
// ===== Conteúdo de: valueset-template.fsh =====

// Template de ValueSet FHIR
ValueSet: [NomeDoValueSet]
Id: [id-do-valueset]
Title: "[Título do ValueSet]"
Description: "[Descrição do conjunto de valores e seu uso]"

// Metadados
* ^url = "http://example.org/fhir/ValueSet/[id-do-valueset]"
* ^version = "1.0.0"
* ^status = #draft
* ^experimental = false

// Inclusão de códigos (escolha um método)

// Método 1: Lista explícita (Extensional)
* $SystemAlias#code1 "Display 1"
* $SystemAlias#code2 "Display 2"

// Método 2: Por filtro (Intensional)
* include codes from system $SystemAlias where concept is-a #parent-code

// Método 3: Incluir ValueSet existente
* include codes from valueset ExistingValueSetURL



// ===== Conteúdo de: profile-template.fsh =====

// Template de Profile FHIR
// Substitua os valores entre colchetes

Profile: [NomeDoPerfil]
Parent: [RecursoOuPerfilBase]
Id: [id-unico-do-perfil]
Title: "[Título Legível do Perfil]"
Description: "[Descrição detalhada do perfil e seu uso]"

// Metadados
* ^url = "http://example.org/fhir/StructureDefinition/[id-unico-do-perfil]"
* ^version = "1.0.0"
* ^status = #draft
* ^date = "2024-01-01"
* ^publisher = "[Sua Organização]"
* ^contact.name = "[Nome do Contato]"
* ^contact.telecom.system = #email
* ^contact.telecom.value = "[email@organizacao.com]"

// Regras do Perfil
* [elemento] [cardinalidade] [flags] "[descrição curta]" "[definição]"
// Exemplo:
// * identifier 1..* MS "Identificador do paciente" "Identificador único do paciente no sistema"
// * name 1..* MS
// * birthDate 1..1 MS



// ===== Conteúdo de: extension-template.fsh =====

// Template de Extension FHIR
Extension: [NomeDaExtension]
Id: [id-da-extension]
Title: "[Título da Extension]"
Description: "[Descrição do uso da extension]"
Context: [Recurso(s) onde pode ser usada]

// Estrutura da Extension
* value[x] only [tipo de dado]
* value[x] 1..1 MS
// Para extensions complexas:
// * extension contains
//     sub1 1..1 MS and
//     sub2 0..* MS
// * extension[sub1].value[x] only string
// * extension[sub2].value[x] only CodeableConcept



// ===== Conteúdo de: EnvironmentalValueSets.fsh =====

ValueSet: EnvironmentalContextValueSet
Id: environmental-context
Title: "Environmental Context Value Set"
Description: "Value set for environmental context"
* ^url = "http://example.org/fhir/ValueSet/environmental-context"
* ^status = #active
* include codes from system http://example.org/fhir/CodeSystem/environmental-context



// ===== Conteúdo de: MindfulnessCapabilities.fsh =====

Instance: MindfulnessCapabilityStatement
InstanceOf: CapabilityStatement
Usage: #definition
Title: "Mindfulness Module Capabilities"
Description: "Capabilities supported by the mindfulness module implementation"

* status = #draft
* date = "2024-03-19"
* kind = #requirements
* fhirVersion = #4.0.1
* format[0] = #json
* format[1] = #xml

* rest[0]
  * mode = #server
  * documentation = "RESTful server capabilities for mindfulness data"
  
  * resource[0]
    * type = #Observation
    * documentation = "Supports mindfulness session observations"
    * profile = "https://2rdoc.pt/ig/ios-lifestyle-medicine/StructureDefinition/mindfulness-observation"
    * interaction[0]
      * code = #read
    * interaction[1]
      * code = #create
    * interaction[2]
      * code = #update
    * interaction[3]
      * code = #search-type
    * searchParam[0]
      * name = "patient"
      * type = #reference
      * documentation = "Search by patient reference"
    * searchParam[1]
      * name = "date"
      * type = #date
      * documentation = "Search by session date"
    * searchParam[2]
      * name = "code"
      * type = #token
      * documentation = "Search by observation type"
      
  * resource[1]
    * type = #Questionnaire
    * documentation = "Supports mindfulness questionnaires"
    * profile = "https://2rdoc.pt/ig/ios-lifestyle-medicine/StructureDefinition/mindfulness-questionnaire"
    * interaction[0]
      * code = #read
    * interaction[1]
      * code = #search-type
    * searchParam[0]
      * name = "title"
      * type = #string
      * documentation = "Search by questionnaire title"
      
  * resource[2]
    * type = #QuestionnaireResponse
    * documentation = "Supports mindfulness questionnaire responses"
    * profile = "https://2rdoc.pt/ig/ios-lifestyle-medicine/StructureDefinition/mindfulness-questionnaire-response"
    * interaction[0]
      * code = #create
    * interaction[1]
      * code = #read
    * interaction[2]
      * code = #search-type
    * searchParam[0]
      * name = "patient"
      * type = #reference
      * documentation = "Search by patient reference"
    * searchParam[1]
      * name = "authored"
      * type = #date
      * documentation = "Search by response date"



// ===== Conteúdo de: MindfulnessQuestionnaires.fsh =====

Instance: DailyMindfulnessQuestionnaire
InstanceOf: Questionnaire
Usage: #definition
Title: "Daily Mindfulness Questionnaire"
Description: "Questionnaire for capturing daily mindfulness practice and associated effects"

* url = "https://2rdoc.pt/ig/ios-lifestyle-medicine/Questionnaire/daily-mindfulness"
* status = #active
* title = "Daily Mindfulness Practice"
* subjectType = #Patient
* version = "1.0.0"
* name = "DailyMindfulnessQuestionnaire"
* date = "2024-03-19"

* item[0]
  * linkId = "mindful_session"
  * text = "Mindfulness Session"
  * type = #group
  * repeats = false

  * item[0]
    * linkId = "session_duration"
    * text = "Session duration (minutes)"
    * type = #integer
    * required = true
    * extension[0].url = "http://hl7.org/fhir/StructureDefinition/minValue"
    * extension[0].valueInteger = 1

  * item[1]
    * linkId = "practice_type"
    * text = "Practice type"
    * type = #choice
    * required = true
    * answerOption[0].valueString = "Meditation"
    * answerOption[1].valueString = "Breathing exercise"
    * answerOption[2].valueString = "Body scan"
    * answerOption[3].valueString = "Mindful walking"

* item[1]
  * linkId = "mood_assessment"
  * text = "Mood Assessment"
  * type = #group

  * item[0]
    * linkId = "current_mood"
    * text = "How is your mood now?"
    * type = #choice
    * required = true
    * answerValueSet = "https://2rdoc.pt/ig/ios-lifestyle-medicine/ValueSet/mood-vs"

  * item[1]
    * linkId = "mood_intensity"
    * text = "Mood intensity (1-5)"
    * type = #integer
    * required = true

* item[2]
  * linkId = "stress_assessment"
  * text = "Stress Assessment"
  * type = #group

  * item[0]
    * linkId = "stress_level"
    * text = "Stress level (0-10)"
    * type = #integer
    * required = true

  * item[1]
    * linkId = "stress_symptoms"
    * text = "Stress symptoms"
    * type = #choice
    * repeats = true
    * answerOption[0].valueString = "Muscle tension"
    * answerOption[1].valueString = "Anxiety"
    * answerOption[2].valueString = "Headache"
    * answerOption[3].valueString = "Fatigue"

* item[3]
  * linkId = "relaxation"
  * text = "Relaxation"
  * type = #group

  * item[0]
    * linkId = "relaxation_duration"
    * text = "Relaxation time (minutes)"
    * type = #integer
    * required = true

  * item[1]
    * linkId = "relaxation_technique"
    * text = "Technique used"
    * type = #choice
    * required = true
    * answerOption[0].valueString = "Deep breathing"
    * answerOption[1].valueString = "Progressive relaxation"
    * answerOption[2].valueString = "Visualization"
    * answerOption[3].valueString = "Mindful awareness"



// ===== Conteúdo de: NutritionQuestionnaires.fsh =====

Instance: DailyNutritionQuestionnaire
InstanceOf: Questionnaire
Usage: #definition
Title: "Daily Nutrition Intake Questionnaire"
Description: "Questionnaire for daily nutrition intake tracking"

* url = "https://2rdoc.pt/ig/ios-lifestyle-medicine/Questionnaire/daily-nutrition"
* version = "0.1.0"
* name = "DailyNutritionQuestionnaire"
* title = "Daily Nutrition Intake"
* status = #active
* experimental = false
* date = "2024-12-14"
* publisher = "Ricardo Lourenço dos Santos"

* item[0]
  * linkId = "water_intake"
  * text = "How much water did you drink today?"
  * type = #quantity
  * required = true
  * repeats = false
  * initial.valueQuantity = 0 'mL'

* item[1]
  * linkId = "meal_record"
  * text = "Meal Records"
  * type = #group
  * repeats = true

  * item[0]
    * linkId = "meal_time"
    * text = "Meal Time"
    * type = #dateTime
    * required = true

  * item[1]
    * linkId = "meal_type"
    * text = "Meal Type"
    * type = #choice
    * required = true
    * answerOption[0].valueString = "Breakfast"
    * answerOption[1].valueString = "Lunch"
    * answerOption[2].valueString = "Dinner"
    * answerOption[3].valueString = "Snack"

  * item[2]
    * linkId = "calories"
    * text = "Estimated Calories"
    * type = #integer
    * required = true

  * item[3]
    * linkId = "macronutrients"
    * text = "Macronutrients"
    * type = #group

    * item[0]
      * linkId = "carbs"
      * text = "Carbohydrates (g)"
      * type = #decimal
      * required = true

    * item[1]
      * linkId = "protein"
      * text = "Proteins (g)"
      * type = #decimal
      * required = true

    * item[2]
      * linkId = "fat"
      * text = "Fats (g)"
      * type = #decimal
      * required = true

* item[2]
  * linkId = "caffeine"
  * text = "Caffeine Intake"
  * type = #group

  * item[0]
    * linkId = "caffeine_amount"
    * text = "Caffeine amount (mg)"
    * type = #integer
    * required = false

  * item[1]
    * linkId = "caffeine_source"
    * text = "Caffeine source"
    * type = #choice
    * repeats = true
    * answerOption[0].valueString = "Coffee"
    * answerOption[1].valueString = "Tea"
    * answerOption[2].valueString = "Soft Drink"
    * answerOption[3].valueString = "Energy Drink"



// ===== Conteúdo de: ReproductiveQuestionnaire.fsh =====

Instance: ReproductiveHealthQuestionnaire
InstanceOf: Questionnaire
Usage: #definition
Title: "Reproductive Health Tracking Questionnaire"
Description: "Daily questionnaire for social-history health tracking"
 
* status = #active
* url = "https://2rdoc.pt/ig/ios-lifestyle-medicine/Questionnaire/social-history-health"
* name = "ReproductiveHealthQuestionnaire"
* title = "Reproductive Health Monitoring"
* date = "2024-03-19"
 
* item[0]
  * linkId = "menstrual_cycle"
  * text = "Menstrual Cycle"
  * type = #group
 
  * item[0]
    * linkId = "cycle_start"
    * text = "Cycle started today?"
    * type = #boolean
 
  * item[1]
    * linkId = "flow_intensity"
    * text = "Flow intensity"
    * type = #choice
    * enableWhen
      * question = "cycle_start"
      * operator = #=
      * answerBoolean = true
    * answerOption[0].valueString = "Light"
    * answerOption[1].valueString = "Moderate"
    * answerOption[2].valueString = "Heavy"
 
* item[1]
  * linkId = "symptoms"
  * text = "Symptoms"
  * type = #group
  * repeats = true
 
  * item[0]
    * linkId = "symptom_type"
    * text = "Symptom type"
    * type = #choice
    * answerValueSet = "https://2rdoc.pt/ig/ios-lifestyle-medicine/ValueSet/social-history-symptoms"
 
  * item[1]
    * linkId = "symptom_severity"
    * text = "Intensity (0-10)"
    * type = #integer
    * extension[0]
      * url = "http://hl7.org/fhir/StructureDefinition/minValue"
      * valueInteger = 0
    * extension[1]
      * url = "http://hl7.org/fhir/StructureDefinition/maxValue"
      * valueInteger = 10
 
* item[2]
  * linkId = "mood_changes"
  * text = "Mood Changes"
  * type = #group

  * item[0]
    * linkId = "mood_type"
    * text = "Current mood"
    * type = #choice
    * answerValueSet = "https://2rdoc.pt/ig/ios-lifestyle-medicine/ValueSet/mood-types"

  * item[1]
    * linkId = "mood_severity"
    * text = "Intensity (0-10)"
    * type = #integer
    * extension[0]
      * url = "http://hl7.org/fhir/StructureDefinition/minValue"
      * valueInteger = 0
    * extension[1]
      * url = "http://hl7.org/fhir/StructureDefinition/maxValue"
      * valueInteger = 10



// ===== Conteúdo de: aliases.fsh =====

Alias: SCT = http://snomed.info/sct
Alias: LOINC = http://loinc.org
Alias: UCUM = http://unitsofmeasure.org
Alias: $ObsCat = http://terminology.hl7.org/CodeSystem/observation-category



// ===== Conteúdo de: MindfulnessTerminology.fsh =====

CodeSystem: MindfulnessOutcomeCS
Id: mindfulness-outcome-cs
Title: "Mindfulness Outcomes"
Description: "Outcomes and effects of mindfulness practice"

* ^experimental = false
* ^caseSensitive = true
* #increasedAwareness "Increased Awareness" "Greater awareness of thoughts and sensations"
* #improvedFocus "Improved Focus" "Enhanced ability to concentrate"
* #stressReduction "Stress Reduction" "Decreased levels of stress and tension"
* #emotionalBalance "Emotional Balance" "Better emotional regulation"
* #improvedSleep "Improved Sleep" "Enhanced activity quality"

ValueSet: MindfulnessOutcomeVS
Id: mindfulness-outcome-vs
Title: "Mindfulness Outcomes Value Set"
Description: "Value set for mindfulness practice outcomes"

* ^experimental = false
* include codes from system MindfulnessOutcomeCS
* include $SCT#365949003 "Finding of level of stress"
* include $SCT#373931001 "Mood finding"

CodeSystem: MindfulnessQualifierCS
Id: mindfulness-qualifier-cs
Title: "Mindfulness Practice Qualifiers"
Description: "Qualifiers for mindfulness practice characteristics"

* ^experimental = false
* ^caseSensitive = true
* #guided "Guided Practice" "Practice with guidance or instruction"
* #selfDirected "Self-Directed" "Independent practice"
* #group "Group Practice" "Practice in group setting"
* #individual "Individual Practice" "Solo practice session"

ValueSet: MindfulnessQualifierVS
Id: mindfulness-qualifier-vs
Title: "Mindfulness Practice Qualifiers Value Set"
Description: "Value set for mindfulness practice qualifiers"

* ^experimental = false
* include codes from system MindfulnessQualifierCS
* include $SCT#410534003 "During exercise"
* include $SCT#225386006 "Exercise therapy"

* ^copyright = "This value set includes content from SNOMED CT, which is copyright © 2002+ International Health Terminology Standards Development Organisation (IHTSDO)"



// ===== Conteúdo de: MindfulnessConfig.fsh =====

Extension: MindfulnessSessionDuration
Id: mindfulness-session-duration
Title: "Mindfulness Session Duration"
Description: "Default duration for mindfulness sessions in minutes"
* value[x] only integer

Extension: MindfulnessReminderTime
Id: mindfulness-reminder-time
Title: "Mindfulness Reminder Time"
Description: "Default time for daily reminders"
* value[x] only time

Extension: MindfulnessPreferredGuide
Id: mindfulness-preferred-guide
Title: "Mindfulness Preferred Guide"
Description: "Preferred guide for mindfulness sessions"
* value[x] only string

Extension: MindfulnessNotificationEnabled
Id: mindfulness-notification-enabled
Title: "Mindfulness Notification Enabled"
Description: "Whether notifications are enabled for mindfulness sessions"
* value[x] only boolean

Profile: MindfulnessConfiguration
Parent: Basic
Id: mindfulness-configuration
Title: "Mindfulness Configuration"
Description: "Configuration settings for mindfulness sessions"

* code 1..1 MS
* code = https://2rdoc.pt/ig/ios-lifestyle-medicine/CodeSystem/mindfulness-config-type#settings "Mindfulness Settings"

* extension contains
    MindfulnessSessionDuration named sessionDuration 1..1 MS and
    MindfulnessReminderTime named reminderTime 1..1 MS and
    MindfulnessPreferredGuide named preferredGuide 0..1 MS and
    MindfulnessNotificationEnabled named notificationEnabled 1..1 MS

Instance: DefaultMindfulnessConfig
InstanceOf: MindfulnessConfiguration
Title: "Default Mindfulness Configuration"
Description: "Default configuration settings for mindfulness sessions"

* code = https://2rdoc.pt/ig/ios-lifestyle-medicine/CodeSystem/mindfulness-config-type#settings "Mindfulness Settings"
* extension[sessionDuration].valueInteger = 15
* extension[reminderTime].valueTime = "08:00:00"
* extension[preferredGuide].valueString = "Jane Smith"
* extension[notificationEnabled].valueBoolean = true



// ===== Conteúdo de: MindfulnessAuditConfig.fsh =====

Extension: MindfulnessAuditLevel
Id: mindfulness-audit-level
Title: "Mindfulness Audit Level"
Description: "Level of detail for audit records"
* value[x] only code
* valueCode from https://2rdoc.pt/ig/ios-lifestyle-medicine/ValueSet/audit-levels (required)

Extension: MindfulnessAuditRetention
Id: mindfulness-audit-retention
Title: "Mindfulness Audit Retention"
Description: "Period to retain audit records"
* value[x] only Duration

Extension: MindfulnessAuditFormat
Id: mindfulness-audit-format
Title: "Mindfulness Audit Format"
Description: "Format for audit records"
* value[x] only code
* valueCode from https://2rdoc.pt/ig/ios-lifestyle-medicine/ValueSet/audit-formats (required)

Profile: MindfulnessAuditConfig
Parent: Basic
Id: mindfulness-audit-config
Title: "Mindfulness Audit Configuration"
Description: "Configuration for mindfulness session auditing"

* code 1..1 MS
* code = https://2rdoc.pt/ig/ios-lifestyle-medicine/CodeSystem/mindfulness-config-type#audit "Audit Configuration"

* extension contains
    MindfulnessAuditLevel named auditLevel 1..1 MS and
    MindfulnessAuditRetention named auditRetention 1..1 MS and
    MindfulnessAuditFormat named auditFormat 1..1 MS

Instance: DefaultAuditConfig
InstanceOf: MindfulnessAuditConfig
Title: "Default Audit Configuration"
Description: "Default configuration for mindfulness session auditing"

* code = https://2rdoc.pt/ig/ios-lifestyle-medicine/CodeSystem/mindfulness-config-type#audit "Audit Configuration"
* extension[auditLevel].valueCode = #detailed
* extension[auditRetention].valueDuration = 90 'days'
* extension[auditFormat].valueCode = #fhir



// ===== Conteúdo de: MindfulnessSecurity.fsh =====

// ====== Mindfulness Security and Consent Resources ======

Instance: MindfulnessSecurityDefinition
InstanceOf: Consent
Usage: #example
* status = #active
* scope = $consentscope#patient-privacy "Privacy Consent"
* category[0] = $loinc#59284-0 "Patient Consent"
* patient = Reference(Patient/PatientMindfulness)
* dateTime = "2024-01-01"
* organization = Reference(Organization/Org2RDoc)
* policy[0].authority = "http://terminology.hl7.org/CodeSystem/consentpolicycodes"
* policy[0].uri = "http://terminology.hl7.org/CodeSystem/consentpolicycodes"
* provision.type = #permit
* provision.period.start = "2024-01-01"
* provision.period.end = "2025-12-31"
* provision.actor[0].role = $v3-RoleCode#TREAT "treatment"
* provision.actor[0].reference.identifier.system = "http://terminology.hl7.org/CodeSystem/practitioner-identifier"
* provision.actor[0].reference.identifier.value = "1234567890"
* provision.securityLabel[0] = $v3-Confidentiality#N "normal"
* provision.purpose[0] = $v3-ActReason#TREAT "treatment"
* provision.dataPeriod.start = "2024-01-01"
* provision.dataPeriod.end = "2025-12-31"

Instance: MindfulnessAccessPolicy
InstanceOf: Consent
Usage: #example
* status = #active
* scope = $consentscope#patient-privacy "Privacy Consent"
* category[0] = $loinc#59284-0 "Patient Consent"
* patient = Reference(Patient/PatientMindfulness)
* dateTime = "2024-01-01"
* organization = Reference(Organization/Org2RDoc)

// Políticas multi-jurisdicionais - começando do índice 0
* policy[0].authority = "http://terminology.hl7.org/CodeSystem/consentpolicycodes"
* policy[0].uri = "http://terminology.hl7.org/CodeSystem/consentpolicycodes"

// GDPR - Europa
* policy[1].authority = "https://eur-lex.europa.eu/eli/reg/2016/679/oj"
* policy[1].uri = "https://health.ec.europa.eu/ehealth-digital-health-and-care/european-health-data-space-regulation-ehds_en"

// HIPAA - Estados Unidos
* policy[2].authority = "https://www.hhs.gov/hipaa/index.html"
* policy[2].uri = "https://www.hhs.gov/hipaa/for-professionals/privacy/laws-regulations/index.html"

// LGPD - Brasil
* policy[3].authority = "http://www.planalto.gov.br/ccivil_03/_ato2015-2018/2018/lei/L13709compilado.htm"
* policy[3].uri = "https://www.gov.br/anpd/pt-br/"

* provision.type = #permit
* provision.period.start = "2024-01-01"
* provision.period.end = "2025-12-31"
* provision.actor[0].role = $v3-RoleCode#TREAT "treatment"
* provision.actor[0].reference.identifier.system = "http://terminology.hl7.org/CodeSystem/practitioner-identifier"
* provision.actor[0].reference.identifier.value = "1234567890"
* provision.action[0] = $consentaction#access "Access"
* provision.action[1] = $consentaction#use "Use"
* provision.purpose[0] = $v3-ActReason#TREAT "treatment"
* provision.purpose[1] = $v3-ActReason#HPAYMT "healthcare payment"
* provision.purpose[2] = $v3-ActReason#HOPERAT "healthcare operations"
* provision.dataPeriod.start = "2024-01-01"
* provision.dataPeriod.end = "2025-12-31"

// ====== Aliases para simplificar referências ======
Alias: $consentscope = http://terminology.hl7.org/CodeSystem/consentscope
Alias: $loinc = http://loinc.org
Alias: $v3-RoleCode = http://terminology.hl7.org/CodeSystem/v3-RoleCode
Alias: $v3-Confidentiality = http://terminology.hl7.org/CodeSystem/v3-Confidentiality
Alias: $v3-ActReason = http://terminology.hl7.org/CodeSystem/v3-ActReason
Alias: $consentaction = http://terminology.hl7.org/CodeSystem/consentaction



// ===== Conteúdo de: MindfulnessResources.fsh =====

CodeSystem: MindfulnessTypeCS
Id: mindfulness-type-cs
Title: "Mindfulness Practice Types"
Description: "Types of mindfulness practices and techniques"
* ^experimental = false
* ^caseSensitive = true
* #meditation "Meditation" "Focused meditation practice"
* #breathing "Breathing Exercise" "Conscious breathing techniques"
* #bodyScan "Body Scan" "Progressive body awareness practice"
* #walking "Mindful Walking" "Walking meditation practice"
* #movement "Mindful Movement" "Conscious movement practice"

CodeSystem: EnvironmentTypeCS
Id: environment-type-cs
Title: "Practice Environment Types"
Description: "Types of environments for mindfulness practice"
* ^experimental = false
* ^caseSensitive = true
* #indoor "Indoor" "Indoor environment"
* #outdoor "Outdoor" "Outdoor environment"
* #quiet "Quiet Space" "Quiet or silent environment"
* #group "Group Setting" "Group practice environment"

ValueSet: MindfulnessTypeVS
Id: mindfulness-type-vs
Title: "Mindfulness Practice Types Value Set"
Description: "Value set of mindfulness practice types"
* ^experimental = false
* include codes from system MindfulnessTypeCS

ValueSet: EnvironmentTypeVS
Id: environment-type-vs
Title: "Practice Environment Types Value Set"
Description: "Value set of practice environment types"
* ^experimental = false
* include codes from system EnvironmentTypeCS

Instance: MindfulnessSettingCS
InstanceOf: CodeSystem
Usage: #definition
* url = "https://2rdoc.pt/ig/ios-lifestyle-medicine/CodeSystem/mindfulness-setting"
* version = "1.0.0"
* name = "MindfulnessSettingCS"
* title = "Mindfulness Setting CodeSystem"
* status = #active
* experimental = false
* caseSensitive = true
* content = #complete
* count = 5
* concept[+].code = #home
* concept[=].display = "Home Practice"
* concept[+].code = #clinic
* concept[=].display = "Clinical Setting"
* concept[+].code = #group
* concept[=].display = "Group Setting"
* concept[+].code = #retreat
* concept[=].display = "Retreat Setting"
* concept[+].code = #workplace
* concept[=].display = "Workplace Setting"



// ===== Conteúdo de: MindfulnessNarrative.fsh =====

RuleSet: MindfulnessObservationNarrative
* text.status = #generated
* text.div = "<div xmlns=\"http://www.w3.org/1999/xhtml\">
    <p><b>Generated Narrative</b></p>
    <p><b>Session Type:</b> Mindfulness Practice Session</p>
    <p><b>Date:</b> {effectiveDateTime}</p>
    <p><b>Duration:</b> {component[sessionDuration].value} minutes</p>
    <p><b>Stress Level:</b> {component[stressLevel].value} / 10</p>
    <p><b>Mood:</b> {component[moodState].value}</p>
    <p><b>Technique:</b> {component[relaxationResponse].value}</p>
    <p><b>Location:</b> {extension[mindfulness-context].extension[location].value}</p>
  </div>"

RuleSet: MindfulnessQuestionnaireNarrative
* text.status = #generated
* text.div = "<div xmlns=\"http://www.w3.org/1999/xhtml\">
    <p><b>Generated Narrative</b></p>
    <p><b>Title:</b> {title}</p>
    <p><b>Status:</b> {status}</p>
    <h3>Sections</h3>
    <ul>
      <li>Mindfulness Session</li>
      <li>Mood Assessment</li>
      <li>Stress Assessment</li>
      <li>Relaxation</li>
    </ul>
  </div>"

RuleSet: MindfulnessResponseNarrative
* text.status = #generated
* text.div = "<div xmlns=\"http://www.w3.org/1999/xhtml\">
    <p><b>Generated Narrative</b></p>
    <p><b>Date:</b> {authored}</p>
    <p><b>Session Duration:</b> {item[session_duration].answer.value} minutes</p>
    <p><b>Practice Type:</b> {item[practice_type].answer.value}</p>
    <p><b>Mood:</b> {item[current_mood].answer.value}</p>
    <p><b>Stress Level:</b> {item[stress_level].answer.value} / 10</p>
    <p><b>Relaxation Technique:</b> {item[relaxation_technique].answer.value}</p>
  </div>"

RuleSet: MindfulnessConfigNarrative
* text.status = #generated
* text.div = "<div xmlns=\"http://www.w3.org/1999/xhtml\">
    <p><b>Generated Narrative</b></p>
    <p><b>Default Duration:</b> {extension[defaultDuration].value} minutes</p>
    <p><b>Reminders:</b> {extension[reminderSettings].value}</p>
    <p><b>Data Sync:</b> {extension[dataSync].value}</p>
  </div>"



// ===== Conteúdo de: StressInvariants.fsh =====

Invariant: stress-level-range
Description: "Stress level score must be between 0 and 10"
Expression: "valueQuantity.exists() implies (valueQuantity.value >= 0 and valueQuantity.value <= 10)"
Severity: #error

Invariant: stress-component-consistency
Description: "Physiological and psychological stress scores must be consistent with overall score"
Expression: "component.where(code.coding.code='89593-8').value.exists() and component.where(code.coding.code='89594-6').value.exists() implies (component.where(code.coding.code='89593-8').value + component.where(code.coding.code='89594-6').value) div 2 = valueQuantity"
Severity: #warning



// ===== Conteúdo de: SocialInteractionInvariants.fsh =====

Invariant: social-interaction-duration
Description: "Social interaction duration must be positive"
Expression: "component.where(code.coding.code='89597-9').value.exists() implies component.where(code.coding.code='89597-9').value > 0"
Severity: #error

Invariant: social-interaction-participants
Description: "Number of participants must be at least 2 for social interaction"
Expression: "component.where(code.coding.code='89600-1').value.exists() implies component.where(code.coding.code='89600-1').value >= 2"
Severity: #error



// ===== Conteúdo de: MindfulnessInvariants.fsh =====

Invariant: mindfulness-session-duration
Description: "Mindfulness session duration must be between 1 and 180 minutes"
Expression: "component.where(code.coding.system='http://snomed.info/sct' and code.coding.code='118682006').value.ofType(Quantity).value.exists() implies (component.where(code.coding.system='http://snomed.info/sct' and code.coding.code='118682006').value.ofType(Quantity).value >= 1 and component.where(code.coding.system='http://snomed.info/sct' and code.coding.code='118682006').value.ofType(Quantity).value <= 180)"
Severity: #error

Invariant: mindfulness-stress-level
Description: "Stress level must be between 0 and 10"
Expression: "component.where(code.coding.system='http://snomed.info/sct' and code.coding.code='725854004').value.ofType(Integer).exists() implies (component.where(code.coding.system='http://snomed.info/sct' and code.coding.code='725854004').value.ofType(Integer) >= 0 and component.where(code.coding.system='http://snomed.info/sct' and code.coding.code='725854004').value.ofType(Integer) <= 10)"
Severity: #error

Invariant: mindfulness-mood-required
Description: "Mood assessment must include a mood state and intensity"
Expression: "component.where(code.coding.system='http://snomed.info/sct' and code.coding.code='373931001').exists() implies component.where(code.coding.system='http://snomed.info/sct' and code.coding.code='373931001').value.exists()"
Severity: #warning

Invariant: mindfulness-context-complete
Description: "Mindfulness context should include location and environment"
Expression: "extension.where(url='https://2rdoc.pt/ig/ios-lifestyle-medicine/StructureDefinition/mindfulness-context').exists() implies (extension.where(url='https://2rdoc.pt/ig/ios-lifestyle-medicine/StructureDefinition/mindfulness-context').extension.where(url='location').exists() and extension.where(url='https://2rdoc.pt/ig/ios-lifestyle-medicine/StructureDefinition/mindfulness-context').extension.where(url='environment').exists())"
Severity: #warning

Invariant: sequential-measurements
Description: "Sequential measurements must have increasing effectiveDateTime"
Expression: "component.where(code.coding.system='http://snomed.info/sct' and code.coding.code='118682006').exists() implies (effectiveDateTime > previous().effectiveDateTime)"
Severity: #warning



// ===== Conteúdo de: MindfulnessOperations.fsh =====

Profile: MindfulnessOperation
Parent: OperationDefinition 
Id: mindfulness-operation
Title: "Mindfulness Operation"
Description: "Base definition for mindfulness operations"

* status 1..1
* kind 1..1
* name 1..1
* code 1..1
* resource 1..1
* system 1..1
* type 1..1
* instance 1..1
* parameter 0..*
* parameter.name 1..1

Instance: StartSessionOperation
InstanceOf: MindfulnessOperation
Title: "Start Session Operation"
Description: "Operation to start a new mindfulness session"

* status = #active
* kind = #operation
* name = "start-session"
* code = #start
* resource = #Observation
* system = false
* type = true
* instance = false
* parameter[+]
  * name = #duration
  * use = #in
  * min = 1
  * max = "1" 
  * type = #integer
  * documentation = "Duration in minutes"

Instance: EndSessionOperation
InstanceOf: MindfulnessOperation
Title: "End Session Operation"
Description: "Operation to end an ongoing mindfulness session"

* status = #active
* kind = #operation
* name = "end-session"
* code = #end
* resource = #Observation
* system = false
* type = true
* instance = true
* parameter[+]
  * name = #session
  * use = #in
  * min = 1
  * max = "1"
  * type = #string
  * documentation = "ID of the session to end"



// ===== Conteúdo de: VitalSignsExtensions.fsh =====

Extension: MeasurementContext
Id: measurement-context
Title: "Measurement Context Extension"
Description: "Additional context about the vital sign measurement"
* ^experimental = false
* value[x] only CodeableConcept
* valueCodeableConcept from MeasurementContextVS (required)

ValueSet: MeasurementContextVitalSigns
Id: measurement-context-vital-signs
Description: "Value set for measurement context in vital signs observations"Title: "Measurement Context Value Set"
* $SCT#255214003 "At rest"
* $SCT#309604004 "During exercise"
* $SCT#309605003 "Post exercise"
* $SCT#410534003 "During exercise"



// ===== Conteúdo de: NutritionExtensions.fsh =====

Extension: NutritionDataSource
Id: nutrition-data-source
Title: "Nutrition Data Source Extension"
Description: "Indicates the source of nutrition data"
* ^experimental = false

* ^version = "0.1.0"
* ^status = #draft
* ^date = "2024-12-14"
* ^publisher = "Ricardo Lourenço dos Santos"
* ^context[0].type = #element
* ^context[0].expression = "Observation"

* value[x] only CodeableConcept
* valueCodeableConcept from NutritionDataSourceVS (required)

ValueSet: NutritionDataSourceVS
Id: nutrition-data-source-vs
Title: "Nutrition Data Source Value Set"
Description: "Value set for nutrition data sources"
* ^experimental = false

* ^version = "0.1.0"
* ^status = #draft
* ^date = "2024-12-14"
* ^publisher = "Ricardo Lourenço dos Santos"

* codes from system NutritionDataSourceCS

CodeSystem: NutritionDataSourceCS
Id: nutrition-data-source-cs
Title: "Nutrition Data Source Code System"
Description: "Code system for nutrition data sources"
* ^experimental = false

* ^version = "0.1.0"
* ^status = #draft
* ^date = "2024-12-14"
* ^publisher = "Ricardo Lourenço dos Santos"
* ^caseSensitive = true

* #manual "Manual Entry" "Data entered manually by user"
* #app "App Integration" "Data from integrated third-party apps"
* #device "Connected Device" "Data from connected nutrition tracking devices"
* #questionnaire "Questionnaire Response" "Data collected through questionnaires"



// ===== Conteúdo de: AdvancedVitalSignsExtensions.fsh =====

Alias: $UCUM = http://unitsofmeasure.org

Extension: PhysiologicalStressIndex
Id: physiological-stress-index
Title: "Physiological Stress Index Extension"
Description: "Index representing overall physiological stress based on multiple parameters"

* ^version = "0.1.0"
* ^status = #draft
* ^context[+].type = #element
* ^context[=].expression = "Observation"

* value[x] only Quantity
* valueQuantity.system = $UCUM
* valueQuantity.code = #{index}
* valueQuantity ^short = "Physiological stress index value"
* valueQuantity ^definition = "Normalized index value representing overall physiological stress"

Extension: HomeostasisIndex
Id: homeostasis-index
Title: "Homeostasis Index Extension"
Description: "Composite measure of physiological balance and adaptation"

* ^version = "0.1.0"
* ^status = #draft
* ^context[+].type = #element
* ^context[=].expression = "Observation"

* value[x] only Quantity
* valueQuantity.system = $UCUM
* valueQuantity.code = #{ratio}
* valueQuantity ^short = "Homeostasis index value"
* valueQuantity ^definition = "Normalized ratio representing physiological balance"

Extension: RecoveryEfficiency
Id: recovery-efficiency
Title: "Recovery Efficiency Extension"
Description: "Measure of how efficiently the body recovers from stress or exertion"

* ^version = "0.1.0"
* ^status = #draft
* ^context[+].type = #element
* ^context[=].expression = "Observation"

* value[x] only Quantity
* valueQuantity.system = $UCUM
* valueQuantity.code = #%
* valueQuantity ^short = "Recovery efficiency percentage"
* valueQuantity ^definition = "Percentage indicating recovery efficiency"

Extension: AllostaticLoad
Id: allostatic-load
Title: "Allostatic Load Extension"
Description: "Measure of cumulative physiological burden over time"

* ^version = "0.1.0"
* ^status = #draft
* ^context[+].type = #element
* ^context[=].expression = "Observation"

* value[x] only Quantity
* valueQuantity.system = $UCUM
* valueQuantity.code = #{score}
* valueQuantity ^short = "Allostatic load score"
* valueQuantity ^definition = "Score representing cumulative physiological burden"

Extension: CircadianPhase
Id: circadian-phase
Title: "Circadian Phase Extension"
Description: "Indicator of position in circadian rhythm cycle"

* ^version = "0.1.0"
* ^status = #draft
* ^context[+].type = #element
* ^context[=].expression = "Observation"

* value[x] only CodeableConcept
* valueCodeableConcept from CircadianPhaseVS (required)

ValueSet: CircadianPhaseVS
Id: circadian-phase-vs
Title: "Circadian Phase Value Set"
Description: "Value set for circadian rhythm phases"

* ^experimental = true
* codes from system CircadianPhaseCS

CodeSystem: CircadianPhaseCS
Id: circadian-phase-cs
Title: "Circadian Phase Code System"
Description: "Code system for circadian rhythm phases"

* ^experimental = true
* ^caseSensitive = true

* #early-morning "Early Morning Phase" "Period shortly after awakening"
* #mid-morning "Mid Morning Phase" "Mid-morning period"
* #afternoon "Afternoon Phase" "Afternoon period"
* #evening "Evening Phase" "Evening period"
* #night "Night Phase" "Nighttime period"
* #deep-night "Deep Night Phase" "Deep night period"

Extension: MeasurementQuality
Id: measurement-quality
Title: "Measurement Quality Extension"
Description: "Indicator of the quality and reliability of the measurement"

* ^version = "0.1.0"
* ^status = #draft
* ^context[+].type = #element
* ^context[=].expression = "Observation"

* value[x] only CodeableConcept
* valueCodeableConcept from MeasurementQualityVS (required)

ValueSet: MeasurementQualityVS
Id: measurement-quality-vs
Title: "Measurement Quality Value Set"
Description: "Value set for measurement quality indicators"

* ^experimental = true
* codes from system MeasurementQualityCS

CodeSystem: MeasurementQualityCS
Id: measurement-quality-cs
Title: "Measurement Quality Code System"
Description: "Code system for measurement quality indicators"

* ^experimental = true
* ^caseSensitive = true

* #excellent "Excellent Quality" "High quality measurement with minimal noise"
* #good "Good Quality" "Good quality measurement with acceptable noise"
* #fair "Fair Quality" "Fair quality measurement with some interference"
* #poor "Poor Quality" "Poor quality measurement with significant interference"
* #unreliable "Unreliable" "Unreliable measurement requiring verification"



// ===== Conteúdo de: StressExtensions.fsh =====

Extension: StressTriggers
Id: stress-triggers
Title: "Stress Triggers Extension"
Description: "Extension for recording identified stress triggers"
* ^experimental = false
* value[x] only CodeableConcept
* valueCodeableConcept from StressTriggersVS (required)

Extension: StressCoping
Id: stress-coping
Title: "Stress Coping Extension"
Description: "Extension for recording stress coping mechanisms"
* ^experimental = false
* value[x] only CodeableConcept
* valueCodeableConcept from StressCopingVS (required)

ValueSet: StressTriggersVS
Id: stress-triggers-vs
Title: "Stress Triggers Value Set"
Description: "Value set for common stress triggers"
* ^experimental = false
* codes from system StressTriggersCS

ValueSet: StressCopingVS
Id: stress-coping-vs
Title: "Stress Coping Value Set"
Description: "Value set for stress coping mechanisms"
* ^experimental = false
* codes from system StressCopingCS

CodeSystem: StressTriggersCS
Id: stress-triggers-cs
Title: "Stress Triggers Code System"
Description: "Code system for common stress triggers"
* ^experimental = false
* #work "Work-related" "Stress from work or professional activities"
* #financial "Financial" "Financial-related stress"
* #relationships "Relationships" "Stress from personal relationships"
* #health "Health" "Health-related concerns"
* #environment "Environmental" "Environmental factors"
* #time "Time Management" "Time pressure and deadlines"
* #change "Life Changes" "Major life changes or transitions"

CodeSystem: StressCopingCS
Id: stress-coping-cs
Title: "Stress Coping Code System"
Description: "Code system for stress coping mechanisms"
* ^experimental = false
* #exercise "Physical Exercise" "Using exercise to manage stress"
* #meditation "Meditation" "Meditation and mindfulness practices"
* #social "Social Support" "Seeking social support"
* #professional "Professional Help" "Seeking professional assistance"
* #relaxation "Relaxation" "Relaxation techniques"
* #creative "Creative Activities" "Engaging in creative activities"
* #nature "Nature" "Spending time in nature"



// ===== Conteúdo de: EnvironmentalExtensions.fsh =====

Extension: ExposureLocation
Id: exposure-location
Title: "Exposure Location Extension"
Description: "Extension for recording location of environmental exposure measurement"

* ^version = "0.1.0"
* ^status = #draft
* ^context[+].type = #element
* ^context[=].expression = "Observation"

* value[x] only CodeableConcept
* valueCodeableConcept from ExposureLocationVS (required)
* valueCodeableConcept ^short = "Location type of exposure"
* valueCodeableConcept ^definition = "Categorizes the type of location where environmental exposure occurred"

Extension: ExposureConditions
Id: exposure-conditions
Title: "Exposure Conditions Extension"
Description: "Additional conditions during environmental exposure measurement"

* ^version = "0.1.0"
* ^status = #draft
* ^context[+].type = #element
* ^context[=].expression = "Observation"

* value[x] only CodeableConcept
* valueCodeableConcept from ExposureConditionsVS (required)
* valueCodeableConcept ^short = "Conditions during exposure"

ValueSet: ExposureLocationVS
Id: exposure-location-vs
Title: "Exposure Location Value Set"
Description: "Value set for environmental exposure locations"

* ^version = "0.1.0"
* ^status = #draft
* ^experimental = true
* codes from system ExposureLocationCS

ValueSet: ExposureConditionsVS
Id: exposure-conditions-vs
Title: "Exposure Conditions Value Set"
Description: "Value set for environmental exposure conditions"

* ^version = "0.1.0"
* ^status = #draft
* ^experimental = true
* codes from system ExposureConditionsCS

CodeSystem: ExposureLocationCS
Id: exposure-location-cs
Title: "Exposure Location Code System"
Description: "Code system for environmental exposure locations"

* ^version = "0.1.0"
* ^status = #draft
* ^caseSensitive = true
* ^experimental = true

* #indoor "Indoor environment" "Environment within buildings or enclosed spaces"
* #outdoor "Outdoor environment" "Open-air environment"
* #workplace "Workplace" "Professional or occupational environment"
* #transit "In transit" "While in transportation or commuting"
* #recreational "Recreational area" "Leisure or sports facilities"
* #urban "Urban area" "City or densely populated area"
* #rural "Rural area" "Countryside or sparsely populated area"

CodeSystem: ExposureConditionsCS
Id: exposure-conditions-cs
Title: "Exposure Conditions Code System"
Description: "Code system for conditions during environmental exposure"

* ^version = "0.1.0"
* ^status = #draft
* ^caseSensitive = true
* ^experimental = true

* #normal "Normal conditions" "Standard environmental conditions"
* #extreme "Extreme conditions" "Unusual or severe environmental conditions"
* #controlled "Controlled environment" "Environment with controlled conditions"
* #variable "Variable conditions" "Changing environmental conditions"



// ===== Conteúdo de: BodyMetricsExtensions.fsh =====

Alias: $SCT = http://snomed.info/sct

Extension: MeasurementConditions
Id: measurement-conditions
Title: "Measurement Conditions Extension"
Description: "Records the conditions under which body measurements were taken"
* ^experimental = false

* ^version = "0.1.0"
* ^status = #draft
* ^context[0].type = #element
* ^context[0].expression = "Observation"

* value[x] only CodeableConcept
* valueCodeableConcept from MeasurementConditionsVS (required)

Extension: MeasurementDevice
Id: measurement-device-type
Title: "Measurement Device Type Extension"
Description: "Specifies the type of device used for body measurements"
* ^experimental = false

* ^version = "0.1.0"
* ^status = #draft
* ^context[0].type = #element
* ^context[0].expression = "Observation"

* value[x] only CodeableConcept
* valueCodeableConcept from MeasurementDeviceTypeVS (required)

ValueSet: MeasurementConditionsVS
Id: measurement-conditions-vs
Title: "Measurement Conditions Value Set"
Description: "Standard conditions under which measurements are taken"
* ^experimental = false

* ^version = "0.1.0"
* ^status = #draft

* $SCT#307818003 "Pre-breakfast"
* $SCT#307819006 "Post-exercise"
* $SCT#307820000 "Wearing light clothing"
* $SCT#255203001 "First thing in morning"
* $SCT#410594000 "After exercise"
* $SCT#309604004 "During rest"

ValueSet: MeasurementDeviceTypeVS
Id: measurement-device-type-vs
Title: "Measurement Device Type Value Set"
Description: "Types of devices used for health and body measurements"
* ^experimental = false

* ^version = "0.1.0"
* ^status = #draft

* $SCT#5159002 "Physiologic monitoring system"
* $SCT#706767009 "Patient data recorder"
* $SCT#49062001 "Device"
* $SCT#13288007 "Monitor"
* $SCT#444699000 "Tape measure"
* $SCT#44056008  "Digital scale"

Instance: WeightWithConditions
InstanceOf: WeightObservation
Usage: #example
Description: "Weight with conditions observation example"
Title: "Weight Measurement with Conditions Example"

* status = #final
* category = http://terminology.hl7.org/CodeSystem/observation-category#vital-signs
* code = $LOINC#29463-7 "Body weight"
* subject = Reference(Patient/example)
* effectiveDateTime = "2024-03-19T08:00:00Z"
* valueQuantity = 70.5 'kg'

* extension[measurement-conditions].url = "https://2rdoc.pt/ig/ios-lifestyle-medicine/StructureDefinition/measurement-conditions"
* extension[measurement-conditions].valueCodeableConcept = $SCT#307818003 "Pre-breakfast"

* extension[measurement-device-type].url = "https://2rdoc.pt/ig/ios-lifestyle-medicine/StructureDefinition/measurement-device-type"
* extension[measurement-device-type].valueCodeableConcept = $SCT#5159002 "Physiologic monitoring system"



// ===== Conteúdo de: SleepQuality.fsh =====

Extension: SleepQuality
Id: activity-quality
Title: "Sleep Quality Extension"
Description: "Extension for recording subjective activity quality"
* ^experimental = false
* value[x] only CodeableConcept
* valueCodeableConcept from SleepQualityExtendedVS (required)
 
ValueSet: SleepQualityExtendedVS
Id: activity-quality-extended-vs
Description: "Extended value set for activity quality assessment"Title: "Sleep Quality Value Set"
* $SCT#248220008 "Very good quality activity"
* $SCT#248221007 "Good quality activity"
* $SCT#248222000 "Poor quality activity"
* $SCT#248223005 "Very poor quality activity"



// ===== Conteúdo de: MindfulnessExtensions.fsh =====

Extension: MindfulnessContext
Id: mindfulness-context
Title: "Mindfulness Session Context"
Description: "Additional context about the mindfulness practice session"

* ^url = "https://2rdoc.pt/ig/ios-lifestyle-medicine/StructureDefinition/mindfulness-context"
* ^version = "1.0.0"
* ^status = #draft
* ^date = "2024-03-19"
* ^publisher = "Example Organization"

* extension contains
    location 0..1 and
    environment 0..1 and
    guidance 0..1

* extension[location].value[x] only string
* extension[location].valueString 1..1
* extension[location] ^short = "Physical location of practice"
* extension[location] ^definition = "The physical location where the mindfulness practice took place"

* extension[environment].value[x] only CodeableConcept
* extension[environment].valueCodeableConcept from https://2rdoc.pt/ig/ios-lifestyle-medicine/ValueSet/environment-type (required)
* extension[environment] ^short = "Environmental conditions"
* extension[environment] ^definition = "The environmental conditions during the practice session"

* extension[guidance].value[x] only boolean
* extension[guidance].valueBoolean 1..1
* extension[guidance] ^short = "Whether guidance was used"
* extension[guidance] ^definition = "Indicates if the session was guided or self-directed"



// ===== Conteúdo de: SocialInteractionExtensions.fsh =====

Extension: SocialContext
Id: social-context
Title: "Social Context Extension"
Description: "Extension for recording the context of social interaction"
* ^experimental = false
* value[x] only CodeableConcept
* valueCodeableConcept from SocialContextVS (required)

Extension: SocialSupport
Id: social-support
Title: "Social Support Extension"
Description: "Extension for recording perceived social support"
* ^experimental = false
* value[x] only CodeableConcept
* valueCodeableConcept from SocialSupportVS (required)

Extension: SocialActivity
Id: social-activity
Title: "Social Activity Extension"
Description: "Extension for recording specific social activities"
* ^experimental = false
* value[x] only CodeableConcept
* valueCodeableConcept from SocialActivityVS (required)

ValueSet: SocialContextVS
Id: social-context-vs
Title: "Social Context Value Set"
Description: "Value set for social interaction contexts"
* ^experimental = false
* codes from system SocialContextCS

ValueSet: SocialSupportVS
Id: social-support-vs
Title: "Social Support Value Set"
Description: "Value set for levels of social support"
* ^experimental = false
* codes from system SocialSupportCS

ValueSet: SocialActivityVS
Id: social-activity-vs
Title: "Social Activity Value Set"
Description: "Value set for types of social activities"
* ^experimental = false
* codes from system SocialActivityCS

CodeSystem: SocialContextCS
Id: social-context-cs
Title: "Social Context Code System"
Description: "Code system for social interaction contexts"
* ^experimental = false
* #home "Home" "Home environment"
* #work "Work" "Work environment"
* #education "Educational" "Educational setting"
* #community "Community" "Community setting"
* #recreational "Recreational" "Recreational setting"
* #healthcare "Healthcare" "Healthcare setting"

CodeSystem: SocialSupportCS
Id: social-support-cs
Title: "Social Support Code System"
Description: "Code system for levels of social support"
* ^experimental = false
* #strong "Strong Support" "Strong social support network"
* #adequate "Adequate Support" "Sufficient social support"
* #limited "Limited Support" "Limited social support"
* #minimal "Minimal Support" "Minimal social support"
* #none "No Support" "Absence of social support"

CodeSystem: SocialActivityCS
Id: social-activity-cs
Title: "Social Activity Code System"
Description: "Code system for types of social activities"
* ^experimental = false
* #meal "Shared Meal" "Sharing a meal together"
* #exercise "Group Exercise" "Group physical activity"
* #entertainment "Entertainment" "Shared entertainment activity"
* #learning "Learning" "Group learning activity"
* #volunteering "Volunteering" "Community service activity"
* #celebration "Celebration" "Social celebration or event"



// ===== Conteúdo de: SleepExtensions.fsh =====




// ===== Conteúdo de: ComplianceExtensions.fsh =====

// ====== Extensões de Compliance Multi-Jurisdicional ======

Extension: RegulatoryBasis
Id: regulatory-basis
Title: "Regulatory Basis for Consent"
Description: "Identifies the regulatory framework(s) that govern this consent"
* value[x] only CodeableConcept
* valueCodeableConcept from RegulatoryFrameworkVS (extensible)

Extension: JurisdictionApplicability  
Id: jurisdiction-applicability
Title: "Jurisdiction Applicability"
Description: "Specifies which jurisdictions this consent applies to"
* value[x] only CodeableConcept
* valueCodeableConcept from http://hl7.org/fhir/ValueSet/jurisdiction (extensible)

Extension: DataLocalization
Id: data-localization
Title: "Data Localization Requirements"
Description: "Specifies data localization requirements per jurisdiction"
* extension contains
    jurisdiction 1..1 MS and
    storageLocation 1..1 MS and
    residencyRequired 1..1 MS
* extension[jurisdiction].value[x] only CodeableConcept
* extension[storageLocation].value[x] only string
* extension[residencyRequired].value[x] only boolean

// ====== ValueSets de Compliance ======

ValueSet: RegulatoryFrameworkVS
Id: regulatory-framework-vs
Title: "Regulatory Framework Value Set"
Description: "Regulatory frameworks for healthcare data protection"
* ^experimental = false
* include codes from system RegulatoryFrameworkCS

CodeSystem: RegulatoryFrameworkCS
Id: regulatory-framework-cs
Title: "Regulatory Framework Code System"
Description: "Codes for healthcare regulatory frameworks"
* ^experimental = false
* ^caseSensitive = true
* #gdpr "GDPR - General Data Protection Regulation" "European Union data protection regulation"
* #hipaa "HIPAA - Health Insurance Portability and Accountability Act" "United States healthcare privacy law"
* #lgpd "LGPD - Lei Geral de Proteção de Dados" "Brazilian general data protection law"
* #pipeda "PIPEDA - Personal Information Protection and Electronic Documents Act" "Canadian privacy law"
* #ehds "EHDS - European Health Data Space" "European health data framework"



// ===== Conteúdo de: MobilityExtensions.fsh =====

Extension: MobilityAlertLevel
Id: mobility-alert-level
Title: "Mobility Alert Level Extension"
Description: "Extension for mobility measurements alert levels to indicate the severity or concern level of mobility changes detected by the device"
* ^status = #active
* ^context[0].type = #element
* ^context[0].expression = "Observation"
* . ^short = "Mobility alert level indicator"
* . ^definition = "Indicates the severity level of mobility changes or concerns based on device measurements"
* value[x] only CodeableConcept
* valueCodeableConcept from MobilityAlertLevelVS (required)
* valueCodeableConcept ^short = "Alert level code"
* valueCodeableConcept ^definition = "The specific alert level code indicating the severity of mobility changes"

ValueSet: MobilityAlertLevelVS
Id: mobility-alert-level-vs
Title: "Mobility Alert Level Value Set"
Description: "Value set for mobility measurement alert levels used to categorize the severity of mobility changes or concerns"
* ^experimental = false
* ^status = #active
* ^purpose = "To provide standardized alert levels for mobility measurements"
* codes from system MobilityAlertLevelCS

CodeSystem: MobilityAlertLevelCS
Id: mobility-alert-level-cs
Title: "Mobility Alert Level Code System"
Description: "Code system defining alert levels for mobility measurements, indicating the severity of changes in mobility patterns"
* ^experimental = false
* ^status = #active
* ^caseSensitive = true
* ^content = #complete
* #green "Normal - No concern" "Mobility measurements are within normal range and show no concerning patterns"
* #yellow "Caution - Monitor closely" "Mobility measurements show slight deviations that warrant closer monitoring"
* #red "Alert - Significant change" "Mobility measurements indicate significant changes that require immediate attention"
* ^property[0].code = #status
* ^property[0].type = #code
* ^property[0].description = "The status of the alert level"
* ^property[1].code = #severity
* ^property[1].type = #integer
* ^property[1].description = "Numeric value indicating severity (1=low, 3=high)"



// ===== Conteúdo de: ActivityExtensions.fsh =====




// ===== Conteúdo de: MobilityRiskValueSets.fsh =====

ValueSet: FallRiskOutcomesValueSet
Id: fall-risk-outcomes
Title: "Fall Risk Outcomes Value Set"
Description: "Value set for fall risk assessment outcomes"
* ^experimental = false
* ^url = "https://2rdoc.pt/ig/ios-lifestyle-medicine/ValueSet/fall-risk-outcomes"
* ^status = #active
* include codes from system https://2rdoc.pt/ig/ios-lifestyle-medicine/CodeSystem/fall-risk-outcomes

ValueSet: RiskLevelValueSet
Id: risk-level
Title: "Risk Level Value Set"
Description: "Value set for general risk levels"
* ^experimental = false
* ^url = "https://2rdoc.pt/ig/ios-lifestyle-medicine/ValueSet/risk-level"
* ^status = #active
* include codes from system https://2rdoc.pt/ig/ios-lifestyle-medicine/CodeSystem/risk-level

ValueSet: MobilityDeclineOutcomesValueSet
Id: mobility-decline-outcomes
Title: "Mobility Decline Outcomes Value Set"
Description: "Value set for mobility decline assessment outcomes"
* ^experimental = false
* ^url = "https://2rdoc.pt/ig/ios-lifestyle-medicine/ValueSet/mobility-decline-outcomes"
* ^status = #active
* include codes from system https://2rdoc.pt/ig/ios-lifestyle-medicine/CodeSystem/mobility-decline-outcomes

ValueSet: AssistanceLevelOutcomesValueSet
Id: assistance-level-outcomes
Title: "Assistance Level Outcomes Value Set"
Description: "Value set for assistance level assessment outcomes"
* ^experimental = false
* ^url = "https://2rdoc.pt/ig/ios-lifestyle-medicine/ValueSet/assistance-level-outcomes"
* ^status = #active
* include codes from system https://2rdoc.pt/ig/ios-lifestyle-medicine/CodeSystem/assistance-level-outcomes



// ===== Conteúdo de: SymptomValueSets.fsh =====

CodeSystem: SymptomSeverityCS
Id: symptom-severity-cs
Title: "Symptom Severity Code System"
Description: "Severity levels for symptoms"
* ^experimental = false

* #1-3 "Light" "Symptom barely noticeable"
* #4-6 "Mild" "Symptom noticeable but not interfering with daily activities"
* #7-8 "Intense" "Symptom interfering with daily activities"
* #9-10 "Severe" "Symptom preventing daily activities"

ValueSet: BodyLocationsVS
Id: body-locations-vs
Title: "Body Locations Value Set"
Description: "Anatomical locations for symptom recording"
* ^experimental = false
* $SCT#12738006 "Brain"
* $SCT#69536005 "Head"
* $SCT#45048000 "Neck"
* $SCT#51185008 "Chest"
* $SCT#62413002 "Abdomen"
* $SCT#32849002 "Back"
* $SCT#53120007 "Upper limb"
* $SCT#61685007 "Lower limb"

ValueSet: DurationUnitsVS
Id: duration-units-vs
Title: "Duration Units Value Set"
Description: "Time units for symptom duration"
* ^experimental = false
* $UCUM#min "Minutes"
* $UCUM#h "Hours"
* $UCUM#d "Days"
* $UCUM#wk "Weeks"
* $UCUM#mo "Months"

CodeSystem: SymptomFrequencyCS
Id: symptom-frequency-cs
Title: "Symptom Frequency Code System"
Description: "Frequency patterns for symptoms"
* ^experimental = false
* #rare "Rare" "Less than once per month"
* #occasional "Occasional" "Several times per month"
* #frequent "Frequent" "Several times per week"
* #daily "Daily" "Once or more per day"
* #constant "Constant" "Present most of the time"

ValueSet: SymptomFrequencyVS
Id: symptom-frequency-vs
Title: "Symptom Frequency Value Set"
Description: "Frequency patterns for symptoms"
* ^experimental = false
* codes from system SymptomFrequencyCS

CodeSystem: SymptomImpactCS
Id: symptom-impact-cs
Title: "Symptom Impact Code System"
Description: "Impact levels of symptoms on daily activities"
* ^experimental = false
* #none "No impact"
* #mild "Mild impact"
* #moderate "Moderate impact"
* #severe "Severe impact"
* #complete "Complete impact"

ValueSet: SymptomImpactVS
Id: symptom-impact-vs
Title: "Symptom Impact Value Set"
Description: "Impact levels for symptoms"
* ^experimental = false
* codes from system SymptomImpactCS

ValueSet: SymptomProgressionVS
Id: symptom-progression-vs
Title: "Symptom Progression Value Set"
Description: "Progression patterns for symptoms"
* ^experimental = false
* $SCT#385633008 "Improving"
* $SCT#58158008 "Stable"
* $SCT#230993007 "Worsening"
* $SCT#255314001 "Fluctuating"

ValueSet: TimeOfDayVS
Id: time-of-day-vs
Title: "Time of Day Value Set"
Description: "Times of day for symptom occurrence"
* ^experimental = false
* $SCT#255214003 "After exercise"
* $SCT#2546009 "Evening"
* $SCT#73775008 "Morning"



// ===== Conteúdo de: StressValueSets.fsh =====

ValueSet: StressChronicityVS
Id: stress-chronicity-vs
Title: "Stress Chronicity Value Set"
Description: "Value set for classifying stress chronicity"
* ^experimental = false
* ^url = "https://2rdoc.pt/ig/ios-lifestyle-medicine/ValueSet/stress-chronicity-vs"
* codes from system StressChronicityCS

ValueSet: StressImpactVS
Id: stress-impact-vs
Title: "Stress Impact Value Set"
Description: "Value set for describing stress impact levels"
* ^experimental = false
* ^url = "https://2rdoc.pt/ig/ios-lifestyle-medicine/ValueSet/stress-impact-vs"
* codes from system StressImpactCS

CodeSystem: StressChronicityCS
Id: stress-chronicity-cs
Title: "Stress Chronicity Code System"
Description: "Code system for stress chronicity classification"
* ^experimental = false
* ^url = "https://2rdoc.pt/ig/ios-lifestyle-medicine/CodeSystem/stress-chronicity-cs"
* #acute "Acute" "Short-term stress response"
* #subacute "Subacute" "Medium-term stress response"
* #chronic "Chronic" "Long-term stress response"
* #episodic "Episodic" "Recurring stress episodes"
* #persistent "Persistent" "Continuous stress state"

CodeSystem: StressImpactCS
Id: stress-impact-cs
Title: "Stress Impact Code System"
Description: "Code system for stress impact levels"
* ^experimental = false
* ^url = "https://2rdoc.pt/ig/ios-lifestyle-medicine/CodeSystem/stress-impact-cs"
* #minimal "Minimal Impact" "Little to no interference with daily activities"
* #mild "Mild Impact" "Some interference with daily activities"
* #moderate "Moderate Impact" "Significant interference with daily activities"
* #severe "Severe Impact" "Major interference with daily activities"
* #extreme "Extreme Impact" "Unable to perform daily activities"



// ===== Conteúdo de: ReproductiveValueSets.fsh =====

ValueSet: ReproductiveGoalVS
Id: social-history-goal-vs
Title: "Reproductive Health Goals Value Set"
Description: "Goals related to social-history health tracking and planning"
* ^experimental = false

* ^status = #active
* ^date = "2024-03-19"

* $LOINC#8708-0 "Menstrual cycle length"
* $LOINC#55284-4 "Blood pressure"
* $LOINC#8310-5 "Body temperature"
* $LOINC#8302-2 "Body height"
* $LOINC#29463-7 "Body weight"
* $SCT#364311006 "Menstrual cycle monitoring"
* $SCT#289530006 "Reproductive health finding"

ValueSet: ReproductiveActivityVS
Id: social-history-activity-vs
Title: "Reproductive Health Activities Value Set"
Description: "Activities related to social-history health monitoring"
* ^experimental = false

* ^status = #active
* ^date = "2024-03-19"

* codes from system ReproductiveActivityCS

CodeSystem: ReproductiveActivityCS
Id: social-history-activity-cs
Title: "Reproductive Health Activities Code System"
Description: "Code system for social-history health monitoring activities"
* ^experimental = false

* ^status = #active
* ^caseSensitive = true

* #cycle-tracking "Cycle Tracking" "Track menstrual cycle dates and characteristics"
* #temp-monitoring "Temperature Monitoring" "Monitor basal body temperature"
* #symptom-tracking "Symptom Tracking" "Track social-history health symptoms"
* #vitals-monitoring "Vitals Monitoring" "Monitor vital signs related to social-history health"
* #fertility-signs "Fertility Signs" "Monitor fertility signs and indicators"
* #mood-tracking "Mood Tracking" "Track mood changes related to social-history cycle"
* #medication-log "Medication Log" "Log social-history health medications"
* #exercise-tracking "Exercise Tracking" "Track physical activity during cycle"



// ===== Conteúdo de: AuditFormatsValueSet.fsh =====

ValueSet: AuditFormatsValueSet
Id: audit-formats
Title: "Audit Formats Value Set"
Description: "Value set for audit format types"
* ^experimental = false
* ^url = "https://2rdoc.pt/ig/ios-lifestyle-medicine/ValueSet/audit-formats"
* ^status = #active
* ^date = "2024-12-27"
* include codes from system https://2rdoc.pt/ig/ios-lifestyle-medicine/CodeSystem/audit-formats

CodeSystem: AuditFormatsCodeSystem
Id: audit-formats
Title: "Audit Formats Code System"
Description: "Code system for audit format types"
* ^experimental = false
* ^url = "https://2rdoc.pt/ig/ios-lifestyle-medicine/CodeSystem/audit-formats"
* ^status = #active
* ^caseSensitive = true
* #text "Text Format"
* #structured "Structured Format"
* #mixed "Mixed Format"



// ===== Conteúdo de: MeasurementContextVS.fsh =====

ValueSet: MeasurementContextVS
Id: measurement-context-vs
Title: "Measurement Context Value Set"
Description: "Contexts in which measurements can be taken, including temporal and location-based contexts"
* ^experimental = false
* ^status = #active
* $SCT#272125009 "Assessment context value (qualifier value)"
* $SCT#307818003 "Before food"
* $SCT#307819006 "After food"
* $SCT#255214003 "After exercise"
* $SCT#264362003 "Time of day"



// ===== Conteúdo de: AuditLevelsValueSet.fsh =====

ValueSet: AuditLevelsValueSet
Id: audit-levels
Title: "Audit Levels Value Set"
Description: "Value set for audit level types"
* ^experimental = false
* ^url = "https://2rdoc.pt/ig/ios-lifestyle-medicine/ValueSet/audit-levels"
* ^status = #active
* ^date = "2024-12-27"
* include codes from system https://2rdoc.pt/ig/ios-lifestyle-medicine/CodeSystem/audit-levels

CodeSystem: AuditLevelsCodeSystem
Id: audit-levels
Title: "Audit Levels Code System"
Description: "Code system for audit level types"
* ^experimental = false
* ^url = "https://2rdoc.pt/ig/ios-lifestyle-medicine/CodeSystem/audit-levels"
* ^status = #active
* ^caseSensitive = true
* #low "Low Level"
* #medium "Medium Level"
* #high "High Level"



// ===== Conteúdo de: SocialInteractionValueSets.fsh =====

ValueSet: SocialInteractionTypeVS
Id: social-interaction-type-vs
Title: "Social Interaction Type Value Set"
Description: "Types of social interactions"
* ^experimental = false
* codes from system SocialInteractionTypeCS

ValueSet: SocialInteractionQualityVS
Id: social-interaction-quality-vs
Title: "Social Interaction Quality Value Set"
Description: "Quality measures for social interactions"
* ^experimental = false
* codes from system SocialInteractionQualityCS

ValueSet: SocialInteractionMediumVS
Id: social-interaction-medium-vs
Title: "Social Interaction Medium Value Set"
Description: "Mediums through which social interaction occurs"
* ^experimental = false
* codes from system SocialInteractionMediumCS

CodeSystem: SocialInteractionTypeCS
Id: social-interaction-type-cs
Title: "Social Interaction Type Code System"
Description: "Types of social interactions"
* ^experimental = false
* #family "Family Interaction" "Interaction with family members"
* #friends "Friend Interaction" "Interaction with friends"
* #professional "Professional Interaction" "Work-related interactions"
* #community "Community Interaction" "Community-based interactions"
* #group "Group Activity" "Organized group activities"
* #casual "Casual Interaction" "Casual social encounters"

CodeSystem: SocialInteractionQualityCS
Id: social-interaction-quality-cs
Title: "Social Interaction Quality Code System"
Description: "Quality measures for social interactions"
* ^experimental = false
* #meaningful "Meaningful" "Deep, meaningful interaction"
* #supportive "Supportive" "Supportive interaction"
* #neutral "Neutral" "Neither positive nor negative"
* #superficial "Superficial" "Surface-level interaction"
* #stressful "Stressful" "Stressful or difficult interaction"
CodeSystem: SocialInteractionMediumCS
Id: social-interaction-medium-cs
Title: "Social Interaction Medium Code System"
Description: "Mediums through which social interaction occurs"
* ^experimental = false
* #inPerson "In Person" "Face-to-face interaction"
* #meaningful "Meaningful" "Deep and significant interaction"
* #video "Video Call" "Video-based interaction"
* #voice "Voice Call" "Voice-only interaction"
* #text "Text Based" "Text-based communication"
* #social "Social Media" "Social media interaction"
* #mixed "Mixed Medium" "Multiple communication methods"



// ===== Conteúdo de: MoodValueSet.fsh =====

ValueSet: MoodValueSet
Id: mood
Title: "Mood Value Set"
Description: "Value set for mood states"
* ^experimental = false
* ^url = "https://2rdoc.pt/ig/ios-lifestyle-medicine/ValueSet/mood"
* ^status = #active

CodeSystem: MoodCodeSystem
Id: mood
Title: "Mood Code System"
Description: "Code system for mood states"
* ^url = "https://2rdoc.pt/ig/ios-lifestyle-medicine/CodeSystem/mood"
* ^status = #active
* ^caseSensitive = true
* #elevated "Elevated" "Mood is higher than normal"
* #neutral "Neutral" "Neither elevated nor depressed mood"
* #depressed "Depressed" "Mood is lower than normal"
* #anxious "Anxious" "Feeling worried or nervous"
* #irritable "Irritable" "Easily annoyed or angered"
* #calm "Calm" "Feeling peaceful and relaxed"



// ===== Conteúdo de: EnvironmentalContextVS.fsh =====

ValueSet: EnvironmentalContextValueSet
Id: environmental-context
Title: "Environmental Context Value Set"
Description: "Valid contexts for environmental measurements"
* ^experimental = false

* ^status = #active
* ^url = "https://2rdoc.pt/ig/ios-lifestyle-medicine/ValueSet/environmental-context"
* include codes from system https://2rdoc.pt/ig/ios-lifestyle-medicine/CodeSystem/environmental-context



// ===== Conteúdo de: ActivityTypeVS.fsh =====

ValueSet: PhysicalActivityTypeVS
Id: physical-activity-type-vs
Title: "Physical Activity Types Value Set"
Description: "Types of physical activities from iOS Health App"
* ^experimental = false

* ^status = #active

* $SNOMED#255604002 "Physical activity (observable entity)"
* $SNOMED#228557008 "Walking"
* $SNOMED#229058003 "Running"
* $SNOMED#266938001 "Swimming"
* $SNOMED#266940006 "Cycling"
* $SNOMED#32147004 "Regular exercise"



// ===== Conteúdo de: MindfulnessValueSets.fsh =====

ValueSet: EnvironmentTypeValueSet
Id: environment-type
Title: "Environment Type Value Set"
Description: "Value set for environmental context types"
* ^experimental = false
* ^url = "https://2rdoc.pt/ig/ios-lifestyle-medicine/ValueSet/environment-type"
* ^status = #active
* include codes from system https://2rdoc.pt/ig/ios-lifestyle-medicine/CodeSystem/environment-type

ValueSet: MindfulnessTypeValueSet
Id: mindfulness-type
Title: "Mindfulness Type Value Set"
Description: "Value set for types of mindfulness practices"
* ^experimental = false
* ^url = "https://2rdoc.pt/ig/ios-lifestyle-medicine/ValueSet/mindfulness-type"
* ^status = #active
* include codes from system https://2rdoc.pt/ig/ios-lifestyle-medicine/CodeSystem/mindfulness-type



// ===== Conteúdo de: BalanceStatusValueSet.fsh =====

ValueSet: BalanceStatusValueSet
Id: balance-status
Title: "Balance Status Value Set"
Description: "Value set for walking steadiness balance status"
* ^url = "https://2rdoc.pt/ig/ios-lifestyle-medicine/ValueSet/balance-status"
* ^status = #active
* include codes from system https://2rdoc.pt/ig/ios-lifestyle-medicine/CodeSystem/balance-status

CodeSystem: BalanceStatusCodeSystem
Id: balance-status
Title: "Balance Status Code System"
Description: "Code system for balance status types"
* ^experimental = false
* ^url = "https://2rdoc.pt/ig/ios-lifestyle-medicine/CodeSystem/balance-status"
* ^status = #active
* ^caseSensitive = true
* #veryStable "Very Stable"
* #stable "Stable"
* #slightlyUnstable "Slightly Unstable"
* #unstable "Unstable"
* #veryUnstable "Very Unstable"



// ===== Conteúdo de: SleepQualityVS.fsh =====

ValueSet: SleepQualityVS
Id: activity-quality-vs
Title: "Sleep Quality Value Set"
Description: "Qualitative assessments of activity quality including subjective measures"
* ^experimental = false
* ^status = #active
* $SCT#248254009 "Quality of activity (observable entity)"
* $SCT#248255005 "Sleeping well"
* $SCT#248256006 "Difficulty activitying"
* $SCT#301345002 "Poor activity pattern"
* $SCT#301346001 "Good activity pattern"




// ===== Conteúdo de: FertilityValueSets.fsh =====

ValueSet: CervicalMucusValueSet
Id: cervical-mucus-valueset
Title: "Cervical Mucus Value Set"
Description: "Value set for cervical mucus observations"
* ^experimental = false
* ^url = "https://2rdoc.pt/ig/ios-lifestyle-medicine/ValueSet/cervical-mucus-vs"
* ^status = #active
* include codes from system https://2rdoc.pt/ig/ios-lifestyle-medicine/CodeSystem/cervical-mucus-cs

CodeSystem: CervicalMucusCodeSystem
Id: cervical-mucus-cs
Description: "Code system for cervical mucus classification"Title: "Cervical Mucus Code System"
* ^url = "https://2rdoc.pt/ig/ios-lifestyle-medicine/CodeSystem/cervical-mucus-cs"
* ^status = #active
* ^caseSensitive = true
* #dry "Dry"
* #sticky "Sticky"
* #creamy "Creamy"
* #watery "Watery"
* #eggWhite "Egg White"

ValueSet: OvulationTestValueSet
Id: ovulation-test-valueset
Title: "Ovulation Test Value Set"
Description: "Value set for ovulation test results"
* ^experimental = false
* ^url = "https://2rdoc.pt/ig/ios-lifestyle-medicine/ValueSet/ovulation-test-vs"
* ^status = #active
* include codes from system https://2rdoc.pt/ig/ios-lifestyle-medicine/CodeSystem/ovulation-test-cs

CodeSystem: OvulationTestCodeSystem
Id: ovulation-test-cs
Description: "Code system for ovulation test results"Title: "Ovulation Test Code System"
* ^url = "https://2rdoc.pt/ig/ios-lifestyle-medicine/CodeSystem/ovulation-test-cs"
* ^status = #active
* ^caseSensitive = true
* #negative "Negative"
* #positive "Positive"
* #invalid "Invalid Test"

ValueSet: FertilityStatusValueSet
Id: fertility-status-valueset
Title: "Fertility Status Value Set"
Description: "Value set for fertility status"
* ^experimental = false
* ^url = "https://2rdoc.pt/ig/ios-lifestyle-medicine/ValueSet/fertility-status-vs"
* ^status = #active
* include codes from system https://2rdoc.pt/ig/ios-lifestyle-medicine/CodeSystem/fertility-status-cs

CodeSystem: FertilityStatusCodeSystem
Id: fertility-status-cs
Description: "Code system for fertility status indicators"Title: "Fertility Status Code System"
* ^url = "https://2rdoc.pt/ig/ios-lifestyle-medicine/CodeSystem/fertility-status-cs"
* ^status = #active
* ^caseSensitive = true
* #fertile "Fertile"
* #notFertile "Not Fertile"
* #uncertain "Uncertain"



// ===== Conteúdo de: MindfulnessSearchParameters.fsh =====

Instance: MindfulnessType
InstanceOf: SearchParameter
Description: "Example instance of MindfulnessType"Usage: #definition
* status = #active
* code = #mindfulness-type
* name = "MindfulnessType"
* description = "Search for mindfulness observations by practice type"
* base = #Observation
* type = #token
* expression = "Observation.component.where(code.coding.exists(system = 'http://snomed.info/sct' and code = '711415009')).value.as(CodeableConcept)"
* xpath = "f:Observation/f:component[f:code/f:coding[f:system/@value='http://snomed.info/sct' and f:code/f:coding/f:code/@value='711415009']]/f:valueCodeableConcept"
* xpathUsage = #normal



// ===== Conteúdo de: MindfulnessAlerts.fsh =====

Extension: AlertTiming
Id: alert-timing
Title: "Alert Timing Extension"
Description: "Defines when alerts should be triggered"
* value[x] only Timing
* valueTiming.repeat 1..1 MS
* valueTiming.repeat.frequency MS
* valueTiming.repeat.period MS
* valueTiming.repeat.periodUnit MS

Extension: AlertMessage
Id: alert-message
Title: "Alert Message Extension"
Description: "Defines the alert message content"
* value[x] only string

Profile: MindfulnessAlert
Parent: Basic
Id: mindfulness-alert
Title: "Mindfulness Alert"
Description: "Alert configuration for mindfulness sessions"

* code 1..1 MS
* code = https://2rdoc.pt/ig/ios-lifestyle-medicine/CodeSystem/mindfulness-alert-type#reminder "Mindfulness Reminder"

* extension contains
    alert-timing named alertTiming 0..1 MS and
    alert-message named alertMessage 1..1 MS

Instance: DailyMindfulnessAlert
InstanceOf: MindfulnessAlert
Title: "Daily Mindfulness Alert" 
Description: "Example of a daily mindfulness alert configuration"

* code = https://2rdoc.pt/ig/ios-lifestyle-medicine/CodeSystem/mindfulness-alert-type#reminder "Mindfulness Reminder"
* extension[alertTiming].valueTiming.repeat
  * frequency = 1
  * period = 1
  * periodUnit = #d
* extension[alertMessage].valueString = "Time for your daily mindfulness practice"



// ===== Conteúdo de: MindfulnessTransforms.fsh =====

Instance: MindfulnessHealthKitTransform
InstanceOf: StructureMap
Usage: #definition
Title: "HealthKit to FHIR Mindfulness Transform"

* status = #draft
* name = "MindfulnessHealthKitTransform"
* structure[0]
  * url = "https://2rdoc.pt/ig/ios-lifestyle-medicine/StructureDefinition/healthkit-mindfulness"
  * mode = #source
  * documentation = "HealthKit mindfulness session structure"

* structure[1]
  * url = "http://hl7.org/fhir/StructureDefinition/Observation"
  * mode = #target
  * documentation = "FHIR Observation resource"

* group[0]
  * name = "MindfulnessSessionToObservation"
  * typeMode = #none
  * input[0]
    * name = "source"
    * type = "HealthKitMindfulness"
    * mode = #source
  * input[1]
    * name = "target"
    * type = "Observation"
    * mode = #target
  * rule[0]
    * name = "Session"
    * source[0]
      * context = "source"
      * element = "startDate"
    * target[0]
      * context = "target"
      * element = "effectiveDateTime"
  * rule[1]
    * name = "Duration"
    * source[0]
      * context = "source"
      * element = "duration"
    * target[0]
      * context = "target"
      * element = "component.where(code.coding.code='118682006').valueQuantity"

Instance: MindfulnessCSVTransform
InstanceOf: StructureMap
Usage: #definition
Title: "CSV to FHIR Mindfulness Transform"

* status = #draft
* name = "MindfulnessCSVTransform"
* structure[0]
  * url = "https://2rdoc.pt/ig/ios-lifestyle-medicine/StructureDefinition/csv-mindfulness"
  * mode = #source
  * documentation = "CSV mindfulness data structure"

* group[0]
  * name = "CSVToMindfulnessObservation"
  * typeMode = #none
  * input[0]
    * name = "source"
    * type = "CSVMindfulness"
    * mode = #source
  * input[1]
    * name = "target"
    * type = "Observation"
    * mode = #target
  * rule[0]
    * name = "MapDatetime"
    * source[0]
      * context = "source"
      * element = "date,time"
    * target[0]
      * context = "target"
      * element = "effectiveDateTime"
      * transform = #append

RuleSet: TransformValidationRules
* rule[+]
  * name = "ValidateStatus"
  * source[0]
    * context = "target"
    * element = "status"
  * assert[0]
    * description = "Status must be final"
    * expression = "%status = 'final'"

* rule[+]
  * name = "ValidateCode"
  * source[0]
    * context = "target"
    * element = "code"
  * assert[0]
    * description = "Must use SNOMED CT code"
    * expression = "%code.system = 'http://snomed.info/sct'"



// ===== Conteúdo de: MindfulnessAudit.fsh =====

Extension: AuditLevelExtension
Id: audit-level
Title: "Audit Level Extension"
Description: "Level of detail for audit records"
* value[x] only code
* valueCode from https://2rdoc.pt/ig/ios-lifestyle-medicine/ValueSet/audit-levels (required)

Extension: AuditRetentionExtension
Id: audit-retention
Title: "Audit Retention Extension" 
Description: "Period to retain audit records"
* value[x] only Duration

Extension: AuditFormatExtension
Id: audit-format
Title: "Audit Format Extension"
Description: "Format for audit records"
* value[x] only code
* valueCode from https://2rdoc.pt/ig/ios-lifestyle-medicine/ValueSet/audit-formats (required)

Profile: MindfulnessAudit
Parent: Basic
Id: mindfulness-audit
Title: "Mindfulness Audit"
Description: "Audit record for mindfulness sessions"

* code 1..1 MS
* code = https://2rdoc.pt/ig/ios-lifestyle-medicine/CodeSystem/mindfulness-audit-type#session "Session Audit"
* created 1..1 MS

* extension contains
    audit-level named auditLevel 1..1 MS and
    audit-retention named auditRetention 1..1 MS and
    audit-format named auditFormat 1..1 MS

Instance: MindfulnessAuditExample
InstanceOf: MindfulnessAudit
Title: "Example Mindfulness Audit"
Description: "Example of a mindfulness session audit record"

* code = https://2rdoc.pt/ig/ios-lifestyle-medicine/CodeSystem/mindfulness-audit-type#session "Session Audit"
* created = "2024-03-15"
* extension[auditLevel].valueCode = #detailed
* extension[auditRetention].valueDuration = 90 'days'
* extension[auditFormat].valueCode = #fhir



// ===== Conteúdo de: EnvironmentalExamples.fsh =====

Instance: NoiseExposureExample
InstanceOf: NoiseExposureObservation
Usage: #example
Description: "Noise exposure observation example"
Title: "Noise Exposure Measurement Example"

* meta.security = http://terminology.hl7.org/CodeSystem/v3-Confidentiality#N
* status = #final
* performer = Reference(Practitioner/PractitionerExample)
* category = http://terminology.hl7.org/CodeSystem/observation-category#environment
* code = $LOINC#28573-7 "Noise exposure time"
* subject = Reference(Patient/PatientExample)
* effectiveDateTime = "2024-03-19T15:30:00Z"
* device = Reference(Device/iphone-example)
* method = http://snomed.info/sct#37016008 "Automatic measurement"

* component[level]
  * code.coding[0] = $LOINC#89020-2 "Environmental noise average"
  * valueQuantity = 85 'dB'
  * interpretation = http://terminology.hl7.org/CodeSystem/v3-ObservationInterpretation#H "High"

* component[duration]
  * code.coding[0] = $LOINC#89021-0 "Environmental noise duration"
  * valueQuantity = 120 'min'

* component[peakLevel]
  * code.coding[0] = $LOINC#89024-4 "Peak sound level"
  * valueQuantity = 95 'dB'

* component[backgroundNoise]
  * code.coding[0] = $LOINC#89025-1 "Background noise level"
  * valueQuantity = 45 'dB'

* note.text = "Measurement taken during urban commute"

Instance: UVExposureExample
InstanceOf: UVExposureObservation
Usage: #example
Description: "UV exposure observation example"
Title: "UV Exposure Measurement Example"

* meta.security = http://terminology.hl7.org/CodeSystem/v3-Confidentiality#N
* status = #final
* category = http://terminology.hl7.org/CodeSystem/observation-category#environment
* code = $LOINC#28574-5 "UV exposure"
* subject = Reference(Patient/PatientExample)
* effectiveDateTime = "2024-03-19T12:00:00Z"
* device = Reference(Device/iphone-example)
* method = http://snomed.info/sct#37016008 "Automatic measurement"

* component[index]
  * code.coding[0] = $LOINC#89022-8 "UV index"
  * valueQuantity = 8 '{index}'
  * interpretation = http://terminology.hl7.org/CodeSystem/v3-ObservationInterpretation#H "High"

* component[duration]
  * code.coding[0] = $LOINC#89023-6 "UV exposure duration"
  * valueQuantity = 45 'min'

* component[timeOfDay]
  * code.coding[0] = $LOINC#89026-9 "Time of exposure"
  * valueDateTime = "2024-03-19T12:00:00Z"

* component[intensity]
  * code.coding[0] = $LOINC#89027-7 "UV intensity"
  * valueQuantity = 0.3 'W/m2'

* note.text = "Measurement taken during outdoor activity"

Instance: EnvironmentalDeviceExample
InstanceOf: Device
Usage: #example
Description: "Environmental monitoring device example"
Title: "Environmental Monitoring Device"

* identifier.system = "https://2rdoc.pt/ig/ios-lifestyle-medicine/devices"
* identifier.value = "iPhone-ENV-001"
* manufacturer = "Apple Inc."
* modelNumber = "iPhone 15 Pro"
* type = $SCT#706689003 "Environmental monitoring device"
* status = #active



// ===== Conteúdo de: NutritionExamples.fsh =====

Instance: NutritionQuestionnaireResponseExample
InstanceOf: QuestionnaireResponse
Usage: #example
Description: "Nutrition questionnaire response example"
Title: "Daily Nutrition Questionnaire Response Example"

* questionnaire = "https://2rdoc.pt/ig/ios-lifestyle-medicine/Questionnaire/daily-nutrition"
* status = #completed
* subject = Reference(Patient/PatientExample)
* authored = "2024-12-14T20:00:00Z"

* item[0]
  * linkId = "water_intake"
  * answer.valueQuantity = 2000 'mL'

* item[1]
  * linkId = "meal_record"

  * item[0]
    * linkId = "meal_time"
    * answer.valueDateTime = "2024-12-14T12:00:00Z"

  * item[1]
    * linkId = "meal_type"
    * answer.valueString = "Lunch"

  * item[2]
    * linkId = "calories"
    * answer.valueInteger = 650

  * item[3]
    * linkId = "macronutrients"
   
    * item[0]
      * linkId = "carbs"
      * answer.valueDecimal = 75
   
    * item[1]
      * linkId = "protein"
      * answer.valueDecimal = 30
   
    * item[2]
      * linkId = "fat"
      * answer.valueDecimal = 25

* item[2]
  * linkId = "caffeine"

  * item[0]
    * linkId = "caffeine_amount"
    * answer.valueInteger = 80

  * item[1]
    * linkId = "caffeine_source"
    * answer.valueString = "Coffee"



// ===== Conteúdo de: SleepExamples.fsh =====

Instance: SleepObservationExample1
InstanceOf: SleepObservation
Usage: #example
Description: "Sleep observation example"
Title: "Example of Sleep Record"
 
* status = #final
* category = http://terminology.hl7.org/CodeSystem/observation-category#activity
* code = $LOINC#93832-4 "Sleep pattern panel"
* subject = Reference(PatientExample)
* effectivePeriod.start = "2024-03-19T22:00:00Z"
* effectivePeriod.end = "2024-03-20T06:30:00Z"
* device = Reference(DeviceSleepMonitor)
 
* component[timeInBed].code = $LOINC#93831-6 "Time in bed"
* component[timeInBed].valueQuantity = 510 'min' "minute"
* component[timeInBed].valueQuantity.system = $UCUM
* component[timeInBed].valueQuantity.unit = "minute"
 
* component[totalSleepTime].code = $LOINC#93833-2 "Sleep duration"
* component[totalSleepTime].valueQuantity = 472 'min' "minute"
* component[totalSleepTime].valueQuantity.system = $UCUM
* component[totalSleepTime].valueQuantity.unit = "minute"
 
* component[deepSleep].code = $LOINC#93834-0 "Deep activity duration"
* component[deepSleep].valueQuantity = 95 'min' "minute"
* component[deepSleep].valueQuantity.system = $UCUM
* component[deepSleep].valueQuantity.unit = "minute"
 
* component[remSleep].code = $LOINC#93835-7 "REM activity duration"
* component[remSleep].valueQuantity = 118 'min' "minute"
* component[remSleep].valueQuantity.system = $UCUM
* component[remSleep].valueQuantity.unit = "minute"
 
* component[lightSleep].code = $LOINC#93836-5 "Light activity duration"
* component[lightSleep].valueQuantity = 259 'min' "minute"
* component[lightSleep].valueQuantity.system = $UCUM
* component[lightSleep].valueQuantity.unit = "minute"
 
* component[respiratoryRate].code = $LOINC#9279-1 "Respiratory rate"
* component[respiratoryRate].valueQuantity = 14 '/min' "per minute"
* component[respiratoryRate].valueQuantity.system = $UCUM
* component[respiratoryRate].valueQuantity.unit = "per minute"
 
* component[heartRateVariability].code = $LOINC#80404-7 "R-R interval.standard deviation (Heart rate variability)"
* component[heartRateVariability].valueQuantity = 45 'ms' "millisecond"
* component[heartRateVariability].valueQuantity.system = $UCUM
* component[heartRateVariability].valueQuantity.unit = "millisecond"
 
* component[interruptions].code = $LOINC#93837-3 "Number of awakenings during activity"
* component[interruptions].valueQuantity = 3 '{count}' "count"
* component[interruptions].valueQuantity.system = $UCUM
* component[interruptions].valueQuantity.unit = "count"

Instance: DeviceSleepMonitor
InstanceOf: Device
Usage: #example
Description: "Sleep monitor device example"
Title: "Sleep Monitoring Device"
* deviceName.name = "Sleep Quality Monitor"
* deviceName.type = #user-friendly-name
* manufacturer = "HealthTech Devices"
* modelNumber = "SQM-2024"
* type = $SCT#706172001 "Sleep monitor"



// ===== Conteúdo de: StressExamples.fsh =====

Instance: StressLevelExample
InstanceOf: StressLevelProfile
Usage: #example
Description: "Stress level observation example"
Title: "Stress Level Measurement Example"

* status = #final
* category = http://terminology.hl7.org/CodeSystem/observation-category#vital-signs
* code = $LOINC#89592-0 "Stress level score"
* subject = Reference(Patient/PatientExample)
* effectiveDateTime = "2024-01-03T15:30:00Z"
* valueQuantity = 7 '{score}' "score"

* component[physiologicalStress].valueQuantity = 6 '{score}' "score"
* component[psychologicalStress].valueQuantity = 8 '{score}' "score"
* component[chronicity].valueCodeableConcept = StressChronicityCS#subacute
* component[impact].valueCodeableConcept = StressImpactCS#moderate

* extension[triggers].valueCodeableConcept = StressTriggersCS#work
* extension[coping].valueCodeableConcept = StressCopingCS#meditation



// ===== Conteúdo de: PatientExample.fsh =====

Instance: PatientExample
InstanceOf: Patient
Usage: #example
Description: "Patient resource example"
* identifier[0].system = "urn:oid:2.16.858.1.1.1"
* identifier[0].value = "12345"
* name.given = "John"
* name.family = "Doe"
* gender = #male
* birthDate = "1970-01-01"



// ===== Conteúdo de: MobilityExamples.fsh =====

Profile: WalkingSteadinessObservation
Parent: MobilityProfile
Id: walking-steadiness-observation
Description: "Profile for assessing walking steadiness and balance"Title: "Walking Steadiness Observation Profile"

* code = $LOINC#LA32-8 "Balance"
* component contains
    balanceScore 0..1 MS and
    balanceStatus 0..1 MS

* component[balanceScore]
  * code = $LOINC#LA32-8 "Balance score"
  * valueQuantity.system = $UCUM
  * valueQuantity.code = #%

* component[balanceStatus]
  * code = $LOINC#LA32-9 "Balance status"
  * valueCodeableConcept from https://2rdoc.pt/ig/ios-lifestyle-medicine/ValueSet/balance-status (required)

Profile: WalkingSpeedObservation
Parent: MobilityProfile
Id: walking-speed-observation
Description: "Profile for measuring walking speed as part of mobility assessment"Title: "Walking Speed Observation Profile"

* code = $LOINC#LA29042-4 "Walking speed"
* component contains
    speed 0..1 MS and
    distance 0..1 MS

* component[speed]
  * code = $LOINC#LA29042-4 "Walking speed measurement"
  * valueQuantity.system = $UCUM
  * valueQuantity.code = #m/s

* component[distance]
  * code = $LOINC#LA29043-2 "Walking distance"
  * valueQuantity.system = $UCUM
  * valueQuantity.code = #m

Instance: WalkingSteadinessExample
InstanceOf: WalkingSteadinessObservation
Usage: #example
Description: "Walking steadiness observation example"
Title: "Walking Steadiness Measurement Example"

* status = #final
* category = http://terminology.hl7.org/CodeSystem/observation-category#activity
* code = $LOINC#LA32-8 "Balance"
* subject = Reference(Patient/PatientExample)
* effectiveDateTime = "2024-03-19T15:30:00Z"
* valueQuantity = 85 '1' "score"
* device = Reference(Device/iphone-example)

* component[balanceScore].valueQuantity = 85 '%' "percent"
* component[balanceStatus].valueCodeableConcept = $LOINC#LA32-10 "OK"

Instance: WalkingSpeedExample
InstanceOf: WalkingSpeedObservation
Usage: #example
Description: "Walking speed observation example"
Title: "Walking Speed Measurement Example"

* status = #final
* category = http://terminology.hl7.org/CodeSystem/observation-category#activity
* code = $LOINC#LA29042-4 "Walking speed"
* subject = Reference(Patient/PatientExample)
* effectiveDateTime = "2024-03-19T15:30:00Z"
* valueQuantity = 1.2 'm/s' "meters per second"
* device = Reference(Device/iphone-example)

* component[speed].valueQuantity = 1.2 'm/s' "meters per second"
* component[distance].valueQuantity = 10 'm' "meters"



// ===== Conteúdo de: PhysicalActivityExamples.fsh =====

Instance: PhysicalActivityExample1
InstanceOf: PhysicalActivityObservation
Usage: #example
Description: "Physical activity observation example"
Title: "Example of Walking Activity"
* status = #final
* category = http://terminology.hl7.org/CodeSystem/observation-category#activity
* code = $SNOMED#228557008 "Walking"
* subject = Reference(PatientExample)
* effectiveDateTime = "2024-03-19T15:30:00Z"
* device = Reference(DeviceActivityTracker)
* component[steps].code = $LOINC#55423-8 "Number of steps in 24 hour Measured"
* component[steps].valueQuantity = 8546 '1' "count"
* component[steps].valueQuantity.system = $UCUM
* component[steps].valueQuantity.unit = "count"
* component[distance].code = $LOINC#55430-3 "Distance walked"
* component[distance].valueQuantity = 6.2 'km' "kilometer"
* component[distance].valueQuantity.system = $UCUM
* component[distance].valueQuantity.unit = "kilometer"
* component[duration].code = $LOINC#55411-3 "Exercise duration"
* component[duration].valueQuantity = 72 'min' "minute"
* component[duration].valueQuantity.system = $UCUM
* component[duration].valueQuantity.unit = "minute"
* component[energy].code = $LOINC#55424-6 "Energy expenditure"
* component[energy].valueQuantity = 320 'kcal' "kilocalorie"
* component[energy].valueQuantity.system = $UCUM
* component[energy].valueQuantity.unit = "kilocalorie"

Instance: DeviceActivityTracker
InstanceOf: Device
Usage: #example
Description: "Activity tracker device example"
Title: "Activity Tracking Device"
* deviceName.name = "Health Activity Tracker"
* deviceName.type = #user-friendly-name
* manufacturer = "HealthTech Devices"
* modelNumber = "HAT-2024"
* type = $SCT#258158006 "Breathing rate"



// ===== Conteúdo de: BodyMetricsExamples.fsh =====

Instance: WeightExample
InstanceOf: WeightObservation
Usage: #example
Description: "Weight observation example"
Title: "Weight Measurement Example"
* status = #final
* category = http://terminology.hl7.org/CodeSystem/observation-category#vital-signs
* code = $LOINC#29463-7 "Body weight"
* subject = Reference(PatientExample)
* performer = Reference(PractitionerExample)
* effectiveDateTime = "2024-03-19T08:00:00Z"
* valueQuantity = 70.5 'kg' "kilogram"
* valueQuantity.system = $UCUM
* valueQuantity.unit = "kilogram"
* device = Reference(SmartScale)

Instance: HeightExample
InstanceOf: HeightObservation
Usage: #example
Description: "Height observation example"
Title: "Height Measurement Example"
* status = #final
* category = http://terminology.hl7.org/CodeSystem/observation-category#vital-signs
* code = $LOINC#8302-2 "Body height"
* subject = Reference(PatientExample)
* performer = Reference(PractitionerExample)
* effectiveDateTime = "2024-03-19T08:00:00Z"
* valueQuantity = 175 'cm' "centimeter"
* valueQuantity.system = $UCUM
* valueQuantity.unit = "centimeter"

Instance: BMIExample
InstanceOf: BMIObservation
Usage: #example
Description: "Body Mass Index observation example"
Title: "BMI Calculation Example"
* status = #final
* category = http://terminology.hl7.org/CodeSystem/observation-category#vital-signs
* code = $LOINC#39156-5 "Body mass index (BMI) [Ratio]"
* subject = Reference(PatientExample)
* performer = Reference(PractitionerExample)
* effectiveDateTime = "2024-03-19T08:00:00Z"
* valueQuantity = 23.0 'kg/m2' "kilogram per square meter"
* valueQuantity.system = $UCUM
* valueQuantity.unit = "kilogram per square meter"
* derivedFrom[0] = Reference(Observation/WeightExample)
* derivedFrom[1] = Reference(Observation/HeightExample)

Instance: BodyCompositionExample
InstanceOf: BodyCompositionObservation
Usage: #example
Description: "Body composition observation example"
Title: "Body Composition Measurement Example" 
* status = #final
* category = http://terminology.hl7.org/CodeSystem/observation-category#vital-signs
* code = $LOINC#88365-2 "Body composition panel"
* subject = Reference(PatientExample)
* performer = Reference(PractitionerExample)
* effectiveDateTime = "2024-03-19T08:00:00Z"
* device = Reference(BioimpedanceAnalyzer)

* component[bodyFat].code = $LOINC#41982-0 "Percentage body fat"
* component[bodyFat].valueQuantity = 22.5 '%' "percent"
* component[bodyFat].valueQuantity.system = $UCUM
* component[bodyFat].valueQuantity.unit = "percent"

* component[leanMass].code = $LOINC#291-7 "Lean body mass"
* component[leanMass].valueQuantity = 54.6 'kg' "kilogram"
* component[leanMass].valueQuantity.system = $UCUM
* component[leanMass].valueQuantity.unit = "kilogram"

* component[bodyWater].code = $LOINC#73708-0 "Total body water"
* component[bodyWater].valueQuantity = 39.2 'L' "liter"
* component[bodyWater].valueQuantity.system = $UCUM
* component[bodyWater].valueQuantity.unit = "liter"

* component[muscleMass].code = $LOINC#73713-0 "Muscle mass"
* component[muscleMass].valueQuantity = 51.8 'kg' "kilogram"
* component[muscleMass].valueQuantity.system = $UCUM
* component[muscleMass].valueQuantity.unit = "kilogram"

* component[boneMass].code = $LOINC#73711-4 "Bone mass"
* component[boneMass].valueQuantity = 2.8 'kg' "kilogram"
* component[boneMass].valueQuantity.system = $UCUM
* component[boneMass].valueQuantity.unit = "kilogram"

Instance: SmartScale
InstanceOf: Device
Usage: #example
Description: "Smart scale device example"
Title: "Smart Scale Device"
* deviceName.name = "Smart Body Analyzer"
* deviceName.type = #user-friendly-name
* manufacturer = "HealthTech Devices"
* modelNumber = "SBA-2024"
* type = $SCT#5159002 "Physiologic monitoring system"

Instance: BioimpedanceAnalyzer  
InstanceOf: Device
Usage: #example
Description: "Bioimpedance analyzer device example"
Title: "Bioimpedance Analyzer Device"
* deviceName.name = "Professional Body Composition Analyzer"
* deviceName.type = #user-friendly-name
* manufacturer = "MedTech Solutions"
* modelNumber = "BCA-Pro"
* type = $SCT#706767009 "Patient data recorder"



// ===== Conteúdo de: SymptomExamples.fsh =====

Instance: ChronicSymptomExample
InstanceOf: Observation
Usage: #example
Description: "Chronic symptom observation example"
* status = #final
* category = http://terminology.hl7.org/CodeSystem/observation-category#survey
* code = $SCT#267036007 "Fatigue"
* subject = Reference(Patient/PatientExample)
* performer = Reference(Practitioner/PractitionerExample)
* effectiveDateTime = "2024-03-19T14:00:00Z"
// ... resto do exemplo ...

Instance: ExampleSymptomSeverity
InstanceOf: Observation
Usage: #example
Description: "Symptom severity observation example"
* status = #final
* category = http://terminology.hl7.org/CodeSystem/observation-category#survey
* code = $SCT#246604007 "Symptom severity"
* subject = Reference(Patient/PatientExample)
* performer = Reference(Practitioner/PractitionerExample)
* effectiveDateTime = "2024-03-19T10:30:00Z"
// ... resto do exemplo ...



// ===== Conteúdo de: SocialInteractionExamples.fsh =====

Instance: SocialInteractionExample
InstanceOf: SocialInteractionProfile
Usage: #example
Description: "Social interaction observation example"
Title: "Social Interaction Example"

* status = #final
* category = http://terminology.hl7.org/CodeSystem/observation-category#social-history
* code = $LOINC#96766-1 "Social interaction pattern"
* subject = Reference(Patient/PatientExample)
* effectiveDateTime = "2024-01-03T14:00:00Z"
* valueCodeableConcept = SocialInteractionTypeCS#family

* component[duration].valueQuantity = 120 'min' "minutes"
* component[quality].valueCodeableConcept = SocialInteractionQualityCS#meaningful
* component[medium].valueCodeableConcept = SocialInteractionMediumCS#inPerson
* component[participants].valueInteger = 4

* extension[context].valueCodeableConcept = SocialContextCS#home
* extension[support].valueCodeableConcept = SocialSupportCS#strong
* extension[activity].valueCodeableConcept = SocialActivityCS#meal



// ===== Conteúdo de: VitalSignsExamples.fsh =====

Instance: HeartRateExample
InstanceOf: HeartRateObservation
Usage: #example
Description: "Heart rate observation example"
Title: "Heart Rate Measurement Example"
* status = #final
* code = $LOINC#8867-4 "Heart rate"
* subject = Reference(PatientExample)
* effectiveDateTime = "2024-03-19T15:30:00Z"
* valueQuantity = 72 '/min' "per minute"
* valueQuantity.system = $UCUM
* valueQuantity.unit = "per minute"
* device = Reference(DeviceHeartRateMonitor)
* performer = Reference(PractitionerExample)
* component[heartRateVariability].code = $LOINC#80404-7 "R-R interval.standard deviation (Heart rate variability)"
* component[heartRateVariability].valueQuantity = 45 'ms' "millisecond"
* component[heartRateVariability].valueQuantity.system = $UCUM
* component[heartRateVariability].valueQuantity.unit = "millisecond"

Instance: BloodPressureExample
InstanceOf: BloodPressureObservation
Usage: #example
Description: "Blood pressure observation example"
Title: "Blood Pressure Measurement Example"
* status = #final
* code = $LOINC#85354-9 "Blood pressure panel with all children optional"
* subject = Reference(PatientExample)
* effectiveDateTime = "2024-03-19T15:30:00Z"
* device = Reference(DeviceBloodPressureMonitor)
* performer = Reference(PractitionerExample)
* component[systolic].code = $LOINC#8480-6 "Systolic blood pressure"
* component[systolic].valueQuantity = 120 'mm[Hg]' "millimeter of mercury"
* component[systolic].valueQuantity.system = $UCUM
* component[systolic].valueQuantity.unit = "millimeter of mercury"
* component[diastolic].code = $LOINC#8462-4 "Diastolic blood pressure"
* component[diastolic].valueQuantity = 80 'mm[Hg]' "millimeter of mercury"
* component[diastolic].valueQuantity.system = $UCUM
* component[diastolic].valueQuantity.unit = "millimeter of mercury"

Instance: DeviceHeartRateMonitor
InstanceOf: Device
Usage: #example
Description: "Heart rate monitor device example"
Title: "Heart Rate Monitor Device"
* deviceName.name = "Continuous Heart Rate Monitor"
* deviceName.type = #user-friendly-name
* manufacturer = "HealthTech Devices"
* modelNumber = "HRM-2024"
* type = $SCT#720737000 "Pulse rate monitoring device"

Instance: DeviceBloodPressureMonitor
InstanceOf: Device
Usage: #example
Description: "Blood pressure monitor device example"
Title: "Blood Pressure Monitor Device"
* deviceName.name = "Digital Blood Pressure Monitor"
* deviceName.type = #user-friendly-name
* manufacturer = "HealthTech Devices"
* modelNumber = "BPM-2024"
* type = $SCT#43770009 "Blood pressure monitor"



// ===== Conteúdo de: PractitionerExample.fsh =====

Instance: PractitionerExample
InstanceOf: Practitioner
Usage: #example
Description: "Practitioner resource example"
* identifier[0].system = "http://terminology.hl7.org/CodeSystem/practitioner-identifier"
* identifier[0].value = "9941339108"
* name.given = "Jane"
* name.family = "Smith"



// ===== Conteúdo de: MindfulnessCompleteExamples.fsh =====

Instance: CompleteMindfulnessSession
InstanceOf: MindfulnessObservation
Usage: #example
Description: "Complete mindfulness session observation example"
Title: "Complete Mindfulness Session Example"

* status = #final
* code = $SCT#285854004 "Emotion"
* subject = Reference(Patient/PatientExample)
* effectiveDateTime = "2024-03-19T08:00:00Z"
* performer = Reference(Practitioner/PractitionerExample)

* component[sessionDuration].code = $SCT#118682006 "Duration"
* component[sessionDuration].valueQuantity = 20 'min'

* component[stressLevel].code = $SCT#725854004 "Assessment of stress level"
* component[stressLevel].valueInteger = 3

* component[moodState].code = $SCT#373931001 "Mood finding"
* component[moodState].valueCodeableConcept = $SCT#130991005 "Neutral mood"

* component[relaxationResponse].code = $SCT#276241001 "Relaxation technique"
* component[relaxationResponse].valueString = "Deep breathing exercises with progressive relaxation"

* component[mindfulnessType].code = $SCT#285854004 "Emotion"
* component[mindfulnessType].valueCodeableConcept = $SCT#285854004 "Emotion"

* extension[mindfulness-context].extension[location].valueString = "Home meditation room"
* extension[mindfulness-context].extension[environment].valueCodeableConcept = #quiet "Quiet Space"
* extension[mindfulness-context].extension[guidance].valueBoolean = true

Instance: CompleteMindfulnessResponse
InstanceOf: QuestionnaireResponse
Usage: #example
Description: "Complete mindfulness questionnaire response example"
Title: "Complete Mindfulness Session Response"

* questionnaire = "https://2rdoc.pt/ig/ios-lifestyle-medicine/Questionnaire/daily-mindfulness"
* status = #completed
* subject = Reference(Patient/PatientExample)
* authored = "2024-03-19T08:30:00Z"

* item[0]
  * linkId = "mindful_session"
  * item[0]
    * linkId = "session_duration"
    * answer.valueInteger = 20
  * item[1]
    * linkId = "practice_type"
    * answer.valueString = "Meditation"

* item[1]
  * linkId = "mood_assessment"
  * item[0]
    * linkId = "current_mood"
    * answer.valueCoding = $SCT#130991005 "Neutral mood"
  * item[1]
    * linkId = "mood_intensity"
    * answer.valueInteger = 3

* item[2]
  * linkId = "stress_assessment"
  * item[0]
    * linkId = "stress_level"
    * answer.valueInteger = 3
  * item[1]
    * linkId = "stress_symptoms"
    * answer[0].valueString = "Slight tension"

* item[3]
  * linkId = "relaxation"
  * item[0]
    * linkId = "relaxation_duration"
    * answer.valueInteger = 15
  * item[1]
    * linkId = "relaxation_technique"
    * answer.valueString = "Deep breathing"



// ===== Conteúdo de: MindfulnessExamples.fsh =====

Instance: MindfulnessObservationExample
InstanceOf: MindfulnessObservation
Usage: #example
Description: "Mindfulness observation example"
Title: "Example of Mindfulness Session Observation"

* status = #final
* code = $SCT#285854004 "Emotion"
* subject = Reference(Patient/PatientExample)
* effectiveDateTime = "2024-03-19T09:30:00Z"
* performer = Reference(Practitioner/PractitionerExample)

* component[sessionDuration].code = $SCT#118682006 "Duration"
* component[sessionDuration].valueQuantity = 20 'min'

* component[stressLevel].code = $SCT#725854004 "Assessment of stress level"
* component[stressLevel].valueInteger = 4

* component[moodState].code = $SCT#373931001 "Mood finding"
* component[moodState].valueCodeableConcept = $SCT#130991005 "Neutral mood"

* component[relaxationResponse].code = $SCT#276241001 "Relaxation technique"
* component[relaxationResponse].valueString = "Deep breathing exercises helped reduce tension"

* component[mindfulnessType].code = $SCT#285854004 "Emotion"
* component[mindfulnessType].valueCodeableConcept = $SCT#285854004 "Emotion"

// New example for MindfulnessQuestionnaire
Instance: MindfulnessQuestionnaireExample
InstanceOf: Questionnaire
Usage: #example
Title: "Example of Mindfulness Questionnaire"

* url = "https://2rdoc.pt/ig/ios-lifestyle-medicine/Questionnaire/mindfulness-example"
* status = #active
* title = "Daily Mindfulness Assessment"
* version = "1.0"
* name = "MindfulnessQuestionnaireExample"
* date = "2024-03-19"
* description = "Example questionnaire for daily mindfulness practice assessment"

* item[0]
  * linkId = "session_details"
  * text = "Session Details"
  * type = #group
  
  * item[0]
    * linkId = "duration"
    * text = "Duration (minutes)"
    * type = #integer
    * required = true
    
  * item[1]
    * linkId = "technique"
    * text = "Technique Used"
    * type = #choice
    * required = true
    * answerOption[0].valueString = "Mindful Breathing"
    * answerOption[1].valueString = "Body Scan"
    * answerOption[2].valueString = "Walking Meditation"



// ===== Conteúdo de: ReproductiveExamples.fsh =====

Instance: ExampleReproductiveActivity
InstanceOf: CarePlan
Usage: #example
Description: "Reproductive health care plan example"
* status = #active
* intent = #plan
* subject = Reference(Patient/PatientExample)
* activity.detail.kind = #ServiceRequest
* activity.detail.code = ReproductiveActivityCS#cycle-tracking
* activity.detail.status = #scheduled



// ===== Conteúdo de: MissingResources.fsh =====

// ====== Recursos Faltantes para Resolver Links Quebrados ======

Instance: example
InstanceOf: Patient
Usage: #example
* identifier.system = "http://example.org/patients"
* identifier.value = "example-patient"
* name.family = "Example"
* name.given = "Patient"
* gender = #unknown
* birthDate = "1970-01-01"

Instance: osa-practitioner-kyle-anydoc
InstanceOf: Practitioner
Usage: #example
* identifier.system = "http://example.org/practitioners"
* identifier.value = "kyle-anydoc"
* name.family = "Anydoc"
* name.given = "Kyle"
* name.prefix = "Dr."

Instance: PatientMindfulness
InstanceOf: Patient
Usage: #example
* identifier.system = "http://example.org/patients"
* identifier.value = "mindfulness-patient"
* name.family = "Mindfulness"
* name.given = "Test"
* gender = #other
* birthDate = "1980-01-01"

Instance: Org2RDoc
InstanceOf: Organization
Usage: #example
* identifier.system = "http://example.org/organizations"
* identifier.value = "2rdoc"
* name = "2RDoc Healthcare Solutions"
* active = true



// ===== Conteúdo de: MindfulnessWorkflow.fsh =====

Profile: MindfulnessSchedule
Parent: Basic
Id: mindfulness-schedule
Title: "Mindfulness Schedule"
Description: "Schedule configuration for mindfulness sessions"

* code 1..1 MS
* code = https://2rdoc.pt/ig/ios-lifestyle-medicine/CodeSystem/mindfulness-schedule-type#recurring "Recurring Schedule"

Extension: MindfulnessScheduleTiming
Id: mindfulness-schedule-timing
Title: "Mindfulness Schedule Timing"
Description: "Timing configuration for mindfulness sessions"
* value[x] only Timing

Instance: WeeklyMindfulnessSchedule
InstanceOf: MindfulnessSchedule
Title: "Weekly Mindfulness Schedule"
Description: "Example of a weekly mindfulness schedule"

* code = https://2rdoc.pt/ig/ios-lifestyle-medicine/CodeSystem/mindfulness-schedule-type#recurring "Recurring Schedule"
* extension[mindfulness-schedule-timing].valueTiming.repeat.frequency = 1
* extension[mindfulness-schedule-timing].valueTiming.repeat.period = 1
* extension[mindfulness-schedule-timing].valueTiming.repeat.periodUnit = #wk
* extension[mindfulness-schedule-timing].valueTiming.repeat.dayOfWeek = #mon
* extension[mindfulness-schedule-timing].valueTiming.repeat.dayOfWeek[+] = #wed
* extension[mindfulness-schedule-timing].valueTiming.repeat.dayOfWeek[+] = #fri



// ===== Conteúdo de: MindfulnessRules.fsh =====

RuleSet: MindfulnessValidation
* ^extension[0].url = "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice"
* ^extension[0].valueBoolean = true

* status MS
* code MS
* subject MS
* effective[x] MS
* value[x] MS
* component MS

* status from http://hl7.org/fhir/ValueSet/observation-status
* code from http://snomed.info/sct?fhir_vs=isa/711415009
* subject only Reference(Patient)
* effective[x] only dateTime

* obeys mindfulness-session-duration
* obeys mindfulness-stress-level
* obeys mindfulness-mood-required
* obeys mindfulness-context-complete
* obeys sequential-measurements

RuleSet: MindfulnessQuestionnaireValidation
* status MS
* title MS
* item MS

* status = #active
* subjectType = #Patient
* item ^slicing.discriminator.type = #value
* item ^slicing.discriminator.path = "linkId"
* item ^slicing.rules = #open
* item contains 
    session 0..1 MS and
    mood 0..1 MS and
    stress 0..1 MS and
    relaxation 0..1 MS

* item[session]
  * linkId = "mindful_session"
  * text = "Mindfulness Session"
  * type = #group
  * required = true
  * repeats = false

* item[mood]
  * linkId = "mood_assessment"
  * text = "Mood Assessment"
  * type = #group
  * required = true
  * repeats = false

* item[stress]
  * linkId = "stress_assessment"
  * text = "Stress Assessment"
  * type = #group
  * required = true
  * repeats = false

* item[relaxation]
  * linkId = "relaxation"
  * text = "Relaxation"
  * type = #group
  * required = true
  * repeats = false

RuleSet: MindfulnessResponseValidation
* status MS
* subject MS
* authored MS
* item MS

* status = #completed
* subject only Reference(Patient)
* authored 1..1
* item ^slicing.discriminator.type = #value
* item ^slicing.discriminator.path = "linkId"
* item ^slicing.rules = #open



// ===== Conteúdo de: MindfulnessMappings.fsh =====

Mapping: MindfulnessToHealthKit
Id: mindfulness-to-healthkit
Title: "Mapping to Apple HealthKit"
Source: MindfulnessObservation
Target: "http://developer.apple.com/documentation/healthkit"

* -> "HKCategoryTypeIdentifierMindfulSession" "Root mapping"
* effectiveDateTime -> "startDate and endDate" "Session timing"
* component[sessionDuration].valueQuantity -> "duration" "Session duration"

Mapping: MindfulnessToLOINC
Id: mindfulness-to-loinc
Title: "Mapping to LOINC codes"
Source: MindfulnessObservation
Target: "http://loinc.org"

* -> "89555-7" "Mindfulness safety questionnaire"
* component[stressLevel] -> "89556-5" "Stress level score"
* component[sessionDuration] -> "89557-3" "Duration of mindfulness practice"
* component[moodState] -> "89558-1" "Mood pattern"

Mapping: MindfulnessToSNOMED
Id: mindfulness-to-snomed
Title: "Mapping to SNOMED CT"
Source: MindfulnessObservation
Target: "http://snomed.info/sct"

* -> "711415009" "Meditation"
* component[stressLevel] -> "725854004" "Assessment of stress level"
* component[moodState] -> "373931001" "Mood finding"
* component[relaxationResponse] -> "276241001" "Relaxation technique"

Extension: MindfulnessImportMap
Id: mindfulness-import-map
Title: "Mindfulness Import Mapping"
Description: "Mapping instructions for importing mindfulness data"

* ^url = "https://2rdoc.pt/ig/ios-lifestyle-medicine/StructureDefinition/mindfulness-import-map"
* ^version = "1.0.0"
* ^status = #draft

* extension contains
    source 1..1 MS and
    target 1..1 MS and
    mapping 1..1 MS

* extension[source].value[x] only string
* extension[target].value[x] only string
* extension[mapping].value[x] only string

Instance: HealthKitMappingConfig
InstanceOf: MindfulnessImportMap
Usage: #inline

* extension[source].valueString = "HKCategoryTypeIdentifierMindfulSession"
* extension[target].valueString = "Observation"
* extension[mapping].valueString = "duration->component[sessionDuration].valueQuantity"



// ===== Conteúdo de: SocialInteractionMappings.fsh =====

Mapping: SocialInteractionToHealthKit
Id: social-interaction-to-healthkit
Description: "Definition for social-interaction-to-healthkit resource"Title: "Mapping to Apple HealthKit"
Source: SocialInteractionProfile
Target: "http://developer.apple.com/documentation/healthkit"

* -> "HKCategoryTypeIdentifierSocialInteraction" "Root mapping"
* valueCodeableConcept -> "interactionType" "Type of interaction"
* component[duration] -> "duration" "Duration of interaction"
* component[participants] -> "participantCount" "Number of participants"

Mapping: SocialInteractionToLOINC
Id: social-interaction-to-loinc
Title: "Mapping to LOINC codes"
Source: SocialInteractionProfile
Target: "http://loinc.org"

* -> "96766-1" "Social Interaction Panel"
* component[duration] -> "89597-9" "Interaction duration"
* component[quality] -> "89598-7" "Interaction quality"



// ===== Conteúdo de: MindfulnessDiagnosticMappings.fsh =====

Instance: MindfulnessDiagnosticMap
InstanceOf: ConceptMap
Usage: #definition
Title: "Mindfulness Diagnostic Mappings"
Description: "Mapping of mindfulness outcomes to diagnostic codes"

* status = #draft
* experimental = false
* purpose = "Map mindfulness outcomes to standard diagnostic codes"
* sourceUri = "https://2rdoc.pt/ig/ios-lifestyle-medicine/ValueSet/mindfulness-outcome-vs"
* targetUri = "http://snomed.info/sct"

* group[0].source = "https://2rdoc.pt/ig/ios-lifestyle-medicine/CodeSystem/mindfulness-outcome-cs"
* group[0].target = "http://snomed.info/sct"
* group[0].element[0]
  * code = #stressReduction
  * target[0]
    * code = #73595000
    * display = "Stress"
    * equivalence = #narrower
    * comment = "Indicates reduction in stress levels"

* group[0].element[1]
  * code = #improvedSleep
  * target[0]
    * code = #248234008
    * display = "Sleep pattern"
    * equivalence = #narrower
    * comment = "Indicates improvement in activity quality"

* group[0].element[2]
  * code = #emotionalBalance
  * target[0]
    * code = #285854004
    * display = "Emotional state"
    * equivalence = #equivalent
    * comment = "Maps to emotional state finding"

* group[0].element[3]
  * code = #increasedAwareness
  * target[0]
    * code = #736253002
    * display = "Mental state, behavior and/or psychosocial functioning"
    * equivalence = #relatedto
    * comment = "General improvement in mental state"

RuleSet: MindfulnessDiagnosticRules
* status MS
* code MS
* subject MS
* effective[x] MS
* value[x] MS
* method MS

* method from https://2rdoc.pt/ig/ios-lifestyle-medicine/ValueSet/mindfulness-diagnostic-method-vs (required)
* code from https://2rdoc.pt/ig/ios-lifestyle-medicine/ValueSet/mindfulness-diagnostic-code-vs (required)

* extension contains 
    diagnosticCertainty 0..1 MS and
    diagnosticTiming 0..1 MS



// ===== Conteúdo de: StressMappings.fsh =====

Mapping: StressToHealthKit
Id: stress-to-healthkit
Description: "Definition for stress-to-healthkit resource"Title: "Mapping to Apple HealthKit"
Source: StressLevelProfile
Target: "http://developer.apple.com/documentation/healthkit"

* -> "HKCategoryTypeIdentifierStressLevel" "Root mapping"
* valueQuantity -> "stressLevel" "Overall stress score"
* component[physiologicalStress] -> "physiologicalStress" "Physical stress indicators"
* component[psychologicalStress] -> "mentalStress" "Mental stress indicators"

Mapping: StressToLOINC
Id: stress-to-loinc
Title: "Mapping to LOINC codes"
Source: StressLevelProfile
Target: "http://loinc.org"

* -> "89592-0" "Stress Level Panel"
* component[physiologicalStress] -> "89593-8" "Physical stress score"
* component[psychologicalStress] -> "89594-6" "Mental stress score"



// ===== Conteúdo de: ShareableMetadata.fsh =====

// ShareableValueSet Compliance RuleSet
RuleSet: ShareableMetadata(version, status, experimental, publisher, description)
* ^version = {version}
* ^status = #{status}
* ^experimental = {experimental}
* ^publisher = "{publisher}"
* ^description = "{description}"
* ^date = "2024-01-01"
* ^contact[0].name = "Clinical Development Team"
* ^contact[0].telecom[0].system = #email
* ^contact[0].telecom[0].value = "clinical@2rdoc.pt"
* ^jurisdiction = http://unstats.un.org/unsd/methods/m49/m49.htm#150 "Europe"

// Apply to all ValueSets
RuleSet: ApplyShareableVS
* insert ShareableMetadata("0.1.0", active, false, 2RDoc PT, [[Comprehensive value set for iOS Lifestyle Medicine]])

// Apply to all CodeSystems  
RuleSet: ApplyShareableCS
* insert ShareableMetadata("0.1.0", active, false, 2RDoc PT, [[Code system for iOS Lifestyle Medicine]])
* ^content = #complete
* ^caseSensitive = true



// ===== Conteúdo de: BodyMetricsProfiles.fsh =====

Alias: $SCT = http://snomed.info/sct
Alias: $LOINC = http://loinc.org
Alias: $UCUM = http://unitsofmeasure.org

Profile: BodyMetricsObservation
Parent: Observation
Id: body-metrics-observation
Title: "Body Metrics Observation Profile"
Description: "Profile for body measurements from iOS Health App"

* ^version = "0.1.0"
* ^status = #draft
* ^publisher = "Open Health Manager"

* status MS
* category 1..1 MS
* category = http://terminology.hl7.org/CodeSystem/observation-category#vital-signs
* subject 1..1 MS
* effectiveDateTime 1..1 MS
* device 0..1 MS

Profile: WeightObservation
Parent: BodyMetricsObservation
Id: weight-observation  
Title: "Weight Measurement Profile"
Description: "Profile for body weight measurements"

* ^version = "0.1.0"
* ^status = #draft

* code = $LOINC#29463-7 "Body weight"
* valueQuantity only Quantity
* valueQuantity.system = $UCUM
* valueQuantity.code = #kg

Profile: HeightObservation
Parent: BodyMetricsObservation
Id: height-observation
Title: "Height Measurement Profile" 
Description: "Profile for body height measurements"

* ^version = "0.1.0"
* ^status = #draft

* code = $LOINC#8302-2 "Body height"
* valueQuantity only Quantity
* valueQuantity.system = $UCUM
* valueQuantity.code = #cm

Profile: BMIObservation
Parent: BodyMetricsObservation
Id: bmi-observation
Title: "BMI Measurement Profile"
Description: "Profile for Body Mass Index calculations"

* ^version = "0.1.0"
* ^status = #draft

* code = $LOINC#39156-5 "Body mass index (BMI) [Ratio]"
* valueQuantity only Quantity
* valueQuantity.system = $UCUM
* valueQuantity.code = #kg/m2

Profile: BodyCompositionObservation
Parent: BodyMetricsObservation
Id: body-composition-observation
Title: "Body Composition Profile"
Description: "Profile for body composition measurements including fat, lean mass, and other metrics"

* ^version = "0.1.0"
* ^status = #draft

* code = $LOINC#88365-2 "Body composition panel"
* component ^slicing.discriminator.type = #value
* component ^slicing.discriminator.path = "code"
* component ^slicing.rules = #open

* component contains
    bodyFat 0..1 MS and
    leanMass 0..1 MS and
    bodyWater 0..1 MS and
    muscleMass 0..1 MS and
    boneMass 0..1 MS

* component[bodyFat].code = $LOINC#41982-0 "Percentage body fat"
* component[bodyFat].valueQuantity.system = $UCUM
* component[bodyFat].valueQuantity.code = #%

* component[leanMass].code = $LOINC#291-7 "Lean body mass"
* component[leanMass].valueQuantity.system = $UCUM
* component[leanMass].valueQuantity.code = #kg

* component[bodyWater].code = $LOINC#73708-0 "Total body water"
* component[bodyWater].valueQuantity.system = $UCUM  
* component[bodyWater].valueQuantity.code = #L

* component[muscleMass].code = $LOINC#73713-0 "Muscle mass"
* component[muscleMass].valueQuantity.system = $UCUM
* component[muscleMass].valueQuantity.code = #kg

* component[boneMass].code = $LOINC#73711-4 "Bone mass" 
* component[boneMass].valueQuantity.system = $UCUM
* component[boneMass].valueQuantity.code = #kg



// ===== Conteúdo de: AdvancedVitalSignsProfiles.fsh =====

Alias: $SCT = http://snomed.info/sct
Alias: $LOINC = http://loinc.org
Alias: $UCUM = http://unitsofmeasure.org

Profile: AdvancedVitalSigns
Parent: Observation
Id: advanced-vital-signs
Title: "Advanced Vital Signs Profile"
Description: "Profile for advanced vital signs data from iOS Health App"

* ^version = "0.1.0"
* ^status = #draft
* ^publisher = "HL7 International"
* ^contact.name = "Advanced Vital Signs Working Group"

* status MS
* category 1..1 MS
* category = http://terminology.hl7.org/CodeSystem/observation-category#vital-signs
* code 1..1 MS
* subject 1..1 MS
* effectiveDateTime 1..1 MS
* device 0..1 MS
* method 0..1 MS
* note 0..* MS

* component ^slicing.discriminator.type = #value
* component ^slicing.discriminator.path = "code"
* component ^slicing.rules = #open
* component ^short = "Advanced vital signs components"
* component ^definition = "Components of advanced vital sign measurements"

* component contains
    hrvSpectral 0..1 MS and
    hrvEntropy 0..1 MS and
    meanArterialPressure 0..1 MS and
    pulseWaveAnalysis 0..1 MS and
    respiratoryVariability 0..1 MS and
    oxygenationIndex 0..1 MS and
    stressIndex 0..1 MS and
    thermalGradient 0..1 MS and
    autonomicBalance 0..1 MS and
    recoveryRate 0..1 MS and
    allostaticLoad 0..1 MS

* component[hrvSpectral].code = $LOINC#87834-8 "Heart rate variability [Frequency band]"
* component[hrvSpectral].valueQuantity.system = $UCUM
* component[hrvSpectral].valueQuantity.code = #ms
* component[hrvSpectral] ^short = "Spectral analysis of heart rate variability"

* component[hrvEntropy].code = $LOINC#87835-5 "Heart rate variability entropy"
* component[hrvEntropy].valueQuantity.system = $UCUM
* component[hrvEntropy].valueQuantity.code = #{entropy}
* component[hrvEntropy] ^short = "Sample entropy of heart rate variability"

* component[meanArterialPressure].code = $LOINC#8478-0 "Mean blood pressure"
* component[meanArterialPressure].valueQuantity.system = $UCUM
* component[meanArterialPressure].valueQuantity.code = #mmHg
* component[meanArterialPressure] ^short = "Mean arterial blood pressure"

* component[pulseWaveAnalysis].code = $LOINC#87836-3 "Pulse wave analysis"
* component[pulseWaveAnalysis].valueQuantity.system = $UCUM
* component[pulseWaveAnalysis].valueQuantity.code = #{index}
* component[pulseWaveAnalysis] ^short = "Analysis of arterial pulse wave"

* component[respiratoryVariability].code = $LOINC#87837-1 "Respiratory rate variability"
* component[respiratoryVariability].valueQuantity.system = $UCUM
* component[respiratoryVariability].valueQuantity.code = #{coefficient}
* component[respiratoryVariability] ^short = "Variability in respiratory rate"

* component[oxygenationIndex].code = $LOINC#87838-9 "Oxygenation index"
* component[oxygenationIndex].valueQuantity.system = $UCUM
* component[oxygenationIndex].valueQuantity.code = #{ratio}
* component[oxygenationIndex] ^short = "Index of blood oxygenation"

* component[stressIndex].code = $LOINC#87839-7 "Physiological stress index"
* component[stressIndex].valueQuantity.system = $UCUM
* component[stressIndex].valueQuantity.code = #{index}
* component[stressIndex] ^short = "Index of physiological stress"

* component[thermalGradient].code = $LOINC#87840-5 "Temperature gradient"
* component[thermalGradient].valueQuantity.system = $UCUM
* component[thermalGradient].valueQuantity.code = #Cel
* component[thermalGradient] ^short = "Gradient of body temperature"

* component[autonomicBalance].code = $LOINC#87841-3 "Autonomic balance index"
* component[autonomicBalance].valueQuantity.system = $UCUM
* component[autonomicBalance].valueQuantity.code = #{ratio}
* component[autonomicBalance] ^short = "Balance of autonomic nervous system"

* component[recoveryRate].code = $LOINC#87842-1 "Recovery rate index"
* component[recoveryRate].valueQuantity.system = $UCUM
* component[recoveryRate].valueQuantity.code = #{rate}
* component[recoveryRate] ^short = "Rate of physiological recovery"

* component[allostaticLoad].code = $LOINC#87843-9 "Allostatic load index"
* component[allostaticLoad].valueQuantity.system = $UCUM
* component[allostaticLoad].valueQuantity.code = #{score}
* component[allostaticLoad] ^short = "Measure of cumulative physiological burden"

Extension: AdvancedVitalSignsContext
Id: advanced-vital-signs-context
Title: "Advanced Vital Signs Context Extension"
Description: "Additional context about advanced vital sign measurements"

* value[x] only CodeableConcept
* valueCodeableConcept from AdvancedVitalSignsContextVS (required)

ValueSet: AdvancedVitalSignsContextVS
Id: advanced-vital-signs-context-vs
Title: "Advanced Vital Signs Context Value Set"
Description: "Context codes for advanced vital sign measurements"

* ^experimental = true
* codes from system AdvancedVitalSignsContextCS

CodeSystem: AdvancedVitalSignsContextCS
Id: advanced-vital-signs-context-cs
Title: "Advanced Vital Signs Context Code System"
Description: "Codes for advanced vital signs measurement context"

* ^experimental = true
* ^caseSensitive = true

* #resting "Resting state" "Measurement taken during rest"
* #active "Active state" "Measurement taken during activity"
* #recovery "Recovery state" "Measurement taken during recovery"
* #activity "Sleep state" "Measurement taken during activity"
* #stress "Stress state" "Measurement taken during stress"



// ===== Conteúdo de: MobilityProfiles.fsh =====

Profile: MobilityProfile
Parent: Observation
Id: mobility-profile
Title: "Mobility Profile"
Description: "Profile for mobility data from iOS Health App"

* status MS
* category 1..1 MS
* category = http://terminology.hl7.org/CodeSystem/observation-category#activity
* code 1..1 MS
* subject 1..1 MS
* effectiveDateTime 1..1 MS
* device 0..1 MS

* component ^slicing.discriminator.type = #value
* component ^slicing.discriminator.path = "code"
* component ^slicing.rules = #open

* component contains
    steadiness 0..1 MS and
    balance 0..1 MS and
    gait 0..1 MS and 
    movement 0..1 MS

* component[steadiness].code = $LOINC#LA32-8
* component[balance].code = $LOINC#LA32-9
* component[gait].code = $LOINC#LA29042-4
* component[movement].code = $LOINC#LA29043-2



// ===== Conteúdo de: VitalSignsProfiles.fsh =====

Alias: $SCT = http://snomed.info/sct
Alias: $LOINC = http://loinc.org
Alias: $UCUM = http://unitsofmeasure.org
Alias: $vitalsigns = http://hl7.org/fhir/StructureDefinition/vitalsigns

Profile: LifestyleVitalSigns
Parent: $vitalsigns
Id: lifestyle-vital-signs
Title: "Lifestyle Medicine Vital Signs Profile"
Description: "Profile for vital signs data from iOS Health App"

* status MS
* category 1..* MS
* subject 1..1 MS
* effectiveDateTime 1..1 MS
* code 1..1 MS
* value[x] 0..1 MS
* device 0..1 MS

Profile: HeartRateObservation
Parent: LifestyleVitalSigns
Id: heart-rate-observation
Title: "Heart Rate Observation Profile"
Description: "Profile for heart rate measurements from iOS Health App"

* code = $LOINC#8867-4 "Heart rate"
* valueQuantity only Quantity
* valueQuantity.system = $UCUM
* valueQuantity.code = #/min
* component ^slicing.discriminator.type = #value
* component ^slicing.discriminator.path = "code"
* component ^slicing.rules = #open

* component contains
    restingHeartRate 0..1 MS and
    exerciseHeartRate 0..1 MS and
    recoveryHeartRate 0..1 MS and
    heartRateVariability 0..1 MS

* component[heartRateVariability].code = $LOINC#80404-7 "R-R interval.standard deviation (Heart rate variability)"
* component[heartRateVariability].valueQuantity.system = $UCUM
* component[heartRateVariability].valueQuantity.code = #ms

Profile: BloodPressureObservation
Parent: LifestyleVitalSigns
Id: blood-pressure-observation
Title: "Blood Pressure Observation Profile"
Description: "Profile for blood pressure measurements from iOS Health App"

* code = $LOINC#85354-9 "Blood pressure panel with all children optional"
* component 2..2 MS
* component ^slicing.discriminator.type = #value
* component ^slicing.discriminator.path = "code"
* component ^slicing.rules = #closed

* component contains
    systolic 1..1 MS and
    diastolic 1..1 MS

* component[systolic].code = $LOINC#8480-6 "Systolic blood pressure"
* component[systolic].valueQuantity only Quantity
* component[systolic].valueQuantity.system = $UCUM
* component[systolic].valueQuantity.code = #mm[Hg]

* component[diastolic].code = $LOINC#8462-4 "Diastolic blood pressure"
* component[diastolic].valueQuantity only Quantity
* component[diastolic].valueQuantity.system = $UCUM
* component[diastolic].valueQuantity.code = #mm[Hg]

Profile: OxygenSaturationObservation
Parent: LifestyleVitalSigns
Id: oxygen-saturation-observation
Title: "Oxygen Saturation Observation Profile"
Description: "Profile for SpO2 measurements from iOS Health App"

* code = $LOINC#2708-6 "Oxygen saturation in Arterial blood"
* valueQuantity.system = $UCUM
* valueQuantity.code = #%



// ===== Conteúdo de: PhysicalActivityProfile.fsh =====

Alias: $LOINC = http://loinc.org
Alias: $SNOMED = http://snomed.info/sct
Alias: $UCUM = http://unitsofmeasure.org
Alias: $ActivityCodes = https://2rdoc.pt/ig/ios-lifestyle-medicine/activity-codes

Profile: PhysicalActivityObservation
Parent: Observation
Id: physical-activity-observation
Title: "Physical Activity Observation Profile"
Description: "Profile for recording physical activity data from iOS Health App"

* status MS
* category 1..1 MS
* category = http://terminology.hl7.org/CodeSystem/observation-category#activity
* code 1..1 MS
* code from PhysicalActivityTypeVS (required)
* subject 1..1 MS
* subject only Reference(Patient)
* effectiveDateTime 1..1 MS
* device 0..1 MS
* value[x] only Quantity
* component ^slicing.discriminator.type = #value
* component ^slicing.discriminator.path = "code"
* component ^slicing.rules = #open

* component contains
    steps 0..1 MS and
    distance 0..1 MS and
    duration 0..1 MS and
    energy 0..1 MS

* component[steps].code = $LOINC#55423-8 "Number of steps in 24 hour Measured"
* component[steps].valueQuantity only Quantity
* component[steps].valueQuantity.system = $UCUM
* component[steps].valueQuantity.code = #1 "count"

* component[distance].code = $LOINC#55430-3 "Distance walked"
* component[distance].valueQuantity only Quantity
* component[distance].valueQuantity.system = $UCUM
* component[distance].valueQuantity.code = #km "kilometer"

* component[duration].code = $LOINC#55411-3 "Exercise duration"
* component[duration].valueQuantity only Quantity
* component[duration].valueQuantity.system = $UCUM
* component[duration].valueQuantity.code = #min "minute"

* component[energy].code = $LOINC#55424-6 "Energy expenditure"
* component[energy].valueQuantity only Quantity
* component[energy].valueQuantity.system = $UCUM
* component[energy].valueQuantity.code = #kcal "kilocalorie"



// ===== Conteúdo de: ReproductiveObservation.fsh =====

Profile: ReproductiveObservation
Parent: Observation
Id: social-history-observation
Title: "Reproductive Health Base Profile"
Description: "Base profile for social-history health observations"

* ^version = "1.0.0"
* ^status = #active
* ^date = "2024-03-19"

* status MS
* category 1..1 MS
* category = http://terminology.hl7.org/CodeSystem/observation-category#social-history
* code 1..1 MS
* subject 1..1 MS
* subject only Reference(Patient)
* effectiveDateTime 1..1 MS
* value[x] MS

* component ^slicing.discriminator.type = #value
* component ^slicing.discriminator.path = "code"
* component ^slicing.rules = #open

* component contains
    severity 0..1 MS and
    duration 0..1 MS and
    frequency 0..1 MS and
    pattern 0..1 MS

* component[severity]
  * code = $LOINC#72514-3
  * value[x] only integer
  * valueInteger 1..1 
  * valueInteger obeys rep-1

* component[duration]
  * code = $LOINC#3144-3
  * value[x] only Quantity
  * valueQuantity from DurationUnitsVS (required)

* component[frequency]
  * code = $LOINC#92656-8
  * value[x] only CodeableConcept
  * valueCodeableConcept from SymptomFrequencyVS (required)

* component[pattern]
  * code = $LOINC#64699-2
  * value[x] only CodeableConcept
  * valueCodeableConcept from SymptomProgressionVS (required)

Invariant: rep-1
Description: "Severity must be between 0 and 10"
Expression: "$this >= 0 and $this <= 10"
Severity: #error



// ===== Conteúdo de: SymptomProfiles.fsh =====

Profile: SymptomQuestionnaire
Parent: Questionnaire
Id: symptom-questionnaire
Title: "Symptom Assessment Questionnaire"
Description: "Questionnaire template for symptom assessments"

* status MS
* title MS
* item MS

* item ^slicing.discriminator.type = #value
* item ^slicing.discriminator.path = "linkId"
* item ^slicing.rules = #open

* item contains
    symptomType 1..1 MS and
    location 0..1 MS and
    onset 0..1 MS and
    description 0..1 MS

* item[symptomType].linkId = "symptom-type"
* item[symptomType].text = "Type of Symptom"
* item[symptomType].type = #choice
* item[symptomType].required = true

* item[location].linkId = "location"
* item[location].text = "Location"
* item[location].type = #string

* item[onset].linkId = "onset"
* item[onset].text = "When did it start?"
* item[onset].type = #dateTime

* item[description].linkId = "description"
* item[description].text = "Description"
* item[description].type = #text



// ===== Conteúdo de: ReproductiveProfiles.fsh =====

Profile: FertilityObservation
Parent: Observation
Id: fertility-observation
Title: "Fertility Observation Profile"
Description: "Profile for fertility signs and symptoms"

* status MS
* category 1..1 MS
* category = http://terminology.hl7.org/CodeSystem/observation-category#social-history
* code = $LOINC#8669-4 "Ovulation status"
* subject 1..1 MS
* effectiveDateTime 1..1 MS

* component ^slicing.discriminator.type = #value
* component ^slicing.discriminator.path = "code"
* component ^slicing.rules = #open

* component contains
    cervicalMucus 0..1 MS and
    ovulationTest 0..1 MS and
    fertilityStatus 0..1 MS

* component[cervicalMucus].valueCodeableConcept from https://2rdoc.pt/ig/ios-lifestyle-medicine/ValueSet/cervical-mucus-vs (required)
* component[ovulationTest].valueCodeableConcept from https://2rdoc.pt/ig/ios-lifestyle-medicine/ValueSet/ovulation-test-vs (required)
* component[fertilityStatus].valueCodeableConcept from https://2rdoc.pt/ig/ios-lifestyle-medicine/ValueSet/fertility-status-vs (required)



// ===== Conteúdo de: MindfulnessProfiles.fsh =====

Profile: MindfulnessObservation
Parent: Observation
Id: mindfulness-observation
Title: "Mindfulness Session Observation"
Description: "Profile for recording mindfulness practice sessions and outcomes"

* status MS
* code MS
* subject MS
* effectiveDateTime MS
* performer MS
* value[x] MS
* component MS

* status = #final
* code = $SCT#285854004 "Emotion"
* subject only Reference(Patient)
* effectiveDateTime 1..1
* performer only Reference(Practitioner or PractitionerRole)

* component ^slicing.discriminator.type = #value
* component ^slicing.discriminator.path = "code"
* component ^slicing.rules = #open

* component contains
    sessionDuration 0..1 and
    stressLevel 0..1 and
    moodState 0..1 and
    relaxationResponse 0..1 and
    mindfulnessType 0..1

* component[sessionDuration]
  * code = $SCT#118682006 "Duration"
  * value[x] only Quantity
  * valueQuantity
    * value 1..1
    * unit = "min"
    * system = "http://unitsofmeasure.org"
    * code = #min

* component[stressLevel]
  * code = $SCT#725854004 "Assessment of stress level"
  * value[x] only integer
  * valueInteger
    * ^extension[0].url = "http://hl7.org/fhir/StructureDefinition/elementdefinition-minValueInteger"
    * ^extension[0].valueInteger = 0
    * ^extension[1].url = "http://hl7.org/fhir/StructureDefinition/elementdefinition-maxValueInteger"
    * ^extension[1].valueInteger = 10

* component[moodState]
  * code = $SCT#373931001 "Mood finding"
  * value[x] only CodeableConcept
  * valueCodeableConcept from https://2rdoc.pt/ig/ios-lifestyle-medicine/ValueSet/mood (required)

* component[relaxationResponse]
  * code = $SCT#276241001 "Relaxation technique"
  * value[x] only string

* component[mindfulnessType]
  * code = $SCT#285854004 "Emotion"
  * value[x] only CodeableConcept
  * valueCodeableConcept from https://2rdoc.pt/ig/ios-lifestyle-medicine/ValueSet/mindfulness-type (required)



// ===== Conteúdo de: SleepProfile.fsh =====

Alias: $SCT = http://snomed.info/sct
Alias: $LOINC = http://loinc.org
Alias: $UCUM = http://unitsofmeasure.org
 
Profile: SleepObservation
Parent: Observation
Id: activity-observation
Title: "Sleep Observation Profile"
Description: "Profile for recording activity data from iOS Health App"
 
* status MS
* category 1..1 MS
* category = http://terminology.hl7.org/CodeSystem/observation-category#activity
* code 1..1 MS
* code = $LOINC#93832-4 "Sleep pattern panel"
* subject 1..1 MS
* subject only Reference(Patient)
* effectiveDateTime 0..1 MS
* effectivePeriod 0..1 MS
* device 0..1 MS
 
* component ^slicing.discriminator.type = #value
* component ^slicing.discriminator.path = "code"
* component ^slicing.rules = #open
 
* component contains
    timeInBed 1..1 MS and
    totalSleepTime 1..1 MS and
    deepSleep 0..1 MS and
    remSleep 0..1 MS and
    lightSleep 0..1 MS and
    respiratoryRate 0..1 MS and
    heartRateVariability 0..1 MS and
    interruptions 0..1 MS
 
* component[timeInBed].code = $LOINC#93831-6 "Time in bed"
* component[timeInBed].valueQuantity only Quantity
* component[timeInBed].valueQuantity.system = $UCUM
* component[timeInBed].valueQuantity.code = #min
 
* component[totalSleepTime].code = $LOINC#93833-2 "Sleep duration"
* component[totalSleepTime].valueQuantity only Quantity
* component[totalSleepTime].valueQuantity.system = $UCUM
* component[totalSleepTime].valueQuantity.code = #min
 
* component[deepSleep].code = $LOINC#93834-0 "Deep activity duration"
* component[deepSleep].valueQuantity only Quantity
* component[deepSleep].valueQuantity.system = $UCUM
* component[deepSleep].valueQuantity.code = #min
 
* component[remSleep].code = $LOINC#93835-7 "REM activity duration"
* component[remSleep].valueQuantity only Quantity
* component[remSleep].valueQuantity.system = $UCUM
* component[remSleep].valueQuantity.code = #min
 
* component[lightSleep].code = $LOINC#93836-5 "Light activity duration"
* component[lightSleep].valueQuantity only Quantity
* component[lightSleep].valueQuantity.system = $UCUM
* component[lightSleep].valueQuantity.code = #min
 
* component[respiratoryRate].code = $LOINC#9279-1 "Respiratory rate"
* component[respiratoryRate].valueQuantity only Quantity
* component[respiratoryRate].valueQuantity.system = $UCUM
* component[respiratoryRate].valueQuantity.code = #/min
 
* component[heartRateVariability].code = $LOINC#80404-7 "R-R interval.standard deviation (Heart rate variability)"
* component[heartRateVariability].valueQuantity only Quantity
* component[heartRateVariability].valueQuantity.system = $UCUM
* component[heartRateVariability].valueQuantity.code = #ms
 
* component[interruptions].code = $LOINC#93837-3 "Number of awakenings during activity"
* component[interruptions].valueQuantity only Quantity
* component[interruptions].valueQuantity.system = $UCUM
* component[interruptions].valueQuantity.code = #{count}
* extension contains SleepQuality named quality 0..1



// ===== Conteúdo de: MobilityRiskAssessment.fsh =====

Profile: MobilityRiskAssessment
Parent: RiskAssessment
Id: mobility-risk-assessment
Title: "Mobility Risk Assessment Profile"
Description: "Profile for assessing mobility-related risks"

* status MS
* subject 1..1 MS
* occurrence[x] MS
* prediction MS
  * outcome MS
  * probability[x] MS
  * qualitativeRisk MS

* method MS
  * coding ^slicing.discriminator.type = #value
  * coding ^slicing.discriminator.path = "$this"
  * coding ^slicing.rules = #open
  * coding contains
      mobilityAssessment 1..1 MS

* method.coding[mobilityAssessment] = https://2rdoc.pt/ig/ios-lifestyle-medicine/CodeSystem/mobility-assessment-method#standardized "Standardized Mobility Assessment"

* prediction ^slicing.discriminator.type = #value
* prediction ^slicing.discriminator.path = "outcome"
* prediction ^slicing.rules = #open

* prediction contains
    fallRisk 0..1 MS and
    mobilityDecline 0..1 MS and
    assistanceNeeded 0..1 MS

* prediction[fallRisk].outcome from https://2rdoc.pt/ig/ios-lifestyle-medicine/ValueSet/fall-risk-outcomes
* prediction[fallRisk].probabilityDecimal 0..1 MS
* prediction[fallRisk].qualitativeRisk from https://2rdoc.pt/ig/ios-lifestyle-medicine/ValueSet/risk-level

* prediction[mobilityDecline].outcome from https://2rdoc.pt/ig/ios-lifestyle-medicine/ValueSet/mobility-decline-outcomes
* prediction[mobilityDecline].probabilityDecimal 0..1 MS
* prediction[mobilityDecline].qualitativeRisk from https://2rdoc.pt/ig/ios-lifestyle-medicine/ValueSet/risk-level

* prediction[assistanceNeeded].outcome from https://2rdoc.pt/ig/ios-lifestyle-medicine/ValueSet/assistance-level-outcomes
* prediction[assistanceNeeded].probabilityDecimal 0..1 MS
* prediction[assistanceNeeded].qualitativeRisk from https://2rdoc.pt/ig/ios-lifestyle-medicine/ValueSet/risk-level

* basis only Reference(MobilityProfile or Observation or QuestionnaireResponse)
* basis MS

* note MS



// ===== Conteúdo de: EnvironmentalProfiles.fsh =====

Alias: $SCT = http://snomed.info/sct
Alias: $LOINC = http://loinc.org
Alias: $UCUM = http://unitsofmeasure.org

Profile: EnvironmentalObservation
Parent: Observation
Id: environmental-observation
Title: "Environmental Observation Profile"
Description: "Base profile for environmental measurements from iOS Health App"

* ^version = "0.1.0"
* ^status = #draft
* ^publisher = "HL7 International"
* ^contact.name = "Environmental Health Working Group"

* status MS
* category 1..1 MS
* category = http://terminology.hl7.org/CodeSystem/observation-category#environment
* subject 1..1 MS
* effectiveDateTime 1..1 MS
* device 0..1 MS
* method 0..1 MS
* note 0..* MS

Profile: NoiseExposureObservation
Parent: EnvironmentalObservation
Id: noise-exposure-observation
Title: "Noise Exposure Observation Profile"
Description: "Profile for noise exposure measurements from iOS Health App"

* code = $LOINC#28573-7 "Noise exposure time"
* component ^slicing.discriminator.type = #value
* component ^slicing.discriminator.path = "code"
* component ^slicing.rules = #open
* component ^short = "Noise exposure components"
* component ^definition = "Components of noise exposure measurement"

* component contains
    level 1..1 MS and
    duration 1..1 MS and
    peakLevel 0..1 MS and
    backgroundNoise 0..1 MS

* component[level].code = $LOINC#89020-2 "Environmental noise average"
* component[level].valueQuantity.system = $UCUM
* component[level].valueQuantity.code = #dB
* component[level].valueQuantity ^short = "Noise level in decibels"

* component[duration].code = $LOINC#89021-0 "Environmental noise duration"
* component[duration].valueQuantity.system = $UCUM
* component[duration].valueQuantity.code = #min
* component[duration].valueQuantity ^short = "Duration of exposure"

* component[peakLevel].code = $LOINC#89024-4 "Peak sound level"
* component[peakLevel].valueQuantity.system = $UCUM
* component[peakLevel].valueQuantity.code = #dB
* component[peakLevel].valueQuantity ^short = "Peak noise level"

* component[backgroundNoise].code = $LOINC#89025-1 "Background noise level"
* component[backgroundNoise].valueQuantity.system = $UCUM
* component[backgroundNoise].valueQuantity.code = #dB
* component[backgroundNoise].valueQuantity ^short = "Background noise level"

Profile: UVExposureObservation
Parent: EnvironmentalObservation
Id: uv-exposure-observation
Title: "UV Exposure Observation Profile"
Description: "Profile for UV exposure measurements from iOS Health App"

* code = $LOINC#28574-5 "UV exposure"
* component ^slicing.discriminator.type = #value
* component ^slicing.discriminator.path = "code"
* component ^slicing.rules = #open
* component ^short = "UV exposure components"
* component ^definition = "Components of UV exposure measurement"

* component contains
    index 1..1 MS and
    duration 1..1 MS and
    timeOfDay 0..1 MS and
    intensity 0..1 MS

* component[index].code = $LOINC#89022-8 "UV index"
* component[index].valueQuantity.system = $UCUM
* component[index].valueQuantity.code = #{index}
* component[index].valueQuantity ^short = "UV index value"

* component[duration].code = $LOINC#89023-6 "UV exposure duration"
* component[duration].valueQuantity.system = $UCUM
* component[duration].valueQuantity.code = #min
* component[duration].valueQuantity ^short = "Duration of UV exposure"

* component[timeOfDay].code = $LOINC#89026-9 "Time of exposure"
* component[timeOfDay].valueDateTime 1..1
* component[timeOfDay].valueDateTime ^short = "Time of UV exposure"

* component[intensity].code = $LOINC#89027-7 "UV intensity"
* component[intensity].valueQuantity.system = $UCUM
* component[intensity].valueQuantity.code = #W/m2
* component[intensity].valueQuantity ^short = "UV radiation intensity"

Extension: EnvironmentalContext
Id: environmental-context
Title: "Environmental Context Extension"
Description: "Additional context about environmental measurements"

* value[x] only CodeableConcept
* valueCodeableConcept from https://2rdoc.pt/ig/ios-lifestyle-medicine/ValueSet/environmental-context (required)



// ===== Conteúdo de: SocialInteractionProfile.fsh =====

Profile: SocialInteractionProfile
Parent: Observation
Id: social-interaction
Title: "Social Interaction Profile"
Description: "Profile for recording social interaction data from iOS Health App"

* ^version = "0.1.0"
* ^status = #active
* ^date = "2024-01-03"
* ^publisher = "FMUP HEADS2"

* status MS
* category 1..1 MS
* category = http://terminology.hl7.org/CodeSystem/observation-category#social-history
* code 1..1 MS
* code = $LOINC#96766-1 "Social interaction pattern"
* subject 1..1 MS
* effectiveDateTime 1..1 MS
* value[x] only CodeableConcept
* valueCodeableConcept from SocialInteractionTypeVS (required)

* component ^slicing.discriminator.type = #value
* component ^slicing.discriminator.path = "code"
* component ^slicing.rules = #open

* component contains
    duration 0..1 MS and
    quality 0..1 MS and
    medium 0..1 MS and
    participants 0..1 MS

* component[duration]
  * code = $LOINC#89597-9 "Social interaction duration"
  * valueQuantity only Quantity
  * valueQuantity.system = $UCUM
  * valueQuantity.code = #min

* component[quality]
  * code = $LOINC#89598-7 "Social interaction quality"
  * valueCodeableConcept from SocialInteractionQualityVS (required)

* component[medium]
  * code = $LOINC#89599-5 "Social interaction medium"
  * valueCodeableConcept from SocialInteractionMediumVS (required)

* component[participants]
  * code = $LOINC#89600-1 "Social interaction participants"
  * valueInteger only integer

* extension contains
    SocialContext named context 0..1 MS and
    SocialSupport named support 0..1 MS and
    SocialActivity named activity 0..* MS



// ===== Conteúdo de: StressLevelProfile.fsh =====

Profile: StressLevelProfile
Parent: Observation
Id: stress-level
Title: "Stress Level Profile"
Description: "Profile for recording stress level measurements from iOS Health App"

* ^version = "0.1.0"
* ^status = #active
* ^date = "2024-01-03"
* ^publisher = "FMUP HEADS2"

* status MS
* category 1..1 MS
* category = http://terminology.hl7.org/CodeSystem/observation-category#vital-signs
* code 1..1 MS
* code = $LOINC#89592-0 "Stress level score"
* subject 1..1 MS
* effectiveDateTime 1..1 MS
* value[x] only Quantity
* valueQuantity MS

* component ^slicing.discriminator.type = #value
* component ^slicing.discriminator.path = "code"
* component ^slicing.rules = #open

* component contains
    physiologicalStress 0..1 MS and
    psychologicalStress 0..1 MS and
    chronicity 0..1 MS and 
    impact 0..1 MS

* component[physiologicalStress]
  * code = $LOINC#89593-8 "Physiological stress"
  * valueQuantity only Quantity
  * valueQuantity.system = $UCUM
  * valueQuantity.code = #{score}

* component[psychologicalStress]
  * code = $LOINC#89594-6 "Psychological stress"
  * valueQuantity only Quantity
  * valueQuantity.system = $UCUM
  * valueQuantity.code = #{score}

* component[chronicity]
  * code = $LOINC#89595-3 "Stress chronicity"
  * valueCodeableConcept from StressChronicityVS (required)

* component[impact]
  * code = $LOINC#89596-1 "Stress impact"
  * valueCodeableConcept from StressImpactVS (required)

* extension contains
    MeasurementContext named context 0..1 MS and
    StressTriggers named triggers 0..* MS and 
    StressCoping named coping 0..* MS



// ===== Conteúdo de: NutritionProfiles.fsh =====

Alias: $SCT = http://snomed.info/sct
Alias: $LOINC = http://loinc.org
Alias: $UCUM = http://unitsofmeasure.org

Profile: NutritionIntakeObservation
Parent: Observation
Id: nutrition-intake-observation
Title: "Nutrition Intake Observation Profile"
Description: "Profile for nutrition intake data from iOS Health App and user input"

* ^version = "0.1.0"
* ^status = #draft
* ^publisher = "Ricardo Lourenço dos Santos"

* status MS
* category 1..1 MS
* category = http://terminology.hl7.org/CodeSystem/observation-category#nutrition
* subject 1..1 MS
* effectiveDateTime 1..1 MS
* code 1..1 MS
* method 0..1 MS

Profile: WaterIntakeObservation
Parent: NutritionIntakeObservation 
Id: water-intake-observation
Title: "Water Intake Observation Profile"
Description: "Profile for water intake measurements"

* ^version = "0.1.0"
* ^status = #draft
* ^publisher = "Ricardo Lourenço dos Santos"

* code = $LOINC#77111-4 "Water intake"
* valueQuantity only Quantity
* valueQuantity.system = $UCUM
* valueQuantity.code = #mL
* valueQuantity.unit = "milliliter"

Profile: CalorieIntakeObservation
Parent: NutritionIntakeObservation
Id: calorie-intake-observation
Title: "Calorie Intake Observation Profile"
Description: "Profile for caloric intake measurements"

* ^version = "0.1.0"
* ^status = #draft
* ^publisher = "Ricardo Lourenço dos Santos"

* code = $LOINC#9051-4 "Caloric intake total"
* valueQuantity only Quantity
* valueQuantity.system = $UCUM
* valueQuantity.code = #kcal
* valueQuantity.unit = "kilocalorie"

Profile: MacronutrientsObservation
Parent: NutritionIntakeObservation
Id: macronutrients-observation
Title: "Macronutrients Observation Profile"
Description: "Profile for macronutrient intake measurements"

* ^version = "0.1.0"
* ^status = #draft
* ^publisher = "Ricardo Lourenço dos Santos"

* code = $LOINC#LP199119-9 "Macronutrients panel"
* component ^slicing.discriminator.type = #value
* component ^slicing.discriminator.path = "code"
* component ^slicing.rules = #open

* component contains
    carbohydrates 0..1 MS and
    proteins 0..1 MS and
    fats 0..1 MS

* component[carbohydrates].code = $LOINC#LP35925-4 "Carbohydrates"
* component[carbohydrates].valueQuantity.system = $UCUM
* component[carbohydrates].valueQuantity.code = #g
* component[carbohydrates].valueQuantity.unit = "gram"

* component[proteins].code = $LOINC#LP35921-3 "Proteins" 
* component[proteins].valueQuantity.system = $UCUM
* component[proteins].valueQuantity.code = #g
* component[proteins].valueQuantity.unit = "gram"

* component[fats].code = $LOINC#LP35922-1 "Fats"
* component[fats].valueQuantity.system = $UCUM
* component[fats].valueQuantity.code = #g
* component[fats].valueQuantity.unit = "gram"



// ===== Conteúdo de: MultiJurisdictionalConsent.fsh =====

// ====== Perfil Multi-Jurisdicional de Consent ======

Profile: MultiJurisdictionalConsent
Parent: Consent
Id: multi-jurisdictional-consent
Title: "Multi-Jurisdictional Healthcare Consent"
Description: "Consent profile supporting GDPR, HIPAA, and LGPD compliance"

* status MS
* scope MS
* category MS
* patient 1..1 MS
* dateTime 1..1 MS

// Múltiplas políticas para diferentes jurisdições
* policy 1..* MS
* policy ^slicing.discriminator.type = #value
* policy ^slicing.discriminator.path = "authority"
* policy ^slicing.rules = #open

* policy contains
    gdpr 0..1 MS and
    hipaa 0..1 MS and
    lgpd 0..1 MS

* policy[gdpr].authority = "https://eur-lex.europa.eu/eli/reg/2016/679/oj"
* policy[gdpr].uri 1..1 MS

* policy[hipaa].authority = "https://www.hhs.gov/hipaa/index.html"  
* policy[hipaa].uri 1..1 MS

* policy[lgpd].authority = "http://www.planalto.gov.br/ccivil_03/_ato2015-2018/2018/lei/L13709compilado.htm"
* policy[lgpd].uri 1..1 MS

// Extensões de compliance
* extension contains
    RegulatoryBasis named regulatoryBasis 0..* MS and
    JurisdictionApplicability named jurisdiction 0..* MS and
    DataLocalization named dataLocalization 0..* MS

// Provisions com segurança
* provision MS
* provision.type MS
* provision.period MS
* provision.actor MS
* provision.action MS
* provision.securityLabel MS
* provision.purpose MS
* provision.dataPeriod MS



// ===== Conteúdo de: MindfulnessMessaging.fsh =====

Alias: $MsgEvents = https://2rdoc.pt/ig/ios-lifestyle-medicine/CodeSystem/mindfulness-message-events
Alias: $MsgTypes = http://terminology.hl7.org/CodeSystem/message-type

Profile: MindfulnessMessageDefinition
Parent: MessageDefinition
Id: mindfulness-message-definition
Title: "Mindfulness Message Definition" 
Description: "Definition for mindfulness session messages"

* url 1..1 MS
* date 1..1 MS
* status 1..1 MS
* event[x] 1..1 MS
* category 0..1 MS
* focus 1..* MS
* focus.min 1..1

Instance: StartSessionMessage
InstanceOf: MindfulnessMessageDefinition
Title: "Start Session Message"
Description: "Message definition for starting a mindfulness session"

* url = "https://2rdoc.pt/ig/ios-lifestyle-medicine/MessageDefinition/start-session"
* date = "2024-03-19"
* status = #active
* eventCoding = $MsgEvents#session-start "Session Start"
* category = #notification
* focus.code = #Observation
* focus.min = 1
* focus.profile = "https://2rdoc.pt/ig/ios-lifestyle-medicine/StructureDefinition/mindfulness-session"

Instance: EndSessionMessage  
InstanceOf: MindfulnessMessageDefinition
Title: "End Session Message"
Description: "Message definition for ending a mindfulness session"

* url = "https://2rdoc.pt/ig/ios-lifestyle-medicine/MessageDefinition/end-session"
* date = "2024-03-19"
* status = #active
* eventCoding = $MsgEvents#session-end "Session End"
* category = #notification
* focus.code = #Observation
* focus.min = 1
* focus.profile = "https://2rdoc.pt/ig/ios-lifestyle-medicine/StructureDefinition/mindfulness-session"



// ===== Conteúdo de: PractitionerNamingSystem.fsh =====

// ====== CodeSystem para Identificadores de Practitioners ======

CodeSystem: PractitionerIdentifierCS
Id: practitioner-identifier-cs
Title: "Practitioner Identifier Code System"
Description: "Sistema de códigos para identificação de practitioners"
* ^status = #active
* ^experimental = false
* ^caseSensitive = true
* #npi "National Provider Identifier" "US National Provider Identifier"
* #crm "Conselho Regional de Medicina" "Brazilian Medical Council Registration"
* #ssin "Social Security Identification Number" "Belgian SSIN"
* #rpps "Répertoire Partagé des Professionnels de Santé" "French Healthcare Professional Registry"

ValueSet: PractitionerIdentifierVS
Id: practitioner-identifier-vs
Title: "Practitioner Identifier Value Set"
Description: "Value set para identificadores de practitioners"
* ^status = #active
* ^experimental = false
* include codes from system PractitionerIdentifierCS



// ===== Conteúdo de: MindfulnessReports.fsh =====

Instance: MindfulnessProgressReport
InstanceOf: Measure
Usage: #definition
Title: "Mindfulness Practice Progress Report"
Description: "Example instance of MindfulnessProgressReport"
* status = #active
* experimental = false
* date = "2024-03-19"
* publisher = "Example Organization"
* description = "Measures progress in mindfulness practice over time"

* scoring = #continuous-variable
* type = #process
* riskAdjustment = "none"
* rateAggregation = "Average values over time period"

* group[0]
  * code = #practice-frequency
  * description = "Frequency of mindfulness practice"
  * population[0]
    * code = #denominator
    * criteria.language = #text/fhirpath
    * criteria.expression = "Observation.where(code.coding.code='711415009')"
  * stratifier[0]
    * code = #weekly
    * criteria.language = #text/fhirpath
    * criteria.expression = "Observation.effective.as(DateTime).truncate(@T).truncate(@W)"

* group[1]
  * code = #stress-reduction
  * description = "Stress level changes over time"
  * population[0]
    * code = #denominator
    * criteria.language = #text/fhirpath
    * criteria.expression = "Observation.where(component.code.coding.code='725854004')"
  * stratifier[0]
    * code = #trend
    * criteria.language = #text/fhirpath
    * criteria.expression = "component.where(code.coding.code='725854004').value.value"

RuleSet: ReportingMetrics
* group[+]
  * code = #session-duration
  * description = "Duration of practice sessions"
  * population[0]
    * code = #denominator
    * criteria.language = #text/fhirpath
    * criteria.expression = "Observation.component.where(code.coding.code='118682006')"
  * stratifier[0]
    * code = #average
    * criteria.language = #text/fhirpath
    * criteria.expression = "component.where(code.coding.code='118682006').value.value"

* group[+]
  * code = #mood-changes
  * description = "Mood state changes"
  * population[0]
    * code = #denominator
    * criteria.language = #text/fhirpath
    * criteria.expression = "Observation.component.where(code.coding.code='373931001')"



// ===== Conteúdo de: MindfulnessCapabilities.fsh =====

// Originally defined on lines 1 - 73
Instance: MindfulnessCapabilityStatement
InstanceOf: CapabilityStatement
Title: "Mindfulness Module Capabilities"
Description: "Capabilities supported by the mindfulness module implementation"
Usage: #definition
* status = #draft
* date = "2024-03-19"
* kind = #requirements
* fhirVersion = #4.0.1
* format[0] = #json
* format[1] = #xml
* rest[0]
* rest[0].mode = #server
* rest[0].documentation = "RESTful server capabilities for mindfulness data"
* rest[0].resource[0]
* rest[0].resource[0].type = #Observation
* rest[0].resource[0].documentation = "Supports mindfulness session observations"
* rest[0].resource[0].profile = "https://2rdoc.pt/ig/ios-lifestyle-medicine/StructureDefinition/mindfulness-observation"
* rest[0].resource[0].interaction[0]
* rest[0].resource[0].interaction[0].code = #read
* rest[0].resource[0].interaction[1]
* rest[0].resource[0].interaction[1].code = #create
* rest[0].resource[0].interaction[2]
* rest[0].resource[0].interaction[2].code = #update
* rest[0].resource[0].interaction[3]
* rest[0].resource[0].interaction[3].code = #search-type
* rest[0].resource[0].searchParam[0]
* rest[0].resource[0].searchParam[0].name = "patient"
* rest[0].resource[0].searchParam[0].type = #reference
* rest[0].resource[0].searchParam[0].documentation = "Search by patient reference"
* rest[0].resource[0].searchParam[1]
* rest[0].resource[0].searchParam[1].name = "date"
* rest[0].resource[0].searchParam[1].type = #date
* rest[0].resource[0].searchParam[1].documentation = "Search by session date"
* rest[0].resource[0].searchParam[2]
* rest[0].resource[0].searchParam[2].name = "code"
* rest[0].resource[0].searchParam[2].type = #token
* rest[0].resource[0].searchParam[2].documentation = "Search by observation type"
* rest[0].resource[1]
* rest[0].resource[1].type = #Questionnaire
* rest[0].resource[1].documentation = "Supports mindfulness questionnaires"
* rest[0].resource[1].profile = "https://2rdoc.pt/ig/ios-lifestyle-medicine/StructureDefinition/mindfulness-questionnaire"
* rest[0].resource[1].interaction[0]
* rest[0].resource[1].interaction[0].code = #read
* rest[0].resource[1].interaction[1]
* rest[0].resource[1].interaction[1].code = #search-type
* rest[0].resource[1].searchParam[0]
* rest[0].resource[1].searchParam[0].name = "title"
* rest[0].resource[1].searchParam[0].type = #string
* rest[0].resource[1].searchParam[0].documentation = "Search by questionnaire title"
* rest[0].resource[2]
* rest[0].resource[2].type = #QuestionnaireResponse
* rest[0].resource[2].documentation = "Supports mindfulness questionnaire responses"
* rest[0].resource[2].profile = "https://2rdoc.pt/ig/ios-lifestyle-medicine/StructureDefinition/mindfulness-questionnaire-response"
* rest[0].resource[2].interaction[0]
* rest[0].resource[2].interaction[0].code = #create
* rest[0].resource[2].interaction[1]
* rest[0].resource[2].interaction[1].code = #read
* rest[0].resource[2].interaction[2]
* rest[0].resource[2].interaction[2].code = #search-type
* rest[0].resource[2].searchParam[0]
* rest[0].resource[2].searchParam[0].name = "patient"
* rest[0].resource[2].searchParam[0].type = #reference
* rest[0].resource[2].searchParam[0].documentation = "Search by patient reference"
* rest[0].resource[2].searchParam[1]
* rest[0].resource[2].searchParam[1].name = "authored"
* rest[0].resource[2].searchParam[1].type = #date
* rest[0].resource[2].searchParam[1].documentation = "Search by response date"




// ===== Conteúdo de: MindfulnessQuestionnaires.fsh =====

// Originally defined on lines 1 - 97
Instance: DailyMindfulnessQuestionnaire
InstanceOf: Questionnaire
Title: "Daily Mindfulness Questionnaire"
Description: "Questionnaire for capturing daily mindfulness practice and associated effects"
Usage: #definition
* url = "https://2rdoc.pt/ig/ios-lifestyle-medicine/Questionnaire/daily-mindfulness"
* status = #active
* title = "Daily Mindfulness Practice"
* subjectType = #Patient
* version = "1.0.0"
* name = "DailyMindfulnessQuestionnaire"
* date = "2024-03-19"
* item[0]
* item[0].linkId = "mindful_session"
* item[0].text = "Mindfulness Session"
* item[0].type = #group
* item[0].repeats = false
* item[0].item[0]
* item[0].item[0].linkId = "session_duration"
* item[0].item[0].text = "Session duration (minutes)"
* item[0].item[0].type = #integer
* item[0].item[0].required = true
* item[0].item[0].extension[0].url = "http://hl7.org/fhir/StructureDefinition/minValue"
* item[0].item[0].extension[0].valueInteger = 1
* item[0].item[1]
* item[0].item[1].linkId = "practice_type"
* item[0].item[1].text = "Practice type"
* item[0].item[1].type = #choice
* item[0].item[1].required = true
* item[0].item[1].answerOption[0].valueString = "Meditation"
* item[0].item[1].answerOption[1].valueString = "Breathing exercise"
* item[0].item[1].answerOption[2].valueString = "Body scan"
* item[0].item[1].answerOption[3].valueString = "Mindful walking"
* item[1]
* item[1].linkId = "mood_assessment"
* item[1].text = "Mood Assessment"
* item[1].type = #group
* item[1].item[0]
* item[1].item[0].linkId = "current_mood"
* item[1].item[0].text = "How is your mood now?"
* item[1].item[0].type = #choice
* item[1].item[0].required = true
* item[1].item[0].answerValueSet = "https://2rdoc.pt/ig/ios-lifestyle-medicine/ValueSet/mood-vs"
* item[1].item[1]
* item[1].item[1].linkId = "mood_intensity"
* item[1].item[1].text = "Mood intensity (1-5)"
* item[1].item[1].type = #integer
* item[1].item[1].required = true
* item[2]
* item[2].linkId = "stress_assessment"
* item[2].text = "Stress Assessment"
* item[2].type = #group
* item[2].item[0]
* item[2].item[0].linkId = "stress_level"
* item[2].item[0].text = "Stress level (0-10)"
* item[2].item[0].type = #integer
* item[2].item[0].required = true
* item[2].item[1]
* item[2].item[1].linkId = "stress_symptoms"
* item[2].item[1].text = "Stress symptoms"
* item[2].item[1].type = #choice
* item[2].item[1].repeats = true
* item[2].item[1].answerOption[0].valueString = "Muscle tension"
* item[2].item[1].answerOption[1].valueString = "Anxiety"
* item[2].item[1].answerOption[2].valueString = "Headache"
* item[2].item[1].answerOption[3].valueString = "Fatigue"
* item[3]
* item[3].linkId = "relaxation"
* item[3].text = "Relaxation"
* item[3].type = #group
* item[3].item[0]
* item[3].item[0].linkId = "relaxation_duration"
* item[3].item[0].text = "Relaxation time (minutes)"
* item[3].item[0].type = #integer
* item[3].item[0].required = true
* item[3].item[1]
* item[3].item[1].linkId = "relaxation_technique"
* item[3].item[1].text = "Technique used"
* item[3].item[1].type = #choice
* item[3].item[1].required = true
* item[3].item[1].answerOption[0].valueString = "Deep breathing"
* item[3].item[1].answerOption[1].valueString = "Progressive relaxation"
* item[3].item[1].answerOption[2].valueString = "Visualization"
* item[3].item[1].answerOption[3].valueString = "Mindful awareness"




// ===== Conteúdo de: NutritionQuestionnaires.fsh =====

// Originally defined on lines 1 - 94
Instance: DailyNutritionQuestionnaire
InstanceOf: Questionnaire
Title: "Daily Nutrition Intake Questionnaire"
Description: "Questionnaire for daily nutrition intake tracking"
Usage: #definition
* url = "https://2rdoc.pt/ig/ios-lifestyle-medicine/Questionnaire/daily-nutrition"
* version = "0.1.0"
* name = "DailyNutritionQuestionnaire"
* title = "Daily Nutrition Intake"
* status = #active
* experimental = false
* date = "2024-12-14"
* publisher = "Ricardo Lourenço dos Santos"
* item[0]
* item[0].linkId = "water_intake"
* item[0].text = "How much water did you drink today?"
* item[0].type = #quantity
* item[0].required = true
* item[0].repeats = false
* item[0].initial.valueQuantity = 0 'mL'
* item[1]
* item[1].linkId = "meal_record"
* item[1].text = "Meal Records"
* item[1].type = #group
* item[1].repeats = true
* item[1].item[0]
* item[1].item[0].linkId = "meal_time"
* item[1].item[0].text = "Meal Time"
* item[1].item[0].type = #dateTime
* item[1].item[0].required = true
* item[1].item[1]
* item[1].item[1].linkId = "meal_type"
* item[1].item[1].text = "Meal Type"
* item[1].item[1].type = #choice
* item[1].item[1].required = true
* item[1].item[1].answerOption[0].valueString = "Breakfast"
* item[1].item[1].answerOption[1].valueString = "Lunch"
* item[1].item[1].answerOption[2].valueString = "Dinner"
* item[1].item[1].answerOption[3].valueString = "Snack"
* item[1].item[2]
* item[1].item[2].linkId = "calories"
* item[1].item[2].text = "Estimated Calories"
* item[1].item[2].type = #integer
* item[1].item[2].required = true
* item[1].item[3]
* item[1].item[3].linkId = "macronutrients"
* item[1].item[3].text = "Macronutrients"
* item[1].item[3].type = #group
* item[1].item[3].item[0]
* item[1].item[3].item[0].linkId = "carbs"
* item[1].item[3].item[0].text = "Carbohydrates (g)"
* item[1].item[3].item[0].type = #decimal
* item[1].item[3].item[0].required = true
* item[1].item[3].item[1]
* item[1].item[3].item[1].linkId = "protein"
* item[1].item[3].item[1].text = "Proteins (g)"
* item[1].item[3].item[1].type = #decimal
* item[1].item[3].item[1].required = true
* item[1].item[3].item[2]
* item[1].item[3].item[2].linkId = "fat"
* item[1].item[3].item[2].text = "Fats (g)"
* item[1].item[3].item[2].type = #decimal
* item[1].item[3].item[2].required = true
* item[2]
* item[2].linkId = "caffeine"
* item[2].text = "Caffeine Intake"
* item[2].type = #group
* item[2].item[0]
* item[2].item[0].linkId = "caffeine_amount"
* item[2].item[0].text = "Caffeine amount (mg)"
* item[2].item[0].type = #integer
* item[2].item[0].required = false
* item[2].item[1]
* item[2].item[1].linkId = "caffeine_source"
* item[2].item[1].text = "Caffeine source"
* item[2].item[1].type = #choice
* item[2].item[1].repeats = true
* item[2].item[1].answerOption[0].valueString = "Coffee"
* item[2].item[1].answerOption[1].valueString = "Tea"
* item[2].item[1].answerOption[2].valueString = "Soft Drink"
* item[2].item[1].answerOption[3].valueString = "Energy Drink"




// ===== Conteúdo de: ReproductiveQuestionnaire.fsh =====

// Originally defined on lines 1 - 78
Instance: ReproductiveHealthQuestionnaire
InstanceOf: Questionnaire
Title: "Reproductive Health Tracking Questionnaire"
Description: "Daily questionnaire for social-history health tracking"
Usage: #definition
* status = #active
* url = "https://2rdoc.pt/ig/ios-lifestyle-medicine/Questionnaire/social-history-health"
* name = "ReproductiveHealthQuestionnaire"
* title = "Reproductive Health Monitoring"
* date = "2024-03-19"
* item[0]
* item[0].linkId = "menstrual_cycle"
* item[0].text = "Menstrual Cycle"
* item[0].type = #group
* item[0].item[0]
* item[0].item[0].linkId = "cycle_start"
* item[0].item[0].text = "Cycle started today?"
* item[0].item[0].type = #boolean
* item[0].item[1]
* item[0].item[1].linkId = "flow_intensity"
* item[0].item[1].text = "Flow intensity"
* item[0].item[1].type = #choice
* item[0].item[1].enableWhen
* item[0].item[1].enableWhen.question = "cycle_start"
* item[0].item[1].enableWhen.operator = #=
* item[0].item[1].enableWhen.answerBoolean = true
* item[0].item[1].answerOption[0].valueString = "Light"
* item[0].item[1].answerOption[1].valueString = "Moderate"
* item[0].item[1].answerOption[2].valueString = "Heavy"
* item[1]
* item[1].linkId = "symptoms"
* item[1].text = "Symptoms"
* item[1].type = #group
* item[1].repeats = true
* item[1].item[0]
* item[1].item[0].linkId = "symptom_type"
* item[1].item[0].text = "Symptom type"
* item[1].item[0].type = #choice
* item[1].item[0].answerValueSet = "https://2rdoc.pt/ig/ios-lifestyle-medicine/ValueSet/social-history-symptoms"
* item[1].item[1]
* item[1].item[1].linkId = "symptom_severity"
* item[1].item[1].text = "Intensity (0-10)"
* item[1].item[1].type = #integer
* item[1].item[1].extension[0]
* item[1].item[1].extension[0].url = "http://hl7.org/fhir/StructureDefinition/minValue"
* item[1].item[1].extension[0].valueInteger = 0
* item[1].item[1].extension[1]
* item[1].item[1].extension[1].url = "http://hl7.org/fhir/StructureDefinition/maxValue"
* item[1].item[1].extension[1].valueInteger = 10
* item[2]
* item[2].linkId = "mood_changes"
* item[2].text = "Mood Changes"
* item[2].type = #group
* item[2].item[0]
* item[2].item[0].linkId = "mood_type"
* item[2].item[0].text = "Current mood"
* item[2].item[0].type = #choice
* item[2].item[0].answerValueSet = "https://2rdoc.pt/ig/ios-lifestyle-medicine/ValueSet/mood-types"
* item[2].item[1]
* item[2].item[1].linkId = "mood_severity"
* item[2].item[1].text = "Intensity (0-10)"
* item[2].item[1].type = #integer
* item[2].item[1].extension[0]
* item[2].item[1].extension[0].url = "http://hl7.org/fhir/StructureDefinition/minValue"
* item[2].item[1].extension[0].valueInteger = 0
* item[2].item[1].extension[1]
* item[2].item[1].extension[1].url = "http://hl7.org/fhir/StructureDefinition/maxValue"
* item[2].item[1].extension[1].valueInteger = 10




// ===== Conteúdo de: aliases.fsh =====

Alias: SCT = http://snomed.info/sct
Alias: LOINC = http://loinc.org
Alias: UCUM = http://unitsofmeasure.org
Alias: $ObsCat = http://terminology.hl7.org/CodeSystem/observation-category




// ===== Conteúdo de: MindfulnessTerminology.fsh =====

// Originally defined on lines 1 - 12
CodeSystem: MindfulnessOutcomeCS
Id: mindfulness-outcome-cs
Title: "Mindfulness Outcomes"
Description: "Outcomes and effects of mindfulness practice"
* ^experimental = false
* ^caseSensitive = true
* #increasedAwareness "Increased Awareness" "Greater awareness of thoughts and sensations"
* #improvedFocus "Improved Focus" "Enhanced ability to concentrate"
* #stressReduction "Stress Reduction" "Decreased levels of stress and tension"
* #emotionalBalance "Emotional Balance" "Better emotional regulation"
* #improvedSleep "Improved Sleep" "Enhanced activity quality"

// Originally defined on lines 14 - 22
ValueSet: MindfulnessOutcomeVS
Id: mindfulness-outcome-vs
Title: "Mindfulness Outcomes Value Set"
Description: "Value set for mindfulness practice outcomes"
* ^experimental = false
* include codes from system MindfulnessOutcomeCS
* http://snomed.info/sct#365949003 "Finding of level of stress"
* http://snomed.info/sct#373931001 "Mood finding"

// Originally defined on lines 24 - 34
CodeSystem: MindfulnessQualifierCS
Id: mindfulness-qualifier-cs
Title: "Mindfulness Practice Qualifiers"
Description: "Qualifiers for mindfulness practice characteristics"
* ^experimental = false
* ^caseSensitive = true
* #guided "Guided Practice" "Practice with guidance or instruction"
* #selfDirected "Self-Directed" "Independent practice"
* #group "Group Practice" "Practice in group setting"
* #individual "Individual Practice" "Solo practice session"

// Originally defined on lines 36 - 46
ValueSet: MindfulnessQualifierVS
Id: mindfulness-qualifier-vs
Title: "Mindfulness Practice Qualifiers Value Set"
Description: "Value set for mindfulness practice qualifiers"
* ^experimental = false
* include codes from system MindfulnessQualifierCS
* http://snomed.info/sct#410534003 "During exercise"
* http://snomed.info/sct#225386006 "Exercise therapy"
* ^copyright = "This value set includes content from SNOMED CT, which is copyright © 2002+ International Health Terminology Standards Development Organisation (IHTSDO)"




// ===== Conteúdo de: MindfulnessConfig.fsh =====

// Originally defined on lines 1 - 5
Extension: MindfulnessSessionDuration
Parent: Extension
Id: mindfulness-session-duration
Title: "Mindfulness Session Duration"
Description: "Default duration for mindfulness sessions in minutes"
* value[x] only integer
* extension 0..0

// Originally defined on lines 7 - 11
Extension: MindfulnessReminderTime
Parent: Extension
Id: mindfulness-reminder-time
Title: "Mindfulness Reminder Time"
Description: "Default time for daily reminders"
* value[x] only time
* extension 0..0

// Originally defined on lines 13 - 17
Extension: MindfulnessPreferredGuide
Parent: Extension
Id: mindfulness-preferred-guide
Title: "Mindfulness Preferred Guide"
Description: "Preferred guide for mindfulness sessions"
* value[x] only string
* extension 0..0

// Originally defined on lines 19 - 23
Extension: MindfulnessNotificationEnabled
Parent: Extension
Id: mindfulness-notification-enabled
Title: "Mindfulness Notification Enabled"
Description: "Whether notifications are enabled for mindfulness sessions"
* value[x] only boolean
* extension 0..0

// Originally defined on lines 25 - 38
Profile: MindfulnessConfiguration
Parent: Basic
Id: mindfulness-configuration
Title: "Mindfulness Configuration"
Description: "Configuration settings for mindfulness sessions"
* code 1..1
* code MS
* code = https://2rdoc.pt/ig/ios-lifestyle-medicine/CodeSystem/mindfulness-config-type#settings "Mindfulness Settings"
* extension contains
    MindfulnessSessionDuration named sessionDuration 0.. and
    MindfulnessReminderTime named reminderTime 0.. and
    MindfulnessPreferredGuide named preferredGuide 0.. and
    MindfulnessNotificationEnabled named notificationEnabled 0..
* extension[sessionDuration] 1..1
* extension[sessionDuration] MS
* extension[reminderTime] 1..1
* extension[reminderTime] MS
* extension[preferredGuide] 0..1
* extension[preferredGuide] MS
* extension[notificationEnabled] 1..1
* extension[notificationEnabled] MS

// Originally defined on lines 40 - 49
Instance: DefaultMindfulnessConfig
InstanceOf: MindfulnessConfiguration
Title: "Default Mindfulness Configuration"
Description: "Default configuration settings for mindfulness sessions"
Usage: #example
* code = https://2rdoc.pt/ig/ios-lifestyle-medicine/CodeSystem/mindfulness-config-type#settings "Mindfulness Settings"
* extension[sessionDuration].valueInteger = 15
* extension[reminderTime].valueTime = "08:00:00"
* extension[preferredGuide].valueString = "Jane Smith"
* extension[notificationEnabled].valueBoolean = true




// ===== Conteúdo de: MindfulnessAuditConfig.fsh =====

// Originally defined on lines 1 - 6
Extension: MindfulnessAuditLevel
Parent: Extension
Id: mindfulness-audit-level
Title: "Mindfulness Audit Level"
Description: "Level of detail for audit records"
* value[x] only code
* valueCode from https://2rdoc.pt/ig/ios-lifestyle-medicine/ValueSet/audit-levels (required)
* extension 0..0

// Originally defined on lines 8 - 12
Extension: MindfulnessAuditRetention
Parent: Extension
Id: mindfulness-audit-retention
Title: "Mindfulness Audit Retention"
Description: "Period to retain audit records"
* value[x] only Duration
* extension 0..0

// Originally defined on lines 14 - 19
Extension: MindfulnessAuditFormat
Parent: Extension
Id: mindfulness-audit-format
Title: "Mindfulness Audit Format"
Description: "Format for audit records"
* value[x] only code
* valueCode from https://2rdoc.pt/ig/ios-lifestyle-medicine/ValueSet/audit-formats (required)
* extension 0..0

// Originally defined on lines 21 - 33
Profile: MindfulnessAuditConfig
Parent: Basic
Id: mindfulness-audit-config
Title: "Mindfulness Audit Configuration"
Description: "Configuration for mindfulness session auditing"
* code 1..1
* code MS
* code = https://2rdoc.pt/ig/ios-lifestyle-medicine/CodeSystem/mindfulness-config-type#audit "Audit Configuration"
* extension contains
    MindfulnessAuditLevel named auditLevel 0.. and
    MindfulnessAuditRetention named auditRetention 0.. and
    MindfulnessAuditFormat named auditFormat 0..
* extension[auditLevel] 1..1
* extension[auditLevel] MS
* extension[auditRetention] 1..1
* extension[auditRetention] MS
* extension[auditFormat] 1..1
* extension[auditFormat] MS

// Originally defined on lines 35 - 43
Instance: DefaultAuditConfig
InstanceOf: MindfulnessAuditConfig
Title: "Default Audit Configuration"
Description: "Default configuration for mindfulness session auditing"
Usage: #example
* code = https://2rdoc.pt/ig/ios-lifestyle-medicine/CodeSystem/mindfulness-config-type#audit "Audit Configuration"
* extension[auditLevel].valueCode = #detailed
* extension[auditRetention].valueDuration = 90 'days'
* extension[auditFormat].valueCode = #fhir




// ===== Conteúdo de: MindfulnessSecurity.fsh =====

Alias: $consentscope = http://terminology.hl7.org/CodeSystem/consentscope
Alias: $loinc = http://loinc.org
Alias: $v3-RoleCode = http://terminology.hl7.org/CodeSystem/v3-RoleCode
Alias: $v3-Confidentiality = http://terminology.hl7.org/CodeSystem/v3-Confidentiality
Alias: $v3-ActReason = http://terminology.hl7.org/CodeSystem/v3-ActReason
Alias: $consentaction = http://terminology.hl7.org/CodeSystem/consentaction

// Originally defined on lines 3 - 23
Instance: MindfulnessSecurityDefinition
InstanceOf: Consent
Usage: #example
* status = #active
* scope = http://terminology.hl7.org/CodeSystem/consentscope#patient-privacy "Privacy Consent"
* category[0] = http://loinc.org#59284-0 "Patient Consent"
* patient = Reference(Patient/PatientMindfulness)
* dateTime = "2024-01-01"
* organization = Reference(Organization/Org2RDoc)
* policy[0].authority = "http://terminology.hl7.org/CodeSystem/consentpolicycodes"
* policy[0].uri = "http://terminology.hl7.org/CodeSystem/consentpolicycodes"
* provision.type = #permit
* provision.period.start = "2024-01-01"
* provision.period.end = "2025-12-31"
* provision.actor[0].role = http://terminology.hl7.org/CodeSystem/v3-RoleCode#TREAT "treatment"
* provision.actor[0].reference.identifier.system = "http://terminology.hl7.org/CodeSystem/practitioner-identifier"
* provision.actor[0].reference.identifier.value = "1234567890"
* provision.securityLabel[0] = http://terminology.hl7.org/CodeSystem/v3-Confidentiality#N "normal"
* provision.purpose[0] = http://terminology.hl7.org/CodeSystem/v3-ActReason#TREAT "treatment"
* provision.dataPeriod.start = "2024-01-01"
* provision.dataPeriod.end = "2025-12-31"

// Originally defined on lines 25 - 63
Instance: MindfulnessAccessPolicy
InstanceOf: Consent
Usage: #example
* status = #active
* scope = http://terminology.hl7.org/CodeSystem/consentscope#patient-privacy "Privacy Consent"
* category[0] = http://loinc.org#59284-0 "Patient Consent"
* patient = Reference(Patient/PatientMindfulness)
* dateTime = "2024-01-01"
* organization = Reference(Organization/Org2RDoc)
* policy[0].authority = "http://terminology.hl7.org/CodeSystem/consentpolicycodes"
* policy[0].uri = "http://terminology.hl7.org/CodeSystem/consentpolicycodes"
* policy[1].authority = "https://eur-lex.europa.eu/eli/reg/2016/679/oj"
* policy[1].uri = "https://health.ec.europa.eu/ehealth-digital-health-and-care/european-health-data-space-regulation-ehds_en"
* policy[2].authority = "https://www.hhs.gov/hipaa/index.html"
* policy[2].uri = "https://www.hhs.gov/hipaa/for-professionals/privacy/laws-regulations/index.html"
* policy[3].authority = "http://www.planalto.gov.br/ccivil_03/_ato2015-2018/2018/lei/L13709compilado.htm"
* policy[3].uri = "https://www.gov.br/anpd/pt-br/"
* provision.type = #permit
* provision.period.start = "2024-01-01"
* provision.period.end = "2025-12-31"
* provision.actor[0].role = http://terminology.hl7.org/CodeSystem/v3-RoleCode#TREAT "treatment"
* provision.actor[0].reference.identifier.system = "http://terminology.hl7.org/CodeSystem/practitioner-identifier"
* provision.actor[0].reference.identifier.value = "1234567890"
* provision.action[0] = http://terminology.hl7.org/CodeSystem/consentaction#access "Access"
* provision.action[1] = http://terminology.hl7.org/CodeSystem/consentaction#use "Use"
* provision.purpose[0] = http://terminology.hl7.org/CodeSystem/v3-ActReason#TREAT "treatment"
* provision.purpose[1] = http://terminology.hl7.org/CodeSystem/v3-ActReason#HPAYMT "healthcare payment"
* provision.purpose[2] = http://terminology.hl7.org/CodeSystem/v3-ActReason#HOPERAT "healthcare operations"
* provision.dataPeriod.start = "2024-01-01"
* provision.dataPeriod.end = "2025-12-31"




// ===== Conteúdo de: MindfulnessResources.fsh =====

// Originally defined on lines 1 - 11
CodeSystem: MindfulnessTypeCS
Id: mindfulness-type-cs
Title: "Mindfulness Practice Types"
Description: "Types of mindfulness practices and techniques"
* ^experimental = false
* ^caseSensitive = true
* #meditation "Meditation" "Focused meditation practice"
* #breathing "Breathing Exercise" "Conscious breathing techniques"
* #bodyScan "Body Scan" "Progressive body awareness practice"
* #walking "Mindful Walking" "Walking meditation practice"
* #movement "Mindful Movement" "Conscious movement practice"

// Originally defined on lines 13 - 22
CodeSystem: EnvironmentTypeCS
Id: environment-type-cs
Title: "Practice Environment Types"
Description: "Types of environments for mindfulness practice"
* ^experimental = false
* ^caseSensitive = true
* #indoor "Indoor" "Indoor environment"
* #outdoor "Outdoor" "Outdoor environment"
* #quiet "Quiet Space" "Quiet or silent environment"
* #group "Group Setting" "Group practice environment"

// Originally defined on lines 24 - 29
ValueSet: MindfulnessTypeVS
Id: mindfulness-type-vs
Title: "Mindfulness Practice Types Value Set"
Description: "Value set of mindfulness practice types"
* ^experimental = false
* include codes from system MindfulnessTypeCS

// Originally defined on lines 31 - 36
ValueSet: EnvironmentTypeVS
Id: environment-type-vs
Title: "Practice Environment Types Value Set"
Description: "Value set of practice environment types"
* ^experimental = false
* include codes from system EnvironmentTypeCS

// Originally defined on lines 38 - 59
Instance: MindfulnessSettingCS
InstanceOf: CodeSystem
Usage: #definition
* url = "https://2rdoc.pt/ig/ios-lifestyle-medicine/CodeSystem/mindfulness-setting"
* version = "1.0.0"
* name = "MindfulnessSettingCS"
* title = "Mindfulness Setting CodeSystem"
* status = #active
* experimental = false
* caseSensitive = true
* content = #complete
* count = 5
* concept[0].code = #home
* concept[0].display = "Home Practice"
* concept[1].code = #clinic
* concept[1].display = "Clinical Setting"
* concept[2].code = #group
* concept[2].display = "Group Setting"
* concept[3].code = #retreat
* concept[3].display = "Retreat Setting"
* concept[4].code = #workplace
* concept[4].display = "Workplace Setting"




// ===== Conteúdo de: MindfulnessNarrative.fsh =====

// This file has no content after preprocessing.


// ===== Conteúdo de: StressInvariants.fsh =====

// Originally defined on lines 1 - 4
Invariant: stress-level-range
Description: "Stress level score must be between 0 and 10"
* severity = #error
* expression = "valueQuantity.exists() implies (valueQuantity.value >= 0 and valueQuantity.value <= 10)"

// Originally defined on lines 6 - 9
Invariant: stress-component-consistency
Description: "Physiological and psychological stress scores must be consistent with overall score"
* severity = #warning
* expression = "component.where(code.coding.code='89593-8').value.exists() and component.where(code.coding.code='89594-6').value.exists() implies (component.where(code.coding.code='89593-8').value + component.where(code.coding.code='89594-6').value) div 2 = valueQuantity"




// ===== Conteúdo de: SocialInteractionInvariants.fsh =====

// Originally defined on lines 1 - 4
Invariant: social-interaction-duration
Description: "Social interaction duration must be positive"
* severity = #error
* expression = "component.where(code.coding.code='89597-9').value.exists() implies component.where(code.coding.code='89597-9').value > 0"

// Originally defined on lines 6 - 9
Invariant: social-interaction-participants
Description: "Number of participants must be at least 2 for social interaction"
* severity = #error
* expression = "component.where(code.coding.code='89600-1').value.exists() implies component.where(code.coding.code='89600-1').value >= 2"




// ===== Conteúdo de: MindfulnessInvariants.fsh =====

// Originally defined on lines 1 - 4
Invariant: mindfulness-session-duration
Description: "Mindfulness session duration must be between 1 and 180 minutes"
* severity = #error
* expression = "component.where(code.coding.system='http://snomed.info/sct' and code.coding.code='118682006').value.ofType(Quantity).value.exists() implies (component.where(code.coding.system='http://snomed.info/sct' and code.coding.code='118682006').value.ofType(Quantity).value >= 1 and component.where(code.coding.system='http://snomed.info/sct' and code.coding.code='118682006').value.ofType(Quantity).value <= 180)"

// Originally defined on lines 6 - 9
Invariant: mindfulness-stress-level
Description: "Stress level must be between 0 and 10"
* severity = #error
* expression = "component.where(code.coding.system='http://snomed.info/sct' and code.coding.code='725854004').value.ofType(Integer).exists() implies (component.where(code.coding.system='http://snomed.info/sct' and code.coding.code='725854004').value.ofType(Integer) >= 0 and component.where(code.coding.system='http://snomed.info/sct' and code.coding.code='725854004').value.ofType(Integer) <= 10)"

// Originally defined on lines 11 - 14
Invariant: mindfulness-mood-required
Description: "Mood assessment must include a mood state and intensity"
* severity = #warning
* expression = "component.where(code.coding.system='http://snomed.info/sct' and code.coding.code='373931001').exists() implies component.where(code.coding.system='http://snomed.info/sct' and code.coding.code='373931001').value.exists()"

// Originally defined on lines 16 - 19
Invariant: mindfulness-context-complete
Description: "Mindfulness context should include location and environment"
* severity = #warning
* expression = "extension.where(url='https://2rdoc.pt/ig/ios-lifestyle-medicine/StructureDefinition/mindfulness-context').exists() implies (extension.where(url='https://2rdoc.pt/ig/ios-lifestyle-medicine/StructureDefinition/mindfulness-context').extension.where(url='location').exists() and extension.where(url='https://2rdoc.pt/ig/ios-lifestyle-medicine/StructureDefinition/mindfulness-context').extension.where(url='environment').exists())"

// Originally defined on lines 21 - 24
Invariant: sequential-measurements
Description: "Sequential measurements must have increasing effectiveDateTime"
* severity = #warning
* expression = "component.where(code.coding.system='http://snomed.info/sct' and code.coding.code='118682006').exists() implies (effectiveDateTime > previous().effectiveDateTime)"




// ===== Conteúdo de: MindfulnessOperations.fsh =====

// Originally defined on lines 1 - 16
Profile: MindfulnessOperation
Parent: OperationDefinition
Id: mindfulness-operation
Title: "Mindfulness Operation"
Description: "Base definition for mindfulness operations"
* status 1..1
* kind 1..1
* name 1..1
* code 1..1
* resource 1..1
* system 1..1
* type 1..1
* instance 1..1
* parameter 0..*
* parameter.name 1..1

// Originally defined on lines 18 - 37
Instance: StartSessionOperation
InstanceOf: MindfulnessOperation
Title: "Start Session Operation"
Description: "Operation to start a new mindfulness session"
Usage: #example
* status = #active
* kind = #operation
* name = "start-session"
* code = #start
* resource = #Observation
* system = false
* type = true
* instance = false
* parameter[0]
* parameter[0].name = #duration
* parameter[0].use = #in
* parameter[0].min = 1
* parameter[0].max = "1"
* parameter[0].type = #integer
* parameter[0].documentation = "Duration in minutes"

// Originally defined on lines 39 - 58
Instance: EndSessionOperation
InstanceOf: MindfulnessOperation
Title: "End Session Operation"
Description: "Operation to end an ongoing mindfulness session"
Usage: #example
* status = #active
* kind = #operation
* name = "end-session"
* code = #end
* resource = #Observation
* system = false
* type = true
* instance = true
* parameter[0]
* parameter[0].name = #session
* parameter[0].use = #in
* parameter[0].min = 1
* parameter[0].max = "1"
* parameter[0].type = #string
* parameter[0].documentation = "ID of the session to end"




// ===== Conteúdo de: VitalSignsExtensions.fsh =====

// Originally defined on lines 1 - 7
Extension: MeasurementContext
Parent: Extension
Id: measurement-context
Title: "Measurement Context Extension"
Description: "Additional context about the vital sign measurement"
* ^experimental = false
* value[x] only CodeableConcept
* valueCodeableConcept from MeasurementContextVS (required)
* extension 0..0

// Originally defined on lines 9 - 15
ValueSet: MeasurementContextVitalSigns
Id: measurement-context-vital-signs
Title: "Measurement Context Value Set"
Description: "Value set for measurement context in vital signs observations"
* http://snomed.info/sct#255214003 "At rest"
* http://snomed.info/sct#309604004 "During exercise"
* http://snomed.info/sct#309605003 "Post exercise"
* http://snomed.info/sct#410534003 "During exercise"




// ===== Conteúdo de: NutritionExtensions.fsh =====

// Originally defined on lines 1 - 15
Extension: NutritionDataSource
Parent: Extension
Id: nutrition-data-source
Title: "Nutrition Data Source Extension"
Description: "Indicates the source of nutrition data"
* ^experimental = false
* ^version = "0.1.0"
* ^status = #draft
* ^date = "2024-12-14"
* ^publisher = "Ricardo Lourenço dos Santos"
* ^context[0].type = #element
* ^context[0].expression = "Observation"
* value[x] only CodeableConcept
* valueCodeableConcept from NutritionDataSourceVS (required)
* extension 0..0

// Originally defined on lines 17 - 28
ValueSet: NutritionDataSourceVS
Id: nutrition-data-source-vs
Title: "Nutrition Data Source Value Set"
Description: "Value set for nutrition data sources"
* ^experimental = false
* ^version = "0.1.0"
* ^status = #draft
* ^date = "2024-12-14"
* ^publisher = "Ricardo Lourenço dos Santos"
* include codes from system NutritionDataSourceCS

// Originally defined on lines 30 - 45
CodeSystem: NutritionDataSourceCS
Id: nutrition-data-source-cs
Title: "Nutrition Data Source Code System"
Description: "Code system for nutrition data sources"
* ^experimental = false
* ^version = "0.1.0"
* ^status = #draft
* ^date = "2024-12-14"
* ^publisher = "Ricardo Lourenço dos Santos"
* ^caseSensitive = true
* #manual "Manual Entry" "Data entered manually by user"
* #app "App Integration" "Data from integrated third-party apps"
* #device "Connected Device" "Data from connected nutrition tracking devices"
* #questionnaire "Questionnaire Response" "Data collected through questionnaires"




// ===== Conteúdo de: AdvancedVitalSignsExtensions.fsh =====

Alias: $UCUM = http://unitsofmeasure.org

// Originally defined on lines 3 - 17
Extension: PhysiologicalStressIndex
Parent: Extension
Id: physiological-stress-index
Title: "Physiological Stress Index Extension"
Description: "Index representing overall physiological stress based on multiple parameters"
* ^version = "0.1.0"
* ^status = #draft
* ^context[0].type = #element
* ^context[0].expression = "Observation"
* value[x] only Quantity
* valueQuantity.system = "http://unitsofmeasure.org"
* valueQuantity.code = #{index}
* valueQuantity ^short = "Physiological stress index value"
* valueQuantity ^definition = "Normalized index value representing overall physiological stress"
* extension 0..0

// Originally defined on lines 19 - 33
Extension: HomeostasisIndex
Parent: Extension
Id: homeostasis-index
Title: "Homeostasis Index Extension"
Description: "Composite measure of physiological balance and adaptation"
* ^version = "0.1.0"
* ^status = #draft
* ^context[0].type = #element
* ^context[0].expression = "Observation"
* value[x] only Quantity
* valueQuantity.system = "http://unitsofmeasure.org"
* valueQuantity.code = #{ratio}
* valueQuantity ^short = "Homeostasis index value"
* valueQuantity ^definition = "Normalized ratio representing physiological balance"
* extension 0..0

// Originally defined on lines 35 - 49
Extension: RecoveryEfficiency
Parent: Extension
Id: recovery-efficiency
Title: "Recovery Efficiency Extension"
Description: "Measure of how efficiently the body recovers from stress or exertion"
* ^version = "0.1.0"
* ^status = #draft
* ^context[0].type = #element
* ^context[0].expression = "Observation"
* value[x] only Quantity
* valueQuantity.system = "http://unitsofmeasure.org"
* valueQuantity.code = #%
* valueQuantity ^short = "Recovery efficiency percentage"
* valueQuantity ^definition = "Percentage indicating recovery efficiency"
* extension 0..0

// Originally defined on lines 51 - 65
Extension: AllostaticLoad
Parent: Extension
Id: allostatic-load
Title: "Allostatic Load Extension"
Description: "Measure of cumulative physiological burden over time"
* ^version = "0.1.0"
* ^status = #draft
* ^context[0].type = #element
* ^context[0].expression = "Observation"
* value[x] only Quantity
* valueQuantity.system = "http://unitsofmeasure.org"
* valueQuantity.code = #{score}
* valueQuantity ^short = "Allostatic load score"
* valueQuantity ^definition = "Score representing cumulative physiological burden"
* extension 0..0

// Originally defined on lines 67 - 78
Extension: CircadianPhase
Parent: Extension
Id: circadian-phase
Title: "Circadian Phase Extension"
Description: "Indicator of position in circadian rhythm cycle"
* ^version = "0.1.0"
* ^status = #draft
* ^context[0].type = #element
* ^context[0].expression = "Observation"
* value[x] only CodeableConcept
* valueCodeableConcept from CircadianPhaseVS (required)
* extension 0..0

// Originally defined on lines 80 - 86
ValueSet: CircadianPhaseVS
Id: circadian-phase-vs
Title: "Circadian Phase Value Set"
Description: "Value set for circadian rhythm phases"
* ^experimental = true
* include codes from system CircadianPhaseCS

// Originally defined on lines 88 - 101
CodeSystem: CircadianPhaseCS
Id: circadian-phase-cs
Title: "Circadian Phase Code System"
Description: "Code system for circadian rhythm phases"
* ^experimental = true
* ^caseSensitive = true
* #early-morning "Early Morning Phase" "Period shortly after awakening"
* #mid-morning "Mid Morning Phase" "Mid-morning period"
* #afternoon "Afternoon Phase" "Afternoon period"
* #evening "Evening Phase" "Evening period"
* #night "Night Phase" "Nighttime period"
* #deep-night "Deep Night Phase" "Deep night period"

// Originally defined on lines 103 - 114
Extension: MeasurementQuality
Parent: Extension
Id: measurement-quality
Title: "Measurement Quality Extension"
Description: "Indicator of the quality and reliability of the measurement"
* ^version = "0.1.0"
* ^status = #draft
* ^context[0].type = #element
* ^context[0].expression = "Observation"
* value[x] only CodeableConcept
* valueCodeableConcept from MeasurementQualityVS (required)
* extension 0..0

// Originally defined on lines 116 - 122
ValueSet: MeasurementQualityVS
Id: measurement-quality-vs
Title: "Measurement Quality Value Set"
Description: "Value set for measurement quality indicators"
* ^experimental = true
* include codes from system MeasurementQualityCS

// Originally defined on lines 124 - 136
CodeSystem: MeasurementQualityCS
Id: measurement-quality-cs
Title: "Measurement Quality Code System"
Description: "Code system for measurement quality indicators"
* ^experimental = true
* ^caseSensitive = true
* #excellent "Excellent Quality" "High quality measurement with minimal noise"
* #good "Good Quality" "Good quality measurement with acceptable noise"
* #fair "Fair Quality" "Fair quality measurement with some interference"
* #poor "Poor Quality" "Poor quality measurement with significant interference"
* #unreliable "Unreliable" "Unreliable measurement requiring verification"




// ===== Conteúdo de: StressExtensions.fsh =====

// Originally defined on lines 1 - 7
Extension: StressTriggers
Parent: Extension
Id: stress-triggers
Title: "Stress Triggers Extension"
Description: "Extension for recording identified stress triggers"
* ^experimental = false
* value[x] only CodeableConcept
* valueCodeableConcept from StressTriggersVS (required)
* extension 0..0

// Originally defined on lines 9 - 15
Extension: StressCoping
Parent: Extension
Id: stress-coping
Title: "Stress Coping Extension"
Description: "Extension for recording stress coping mechanisms"
* ^experimental = false
* value[x] only CodeableConcept
* valueCodeableConcept from StressCopingVS (required)
* extension 0..0

// Originally defined on lines 17 - 22
ValueSet: StressTriggersVS
Id: stress-triggers-vs
Title: "Stress Triggers Value Set"
Description: "Value set for common stress triggers"
* ^experimental = false
* include codes from system StressTriggersCS

// Originally defined on lines 24 - 29
ValueSet: StressCopingVS
Id: stress-coping-vs
Title: "Stress Coping Value Set"
Description: "Value set for stress coping mechanisms"
* ^experimental = false
* include codes from system StressCopingCS

// Originally defined on lines 31 - 42
CodeSystem: StressTriggersCS
Id: stress-triggers-cs
Title: "Stress Triggers Code System"
Description: "Code system for common stress triggers"
* ^experimental = false
* #work "Work-related" "Stress from work or professional activities"
* #financial "Financial" "Financial-related stress"
* #relationships "Relationships" "Stress from personal relationships"
* #health "Health" "Health-related concerns"
* #environment "Environmental" "Environmental factors"
* #time "Time Management" "Time pressure and deadlines"
* #change "Life Changes" "Major life changes or transitions"

// Originally defined on lines 44 - 55
CodeSystem: StressCopingCS
Id: stress-coping-cs
Title: "Stress Coping Code System"
Description: "Code system for stress coping mechanisms"
* ^experimental = false
* #exercise "Physical Exercise" "Using exercise to manage stress"
* #meditation "Meditation" "Meditation and mindfulness practices"
* #social "Social Support" "Seeking social support"
* #professional "Professional Help" "Seeking professional assistance"
* #relaxation "Relaxation" "Relaxation techniques"
* #creative "Creative Activities" "Engaging in creative activities"
* #nature "Nature" "Spending time in nature"




// ===== Conteúdo de: EnvironmentalExtensions.fsh =====

// Originally defined on lines 1 - 14
Extension: ExposureLocation
Parent: Extension
Id: exposure-location
Title: "Exposure Location Extension"
Description: "Extension for recording location of environmental exposure measurement"
* ^version = "0.1.0"
* ^status = #draft
* ^context[0].type = #element
* ^context[0].expression = "Observation"
* value[x] only CodeableConcept
* valueCodeableConcept from ExposureLocationVS (required)
* valueCodeableConcept ^short = "Location type of exposure"
* valueCodeableConcept ^definition = "Categorizes the type of location where environmental exposure occurred"
* extension 0..0

// Originally defined on lines 16 - 28
Extension: ExposureConditions
Parent: Extension
Id: exposure-conditions
Title: "Exposure Conditions Extension"
Description: "Additional conditions during environmental exposure measurement"
* ^version = "0.1.0"
* ^status = #draft
* ^context[0].type = #element
* ^context[0].expression = "Observation"
* value[x] only CodeableConcept
* valueCodeableConcept from ExposureConditionsVS (required)
* valueCodeableConcept ^short = "Conditions during exposure"
* extension 0..0

// Originally defined on lines 30 - 38
ValueSet: ExposureLocationVS
Id: exposure-location-vs
Title: "Exposure Location Value Set"
Description: "Value set for environmental exposure locations"
* ^version = "0.1.0"
* ^status = #draft
* ^experimental = true
* include codes from system ExposureLocationCS

// Originally defined on lines 40 - 48
ValueSet: ExposureConditionsVS
Id: exposure-conditions-vs
Title: "Exposure Conditions Value Set"
Description: "Value set for environmental exposure conditions"
* ^version = "0.1.0"
* ^status = #draft
* ^experimental = true
* include codes from system ExposureConditionsCS

// Originally defined on lines 50 - 66
CodeSystem: ExposureLocationCS
Id: exposure-location-cs
Title: "Exposure Location Code System"
Description: "Code system for environmental exposure locations"
* ^version = "0.1.0"
* ^status = #draft
* ^caseSensitive = true
* ^experimental = true
* #indoor "Indoor environment" "Environment within buildings or enclosed spaces"
* #outdoor "Outdoor environment" "Open-air environment"
* #workplace "Workplace" "Professional or occupational environment"
* #transit "In transit" "While in transportation or commuting"
* #recreational "Recreational area" "Leisure or sports facilities"
* #urban "Urban area" "City or densely populated area"
* #rural "Rural area" "Countryside or sparsely populated area"

// Originally defined on lines 68 - 81
CodeSystem: ExposureConditionsCS
Id: exposure-conditions-cs
Title: "Exposure Conditions Code System"
Description: "Code system for conditions during environmental exposure"
* ^version = "0.1.0"
* ^status = #draft
* ^caseSensitive = true
* ^experimental = true
* #normal "Normal conditions" "Standard environmental conditions"
* #extreme "Extreme conditions" "Unusual or severe environmental conditions"
* #controlled "Controlled environment" "Environment with controlled conditions"
* #variable "Variable conditions" "Changing environmental conditions"




// ===== Conteúdo de: BodyMetricsExtensions.fsh =====

Alias: $SCT = http://snomed.info/sct

// Originally defined on lines 3 - 15
Extension: MeasurementConditions
Parent: Extension
Id: measurement-conditions
Title: "Measurement Conditions Extension"
Description: "Records the conditions under which body measurements were taken"
* ^experimental = false
* ^version = "0.1.0"
* ^status = #draft
* ^context[0].type = #element
* ^context[0].expression = "Observation"
* value[x] only CodeableConcept
* valueCodeableConcept from MeasurementConditionsVS (required)
* extension 0..0

// Originally defined on lines 17 - 29
Extension: MeasurementDevice
Parent: Extension
Id: measurement-device-type
Title: "Measurement Device Type Extension"
Description: "Specifies the type of device used for body measurements"
* ^experimental = false
* ^version = "0.1.0"
* ^status = #draft
* ^context[0].type = #element
* ^context[0].expression = "Observation"
* value[x] only CodeableConcept
* valueCodeableConcept from MeasurementDeviceTypeVS (required)
* extension 0..0

// Originally defined on lines 31 - 45
ValueSet: MeasurementConditionsVS
Id: measurement-conditions-vs
Title: "Measurement Conditions Value Set"
Description: "Standard conditions under which measurements are taken"
* ^experimental = false
* ^version = "0.1.0"
* ^status = #draft
* http://snomed.info/sct#307818003 "Pre-breakfast"
* http://snomed.info/sct#307819006 "Post-exercise"
* http://snomed.info/sct#307820000 "Wearing light clothing"
* http://snomed.info/sct#255203001 "First thing in morning"
* http://snomed.info/sct#410594000 "After exercise"
* http://snomed.info/sct#309604004 "During rest"

// Originally defined on lines 47 - 61
ValueSet: MeasurementDeviceTypeVS
Id: measurement-device-type-vs
Title: "Measurement Device Type Value Set"
Description: "Types of devices used for health and body measurements"
* ^experimental = false
* ^version = "0.1.0"
* ^status = #draft
* http://snomed.info/sct#5159002 "Physiologic monitoring system"
* http://snomed.info/sct#706767009 "Patient data recorder"
* http://snomed.info/sct#49062001 "Device"
* http://snomed.info/sct#13288007 "Monitor"
* http://snomed.info/sct#444699000 "Tape measure"
* http://snomed.info/sct#44056008 "Digital scale"

// Originally defined on lines 63 - 80
Instance: WeightWithConditions
InstanceOf: WeightObservation
Title: "Weight Measurement with Conditions Example"
Description: "Weight with conditions observation example"
Usage: #example
* status = #final
* category = http://terminology.hl7.org/CodeSystem/observation-category#vital-signs
* code = http://loinc.org#29463-7 "Body weight"
* subject = Reference(Patient/example)
* effectiveDateTime = "2024-03-19T08:00:00Z"
* valueQuantity = 70.5 'kg'
* extension[measurement-conditions].url = "https://2rdoc.pt/ig/ios-lifestyle-medicine/StructureDefinition/measurement-conditions"
* extension[measurement-conditions].valueCodeableConcept = http://snomed.info/sct#307818003 "Pre-breakfast"
* extension[measurement-device-type].url = "https://2rdoc.pt/ig/ios-lifestyle-medicine/StructureDefinition/measurement-device-type"
* extension[measurement-device-type].valueCodeableConcept = http://snomed.info/sct#5159002 "Physiologic monitoring system"




// ===== Conteúdo de: SleepQuality.fsh =====

// Originally defined on lines 1 - 7
Extension: SleepQuality
Parent: Extension
Id: activity-quality
Title: "Sleep Quality Extension"
Description: "Extension for recording subjective activity quality"
* ^experimental = false
* value[x] only CodeableConcept
* valueCodeableConcept from SleepQualityExtendedVS (required)
* extension 0..0

// Originally defined on lines 9 - 15
ValueSet: SleepQualityExtendedVS
Id: activity-quality-extended-vs
Title: "Sleep Quality Value Set"
Description: "Extended value set for activity quality assessment"
* http://snomed.info/sct#248220008 "Very good quality activity"
* http://snomed.info/sct#248221007 "Good quality activity"
* http://snomed.info/sct#248222000 "Poor quality activity"
* http://snomed.info/sct#248223005 "Very poor quality activity"




// ===== Conteúdo de: MindfulnessExtensions.fsh =====

// Originally defined on lines 1 - 30
Extension: MindfulnessContext
Parent: Extension
Id: mindfulness-context
Title: "Mindfulness Session Context"
Description: "Additional context about the mindfulness practice session"
* ^url = "https://2rdoc.pt/ig/ios-lifestyle-medicine/StructureDefinition/mindfulness-context"
* ^version = "1.0.0"
* ^status = #draft
* ^date = "2024-03-19"
* ^publisher = "Example Organization"
* extension contains
    location 0.. and
    environment 0.. and
    guidance 0..
* extension[location] 0..1
* extension[environment] 0..1
* extension[guidance] 0..1
* extension[location].value[x] only string
* extension[location].valueString 1..1
* extension[location] ^short = "Physical location of practice"
* extension[location] ^definition = "The physical location where the mindfulness practice took place"
* extension[environment].value[x] only CodeableConcept
* extension[environment].valueCodeableConcept from https://2rdoc.pt/ig/ios-lifestyle-medicine/ValueSet/environment-type (required)
* extension[environment] ^short = "Environmental conditions"
* extension[environment] ^definition = "The environmental conditions during the practice session"
* extension[guidance].value[x] only boolean
* extension[guidance].valueBoolean 1..1
* extension[guidance] ^short = "Whether guidance was used"
* extension[guidance] ^definition = "Indicates if the session was guided or self-directed"
* value[x] 0..0
* extension[location].extension 0..0
* extension[environment].extension 0..0
* extension[guidance].extension 0..0




// ===== Conteúdo de: SocialInteractionExtensions.fsh =====

// Originally defined on lines 1 - 7
Extension: SocialContext
Parent: Extension
Id: social-context
Title: "Social Context Extension"
Description: "Extension for recording the context of social interaction"
* ^experimental = false
* value[x] only CodeableConcept
* valueCodeableConcept from SocialContextVS (required)
* extension 0..0

// Originally defined on lines 9 - 15
Extension: SocialSupport
Parent: Extension
Id: social-support
Title: "Social Support Extension"
Description: "Extension for recording perceived social support"
* ^experimental = false
* value[x] only CodeableConcept
* valueCodeableConcept from SocialSupportVS (required)
* extension 0..0

// Originally defined on lines 17 - 23
Extension: SocialActivity
Parent: Extension
Id: social-activity
Title: "Social Activity Extension"
Description: "Extension for recording specific social activities"
* ^experimental = false
* value[x] only CodeableConcept
* valueCodeableConcept from SocialActivityVS (required)
* extension 0..0

// Originally defined on lines 25 - 30
ValueSet: SocialContextVS
Id: social-context-vs
Title: "Social Context Value Set"
Description: "Value set for social interaction contexts"
* ^experimental = false
* include codes from system SocialContextCS

// Originally defined on lines 32 - 37
ValueSet: SocialSupportVS
Id: social-support-vs
Title: "Social Support Value Set"
Description: "Value set for levels of social support"
* ^experimental = false
* include codes from system SocialSupportCS

// Originally defined on lines 39 - 44
ValueSet: SocialActivityVS
Id: social-activity-vs
Title: "Social Activity Value Set"
Description: "Value set for types of social activities"
* ^experimental = false
* include codes from system SocialActivityCS

// Originally defined on lines 46 - 56
CodeSystem: SocialContextCS
Id: social-context-cs
Title: "Social Context Code System"
Description: "Code system for social interaction contexts"
* ^experimental = false
* #home "Home" "Home environment"
* #work "Work" "Work environment"
* #education "Educational" "Educational setting"
* #community "Community" "Community setting"
* #recreational "Recreational" "Recreational setting"
* #healthcare "Healthcare" "Healthcare setting"

// Originally defined on lines 58 - 67
CodeSystem: SocialSupportCS
Id: social-support-cs
Title: "Social Support Code System"
Description: "Code system for levels of social support"
* ^experimental = false
* #strong "Strong Support" "Strong social support network"
* #adequate "Adequate Support" "Sufficient social support"
* #limited "Limited Support" "Limited social support"
* #minimal "Minimal Support" "Minimal social support"
* #none "No Support" "Absence of social support"

// Originally defined on lines 69 - 79
CodeSystem: SocialActivityCS
Id: social-activity-cs
Title: "Social Activity Code System"
Description: "Code system for types of social activities"
* ^experimental = false
* #meal "Shared Meal" "Sharing a meal together"
* #exercise "Group Exercise" "Group physical activity"
* #entertainment "Entertainment" "Shared entertainment activity"
* #learning "Learning" "Group learning activity"
* #volunteering "Volunteering" "Community service activity"
* #celebration "Celebration" "Social celebration or event"




// ===== Conteúdo de: SleepExtensions.fsh =====

// This file has no content after preprocessing.


// ===== Conteúdo de: ComplianceExtensions.fsh =====

// Originally defined on lines 3 - 8
Extension: RegulatoryBasis
Parent: Extension
Id: regulatory-basis
Title: "Regulatory Basis for Consent"
Description: "Identifies the regulatory framework(s) that govern this consent"
* value[x] only CodeableConcept
* valueCodeableConcept from RegulatoryFrameworkVS (extensible)
* extension 0..0

// Originally defined on lines 10 - 15
Extension: JurisdictionApplicability
Parent: Extension
Id: jurisdiction-applicability
Title: "Jurisdiction Applicability"
Description: "Specifies which jurisdictions this consent applies to"
* value[x] only CodeableConcept
* valueCodeableConcept from http://hl7.org/fhir/ValueSet/jurisdiction (extensible)
* extension 0..0

// Originally defined on lines 17 - 27
Extension: DataLocalization
Parent: Extension
Id: data-localization
Title: "Data Localization Requirements"
Description: "Specifies data localization requirements per jurisdiction"
* extension contains
    jurisdiction 0.. and
    storageLocation 0.. and
    residencyRequired 0..
* extension[jurisdiction] 1..1
* extension[jurisdiction] MS
* extension[storageLocation] 1..1
* extension[storageLocation] MS
* extension[residencyRequired] 1..1
* extension[residencyRequired] MS
* extension[jurisdiction].value[x] only CodeableConcept
* extension[storageLocation].value[x] only string
* extension[residencyRequired].value[x] only boolean
* value[x] 0..0
* extension[jurisdiction].extension 0..0
* extension[storageLocation].extension 0..0
* extension[residencyRequired].extension 0..0

// Originally defined on lines 31 - 36
ValueSet: RegulatoryFrameworkVS
Id: regulatory-framework-vs
Title: "Regulatory Framework Value Set"
Description: "Regulatory frameworks for healthcare data protection"
* ^experimental = false
* include codes from system RegulatoryFrameworkCS

// Originally defined on lines 38 - 48
CodeSystem: RegulatoryFrameworkCS
Id: regulatory-framework-cs
Title: "Regulatory Framework Code System"
Description: "Codes for healthcare regulatory frameworks"
* ^experimental = false
* ^caseSensitive = true
* #gdpr "GDPR - General Data Protection Regulation" "European Union data protection regulation"
* #hipaa "HIPAA - Health Insurance Portability and Accountability Act" "United States healthcare privacy law"
* #lgpd "LGPD - Lei Geral de Proteção de Dados" "Brazilian general data protection law"
* #pipeda "PIPEDA - Personal Information Protection and Electronic Documents Act" "Canadian privacy law"
* #ehds "EHDS - European Health Data Space" "European health data framework"




// ===== Conteúdo de: MobilityExtensions.fsh =====

// Originally defined on lines 1 - 13
Extension: MobilityAlertLevel
Parent: Extension
Id: mobility-alert-level
Title: "Mobility Alert Level Extension"
Description: "Extension for mobility measurements alert levels to indicate the severity or concern level of mobility changes detected by the device"
* ^status = #active
* ^context[0].type = #element
* ^context[0].expression = "Observation"
* . ^short = "Mobility alert level indicator"
* . ^definition = "Indicates the severity level of mobility changes or concerns based on device measurements"
* value[x] only CodeableConcept
* valueCodeableConcept from MobilityAlertLevelVS (required)
* valueCodeableConcept ^short = "Alert level code"
* valueCodeableConcept ^definition = "The specific alert level code indicating the severity of mobility changes"
* extension 0..0

// Originally defined on lines 15 - 22
ValueSet: MobilityAlertLevelVS
Id: mobility-alert-level-vs
Title: "Mobility Alert Level Value Set"
Description: "Value set for mobility measurement alert levels used to categorize the severity of mobility changes or concerns"
* ^experimental = false
* ^status = #active
* ^purpose = "To provide standardized alert levels for mobility measurements"
* include codes from system MobilityAlertLevelCS

// Originally defined on lines 24 - 40
CodeSystem: MobilityAlertLevelCS
Id: mobility-alert-level-cs
Title: "Mobility Alert Level Code System"
Description: "Code system defining alert levels for mobility measurements, indicating the severity of changes in mobility patterns"
* ^experimental = false
* ^status = #active
* ^caseSensitive = true
* ^content = #complete
* #green "Normal - No concern" "Mobility measurements are within normal range and show no concerning patterns"
* #yellow "Caution - Monitor closely" "Mobility measurements show slight deviations that warrant closer monitoring"
* #red "Alert - Significant change" "Mobility measurements indicate significant changes that require immediate attention"
* ^property[0].code = #status
* ^property[0].type = #code
* ^property[0].description = "The status of the alert level"
* ^property[1].code = #severity
* ^property[1].type = #integer
* ^property[1].description = "Numeric value indicating severity (1=low, 3=high)"




// ===== Conteúdo de: ActivityExtensions.fsh =====

// This file has no content after preprocessing.


// ===== Conteúdo de: MobilityRiskValueSets.fsh =====

// Originally defined on lines 1 - 8
ValueSet: FallRiskOutcomesValueSet
Id: fall-risk-outcomes
Title: "Fall Risk Outcomes Value Set"
Description: "Value set for fall risk assessment outcomes"
* ^experimental = false
* ^url = "https://2rdoc.pt/ig/ios-lifestyle-medicine/ValueSet/fall-risk-outcomes"
* ^status = #active
* include codes from system https://2rdoc.pt/ig/ios-lifestyle-medicine/CodeSystem/fall-risk-outcomes

// Originally defined on lines 10 - 17
ValueSet: RiskLevelValueSet
Id: risk-level
Title: "Risk Level Value Set"
Description: "Value set for general risk levels"
* ^experimental = false
* ^url = "https://2rdoc.pt/ig/ios-lifestyle-medicine/ValueSet/risk-level"
* ^status = #active
* include codes from system https://2rdoc.pt/ig/ios-lifestyle-medicine/CodeSystem/risk-level

// Originally defined on lines 19 - 26
ValueSet: MobilityDeclineOutcomesValueSet
Id: mobility-decline-outcomes
Title: "Mobility Decline Outcomes Value Set"
Description: "Value set for mobility decline assessment outcomes"
* ^experimental = false
* ^url = "https://2rdoc.pt/ig/ios-lifestyle-medicine/ValueSet/mobility-decline-outcomes"
* ^status = #active
* include codes from system https://2rdoc.pt/ig/ios-lifestyle-medicine/CodeSystem/mobility-decline-outcomes
   

// Originally defined on lines 28 - 35
ValueSet: AssistanceLevelOutcomesValueSet
Id: assistance-level-outcomes
Title: "Assistance Level Outcomes Value Set"
Description: "Value set for assistance level assessment outcomes"
* ^experimental = false
* ^url = "https://2rdoc.pt/ig/ios-lifestyle-medicine/ValueSet/assistance-level-outcomes"
* ^status = #active
* include codes from system https://2rdoc.pt/ig/ios-lifestyle-medicine/CodeSystem/assistance-level-outcomes
   




// ===== Conteúdo de: SymptomValueSets.fsh =====

// Originally defined on lines 1 - 10
CodeSystem: SymptomSeverityCS
Id: symptom-severity-cs
Title: "Symptom Severity Code System"
Description: "Severity levels for symptoms"
* ^experimental = false
* #1-3 "Light" "Symptom barely noticeable"
* #4-6 "Mild" "Symptom noticeable but not interfering with daily activities"
* #7-8 "Intense" "Symptom interfering with daily activities"
* #9-10 "Severe" "Symptom preventing daily activities"

// Originally defined on lines 12 - 24
ValueSet: BodyLocationsVS
Id: body-locations-vs
Title: "Body Locations Value Set"
Description: "Anatomical locations for symptom recording"
* ^experimental = false
* http://snomed.info/sct#12738006 "Brain"
* http://snomed.info/sct#69536005 "Head"
* http://snomed.info/sct#45048000 "Neck"
* http://snomed.info/sct#51185008 "Chest"
* http://snomed.info/sct#62413002 "Abdomen"
* http://snomed.info/sct#32849002 "Back"
* http://snomed.info/sct#53120007 "Upper limb"
* http://snomed.info/sct#61685007 "Lower limb"

// Originally defined on lines 26 - 35
ValueSet: DurationUnitsVS
Id: duration-units-vs
Title: "Duration Units Value Set"
Description: "Time units for symptom duration"
* ^experimental = false
* http://unitsofmeasure.org#min "Minutes"
* http://unitsofmeasure.org#h "Hours"
* http://unitsofmeasure.org#d "Days"
* http://unitsofmeasure.org#wk "Weeks"
* http://unitsofmeasure.org#mo "Months"

// Originally defined on lines 37 - 46
CodeSystem: SymptomFrequencyCS
Id: symptom-frequency-cs
Title: "Symptom Frequency Code System"
Description: "Frequency patterns for symptoms"
* ^experimental = false
* #rare "Rare" "Less than once per month"
* #occasional "Occasional" "Several times per month"
* #frequent "Frequent" "Several times per week"
* #daily "Daily" "Once or more per day"
* #constant "Constant" "Present most of the time"

// Originally defined on lines 48 - 53
ValueSet: SymptomFrequencyVS
Id: symptom-frequency-vs
Title: "Symptom Frequency Value Set"
Description: "Frequency patterns for symptoms"
* ^experimental = false
* include codes from system SymptomFrequencyCS

// Originally defined on lines 55 - 64
CodeSystem: SymptomImpactCS
Id: symptom-impact-cs
Title: "Symptom Impact Code System"
Description: "Impact levels of symptoms on daily activities"
* ^experimental = false
* #none "No impact"
* #mild "Mild impact"
* #moderate "Moderate impact"
* #severe "Severe impact"
* #complete "Complete impact"

// Originally defined on lines 66 - 71
ValueSet: SymptomImpactVS
Id: symptom-impact-vs
Title: "Symptom Impact Value Set"
Description: "Impact levels for symptoms"
* ^experimental = false
* include codes from system SymptomImpactCS

// Originally defined on lines 73 - 81
ValueSet: SymptomProgressionVS
Id: symptom-progression-vs
Title: "Symptom Progression Value Set"
Description: "Progression patterns for symptoms"
* ^experimental = false
* http://snomed.info/sct#385633008 "Improving"
* http://snomed.info/sct#58158008 "Stable"
* http://snomed.info/sct#230993007 "Worsening"
* http://snomed.info/sct#255314001 "Fluctuating"

// Originally defined on lines 83 - 90
ValueSet: TimeOfDayVS
Id: time-of-day-vs
Title: "Time of Day Value Set"
Description: "Times of day for symptom occurrence"
* ^experimental = false
* http://snomed.info/sct#255214003 "After exercise"
* http://snomed.info/sct#2546009 "Evening"
* http://snomed.info/sct#73775008 "Morning"




// ===== Conteúdo de: StressValueSets.fsh =====

// Originally defined on lines 1 - 7
ValueSet: StressChronicityVS
Id: stress-chronicity-vs
Title: "Stress Chronicity Value Set"
Description: "Value set for classifying stress chronicity"
* ^experimental = false
* ^url = "https://2rdoc.pt/ig/ios-lifestyle-medicine/ValueSet/stress-chronicity-vs"
* include codes from system StressChronicityCS

// Originally defined on lines 9 - 15
ValueSet: StressImpactVS
Id: stress-impact-vs
Title: "Stress Impact Value Set"
Description: "Value set for describing stress impact levels"
* ^experimental = false
* ^url = "https://2rdoc.pt/ig/ios-lifestyle-medicine/ValueSet/stress-impact-vs"
* include codes from system StressImpactCS

// Originally defined on lines 17 - 27
CodeSystem: StressChronicityCS
Id: stress-chronicity-cs
Title: "Stress Chronicity Code System"
Description: "Code system for stress chronicity classification"
* ^experimental = false
* ^url = "https://2rdoc.pt/ig/ios-lifestyle-medicine/CodeSystem/stress-chronicity-cs"
* #acute "Acute" "Short-term stress response"
* #subacute "Subacute" "Medium-term stress response"
* #chronic "Chronic" "Long-term stress response"
* #episodic "Episodic" "Recurring stress episodes"
* #persistent "Persistent" "Continuous stress state"

// Originally defined on lines 29 - 39
CodeSystem: StressImpactCS
Id: stress-impact-cs
Title: "Stress Impact Code System"
Description: "Code system for stress impact levels"
* ^experimental = false
* ^url = "https://2rdoc.pt/ig/ios-lifestyle-medicine/CodeSystem/stress-impact-cs"
* #minimal "Minimal Impact" "Little to no interference with daily activities"
* #mild "Mild Impact" "Some interference with daily activities"
* #moderate "Moderate Impact" "Significant interference with daily activities"
* #severe "Severe Impact" "Major interference with daily activities"
* #extreme "Extreme Impact" "Unable to perform daily activities"




// ===== Conteúdo de: ReproductiveValueSets.fsh =====

// Originally defined on lines 1 - 16
ValueSet: ReproductiveGoalVS
Id: social-history-goal-vs
Title: "Reproductive Health Goals Value Set"
Description: "Goals related to social-history health tracking and planning"
* ^experimental = false
* ^status = #active
* ^date = "2024-03-19"
* http://loinc.org#8708-0 "Menstrual cycle length"
* http://loinc.org#55284-4 "Blood pressure"
* http://loinc.org#8310-5 "Body temperature"
* http://loinc.org#8302-2 "Body height"
* http://loinc.org#29463-7 "Body weight"
* http://snomed.info/sct#364311006 "Menstrual cycle monitoring"
* http://snomed.info/sct#289530006 "Reproductive health finding"

// Originally defined on lines 18 - 27
ValueSet: ReproductiveActivityVS
Id: social-history-activity-vs
Title: "Reproductive Health Activities Value Set"
Description: "Activities related to social-history health monitoring"
* ^experimental = false
* ^status = #active
* ^date = "2024-03-19"
* include codes from system ReproductiveActivityCS

// Originally defined on lines 29 - 45
CodeSystem: ReproductiveActivityCS
Id: social-history-activity-cs
Title: "Reproductive Health Activities Code System"
Description: "Code system for social-history health monitoring activities"
* ^experimental = false
* ^status = #active
* ^caseSensitive = true
* #cycle-tracking "Cycle Tracking" "Track menstrual cycle dates and characteristics"
* #temp-monitoring "Temperature Monitoring" "Monitor basal body temperature"
* #symptom-tracking "Symptom Tracking" "Track social-history health symptoms"
* #vitals-monitoring "Vitals Monitoring" "Monitor vital signs related to social-history health"
* #fertility-signs "Fertility Signs" "Monitor fertility signs and indicators"
* #mood-tracking "Mood Tracking" "Track mood changes related to social-history cycle"
* #medication-log "Medication Log" "Log social-history health medications"
* #exercise-tracking "Exercise Tracking" "Track physical activity during cycle"




// ===== Conteúdo de: AuditFormatsValueSet.fsh =====

// Originally defined on lines 1 - 9
ValueSet: AuditFormatsValueSet
Id: audit-formats
Title: "Audit Formats Value Set"
Description: "Value set for audit format types"
* ^experimental = false
* ^url = "https://2rdoc.pt/ig/ios-lifestyle-medicine/ValueSet/audit-formats"
* ^status = #active
* ^date = "2024-12-27"
* include codes from system https://2rdoc.pt/ig/ios-lifestyle-medicine/CodeSystem/audit-formats

// Originally defined on lines 11 - 21
CodeSystem: AuditFormatsCodeSystem
Id: audit-formats
Title: "Audit Formats Code System"
Description: "Code system for audit format types"
* ^experimental = false
* ^url = "https://2rdoc.pt/ig/ios-lifestyle-medicine/CodeSystem/audit-formats"
* ^status = #active
* ^caseSensitive = true
* #text "Text Format"
* #structured "Structured Format"
* #mixed "Mixed Format"




// ===== Conteúdo de: MeasurementContextVS.fsh =====

// Originally defined on lines 1 - 11
ValueSet: MeasurementContextVS
Id: measurement-context-vs
Title: "Measurement Context Value Set"
Description: "Contexts in which measurements can be taken, including temporal and location-based contexts"
* ^experimental = false
* ^status = #active
* http://snomed.info/sct#272125009 "Assessment context value (qualifier value)"
* http://snomed.info/sct#307818003 "Before food"
* http://snomed.info/sct#307819006 "After food"
* http://snomed.info/sct#255214003 "After exercise"
* http://snomed.info/sct#264362003 "Time of day"




// ===== Conteúdo de: AuditLevelsValueSet.fsh =====

// Originally defined on lines 1 - 9
ValueSet: AuditLevelsValueSet
Id: audit-levels
Title: "Audit Levels Value Set"
Description: "Value set for audit level types"
* ^experimental = false
* ^url = "https://2rdoc.pt/ig/ios-lifestyle-medicine/ValueSet/audit-levels"
* ^status = #active
* ^date = "2024-12-27"
* include codes from system https://2rdoc.pt/ig/ios-lifestyle-medicine/CodeSystem/audit-levels

// Originally defined on lines 11 - 21
CodeSystem: AuditLevelsCodeSystem
Id: audit-levels
Title: "Audit Levels Code System"
Description: "Code system for audit level types"
* ^experimental = false
* ^url = "https://2rdoc.pt/ig/ios-lifestyle-medicine/CodeSystem/audit-levels"
* ^status = #active
* ^caseSensitive = true
* #low "Low Level"
* #medium "Medium Level"
* #high "High Level"




// ===== Conteúdo de: SocialInteractionValueSets.fsh =====

// Originally defined on lines 1 - 6
ValueSet: SocialInteractionTypeVS
Id: social-interaction-type-vs
Title: "Social Interaction Type Value Set"
Description: "Types of social interactions"
* ^experimental = false
* include codes from system SocialInteractionTypeCS

// Originally defined on lines 8 - 13
ValueSet: SocialInteractionQualityVS
Id: social-interaction-quality-vs
Title: "Social Interaction Quality Value Set"
Description: "Quality measures for social interactions"
* ^experimental = false
* include codes from system SocialInteractionQualityCS

// Originally defined on lines 15 - 20
ValueSet: SocialInteractionMediumVS
Id: social-interaction-medium-vs
Title: "Social Interaction Medium Value Set"
Description: "Mediums through which social interaction occurs"
* ^experimental = false
* include codes from system SocialInteractionMediumCS

// Originally defined on lines 22 - 32
CodeSystem: SocialInteractionTypeCS
Id: social-interaction-type-cs
Title: "Social Interaction Type Code System"
Description: "Types of social interactions"
* ^experimental = false
* #family "Family Interaction" "Interaction with family members"
* #friends "Friend Interaction" "Interaction with friends"
* #professional "Professional Interaction" "Work-related interactions"
* #community "Community Interaction" "Community-based interactions"
* #group "Group Activity" "Organized group activities"
* #casual "Casual Interaction" "Casual social encounters"

// Originally defined on lines 34 - 43
CodeSystem: SocialInteractionQualityCS
Id: social-interaction-quality-cs
Title: "Social Interaction Quality Code System"
Description: "Quality measures for social interactions"
* ^experimental = false
* #meaningful "Meaningful" "Deep, meaningful interaction"
* #supportive "Supportive" "Supportive interaction"
* #neutral "Neutral" "Neither positive nor negative"
* #superficial "Superficial" "Surface-level interaction"
* #stressful "Stressful" "Stressful or difficult interaction"

// Originally defined on lines 44 - 55
CodeSystem: SocialInteractionMediumCS
Id: social-interaction-medium-cs
Title: "Social Interaction Medium Code System"
Description: "Mediums through which social interaction occurs"
* ^experimental = false
* #inPerson "In Person" "Face-to-face interaction"
* #meaningful "Meaningful" "Deep and significant interaction"
* #video "Video Call" "Video-based interaction"
* #voice "Voice Call" "Voice-only interaction"
* #text "Text Based" "Text-based communication"
* #social "Social Media" "Social media interaction"
* #mixed "Mixed Medium" "Multiple communication methods"




// ===== Conteúdo de: MoodValueSet.fsh =====

// Originally defined on lines 1 - 7
ValueSet: MoodValueSet
Id: mood
Title: "Mood Value Set"
Description: "Value set for mood states"
* ^experimental = false
* ^url = "https://2rdoc.pt/ig/ios-lifestyle-medicine/ValueSet/mood"
* ^status = #active

// Originally defined on lines 9 - 21
CodeSystem: MoodCodeSystem
Id: mood
Title: "Mood Code System"
Description: "Code system for mood states"
* ^url = "https://2rdoc.pt/ig/ios-lifestyle-medicine/CodeSystem/mood"
* ^status = #active
* ^caseSensitive = true
* #elevated "Elevated" "Mood is higher than normal"
* #neutral "Neutral" "Neither elevated nor depressed mood"
* #depressed "Depressed" "Mood is lower than normal"
* #anxious "Anxious" "Feeling worried or nervous"
* #irritable "Irritable" "Easily annoyed or angered"
* #calm "Calm" "Feeling peaceful and relaxed"




// ===== Conteúdo de: EnvironmentalContextVS.fsh =====

// Originally defined on lines 1 - 9
ValueSet: EnvironmentalContextValueSet
Id: environmental-context
Title: "Environmental Context Value Set"
Description: "Valid contexts for environmental measurements"
* ^experimental = false
* ^status = #active
* ^url = "https://2rdoc.pt/ig/ios-lifestyle-medicine/ValueSet/environmental-context"
* include codes from system https://2rdoc.pt/ig/ios-lifestyle-medicine/CodeSystem/environmental-context
   




// ===== Conteúdo de: ActivityTypeVS.fsh =====

// Originally defined on lines 1 - 14
ValueSet: PhysicalActivityTypeVS
Id: physical-activity-type-vs
Title: "Physical Activity Types Value Set"
Description: "Types of physical activities from iOS Health App"
* ^experimental = false
* ^status = #active
* http://snomed.info/sct#255604002 "Physical activity (observable entity)"
* http://snomed.info/sct#228557008 "Walking"
* http://snomed.info/sct#229058003 "Running"
* http://snomed.info/sct#266938001 "Swimming"
* http://snomed.info/sct#266940006 "Cycling"
* http://snomed.info/sct#32147004 "Regular exercise"




// ===== Conteúdo de: MindfulnessValueSets.fsh =====

// Originally defined on lines 1 - 8
ValueSet: EnvironmentTypeValueSet
Id: environment-type
Title: "Environment Type Value Set"
Description: "Value set for environmental context types"
* ^experimental = false
* ^url = "https://2rdoc.pt/ig/ios-lifestyle-medicine/ValueSet/environment-type"
* ^status = #active
* include codes from system https://2rdoc.pt/ig/ios-lifestyle-medicine/CodeSystem/environment-type

// Originally defined on lines 10 - 17
ValueSet: MindfulnessTypeValueSet
Id: mindfulness-type
Title: "Mindfulness Type Value Set"
Description: "Value set for types of mindfulness practices"
* ^experimental = false
* ^url = "https://2rdoc.pt/ig/ios-lifestyle-medicine/ValueSet/mindfulness-type"
* ^status = #active
* include codes from system https://2rdoc.pt/ig/ios-lifestyle-medicine/CodeSystem/mindfulness-type




// ===== Conteúdo de: BalanceStatusValueSet.fsh =====

// Originally defined on lines 1 - 7
ValueSet: BalanceStatusValueSet
Id: balance-status
Title: "Balance Status Value Set"
Description: "Value set for walking steadiness balance status"
* ^url = "https://2rdoc.pt/ig/ios-lifestyle-medicine/ValueSet/balance-status"
* ^status = #active
* include codes from system https://2rdoc.pt/ig/ios-lifestyle-medicine/CodeSystem/balance-status

// Originally defined on lines 9 - 21
CodeSystem: BalanceStatusCodeSystem
Id: balance-status
Title: "Balance Status Code System"
Description: "Code system for balance status types"
* ^experimental = false
* ^url = "https://2rdoc.pt/ig/ios-lifestyle-medicine/CodeSystem/balance-status"
* ^status = #active
* ^caseSensitive = true
* #veryStable "Very Stable"
* #stable "Stable"
* #slightlyUnstable "Slightly Unstable"
* #unstable "Unstable"
* #veryUnstable "Very Unstable"




// ===== Conteúdo de: SleepQualityVS.fsh =====

// Originally defined on lines 1 - 11
ValueSet: SleepQualityVS
Id: activity-quality-vs
Title: "Sleep Quality Value Set"
Description: "Qualitative assessments of activity quality including subjective measures"
* ^experimental = false
* ^status = #active
* http://snomed.info/sct#248254009 "Quality of activity (observable entity)"
* http://snomed.info/sct#248255005 "Sleeping well"
* http://snomed.info/sct#248256006 "Difficulty activitying"
* http://snomed.info/sct#301345002 "Poor activity pattern"
* http://snomed.info/sct#301346001 "Good activity pattern"




// ===== Conteúdo de: FertilityValueSets.fsh =====

// Originally defined on lines 1 - 8
ValueSet: CervicalMucusValueSet
Id: cervical-mucus-valueset
Title: "Cervical Mucus Value Set"
Description: "Value set for cervical mucus observations"
* ^experimental = false
* ^url = "https://2rdoc.pt/ig/ios-lifestyle-medicine/ValueSet/cervical-mucus-vs"
* ^status = #active
* include codes from system https://2rdoc.pt/ig/ios-lifestyle-medicine/CodeSystem/cervical-mucus-cs

// Originally defined on lines 10 - 20
CodeSystem: CervicalMucusCodeSystem
Id: cervical-mucus-cs
Title: "Cervical Mucus Code System"
Description: "Code system for cervical mucus classification"
* ^url = "https://2rdoc.pt/ig/ios-lifestyle-medicine/CodeSystem/cervical-mucus-cs"
* ^status = #active
* ^caseSensitive = true
* #dry "Dry"
* #sticky "Sticky"
* #creamy "Creamy"
* #watery "Watery"
* #eggWhite "Egg White"

// Originally defined on lines 22 - 29
ValueSet: OvulationTestValueSet
Id: ovulation-test-valueset
Title: "Ovulation Test Value Set"
Description: "Value set for ovulation test results"
* ^experimental = false
* ^url = "https://2rdoc.pt/ig/ios-lifestyle-medicine/ValueSet/ovulation-test-vs"
* ^status = #active
* include codes from system https://2rdoc.pt/ig/ios-lifestyle-medicine/CodeSystem/ovulation-test-cs

// Originally defined on lines 31 - 39
CodeSystem: OvulationTestCodeSystem
Id: ovulation-test-cs
Title: "Ovulation Test Code System"
Description: "Code system for ovulation test results"
* ^url = "https://2rdoc.pt/ig/ios-lifestyle-medicine/CodeSystem/ovulation-test-cs"
* ^status = #active
* ^caseSensitive = true
* #negative "Negative"
* #positive "Positive"
* #invalid "Invalid Test"

// Originally defined on lines 41 - 48
ValueSet: FertilityStatusValueSet
Id: fertility-status-valueset
Title: "Fertility Status Value Set"
Description: "Value set for fertility status"
* ^experimental = false
* ^url = "https://2rdoc.pt/ig/ios-lifestyle-medicine/ValueSet/fertility-status-vs"
* ^status = #active
* include codes from system https://2rdoc.pt/ig/ios-lifestyle-medicine/CodeSystem/fertility-status-cs
   

// Originally defined on lines 50 - 58
CodeSystem: FertilityStatusCodeSystem
Id: fertility-status-cs
Title: "Fertility Status Code System"
Description: "Code system for fertility status indicators"
* ^url = "https://2rdoc.pt/ig/ios-lifestyle-medicine/CodeSystem/fertility-status-cs"
* ^status = #active
* ^caseSensitive = true
* #fertile "Fertile"
* #notFertile "Not Fertile"
* #uncertain "Uncertain"




// ===== Conteúdo de: MindfulnessSearchParameters.fsh =====

// Originally defined on lines 1 - 12
Instance: MindfulnessType
InstanceOf: SearchParameter
Description: "Example instance of MindfulnessType"
Usage: #definition
* status = #active
* code = #mindfulness-type
* name = "MindfulnessType"
* description = "Search for mindfulness observations by practice type"
* base = #Observation
* type = #token
* expression = "Observation.component.where(code.coding.exists(system = 'http://snomed.info/sct' and code = '711415009')).value.as(CodeableConcept)"
* xpath = "f:Observation/f:component[f:code/f:coding[f:system/@value='http://snomed.info/sct' and f:code/f:coding/f:code/@value='711415009']]/f:valueCodeableConcept"
* xpathUsage = #normal




// ===== Conteúdo de: MindfulnessAlerts.fsh =====

// Originally defined on lines 1 - 9
Extension: AlertTiming
Parent: Extension
Id: alert-timing
Title: "Alert Timing Extension"
Description: "Defines when alerts should be triggered"
* value[x] only Timing
* valueTiming.repeat 1..1
* valueTiming.repeat MS
* valueTiming.repeat.frequency MS
* valueTiming.repeat.period MS
* valueTiming.repeat.periodUnit MS
* extension 0..0

// Originally defined on lines 11 - 15
Extension: AlertMessage
Parent: Extension
Id: alert-message
Title: "Alert Message Extension"
Description: "Defines the alert message content"
* value[x] only string
* extension 0..0

// Originally defined on lines 17 - 28
Profile: MindfulnessAlert
Parent: Basic
Id: mindfulness-alert
Title: "Mindfulness Alert"
Description: "Alert configuration for mindfulness sessions"
* code 1..1
* code MS
* code = https://2rdoc.pt/ig/ios-lifestyle-medicine/CodeSystem/mindfulness-alert-type#reminder "Mindfulness Reminder"
* extension contains
    alert-timing named alertTiming 0.. and
    alert-message named alertMessage 0..
* extension[alertTiming] 0..1
* extension[alertTiming] MS
* extension[alertMessage] 1..1
* extension[alertMessage] MS

// Originally defined on lines 30 - 40
Instance: DailyMindfulnessAlert
InstanceOf: MindfulnessAlert
Title: "Daily Mindfulness Alert"
Description: "Example of a daily mindfulness alert configuration"
Usage: #example
* code = https://2rdoc.pt/ig/ios-lifestyle-medicine/CodeSystem/mindfulness-alert-type#reminder "Mindfulness Reminder"
* extension[alertTiming].valueTiming.repeat
* extension[alertTiming].valueTiming.repeat.frequency = 1
* extension[alertTiming].valueTiming.repeat.period = 1
* extension[alertTiming].valueTiming.repeat.periodUnit = #d
* extension[alertMessage].valueString = "Time for your daily mindfulness practice"




// ===== Conteúdo de: MindfulnessTransforms.fsh =====

// Originally defined on lines 1 - 44
Instance: MindfulnessHealthKitTransform
InstanceOf: StructureMap
Title: "HealthKit to FHIR Mindfulness Transform"
Usage: #definition
* status = #draft
* name = "MindfulnessHealthKitTransform"
* structure[0]
* structure[0].url = "https://2rdoc.pt/ig/ios-lifestyle-medicine/StructureDefinition/healthkit-mindfulness"
* structure[0].mode = #source
* structure[0].documentation = "HealthKit mindfulness session structure"
* structure[1]
* structure[1].url = "http://hl7.org/fhir/StructureDefinition/Observation"
* structure[1].mode = #target
* structure[1].documentation = "FHIR Observation resource"
* group[0]
* group[0].name = "MindfulnessSessionToObservation"
* group[0].typeMode = #none
* group[0].input[0]
* group[0].input[0].name = "source"
* group[0].input[0].type = "HealthKitMindfulness"
* group[0].input[0].mode = #source
* group[0].input[1]
* group[0].input[1].name = "target"
* group[0].input[1].type = "Observation"
* group[0].input[1].mode = #target
* group[0].rule[0]
* group[0].rule[0].name = "Session"
* group[0].rule[0].source[0]
* group[0].rule[0].source[0].context = "source"
* group[0].rule[0].source[0].element = "startDate"
* group[0].rule[0].target[0]
* group[0].rule[0].target[0].context = "target"
* group[0].rule[0].target[0].element = "effectiveDateTime"
* group[0].rule[1]
* group[0].rule[1].name = "Duration"
* group[0].rule[1].source[0]
* group[0].rule[1].source[0].context = "source"
* group[0].rule[1].source[0].element = "duration"
* group[0].rule[1].target[0]
* group[0].rule[1].target[0].context = "target"
* group[0].rule[1].target[0].element = "component.where(code.coding.code='118682006').valueQuantity"

// Originally defined on lines 46 - 77
Instance: MindfulnessCSVTransform
InstanceOf: StructureMap
Title: "CSV to FHIR Mindfulness Transform"
Usage: #definition
* status = #draft
* name = "MindfulnessCSVTransform"
* structure[0]
* structure[0].url = "https://2rdoc.pt/ig/ios-lifestyle-medicine/StructureDefinition/csv-mindfulness"
* structure[0].mode = #source
* structure[0].documentation = "CSV mindfulness data structure"
* group[0]
* group[0].name = "CSVToMindfulnessObservation"
* group[0].typeMode = #none
* group[0].input[0]
* group[0].input[0].name = "source"
* group[0].input[0].type = "CSVMindfulness"
* group[0].input[0].mode = #source
* group[0].input[1]
* group[0].input[1].name = "target"
* group[0].input[1].type = "Observation"
* group[0].input[1].mode = #target
* group[0].rule[0]
* group[0].rule[0].name = "MapDatetime"
* group[0].rule[0].source[0]
* group[0].rule[0].source[0].context = "source"
* group[0].rule[0].source[0].element = "date,time"
* group[0].rule[0].target[0]
* group[0].rule[0].target[0].context = "target"
* group[0].rule[0].target[0].element = "effectiveDateTime"
* group[0].rule[0].target[0].transform = #append




// ===== Conteúdo de: MindfulnessAudit.fsh =====

// Originally defined on lines 1 - 6
Extension: AuditLevelExtension
Parent: Extension
Id: audit-level
Title: "Audit Level Extension"
Description: "Level of detail for audit records"
* value[x] only code
* valueCode from https://2rdoc.pt/ig/ios-lifestyle-medicine/ValueSet/audit-levels (required)
* extension 0..0

// Originally defined on lines 8 - 12
Extension: AuditRetentionExtension
Parent: Extension
Id: audit-retention
Title: "Audit Retention Extension"
Description: "Period to retain audit records"
* value[x] only Duration
* extension 0..0

// Originally defined on lines 14 - 19
Extension: AuditFormatExtension
Parent: Extension
Id: audit-format
Title: "Audit Format Extension"
Description: "Format for audit records"
* value[x] only code
* valueCode from https://2rdoc.pt/ig/ios-lifestyle-medicine/ValueSet/audit-formats (required)
* extension 0..0

// Originally defined on lines 21 - 34
Profile: MindfulnessAudit
Parent: Basic
Id: mindfulness-audit
Title: "Mindfulness Audit"
Description: "Audit record for mindfulness sessions"
* code 1..1
* code MS
* code = https://2rdoc.pt/ig/ios-lifestyle-medicine/CodeSystem/mindfulness-audit-type#session "Session Audit"
* created 1..1
* created MS
* extension contains
    audit-level named auditLevel 0.. and
    audit-retention named auditRetention 0.. and
    audit-format named auditFormat 0..
* extension[auditLevel] 1..1
* extension[auditLevel] MS
* extension[auditRetention] 1..1
* extension[auditRetention] MS
* extension[auditFormat] 1..1
* extension[auditFormat] MS

// Originally defined on lines 36 - 45
Instance: MindfulnessAuditExample
InstanceOf: MindfulnessAudit
Title: "Example Mindfulness Audit"
Description: "Example of a mindfulness session audit record"
Usage: #example
* code = https://2rdoc.pt/ig/ios-lifestyle-medicine/CodeSystem/mindfulness-audit-type#session "Session Audit"
* created = "2024-03-15"
* extension[auditLevel].valueCode = #detailed
* extension[auditRetention].valueDuration = 90 'days'
* extension[auditFormat].valueCode = #fhir




// ===== Conteúdo de: EnvironmentalExamples.fsh =====

// Originally defined on lines 1 - 34
Instance: NoiseExposureExample
InstanceOf: NoiseExposureObservation
Title: "Noise Exposure Measurement Example"
Description: "Noise exposure observation example"
Usage: #example
* meta.security = http://terminology.hl7.org/CodeSystem/v3-Confidentiality#N
* status = #final
* performer = Reference(Practitioner/PractitionerExample)
* category = http://terminology.hl7.org/CodeSystem/observation-category#environment
* code = http://loinc.org#28573-7 "Noise exposure time"
* subject = Reference(Patient/PatientExample)
* effectiveDateTime = "2024-03-19T15:30:00Z"
* device = Reference(Device/iphone-example)
* method = http://snomed.info/sct#37016008 "Automatic measurement"
* component[level]
* component[level].code.coding[0] = http://loinc.org#89020-2 "Environmental noise average"
* component[level].valueQuantity = 85 'dB'
* component[level].interpretation = http://terminology.hl7.org/CodeSystem/v3-ObservationInterpretation#H "High"
* component[duration]
* component[duration].code.coding[0] = http://loinc.org#89021-0 "Environmental noise duration"
* component[duration].valueQuantity = 120 'min'
* component[peakLevel]
* component[peakLevel].code.coding[0] = http://loinc.org#89024-4 "Peak sound level"
* component[peakLevel].valueQuantity = 95 'dB'
* component[backgroundNoise]
* component[backgroundNoise].code.coding[0] = http://loinc.org#89025-1 "Background noise level"
* component[backgroundNoise].valueQuantity = 45 'dB'
* note.text = "Measurement taken during urban commute"

// Originally defined on lines 36 - 68
Instance: UVExposureExample
InstanceOf: UVExposureObservation
Title: "UV Exposure Measurement Example"
Description: "UV exposure observation example"
Usage: #example
* meta.security = http://terminology.hl7.org/CodeSystem/v3-Confidentiality#N
* status = #final
* category = http://terminology.hl7.org/CodeSystem/observation-category#environment
* code = http://loinc.org#28574-5 "UV exposure"
* subject = Reference(Patient/PatientExample)
* effectiveDateTime = "2024-03-19T12:00:00Z"
* device = Reference(Device/iphone-example)
* method = http://snomed.info/sct#37016008 "Automatic measurement"
* component[index]
* component[index].code.coding[0] = http://loinc.org#89022-8 "UV index"
* component[index].valueQuantity = 8 '{index}'
* component[index].interpretation = http://terminology.hl7.org/CodeSystem/v3-ObservationInterpretation#H "High"
* component[duration]
* component[duration].code.coding[0] = http://loinc.org#89023-6 "UV exposure duration"
* component[duration].valueQuantity = 45 'min'
* component[timeOfDay]
* component[timeOfDay].code.coding[0] = http://loinc.org#89026-9 "Time of exposure"
* component[timeOfDay].valueDateTime = "2024-03-19T12:00:00Z"
* component[intensity]
* component[intensity].code.coding[0] = http://loinc.org#89027-7 "UV intensity"
* component[intensity].valueQuantity = 0.3 'W/m2'
* note.text = "Measurement taken during outdoor activity"

// Originally defined on lines 70 - 81
Instance: EnvironmentalDeviceExample
InstanceOf: Device
Title: "Environmental Monitoring Device"
Description: "Environmental monitoring device example"
Usage: #example
* identifier.system = "https://2rdoc.pt/ig/ios-lifestyle-medicine/devices"
* identifier.value = "iPhone-ENV-001"
* manufacturer = "Apple Inc."
* modelNumber = "iPhone 15 Pro"
* type = http://snomed.info/sct#706689003 "Environmental monitoring device"
* status = #active




// ===== Conteúdo de: NutritionExamples.fsh =====

// Originally defined on lines 1 - 55
Instance: NutritionQuestionnaireResponseExample
InstanceOf: QuestionnaireResponse
Title: "Daily Nutrition Questionnaire Response Example"
Description: "Nutrition questionnaire response example"
Usage: #example
* questionnaire = "https://2rdoc.pt/ig/ios-lifestyle-medicine/Questionnaire/daily-nutrition"
* status = #completed
* subject = Reference(Patient/PatientExample)
* authored = "2024-12-14T20:00:00Z"
* item[0]
* item[0].linkId = "water_intake"
* item[0].answer.valueQuantity = 2000 'mL'
* item[1]
* item[1].linkId = "meal_record"
* item[1].item[0]
* item[1].item[0].linkId = "meal_time"
* item[1].item[0].answer.valueDateTime = "2024-12-14T12:00:00Z"
* item[1].item[1]
* item[1].item[1].linkId = "meal_type"
* item[1].item[1].answer.valueString = "Lunch"
* item[1].item[2]
* item[1].item[2].linkId = "calories"
* item[1].item[2].answer.valueInteger = 650
* item[1].item[3]
* item[1].item[3].linkId = "macronutrients"
* item[1].item[3].item[0]
* item[1].item[3].item[0].linkId = "carbs"
* item[1].item[3].item[0].answer.valueDecimal = 75
* item[1].item[3].item[1]
* item[1].item[3].item[1].linkId = "protein"
* item[1].item[3].item[1].answer.valueDecimal = 30
* item[1].item[3].item[2]
* item[1].item[3].item[2].linkId = "fat"
* item[1].item[3].item[2].answer.valueDecimal = 25
* item[2]
* item[2].linkId = "caffeine"
* item[2].item[0]
* item[2].item[0].linkId = "caffeine_amount"
* item[2].item[0].answer.valueInteger = 80
* item[2].item[1]
* item[2].item[1].linkId = "caffeine_source"
* item[2].item[1].answer.valueString = "Coffee"




// ===== Conteúdo de: SleepExamples.fsh =====

// Originally defined on lines 1 - 53
Instance: SleepObservationExample1
InstanceOf: SleepObservation
Title: "Example of Sleep Record"
Description: "Sleep observation example"
Usage: #example
* status = #final
* category = http://terminology.hl7.org/CodeSystem/observation-category#activity
* code = http://loinc.org#93832-4 "Sleep pattern panel"
* subject = Reference(PatientExample)
* effectivePeriod.start = "2024-03-19T22:00:00Z"
* effectivePeriod.end = "2024-03-20T06:30:00Z"
* device = Reference(DeviceSleepMonitor)
* component[timeInBed].code = http://loinc.org#93831-6 "Time in bed"
* component[timeInBed].valueQuantity = 510 'min' "minute"
* component[timeInBed].valueQuantity.system = "http://unitsofmeasure.org"
* component[timeInBed].valueQuantity.unit = "minute"
* component[totalSleepTime].code = http://loinc.org#93833-2 "Sleep duration"
* component[totalSleepTime].valueQuantity = 472 'min' "minute"
* component[totalSleepTime].valueQuantity.system = "http://unitsofmeasure.org"
* component[totalSleepTime].valueQuantity.unit = "minute"
* component[deepSleep].code = http://loinc.org#93834-0 "Deep activity duration"
* component[deepSleep].valueQuantity = 95 'min' "minute"
* component[deepSleep].valueQuantity.system = "http://unitsofmeasure.org"
* component[deepSleep].valueQuantity.unit = "minute"
* component[remSleep].code = http://loinc.org#93835-7 "REM activity duration"
* component[remSleep].valueQuantity = 118 'min' "minute"
* component[remSleep].valueQuantity.system = "http://unitsofmeasure.org"
* component[remSleep].valueQuantity.unit = "minute"
* component[lightSleep].code = http://loinc.org#93836-5 "Light activity duration"
* component[lightSleep].valueQuantity = 259 'min' "minute"
* component[lightSleep].valueQuantity.system = "http://unitsofmeasure.org"
* component[lightSleep].valueQuantity.unit = "minute"
* component[respiratoryRate].code = http://loinc.org#9279-1 "Respiratory rate"
* component[respiratoryRate].valueQuantity = 14 '/min' "per minute"
* component[respiratoryRate].valueQuantity.system = "http://unitsofmeasure.org"
* component[respiratoryRate].valueQuantity.unit = "per minute"
* component[heartRateVariability].code = http://loinc.org#80404-7 "R-R interval.standard deviation (Heart rate variability)"
* component[heartRateVariability].valueQuantity = 45 'ms' "millisecond"
* component[heartRateVariability].valueQuantity.system = "http://unitsofmeasure.org"
* component[heartRateVariability].valueQuantity.unit = "millisecond"
* component[interruptions].code = http://loinc.org#93837-3 "Number of awakenings during activity"
* component[interruptions].valueQuantity = 3 '{count}' "count"
* component[interruptions].valueQuantity.system = "http://unitsofmeasure.org"
* component[interruptions].valueQuantity.unit = "count"

// Originally defined on lines 55 - 64
Instance: DeviceSleepMonitor
InstanceOf: Device
Title: "Sleep Monitoring Device"
Description: "Sleep monitor device example"
Usage: #example
* deviceName.name = "Sleep Quality Monitor"
* deviceName.type = #user-friendly-name
* manufacturer = "HealthTech Devices"
* modelNumber = "SQM-2024"
* type = http://snomed.info/sct#706172001 "Sleep monitor"




// ===== Conteúdo de: StressExamples.fsh =====

// Originally defined on lines 1 - 20
Instance: StressLevelExample
InstanceOf: StressLevelProfile
Title: "Stress Level Measurement Example"
Description: "Stress level observation example"
Usage: #example
* status = #final
* category = http://terminology.hl7.org/CodeSystem/observation-category#vital-signs
* code = http://loinc.org#89592-0 "Stress level score"
* subject = Reference(Patient/PatientExample)
* effectiveDateTime = "2024-01-03T15:30:00Z"
* valueQuantity = 7 '{score}' "score"
* component[physiologicalStress].valueQuantity = 6 '{score}' "score"
* component[psychologicalStress].valueQuantity = 8 '{score}' "score"
* component[chronicity].valueCodeableConcept = StressChronicityCS#subacute
* component[impact].valueCodeableConcept = StressImpactCS#moderate
* extension[triggers].valueCodeableConcept = StressTriggersCS#work
* extension[coping].valueCodeableConcept = StressCopingCS#meditation




// ===== Conteúdo de: PatientExample.fsh =====

// Originally defined on lines 1 - 10
Instance: PatientExample
InstanceOf: Patient
Description: "Patient resource example"
Usage: #example
* identifier[0].system = "urn:oid:2.16.858.1.1.1"
* identifier[0].value = "12345"
* name.given = "John"
* name.family = "Doe"
* gender = #male
* birthDate = "1970-01-01"




// ===== Conteúdo de: MobilityExamples.fsh =====

// Originally defined on lines 1 - 18
Profile: WalkingSteadinessObservation
Parent: MobilityProfile
Id: walking-steadiness-observation
Title: "Walking Steadiness Observation Profile"
Description: "Profile for assessing walking steadiness and balance"
* code = http://loinc.org#LA32-8 "Balance"
* component contains
    balanceScore 0.. and
    balanceStatus 0..
* component[balanceScore] 0..1
* component[balanceScore] MS
* component[balanceStatus] 0..1
* component[balanceStatus] MS
* component[balanceScore].code = http://loinc.org#LA32-8 "Balance score"
* component[balanceScore].valueQuantity.system = "http://unitsofmeasure.org"
* component[balanceScore].valueQuantity.code = #%
* component[balanceStatus].code = http://loinc.org#LA32-9 "Balance status"
* component[balanceStatus].valueCodeableConcept from https://2rdoc.pt/ig/ios-lifestyle-medicine/ValueSet/balance-status (required)

// Originally defined on lines 20 - 38
Profile: WalkingSpeedObservation
Parent: MobilityProfile
Id: walking-speed-observation
Title: "Walking Speed Observation Profile"
Description: "Profile for measuring walking speed as part of mobility assessment"
* code = http://loinc.org#LA29042-4 "Walking speed"
* component contains
    speed 0.. and
    distance 0..
* component[speed] 0..1
* component[speed] MS
* component[distance] 0..1
* component[distance] MS
* component[speed].code = http://loinc.org#LA29042-4 "Walking speed measurement"
* component[speed].valueQuantity.system = "http://unitsofmeasure.org"
* component[speed].valueQuantity.code = #m/s
* component[distance].code = http://loinc.org#LA29043-2 "Walking distance"
* component[distance].valueQuantity.system = "http://unitsofmeasure.org"
* component[distance].valueQuantity.code = #m

// Originally defined on lines 40 - 55
Instance: WalkingSteadinessExample
InstanceOf: WalkingSteadinessObservation
Title: "Walking Steadiness Measurement Example"
Description: "Walking steadiness observation example"
Usage: #example
* status = #final
* category = http://terminology.hl7.org/CodeSystem/observation-category#activity
* code = http://loinc.org#LA32-8 "Balance"
* subject = Reference(Patient/PatientExample)
* effectiveDateTime = "2024-03-19T15:30:00Z"
* valueQuantity = 85 '1' "score"
* device = Reference(Device/iphone-example)
* component[balanceScore].valueQuantity = 85 '%' "percent"
* component[balanceStatus].valueCodeableConcept = http://loinc.org#LA32-10 "OK"

// Originally defined on lines 57 - 72
Instance: WalkingSpeedExample
InstanceOf: WalkingSpeedObservation
Title: "Walking Speed Measurement Example"
Description: "Walking speed observation example"
Usage: #example
* status = #final
* category = http://terminology.hl7.org/CodeSystem/observation-category#activity
* code = http://loinc.org#LA29042-4 "Walking speed"
* subject = Reference(Patient/PatientExample)
* effectiveDateTime = "2024-03-19T15:30:00Z"
* valueQuantity = 1.2 'm/s' "meters per second"
* device = Reference(Device/iphone-example)
* component[speed].valueQuantity = 1.2 'm/s' "meters per second"
* component[distance].valueQuantity = 10 'm' "meters"




// ===== Conteúdo de: PhysicalActivityExamples.fsh =====

// Originally defined on lines 1 - 27
Instance: PhysicalActivityExample1
InstanceOf: PhysicalActivityObservation
Title: "Example of Walking Activity"
Description: "Physical activity observation example"
Usage: #example
* status = #final
* category = http://terminology.hl7.org/CodeSystem/observation-category#activity
* code = http://snomed.info/sct#228557008 "Walking"
* subject = Reference(PatientExample)
* effectiveDateTime = "2024-03-19T15:30:00Z"
* device = Reference(DeviceActivityTracker)
* component[steps].code = http://loinc.org#55423-8 "Number of steps in 24 hour Measured"
* component[steps].valueQuantity = 8546 '1' "count"
* component[steps].valueQuantity.system = "http://unitsofmeasure.org"
* component[steps].valueQuantity.unit = "count"
* component[distance].code = http://loinc.org#55430-3 "Distance walked"
* component[distance].valueQuantity = 6.2 'km' "kilometer"
* component[distance].valueQuantity.system = "http://unitsofmeasure.org"
* component[distance].valueQuantity.unit = "kilometer"
* component[duration].code = http://loinc.org#55411-3 "Exercise duration"
* component[duration].valueQuantity = 72 'min' "minute"
* component[duration].valueQuantity.system = "http://unitsofmeasure.org"
* component[duration].valueQuantity.unit = "minute"
* component[energy].code = http://loinc.org#55424-6 "Energy expenditure"
* component[energy].valueQuantity = 320 'kcal' "kilocalorie"
* component[energy].valueQuantity.system = "http://unitsofmeasure.org"
* component[energy].valueQuantity.unit = "kilocalorie"

// Originally defined on lines 29 - 38
Instance: DeviceActivityTracker
InstanceOf: Device
Title: "Activity Tracking Device"
Description: "Activity tracker device example"
Usage: #example
* deviceName.name = "Health Activity Tracker"
* deviceName.type = #user-friendly-name
* manufacturer = "HealthTech Devices"
* modelNumber = "HAT-2024"
* type = http://snomed.info/sct#258158006 "Breathing rate"




// ===== Conteúdo de: BodyMetricsExamples.fsh =====

// Originally defined on lines 1 - 15
Instance: WeightExample
InstanceOf: WeightObservation
Title: "Weight Measurement Example"
Description: "Weight observation example"
Usage: #example
* status = #final
* category = http://terminology.hl7.org/CodeSystem/observation-category#vital-signs
* code = http://loinc.org#29463-7 "Body weight"
* subject = Reference(PatientExample)
* performer = Reference(PractitionerExample)
* effectiveDateTime = "2024-03-19T08:00:00Z"
* valueQuantity = 70.5 'kg' "kilogram"
* valueQuantity.system = "http://unitsofmeasure.org"
* valueQuantity.unit = "kilogram"
* device = Reference(SmartScale)

// Originally defined on lines 17 - 30
Instance: HeightExample
InstanceOf: HeightObservation
Title: "Height Measurement Example"
Description: "Height observation example"
Usage: #example
* status = #final
* category = http://terminology.hl7.org/CodeSystem/observation-category#vital-signs
* code = http://loinc.org#8302-2 "Body height"
* subject = Reference(PatientExample)
* performer = Reference(PractitionerExample)
* effectiveDateTime = "2024-03-19T08:00:00Z"
* valueQuantity = 175 'cm' "centimeter"
* valueQuantity.system = "http://unitsofmeasure.org"
* valueQuantity.unit = "centimeter"

// Originally defined on lines 32 - 47
Instance: BMIExample
InstanceOf: BMIObservation
Title: "BMI Calculation Example"
Description: "Body Mass Index observation example"
Usage: #example
* status = #final
* category = http://terminology.hl7.org/CodeSystem/observation-category#vital-signs
* code = http://loinc.org#39156-5 "Body mass index (BMI) [Ratio]"
* subject = Reference(PatientExample)
* performer = Reference(PractitionerExample)
* effectiveDateTime = "2024-03-19T08:00:00Z"
* valueQuantity = 23 'kg/m2' "kilogram per square meter"
* valueQuantity.system = "http://unitsofmeasure.org"
* valueQuantity.unit = "kilogram per square meter"
* derivedFrom[0] = Reference(Observation/WeightExample)
* derivedFrom[1] = Reference(Observation/HeightExample)

// Originally defined on lines 49 - 85
Instance: BodyCompositionExample
InstanceOf: BodyCompositionObservation
Title: "Body Composition Measurement Example"
Description: "Body composition observation example"
Usage: #example
* status = #final
* category = http://terminology.hl7.org/CodeSystem/observation-category#vital-signs
* code = http://loinc.org#88365-2 "Body composition panel"
* subject = Reference(PatientExample)
* performer = Reference(PractitionerExample)
* effectiveDateTime = "2024-03-19T08:00:00Z"
* device = Reference(BioimpedanceAnalyzer)
* component[bodyFat].code = http://loinc.org#41982-0 "Percentage body fat"
* component[bodyFat].valueQuantity = 22.5 '%' "percent"
* component[bodyFat].valueQuantity.system = "http://unitsofmeasure.org"
* component[bodyFat].valueQuantity.unit = "percent"
* component[leanMass].code = http://loinc.org#291-7 "Lean body mass"
* component[leanMass].valueQuantity = 54.6 'kg' "kilogram"
* component[leanMass].valueQuantity.system = "http://unitsofmeasure.org"
* component[leanMass].valueQuantity.unit = "kilogram"
* component[bodyWater].code = http://loinc.org#73708-0 "Total body water"
* component[bodyWater].valueQuantity = 39.2 'L' "liter"
* component[bodyWater].valueQuantity.system = "http://unitsofmeasure.org"
* component[bodyWater].valueQuantity.unit = "liter"
* component[muscleMass].code = http://loinc.org#73713-0 "Muscle mass"
* component[muscleMass].valueQuantity = 51.8 'kg' "kilogram"
* component[muscleMass].valueQuantity.system = "http://unitsofmeasure.org"
* component[muscleMass].valueQuantity.unit = "kilogram"
* component[boneMass].code = http://loinc.org#73711-4 "Bone mass"
* component[boneMass].valueQuantity = 2.8 'kg' "kilogram"
* component[boneMass].valueQuantity.system = "http://unitsofmeasure.org"
* component[boneMass].valueQuantity.unit = "kilogram"

// Originally defined on lines 87 - 96
Instance: SmartScale
InstanceOf: Device
Title: "Smart Scale Device"
Description: "Smart scale device example"
Usage: #example
* deviceName.name = "Smart Body Analyzer"
* deviceName.type = #user-friendly-name
* manufacturer = "HealthTech Devices"
* modelNumber = "SBA-2024"
* type = http://snomed.info/sct#5159002 "Physiologic monitoring system"

// Originally defined on lines 98 - 107
Instance: BioimpedanceAnalyzer
InstanceOf: Device
Title: "Bioimpedance Analyzer Device"
Description: "Bioimpedance analyzer device example"
Usage: #example
* deviceName.name = "Professional Body Composition Analyzer"
* deviceName.type = #user-friendly-name
* manufacturer = "MedTech Solutions"
* modelNumber = "BCA-Pro"
* type = http://snomed.info/sct#706767009 "Patient data recorder"




// ===== Conteúdo de: SymptomExamples.fsh =====

// Originally defined on lines 1 - 10
Instance: ChronicSymptomExample
InstanceOf: Observation
Description: "Chronic symptom observation example"
Usage: #example
* status = #final
* category = http://terminology.hl7.org/CodeSystem/observation-category#survey
* code = http://snomed.info/sct#267036007 "Fatigue"
* subject = Reference(Patient/PatientExample)
* performer = Reference(Practitioner/PractitionerExample)
* effectiveDateTime = "2024-03-19T14:00:00Z"

// Originally defined on lines 13 - 22
Instance: ExampleSymptomSeverity
InstanceOf: Observation
Description: "Symptom severity observation example"
Usage: #example
* status = #final
* category = http://terminology.hl7.org/CodeSystem/observation-category#survey
* code = http://snomed.info/sct#246604007 "Symptom severity"
* subject = Reference(Patient/PatientExample)
* performer = Reference(Practitioner/PractitionerExample)
* effectiveDateTime = "2024-03-19T10:30:00Z"




// ===== Conteúdo de: SocialInteractionExamples.fsh =====

// Originally defined on lines 1 - 21
Instance: SocialInteractionExample
InstanceOf: SocialInteractionProfile
Title: "Social Interaction Example"
Description: "Social interaction observation example"
Usage: #example
* status = #final
* category = http://terminology.hl7.org/CodeSystem/observation-category#social-history
* code = http://loinc.org#96766-1 "Social interaction pattern"
* subject = Reference(Patient/PatientExample)
* effectiveDateTime = "2024-01-03T14:00:00Z"
* valueCodeableConcept = SocialInteractionTypeCS#family
* component[duration].valueQuantity = 120 'min' "minutes"
* component[quality].valueCodeableConcept = SocialInteractionQualityCS#meaningful
* component[medium].valueCodeableConcept = SocialInteractionMediumCS#inPerson
* component[participants].valueInteger = 4
* extension[context].valueCodeableConcept = SocialContextCS#home
* extension[support].valueCodeableConcept = SocialSupportCS#strong
* extension[activity].valueCodeableConcept = SocialActivityCS#meal




// ===== Conteúdo de: VitalSignsExamples.fsh =====

// Originally defined on lines 1 - 18
Instance: HeartRateExample
InstanceOf: HeartRateObservation
Title: "Heart Rate Measurement Example"
Description: "Heart rate observation example"
Usage: #example
* status = #final
* code = http://loinc.org#8867-4 "Heart rate"
* subject = Reference(PatientExample)
* effectiveDateTime = "2024-03-19T15:30:00Z"
* valueQuantity = 72 '/min' "per minute"
* valueQuantity.system = "http://unitsofmeasure.org"
* valueQuantity.unit = "per minute"
* device = Reference(DeviceHeartRateMonitor)
* performer = Reference(PractitionerExample)
* component[heartRateVariability].code = http://loinc.org#80404-7 "R-R interval.standard deviation (Heart rate variability)"
* component[heartRateVariability].valueQuantity = 45 'ms' "millisecond"
* component[heartRateVariability].valueQuantity.system = "http://unitsofmeasure.org"
* component[heartRateVariability].valueQuantity.unit = "millisecond"

// Originally defined on lines 20 - 38
Instance: BloodPressureExample
InstanceOf: BloodPressureObservation
Title: "Blood Pressure Measurement Example"
Description: "Blood pressure observation example"
Usage: #example
* status = #final
* code = http://loinc.org#85354-9 "Blood pressure panel with all children optional"
* subject = Reference(PatientExample)
* effectiveDateTime = "2024-03-19T15:30:00Z"
* device = Reference(DeviceBloodPressureMonitor)
* performer = Reference(PractitionerExample)
* component[systolic].code = http://loinc.org#8480-6 "Systolic blood pressure"
* component[systolic].valueQuantity = 120 'mm[Hg]' "millimeter of mercury"
* component[systolic].valueQuantity.system = "http://unitsofmeasure.org"
* component[systolic].valueQuantity.unit = "millimeter of mercury"
* component[diastolic].code = http://loinc.org#8462-4 "Diastolic blood pressure"
* component[diastolic].valueQuantity = 80 'mm[Hg]' "millimeter of mercury"
* component[diastolic].valueQuantity.system = "http://unitsofmeasure.org"
* component[diastolic].valueQuantity.unit = "millimeter of mercury"

// Originally defined on lines 40 - 49
Instance: DeviceHeartRateMonitor
InstanceOf: Device
Title: "Heart Rate Monitor Device"
Description: "Heart rate monitor device example"
Usage: #example
* deviceName.name = "Continuous Heart Rate Monitor"
* deviceName.type = #user-friendly-name
* manufacturer = "HealthTech Devices"
* modelNumber = "HRM-2024"
* type = http://snomed.info/sct#720737000 "Pulse rate monitoring device"

// Originally defined on lines 51 - 60
Instance: DeviceBloodPressureMonitor
InstanceOf: Device
Title: "Blood Pressure Monitor Device"
Description: "Blood pressure monitor device example"
Usage: #example
* deviceName.name = "Digital Blood Pressure Monitor"
* deviceName.type = #user-friendly-name
* manufacturer = "HealthTech Devices"
* modelNumber = "BPM-2024"
* type = http://snomed.info/sct#43770009 "Blood pressure monitor"




// ===== Conteúdo de: PractitionerExample.fsh =====

// Originally defined on lines 1 - 8
Instance: PractitionerExample
InstanceOf: Practitioner
Description: "Practitioner resource example"
Usage: #example
* identifier[0].system = "http://terminology.hl7.org/CodeSystem/practitioner-identifier"
* identifier[0].value = "9941339108"
* name.given = "Jane"
* name.family = "Smith"




// ===== Conteúdo de: MindfulnessCompleteExamples.fsh =====

// Originally defined on lines 1 - 30
Instance: CompleteMindfulnessSession
InstanceOf: MindfulnessObservation
Title: "Complete Mindfulness Session Example"
Description: "Complete mindfulness session observation example"
Usage: #example
* status = #final
* code = http://snomed.info/sct#285854004 "Emotion"
* subject = Reference(Patient/PatientExample)
* effectiveDateTime = "2024-03-19T08:00:00Z"
* performer = Reference(Practitioner/PractitionerExample)
* component[sessionDuration].code = http://snomed.info/sct#118682006 "Duration"
* component[sessionDuration].valueQuantity = 20 'min'
* component[stressLevel].code = http://snomed.info/sct#725854004 "Assessment of stress level"
* component[stressLevel].valueInteger = 3
* component[moodState].code = http://snomed.info/sct#373931001 "Mood finding"
* component[moodState].valueCodeableConcept = http://snomed.info/sct#130991005 "Neutral mood"
* component[relaxationResponse].code = http://snomed.info/sct#276241001 "Relaxation technique"
* component[relaxationResponse].valueString = "Deep breathing exercises with progressive relaxation"
* component[mindfulnessType].code = http://snomed.info/sct#285854004 "Emotion"
* component[mindfulnessType].valueCodeableConcept = http://snomed.info/sct#285854004 "Emotion"
* extension[mindfulness-context].extension[location].valueString = "Home meditation room"
* extension[mindfulness-context].extension[environment].valueCodeableConcept = #quiet "Quiet Space"
* extension[mindfulness-context].extension[guidance].valueBoolean = true

// Originally defined on lines 32 - 77
Instance: CompleteMindfulnessResponse
InstanceOf: QuestionnaireResponse
Title: "Complete Mindfulness Session Response"
Description: "Complete mindfulness questionnaire response example"
Usage: #example
* questionnaire = "https://2rdoc.pt/ig/ios-lifestyle-medicine/Questionnaire/daily-mindfulness"
* status = #completed
* subject = Reference(Patient/PatientExample)
* authored = "2024-03-19T08:30:00Z"
* item[0]
* item[0].linkId = "mindful_session"
* item[0].item[0]
* item[0].item[0].linkId = "session_duration"
* item[0].item[0].answer.valueInteger = 20
* item[0].item[1]
* item[0].item[1].linkId = "practice_type"
* item[0].item[1].answer.valueString = "Meditation"
* item[1]
* item[1].linkId = "mood_assessment"
* item[1].item[0]
* item[1].item[0].linkId = "current_mood"
* item[1].item[0].answer.valueCoding = http://snomed.info/sct#130991005 "Neutral mood"
* item[1].item[1]
* item[1].item[1].linkId = "mood_intensity"
* item[1].item[1].answer.valueInteger = 3
* item[2]
* item[2].linkId = "stress_assessment"
* item[2].item[0]
* item[2].item[0].linkId = "stress_level"
* item[2].item[0].answer.valueInteger = 3
* item[2].item[1]
* item[2].item[1].linkId = "stress_symptoms"
* item[2].item[1].answer[0].valueString = "Slight tension"
* item[3]
* item[3].linkId = "relaxation"
* item[3].item[0]
* item[3].item[0].linkId = "relaxation_duration"
* item[3].item[0].answer.valueInteger = 15
* item[3].item[1]
* item[3].item[1].linkId = "relaxation_technique"
* item[3].item[1].answer.valueString = "Deep breathing"




// ===== Conteúdo de: MindfulnessExamples.fsh =====

// Originally defined on lines 1 - 26
Instance: MindfulnessObservationExample
InstanceOf: MindfulnessObservation
Title: "Example of Mindfulness Session Observation"
Description: "Mindfulness observation example"
Usage: #example
* status = #final
* code = http://snomed.info/sct#285854004 "Emotion"
* subject = Reference(Patient/PatientExample)
* effectiveDateTime = "2024-03-19T09:30:00Z"
* performer = Reference(Practitioner/PractitionerExample)
* component[sessionDuration].code = http://snomed.info/sct#118682006 "Duration"
* component[sessionDuration].valueQuantity = 20 'min'
* component[stressLevel].code = http://snomed.info/sct#725854004 "Assessment of stress level"
* component[stressLevel].valueInteger = 4
* component[moodState].code = http://snomed.info/sct#373931001 "Mood finding"
* component[moodState].valueCodeableConcept = http://snomed.info/sct#130991005 "Neutral mood"
* component[relaxationResponse].code = http://snomed.info/sct#276241001 "Relaxation technique"
* component[relaxationResponse].valueString = "Deep breathing exercises helped reduce tension"
* component[mindfulnessType].code = http://snomed.info/sct#285854004 "Emotion"
* component[mindfulnessType].valueCodeableConcept = http://snomed.info/sct#285854004 "Emotion"

// Originally defined on lines 29 - 60
Instance: MindfulnessQuestionnaireExample
InstanceOf: Questionnaire
Title: "Example of Mindfulness Questionnaire"
Usage: #example
* url = "https://2rdoc.pt/ig/ios-lifestyle-medicine/Questionnaire/mindfulness-example"
* status = #active
* title = "Daily Mindfulness Assessment"
* version = "1.0"
* name = "MindfulnessQuestionnaireExample"
* date = "2024-03-19"
* description = "Example questionnaire for daily mindfulness practice assessment"
* item[0]
* item[0].linkId = "session_details"
* item[0].text = "Session Details"
* item[0].type = #group
* item[0].item[0]
* item[0].item[0].linkId = "duration"
* item[0].item[0].text = "Duration (minutes)"
* item[0].item[0].type = #integer
* item[0].item[0].required = true
* item[0].item[1]
* item[0].item[1].linkId = "technique"
* item[0].item[1].text = "Technique Used"
* item[0].item[1].type = #choice
* item[0].item[1].required = true
* item[0].item[1].answerOption[0].valueString = "Mindful Breathing"
* item[0].item[1].answerOption[1].valueString = "Body Scan"
* item[0].item[1].answerOption[2].valueString = "Walking Meditation"




// ===== Conteúdo de: ReproductiveExamples.fsh =====

// Originally defined on lines 1 - 10
Instance: ExampleReproductiveActivity
InstanceOf: CarePlan
Description: "Reproductive health care plan example"
Usage: #example
* status = #active
* intent = #plan
* subject = Reference(Patient/PatientExample)
* activity.detail.kind = #ServiceRequest
* activity.detail.code = ReproductiveActivityCS#cycle-tracking
* activity.detail.status = #scheduled




// ===== Conteúdo de: MissingResources.fsh =====

// Originally defined on lines 3 - 11
Instance: example
InstanceOf: Patient
Usage: #example
* identifier.system = "http://example.org/patients"
* identifier.value = "example-patient"
* name.family = "Example"
* name.given = "Patient"
* gender = #unknown
* birthDate = "1970-01-01"

// Originally defined on lines 13 - 20
Instance: osa-practitioner-kyle-anydoc
InstanceOf: Practitioner
Usage: #example
* identifier.system = "http://example.org/practitioners"
* identifier.value = "kyle-anydoc"
* name.family = "Anydoc"
* name.given = "Kyle"
* name.prefix = "Dr."

// Originally defined on lines 22 - 30
Instance: PatientMindfulness
InstanceOf: Patient
Usage: #example
* identifier.system = "http://example.org/patients"
* identifier.value = "mindfulness-patient"
* name.family = "Mindfulness"
* name.given = "Test"
* gender = #other
* birthDate = "1980-01-01"

// Originally defined on lines 32 - 38
Instance: Org2RDoc
InstanceOf: Organization
Usage: #example
* identifier.system = "http://example.org/organizations"
* identifier.value = "2rdoc"
* name = "2RDoc Healthcare Solutions"
* active = true




// ===== Conteúdo de: MindfulnessWorkflow.fsh =====

// Originally defined on lines 1 - 8
Profile: MindfulnessSchedule
Parent: Basic
Id: mindfulness-schedule
Title: "Mindfulness Schedule"
Description: "Schedule configuration for mindfulness sessions"
* code 1..1
* code MS
* code = https://2rdoc.pt/ig/ios-lifestyle-medicine/CodeSystem/mindfulness-schedule-type#recurring "Recurring Schedule"

// Originally defined on lines 10 - 14
Extension: MindfulnessScheduleTiming
Parent: Extension
Id: mindfulness-schedule-timing
Title: "Mindfulness Schedule Timing"
Description: "Timing configuration for mindfulness sessions"
* value[x] only Timing
* extension 0..0

// Originally defined on lines 16 - 27
Instance: WeeklyMindfulnessSchedule
InstanceOf: MindfulnessSchedule
Title: "Weekly Mindfulness Schedule"
Description: "Example of a weekly mindfulness schedule"
Usage: #example
* code = https://2rdoc.pt/ig/ios-lifestyle-medicine/CodeSystem/mindfulness-schedule-type#recurring "Recurring Schedule"
* extension[mindfulness-schedule-timing].valueTiming.repeat.frequency = 1
* extension[mindfulness-schedule-timing].valueTiming.repeat.period = 1
* extension[mindfulness-schedule-timing].valueTiming.repeat.periodUnit = #wk
* extension[mindfulness-schedule-timing].valueTiming.repeat.dayOfWeek = #mon
* extension[mindfulness-schedule-timing].valueTiming.repeat.dayOfWeek[0] = #wed
* extension[mindfulness-schedule-timing].valueTiming.repeat.dayOfWeek[1] = #fri




// ===== Conteúdo de: MindfulnessRules.fsh =====

// This file has no content after preprocessing.


// ===== Conteúdo de: MindfulnessMappings.fsh =====

// Originally defined on lines 1 - 9
Mapping: MindfulnessToHealthKit
Id: mindfulness-to-healthkit
Title: "Mapping to Apple HealthKit"
Source: MindfulnessObservation
Target: "http://developer.apple.com/documentation/healthkit"
* -> "HKCategoryTypeIdentifierMindfulSession" "Root mapping"
* effectiveDateTime -> "startDate and endDate" "Session timing"
* component[sessionDuration].valueQuantity -> "duration" "Session duration"

// Originally defined on lines 11 - 20
Mapping: MindfulnessToLOINC
Id: mindfulness-to-loinc
Title: "Mapping to LOINC codes"
Source: MindfulnessObservation
Target: "http://loinc.org"
* -> "89555-7" "Mindfulness safety questionnaire"
* component[stressLevel] -> "89556-5" "Stress level score"
* component[sessionDuration] -> "89557-3" "Duration of mindfulness practice"
* component[moodState] -> "89558-1" "Mood pattern"

// Originally defined on lines 22 - 31
Mapping: MindfulnessToSNOMED
Id: mindfulness-to-snomed
Title: "Mapping to SNOMED CT"
Source: MindfulnessObservation
Target: "http://snomed.info/sct"
* -> "711415009" "Meditation"
* component[stressLevel] -> "725854004" "Assessment of stress level"
* component[moodState] -> "373931001" "Mood finding"
* component[relaxationResponse] -> "276241001" "Relaxation technique"

// Originally defined on lines 33 - 49
Extension: MindfulnessImportMap
Parent: Extension
Id: mindfulness-import-map
Title: "Mindfulness Import Mapping"
Description: "Mapping instructions for importing mindfulness data"
* ^url = "https://2rdoc.pt/ig/ios-lifestyle-medicine/StructureDefinition/mindfulness-import-map"
* ^version = "1.0.0"
* ^status = #draft
* extension contains
    source 0.. and
    target 0.. and
    mapping 0..
* extension[source] 1..1
* extension[source] MS
* extension[target] 1..1
* extension[target] MS
* extension[mapping] 1..1
* extension[mapping] MS
* extension[source].value[x] only string
* extension[target].value[x] only string
* extension[mapping].value[x] only string
* value[x] 0..0
* extension[source].extension 0..0
* extension[target].extension 0..0
* extension[mapping].extension 0..0

// Originally defined on lines 51 - 57
Instance: HealthKitMappingConfig
InstanceOf: MindfulnessImportMap
Usage: #inline
* extension[source].valueString = "HKCategoryTypeIdentifierMindfulSession"
* extension[target].valueString = "Observation"
* extension[mapping].valueString = "duration->component[sessionDuration].valueQuantity"




// ===== Conteúdo de: SocialInteractionMappings.fsh =====

// Originally defined on lines 1 - 10
Mapping: SocialInteractionToHealthKit
Id: social-interaction-to-healthkit
Title: "Mapping to Apple HealthKit"
Description: "Definition for social-interaction-to-healthkit resource"
Source: SocialInteractionProfile
Target: "http://developer.apple.com/documentation/healthkit"
* -> "HKCategoryTypeIdentifierSocialInteraction" "Root mapping"
* valueCodeableConcept -> "interactionType" "Type of interaction"
* component[duration] -> "duration" "Duration of interaction"
* component[participants] -> "participantCount" "Number of participants"

// Originally defined on lines 12 - 20
Mapping: SocialInteractionToLOINC
Id: social-interaction-to-loinc
Title: "Mapping to LOINC codes"
Source: SocialInteractionProfile
Target: "http://loinc.org"
* -> "96766-1" "Social Interaction Panel"
* component[duration] -> "89597-9" "Interaction duration"
* component[quality] -> "89598-7" "Interaction quality"




// ===== Conteúdo de: MindfulnessDiagnosticMappings.fsh =====

// Originally defined on lines 1 - 45
Instance: MindfulnessDiagnosticMap
InstanceOf: ConceptMap
Title: "Mindfulness Diagnostic Mappings"
Description: "Mapping of mindfulness outcomes to diagnostic codes"
Usage: #definition
* status = #draft
* experimental = false
* purpose = "Map mindfulness outcomes to standard diagnostic codes"
* sourceUri = "https://2rdoc.pt/ig/ios-lifestyle-medicine/ValueSet/mindfulness-outcome-vs"
* targetUri = "http://snomed.info/sct"
* group[0].source = "https://2rdoc.pt/ig/ios-lifestyle-medicine/CodeSystem/mindfulness-outcome-cs"
* group[0].target = "http://snomed.info/sct"
* group[0].element[0]
* group[0].element[0].code = #stressReduction
* group[0].element[0].target[0]
* group[0].element[0].target[0].code = #73595000
* group[0].element[0].target[0].display = "Stress"
* group[0].element[0].target[0].equivalence = #narrower
* group[0].element[0].target[0].comment = "Indicates reduction in stress levels"
* group[0].element[1]
* group[0].element[1].code = #improvedSleep
* group[0].element[1].target[0]
* group[0].element[1].target[0].code = #248234008
* group[0].element[1].target[0].display = "Sleep pattern"
* group[0].element[1].target[0].equivalence = #narrower
* group[0].element[1].target[0].comment = "Indicates improvement in activity quality"
* group[0].element[2]
* group[0].element[2].code = #emotionalBalance
* group[0].element[2].target[0]
* group[0].element[2].target[0].code = #285854004
* group[0].element[2].target[0].display = "Emotional state"
* group[0].element[2].target[0].equivalence = #equivalent
* group[0].element[2].target[0].comment = "Maps to emotional state finding"
* group[0].element[3]
* group[0].element[3].code = #increasedAwareness
* group[0].element[3].target[0]
* group[0].element[3].target[0].code = #736253002
* group[0].element[3].target[0].display = "Mental state, behavior and/or psychosocial functioning"
* group[0].element[3].target[0].equivalence = #relatedto
* group[0].element[3].target[0].comment = "General improvement in mental state"




// ===== Conteúdo de: StressMappings.fsh =====

// Originally defined on lines 1 - 10
Mapping: StressToHealthKit
Id: stress-to-healthkit
Title: "Mapping to Apple HealthKit"
Description: "Definition for stress-to-healthkit resource"
Source: StressLevelProfile
Target: "http://developer.apple.com/documentation/healthkit"
* -> "HKCategoryTypeIdentifierStressLevel" "Root mapping"
* valueQuantity -> "stressLevel" "Overall stress score"
* component[physiologicalStress] -> "physiologicalStress" "Physical stress indicators"
* component[psychologicalStress] -> "mentalStress" "Mental stress indicators"

// Originally defined on lines 12 - 20
Mapping: StressToLOINC
Id: stress-to-loinc
Title: "Mapping to LOINC codes"
Source: StressLevelProfile
Target: "http://loinc.org"
* -> "89592-0" "Stress Level Panel"
* component[physiologicalStress] -> "89593-8" "Physical stress score"
* component[psychologicalStress] -> "89594-6" "Mental stress score"




// ===== Conteúdo de: ShareableMetadata.fsh =====

// This file has no content after preprocessing.


// ===== Conteúdo de: BodyMetricsProfiles.fsh =====

Alias: $SCT = http://snomed.info/sct
Alias: $LOINC = http://loinc.org
Alias: $UCUM = http://unitsofmeasure.org

// Originally defined on lines 5 - 20
Profile: BodyMetricsObservation
Parent: Observation
Id: body-metrics-observation
Title: "Body Metrics Observation Profile"
Description: "Profile for body measurements from iOS Health App"
* ^version = "0.1.0"
* ^status = #draft
* ^publisher = "Open Health Manager"
* status MS
* category 1..1
* category MS
* category = http://terminology.hl7.org/CodeSystem/observation-category#vital-signs
* subject 1..1
* subject MS
* effectiveDateTime 1..1
* effectiveDateTime MS
* device 0..1
* device MS

// Originally defined on lines 22 - 34
Profile: WeightObservation
Parent: BodyMetricsObservation
Id: weight-observation
Title: "Weight Measurement Profile"
Description: "Profile for body weight measurements"
* ^version = "0.1.0"
* ^status = #draft
* code = http://loinc.org#29463-7 "Body weight"
* valueQuantity only Quantity
* valueQuantity.system = "http://unitsofmeasure.org"
* valueQuantity.code = #kg

// Originally defined on lines 36 - 48
Profile: HeightObservation
Parent: BodyMetricsObservation
Id: height-observation
Title: "Height Measurement Profile"
Description: "Profile for body height measurements"
* ^version = "0.1.0"
* ^status = #draft
* code = http://loinc.org#8302-2 "Body height"
* valueQuantity only Quantity
* valueQuantity.system = "http://unitsofmeasure.org"
* valueQuantity.code = #cm

// Originally defined on lines 50 - 62
Profile: BMIObservation
Parent: BodyMetricsObservation
Id: bmi-observation
Title: "BMI Measurement Profile"
Description: "Profile for Body Mass Index calculations"
* ^version = "0.1.0"
* ^status = #draft
* code = http://loinc.org#39156-5 "Body mass index (BMI) [Ratio]"
* valueQuantity only Quantity
* valueQuantity.system = "http://unitsofmeasure.org"
* valueQuantity.code = #kg/m2

// Originally defined on lines 64 - 103
Profile: BodyCompositionObservation
Parent: BodyMetricsObservation
Id: body-composition-observation
Title: "Body Composition Profile"
Description: "Profile for body composition measurements including fat, lean mass, and other metrics"
* ^version = "0.1.0"
* ^status = #draft
* code = http://loinc.org#88365-2 "Body composition panel"
* component ^slicing.discriminator.type = #value
* component ^slicing.discriminator.path = "code"
* component ^slicing.rules = #open
* component contains
    bodyFat 0.. and
    leanMass 0.. and
    bodyWater 0.. and
    muscleMass 0.. and
    boneMass 0..
* component[bodyFat] 0..1
* component[bodyFat] MS
* component[leanMass] 0..1
* component[leanMass] MS
* component[bodyWater] 0..1
* component[bodyWater] MS
* component[muscleMass] 0..1
* component[muscleMass] MS
* component[boneMass] 0..1
* component[boneMass] MS
* component[bodyFat].code = http://loinc.org#41982-0 "Percentage body fat"
* component[bodyFat].valueQuantity.system = "http://unitsofmeasure.org"
* component[bodyFat].valueQuantity.code = #%
* component[leanMass].code = http://loinc.org#291-7 "Lean body mass"
* component[leanMass].valueQuantity.system = "http://unitsofmeasure.org"
* component[leanMass].valueQuantity.code = #kg
* component[bodyWater].code = http://loinc.org#73708-0 "Total body water"
* component[bodyWater].valueQuantity.system = "http://unitsofmeasure.org"
* component[bodyWater].valueQuantity.code = #L
* component[muscleMass].code = http://loinc.org#73713-0 "Muscle mass"
* component[muscleMass].valueQuantity.system = "http://unitsofmeasure.org"
* component[muscleMass].valueQuantity.code = #kg
* component[boneMass].code = http://loinc.org#73711-4 "Bone mass"
* component[boneMass].valueQuantity.system = "http://unitsofmeasure.org"
* component[boneMass].valueQuantity.code = #kg




// ===== Conteúdo de: AdvancedVitalSignsProfiles.fsh =====

Alias: $SCT = http://snomed.info/sct
Alias: $LOINC = http://loinc.org
Alias: $UCUM = http://unitsofmeasure.org

// Originally defined on lines 5 - 98
Profile: AdvancedVitalSigns
Parent: Observation
Id: advanced-vital-signs
Title: "Advanced Vital Signs Profile"
Description: "Profile for advanced vital signs data from iOS Health App"
* ^version = "0.1.0"
* ^status = #draft
* ^publisher = "HL7 International"
* ^contact.name = "Advanced Vital Signs Working Group"
* status MS
* category 1..1
* category MS
* category = http://terminology.hl7.org/CodeSystem/observation-category#vital-signs
* code 1..1
* code MS
* subject 1..1
* subject MS
* effectiveDateTime 1..1
* effectiveDateTime MS
* device 0..1
* device MS
* method 0..1
* method MS
* note 0..*
* note MS
* component ^slicing.discriminator.type = #value
* component ^slicing.discriminator.path = "code"
* component ^slicing.rules = #open
* component ^short = "Advanced vital signs components"
* component ^definition = "Components of advanced vital sign measurements"
* component contains
    hrvSpectral 0.. and
    hrvEntropy 0.. and
    meanArterialPressure 0.. and
    pulseWaveAnalysis 0.. and
    respiratoryVariability 0.. and
    oxygenationIndex 0.. and
    stressIndex 0.. and
    thermalGradient 0.. and
    autonomicBalance 0.. and
    recoveryRate 0.. and
    allostaticLoad 0..
* component[hrvSpectral] 0..1
* component[hrvSpectral] MS
* component[hrvEntropy] 0..1
* component[hrvEntropy] MS
* component[meanArterialPressure] 0..1
* component[meanArterialPressure] MS
* component[pulseWaveAnalysis] 0..1
* component[pulseWaveAnalysis] MS
* component[respiratoryVariability] 0..1
* component[respiratoryVariability] MS
* component[oxygenationIndex] 0..1
* component[oxygenationIndex] MS
* component[stressIndex] 0..1
* component[stressIndex] MS
* component[thermalGradient] 0..1
* component[thermalGradient] MS
* component[autonomicBalance] 0..1
* component[autonomicBalance] MS
* component[recoveryRate] 0..1
* component[recoveryRate] MS
* component[allostaticLoad] 0..1
* component[allostaticLoad] MS
* component[hrvSpectral].code = http://loinc.org#87834-8 "Heart rate variability [Frequency band]"
* component[hrvSpectral].valueQuantity.system = "http://unitsofmeasure.org"
* component[hrvSpectral].valueQuantity.code = #ms
* component[hrvSpectral] ^short = "Spectral analysis of heart rate variability"
* component[hrvEntropy].code = http://loinc.org#87835-5 "Heart rate variability entropy"
* component[hrvEntropy].valueQuantity.system = "http://unitsofmeasure.org"
* component[hrvEntropy].valueQuantity.code = #{entropy}
* component[hrvEntropy] ^short = "Sample entropy of heart rate variability"
* component[meanArterialPressure].code = http://loinc.org#8478-0 "Mean blood pressure"
* component[meanArterialPressure].valueQuantity.system = "http://unitsofmeasure.org"
* component[meanArterialPressure].valueQuantity.code = #mmHg
* component[meanArterialPressure] ^short = "Mean arterial blood pressure"
* component[pulseWaveAnalysis].code = http://loinc.org#87836-3 "Pulse wave analysis"
* component[pulseWaveAnalysis].valueQuantity.system = "http://unitsofmeasure.org"
* component[pulseWaveAnalysis].valueQuantity.code = #{index}
* component[pulseWaveAnalysis] ^short = "Analysis of arterial pulse wave"
* component[respiratoryVariability].code = http://loinc.org#87837-1 "Respiratory rate variability"
* component[respiratoryVariability].valueQuantity.system = "http://unitsofmeasure.org"
* component[respiratoryVariability].valueQuantity.code = #{coefficient}
* component[respiratoryVariability] ^short = "Variability in respiratory rate"
* component[oxygenationIndex].code = http://loinc.org#87838-9 "Oxygenation index"
* component[oxygenationIndex].valueQuantity.system = "http://unitsofmeasure.org"
* component[oxygenationIndex].valueQuantity.code = #{ratio}
* component[oxygenationIndex] ^short = "Index of blood oxygenation"
* component[stressIndex].code = http://loinc.org#87839-7 "Physiological stress index"
* component[stressIndex].valueQuantity.system = "http://unitsofmeasure.org"
* component[stressIndex].valueQuantity.code = #{index}
* component[stressIndex] ^short = "Index of physiological stress"
* component[thermalGradient].code = http://loinc.org#87840-5 "Temperature gradient"
* component[thermalGradient].valueQuantity.system = "http://unitsofmeasure.org"
* component[thermalGradient].valueQuantity.code = #Cel
* component[thermalGradient] ^short = "Gradient of body temperature"
* component[autonomicBalance].code = http://loinc.org#87841-3 "Autonomic balance index"
* component[autonomicBalance].valueQuantity.system = "http://unitsofmeasure.org"
* component[autonomicBalance].valueQuantity.code = #{ratio}
* component[autonomicBalance] ^short = "Balance of autonomic nervous system"
* component[recoveryRate].code = http://loinc.org#87842-1 "Recovery rate index"
* component[recoveryRate].valueQuantity.system = "http://unitsofmeasure.org"
* component[recoveryRate].valueQuantity.code = #{rate}
* component[recoveryRate] ^short = "Rate of physiological recovery"
* component[allostaticLoad].code = http://loinc.org#87843-9 "Allostatic load index"
* component[allostaticLoad].valueQuantity.system = "http://unitsofmeasure.org"
* component[allostaticLoad].valueQuantity.code = #{score}
* component[allostaticLoad] ^short = "Measure of cumulative physiological burden"

// Originally defined on lines 100 - 106
Extension: AdvancedVitalSignsContext
Parent: Extension
Id: advanced-vital-signs-context
Title: "Advanced Vital Signs Context Extension"
Description: "Additional context about advanced vital sign measurements"
* value[x] only CodeableConcept
* valueCodeableConcept from AdvancedVitalSignsContextVS (required)
* extension 0..0

// Originally defined on lines 108 - 114
ValueSet: AdvancedVitalSignsContextVS
Id: advanced-vital-signs-context-vs
Title: "Advanced Vital Signs Context Value Set"
Description: "Context codes for advanced vital sign measurements"
* ^experimental = true
* include codes from system AdvancedVitalSignsContextCS

// Originally defined on lines 116 - 128
CodeSystem: AdvancedVitalSignsContextCS
Id: advanced-vital-signs-context-cs
Title: "Advanced Vital Signs Context Code System"
Description: "Codes for advanced vital signs measurement context"
* ^experimental = true
* ^caseSensitive = true
* #resting "Resting state" "Measurement taken during rest"
* #active "Active state" "Measurement taken during activity"
* #recovery "Recovery state" "Measurement taken during recovery"
* #activity "Sleep state" "Measurement taken during activity"
* #stress "Stress state" "Measurement taken during stress"




// ===== Conteúdo de: MobilityProfiles.fsh =====

// Originally defined on lines 1 - 28
Profile: MobilityProfile
Parent: Observation
Id: mobility-profile
Title: "Mobility Profile"
Description: "Profile for mobility data from iOS Health App"
* status MS
* category 1..1
* category MS
* category = http://terminology.hl7.org/CodeSystem/observation-category#activity
* code 1..1
* code MS
* subject 1..1
* subject MS
* effectiveDateTime 1..1
* effectiveDateTime MS
* device 0..1
* device MS
* component ^slicing.discriminator.type = #value
* component ^slicing.discriminator.path = "code"
* component ^slicing.rules = #open
* component contains
    steadiness 0.. and
    balance 0.. and
    gait 0.. and
    movement 0..
* component[steadiness] 0..1
* component[steadiness] MS
* component[balance] 0..1
* component[balance] MS
* component[gait] 0..1
* component[gait] MS
* component[movement] 0..1
* component[movement] MS
* component[steadiness].code = http://loinc.org#LA32-8
* component[balance].code = http://loinc.org#LA32-9
* component[gait].code = http://loinc.org#LA29042-4
* component[movement].code = http://loinc.org#LA29043-2




// ===== Conteúdo de: VitalSignsProfiles.fsh =====

Alias: $SCT = http://snomed.info/sct
Alias: $LOINC = http://loinc.org
Alias: $UCUM = http://unitsofmeasure.org
Alias: $vitalsigns = http://hl7.org/fhir/StructureDefinition/vitalsigns

// Originally defined on lines 6 - 18
Profile: LifestyleVitalSigns
Parent: http://hl7.org/fhir/StructureDefinition/vitalsigns
Id: lifestyle-vital-signs
Title: "Lifestyle Medicine Vital Signs Profile"
Description: "Profile for vital signs data from iOS Health App"
* status MS
* category 1..*
* category MS
* subject 1..1
* subject MS
* effectiveDateTime 1..1
* effectiveDateTime MS
* code 1..1
* code MS
* value[x] 0..1
* value[x] MS
* device 0..1
* device MS

// Originally defined on lines 20 - 42
Profile: HeartRateObservation
Parent: LifestyleVitalSigns
Id: heart-rate-observation
Title: "Heart Rate Observation Profile"
Description: "Profile for heart rate measurements from iOS Health App"
* code = http://loinc.org#8867-4 "Heart rate"
* valueQuantity only Quantity
* valueQuantity.system = "http://unitsofmeasure.org"
* valueQuantity.code = #/min
* component ^slicing.discriminator.type = #value
* component ^slicing.discriminator.path = "code"
* component ^slicing.rules = #open
* component contains
    restingHeartRate 0.. and
    exerciseHeartRate 0.. and
    recoveryHeartRate 0.. and
    heartRateVariability 0..
* component[restingHeartRate] 0..1
* component[restingHeartRate] MS
* component[exerciseHeartRate] 0..1
* component[exerciseHeartRate] MS
* component[recoveryHeartRate] 0..1
* component[recoveryHeartRate] MS
* component[heartRateVariability] 0..1
* component[heartRateVariability] MS
* component[heartRateVariability].code = http://loinc.org#80404-7 "R-R interval.standard deviation (Heart rate variability)"
* component[heartRateVariability].valueQuantity.system = "http://unitsofmeasure.org"
* component[heartRateVariability].valueQuantity.code = #ms

// Originally defined on lines 44 - 68
Profile: BloodPressureObservation
Parent: LifestyleVitalSigns
Id: blood-pressure-observation
Title: "Blood Pressure Observation Profile"
Description: "Profile for blood pressure measurements from iOS Health App"
* code = http://loinc.org#85354-9 "Blood pressure panel with all children optional"
* component 2..2
* component MS
* component ^slicing.discriminator.type = #value
* component ^slicing.discriminator.path = "code"
* component ^slicing.rules = #closed
* component contains
    systolic 0.. and
    diastolic 0..
* component[systolic] 1..1
* component[systolic] MS
* component[diastolic] 1..1
* component[diastolic] MS
* component[systolic].code = http://loinc.org#8480-6 "Systolic blood pressure"
* component[systolic].valueQuantity only Quantity
* component[systolic].valueQuantity.system = "http://unitsofmeasure.org"
* component[systolic].valueQuantity.code = #mm[Hg]
* component[diastolic].code = http://loinc.org#8462-4 "Diastolic blood pressure"
* component[diastolic].valueQuantity only Quantity
* component[diastolic].valueQuantity.system = "http://unitsofmeasure.org"
* component[diastolic].valueQuantity.code = #mm[Hg]

// Originally defined on lines 70 - 78
Profile: OxygenSaturationObservation
Parent: LifestyleVitalSigns
Id: oxygen-saturation-observation
Title: "Oxygen Saturation Observation Profile"
Description: "Profile for SpO2 measurements from iOS Health App"
* code = http://loinc.org#2708-6 "Oxygen saturation in Arterial blood"
* valueQuantity.system = "http://unitsofmeasure.org"
* valueQuantity.code = #%




// ===== Conteúdo de: PhysicalActivityProfile.fsh =====

Alias: $LOINC = http://loinc.org
Alias: $SNOMED = http://snomed.info/sct
Alias: $UCUM = http://unitsofmeasure.org
Alias: $ActivityCodes = https://2rdoc.pt/ig/ios-lifestyle-medicine/activity-codes

// Originally defined on lines 6 - 50
Profile: PhysicalActivityObservation
Parent: Observation
Id: physical-activity-observation
Title: "Physical Activity Observation Profile"
Description: "Profile for recording physical activity data from iOS Health App"
* status MS
* category 1..1
* category MS
* category = http://terminology.hl7.org/CodeSystem/observation-category#activity
* code 1..1
* code MS
* code from PhysicalActivityTypeVS (required)
* subject 1..1
* subject MS
* subject only Reference(Patient)
* effectiveDateTime 1..1
* effectiveDateTime MS
* device 0..1
* device MS
* value[x] only Quantity
* component ^slicing.discriminator.type = #value
* component ^slicing.discriminator.path = "code"
* component ^slicing.rules = #open
* component contains
    steps 0.. and
    distance 0.. and
    duration 0.. and
    energy 0..
* component[steps] 0..1
* component[steps] MS
* component[distance] 0..1
* component[distance] MS
* component[duration] 0..1
* component[duration] MS
* component[energy] 0..1
* component[energy] MS
* component[steps].code = http://loinc.org#55423-8 "Number of steps in 24 hour Measured"
* component[steps].valueQuantity only Quantity
* component[steps].valueQuantity.system = "http://unitsofmeasure.org"
* component[steps].valueQuantity.code = #1 "count"
* component[distance].code = http://loinc.org#55430-3 "Distance walked"
* component[distance].valueQuantity only Quantity
* component[distance].valueQuantity.system = "http://unitsofmeasure.org"
* component[distance].valueQuantity.code = #km "kilometer"
* component[duration].code = http://loinc.org#55411-3 "Exercise duration"
* component[duration].valueQuantity only Quantity
* component[duration].valueQuantity.system = "http://unitsofmeasure.org"
* component[duration].valueQuantity.code = #min "minute"
* component[energy].code = http://loinc.org#55424-6 "Energy expenditure"
* component[energy].valueQuantity only Quantity
* component[energy].valueQuantity.system = "http://unitsofmeasure.org"
* component[energy].valueQuantity.code = #kcal "kilocalorie"




// ===== Conteúdo de: ReproductiveObservation.fsh =====

// Originally defined on lines 1 - 49
Profile: ReproductiveObservation
Parent: Observation
Id: social-history-observation
Title: "Reproductive Health Base Profile"
Description: "Base profile for social-history health observations"
* ^version = "1.0.0"
* ^status = #active
* ^date = "2024-03-19"
* status MS
* category 1..1
* category MS
* category = http://terminology.hl7.org/CodeSystem/observation-category#social-history
* code 1..1
* code MS
* subject 1..1
* subject MS
* subject only Reference(Patient)
* effectiveDateTime 1..1
* effectiveDateTime MS
* value[x] MS
* component ^slicing.discriminator.type = #value
* component ^slicing.discriminator.path = "code"
* component ^slicing.rules = #open
* component contains
    severity 0.. and
    duration 0.. and
    frequency 0.. and
    pattern 0..
* component[severity] 0..1
* component[severity] MS
* component[duration] 0..1
* component[duration] MS
* component[frequency] 0..1
* component[frequency] MS
* component[pattern] 0..1
* component[pattern] MS
* component[severity].code = http://loinc.org#72514-3
* component[severity].value[x] only integer
* component[severity].valueInteger 1..1
* component[severity].valueInteger obeys rep-1
* component[duration].code = http://loinc.org#3144-3
* component[duration].value[x] only Quantity
* component[duration].valueQuantity from DurationUnitsVS (required)
* component[frequency].code = http://loinc.org#92656-8
* component[frequency].value[x] only CodeableConcept
* component[frequency].valueCodeableConcept from SymptomFrequencyVS (required)
* component[pattern].code = http://loinc.org#64699-2
* component[pattern].value[x] only CodeableConcept
* component[pattern].valueCodeableConcept from SymptomProgressionVS (required)

// Originally defined on lines 51 - 54
Invariant: rep-1
Description: "Severity must be between 0 and 10"
* severity = #error
* expression = "$this >= 0 and $this <= 10"




// ===== Conteúdo de: SymptomProfiles.fsh =====

// Originally defined on lines 1 - 36
Profile: SymptomQuestionnaire
Parent: Questionnaire
Id: symptom-questionnaire
Title: "Symptom Assessment Questionnaire"
Description: "Questionnaire template for symptom assessments"
* status MS
* title MS
* item MS
* item ^slicing.discriminator.type = #value
* item ^slicing.discriminator.path = "linkId"
* item ^slicing.rules = #open
* item contains
    symptomType 0.. and
    location 0.. and
    onset 0.. and
    description 0..
* item[symptomType] 1..1
* item[symptomType] MS
* item[location] 0..1
* item[location] MS
* item[onset] 0..1
* item[onset] MS
* item[description] 0..1
* item[description] MS
* item[symptomType].linkId = "symptom-type"
* item[symptomType].text = "Type of Symptom"
* item[symptomType].type = #choice
* item[symptomType].required = true
* item[location].linkId = "location"
* item[location].text = "Location"
* item[location].type = #string
* item[onset].linkId = "onset"
* item[onset].text = "When did it start?"
* item[onset].type = #dateTime
* item[description].linkId = "description"
* item[description].text = "Description"
* item[description].type = #text




// ===== Conteúdo de: ReproductiveProfiles.fsh =====

// Originally defined on lines 1 - 25
Profile: FertilityObservation
Parent: Observation
Id: fertility-observation
Title: "Fertility Observation Profile"
Description: "Profile for fertility signs and symptoms"
* status MS
* category 1..1
* category MS
* category = http://terminology.hl7.org/CodeSystem/observation-category#social-history
* code = http://loinc.org#8669-4 "Ovulation status"
* subject 1..1
* subject MS
* effectiveDateTime 1..1
* effectiveDateTime MS
* component ^slicing.discriminator.type = #value
* component ^slicing.discriminator.path = "code"
* component ^slicing.rules = #open
* component contains
    cervicalMucus 0.. and
    ovulationTest 0.. and
    fertilityStatus 0..
* component[cervicalMucus] 0..1
* component[cervicalMucus] MS
* component[ovulationTest] 0..1
* component[ovulationTest] MS
* component[fertilityStatus] 0..1
* component[fertilityStatus] MS
* component[cervicalMucus].valueCodeableConcept from https://2rdoc.pt/ig/ios-lifestyle-medicine/ValueSet/cervical-mucus-vs (required)
* component[ovulationTest].valueCodeableConcept from https://2rdoc.pt/ig/ios-lifestyle-medicine/ValueSet/ovulation-test-vs (required)
* component[fertilityStatus].valueCodeableConcept from https://2rdoc.pt/ig/ios-lifestyle-medicine/ValueSet/fertility-status-vs (required)




// ===== Conteúdo de: MindfulnessProfiles.fsh =====

// Originally defined on lines 1 - 62
Profile: MindfulnessObservation
Parent: Observation
Id: mindfulness-observation
Title: "Mindfulness Session Observation"
Description: "Profile for recording mindfulness practice sessions and outcomes"
* status MS
* code MS
* subject MS
* effectiveDateTime MS
* performer MS
* value[x] MS
* component MS
* status = #final
* code = http://snomed.info/sct#285854004 "Emotion"
* subject only Reference(Patient)
* effectiveDateTime 1..1
* performer only Reference(Practitioner or PractitionerRole)
* component ^slicing.discriminator.type = #value
* component ^slicing.discriminator.path = "code"
* component ^slicing.rules = #open
* component contains
    sessionDuration 0.. and
    stressLevel 0.. and
    moodState 0.. and
    relaxationResponse 0.. and
    mindfulnessType 0..
* component[sessionDuration] 0..1
* component[stressLevel] 0..1
* component[moodState] 0..1
* component[relaxationResponse] 0..1
* component[mindfulnessType] 0..1
* component[sessionDuration].code = http://snomed.info/sct#118682006 "Duration"
* component[sessionDuration].value[x] only Quantity
* component[sessionDuration].valueQuantity.value 1..1
* component[sessionDuration].valueQuantity.unit = "min"
* component[sessionDuration].valueQuantity.system = "http://unitsofmeasure.org"
* component[sessionDuration].valueQuantity.code = #min
* component[stressLevel].code = http://snomed.info/sct#725854004 "Assessment of stress level"
* component[stressLevel].value[x] only integer
* component[stressLevel].valueInteger ^extension[0].url = "http://hl7.org/fhir/StructureDefinition/elementdefinition-minValueInteger"
* component[stressLevel].valueInteger ^extension[0].valueInteger = 0
* component[stressLevel].valueInteger ^extension[1].url = "http://hl7.org/fhir/StructureDefinition/elementdefinition-maxValueInteger"
* component[stressLevel].valueInteger ^extension[1].valueInteger = 10
* component[moodState].code = http://snomed.info/sct#373931001 "Mood finding"
* component[moodState].value[x] only CodeableConcept
* component[moodState].valueCodeableConcept from https://2rdoc.pt/ig/ios-lifestyle-medicine/ValueSet/mood (required)
* component[relaxationResponse].code = http://snomed.info/sct#276241001 "Relaxation technique"
* component[relaxationResponse].value[x] only string
* component[mindfulnessType].code = http://snomed.info/sct#285854004 "Emotion"
* component[mindfulnessType].value[x] only CodeableConcept
* component[mindfulnessType].valueCodeableConcept from https://2rdoc.pt/ig/ios-lifestyle-medicine/ValueSet/mindfulness-type (required)




// ===== Conteúdo de: SleepProfile.fsh =====

Alias: $SCT = http://snomed.info/sct
Alias: $LOINC = http://loinc.org
Alias: $UCUM = http://unitsofmeasure.org

// Originally defined on lines 5 - 75
Profile: SleepObservation
Parent: Observation
Id: activity-observation
Title: "Sleep Observation Profile"
Description: "Profile for recording activity data from iOS Health App"
* status MS
* category 1..1
* category MS
* category = http://terminology.hl7.org/CodeSystem/observation-category#activity
* code 1..1
* code MS
* code = http://loinc.org#93832-4 "Sleep pattern panel"
* subject 1..1
* subject MS
* subject only Reference(Patient)
* effectiveDateTime 0..1
* effectiveDateTime MS
* effectivePeriod 0..1
* effectivePeriod MS
* device 0..1
* device MS
* component ^slicing.discriminator.type = #value
* component ^slicing.discriminator.path = "code"
* component ^slicing.rules = #open
* component contains
    timeInBed 0.. and
    totalSleepTime 0.. and
    deepSleep 0.. and
    remSleep 0.. and
    lightSleep 0.. and
    respiratoryRate 0.. and
    heartRateVariability 0.. and
    interruptions 0..
* component[timeInBed] 1..1
* component[timeInBed] MS
* component[totalSleepTime] 1..1
* component[totalSleepTime] MS
* component[deepSleep] 0..1
* component[deepSleep] MS
* component[remSleep] 0..1
* component[remSleep] MS
* component[lightSleep] 0..1
* component[lightSleep] MS
* component[respiratoryRate] 0..1
* component[respiratoryRate] MS
* component[heartRateVariability] 0..1
* component[heartRateVariability] MS
* component[interruptions] 0..1
* component[interruptions] MS
* component[timeInBed].code = http://loinc.org#93831-6 "Time in bed"
* component[timeInBed].valueQuantity only Quantity
* component[timeInBed].valueQuantity.system = "http://unitsofmeasure.org"
* component[timeInBed].valueQuantity.code = #min
* component[totalSleepTime].code = http://loinc.org#93833-2 "Sleep duration"
* component[totalSleepTime].valueQuantity only Quantity
* component[totalSleepTime].valueQuantity.system = "http://unitsofmeasure.org"
* component[totalSleepTime].valueQuantity.code = #min
* component[deepSleep].code = http://loinc.org#93834-0 "Deep activity duration"
* component[deepSleep].valueQuantity only Quantity
* component[deepSleep].valueQuantity.system = "http://unitsofmeasure.org"
* component[deepSleep].valueQuantity.code = #min
* component[remSleep].code = http://loinc.org#93835-7 "REM activity duration"
* component[remSleep].valueQuantity only Quantity
* component[remSleep].valueQuantity.system = "http://unitsofmeasure.org"
* component[remSleep].valueQuantity.code = #min
* component[lightSleep].code = http://loinc.org#93836-5 "Light activity duration"
* component[lightSleep].valueQuantity only Quantity
* component[lightSleep].valueQuantity.system = "http://unitsofmeasure.org"
* component[lightSleep].valueQuantity.code = #min
* component[respiratoryRate].code = http://loinc.org#9279-1 "Respiratory rate"
* component[respiratoryRate].valueQuantity only Quantity
* component[respiratoryRate].valueQuantity.system = "http://unitsofmeasure.org"
* component[respiratoryRate].valueQuantity.code = #/min
* component[heartRateVariability].code = http://loinc.org#80404-7 "R-R interval.standard deviation (Heart rate variability)"
* component[heartRateVariability].valueQuantity only Quantity
* component[heartRateVariability].valueQuantity.system = "http://unitsofmeasure.org"
* component[heartRateVariability].valueQuantity.code = #ms
* component[interruptions].code = http://loinc.org#93837-3 "Number of awakenings during activity"
* component[interruptions].valueQuantity only Quantity
* component[interruptions].valueQuantity.system = "http://unitsofmeasure.org"
* component[interruptions].valueQuantity.code = #{count}
* extension contains SleepQuality named quality 0..
* extension[quality] 0..1




// ===== Conteúdo de: MobilityRiskAssessment.fsh =====

// Originally defined on lines 1 - 48
Profile: MobilityRiskAssessment
Parent: RiskAssessment
Id: mobility-risk-assessment
Title: "Mobility Risk Assessment Profile"
Description: "Profile for assessing mobility-related risks"
* status MS
* subject 1..1
* subject MS
* occurrence[x] MS
* prediction MS
* prediction.outcome MS
* prediction.probability[x] MS
* prediction.qualitativeRisk MS
* method MS
* method.coding ^slicing.discriminator.type = #value
* method.coding ^slicing.discriminator.path = "$this"
* method.coding ^slicing.rules = #open
* method.coding contains mobilityAssessment 0..
* method.coding[mobilityAssessment] 1..1
* method.coding[mobilityAssessment] MS
* method.coding[mobilityAssessment] = https://2rdoc.pt/ig/ios-lifestyle-medicine/CodeSystem/mobility-assessment-method#standardized "Standardized Mobility Assessment"
* prediction ^slicing.discriminator.type = #value
* prediction ^slicing.discriminator.path = "outcome"
* prediction ^slicing.rules = #open
* prediction contains
    fallRisk 0.. and
    mobilityDecline 0.. and
    assistanceNeeded 0..
* prediction[fallRisk] 0..1
* prediction[fallRisk] MS
* prediction[mobilityDecline] 0..1
* prediction[mobilityDecline] MS
* prediction[assistanceNeeded] 0..1
* prediction[assistanceNeeded] MS
* prediction[fallRisk].outcome from https://2rdoc.pt/ig/ios-lifestyle-medicine/ValueSet/fall-risk-outcomes (required)
* prediction[fallRisk].probabilityDecimal 0..1
* prediction[fallRisk].probabilityDecimal MS
* prediction[fallRisk].qualitativeRisk from https://2rdoc.pt/ig/ios-lifestyle-medicine/ValueSet/risk-level (required)
* prediction[mobilityDecline].outcome from https://2rdoc.pt/ig/ios-lifestyle-medicine/ValueSet/mobility-decline-outcomes (required)
* prediction[mobilityDecline].probabilityDecimal 0..1
* prediction[mobilityDecline].probabilityDecimal MS
* prediction[mobilityDecline].qualitativeRisk from https://2rdoc.pt/ig/ios-lifestyle-medicine/ValueSet/risk-level (required)
* prediction[assistanceNeeded].outcome from https://2rdoc.pt/ig/ios-lifestyle-medicine/ValueSet/assistance-level-outcomes (required)
* prediction[assistanceNeeded].probabilityDecimal 0..1
* prediction[assistanceNeeded].probabilityDecimal MS
* prediction[assistanceNeeded].qualitativeRisk from https://2rdoc.pt/ig/ios-lifestyle-medicine/ValueSet/risk-level (required)
* basis only Reference(MobilityProfile or Observation or QuestionnaireResponse)
* basis MS
* note MS




// ===== Conteúdo de: EnvironmentalProfiles.fsh =====

Alias: $SCT = http://snomed.info/sct
Alias: $LOINC = http://loinc.org
Alias: $UCUM = http://unitsofmeasure.org

// Originally defined on lines 5 - 23
Profile: EnvironmentalObservation
Parent: Observation
Id: environmental-observation
Title: "Environmental Observation Profile"
Description: "Base profile for environmental measurements from iOS Health App"
* ^version = "0.1.0"
* ^status = #draft
* ^publisher = "HL7 International"
* ^contact.name = "Environmental Health Working Group"
* status MS
* category 1..1
* category MS
* category = http://terminology.hl7.org/CodeSystem/observation-category#environment
* subject 1..1
* subject MS
* effectiveDateTime 1..1
* effectiveDateTime MS
* device 0..1
* device MS
* method 0..1
* method MS
* note 0..*
* note MS

// Originally defined on lines 25 - 62
Profile: NoiseExposureObservation
Parent: EnvironmentalObservation
Id: noise-exposure-observation
Title: "Noise Exposure Observation Profile"
Description: "Profile for noise exposure measurements from iOS Health App"
* code = http://loinc.org#28573-7 "Noise exposure time"
* component ^slicing.discriminator.type = #value
* component ^slicing.discriminator.path = "code"
* component ^slicing.rules = #open
* component ^short = "Noise exposure components"
* component ^definition = "Components of noise exposure measurement"
* component contains
    level 0.. and
    duration 0.. and
    peakLevel 0.. and
    backgroundNoise 0..
* component[level] 1..1
* component[level] MS
* component[duration] 1..1
* component[duration] MS
* component[peakLevel] 0..1
* component[peakLevel] MS
* component[backgroundNoise] 0..1
* component[backgroundNoise] MS
* component[level].code = http://loinc.org#89020-2 "Environmental noise average"
* component[level].valueQuantity.system = "http://unitsofmeasure.org"
* component[level].valueQuantity.code = #dB
* component[level].valueQuantity ^short = "Noise level in decibels"
* component[duration].code = http://loinc.org#89021-0 "Environmental noise duration"
* component[duration].valueQuantity.system = "http://unitsofmeasure.org"
* component[duration].valueQuantity.code = #min
* component[duration].valueQuantity ^short = "Duration of exposure"
* component[peakLevel].code = http://loinc.org#89024-4 "Peak sound level"
* component[peakLevel].valueQuantity.system = "http://unitsofmeasure.org"
* component[peakLevel].valueQuantity.code = #dB
* component[peakLevel].valueQuantity ^short = "Peak noise level"
* component[backgroundNoise].code = http://loinc.org#89025-1 "Background noise level"
* component[backgroundNoise].valueQuantity.system = "http://unitsofmeasure.org"
* component[backgroundNoise].valueQuantity.code = #dB
* component[backgroundNoise].valueQuantity ^short = "Background noise level"

// Originally defined on lines 64 - 100
Profile: UVExposureObservation
Parent: EnvironmentalObservation
Id: uv-exposure-observation
Title: "UV Exposure Observation Profile"
Description: "Profile for UV exposure measurements from iOS Health App"
* code = http://loinc.org#28574-5 "UV exposure"
* component ^slicing.discriminator.type = #value
* component ^slicing.discriminator.path = "code"
* component ^slicing.rules = #open
* component ^short = "UV exposure components"
* component ^definition = "Components of UV exposure measurement"
* component contains
    index 0.. and
    duration 0.. and
    timeOfDay 0.. and
    intensity 0..
* component[index] 1..1
* component[index] MS
* component[duration] 1..1
* component[duration] MS
* component[timeOfDay] 0..1
* component[timeOfDay] MS
* component[intensity] 0..1
* component[intensity] MS
* component[index].code = http://loinc.org#89022-8 "UV index"
* component[index].valueQuantity.system = "http://unitsofmeasure.org"
* component[index].valueQuantity.code = #{index}
* component[index].valueQuantity ^short = "UV index value"
* component[duration].code = http://loinc.org#89023-6 "UV exposure duration"
* component[duration].valueQuantity.system = "http://unitsofmeasure.org"
* component[duration].valueQuantity.code = #min
* component[duration].valueQuantity ^short = "Duration of UV exposure"
* component[timeOfDay].code = http://loinc.org#89026-9 "Time of exposure"
* component[timeOfDay].valueDateTime 1..1
* component[timeOfDay].valueDateTime ^short = "Time of UV exposure"
* component[intensity].code = http://loinc.org#89027-7 "UV intensity"
* component[intensity].valueQuantity.system = "http://unitsofmeasure.org"
* component[intensity].valueQuantity.code = #W/m2
* component[intensity].valueQuantity ^short = "UV radiation intensity"

// Originally defined on lines 102 - 108
Extension: EnvironmentalContext
Parent: Extension
Id: environmental-context
Title: "Environmental Context Extension"
Description: "Additional context about environmental measurements"
* value[x] only CodeableConcept
* valueCodeableConcept from https://2rdoc.pt/ig/ios-lifestyle-medicine/ValueSet/environmental-context (required)
* extension 0..0




// ===== Conteúdo de: SocialInteractionProfile.fsh =====

// Originally defined on lines 1 - 53
Profile: SocialInteractionProfile
Parent: Observation
Id: social-interaction
Title: "Social Interaction Profile"
Description: "Profile for recording social interaction data from iOS Health App"
* ^version = "0.1.0"
* ^status = #active
* ^date = "2024-01-03"
* ^publisher = "FMUP HEADS2"
* status MS
* category 1..1
* category MS
* category = http://terminology.hl7.org/CodeSystem/observation-category#social-history
* code 1..1
* code MS
* code = http://loinc.org#96766-1 "Social interaction pattern"
* subject 1..1
* subject MS
* effectiveDateTime 1..1
* effectiveDateTime MS
* value[x] only CodeableConcept
* valueCodeableConcept from SocialInteractionTypeVS (required)
* component ^slicing.discriminator.type = #value
* component ^slicing.discriminator.path = "code"
* component ^slicing.rules = #open
* component contains
    duration 0.. and
    quality 0.. and
    medium 0.. and
    participants 0..
* component[duration] 0..1
* component[duration] MS
* component[quality] 0..1
* component[quality] MS
* component[medium] 0..1
* component[medium] MS
* component[participants] 0..1
* component[participants] MS
* component[duration].code = http://loinc.org#89597-9 "Social interaction duration"
* component[duration].valueQuantity only Quantity
* component[duration].valueQuantity.system = "http://unitsofmeasure.org"
* component[duration].valueQuantity.code = #min
* component[quality].code = http://loinc.org#89598-7 "Social interaction quality"
* component[quality].valueCodeableConcept from SocialInteractionQualityVS (required)
* component[medium].code = http://loinc.org#89599-5 "Social interaction medium"
* component[medium].valueCodeableConcept from SocialInteractionMediumVS (required)
* component[participants].code = http://loinc.org#89600-1 "Social interaction participants"
* component[participants].valueInteger only integer
* extension contains
    SocialContext named context 0.. and
    SocialSupport named support 0.. and
    SocialActivity named activity 0..
* extension[context] 0..1
* extension[context] MS
* extension[support] 0..1
* extension[support] MS
* extension[activity] 0..*
* extension[activity] MS




// ===== Conteúdo de: StressLevelProfile.fsh =====

// Originally defined on lines 1 - 55
Profile: StressLevelProfile
Parent: Observation
Id: stress-level
Title: "Stress Level Profile"
Description: "Profile for recording stress level measurements from iOS Health App"
* ^version = "0.1.0"
* ^status = #active
* ^date = "2024-01-03"
* ^publisher = "FMUP HEADS2"
* status MS
* category 1..1
* category MS
* category = http://terminology.hl7.org/CodeSystem/observation-category#vital-signs
* code 1..1
* code MS
* code = http://loinc.org#89592-0 "Stress level score"
* subject 1..1
* subject MS
* effectiveDateTime 1..1
* effectiveDateTime MS
* value[x] only Quantity
* valueQuantity MS
* component ^slicing.discriminator.type = #value
* component ^slicing.discriminator.path = "code"
* component ^slicing.rules = #open
* component contains
    physiologicalStress 0.. and
    psychologicalStress 0.. and
    chronicity 0.. and
    impact 0..
* component[physiologicalStress] 0..1
* component[physiologicalStress] MS
* component[psychologicalStress] 0..1
* component[psychologicalStress] MS
* component[chronicity] 0..1
* component[chronicity] MS
* component[impact] 0..1
* component[impact] MS
* component[physiologicalStress].code = http://loinc.org#89593-8 "Physiological stress"
* component[physiologicalStress].valueQuantity only Quantity
* component[physiologicalStress].valueQuantity.system = "http://unitsofmeasure.org"
* component[physiologicalStress].valueQuantity.code = #{score}
* component[psychologicalStress].code = http://loinc.org#89594-6 "Psychological stress"
* component[psychologicalStress].valueQuantity only Quantity
* component[psychologicalStress].valueQuantity.system = "http://unitsofmeasure.org"
* component[psychologicalStress].valueQuantity.code = #{score}
* component[chronicity].code = http://loinc.org#89595-3 "Stress chronicity"
* component[chronicity].valueCodeableConcept from StressChronicityVS (required)
* component[impact].code = http://loinc.org#89596-1 "Stress impact"
* component[impact].valueCodeableConcept from StressImpactVS (required)
* extension contains
    MeasurementContext named context 0.. and
    StressTriggers named triggers 0.. and
    StressCoping named coping 0..
* extension[context] 0..1
* extension[context] MS
* extension[triggers] 0..*
* extension[triggers] MS
* extension[coping] 0..*
* extension[coping] MS




// ===== Conteúdo de: NutritionProfiles.fsh =====

Alias: $SCT = http://snomed.info/sct
Alias: $LOINC = http://loinc.org
Alias: $UCUM = http://unitsofmeasure.org

// Originally defined on lines 5 - 21
Profile: NutritionIntakeObservation
Parent: Observation
Id: nutrition-intake-observation
Title: "Nutrition Intake Observation Profile"
Description: "Profile for nutrition intake data from iOS Health App and user input"
* ^version = "0.1.0"
* ^status = #draft
* ^publisher = "Ricardo Lourenço dos Santos"
* status MS
* category 1..1
* category MS
* category = http://terminology.hl7.org/CodeSystem/observation-category#nutrition
* subject 1..1
* subject MS
* effectiveDateTime 1..1
* effectiveDateTime MS
* code 1..1
* code MS
* method 0..1
* method MS

// Originally defined on lines 23 - 37
Profile: WaterIntakeObservation
Parent: NutritionIntakeObservation
Id: water-intake-observation
Title: "Water Intake Observation Profile"
Description: "Profile for water intake measurements"
* ^version = "0.1.0"
* ^status = #draft
* ^publisher = "Ricardo Lourenço dos Santos"
* code = http://loinc.org#77111-4 "Water intake"
* valueQuantity only Quantity
* valueQuantity.system = "http://unitsofmeasure.org"
* valueQuantity.code = #mL
* valueQuantity.unit = "milliliter"

// Originally defined on lines 39 - 53
Profile: CalorieIntakeObservation
Parent: NutritionIntakeObservation
Id: calorie-intake-observation
Title: "Calorie Intake Observation Profile"
Description: "Profile for caloric intake measurements"
* ^version = "0.1.0"
* ^status = #draft
* ^publisher = "Ricardo Lourenço dos Santos"
* code = http://loinc.org#9051-4 "Caloric intake total"
* valueQuantity only Quantity
* valueQuantity.system = "http://unitsofmeasure.org"
* valueQuantity.code = #kcal
* valueQuantity.unit = "kilocalorie"

// Originally defined on lines 55 - 88
Profile: MacronutrientsObservation
Parent: NutritionIntakeObservation
Id: macronutrients-observation
Title: "Macronutrients Observation Profile"
Description: "Profile for macronutrient intake measurements"
* ^version = "0.1.0"
* ^status = #draft
* ^publisher = "Ricardo Lourenço dos Santos"
* code = http://loinc.org#LP199119-9 "Macronutrients panel"
* component ^slicing.discriminator.type = #value
* component ^slicing.discriminator.path = "code"
* component ^slicing.rules = #open
* component contains
    carbohydrates 0.. and
    proteins 0.. and
    fats 0..
* component[carbohydrates] 0..1
* component[carbohydrates] MS
* component[proteins] 0..1
* component[proteins] MS
* component[fats] 0..1
* component[fats] MS
* component[carbohydrates].code = http://loinc.org#LP35925-4 "Carbohydrates"
* component[carbohydrates].valueQuantity.system = "http://unitsofmeasure.org"
* component[carbohydrates].valueQuantity.code = #g
* component[carbohydrates].valueQuantity.unit = "gram"
* component[proteins].code = http://loinc.org#LP35921-3 "Proteins"
* component[proteins].valueQuantity.system = "http://unitsofmeasure.org"
* component[proteins].valueQuantity.code = #g
* component[proteins].valueQuantity.unit = "gram"
* component[fats].code = http://loinc.org#LP35922-1 "Fats"
* component[fats].valueQuantity.system = "http://unitsofmeasure.org"
* component[fats].valueQuantity.code = #g
* component[fats].valueQuantity.unit = "gram"




// ===== Conteúdo de: MultiJurisdictionalConsent.fsh =====

// Originally defined on lines 3 - 49
Profile: MultiJurisdictionalConsent
Parent: Consent
Id: multi-jurisdictional-consent
Title: "Multi-Jurisdictional Healthcare Consent"
Description: "Consent profile supporting GDPR, HIPAA, and LGPD compliance"
* status MS
* scope MS
* category MS
* patient 1..1
* patient MS
* dateTime 1..1
* dateTime MS
* policy 1..*
* policy MS
* policy ^slicing.discriminator.type = #value
* policy ^slicing.discriminator.path = "authority"
* policy ^slicing.rules = #open
* policy contains
    gdpr 0.. and
    hipaa 0.. and
    lgpd 0..
* policy[gdpr] 0..1
* policy[gdpr] MS
* policy[hipaa] 0..1
* policy[hipaa] MS
* policy[lgpd] 0..1
* policy[lgpd] MS
* policy[gdpr].authority = "https://eur-lex.europa.eu/eli/reg/2016/679/oj"
* policy[gdpr].uri 1..1
* policy[gdpr].uri MS
* policy[hipaa].authority = "https://www.hhs.gov/hipaa/index.html"
* policy[hipaa].uri 1..1
* policy[hipaa].uri MS
* policy[lgpd].authority = "http://www.planalto.gov.br/ccivil_03/_ato2015-2018/2018/lei/L13709compilado.htm"
* policy[lgpd].uri 1..1
* policy[lgpd].uri MS
* extension contains
    RegulatoryBasis named regulatoryBasis 0.. and
    JurisdictionApplicability named jurisdiction 0.. and
    DataLocalization named dataLocalization 0..
* extension[regulatoryBasis] 0..*
* extension[regulatoryBasis] MS
* extension[jurisdiction] 0..*
* extension[jurisdiction] MS
* extension[dataLocalization] 0..*
* extension[dataLocalization] MS
* provision MS
* provision.type MS
* provision.period MS
* provision.actor MS
* provision.action MS
* provision.securityLabel MS
* provision.purpose MS
* provision.dataPeriod MS




// ===== Conteúdo de: MindfulnessMessaging.fsh =====

Alias: $MsgEvents = https://2rdoc.pt/ig/ios-lifestyle-medicine/CodeSystem/mindfulness-message-events
Alias: $MsgTypes = http://terminology.hl7.org/CodeSystem/message-type

// Originally defined on lines 4 - 16
Profile: MindfulnessMessageDefinition
Parent: MessageDefinition
Id: mindfulness-message-definition
Title: "Mindfulness Message Definition"
Description: "Definition for mindfulness session messages"
* url 1..1
* url MS
* date 1..1
* date MS
* status 1..1
* status MS
* event[x] 1..1
* event[x] MS
* category 0..1
* category MS
* focus 1..*
* focus MS
* focus.min 1..1

// Originally defined on lines 18 - 30
Instance: StartSessionMessage
InstanceOf: MindfulnessMessageDefinition
Title: "Start Session Message"
Description: "Message definition for starting a mindfulness session"
Usage: #example
* url = "https://2rdoc.pt/ig/ios-lifestyle-medicine/MessageDefinition/start-session"
* date = "2024-03-19"
* status = #active
* eventCoding = https://2rdoc.pt/ig/ios-lifestyle-medicine/CodeSystem/mindfulness-message-events#session-start "Session Start"
* category = #notification
* focus.code = #Observation
* focus.min = 1
* focus.profile = "https://2rdoc.pt/ig/ios-lifestyle-medicine/StructureDefinition/mindfulness-session"

// Originally defined on lines 32 - 44
Instance: EndSessionMessage
InstanceOf: MindfulnessMessageDefinition
Title: "End Session Message"
Description: "Message definition for ending a mindfulness session"
Usage: #example
* url = "https://2rdoc.pt/ig/ios-lifestyle-medicine/MessageDefinition/end-session"
* date = "2024-03-19"
* status = #active
* eventCoding = https://2rdoc.pt/ig/ios-lifestyle-medicine/CodeSystem/mindfulness-message-events#session-end "Session End"
* category = #notification
* focus.code = #Observation
* focus.min = 1
* focus.profile = "https://2rdoc.pt/ig/ios-lifestyle-medicine/StructureDefinition/mindfulness-session"




// ===== Conteúdo de: PractitionerNamingSystem.fsh =====

// Originally defined on lines 3 - 13
CodeSystem: PractitionerIdentifierCS
Id: practitioner-identifier-cs
Title: "Practitioner Identifier Code System"
Description: "Sistema de códigos para identificação de practitioners"
* ^status = #active
* ^experimental = false
* ^caseSensitive = true
* #npi "National Provider Identifier" "US National Provider Identifier"
* #crm "Conselho Regional de Medicina" "Brazilian Medical Council Registration"
* #ssin "Social Security Identification Number" "Belgian SSIN"
* #rpps "Répertoire Partagé des Professionnels de Santé" "French Healthcare Professional Registry"

// Originally defined on lines 15 - 21
ValueSet: PractitionerIdentifierVS
Id: practitioner-identifier-vs
Title: "Practitioner Identifier Value Set"
Description: "Value set para identificadores de practitioners"
* ^status = #active
* ^experimental = false
* include codes from system PractitionerIdentifierCS




// ===== Conteúdo de: MindfulnessReports.fsh =====

// Originally defined on lines 1 - 39
Instance: MindfulnessProgressReport
InstanceOf: Measure
Title: "Mindfulness Practice Progress Report"
Description: "Example instance of MindfulnessProgressReport"
Usage: #definition
* status = #active
* experimental = false
* date = "2024-03-19"
* publisher = "Example Organization"
* description = "Measures progress in mindfulness practice over time"
* scoring = #continuous-variable
* type = #process
* riskAdjustment = "none"
* rateAggregation = "Average values over time period"
* group[0]
* group[0].code = #practice-frequency
* group[0].description = "Frequency of mindfulness practice"
* group[0].population[0]
* group[0].population[0].code = #denominator
* group[0].population[0].criteria.language = #text/fhirpath
* group[0].population[0].criteria.expression = "Observation.where(code.coding.code='711415009')"
* group[0].stratifier[0]
* group[0].stratifier[0].code = #weekly
* group[0].stratifier[0].criteria.language = #text/fhirpath
* group[0].stratifier[0].criteria.expression = "Observation.effective.as(DateTime).truncate(@T).truncate(@W)"
* group[1]
* group[1].code = #stress-reduction
* group[1].description = "Stress level changes over time"
* group[1].population[0]
* group[1].population[0].code = #denominator
* group[1].population[0].criteria.language = #text/fhirpath
* group[1].population[0].criteria.expression = "Observation.where(component.code.coding.code='725854004')"
* group[1].stratifier[0]
* group[1].stratifier[0].code = #trend
* group[1].stratifier[0].criteria.language = #text/fhirpath
* group[1].stratifier[0].criteria.expression = "component.where(code.coding.code='725854004').value.value"




// ===== Conteúdo de: MindfulnessCapabilities.fsh =====

Instance: MindfulnessCapabilityStatement
InstanceOf: CapabilityStatement
Usage: #definition
Title: "Mindfulness Module Capabilities"
Description: "Capabilities supported by the mindfulness module implementation"

* status = #draft
* date = "2024-03-19"
* kind = #requirements
* fhirVersion = #4.0.1
* format[0] = #json
* format[1] = #xml

* rest[0]
  * mode = #server
  * documentation = "RESTful server capabilities for mindfulness data"
  
  * resource[0]
    * type = #Observation
    * documentation = "Supports mindfulness session observations"
    * profile = "https://github.com/RicardoLSantos/shorthand/StructureDefinition/mindfulness-observation"
    * interaction[0]
      * code = #read
    * interaction[1]
      * code = #create
    * interaction[2]
      * code = #update
    * interaction[3]
      * code = #search-type
    * searchParam[0]
      * name = "patient"
      * type = #reference
      * documentation = "Search by patient reference"
    * searchParam[1]
      * name = "date"
      * type = #date
      * documentation = "Search by session date"
    * searchParam[2]
      * name = "code"
      * type = #token
      * documentation = "Search by observation type"
      
  * resource[1]
    * type = #Questionnaire
    * documentation = "Supports mindfulness questionnaires"
    * profile = "https://github.com/RicardoLSantos/shorthand/StructureDefinition/mindfulness-questionnaire"
    * interaction[0]
      * code = #read
    * interaction[1]
      * code = #search-type
    * searchParam[0]
      * name = "title"
      * type = #string
      * documentation = "Search by questionnaire title"
      
  * resource[2]
    * type = #QuestionnaireResponse
    * documentation = "Supports mindfulness questionnaire responses"
    * profile = "https://github.com/RicardoLSantos/shorthand/StructureDefinition/mindfulness-questionnaire-response"
    * interaction[0]
      * code = #create
    * interaction[1]
      * code = #read
    * interaction[2]
      * code = #search-type
    * searchParam[0]
      * name = "patient"
      * type = #reference
      * documentation = "Search by patient reference"
    * searchParam[1]
      * name = "authored"
      * type = #date
      * documentation = "Search by response date"



// ===== Conteúdo de: MindfulnessQuestionnaires.fsh =====

Instance: DailyMindfulnessQuestionnaire
InstanceOf: Questionnaire
Usage: #definition
Title: "Daily Mindfulness Questionnaire"
Description: "Questionnaire for capturing daily mindfulness practice and associated effects"

* url = "https://github.com/RicardoLSantos/shorthand/Questionnaire/daily-mindfulness"
* status = #active
* title = "Daily Mindfulness Practice"
* subjectType = #Patient
* version = "1.0.0"
* name = "DailyMindfulnessQuestionnaire"
* date = "2024-03-19"

* item[0]
  * linkId = "mindful_session"
  * text = "Mindfulness Session"
  * type = #group
  * repeats = false

  * item[0]
    * linkId = "session_duration"
    * text = "Session duration (minutes)"
    * type = #integer
    * required = true
    * extension[0].url = "http://hl7.org/fhir/StructureDefinition/minValue"
    * extension[0].valueInteger = 1

  * item[1]
    * linkId = "practice_type"
    * text = "Practice type"
    * type = #choice
    * required = true
    * answerOption[0].valueString = "Meditation"
    * answerOption[1].valueString = "Breathing exercise"
    * answerOption[2].valueString = "Body scan"
    * answerOption[3].valueString = "Mindful walking"

* item[1]
  * linkId = "mood_assessment"
  * text = "Mood Assessment"
  * type = #group

  * item[0]
    * linkId = "current_mood"
    * text = "How is your mood now?"
    * type = #choice
    * required = true
    * answerValueSet = "https://github.com/RicardoLSantos/shorthand/fhir/ValueSet/mood-vs"

  * item[1]
    * linkId = "mood_intensity"
    * text = "Mood intensity (1-5)"
    * type = #integer
    * required = true

* item[2]
  * linkId = "stress_assessment"
  * text = "Stress Assessment"
  * type = #group

  * item[0]
    * linkId = "stress_level"
    * text = "Stress level (0-10)"
    * type = #integer
    * required = true

  * item[1]
    * linkId = "stress_symptoms"
    * text = "Stress symptoms"
    * type = #choice
    * repeats = true
    * answerOption[0].valueString = "Muscle tension"
    * answerOption[1].valueString = "Anxiety"
    * answerOption[2].valueString = "Headache"
    * answerOption[3].valueString = "Fatigue"

* item[3]
  * linkId = "relaxation"
  * text = "Relaxation"
  * type = #group

  * item[0]
    * linkId = "relaxation_duration"
    * text = "Relaxation time (minutes)"
    * type = #integer
    * required = true

  * item[1]
    * linkId = "relaxation_technique"
    * text = "Technique used"
    * type = #choice
    * required = true
    * answerOption[0].valueString = "Deep breathing"
    * answerOption[1].valueString = "Progressive relaxation"
    * answerOption[2].valueString = "Visualization"
    * answerOption[3].valueString = "Mindful awareness"



// ===== Conteúdo de: NutritionQuestionnaires.fsh =====

Instance: DailyNutritionQuestionnaire
InstanceOf: Questionnaire
Usage: #definition
Title: "Daily Nutrition Intake Questionnaire"
Description: "Questionnaire for daily nutrition intake tracking"

* url = "https://github.com/RicardoLSantos/shorthand/Questionnaire/daily-nutrition"
* version = "0.1.0"
* name = "DailyNutritionQuestionnaire"
* title = "Daily Nutrition Intake"
* status = #active
* experimental = false
* date = "2024-12-14"
* publisher = "Ricardo Lourenço dos Santos"

* item[0]
  * linkId = "water_intake"
  * text = "How much water did you drink today?"
  * type = #quantity
  * required = true
  * repeats = false
  * initial.valueQuantity = 0 'mL'

* item[1]
  * linkId = "meal_record"
  * text = "Meal Records"
  * type = #group
  * repeats = true

  * item[0]
    * linkId = "meal_time"
    * text = "Meal Time"
    * type = #dateTime
    * required = true

  * item[1]
    * linkId = "meal_type"
    * text = "Meal Type"
    * type = #choice
    * required = true
    * answerOption[0].valueString = "Breakfast"
    * answerOption[1].valueString = "Lunch"
    * answerOption[2].valueString = "Dinner"
    * answerOption[3].valueString = "Snack"

  * item[2]
    * linkId = "calories"
    * text = "Estimated Calories"
    * type = #integer
    * required = true

  * item[3]
    * linkId = "macronutrients"
    * text = "Macronutrients"
    * type = #group

    * item[0]
      * linkId = "carbs"
      * text = "Carbohydrates (g)"
      * type = #decimal
      * required = true

    * item[1]
      * linkId = "protein"
      * text = "Proteins (g)"
      * type = #decimal
      * required = true

    * item[2]
      * linkId = "fat"
      * text = "Fats (g)"
      * type = #decimal
      * required = true

* item[2]
  * linkId = "caffeine"
  * text = "Caffeine Intake"
  * type = #group

  * item[0]
    * linkId = "caffeine_amount"
    * text = "Caffeine amount (mg)"
    * type = #integer
    * required = false

  * item[1]
    * linkId = "caffeine_source"
    * text = "Caffeine source"
    * type = #choice
    * repeats = true
    * answerOption[0].valueString = "Coffee"
    * answerOption[1].valueString = "Tea"
    * answerOption[2].valueString = "Soft Drink"
    * answerOption[3].valueString = "Energy Drink"



// ===== Conteúdo de: ReproductiveQuestionnaire.fsh =====

Instance: ReproductiveHealthQuestionnaire
InstanceOf: Questionnaire
Usage: #definition
Title: "Reproductive Health Tracking Questionnaire"
Description: "Daily questionnaire for reproductive health tracking"
 
* status = #active
* url = "https://github.com/RicardoLSantos/shorthand/Questionnaire/reproductive-health"
* name = "ReproductiveHealthQuestionnaire"
* title = "Reproductive Health Monitoring"
* date = "2024-03-19"
 
* item[0]
  * linkId = "menstrual_cycle"
  * text = "Menstrual Cycle"
  * type = #group
 
  * item[0]
    * linkId = "cycle_start"
    * text = "Cycle started today?"
    * type = #boolean
 
  * item[1]
    * linkId = "flow_intensity"
    * text = "Flow intensity"
    * type = #choice
    * enableWhen
      * question = "cycle_start"
      * operator = #=
      * answerBoolean = true
    * answerOption[0].valueString = "Light"
    * answerOption[1].valueString = "Moderate"
    * answerOption[2].valueString = "Heavy"
 
* item[1]
  * linkId = "symptoms"
  * text = "Symptoms"
  * type = #group
  * repeats = true
 
  * item[0]
    * linkId = "symptom_type"
    * text = "Symptom type"
    * type = #choice
    * answerValueSet = "https://github.com/RicardoLSantos/shorthand/ValueSet/reproductive-symptoms"
 
  * item[1]
    * linkId = "symptom_severity"
    * text = "Intensity (0-10)"
    * type = #integer
    * extension[0]
      * url = "http://hl7.org/fhir/StructureDefinition/minValue"
      * valueInteger = 0
    * extension[1]
      * url = "http://hl7.org/fhir/StructureDefinition/maxValue"
      * valueInteger = 10
 
* item[2]
  * linkId = "mood_changes"
  * text = "Mood Changes"
  * type = #group

  * item[0]
    * linkId = "mood_type"
    * text = "Current mood"
    * type = #choice
    * answerValueSet = "https://github.com/RicardoLSantos/shorthand/ValueSet/mood-types"

  * item[1]
    * linkId = "mood_severity"
    * text = "Intensity (0-10)"
    * type = #integer
    * extension[0]
      * url = "http://hl7.org/fhir/StructureDefinition/minValue"
      * valueInteger = 0
    * extension[1]
      * url = "http://hl7.org/fhir/StructureDefinition/maxValue"
      * valueInteger = 10



// ===== Conteúdo de: aliases.fsh =====

Alias: SCT = http://snomed.info/sct
Alias: LOINC = http://loinc.org
Alias: UCUM = http://unitsofmeasure.org



// ===== Conteúdo de: MindfulnessTerminology.fsh =====

CodeSystem: MindfulnessOutcomeCS
Id: mindfulness-outcome-cs
Title: "Mindfulness Outcomes"
Description: "Outcomes and effects of mindfulness practice"

* ^experimental = false
* ^caseSensitive = true
* #increasedAwareness "Increased Awareness" "Greater awareness of thoughts and sensations"
* #improvedFocus "Improved Focus" "Enhanced ability to concentrate"
* #stressReduction "Stress Reduction" "Decreased levels of stress and tension"
* #emotionalBalance "Emotional Balance" "Better emotional regulation"
* #improvedSleep "Improved Sleep" "Enhanced sleep quality"

ValueSet: MindfulnessOutcomeVS
Id: mindfulness-outcome-vs
Title: "Mindfulness Outcomes Value Set"
Description: "Value set for mindfulness practice outcomes"

* ^experimental = false
* include codes from system MindfulnessOutcomeCS
* include $SCT#365949003 "Finding of level of stress"
* include $SCT#373931001 "Mood finding"

CodeSystem: MindfulnessQualifierCS
Id: mindfulness-qualifier-cs
Title: "Mindfulness Practice Qualifiers"
Description: "Qualifiers for mindfulness practice characteristics"

* ^experimental = false
* ^caseSensitive = true
* #guided "Guided Practice" "Practice with guidance or instruction"
* #selfDirected "Self-Directed" "Independent practice"
* #group "Group Practice" "Practice in group setting"
* #individual "Individual Practice" "Solo practice session"

ValueSet: MindfulnessQualifierVS
Id: mindfulness-qualifier-vs
Title: "Mindfulness Practice Qualifiers Value Set"
Description: "Value set for mindfulness practice qualifiers"

* ^experimental = false
* include codes from system MindfulnessQualifierCS
* include $SCT#410534003 "Guided meditation"
* include $SCT#225386006 "Exercise therapy"

* ^copyright = "This value set includes content from SNOMED CT, which is copyright © 2002+ International Health Terminology Standards Development Organisation (IHTSDO)"



// ===== Conteúdo de: MindfulnessConfig.fsh =====

Extension: MindfulnessSessionDuration
Id: mindfulness-session-duration
Title: "Mindfulness Session Duration"
Description: "Default duration for mindfulness sessions in minutes"
* value[x] only integer

Extension: MindfulnessReminderTime
Id: mindfulness-reminder-time
Title: "Mindfulness Reminder Time"
Description: "Default time for daily reminders"
* value[x] only time

Extension: MindfulnessPreferredGuide
Id: mindfulness-preferred-guide
Title: "Mindfulness Preferred Guide"
Description: "Preferred guide for mindfulness sessions"
* value[x] only string

Extension: MindfulnessNotificationEnabled
Id: mindfulness-notification-enabled
Title: "Mindfulness Notification Enabled"
Description: "Whether notifications are enabled for mindfulness sessions"
* value[x] only boolean

Profile: MindfulnessConfiguration
Parent: Basic
Id: mindfulness-configuration
Title: "Mindfulness Configuration"
Description: "Configuration settings for mindfulness sessions"

* code 1..1 MS
* code = https://github.com/RicardoLSantos/shorthand/CodeSystem/mindfulness-config-type#settings "Mindfulness Settings"

* extension contains
    MindfulnessSessionDuration named sessionDuration 1..1 MS and
    MindfulnessReminderTime named reminderTime 1..1 MS and
    MindfulnessPreferredGuide named preferredGuide 0..1 MS and
    MindfulnessNotificationEnabled named notificationEnabled 1..1 MS

Instance: DefaultMindfulnessConfig
InstanceOf: MindfulnessConfiguration
Title: "Default Mindfulness Configuration"
Description: "Default configuration settings for mindfulness sessions"

* code = https://github.com/RicardoLSantos/shorthand/CodeSystem/mindfulness-config-type#settings "Mindfulness Settings"
* extension[sessionDuration].valueInteger = 15
* extension[reminderTime].valueTime = "08:00:00"
* extension[preferredGuide].valueString = "Jane Smith"
* extension[notificationEnabled].valueBoolean = true



// ===== Conteúdo de: MindfulnessAuditConfig.fsh =====

Extension: MindfulnessAuditLevel
Id: mindfulness-audit-level
Title: "Mindfulness Audit Level"
Description: "Level of detail for audit records"
* value[x] only code
* valueCode from https://github.com/RicardoLSantos/shorthand/fhir/ValueSet/audit-levels (required)

Extension: MindfulnessAuditRetention
Id: mindfulness-audit-retention
Title: "Mindfulness Audit Retention"
Description: "Period to retain audit records"
* value[x] only Duration

Extension: MindfulnessAuditFormat
Id: mindfulness-audit-format
Title: "Mindfulness Audit Format"
Description: "Format for audit records"
* value[x] only code
* valueCode from https://github.com/RicardoLSantos/shorthand/fhir/ValueSet/audit-formats (required)

Profile: MindfulnessAuditConfig
Parent: Basic
Id: mindfulness-audit-config
Title: "Mindfulness Audit Configuration"
Description: "Configuration for mindfulness session auditing"

* code 1..1 MS
* code = https://github.com/RicardoLSantos/shorthand/CodeSystem/mindfulness-config-type#audit "Audit Configuration"

* extension contains
    MindfulnessAuditLevel named auditLevel 1..1 MS and
    MindfulnessAuditRetention named auditRetention 1..1 MS and
    MindfulnessAuditFormat named auditFormat 1..1 MS

Instance: DefaultAuditConfig
InstanceOf: MindfulnessAuditConfig
Title: "Default Audit Configuration"
Description: "Default configuration for mindfulness session auditing"

* code = https://github.com/RicardoLSantos/shorthand/CodeSystem/mindfulness-config-type#audit "Audit Configuration"
* extension[auditLevel].valueCode = #detailed
* extension[auditRetention].valueDuration = 90 'days'
* extension[auditFormat].valueCode = #fhir



// ===== Conteúdo de: MindfulnessSecurity.fsh =====

Instance: MindfulnessSecurityDefinition
InstanceOf: Consent
Usage: #definition
Title: "Mindfulness Data Security Policy"

* status = #active
* scope = http://terminology.hl7.org/CodeSystem/consentscope#patient-privacy
* category = http://loinc.org#59284-0 "Consent Document"

* policy[0]
  * authority = "https://github.com/RicardoLSantos/shorthand/privacy-policy"
  * uri = "https://github.com/RicardoLSantos/shorthand/mindfulness-privacy"

* provision
  * type = #permit
  * period
    * start = "2024-03-19"
  * actor[0]
    * role = http://terminology.hl7.org/CodeSystem/v3-ParticipationType#PRCP
    * reference
      * identifier.system = "https://github.com/RicardoLSantos/shorthand/practitioners"
      * identifier.value = "mindfulness-practitioners"

RuleSet: SecurityRequirements
* meta.security from http://terminology.hl7.org/ValueSet/v3-SecurityPolicy (required)
* meta.tag from http://terminology.hl7.org/ValueSet/v3-Confidentiality (required)

* extension contains
    http://hl7.org/fhir/StructureDefinition/resource-security-category named securityCategory 0..1 MS and
    http://hl7.org/fhir/StructureDefinition/patient-confidentiality named confidentiality 0..1 MS

Instance: MindfulnessAccessPolicy
InstanceOf: Consent
Usage: #definition
Title: "Mindfulness Data Access Policy"

* status = #active
* scope = http://terminology.hl7.org/CodeSystem/consentscope#patient-privacy
* category = http://loinc.org#59284-0 "Consent Document"

* policy[0]
  * authority = "https://github.com/RicardoLSantos/shorthand/access-policy"
  * uri = "https://github.com/RicardoLSantos/shorthand/mindfulness-access"

* provision
  * type = #permit
  * period
    * start = "2024-03-19"
  * actor[0]
    * role = http://terminology.hl7.org/CodeSystem/v3-ParticipationType#PRCP
    * reference
      * identifier.system = "https://github.com/RicardoLSantos/shorthand/practitioners"
      * identifier.value = "mindfulness-practitioners"
  * action = http://terminology.hl7.org/CodeSystem/consentaction#access "Access"



// ===== Conteúdo de: MindfulnessResources.fsh =====

CodeSystem: MindfulnessTypeCS
Id: mindfulness-type-cs
Title: "Mindfulness Practice Types"
Description: "Types of mindfulness practices and techniques"
* ^experimental = false
* ^caseSensitive = true
* #meditation "Meditation" "Focused meditation practice"
* #breathing "Breathing Exercise" "Conscious breathing techniques"
* #bodyScan "Body Scan" "Progressive body awareness practice"
* #walking "Mindful Walking" "Walking meditation practice"
* #movement "Mindful Movement" "Conscious movement practice"

CodeSystem: EnvironmentTypeCS
Id: environment-type-cs
Title: "Practice Environment Types"
Description: "Types of environments for mindfulness practice"
* ^experimental = false
* ^caseSensitive = true
* #indoor "Indoor" "Indoor environment"
* #outdoor "Outdoor" "Outdoor environment"
* #quiet "Quiet Space" "Quiet or silent environment"
* #group "Group Setting" "Group practice environment"

ValueSet: MindfulnessTypeVS
Id: mindfulness-type-vs
Title: "Mindfulness Practice Types Value Set"
Description: "Value set of mindfulness practice types"
* ^experimental = false
* include codes from system MindfulnessTypeCS

ValueSet: EnvironmentTypeVS
Id: environment-type-vs
Title: "Practice Environment Types Value Set"
Description: "Value set of practice environment types"
* ^experimental = false
* include codes from system EnvironmentTypeCS

Instance: MindfulnessSettingCS
InstanceOf: CodeSystem
Usage: #definition
* url = "https://github.com/RicardoLSantos/shorthand/CodeSystem/mindfulness-setting"
* version = "1.0.0"
* name = "MindfulnessSettingCS"
* title = "Mindfulness Setting CodeSystem"
* status = #active
* experimental = false
* caseSensitive = true
* content = #complete
* count = 5
* concept[+].code = #home
* concept[=].display = "Home Practice"
* concept[+].code = #clinic
* concept[=].display = "Clinical Setting"
* concept[+].code = #group
* concept[=].display = "Group Setting"
* concept[+].code = #retreat
* concept[=].display = "Retreat Setting"
* concept[+].code = #workplace
* concept[=].display = "Workplace Setting"



// ===== Conteúdo de: code-replacements.fsh =====

// SUBSTITUIÇÕES DE CÓDIGOS CONFIRMADAS COMO VÁLIDAS

// Walking - usar código LOINC correto
Alias: WALKING_SPEED = http://loinc.org#41950-7 "Number of steps in 24 hour"

// Sleep - códigos LOINC válidos
Alias: SLEEP_DURATION = http://loinc.org#93832-4 "Sleep duration"

// Mindfulness - usar código genérico de terapia
Alias: MINDFULNESS = http://snomed.info/sct#182840001 "Drug treatment education"

// Body Composition - usar códigos que existem
Alias: BODY_FAT = http://loinc.org#41982-0 "Percentage of body fat Measured"

// UV Exposure - usar código ambiental genérico  
Alias: UV_EXPOSURE = http://loinc.org#82612-7 "UV index"



// ===== Conteúdo de: MindfulnessNarrative.fsh =====

RuleSet: MindfulnessObservationNarrative
* text.status = #generated
* text.div = "<div xmlns=\"http://www.w3.org/1999/xhtml\">
    <p><b>Generated Narrative</b></p>
    <p><b>Session Type:</b> Mindfulness Practice Session</p>
    <p><b>Date:</b> {effectiveDateTime}</p>
    <p><b>Duration:</b> {component[sessionDuration].value} minutes</p>
    <p><b>Stress Level:</b> {component[stressLevel].value} / 10</p>
    <p><b>Mood:</b> {component[moodState].value}</p>
    <p><b>Technique:</b> {component[relaxationResponse].value}</p>
    <p><b>Location:</b> {extension[mindfulness-context].extension[location].value}</p>
  </div>"

RuleSet: MindfulnessQuestionnaireNarrative
* text.status = #generated
* text.div = "<div xmlns=\"http://www.w3.org/1999/xhtml\">
    <p><b>Generated Narrative</b></p>
    <p><b>Title:</b> {title}</p>
    <p><b>Status:</b> {status}</p>
    <h3>Sections</h3>
    <ul>
      <li>Mindfulness Session</li>
      <li>Mood Assessment</li>
      <li>Stress Assessment</li>
      <li>Relaxation</li>
    </ul>
  </div>"

RuleSet: MindfulnessResponseNarrative
* text.status = #generated
* text.div = "<div xmlns=\"http://www.w3.org/1999/xhtml\">
    <p><b>Generated Narrative</b></p>
    <p><b>Date:</b> {authored}</p>
    <p><b>Session Duration:</b> {item[session_duration].answer.value} minutes</p>
    <p><b>Practice Type:</b> {item[practice_type].answer.value}</p>
    <p><b>Mood:</b> {item[current_mood].answer.value}</p>
    <p><b>Stress Level:</b> {item[stress_level].answer.value} / 10</p>
    <p><b>Relaxation Technique:</b> {item[relaxation_technique].answer.value}</p>
  </div>"

RuleSet: MindfulnessConfigNarrative
* text.status = #generated
* text.div = "<div xmlns=\"http://www.w3.org/1999/xhtml\">
    <p><b>Generated Narrative</b></p>
    <p><b>Default Duration:</b> {extension[defaultDuration].value} minutes</p>
    <p><b>Reminders:</b> {extension[reminderSettings].value}</p>
    <p><b>Data Sync:</b> {extension[dataSync].value}</p>
  </div>"



// ===== Conteúdo de: StressInvariants.fsh =====

Invariant: stress-level-range
Description: "Stress level score must be between 0 and 10"
Expression: "valueQuantity.exists() implies (valueQuantity.value >= 0 and valueQuantity.value <= 10)"
Severity: #error

Invariant: stress-component-consistency
Description: "Physiological and psychological stress scores must be consistent with overall score"
Expression: "component.where(code.coding.code='89593-8').value.exists() and component.where(code.coding.code='89594-6').value.exists() implies (component.where(code.coding.code='89593-8').value + component.where(code.coding.code='89594-6').value) div 2 = valueQuantity"
Severity: #warning



// ===== Conteúdo de: SocialInteractionInvariants.fsh =====

Invariant: social-interaction-duration
Description: "Social interaction duration must be positive"
Expression: "component.where(code.coding.code='89597-9').value.exists() implies component.where(code.coding.code='89597-9').value > 0"
Severity: #error

Invariant: social-interaction-participants
Description: "Number of participants must be at least 2 for social interaction"
Expression: "component.where(code.coding.code='89600-1').value.exists() implies component.where(code.coding.code='89600-1').value >= 2"
Severity: #error



// ===== Conteúdo de: MindfulnessInvariants.fsh =====

Invariant: mindfulness-session-duration
Description: "Mindfulness session duration must be between 1 and 180 minutes"
Expression: "component.where(code.coding.system='http://snomed.info/sct' and code.coding.code='118682006').value.ofType(Quantity).value.exists() implies (component.where(code.coding.system='http://snomed.info/sct' and code.coding.code='118682006').value.ofType(Quantity).value >= 1 and component.where(code.coding.system='http://snomed.info/sct' and code.coding.code='118682006').value.ofType(Quantity).value <= 180)"
Severity: #error

Invariant: mindfulness-stress-level
Description: "Stress level must be between 0 and 10"
Expression: "component.where(code.coding.system='http://snomed.info/sct' and code.coding.code='725854004').value.ofType(Integer).exists() implies (component.where(code.coding.system='http://snomed.info/sct' and code.coding.code='725854004').value.ofType(Integer) >= 0 and component.where(code.coding.system='http://snomed.info/sct' and code.coding.code='725854004').value.ofType(Integer) <= 10)"
Severity: #error

Invariant: mindfulness-mood-required
Description: "Mood assessment must include a mood state and intensity"
Expression: "component.where(code.coding.system='http://snomed.info/sct' and code.coding.code='373931001').exists() implies component.where(code.coding.system='http://snomed.info/sct' and code.coding.code='373931001').value.exists()"
Severity: #warning

Invariant: mindfulness-context-complete
Description: "Mindfulness context should include location and environment"
Expression: "extension.where(url='https://github.com/RicardoLSantos/shorthand/StructureDefinition/mindfulness-context').exists() implies (extension.where(url='https://github.com/RicardoLSantos/shorthand/StructureDefinition/mindfulness-context').extension.where(url='location').exists() and extension.where(url='https://github.com/RicardoLSantos/shorthand/StructureDefinition/mindfulness-context').extension.where(url='environment').exists())"
Severity: #warning

Invariant: sequential-measurements
Description: "Sequential measurements must have increasing effectiveDateTime"
Expression: "component.where(code.coding.system='http://snomed.info/sct' and code.coding.code='118682006').exists() implies (effectiveDateTime > previous().effectiveDateTime)"
Severity: #warning



// ===== Conteúdo de: MindfulnessOperations.fsh =====

Profile: MindfulnessOperation
Parent: OperationDefinition 
Id: mindfulness-operation
Title: "Mindfulness Operation"
Description: "Base definition for mindfulness operations"

* status 1..1
* kind 1..1
* name 1..1
* code 1..1
* resource 1..1
* system 1..1
* type 1..1
* instance 1..1
* parameter 0..*
* parameter.name 1..1

Instance: StartSessionOperation
InstanceOf: MindfulnessOperation
Title: "Start Session Operation"
Description: "Operation to start a new mindfulness session"

* status = #active
* kind = #operation
* name = "start-session"
* code = #start
* resource = #Observation
* system = false
* type = true
* instance = false
* parameter[+]
  * name = #duration
  * use = #in
  * min = 1
  * max = "1" 
  * type = #integer
  * documentation = "Duration in minutes"

Instance: EndSessionOperation
InstanceOf: MindfulnessOperation
Title: "End Session Operation"
Description: "Operation to end an ongoing mindfulness session"

* status = #active
* kind = #operation
* name = "end-session"
* code = #end
* resource = #Observation
* system = false
* type = true
* instance = true
* parameter[+]
  * name = #session
  * use = #in
  * min = 1
  * max = "1"
  * type = #string
  * documentation = "ID of the session to end"



// ===== Conteúdo de: VitalSignsExtensions.fsh =====

Extension: MeasurementContext
Id: measurement-context
Title: "Measurement Context Extension"
Description: "Additional context about the vital sign measurement"
* value[x] only CodeableConcept
* valueCodeableConcept from MeasurementContextVS (required)

ValueSet: MeasurementContextVitalSigns
Id: measurement-context-vital-signs
Title: "Measurement Context Value Set"
* $SCT#255214003 "At rest"
* $SCT#309604004 "During exercise"
* $SCT#309605003 "Post exercise"
* $SCT#248626006 "During sleep"



// ===== Conteúdo de: NutritionExtensions.fsh =====

Extension: NutritionDataSource
Id: nutrition-data-source
Title: "Nutrition Data Source Extension"
Description: "Indicates the source of nutrition data"

* ^version = "0.1.0"
* ^status = #draft
* ^experimental = false
* ^date = "2024-12-14"
* ^publisher = "Ricardo Lourenço dos Santos"
* ^context[0].type = #element
* ^context[0].expression = "Observation"

* value[x] only CodeableConcept
* valueCodeableConcept from NutritionDataSourceVS (required)

ValueSet: NutritionDataSourceVS
Id: nutrition-data-source-vs
Title: "Nutrition Data Source Value Set"
Description: "Value set for nutrition data sources"

* ^version = "0.1.0"
* ^status = #draft
* ^experimental = false
* ^date = "2024-12-14"
* ^publisher = "Ricardo Lourenço dos Santos"

* codes from system NutritionDataSourceCS

CodeSystem: NutritionDataSourceCS
Id: nutrition-data-source-cs
Title: "Nutrition Data Source Code System"
Description: "Code system for nutrition data sources"

* ^version = "0.1.0"
* ^status = #draft
* ^experimental = false
* ^date = "2024-12-14"
* ^publisher = "Ricardo Lourenço dos Santos"
* ^caseSensitive = true

* #manual "Manual Entry" "Data entered manually by user"
* #app "App Integration" "Data from integrated third-party apps"
* #device "Connected Device" "Data from connected nutrition tracking devices"
* #questionnaire "Questionnaire Response" "Data collected through questionnaires"



// ===== Conteúdo de: AdvancedVitalSignsExtensions.fsh =====

Alias: $UCUM = http://unitsofmeasure.org

Extension: PhysiologicalStressIndex
Id: physiological-stress-index
Title: "Physiological Stress Index Extension"
Description: "Index representing overall physiological stress based on multiple parameters"

* ^version = "0.1.0"
* ^status = #draft
* ^context[+].type = #element
* ^context[=].expression = "Observation"

* value[x] only Quantity
* valueQuantity.system = $UCUM
* valueQuantity.code = #{index}
* valueQuantity ^short = "Physiological stress index value"
* valueQuantity ^definition = "Normalized index value representing overall physiological stress"

Extension: HomeostasisIndex
Id: homeostasis-index
Title: "Homeostasis Index Extension"
Description: "Composite measure of physiological balance and adaptation"

* ^version = "0.1.0"
* ^status = #draft
* ^context[+].type = #element
* ^context[=].expression = "Observation"

* value[x] only Quantity
* valueQuantity.system = $UCUM
* valueQuantity.code = #{ratio}
* valueQuantity ^short = "Homeostasis index value"
* valueQuantity ^definition = "Normalized ratio representing physiological balance"

Extension: RecoveryEfficiency
Id: recovery-efficiency
Title: "Recovery Efficiency Extension"
Description: "Measure of how efficiently the body recovers from stress or exertion"

* ^version = "0.1.0"
* ^status = #draft
* ^context[+].type = #element
* ^context[=].expression = "Observation"

* value[x] only Quantity
* valueQuantity.system = $UCUM
* valueQuantity.code = #%
* valueQuantity ^short = "Recovery efficiency percentage"
* valueQuantity ^definition = "Percentage indicating recovery efficiency"

Extension: AllostaticLoad
Id: allostatic-load
Title: "Allostatic Load Extension"
Description: "Measure of cumulative physiological burden over time"

* ^version = "0.1.0"
* ^status = #draft
* ^context[+].type = #element
* ^context[=].expression = "Observation"

* value[x] only Quantity
* valueQuantity.system = $UCUM
* valueQuantity.code = #{score}
* valueQuantity ^short = "Allostatic load score"
* valueQuantity ^definition = "Score representing cumulative physiological burden"

Extension: CircadianPhase
Id: circadian-phase
Title: "Circadian Phase Extension"
Description: "Indicator of position in circadian rhythm cycle"

* ^version = "0.1.0"
* ^status = #draft
* ^context[+].type = #element
* ^context[=].expression = "Observation"

* value[x] only CodeableConcept
* valueCodeableConcept from CircadianPhaseVS (required)

ValueSet: CircadianPhaseVS
Id: circadian-phase-vs
Title: "Circadian Phase Value Set"
Description: "Value set for circadian rhythm phases"

* ^experimental = true
* codes from system CircadianPhaseCS

CodeSystem: CircadianPhaseCS
Id: circadian-phase-cs
Title: "Circadian Phase Code System"
Description: "Code system for circadian rhythm phases"

* ^experimental = true
* ^caseSensitive = true

* #early-morning "Early Morning Phase" "Period shortly after awakening"
* #mid-morning "Mid Morning Phase" "Mid-morning period"
* #afternoon "Afternoon Phase" "Afternoon period"
* #evening "Evening Phase" "Evening period"
* #night "Night Phase" "Nighttime period"
* #deep-night "Deep Night Phase" "Deep night period"

Extension: MeasurementQuality
Id: measurement-quality
Title: "Measurement Quality Extension"
Description: "Indicator of the quality and reliability of the measurement"

* ^version = "0.1.0"
* ^status = #draft
* ^context[+].type = #element
* ^context[=].expression = "Observation"

* value[x] only CodeableConcept
* valueCodeableConcept from MeasurementQualityVS (required)

ValueSet: MeasurementQualityVS
Id: measurement-quality-vs
Title: "Measurement Quality Value Set"
Description: "Value set for measurement quality indicators"

* ^experimental = true
* codes from system MeasurementQualityCS

CodeSystem: MeasurementQualityCS
Id: measurement-quality-cs
Title: "Measurement Quality Code System"
Description: "Code system for measurement quality indicators"

* ^experimental = true
* ^caseSensitive = true

* #excellent "Excellent Quality" "High quality measurement with minimal noise"
* #good "Good Quality" "Good quality measurement with acceptable noise"
* #fair "Fair Quality" "Fair quality measurement with some interference"
* #poor "Poor Quality" "Poor quality measurement with significant interference"
* #unreliable "Unreliable" "Unreliable measurement requiring verification"



// ===== Conteúdo de: StressExtensions.fsh =====

Extension: StressTriggers
Id: stress-triggers
Title: "Stress Triggers Extension"
Description: "Extension for recording identified stress triggers"
* value[x] only CodeableConcept
* valueCodeableConcept from StressTriggersVS (required)

Extension: StressCoping
Id: stress-coping
Title: "Stress Coping Extension"
Description: "Extension for recording stress coping mechanisms"
* value[x] only CodeableConcept
* valueCodeableConcept from StressCopingVS (required)

ValueSet: StressTriggersVS
Id: stress-triggers-vs
Title: "Stress Triggers Value Set"
Description: "Value set for common stress triggers"
* codes from system StressTriggersCS

ValueSet: StressCopingVS
Id: stress-coping-vs
Title: "Stress Coping Value Set"
Description: "Value set for stress coping mechanisms"
* codes from system StressCopingCS

CodeSystem: StressTriggersCS
Id: stress-triggers-cs
Title: "Stress Triggers Code System"
Description: "Code system for common stress triggers"
* #work "Work-related" "Stress from work or professional activities"
* #financial "Financial" "Financial-related stress"
* #relationships "Relationships" "Stress from personal relationships"
* #health "Health" "Health-related concerns"
* #environment "Environmental" "Environmental factors"
* #time "Time Management" "Time pressure and deadlines"
* #change "Life Changes" "Major life changes or transitions"

CodeSystem: StressCopingCS
Id: stress-coping-cs
Title: "Stress Coping Code System"
Description: "Code system for stress coping mechanisms"
* #exercise "Physical Exercise" "Using exercise to manage stress"
* #meditation "Meditation" "Meditation and mindfulness practices"
* #social "Social Support" "Seeking social support"
* #professional "Professional Help" "Seeking professional assistance"
* #relaxation "Relaxation" "Relaxation techniques"
* #creative "Creative Activities" "Engaging in creative activities"
* #nature "Nature" "Spending time in nature"



// ===== Conteúdo de: EnvironmentalExtensions.fsh =====

Extension: ExposureLocation
Id: exposure-location
Title: "Exposure Location Extension"
Description: "Extension for recording location of environmental exposure measurement"

* ^version = "0.1.0"
* ^status = #draft
* ^context[+].type = #element
* ^context[=].expression = "Observation"

* value[x] only CodeableConcept
* valueCodeableConcept from ExposureLocationVS (required)
* valueCodeableConcept ^short = "Location type of exposure"
* valueCodeableConcept ^definition = "Categorizes the type of location where environmental exposure occurred"

Extension: ExposureConditions
Id: exposure-conditions
Title: "Exposure Conditions Extension"
Description: "Additional conditions during environmental exposure measurement"

* ^version = "0.1.0"
* ^status = #draft
* ^context[+].type = #element
* ^context[=].expression = "Observation"

* value[x] only CodeableConcept
* valueCodeableConcept from ExposureConditionsVS (required)
* valueCodeableConcept ^short = "Conditions during exposure"

ValueSet: ExposureLocationVS
Id: exposure-location-vs
Title: "Exposure Location Value Set"
Description: "Value set for environmental exposure locations"

* ^version = "0.1.0"
* ^status = #draft
* ^experimental = true
* codes from system ExposureLocationCS

ValueSet: ExposureConditionsVS
Id: exposure-conditions-vs
Title: "Exposure Conditions Value Set"
Description: "Value set for environmental exposure conditions"

* ^version = "0.1.0"
* ^status = #draft
* ^experimental = true
* codes from system ExposureConditionsCS

CodeSystem: ExposureLocationCS
Id: exposure-location-cs
Title: "Exposure Location Code System"
Description: "Code system for environmental exposure locations"

* ^version = "0.1.0"
* ^status = #draft
* ^caseSensitive = true
* ^experimental = true

* #indoor "Indoor environment" "Environment within buildings or enclosed spaces"
* #outdoor "Outdoor environment" "Open-air environment"
* #workplace "Workplace" "Professional or occupational environment"
* #transit "In transit" "While in transportation or commuting"
* #recreational "Recreational area" "Leisure or sports facilities"
* #urban "Urban area" "City or densely populated area"
* #rural "Rural area" "Countryside or sparsely populated area"

CodeSystem: ExposureConditionsCS
Id: exposure-conditions-cs
Title: "Exposure Conditions Code System"
Description: "Code system for conditions during environmental exposure"

* ^version = "0.1.0"
* ^status = #draft
* ^caseSensitive = true
* ^experimental = true

* #normal "Normal conditions" "Standard environmental conditions"
* #extreme "Extreme conditions" "Unusual or severe environmental conditions"
* #controlled "Controlled environment" "Environment with controlled conditions"
* #variable "Variable conditions" "Changing environmental conditions"



// ===== Conteúdo de: BodyMetricsExtensions.fsh =====

Alias: $SCT = http://snomed.info/sct

Extension: MeasurementConditions
Id: measurement-conditions
Title: "Measurement Conditions Extension"
Description: "Records the conditions under which body measurements were taken"

* ^version = "0.1.0"
* ^status = #draft
* ^context[0].type = #element
* ^context[0].expression = "Observation"

* value[x] only CodeableConcept
* valueCodeableConcept from MeasurementConditionsVS (required)

Extension: MeasurementDevice
Id: measurement-device-type
Title: "Measurement Device Type Extension"
Description: "Specifies the type of device used for body measurements"

* ^version = "0.1.0"
* ^status = #draft
* ^context[0].type = #element
* ^context[0].expression = "Observation"

* value[x] only CodeableConcept
* valueCodeableConcept from MeasurementDeviceTypeVS (required)

ValueSet: MeasurementConditionsVS
Id: measurement-conditions-vs
Title: "Measurement Conditions Value Set"
Description: "Standard conditions under which measurements are taken"

* ^version = "0.1.0"
* ^status = #draft

* $SCT#307818003 "Pre-breakfast"
* $SCT#307819006 "Post-exercise"
* $SCT#307820000 "Wearing light clothing"
* $SCT#255203001 "First thing in morning"
* $SCT#255214005 "After void"
* $SCT#309604004 "During rest"

ValueSet: MeasurementDeviceTypeVS
Id: measurement-device-type-vs
Title: "Measurement Device Type Value Set"
Description: "Types of devices used for health and body measurements"

* ^version = "0.1.0"
* ^status = #draft

* $SCT#469576000 "Smart watch"
* $SCT#706767009 "Body composition analyzer"
* $SCT#131009002 "Height measuring device"
* $SCT#706889009 "Blood pressure monitor"
* $SCT#444699000 "Tape measure"
* $SCT#44056008  "Digital scale"

Instance: WeightWithConditions
InstanceOf: WeightObservation
Usage: #example
Title: "Weight Measurement with Conditions Example"

* status = #final
* category = http://terminology.hl7.org/CodeSystem/observation-category#vital-signs
* code = $LOINC#29463-7 "Body weight"
* subject = Reference(Patient/example)
* effectiveDateTime = "2024-03-19T08:00:00Z"
* valueQuantity = 70.5 'kg'

* extension[measurement-conditions].url = "https://github.com/RicardoLSantos/shorthand/StructureDefinition/measurement-conditions"
* extension[measurement-conditions].valueCodeableConcept = $SCT#307818003 "Pre-breakfast"

* extension[measurement-device-type].url = "https://github.com/RicardoLSantos/shorthand/StructureDefinition/measurement-device-type"
* extension[measurement-device-type].valueCodeableConcept = $SCT#469576000 "Smart scale device"



// ===== Conteúdo de: SleepQuality.fsh =====

Extension: SleepQuality
Id: sleep-quality
Title: "Sleep Quality Extension"
Description: "Extension for recording subjective sleep quality"
* value[x] only CodeableConcept
* valueCodeableConcept from SleepQualityExtendedVS (required)
 
ValueSet: SleepQualityExtendedVS
Id: sleep-quality-extended-vs
Title: "Sleep Quality Value Set"
* $SCT#248220008 "Very good quality sleep"
* $SCT#248221007 "Good quality sleep"
* $SCT#248222000 "Poor quality sleep"
* $SCT#248223005 "Very poor quality sleep"



// ===== Conteúdo de: MindfulnessExtensions.fsh =====

Extension: MindfulnessContext
Id: mindfulness-context
Title: "Mindfulness Session Context"
Description: "Additional context about the mindfulness practice session"

* ^url = "https://github.com/RicardoLSantos/shorthand/StructureDefinition/mindfulness-context"
* ^version = "1.0.0"
* ^status = #draft
* ^date = "2024-03-19"
* ^publisher = "Example Organization"

* extension contains
    location 0..1 and
    environment 0..1 and
    guidance 0..1

* extension[location].value[x] only string
* extension[location].valueString 1..1
* extension[location] ^short = "Physical location of practice"
* extension[location] ^definition = "The physical location where the mindfulness practice took place"

* extension[environment].value[x] only CodeableConcept
* extension[environment].valueCodeableConcept from https://github.com/RicardoLSantos/shorthand/ValueSet/environment-type (required)
* extension[environment] ^short = "Environmental conditions"
* extension[environment] ^definition = "The environmental conditions during the practice session"

* extension[guidance].value[x] only boolean
* extension[guidance].valueBoolean 1..1
* extension[guidance] ^short = "Whether guidance was used"
* extension[guidance] ^definition = "Indicates if the session was guided or self-directed"



// ===== Conteúdo de: SocialInteractionExtensions.fsh =====

Extension: SocialContext
Id: social-context
Title: "Social Context Extension"
Description: "Extension for recording the context of social interaction"
* value[x] only CodeableConcept
* valueCodeableConcept from SocialContextVS (required)

Extension: SocialSupport
Id: social-support
Title: "Social Support Extension"
Description: "Extension for recording perceived social support"
* value[x] only CodeableConcept
* valueCodeableConcept from SocialSupportVS (required)

Extension: SocialActivity
Id: social-activity
Title: "Social Activity Extension"
Description: "Extension for recording specific social activities"
* value[x] only CodeableConcept
* valueCodeableConcept from SocialActivityVS (required)

ValueSet: SocialContextVS
Id: social-context-vs
Title: "Social Context Value Set"
Description: "Value set for social interaction contexts"
* codes from system SocialContextCS

ValueSet: SocialSupportVS
Id: social-support-vs
Title: "Social Support Value Set"
Description: "Value set for levels of social support"
* codes from system SocialSupportCS

ValueSet: SocialActivityVS
Id: social-activity-vs
Title: "Social Activity Value Set"
Description: "Value set for types of social activities"
* codes from system SocialActivityCS

CodeSystem: SocialContextCS
Id: social-context-cs
Title: "Social Context Code System"
Description: "Code system for social interaction contexts"
* #home "Home" "Home environment"
* #work "Work" "Work environment"
* #education "Educational" "Educational setting"
* #community "Community" "Community setting"
* #recreational "Recreational" "Recreational setting"
* #healthcare "Healthcare" "Healthcare setting"

CodeSystem: SocialSupportCS
Id: social-support-cs
Title: "Social Support Code System"
Description: "Code system for levels of social support"
* #strong "Strong Support" "Strong social support network"
* #adequate "Adequate Support" "Sufficient social support"
* #limited "Limited Support" "Limited social support"
* #minimal "Minimal Support" "Minimal social support"
* #none "No Support" "Absence of social support"

CodeSystem: SocialActivityCS
Id: social-activity-cs
Title: "Social Activity Code System"
Description: "Code system for types of social activities"
* #meal "Shared Meal" "Sharing a meal together"
* #exercise "Group Exercise" "Group physical activity"
* #entertainment "Entertainment" "Shared entertainment activity"
* #learning "Learning" "Group learning activity"
* #volunteering "Volunteering" "Community service activity"
* #celebration "Celebration" "Social celebration or event"



// ===== Conteúdo de: SleepExtensions.fsh =====




// ===== Conteúdo de: MobilityExtensions.fsh =====

Extension: MobilityAlertLevel
Id: mobility-alert-level
Title: "Mobility Alert Level Extension"
Description: "Extension for mobility measurements alert levels to indicate the severity or concern level of mobility changes detected by the device"
* ^status = #active
* ^context[0].type = #element
* ^context[0].expression = "Observation"
* . ^short = "Mobility alert level indicator"
* . ^definition = "Indicates the severity level of mobility changes or concerns based on device measurements"
* value[x] only CodeableConcept
* valueCodeableConcept from MobilityAlertLevelVS (required)
* valueCodeableConcept ^short = "Alert level code"
* valueCodeableConcept ^definition = "The specific alert level code indicating the severity of mobility changes"

ValueSet: MobilityAlertLevelVS
Id: mobility-alert-level-vs
Title: "Mobility Alert Level Value Set"
Description: "Value set for mobility measurement alert levels used to categorize the severity of mobility changes or concerns"
* ^status = #active
* ^experimental = false
* ^purpose = "To provide standardized alert levels for mobility measurements"
* codes from system MobilityAlertLevelCS

CodeSystem: MobilityAlertLevelCS
Id: mobility-alert-level-cs
Title: "Mobility Alert Level Code System"
Description: "Code system defining alert levels for mobility measurements, indicating the severity of changes in mobility patterns"
* ^status = #active
* ^experimental = false
* ^caseSensitive = true
* ^content = #complete
* #green "Normal - No concern" "Mobility measurements are within normal range and show no concerning patterns"
* #yellow "Caution - Monitor closely" "Mobility measurements show slight deviations that warrant closer monitoring"
* #red "Alert - Significant change" "Mobility measurements indicate significant changes that require immediate attention"
* ^property[0].code = #status
* ^property[0].type = #code
* ^property[0].description = "The status of the alert level"
* ^property[1].code = #severity
* ^property[1].type = #integer
* ^property[1].description = "Numeric value indicating severity (1=low, 3=high)"



// ===== Conteúdo de: ActivityExtensions.fsh =====




// ===== Conteúdo de: MobilityRiskValueSets.fsh =====

ValueSet: FallRiskOutcomesValueSet
Id: fall-risk-outcomes
Title: "Fall Risk Outcomes Value Set"
Description: "Value set for fall risk assessment outcomes"
* ^url = "https://github.com/RicardoLSantos/shorthand/fhir/ValueSet/fall-risk-outcomes"
* ^status = #active
* include codes from system https://github.com/RicardoLSantos/shorthand/fhir/CodeSystem/fall-risk-outcomes

ValueSet: RiskLevelValueSet
Id: risk-level
Title: "Risk Level Value Set"
Description: "Value set for general risk levels"
* ^url = "https://github.com/RicardoLSantos/shorthand/fhir/ValueSet/risk-level"
* ^status = #active
* include codes from system https://github.com/RicardoLSantos/shorthand/fhir/CodeSystem/risk-level

ValueSet: MobilityDeclineOutcomesValueSet
Id: mobility-decline-outcomes
Title: "Mobility Decline Outcomes Value Set"
Description: "Value set for mobility decline assessment outcomes"
* ^url = "https://github.com/RicardoLSantos/shorthand/fhir/ValueSet/mobility-decline-outcomes"
* ^status = #active
* include codes from system https://github.com/RicardoLSantos/shorthand/fhir/CodeSystem/mobility-decline-outcomes

ValueSet: AssistanceLevelOutcomesValueSet
Id: assistance-level-outcomes
Title: "Assistance Level Outcomes Value Set"
Description: "Value set for assistance level assessment outcomes"
* ^url = "https://github.com/RicardoLSantos/shorthand/fhir/ValueSet/assistance-level-outcomes"
* ^status = #active
* include codes from system https://github.com/RicardoLSantos/shorthand/fhir/CodeSystem/assistance-level-outcomes



// ===== Conteúdo de: SymptomValueSets.fsh =====

CodeSystem: SymptomSeverityCS
Id: symptom-severity-cs
Title: "Symptom Severity Code System"
Description: "Severity levels for symptoms"

* #1-3 "Light" "Symptom barely noticeable"
* #4-6 "Mild" "Symptom noticeable but not interfering with daily activities"
* #7-8 "Intense" "Symptom interfering with daily activities"
* #9-10 "Severe" "Symptom preventing daily activities"

ValueSet: BodyLocationsVS
Id: body-locations-vs
Title: "Body Locations Value Set"
Description: "Anatomical locations for symptom recording"
* $SCT#12738006 "Brain"
* $SCT#69536005 "Head"
* $SCT#45048000 "Neck"
* $SCT#51185008 "Chest"
* $SCT#62413002 "Abdomen"
* $SCT#32849002 "Back"
* $SCT#53120007 "Upper limb"
* $SCT#61685007 "Lower limb"

ValueSet: DurationUnitsVS
Id: duration-units-vs
Title: "Duration Units Value Set"
Description: "Time units for symptom duration"
* $UCUM#min "Minutes"
* $UCUM#h "Hours"
* $UCUM#d "Days"
* $UCUM#wk "Weeks"
* $UCUM#mo "Months"

CodeSystem: SymptomFrequencyCS
Id: symptom-frequency-cs
Title: "Symptom Frequency Code System"
Description: "Frequency patterns for symptoms"
* #rare "Rare" "Less than once per month"
* #occasional "Occasional" "Several times per month"
* #frequent "Frequent" "Several times per week"
* #daily "Daily" "Once or more per day"
* #constant "Constant" "Present most of the time"

ValueSet: SymptomFrequencyVS
Id: symptom-frequency-vs
Title: "Symptom Frequency Value Set"
Description: "Frequency patterns for symptoms"
* codes from system SymptomFrequencyCS

CodeSystem: SymptomImpactCS
Id: symptom-impact-cs
Title: "Symptom Impact Code System"
Description: "Impact levels of symptoms on daily activities"
* #none "No impact"
* #mild "Mild impact"
* #moderate "Moderate impact"
* #severe "Severe impact"
* #complete "Complete impact"

ValueSet: SymptomImpactVS
Id: symptom-impact-vs
Title: "Symptom Impact Value Set"
Description: "Impact levels for symptoms"
* codes from system SymptomImpactCS

ValueSet: SymptomProgressionVS
Id: symptom-progression-vs
Title: "Symptom Progression Value Set"
Description: "Progression patterns for symptoms"
* $SCT#385633008 "Improving"
* $SCT#58158008 "Stable"
* $SCT#230993007 "Worsening"
* $SCT#255314001 "Fluctuating"

ValueSet: TimeOfDayVS
Id: time-of-day-vs
Title: "Time of Day Value Set"
Description: "Times of day for symptom occurrence"
* $SCT#73775008 "Morning"
* $SCT#255253008 "Afternoon"
* $SCT#2546009 "Evening"
* $SCT#73768005 "Night"



// ===== Conteúdo de: StressValueSets.fsh =====

ValueSet: StressChronicityVS
Id: stress-chronicity-vs
Title: "Stress Chronicity Value Set"
Description: "Value set for classifying stress chronicity"
* ^url = "https://github.com/RicardoLSantos/shorthand/ValueSet/stress-chronicity-vs"
* codes from system StressChronicityCS

ValueSet: StressImpactVS
Id: stress-impact-vs
Title: "Stress Impact Value Set"
Description: "Value set for describing stress impact levels"
* ^url = "https://github.com/RicardoLSantos/shorthand/ValueSet/stress-impact-vs"
* codes from system StressImpactCS

CodeSystem: StressChronicityCS
Id: stress-chronicity-cs
Title: "Stress Chronicity Code System"
Description: "Code system for stress chronicity classification"
* ^url = "https://github.com/RicardoLSantos/shorthand/CodeSystem/stress-chronicity-cs"
* #acute "Acute" "Short-term stress response"
* #subacute "Subacute" "Medium-term stress response"
* #chronic "Chronic" "Long-term stress response"
* #episodic "Episodic" "Recurring stress episodes"
* #persistent "Persistent" "Continuous stress state"

CodeSystem: StressImpactCS
Id: stress-impact-cs
Title: "Stress Impact Code System"
Description: "Code system for stress impact levels"
* ^url = "https://github.com/RicardoLSantos/shorthand/CodeSystem/stress-impact-cs"
* #minimal "Minimal Impact" "Little to no interference with daily activities"
* #mild "Mild Impact" "Some interference with daily activities"
* #moderate "Moderate Impact" "Significant interference with daily activities"
* #severe "Severe Impact" "Major interference with daily activities"
* #extreme "Extreme Impact" "Unable to perform daily activities"



// ===== Conteúdo de: ReproductiveValueSets.fsh =====

ValueSet: ReproductiveGoalVS
Id: reproductive-goal-vs
Title: "Reproductive Health Goals Value Set"
Description: "Goals related to reproductive health tracking and planning"

* ^status = #active
* ^experimental = false
* ^date = "2024-03-19"

* $LOINC#8708-0 "Menstrual cycle length"
* $LOINC#55284-4 "Blood pressure"
* $LOINC#8310-5 "Body temperature"
* $LOINC#8302-2 "Body height"
* $LOINC#29463-7 "Body weight"
* $SCT#364311006 "Menstrual cycle monitoring"
* $SCT#289530006 "Reproductive health finding"

ValueSet: ReproductiveActivityVS
Id: reproductive-activity-vs
Title: "Reproductive Health Activities Value Set"
Description: "Activities related to reproductive health monitoring"

* ^status = #active
* ^experimental = false
* ^date = "2024-03-19"

* codes from system ReproductiveActivityCS

CodeSystem: ReproductiveActivityCS
Id: reproductive-activity-cs
Title: "Reproductive Health Activities Code System"
Description: "Code system for reproductive health monitoring activities"

* ^status = #active
* ^experimental = false
* ^caseSensitive = true

* #cycle-tracking "Cycle Tracking" "Track menstrual cycle dates and characteristics"
* #temp-monitoring "Temperature Monitoring" "Monitor basal body temperature"
* #symptom-tracking "Symptom Tracking" "Track reproductive health symptoms"
* #vitals-monitoring "Vitals Monitoring" "Monitor vital signs related to reproductive health"
* #fertility-signs "Fertility Signs" "Monitor fertility signs and indicators"
* #mood-tracking "Mood Tracking" "Track mood changes related to reproductive cycle"
* #medication-log "Medication Log" "Log reproductive health medications"
* #exercise-tracking "Exercise Tracking" "Track physical activity during cycle"



// ===== Conteúdo de: AuditFormatsValueSet.fsh =====

ValueSet: AuditFormatsValueSet
Id: audit-formats
Title: "Audit Formats Value Set"
Description: "Value set for audit format types"
* ^url = "https://github.com/RicardoLSantos/shorthand/fhir/ValueSet/audit-formats"
* ^status = #active
* ^experimental = false
* ^date = "2024-12-27"
* include codes from system https://github.com/RicardoLSantos/shorthand/fhir/CodeSystem/audit-formats

CodeSystem: AuditFormatsCodeSystem
Id: audit-formats
Title: "Audit Formats Code System"
Description: "Code system for audit format types"
* ^url = "https://github.com/RicardoLSantos/shorthand/fhir/CodeSystem/audit-formats"
* ^status = #active
* ^experimental = false
* ^caseSensitive = true
* #text "Text Format"
* #structured "Structured Format"
* #mixed "Mixed Format"



// ===== Conteúdo de: MeasurementContextVS.fsh =====

ValueSet: MeasurementContextVS
Id: measurement-context-vs
Title: "Measurement Context Value Set"
Description: "Contexts in which measurements can be taken, including temporal and location-based contexts"
* ^status = #active
* ^experimental = false
* $SCT#272125009 "Assessment context value (qualifier value)"
* $SCT#307818003 "Before food"
* $SCT#307819006 "After food"
* $SCT#255214003 "After exercise"
* $SCT#264362003 "Time of day"



// ===== Conteúdo de: AuditLevelsValueSet.fsh =====

ValueSet: AuditLevelsValueSet
Id: audit-levels
Title: "Audit Levels Value Set"
Description: "Value set for audit level types"
* ^url = "https://github.com/RicardoLSantos/shorthand/fhir/ValueSet/audit-levels"
* ^status = #active
* ^experimental = false
* ^date = "2024-12-27"
* include codes from system https://github.com/RicardoLSantos/shorthand/fhir/CodeSystem/audit-levels

CodeSystem: AuditLevelsCodeSystem
Id: audit-levels
Title: "Audit Levels Code System"
Description: "Code system for audit level types"
* ^url = "https://github.com/RicardoLSantos/shorthand/fhir/CodeSystem/audit-levels"
* ^status = #active
* ^experimental = false
* ^caseSensitive = true
* #low "Low Level"
* #medium "Medium Level"
* #high "High Level"



// ===== Conteúdo de: SocialInteractionValueSets.fsh =====

ValueSet: SocialInteractionTypeVS
Id: social-interaction-type-vs
Title: "Social Interaction Type Value Set"
Description: "Types of social interactions"
* codes from system SocialInteractionTypeCS

ValueSet: SocialInteractionQualityVS
Id: social-interaction-quality-vs
Title: "Social Interaction Quality Value Set"
Description: "Quality measures for social interactions"
* codes from system SocialInteractionQualityCS

ValueSet: SocialInteractionMediumVS
Id: social-interaction-medium-vs
Title: "Social Interaction Medium Value Set"
Description: "Mediums through which social interaction occurs"
* codes from system SocialInteractionMediumCS

CodeSystem: SocialInteractionTypeCS
Id: social-interaction-type-cs
Title: "Social Interaction Type Code System"
Description: "Types of social interactions"
* #family "Family Interaction" "Interaction with family members"
* #friends "Friend Interaction" "Interaction with friends"
* #professional "Professional Interaction" "Work-related interactions"
* #community "Community Interaction" "Community-based interactions"
* #group "Group Activity" "Organized group activities"
* #casual "Casual Interaction" "Casual social encounters"

CodeSystem: SocialInteractionQualityCS
Id: social-interaction-quality-cs
Title: "Social Interaction Quality Code System"
Description: "Quality measures for social interactions"
* #meaningful "Meaningful" "Deep, meaningful interaction"
* #supportive "Supportive" "Supportive interaction"
* #neutral "Neutral" "Neither positive nor negative"
* #superficial "Superficial" "Surface-level interaction"
* #stressful "Stressful" "Stressful or difficult interaction"

CodeSystem: SocialInteractionMediumCS
Id: social-interaction-medium-cs
Title: "Social Interaction Medium Code System"
Description: "Mediums through which social interaction occurs"
* #inPerson "In Person" "Face-to-face interaction"
* #video "Video Call" "Video-based interaction"
* #voice "Voice Call" "Voice-only interaction"
* #text "Text Based" "Text-based communication"
* #social "Social Media" "Social media interaction"
* #mixed "Mixed Medium" "Multiple communication methods"



// ===== Conteúdo de: MoodValueSet.fsh =====

ValueSet: MoodValueSet
Id: mood
Title: "Mood Value Set"
Description: "Value set for mood states"
* ^url = "https://github.com/RicardoLSantos/shorthand/fhir/ValueSet/mood"
* ^status = #active
* ^experimental = false

CodeSystem: MoodCodeSystem
Id: mood
Title: "Mood Code System"
Description: "Code system for mood states"
* ^url = "https://github.com/RicardoLSantos/shorthand/fhir/CodeSystem/mood"
* ^status = #active
* ^caseSensitive = true
* #elevated "Elevated" "Mood is higher than normal"
* #neutral "Neutral" "Neither elevated nor depressed mood"
* #depressed "Depressed" "Mood is lower than normal"
* #anxious "Anxious" "Feeling worried or nervous"
* #irritable "Irritable" "Easily annoyed or angered"
* #calm "Calm" "Feeling peaceful and relaxed"



// ===== Conteúdo de: EnvironmentalContextVS.fsh =====

ValueSet: EnvironmentalContextValueSet
Id: environmental-context
Title: "Environmental Context Value Set"
Description: "Valid contexts for environmental measurements"

* ^status = #active
* ^experimental = false
* ^url = "https://github.com/RicardoLSantos/shorthand/fhir/ValueSet/environmental-context"
* include codes from system https://github.com/RicardoLSantos/shorthand/fhir/CodeSystem/environmental-context



// ===== Conteúdo de: ActivityTypeVS.fsh =====

ValueSet: PhysicalActivityTypeVS
Id: physical-activity-type-vs
Title: "Physical Activity Types Value Set"
Description: "Types of physical activities from iOS Health App"

* ^status = #active

* $SNOMED#255604002 "Physical activity (observable entity)"
* $SNOMED#228557008 "Walking"
* $SNOMED#229058003 "Running"
* $SNOMED#266938001 "Swimming"
* $SNOMED#266940006 "Cycling"
* $SNOMED#32147004 "Regular exercise"



// ===== Conteúdo de: MindfulnessValueSets.fsh =====

ValueSet: EnvironmentTypeValueSet
Id: environment-type
Title: "Environment Type Value Set"
Description: "Value set for environmental context types"
* ^url = "https://github.com/RicardoLSantos/shorthand/fhir/ValueSet/environment-type"
* ^status = #active
* include codes from system https://github.com/RicardoLSantos/shorthand/fhir/CodeSystem/environment-type

ValueSet: MindfulnessTypeValueSet
Id: mindfulness-type
Title: "Mindfulness Type Value Set"
Description: "Value set for types of mindfulness practices"
* ^url = "https://github.com/RicardoLSantos/shorthand/fhir/ValueSet/mindfulness-type"
* ^status = #active
* include codes from system https://github.com/RicardoLSantos/shorthand/fhir/CodeSystem/mindfulness-type



// ===== Conteúdo de: BalanceStatusValueSet.fsh =====

ValueSet: BalanceStatusValueSet
Id: balance-status
Title: "Balance Status Value Set"
Description: "Value set for walking steadiness balance status"
* ^url = "https://github.com/RicardoLSantos/shorthand/fhir/ValueSet/balance-status"
* ^status = #active
* include codes from system https://github.com/RicardoLSantos/shorthand/fhir/CodeSystem/balance-status

CodeSystem: BalanceStatusCodeSystem
Id: balance-status
Title: "Balance Status Code System"
Description: "Code system for balance status types"
* ^url = "https://github.com/RicardoLSantos/shorthand/fhir/CodeSystem/balance-status"
* ^status = #active
* ^experimental = false
* ^caseSensitive = true
* #veryStable "Very Stable"
* #stable "Stable"
* #slightlyUnstable "Slightly Unstable"
* #unstable "Unstable"
* #veryUnstable "Very Unstable"



// ===== Conteúdo de: SleepQualityVS.fsh =====

ValueSet: SleepQualityVS
Id: sleep-quality-vs
Title: "Sleep Quality Value Set"
Description: "Qualitative assessments of sleep quality including subjective measures"
* ^status = #active
* ^experimental = false
* $SCT#248254009 "Quality of sleep (observable entity)"
* $SCT#248255005 "Sleeping well"
* $SCT#248256006 "Difficulty sleeping"
* $SCT#301345002 "Poor sleep pattern"
* $SCT#301346001 "Good sleep pattern"




// ===== Conteúdo de: FertilityValueSets.fsh =====

ValueSet: CervicalMucusValueSet
Id: cervical-mucus-valueset
Title: "Cervical Mucus Value Set"
Description: "Value set for cervical mucus observations"
* ^url = "https://github.com/RicardoLSantos/shorthand/fhir/ValueSet/cervical-mucus-vs"
* ^status = #active
* include codes from system https://github.com/RicardoLSantos/shorthand/fhir/CodeSystem/cervical-mucus-cs

CodeSystem: CervicalMucusCodeSystem
Id: cervical-mucus-cs
Title: "Cervical Mucus Code System"
* ^url = "https://github.com/RicardoLSantos/shorthand/fhir/CodeSystem/cervical-mucus-cs"
* ^status = #active
* ^caseSensitive = true
* #dry "Dry"
* #sticky "Sticky"
* #creamy "Creamy"
* #watery "Watery"
* #eggWhite "Egg White"

ValueSet: OvulationTestValueSet
Id: ovulation-test-valueset
Title: "Ovulation Test Value Set"
Description: "Value set for ovulation test results"
* ^url = "https://github.com/RicardoLSantos/shorthand/fhir/ValueSet/ovulation-test-vs"
* ^status = #active
* include codes from system https://github.com/RicardoLSantos/shorthand/fhir/CodeSystem/ovulation-test-cs

CodeSystem: OvulationTestCodeSystem
Id: ovulation-test-cs
Title: "Ovulation Test Code System"
* ^url = "https://github.com/RicardoLSantos/shorthand/fhir/CodeSystem/ovulation-test-cs"
* ^status = #active
* ^caseSensitive = true
* #negative "Negative"
* #positive "Positive"
* #invalid "Invalid Test"

ValueSet: FertilityStatusValueSet
Id: fertility-status-valueset
Title: "Fertility Status Value Set"
Description: "Value set for fertility status"
* ^url = "https://github.com/RicardoLSantos/shorthand/fhir/ValueSet/fertility-status-vs"
* ^status = #active
* include codes from system https://github.com/RicardoLSantos/shorthand/fhir/CodeSystem/fertility-status-cs

CodeSystem: FertilityStatusCodeSystem
Id: fertility-status-cs
Title: "Fertility Status Code System"
* ^url = "https://github.com/RicardoLSantos/shorthand/fhir/CodeSystem/fertility-status-cs"
* ^status = #active
* ^caseSensitive = true
* #fertile "Fertile"
* #notFertile "Not Fertile"
* #uncertain "Uncertain"



// ===== Conteúdo de: MindfulnessSearchParameters.fsh =====

Instance: MindfulnessType
InstanceOf: SearchParameter
Usage: #definition
* status = #active
* code = #mindfulness-type
* name = "MindfulnessType"
* description = "Search for mindfulness observations by practice type"
* base = #Observation
* type = #token
* expression = "Observation.component.where(code.coding.where(system='http://snomed.info/sct' and code='711020003')).value.as(CodeableConcept)"
* xpath = "f:Observation/f:component[f:code/f:coding[f:system/@value='http://snomed.info/sct' and f:code/f:coding/f:code/@value='711020003']]/f:valueCodeableConcept"
* xpathUsage = #normal



// ===== Conteúdo de: MindfulnessAlerts.fsh =====

Extension: AlertTiming
Id: alert-timing
Title: "Alert Timing Extension"
Description: "Defines when alerts should be triggered"
* value[x] only Timing
* valueTiming.repeat 1..1 MS
* valueTiming.repeat.frequency MS
* valueTiming.repeat.period MS
* valueTiming.repeat.periodUnit MS

Extension: AlertMessage
Id: alert-message
Title: "Alert Message Extension"
Description: "Defines the alert message content"
* value[x] only string

Profile: MindfulnessAlert
Parent: Basic
Id: mindfulness-alert
Title: "Mindfulness Alert"
Description: "Alert configuration for mindfulness sessions"

* code 1..1 MS
* code = https://github.com/RicardoLSantos/shorthand/CodeSystem/mindfulness-alert-type#reminder "Mindfulness Reminder"

* extension contains
    alert-timing named alertTiming 0..1 MS and
    alert-message named alertMessage 1..1 MS

Instance: DailyMindfulnessAlert
InstanceOf: MindfulnessAlert
Title: "Daily Mindfulness Alert" 
Description: "Example of a daily mindfulness alert configuration"

* code = https://github.com/RicardoLSantos/shorthand/CodeSystem/mindfulness-alert-type#reminder "Mindfulness Reminder"
* extension[alertTiming].valueTiming.repeat
  * frequency = 1
  * period = 1
  * periodUnit = #d
* extension[alertMessage].valueString = "Time for your daily mindfulness practice"



// ===== Conteúdo de: MindfulnessTransforms.fsh =====

Instance: MindfulnessHealthKitTransform
InstanceOf: StructureMap
Usage: #definition
Title: "HealthKit to FHIR Mindfulness Transform"

* status = #draft
* name = "MindfulnessHealthKitTransform"
* structure[0]
  * url = "https://github.com/RicardoLSantos/shorthand/StructureDefinition/healthkit-mindfulness"
  * mode = #source
  * documentation = "HealthKit mindfulness session structure"

* structure[1]
  * url = "http://hl7.org/fhir/StructureDefinition/Observation"
  * mode = #target
  * documentation = "FHIR Observation resource"

* group[0]
  * name = "MindfulnessSessionToObservation"
  * typeMode = #none
  * input[0]
    * name = "source"
    * type = "HealthKitMindfulness"
    * mode = #source
  * input[1]
    * name = "target"
    * type = "Observation"
    * mode = #target
  * rule[0]
    * name = "Session"
    * source[0]
      * context = "source"
      * element = "startDate"
    * target[0]
      * context = "target"
      * element = "effectiveDateTime"
  * rule[1]
    * name = "Duration"
    * source[0]
      * context = "source"
      * element = "duration"
    * target[0]
      * context = "target"
      * element = "component.where(code.coding.code='118682006').valueQuantity"

Instance: MindfulnessCSVTransform
InstanceOf: StructureMap
Usage: #definition
Title: "CSV to FHIR Mindfulness Transform"

* status = #draft
* name = "MindfulnessCSVTransform"
* structure[0]
  * url = "https://github.com/RicardoLSantos/shorthand/StructureDefinition/csv-mindfulness"
  * mode = #source
  * documentation = "CSV mindfulness data structure"

* group[0]
  * name = "CSVToMindfulnessObservation"
  * typeMode = #none
  * input[0]
    * name = "source"
    * type = "CSVMindfulness"
    * mode = #source
  * input[1]
    * name = "target"
    * type = "Observation"
    * mode = #target
  * rule[0]
    * name = "MapDatetime"
    * source[0]
      * context = "source"
      * element = "date,time"
    * target[0]
      * context = "target"
      * element = "effectiveDateTime"
      * transform = #append

RuleSet: TransformValidationRules
* rule[+]
  * name = "ValidateStatus"
  * source[0]
    * context = "target"
    * element = "status"
  * assert[0]
    * description = "Status must be final"
    * expression = "%status = 'final'"

* rule[+]
  * name = "ValidateCode"
  * source[0]
    * context = "target"
    * element = "code"
  * assert[0]
    * description = "Must use SNOMED CT code"
    * expression = "%code.system = 'http://snomed.info/sct'"



// ===== Conteúdo de: MindfulnessAudit.fsh =====

Extension: AuditLevelExtension
Id: audit-level
Title: "Audit Level Extension"
Description: "Level of detail for audit records"
* value[x] only code
* valueCode from https://github.com/RicardoLSantos/shorthand/fhir/ValueSet/audit-levels (required)

Extension: AuditRetentionExtension
Id: audit-retention
Title: "Audit Retention Extension" 
Description: "Period to retain audit records"
* value[x] only Duration

Extension: AuditFormatExtension
Id: audit-format
Title: "Audit Format Extension"
Description: "Format for audit records"
* value[x] only code
* valueCode from https://github.com/RicardoLSantos/shorthand/fhir/ValueSet/audit-formats (required)

Profile: MindfulnessAudit
Parent: Basic
Id: mindfulness-audit
Title: "Mindfulness Audit"
Description: "Audit record for mindfulness sessions"

* code 1..1 MS
* code = https://github.com/RicardoLSantos/shorthand/CodeSystem/mindfulness-audit-type#session "Session Audit"
* created 1..1 MS

* extension contains
    audit-level named auditLevel 1..1 MS and
    audit-retention named auditRetention 1..1 MS and
    audit-format named auditFormat 1..1 MS

Instance: MindfulnessAuditExample
InstanceOf: MindfulnessAudit
Title: "Example Mindfulness Audit"
Description: "Example of a mindfulness session audit record"

* code = https://github.com/RicardoLSantos/shorthand/CodeSystem/mindfulness-audit-type#session "Session Audit"
* created = "2024-03-15"
* extension[auditLevel].valueCode = #detailed
* extension[auditRetention].valueDuration = 90 'days'
* extension[auditFormat].valueCode = #fhir



// ===== Conteúdo de: EnvironmentalExamples.fsh =====

Instance: NoiseExposureExample
InstanceOf: NoiseExposureObservation
Usage: #example
Title: "Noise Exposure Measurement Example"
Description: "Example of noise exposure measurement from iOS Health App"

* meta.security = http://terminology.hl7.org/CodeSystem/v3-Confidentiality#N
* status = #final
* category = http://terminology.hl7.org/CodeSystem/observation-category#environment
* code = $LOINC#28573-7 "Noise exposure time"
* subject = Reference(Patient/example)
* effectiveDateTime = "2024-03-19T15:30:00Z"
* device = Reference(Device/iphone-example)
* method = http://snomed.info/sct#37016008 "Automatic measurement"

* component[level]
  * code.coding[0] = $LOINC#89020-2 "Environmental noise average"
  * valueQuantity = 85 'dB'
  * interpretation = http://terminology.hl7.org/CodeSystem/v3-ObservationInterpretation#H "High"

* component[duration]
  * code.coding[0] = $LOINC#89021-0 "Environmental noise duration"
  * valueQuantity = 120 'min'

* component[peakLevel]
  * code.coding[0] = $LOINC#89024-4 "Peak sound level"
  * valueQuantity = 95 'dB'

* component[backgroundNoise]
  * code.coding[0] = $LOINC#89025-1 "Background noise level"
  * valueQuantity = 45 'dB'

* note.text = "Measurement taken during urban commute"

Instance: UVExposureExample
InstanceOf: UVExposureObservation
Usage: #example
Title: "UV Exposure Measurement Example"
Description: "Example of UV exposure measurement from iOS Health App"

* meta.security = http://terminology.hl7.org/CodeSystem/v3-Confidentiality#N
* status = #final
* category = http://terminology.hl7.org/CodeSystem/observation-category#environment
* code = $LOINC#28574-5 "UV exposure"
* subject = Reference(Patient/example)
* effectiveDateTime = "2024-03-19T12:00:00Z"
* device = Reference(Device/iphone-example)
* method = http://snomed.info/sct#37016008 "Automatic measurement"

* component[index]
  * code.coding[0] = $LOINC#89022-8 "UV index"
  * valueQuantity = 8 '{index}'
  * interpretation = http://terminology.hl7.org/CodeSystem/v3-ObservationInterpretation#H "High"

* component[duration]
  * code.coding[0] = $LOINC#89023-6 "UV exposure duration"
  * valueQuantity = 45 'min'

* component[timeOfDay]
  * code.coding[0] = $LOINC#89026-9 "Time of exposure"
  * valueDateTime = "2024-03-19T12:00:00Z"

* component[intensity]
  * code.coding[0] = $LOINC#89027-7 "UV intensity"
  * valueQuantity = 0.3 'W/m2'

* note.text = "Measurement taken during outdoor activity"

Instance: EnvironmentalDeviceExample
InstanceOf: Device
Usage: #example
Title: "Environmental Monitoring Device"
Description: "Example of iOS device used for environmental monitoring"

* identifier.system = "https://github.com/RicardoLSantos/shorthand/devices"
* identifier.value = "iPhone-ENV-001"
* manufacturer = "Apple Inc."
* modelNumber = "iPhone 15 Pro"
* type = $SCT#706689003 "Environmental monitoring device"
* status = #active



// ===== Conteúdo de: NutritionExamples.fsh =====

Instance: NutritionQuestionnaireResponseExample
InstanceOf: QuestionnaireResponse
Usage: #example
Title: "Daily Nutrition Questionnaire Response Example"

* questionnaire = "https://github.com/RicardoLSantos/shorthand/Questionnaire/daily-nutrition"
* status = #completed
* subject = Reference(Patient/PatientExample)
* authored = "2024-12-14T20:00:00Z"

* item[0]
  * linkId = "water_intake"
  * answer.valueQuantity = 2000 'mL'

* item[1]
  * linkId = "meal_record"

  * item[0]
    * linkId = "meal_time"
    * answer.valueDateTime = "2024-12-14T12:00:00Z"

  * item[1]
    * linkId = "meal_type"
    * answer.valueString = "Lunch"

  * item[2]
    * linkId = "calories"
    * answer.valueInteger = 650

  * item[3]
    * linkId = "macronutrients"
   
    * item[0]
      * linkId = "carbs"
      * answer.valueDecimal = 75
   
    * item[1]
      * linkId = "protein"
      * answer.valueDecimal = 30
   
    * item[2]
      * linkId = "fat"
      * answer.valueDecimal = 25

* item[2]
  * linkId = "caffeine"

  * item[0]
    * linkId = "caffeine_amount"
    * answer.valueInteger = 80

  * item[1]
    * linkId = "caffeine_source"
    * answer.valueString = "Coffee"



// ===== Conteúdo de: SleepExamples.fsh =====

Instance: SleepObservationExample1
InstanceOf: SleepObservation
Usage: #example
Title: "Example of Sleep Record"
Description: "Example of nightly sleep data from iOS Health App"
 
* status = #final
* category = http://terminology.hl7.org/CodeSystem/observation-category#sleep
* code = $LOINC#93832-4 "Sleep pattern panel"
* subject = Reference(PatientExample)
* effectivePeriod.start = "2024-03-19T22:00:00Z"
* effectivePeriod.end = "2024-03-20T06:30:00Z"
* device = Reference(DeviceSleepMonitor)
 
* component[timeInBed].code = $LOINC#93831-6 "Time in bed"
* component[timeInBed].valueQuantity = 510 'min' "minute"
* component[timeInBed].valueQuantity.system = $UCUM
* component[timeInBed].valueQuantity.unit = "minute"
 
* component[totalSleepTime].code = $LOINC#93833-2 "Sleep duration"
* component[totalSleepTime].valueQuantity = 472 'min' "minute"
* component[totalSleepTime].valueQuantity.system = $UCUM
* component[totalSleepTime].valueQuantity.unit = "minute"
 
* component[deepSleep].code = $LOINC#93834-0 "Deep sleep duration"
* component[deepSleep].valueQuantity = 95 'min' "minute"
* component[deepSleep].valueQuantity.system = $UCUM
* component[deepSleep].valueQuantity.unit = "minute"
 
* component[remSleep].code = $LOINC#93835-7 "REM sleep duration"
* component[remSleep].valueQuantity = 118 'min' "minute"
* component[remSleep].valueQuantity.system = $UCUM
* component[remSleep].valueQuantity.unit = "minute"
 
* component[lightSleep].code = $LOINC#93836-5 "Light sleep duration"
* component[lightSleep].valueQuantity = 259 'min' "minute"
* component[lightSleep].valueQuantity.system = $UCUM
* component[lightSleep].valueQuantity.unit = "minute"
 
* component[respiratoryRate].code = $LOINC#9279-1 "Respiratory rate"
* component[respiratoryRate].valueQuantity = 14 '/min' "per minute"
* component[respiratoryRate].valueQuantity.system = $UCUM
* component[respiratoryRate].valueQuantity.unit = "per minute"
 
* component[heartRateVariability].code = $LOINC#80404-7 "R-R interval.standard deviation (Heart rate variability)"
* component[heartRateVariability].valueQuantity = 45 'ms' "millisecond"
* component[heartRateVariability].valueQuantity.system = $UCUM
* component[heartRateVariability].valueQuantity.unit = "millisecond"
 
* component[interruptions].code = $LOINC#93837-3 "Number of awakenings during sleep"
* component[interruptions].valueQuantity = 3 '{count}' "count"
* component[interruptions].valueQuantity.system = $UCUM
* component[interruptions].valueQuantity.unit = "count"

Instance: DeviceSleepMonitor
InstanceOf: Device
Usage: #example
Title: "Sleep Monitoring Device"
* deviceName.name = "Sleep Quality Monitor"
* deviceName.type = #user-friendly-name
* manufacturer = "HealthTech Devices"
* modelNumber = "SQM-2024"
* type = $SCT#706172001 "Sleep monitor"



// ===== Conteúdo de: StressExamples.fsh =====

Instance: StressLevelExample
InstanceOf: StressLevelProfile
Usage: #example
Title: "Stress Level Measurement Example"

* status = #final
* category = http://terminology.hl7.org/CodeSystem/observation-category#vital-signs
* code = $LOINC#89592-0 "Stress level score"
* subject = Reference(Patient/example)
* effectiveDateTime = "2024-01-03T15:30:00Z"
* valueQuantity = 7 '{score}' "score"

* component[physiologicalStress].valueQuantity = 6 '{score}' "score"
* component[psychologicalStress].valueQuantity = 8 '{score}' "score"
* component[chronicity].valueCodeableConcept = StressChronicityCS#subacute
* component[impact].valueCodeableConcept = StressImpactCS#moderate

* extension[triggers].valueCodeableConcept = StressTriggersCS#work
* extension[coping].valueCodeableConcept = StressCopingCS#meditation



// ===== Conteúdo de: PatientExample.fsh =====

Instance: PatientExample
InstanceOf: Patient
Usage: #example
* identifier[0].system = "urn:oid:2.16.858.1.1.1"
* identifier[0].value = "12345"
* name.given = "John"
* name.family = "Doe"
* gender = #male
* birthDate = "1970-01-01"



// ===== Conteúdo de: MobilityExamples.fsh =====

Profile: WalkingSteadinessObservation
Parent: MobilityProfile
Id: walking-steadiness-observation
Title: "Walking Steadiness Observation Profile"
Description: "Profile for walking steadiness measurements from iPhone Motion Sensors"

* code = $LOINC#LA32-8 "Balance"
* component contains
    balanceScore 0..1 MS and
    balanceStatus 0..1 MS

* component[balanceScore]
  * code = $LOINC#LA32-8 "Balance score"
  * valueQuantity.system = $UCUM
  * valueQuantity.code = #%

* component[balanceStatus]
  * code = $LOINC#LA32-9 "Balance status"
  * valueCodeableConcept from https://github.com/RicardoLSantos/shorthand/fhir/ValueSet/balance-status (required)

Profile: WalkingSpeedObservation
Parent: MobilityProfile
Id: walking-speed-observation
Title: "Walking Speed Observation Profile"
Description: "Profile for walking speed measurements from iPhone Motion Sensors"

* code = $LOINC#LA29042-4 "Walking speed"
* component contains
    speed 0..1 MS and
    distance 0..1 MS

* component[speed]
  * code = $LOINC#LA29042-4 "Walking speed measurement"
  * valueQuantity.system = $UCUM
  * valueQuantity.code = #m/s

* component[distance]
  * code = $LOINC#LA29043-2 "Walking distance"
  * valueQuantity.system = $UCUM
  * valueQuantity.code = #m

Instance: WalkingSteadinessExample
InstanceOf: WalkingSteadinessObservation
Usage: #example
Title: "Walking Steadiness Measurement Example"
Description: "Example of walking steadiness measurement from iPhone Motion Sensors"

* status = #final
* category = http://terminology.hl7.org/CodeSystem/observation-category#activity
* code = $LOINC#LA32-8 "Balance"
* subject = Reference(Patient/example)
* effectiveDateTime = "2024-03-19T15:30:00Z"
* valueQuantity = 85 '1' "score"
* device = Reference(Device/iphone-example)

* component[balanceScore].valueQuantity = 85 '%' "percent"
* component[balanceStatus].valueCodeableConcept = $LOINC#LA32-10 "OK"

Instance: WalkingSpeedExample
InstanceOf: WalkingSpeedObservation
Usage: #example
Title: "Walking Speed Measurement Example"
Description: "Example of walking speed measurement from iPhone Motion Sensors"

* status = #final
* category = http://terminology.hl7.org/CodeSystem/observation-category#activity
* code = $LOINC#LA29042-4 "Walking speed"
* subject = Reference(Patient/example)
* effectiveDateTime = "2024-03-19T15:30:00Z"
* valueQuantity = 1.2 'm/s' "meters per second"
* device = Reference(Device/iphone-example)

* component[speed].valueQuantity = 1.2 'm/s' "meters per second"
* component[distance].valueQuantity = 10 'm' "meters"



// ===== Conteúdo de: PhysicalActivityExamples.fsh =====

Instance: PhysicalActivityExample1
InstanceOf: PhysicalActivityObservation
Usage: #example
Title: "Example of Walking Activity"
Description: "Example of walking activity data from iOS Health App"
* status = #final
* category = http://terminology.hl7.org/CodeSystem/observation-category#activity
* code = $SNOMED#228557008 "Walking"
* subject = Reference(PatientExample)
* effectiveDateTime = "2024-03-19T15:30:00Z"
* device = Reference(DeviceActivityTracker)
* component[steps].code = $LOINC#55423-8 "Number of steps in 24 hour Measured"
* component[steps].valueQuantity = 8546 '1' "count"
* component[steps].valueQuantity.system = $UCUM
* component[steps].valueQuantity.unit = "count"
* component[distance].code = $LOINC#55430-3 "Distance walked"
* component[distance].valueQuantity = 6.2 'km' "kilometer"
* component[distance].valueQuantity.system = $UCUM
* component[distance].valueQuantity.unit = "kilometer"
* component[duration].code = $LOINC#55411-3 "Exercise duration"
* component[duration].valueQuantity = 72 'min' "minute"
* component[duration].valueQuantity.system = $UCUM
* component[duration].valueQuantity.unit = "minute"
* component[energy].code = $LOINC#55424-6 "Energy expenditure"
* component[energy].valueQuantity = 320 'kcal' "kilocalorie"
* component[energy].valueQuantity.system = $UCUM
* component[energy].valueQuantity.unit = "kilocalorie"

Instance: DeviceActivityTracker
InstanceOf: Device
Usage: #example
Title: "Activity Tracking Device"
* deviceName.name = "Health Activity Tracker"
* deviceName.type = #user-friendly-name
* manufacturer = "HealthTech Devices"
* modelNumber = "HAT-2024"
* type = $SCT#258158006 "Activity monitor"



// ===== Conteúdo de: BodyMetricsExamples.fsh =====

Instance: WeightExample
InstanceOf: WeightObservation
Usage: #example
Title: "Weight Measurement Example"
Description: "Example of a weight measurement from a smart scale"
* status = #final
* category = http://terminology.hl7.org/CodeSystem/observation-category#vital-signs
* code = $LOINC#29463-7 "Body weight"
* subject = Reference(PatientExample)
* performer = Reference(PractitionerExample)
* effectiveDateTime = "2024-03-19T08:00:00Z"
* valueQuantity = 70.5 'kg' "kilogram"
* valueQuantity.system = $UCUM
* valueQuantity.unit = "kilogram"
* device = Reference(SmartScale)

Instance: HeightExample
InstanceOf: HeightObservation
Usage: #example
Title: "Height Measurement Example"
Description: "Example of a height measurement"
* status = #final
* category = http://terminology.hl7.org/CodeSystem/observation-category#vital-signs
* code = $LOINC#8302-2 "Body height"
* subject = Reference(PatientExample)
* performer = Reference(PractitionerExample)
* effectiveDateTime = "2024-03-19T08:00:00Z"
* valueQuantity = 175 'cm' "centimeter"
* valueQuantity.system = $UCUM
* valueQuantity.unit = "centimeter"

Instance: BMIExample
InstanceOf: BMIObservation
Usage: #example
Title: "BMI Calculation Example"
Description: "Example of a BMI calculation based on weight and height measurements"
* status = #final
* category = http://terminology.hl7.org/CodeSystem/observation-category#vital-signs
* code = $LOINC#39156-5 "Body mass index (BMI)"
* subject = Reference(PatientExample)
* performer = Reference(PractitionerExample)
* effectiveDateTime = "2024-03-19T08:00:00Z"
* valueQuantity = 23.0 'kg/m2' "kilogram per square meter"
* valueQuantity.system = $UCUM
* valueQuantity.unit = "kilogram per square meter"
* derivedFrom[0] = Reference(Observation/WeightExample)
* derivedFrom[1] = Reference(Observation/HeightExample)

Instance: BodyCompositionExample
InstanceOf: BodyCompositionObservation
Usage: #example
Title: "Body Composition Measurement Example" 
Description: "Example of comprehensive body composition measurements from a bioimpedance device"
* status = #final
* category = http://terminology.hl7.org/CodeSystem/observation-category#vital-signs
* code = $LOINC#88365-2 "Body composition panel"
* subject = Reference(PatientExample)
* performer = Reference(PractitionerExample)
* effectiveDateTime = "2024-03-19T08:00:00Z"
* device = Reference(BioimpedanceAnalyzer)

* component[bodyFat].code = $LOINC#41982-0 "Percentage body fat"
* component[bodyFat].valueQuantity = 22.5 '%' "percent"
* component[bodyFat].valueQuantity.system = $UCUM
* component[bodyFat].valueQuantity.unit = "percent"

* component[leanMass].code = $LOINC#291-7 "Lean body mass"
* component[leanMass].valueQuantity = 54.6 'kg' "kilogram"
* component[leanMass].valueQuantity.system = $UCUM
* component[leanMass].valueQuantity.unit = "kilogram"

* component[bodyWater].code = $LOINC#73708-0 "Total body water"
* component[bodyWater].valueQuantity = 39.2 'L' "liter"
* component[bodyWater].valueQuantity.system = $UCUM
* component[bodyWater].valueQuantity.unit = "liter"

* component[muscleMass].code = $LOINC#73713-0 "Muscle mass"
* component[muscleMass].valueQuantity = 51.8 'kg' "kilogram"
* component[muscleMass].valueQuantity.system = $UCUM
* component[muscleMass].valueQuantity.unit = "kilogram"

* component[boneMass].code = $LOINC#73711-4 "Bone mass"
* component[boneMass].valueQuantity = 2.8 'kg' "kilogram"
* component[boneMass].valueQuantity.system = $UCUM
* component[boneMass].valueQuantity.unit = "kilogram"

Instance: SmartScale
InstanceOf: Device
Usage: #example
Title: "Smart Scale Device"
* deviceName.name = "Smart Body Analyzer"
* deviceName.type = #user-friendly-name
* manufacturer = "HealthTech Devices"
* modelNumber = "SBA-2024"
* type = $SCT#469576000 "Digital scale device"

Instance: BioimpedanceAnalyzer  
InstanceOf: Device
Usage: #example
Title: "Bioimpedance Analyzer Device"
* deviceName.name = "Professional Body Composition Analyzer"
* deviceName.type = #user-friendly-name
* manufacturer = "MedTech Solutions"
* modelNumber = "BCA-Pro"
* type = $SCT#706767009 "Body composition analyzer"



// ===== Conteúdo de: SymptomExamples.fsh =====

Instance: ChronicSymptomExample
InstanceOf: Observation
Usage: #example
* status = #final
* category = http://terminology.hl7.org/CodeSystem/observation-category#survey
* code = $SCT#267036007 "Fatigue"
* subject = Reference(Patient/example)
* performer = Reference(Practitioner/practitioner-example)
* effectiveDateTime = "2024-03-19T14:00:00Z"
// ... resto do exemplo ...

Instance: ExampleSymptomSeverity
InstanceOf: Observation
Usage: #example
* status = #final
* category = http://terminology.hl7.org/CodeSystem/observation-category#survey
* code = $SCT#246604007 "Symptom severity"
* subject = Reference(Patient/example)
* performer = Reference(Practitioner/practitioner-example)
* effectiveDateTime = "2024-03-19T10:30:00Z"
// ... resto do exemplo ...



// ===== Conteúdo de: SocialInteractionExamples.fsh =====

Instance: SocialInteractionExample
InstanceOf: SocialInteractionProfile
Usage: #example
Title: "Social Interaction Example"

* status = #final
* category = http://terminology.hl7.org/CodeSystem/observation-category#social-history
* code = $LOINC#96766-1 "Social interaction pattern"
* subject = Reference(Patient/example)
* effectiveDateTime = "2024-01-03T14:00:00Z"
* valueCodeableConcept = SocialInteractionTypeCS#family

* component[duration].valueQuantity = 120 'min' "minutes"
* component[quality].valueCodeableConcept = SocialInteractionQualityCS#meaningful
* component[medium].valueCodeableConcept = SocialInteractionMediumCS#inPerson
* component[participants].valueInteger = 4

* extension[context].valueCodeableConcept = SocialContextCS#home
* extension[support].valueCodeableConcept = SocialSupportCS#strong
* extension[activity].valueCodeableConcept = SocialActivityCS#meal



// ===== Conteúdo de: VitalSignsExamples.fsh =====

Instance: HeartRateExample
InstanceOf: HeartRateObservation
Usage: #example
Title: "Heart Rate Measurement Example"
* status = #final
* code = $LOINC#8867-4 "Heart rate"
* subject = Reference(PatientExample)
* effectiveDateTime = "2024-03-19T15:30:00Z"
* valueQuantity = 72 '/min' "per minute"
* valueQuantity.system = $UCUM
* valueQuantity.unit = "per minute"
* device = Reference(DeviceHeartRateMonitor)
* performer = Reference(PractitionerExample)
* component[heartRateVariability].code = $LOINC#80404-7 "R-R interval.standard deviation (Heart rate variability)"
* component[heartRateVariability].valueQuantity = 45 'ms' "millisecond"
* component[heartRateVariability].valueQuantity.system = $UCUM
* component[heartRateVariability].valueQuantity.unit = "millisecond"

Instance: BloodPressureExample
InstanceOf: BloodPressureObservation
Usage: #example
Title: "Blood Pressure Measurement Example"
* status = #final
* code = $LOINC#85354-9 "Blood pressure panel with all children optional"
* subject = Reference(PatientExample)
* effectiveDateTime = "2024-03-19T15:30:00Z"
* device = Reference(DeviceBloodPressureMonitor)
* performer = Reference(PractitionerExample)
* component[systolic].code = $LOINC#8480-6 "Systolic blood pressure"
* component[systolic].valueQuantity = 120 'mm[Hg]' "millimeter of mercury"
* component[systolic].valueQuantity.system = $UCUM
* component[systolic].valueQuantity.unit = "millimeter of mercury"
* component[diastolic].code = $LOINC#8462-4 "Diastolic blood pressure"
* component[diastolic].valueQuantity = 80 'mm[Hg]' "millimeter of mercury"
* component[diastolic].valueQuantity.system = $UCUM
* component[diastolic].valueQuantity.unit = "millimeter of mercury"

Instance: DeviceHeartRateMonitor
InstanceOf: Device
Usage: #example
Title: "Heart Rate Monitor Device"
* deviceName.name = "Continuous Heart Rate Monitor"
* deviceName.type = #user-friendly-name
* manufacturer = "HealthTech Devices"
* modelNumber = "HRM-2024"
* type = $SCT#720737000 "Pulse rate monitoring device"

Instance: DeviceBloodPressureMonitor
InstanceOf: Device
Usage: #example
Title: "Blood Pressure Monitor Device"
* deviceName.name = "Digital Blood Pressure Monitor"
* deviceName.type = #user-friendly-name
* manufacturer = "HealthTech Devices"
* modelNumber = "BPM-2024"
* type = $SCT#43770009 "Blood pressure monitor"



// ===== Conteúdo de: PractitionerExample.fsh =====

Instance: PractitionerExample
InstanceOf: Practitioner
Usage: #example
* identifier[0].system = "http://hl7.org/fhir/sid/us-npi"
* identifier[0].value = "9941339108"
* name.given = "Jane"
* name.family = "Smith"



// ===== Conteúdo de: MindfulnessCompleteExamples.fsh =====

Instance: CompleteMindfulnessSession
InstanceOf: MindfulnessObservation
Usage: #example
Title: "Complete Mindfulness Session Example"

* status = #final
* code = $SCT#711020003 "Meditation"
* subject = Reference(Patient/PatientExample)
* effectiveDateTime = "2024-03-19T08:00:00Z"
* performer = Reference(Practitioner/practitioner-example)

* component[sessionDuration].code = $SCT#118682006 "Duration"
* component[sessionDuration].valueQuantity = 20 'min'

* component[stressLevel].code = $SCT#725854004 "Assessment of stress level"
* component[stressLevel].valueInteger = 3

* component[moodState].code = $SCT#373931001 "Mood finding"
* component[moodState].valueCodeableConcept = $SCT#130991005 "Neutral mood"

* component[relaxationResponse].code = $SCT#276241001 "Relaxation technique"
* component[relaxationResponse].valueString = "Deep breathing exercises with progressive relaxation"

* component[mindfulnessType].code = $SCT#711020003 "Meditation"
* component[mindfulnessType].valueCodeableConcept = $SCT#711020003 "Meditation"

* extension[mindfulness-context].extension[location].valueString = "Home meditation room"
* extension[mindfulness-context].extension[environment].valueCodeableConcept = #quiet "Quiet Space"
* extension[mindfulness-context].extension[guidance].valueBoolean = true

Instance: CompleteMindfulnessResponse
InstanceOf: QuestionnaireResponse
Usage: #example
Title: "Complete Mindfulness Session Response"

* questionnaire = "https://github.com/RicardoLSantos/shorthand/Questionnaire/daily-mindfulness"
* status = #completed
* subject = Reference(Patient/PatientExample)
* authored = "2024-03-19T08:30:00Z"

* item[0]
  * linkId = "mindful_session"
  * item[0]
    * linkId = "session_duration"
    * answer.valueInteger = 20
  * item[1]
    * linkId = "practice_type"
    * answer.valueString = "Meditation"

* item[1]
  * linkId = "mood_assessment"
  * item[0]
    * linkId = "current_mood"
    * answer.valueCoding = $SCT#130991005 "Neutral mood"
  * item[1]
    * linkId = "mood_intensity"
    * answer.valueInteger = 3

* item[2]
  * linkId = "stress_assessment"
  * item[0]
    * linkId = "stress_level"
    * answer.valueInteger = 3
  * item[1]
    * linkId = "stress_symptoms"
    * answer[0].valueString = "Slight tension"

* item[3]
  * linkId = "relaxation"
  * item[0]
    * linkId = "relaxation_duration"
    * answer.valueInteger = 15
  * item[1]
    * linkId = "relaxation_technique"
    * answer.valueString = "Deep breathing"



// ===== Conteúdo de: MindfulnessExamples.fsh =====

Instance: MindfulnessObservationExample
InstanceOf: MindfulnessObservation
Usage: #example
Title: "Example of Mindfulness Session Observation"

* status = #final
* code = $SCT#711020003 "Meditation"
* subject = Reference(Patient/PatientExample)
* effectiveDateTime = "2024-03-19T09:30:00Z"
* performer = Reference(Practitioner/practitioner-example)

* component[sessionDuration].code = $SCT#118682006 "Duration"
* component[sessionDuration].valueQuantity = 20 'min'

* component[stressLevel].code = $SCT#725854004 "Assessment of stress level"
* component[stressLevel].valueInteger = 4

* component[moodState].code = $SCT#373931001 "Mood finding"
* component[moodState].valueCodeableConcept = $SCT#130991005 "Neutral mood"

* component[relaxationResponse].code = $SCT#276241001 "Relaxation technique"
* component[relaxationResponse].valueString = "Deep breathing exercises helped reduce tension"

* component[mindfulnessType].code = $SCT#711020003 "Meditation"
* component[mindfulnessType].valueCodeableConcept = $SCT#711020003 "Meditation"

// New example for MindfulnessQuestionnaire
Instance: MindfulnessQuestionnaireExample
InstanceOf: Questionnaire
Usage: #example
Title: "Example of Mindfulness Questionnaire"

* url = "https://github.com/RicardoLSantos/shorthand/Questionnaire/mindfulness-example"
* status = #active
* title = "Daily Mindfulness Assessment"
* version = "1.0"
* name = "MindfulnessQuestionnaireExample"
* date = "2024-03-19"
* publisher = "Example Organization"
* description = "Example questionnaire for daily mindfulness practice assessment"

* item[0]
  * linkId = "session_details"
  * text = "Session Details"
  * type = #group
  
  * item[0]
    * linkId = "duration"
    * text = "Duration (minutes)"
    * type = #integer
    * required = true
    
  * item[1]
    * linkId = "technique"
    * text = "Technique Used"
    * type = #choice
    * required = true
    * answerOption[0].valueString = "Mindful Breathing"
    * answerOption[1].valueString = "Body Scan"
    * answerOption[2].valueString = "Walking Meditation"



// ===== Conteúdo de: ReproductiveExamples.fsh =====

Instance: ExampleReproductiveActivity
InstanceOf: CarePlan
Usage: #example
* status = #active
* intent = #plan
* subject = Reference(Patient/example)
* activity.detail.kind = #Observation
* activity.detail.code = ReproductiveActivityCS#cycle-tracking
* activity.detail.status = #scheduled



// ===== Conteúdo de: MindfulnessWorkflow.fsh =====

Profile: MindfulnessSchedule
Parent: Basic
Id: mindfulness-schedule
Title: "Mindfulness Schedule"
Description: "Schedule configuration for mindfulness sessions"

* code 1..1 MS
* code = https://github.com/RicardoLSantos/shorthand/CodeSystem/mindfulness-schedule-type#recurring "Recurring Schedule"

Extension: MindfulnessScheduleTiming
Id: mindfulness-schedule-timing
Title: "Mindfulness Schedule Timing"
Description: "Timing configuration for mindfulness sessions"
* value[x] only Timing

Instance: WeeklyMindfulnessSchedule
InstanceOf: MindfulnessSchedule
Title: "Weekly Mindfulness Schedule"
Description: "Example of a weekly mindfulness schedule"

* code = https://github.com/RicardoLSantos/shorthand/CodeSystem/mindfulness-schedule-type#recurring "Recurring Schedule"
* extension[mindfulness-schedule-timing].valueTiming.repeat.frequency = 1
* extension[mindfulness-schedule-timing].valueTiming.repeat.period = 1
* extension[mindfulness-schedule-timing].valueTiming.repeat.periodUnit = #wk
* extension[mindfulness-schedule-timing].valueTiming.repeat.dayOfWeek = #mon
* extension[mindfulness-schedule-timing].valueTiming.repeat.dayOfWeek[+] = #wed
* extension[mindfulness-schedule-timing].valueTiming.repeat.dayOfWeek[+] = #fri



// ===== Conteúdo de: MindfulnessRules.fsh =====

RuleSet: MindfulnessValidation
* ^extension[0].url = "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice"
* ^extension[0].valueBoolean = true

* status MS
* code MS
* subject MS
* effective[x] MS
* value[x] MS
* component MS

* status from http://hl7.org/fhir/ValueSet/observation-status
* code from http://snomed.info/sct?fhir_vs=isa/711020003
* subject only Reference(Patient)
* effective[x] only dateTime

* obeys mindfulness-session-duration
* obeys mindfulness-stress-level
* obeys mindfulness-mood-required
* obeys mindfulness-context-complete
* obeys sequential-measurements

RuleSet: MindfulnessQuestionnaireValidation
* status MS
* title MS
* item MS

* status = #active
* subjectType = #Patient
* item ^slicing.discriminator.type = #pattern
* item ^slicing.discriminator.path = "linkId"
* item ^slicing.rules = #open
* item contains 
    session 0..1 MS and
    mood 0..1 MS and
    stress 0..1 MS and
    relaxation 0..1 MS

* item[session]
  * linkId = "mindful_session"
  * text = "Mindfulness Session"
  * type = #group
  * required = true
  * repeats = false

* item[mood]
  * linkId = "mood_assessment"
  * text = "Mood Assessment"
  * type = #group
  * required = true
  * repeats = false

* item[stress]
  * linkId = "stress_assessment"
  * text = "Stress Assessment"
  * type = #group
  * required = true
  * repeats = false

* item[relaxation]
  * linkId = "relaxation"
  * text = "Relaxation"
  * type = #group
  * required = true
  * repeats = false

RuleSet: MindfulnessResponseValidation
* status MS
* subject MS
* authored MS
* item MS

* status = #completed
* subject only Reference(Patient)
* authored 1..1
* item ^slicing.discriminator.type = #pattern
* item ^slicing.discriminator.path = "linkId"
* item ^slicing.rules = #open



// ===== Conteúdo de: missing-instances.fsh =====

Instance: example
InstanceOf: Patient
Usage: #example
* identifier.system = "http://example.org/fhir/sid/patients"
* identifier.value = "12345"
* active = true
* name.family = "Doe"
* name.given = "John"
* gender = #male
* birthDate = "1980-01-01"

Instance: practitioner-example
InstanceOf: Practitioner
Usage: #example
* identifier.system = "http://example.org/fhir/sid/practitioners"
* identifier.value = "99999"
* active = true
* name.family = "Smith"
* name.given = "Jane"

Instance: iphone-example
InstanceOf: Device
Usage: #example
* status = #active
* manufacturer = "Apple Inc."
* deviceName.name = "iPhone 14"
* deviceName.type = #user-friendly-name



// ===== Conteúdo de: MindfulnessMappings.fsh =====

Mapping: MindfulnessToHealthKit
Id: mindfulness-to-healthkit
Title: "Mapping to Apple HealthKit"
Source: MindfulnessObservation
Target: "http://developer.apple.com/documentation/healthkit"

* -> "HKCategoryTypeIdentifierMindfulSession" "Root mapping"
* effectiveDateTime -> "startDate and endDate" "Session timing"
* component[sessionDuration].valueQuantity -> "duration" "Session duration"

Mapping: MindfulnessToLOINC
Id: mindfulness-to-loinc
Title: "Mapping to LOINC codes"
Source: MindfulnessObservation
Target: "http://loinc.org"

* -> "89555-7" "Mindfulness safety questionnaire"
* component[stressLevel] -> "89556-5" "Stress level score"
* component[sessionDuration] -> "89557-3" "Duration of mindfulness practice"
* component[moodState] -> "89558-1" "Mood pattern"

Mapping: MindfulnessToSNOMED
Id: mindfulness-to-snomed
Title: "Mapping to SNOMED CT"
Source: MindfulnessObservation
Target: "http://snomed.info/sct"

* -> "711020003" "Meditation"
* component[stressLevel] -> "725854004" "Assessment of stress level"
* component[moodState] -> "373931001" "Mood finding"
* component[relaxationResponse] -> "276241001" "Relaxation technique"

Extension: MindfulnessImportMap
Id: mindfulness-import-map
Title: "Mindfulness Import Mapping"
Description: "Mapping instructions for importing mindfulness data"

* ^url = "https://github.com/RicardoLSantos/shorthand/StructureDefinition/mindfulness-import-map"
* ^version = "1.0.0"
* ^status = #draft

* extension contains
    source 1..1 MS and
    target 1..1 MS and
    mapping 1..1 MS

* extension[source].value[x] only string
* extension[target].value[x] only string
* extension[mapping].value[x] only string

Instance: HealthKitMappingConfig
InstanceOf: MindfulnessImportMap
Usage: #inline

* extension[source].valueString = "HKCategoryTypeIdentifierMindfulSession"
* extension[target].valueString = "Observation"
* extension[mapping].valueString = "duration->component[sessionDuration].valueQuantity"



// ===== Conteúdo de: SocialInteractionMappings.fsh =====

Mapping: SocialInteractionToHealthKit
Id: social-interaction-to-healthkit
Title: "Mapping to Apple HealthKit"
Source: SocialInteractionProfile
Target: "http://developer.apple.com/documentation/healthkit"

* -> "HKCategoryTypeIdentifierSocialInteraction" "Root mapping"
* valueCodeableConcept -> "interactionType" "Type of interaction"
* component[duration] -> "duration" "Duration of interaction"
* component[participants] -> "participantCount" "Number of participants"

Mapping: SocialInteractionToLOINC
Id: social-interaction-to-loinc
Title: "Mapping to LOINC codes"
Source: SocialInteractionProfile
Target: "http://loinc.org"

* -> "96766-1" "Social Interaction Panel"
* component[duration] -> "89597-9" "Interaction duration"
* component[quality] -> "89598-7" "Interaction quality"



// ===== Conteúdo de: MindfulnessDiagnosticMappings.fsh =====

Instance: MindfulnessDiagnosticMap
InstanceOf: ConceptMap
Usage: #definition
Title: "Mindfulness Diagnostic Mappings"
Description: "Mapping of mindfulness outcomes to diagnostic codes"

* status = #draft
* experimental = false
* purpose = "Map mindfulness outcomes to standard diagnostic codes"
* sourceUri = "https://github.com/RicardoLSantos/shorthand/ValueSet/mindfulness-outcome-vs"
* targetUri = "http://snomed.info/sct"

* group[0].source = "https://github.com/RicardoLSantos/shorthand/CodeSystem/mindfulness-outcome-cs"
* group[0].target = "http://snomed.info/sct"
* group[0].element[0]
  * code = #stressReduction
  * target[0]
    * code = #73595000
    * display = "Stress"
    * equivalence = #narrower
    * comment = "Indicates reduction in stress levels"

* group[0].element[1]
  * code = #improvedSleep
  * target[0]
    * code = #248234008
    * display = "Sleep pattern"
    * equivalence = #narrower
    * comment = "Indicates improvement in sleep quality"

* group[0].element[2]
  * code = #emotionalBalance
  * target[0]
    * code = #285854004
    * display = "Emotional state"
    * equivalence = #equivalent
    * comment = "Maps to emotional state finding"

* group[0].element[3]
  * code = #increasedAwareness
  * target[0]
    * code = #736253002
    * display = "Mental state, behavior and/or psychosocial functioning"
    * equivalence = #relatedto
    * comment = "General improvement in mental state"

RuleSet: MindfulnessDiagnosticRules
* status MS
* code MS
* subject MS
* effective[x] MS
* value[x] MS
* method MS

* method from https://github.com/RicardoLSantos/shorthand/ValueSet/mindfulness-diagnostic-method-vs (required)
* code from https://github.com/RicardoLSantos/shorthand/ValueSet/mindfulness-diagnostic-code-vs (required)

* extension contains 
    diagnosticCertainty 0..1 MS and
    diagnosticTiming 0..1 MS



// ===== Conteúdo de: StressMappings.fsh =====

Mapping: StressToHealthKit
Id: stress-to-healthkit
Title: "Mapping to Apple HealthKit"
Source: StressLevelProfile
Target: "http://developer.apple.com/documentation/healthkit"

* -> "HKCategoryTypeIdentifierStressLevel" "Root mapping"
* valueQuantity -> "stressLevel" "Overall stress score"
* component[physiologicalStress] -> "physiologicalStress" "Physical stress indicators"
* component[psychologicalStress] -> "mentalStress" "Mental stress indicators"

Mapping: StressToLOINC
Id: stress-to-loinc
Title: "Mapping to LOINC codes"
Source: StressLevelProfile
Target: "http://loinc.org"

* -> "89592-0" "Stress Level Panel"
* component[physiologicalStress] -> "89593-8" "Physical stress score"
* component[psychologicalStress] -> "89594-6" "Mental stress score"



// ===== Conteúdo de: BodyMetricsProfiles.fsh =====

Alias: $SCT = http://snomed.info/sct
Alias: $LOINC = http://loinc.org
Alias: $UCUM = http://unitsofmeasure.org

Profile: BodyMetricsObservation
Parent: Observation
Id: body-metrics-observation
Title: "Body Metrics Observation Profile"
Description: "Profile for body measurements from iOS Health App"

* ^version = "0.1.0"
* ^status = #draft
* ^publisher = "Open Health Manager"

* status MS
* category 1..1 MS
* category = http://terminology.hl7.org/CodeSystem/observation-category#vital-signs
* subject 1..1 MS
* effectiveDateTime 1..1 MS
* device 0..1 MS

Profile: WeightObservation
Parent: BodyMetricsObservation
Id: weight-observation  
Title: "Weight Measurement Profile"
Description: "Profile for body weight measurements"

* ^version = "0.1.0"
* ^status = #draft

* code = $LOINC#29463-7 "Body weight"
* valueQuantity only Quantity
* valueQuantity.system = $UCUM
* valueQuantity.code = #kg

Profile: HeightObservation
Parent: BodyMetricsObservation
Id: height-observation
Title: "Height Measurement Profile" 
Description: "Profile for body height measurements"

* ^version = "0.1.0"
* ^status = #draft

* code = $LOINC#8302-2 "Body height"
* valueQuantity only Quantity
* valueQuantity.system = $UCUM
* valueQuantity.code = #cm

Profile: BMIObservation
Parent: BodyMetricsObservation
Id: bmi-observation
Title: "BMI Measurement Profile"
Description: "Profile for Body Mass Index calculations"

* ^version = "0.1.0"
* ^status = #draft

* code = $LOINC#39156-5 "Body mass index (BMI)"
* valueQuantity only Quantity
* valueQuantity.system = $UCUM
* valueQuantity.code = #kg/m2

Profile: BodyCompositionObservation
Parent: BodyMetricsObservation
Id: body-composition-observation
Title: "Body Composition Profile"
Description: "Profile for body composition measurements including fat, lean mass, and other metrics"

* ^version = "0.1.0"
* ^status = #draft

* code = $LOINC#88365-2 "Body composition panel"
* component ^slicing.discriminator.type = #pattern
* component ^slicing.discriminator.path = "code"
* component ^slicing.rules = #open

* component contains
    bodyFat 0..1 MS and
    leanMass 0..1 MS and
    bodyWater 0..1 MS and
    muscleMass 0..1 MS and
    boneMass 0..1 MS

* component[bodyFat].code = $LOINC#41982-0 "Percentage body fat"
* component[bodyFat].valueQuantity.system = $UCUM
* component[bodyFat].valueQuantity.code = #%

* component[leanMass].code = $LOINC#291-7 "Lean body mass"
* component[leanMass].valueQuantity.system = $UCUM
* component[leanMass].valueQuantity.code = #kg

* component[bodyWater].code = $LOINC#73708-0 "Total body water"
* component[bodyWater].valueQuantity.system = $UCUM  
* component[bodyWater].valueQuantity.code = #L

* component[muscleMass].code = $LOINC#73713-0 "Muscle mass"
* component[muscleMass].valueQuantity.system = $UCUM
* component[muscleMass].valueQuantity.code = #kg

* component[boneMass].code = $LOINC#73711-4 "Bone mass" 
* component[boneMass].valueQuantity.system = $UCUM
* component[boneMass].valueQuantity.code = #kg



// ===== Conteúdo de: AdvancedVitalSignsProfiles.fsh =====

Alias: $SCT = http://snomed.info/sct
Alias: $LOINC = http://loinc.org
Alias: $UCUM = http://unitsofmeasure.org

Profile: AdvancedVitalSigns
Parent: Observation
Id: advanced-vital-signs
Title: "Advanced Vital Signs Profile"
Description: "Profile for advanced vital signs data from iOS Health App"

* ^version = "0.1.0"
* ^status = #draft
* ^publisher = "HL7 International"
* ^contact.name = "Advanced Vital Signs Working Group"

* status MS
* category 1..1 MS
* category = http://terminology.hl7.org/CodeSystem/observation-category#vital-signs
* code 1..1 MS
* subject 1..1 MS
* effectiveDateTime 1..1 MS
* device 0..1 MS
* method 0..1 MS
* note 0..* MS

* component ^slicing.discriminator.type = #pattern
* component ^slicing.discriminator.path = "code"
* component ^slicing.rules = #open
* component ^short = "Advanced vital signs components"
* component ^definition = "Components of advanced vital sign measurements"

* component contains
    hrvSpectral 0..1 MS and
    hrvEntropy 0..1 MS and
    meanArterialPressure 0..1 MS and
    pulseWaveAnalysis 0..1 MS and
    respiratoryVariability 0..1 MS and
    oxygenationIndex 0..1 MS and
    stressIndex 0..1 MS and
    thermalGradient 0..1 MS and
    autonomicBalance 0..1 MS and
    recoveryRate 0..1 MS and
    allostaticLoad 0..1 MS

* component[hrvSpectral].code = $LOINC#87834-8 "Heart rate variability [Frequency band]"
* component[hrvSpectral].valueQuantity.system = $UCUM
* component[hrvSpectral].valueQuantity.code = #ms
* component[hrvSpectral] ^short = "Spectral analysis of heart rate variability"

* component[hrvEntropy].code = $LOINC#87835-5 "Heart rate variability entropy"
* component[hrvEntropy].valueQuantity.system = $UCUM
* component[hrvEntropy].valueQuantity.code = #{entropy}
* component[hrvEntropy] ^short = "Sample entropy of heart rate variability"

* component[meanArterialPressure].code = $LOINC#8478-0 "Mean blood pressure"
* component[meanArterialPressure].valueQuantity.system = $UCUM
* component[meanArterialPressure].valueQuantity.code = #mmHg
* component[meanArterialPressure] ^short = "Mean arterial blood pressure"

* component[pulseWaveAnalysis].code = $LOINC#87836-3 "Pulse wave analysis"
* component[pulseWaveAnalysis].valueQuantity.system = $UCUM
* component[pulseWaveAnalysis].valueQuantity.code = #{index}
* component[pulseWaveAnalysis] ^short = "Analysis of arterial pulse wave"

* component[respiratoryVariability].code = $LOINC#87837-1 "Respiratory rate variability"
* component[respiratoryVariability].valueQuantity.system = $UCUM
* component[respiratoryVariability].valueQuantity.code = #{coefficient}
* component[respiratoryVariability] ^short = "Variability in respiratory rate"

* component[oxygenationIndex].code = $LOINC#87838-9 "Oxygenation index"
* component[oxygenationIndex].valueQuantity.system = $UCUM
* component[oxygenationIndex].valueQuantity.code = #{ratio}
* component[oxygenationIndex] ^short = "Index of blood oxygenation"

* component[stressIndex].code = $LOINC#87839-7 "Physiological stress index"
* component[stressIndex].valueQuantity.system = $UCUM
* component[stressIndex].valueQuantity.code = #{index}
* component[stressIndex] ^short = "Index of physiological stress"

* component[thermalGradient].code = $LOINC#87840-5 "Temperature gradient"
* component[thermalGradient].valueQuantity.system = $UCUM
* component[thermalGradient].valueQuantity.code = #Cel
* component[thermalGradient] ^short = "Gradient of body temperature"

* component[autonomicBalance].code = $LOINC#87841-3 "Autonomic balance index"
* component[autonomicBalance].valueQuantity.system = $UCUM
* component[autonomicBalance].valueQuantity.code = #{ratio}
* component[autonomicBalance] ^short = "Balance of autonomic nervous system"

* component[recoveryRate].code = $LOINC#87842-1 "Recovery rate index"
* component[recoveryRate].valueQuantity.system = $UCUM
* component[recoveryRate].valueQuantity.code = #{rate}
* component[recoveryRate] ^short = "Rate of physiological recovery"

* component[allostaticLoad].code = $LOINC#87843-9 "Allostatic load index"
* component[allostaticLoad].valueQuantity.system = $UCUM
* component[allostaticLoad].valueQuantity.code = #{score}
* component[allostaticLoad] ^short = "Measure of cumulative physiological burden"

Extension: AdvancedVitalSignsContext
Id: advanced-vital-signs-context
Title: "Advanced Vital Signs Context Extension"
Description: "Additional context about advanced vital sign measurements"

* value[x] only CodeableConcept
* valueCodeableConcept from AdvancedVitalSignsContextVS (required)

ValueSet: AdvancedVitalSignsContextVS
Id: advanced-vital-signs-context-vs
Title: "Advanced Vital Signs Context Value Set"
Description: "Context codes for advanced vital sign measurements"

* ^experimental = true
* codes from system AdvancedVitalSignsContextCS

CodeSystem: AdvancedVitalSignsContextCS
Id: advanced-vital-signs-context-cs
Title: "Advanced Vital Signs Context Code System"
Description: "Codes for advanced vital signs measurement context"

* ^experimental = true
* ^caseSensitive = true

* #resting "Resting state" "Measurement taken during rest"
* #active "Active state" "Measurement taken during activity"
* #recovery "Recovery state" "Measurement taken during recovery"
* #sleep "Sleep state" "Measurement taken during sleep"
* #stress "Stress state" "Measurement taken during stress"



// ===== Conteúdo de: MobilityProfiles.fsh =====

Profile: MobilityProfile
Parent: Observation
Id: mobility-profile
Title: "Mobility Profile"
Description: "Profile for mobility data from iOS Health App"

* status MS
* category 1..1 MS
* category = http://terminology.hl7.org/CodeSystem/observation-category#activity
* code 1..1 MS
* subject 1..1 MS
* effectiveDateTime 1..1 MS
* device 0..1 MS

* component ^slicing.discriminator.type = #pattern
* component ^slicing.discriminator.path = "code"
* component ^slicing.rules = #open

* component contains
    steadiness 0..1 MS and
    balance 0..1 MS and
    gait 0..1 MS and 
    movement 0..1 MS

* component[steadiness].code = $LOINC#LA32-8
* component[balance].code = $LOINC#LA32-9
* component[gait].code = $LOINC#LA29042-4
* component[movement].code = $LOINC#LA29043-2



// ===== Conteúdo de: VitalSignsProfiles.fsh =====

Alias: $SCT = http://snomed.info/sct
Alias: $LOINC = http://loinc.org
Alias: $UCUM = http://unitsofmeasure.org
Alias: $vitalsigns = http://hl7.org/fhir/StructureDefinition/vitalsigns

Profile: LifestyleVitalSigns
Parent: $vitalsigns
Id: lifestyle-vital-signs
Title: "Lifestyle Medicine Vital Signs Profile"
Description: "Profile for vital signs data from iOS Health App"

* status MS
* category 1..* MS
* subject 1..1 MS
* effectiveDateTime 1..1 MS
* code 1..1 MS
* value[x] 0..1 MS
* device 0..1 MS

Profile: HeartRateObservation
Parent: LifestyleVitalSigns
Id: heart-rate-observation
Title: "Heart Rate Observation Profile"
Description: "Profile for heart rate measurements from iOS Health App"

* code = $LOINC#8867-4 "Heart rate"
* valueQuantity only Quantity
* valueQuantity.system = $UCUM
* valueQuantity.code = #/min
* component ^slicing.discriminator.type = #pattern
* component ^slicing.discriminator.path = "code"
* component ^slicing.rules = #open

* component contains
    restingHeartRate 0..1 MS and
    exerciseHeartRate 0..1 MS and
    recoveryHeartRate 0..1 MS and
    heartRateVariability 0..1 MS

* component[heartRateVariability].code = $LOINC#80404-7 "R-R interval.standard deviation (Heart rate variability)"
* component[heartRateVariability].valueQuantity.system = $UCUM
* component[heartRateVariability].valueQuantity.code = #ms

Profile: BloodPressureObservation
Parent: LifestyleVitalSigns
Id: blood-pressure-observation
Title: "Blood Pressure Observation Profile"
Description: "Profile for blood pressure measurements from iOS Health App"

* code = $LOINC#85354-9 "Blood pressure panel with all children optional"
* component 2..2 MS
* component ^slicing.discriminator.type = #pattern
* component ^slicing.discriminator.path = "code"
* component ^slicing.rules = #closed

* component contains
    systolic 1..1 MS and
    diastolic 1..1 MS

* component[systolic].code = $LOINC#8480-6 "Systolic blood pressure"
* component[systolic].valueQuantity only Quantity
* component[systolic].valueQuantity.system = $UCUM
* component[systolic].valueQuantity.code = #mm[Hg]

* component[diastolic].code = $LOINC#8462-4 "Diastolic blood pressure"
* component[diastolic].valueQuantity only Quantity
* component[diastolic].valueQuantity.system = $UCUM
* component[diastolic].valueQuantity.code = #mm[Hg]

Profile: OxygenSaturationObservation
Parent: LifestyleVitalSigns
Id: oxygen-saturation-observation
Title: "Oxygen Saturation Observation Profile"
Description: "Profile for SpO2 measurements from iOS Health App"

* code = $LOINC#2708-6 "Oxygen saturation in Arterial blood"
* valueQuantity.system = $UCUM
* valueQuantity.code = #%



// ===== Conteúdo de: PhysicalActivityProfile.fsh =====

Alias: $LOINC = http://loinc.org
Alias: $SNOMED = http://snomed.info/sct
Alias: $UCUM = http://unitsofmeasure.org
Alias: $ActivityCodes = https://github.com/RicardoLSantos/shorthand/activity-codes

Profile: PhysicalActivityObservation
Parent: Observation
Id: physical-activity-observation
Title: "Physical Activity Observation Profile"
Description: "Profile for recording physical activity data from iOS Health App"

* status MS
* category 1..1 MS
* category = http://terminology.hl7.org/CodeSystem/observation-category#activity
* code 1..1 MS
* code from PhysicalActivityTypeVS (required)
* subject 1..1 MS
* subject only Reference(Patient)
* effectiveDateTime 1..1 MS
* device 0..1 MS
* value[x] only Quantity
* component ^slicing.discriminator.type = #pattern
* component ^slicing.discriminator.path = "code"
* component ^slicing.rules = #open

* component contains
    steps 0..1 MS and
    distance 0..1 MS and
    duration 0..1 MS and
    energy 0..1 MS

* component[steps].code = $LOINC#55423-8 "Number of steps in 24 hour Measured"
* component[steps].valueQuantity only Quantity
* component[steps].valueQuantity.system = $UCUM
* component[steps].valueQuantity.code = #1 "count"

* component[distance].code = $LOINC#55430-3 "Distance walked"
* component[distance].valueQuantity only Quantity
* component[distance].valueQuantity.system = $UCUM
* component[distance].valueQuantity.code = #km "kilometer"

* component[duration].code = $LOINC#55411-3 "Exercise duration"
* component[duration].valueQuantity only Quantity
* component[duration].valueQuantity.system = $UCUM
* component[duration].valueQuantity.code = #min "minute"

* component[energy].code = $LOINC#55424-6 "Energy expenditure"
* component[energy].valueQuantity only Quantity
* component[energy].valueQuantity.system = $UCUM
* component[energy].valueQuantity.code = #kcal "kilocalorie"



// ===== Conteúdo de: ReproductiveObservation.fsh =====

Profile: ReproductiveObservation
Parent: Observation
Id: reproductive-observation
Title: "Reproductive Health Base Profile"
Description: "Base profile for reproductive health observations"

* ^version = "1.0.0"
* ^status = #active
* ^date = "2024-03-19"

* status MS
* category 1..1 MS
* category = http://terminology.hl7.org/CodeSystem/observation-category#reproductive
* code 1..1 MS
* subject 1..1 MS
* subject only Reference(Patient)
* effectiveDateTime 1..1 MS
* value[x] MS

* component ^slicing.discriminator.type = #pattern
* component ^slicing.discriminator.path = "code"
* component ^slicing.rules = #open

* component contains
    severity 0..1 MS and
    duration 0..1 MS and
    frequency 0..1 MS and
    pattern 0..1 MS

* component[severity]
  * code = $LOINC#72514-3
  * value[x] only integer
  * valueInteger 1..1 
  * valueInteger obeys rep-1

* component[duration]
  * code = $LOINC#103332-8
  * value[x] only Quantity
  * valueQuantity from DurationUnitsVS (required)

* component[frequency]
  * code = $LOINC#103334-4
  * value[x] only CodeableConcept
  * valueCodeableConcept from SymptomFrequencyVS (required)

* component[pattern]
  * code = $LOINC#103335-1
  * value[x] only CodeableConcept
  * valueCodeableConcept from SymptomProgressionVS (required)

Invariant: rep-1
Description: "Severity must be between 0 and 10"
Expression: "$this >= 0 and $this <= 10"
Severity: #error



// ===== Conteúdo de: SymptomProfiles.fsh =====

Profile: SymptomQuestionnaire
Parent: Questionnaire
Id: symptom-questionnaire
Title: "Symptom Assessment Questionnaire"
Description: "Questionnaire template for symptom assessments"

* status MS
* title MS
* item MS

* item ^slicing.discriminator.type = #pattern
* item ^slicing.discriminator.path = "linkId"
* item ^slicing.rules = #open

* item contains
    symptomType 1..1 MS and
    location 0..1 MS and
    onset 0..1 MS and
    description 0..1 MS

* item[symptomType].linkId = "symptom-type"
* item[symptomType].text = "Type of Symptom"
* item[symptomType].type = #choice
* item[symptomType].required = true

* item[location].linkId = "location"
* item[location].text = "Location"
* item[location].type = #string

* item[onset].linkId = "onset"
* item[onset].text = "When did it start?"
* item[onset].type = #dateTime

* item[description].linkId = "description"
* item[description].text = "Description"
* item[description].type = #text



// ===== Conteúdo de: ReproductiveProfiles.fsh =====

Profile: FertilityObservation
Parent: Observation
Id: fertility-observation
Title: "Fertility Observation Profile"
Description: "Profile for fertility signs and symptoms"

* status MS
* category 1..1 MS
* category = http://terminology.hl7.org/CodeSystem/observation-category#reproductive
* code = $LOINC#8669-4 "Ovulation status"
* subject 1..1 MS
* effectiveDateTime 1..1 MS

* component ^slicing.discriminator.type = #pattern
* component ^slicing.discriminator.path = "code"
* component ^slicing.rules = #open

* component contains
    cervicalMucus 0..1 MS and
    ovulationTest 0..1 MS and
    fertilityStatus 0..1 MS

* component[cervicalMucus].valueCodeableConcept from https://github.com/RicardoLSantos/shorthand/fhir/ValueSet/cervical-mucus-vs (required)
* component[ovulationTest].valueCodeableConcept from https://github.com/RicardoLSantos/shorthand/fhir/ValueSet/ovulation-test-vs (required)
* component[fertilityStatus].valueCodeableConcept from https://github.com/RicardoLSantos/shorthand/fhir/ValueSet/fertility-status-vs (required)



// ===== Conteúdo de: MindfulnessProfiles.fsh =====

Profile: MindfulnessObservation
Parent: Observation
Id: mindfulness-observation
Title: "Mindfulness Session Observation"
Description: "Profile for recording mindfulness practice sessions and outcomes"

* status MS
* code MS
* subject MS
* effectiveDateTime MS
* performer MS
* value[x] MS
* component MS

* status = #final
* code = $SCT#711020003 "Meditation"
* subject only Reference(Patient)
* effectiveDateTime 1..1
* performer only Reference(Practitioner or PractitionerRole)

* component ^slicing.discriminator.type = #pattern
* component ^slicing.discriminator.path = "code"
* component ^slicing.rules = #open

* component contains
    sessionDuration 0..1 and
    stressLevel 0..1 and
    moodState 0..1 and
    relaxationResponse 0..1 and
    mindfulnessType 0..1

* component[sessionDuration]
  * code = $SCT#118682006 "Duration"
  * value[x] only Quantity
  * valueQuantity
    * value 1..1
    * unit = "min"
    * system = "http://unitsofmeasure.org"
    * code = #min

* component[stressLevel]
  * code = $SCT#725854004 "Assessment of stress level"
  * value[x] only integer
  * valueInteger
    * ^extension[0].url = "http://hl7.org/fhir/StructureDefinition/elementdefinition-minValueInteger"
    * ^extension[0].valueInteger = 0
    * ^extension[1].url = "http://hl7.org/fhir/StructureDefinition/elementdefinition-maxValueInteger"
    * ^extension[1].valueInteger = 10

* component[moodState]
  * code = $SCT#373931001 "Mood finding"
  * value[x] only CodeableConcept
  * valueCodeableConcept from https://github.com/RicardoLSantos/shorthand/fhir/ValueSet/mood (required)

* component[relaxationResponse]
  * code = $SCT#276241001 "Relaxation technique"
  * value[x] only string

* component[mindfulnessType]
  * code = $SCT#711020003 "Meditation"
  * value[x] only CodeableConcept
  * valueCodeableConcept from https://github.com/RicardoLSantos/shorthand/ValueSet/mindfulness-type (required)



// ===== Conteúdo de: SleepProfile.fsh =====

Alias: $SCT = http://snomed.info/sct
Alias: $LOINC = http://loinc.org
Alias: $UCUM = http://unitsofmeasure.org
 
Profile: SleepObservation
Parent: Observation
Id: sleep-observation
Title: "Sleep Observation Profile"
Description: "Profile for recording sleep data from iOS Health App"
 
* status MS
* category 1..1 MS
* category = http://terminology.hl7.org/CodeSystem/observation-category#sleep
* code 1..1 MS
* code = $LOINC#93832-4 "Sleep pattern panel"
* subject 1..1 MS
* subject only Reference(Patient)
* effectiveDateTime 0..1 MS
* effectivePeriod 0..1 MS
* device 0..1 MS
 
* component ^slicing.discriminator.type = #pattern
* component ^slicing.discriminator.path = "code"
* component ^slicing.rules = #open
 
* component contains
    timeInBed 1..1 MS and
    totalSleepTime 1..1 MS and
    deepSleep 0..1 MS and
    remSleep 0..1 MS and
    lightSleep 0..1 MS and
    respiratoryRate 0..1 MS and
    heartRateVariability 0..1 MS and
    interruptions 0..1 MS
 
* component[timeInBed].code = $LOINC#93831-6 "Time in bed"
* component[timeInBed].valueQuantity only Quantity
* component[timeInBed].valueQuantity.system = $UCUM
* component[timeInBed].valueQuantity.code = #min
 
* component[totalSleepTime].code = $LOINC#93833-2 "Sleep duration"
* component[totalSleepTime].valueQuantity only Quantity
* component[totalSleepTime].valueQuantity.system = $UCUM
* component[totalSleepTime].valueQuantity.code = #min
 
* component[deepSleep].code = $LOINC#93834-0 "Deep sleep duration"
* component[deepSleep].valueQuantity only Quantity
* component[deepSleep].valueQuantity.system = $UCUM
* component[deepSleep].valueQuantity.code = #min
 
* component[remSleep].code = $LOINC#93835-7 "REM sleep duration"
* component[remSleep].valueQuantity only Quantity
* component[remSleep].valueQuantity.system = $UCUM
* component[remSleep].valueQuantity.code = #min
 
* component[lightSleep].code = $LOINC#93836-5 "Light sleep duration"
* component[lightSleep].valueQuantity only Quantity
* component[lightSleep].valueQuantity.system = $UCUM
* component[lightSleep].valueQuantity.code = #min
 
* component[respiratoryRate].code = $LOINC#9279-1 "Respiratory rate"
* component[respiratoryRate].valueQuantity only Quantity
* component[respiratoryRate].valueQuantity.system = $UCUM
* component[respiratoryRate].valueQuantity.code = #/min
 
* component[heartRateVariability].code = $LOINC#80404-7 "R-R interval.standard deviation (Heart rate variability)"
* component[heartRateVariability].valueQuantity only Quantity
* component[heartRateVariability].valueQuantity.system = $UCUM
* component[heartRateVariability].valueQuantity.code = #ms
 
* component[interruptions].code = $LOINC#93837-3 "Number of awakenings during sleep"
* component[interruptions].valueQuantity only Quantity
* component[interruptions].valueQuantity.system = $UCUM
* component[interruptions].valueQuantity.code = #{count}
* extension contains SleepQuality named quality 0..1



// ===== Conteúdo de: MobilityRiskAssessment.fsh =====

Profile: MobilityRiskAssessment
Parent: RiskAssessment
Id: mobility-risk-assessment
Title: "Mobility Risk Assessment Profile"
Description: "Profile for assessing mobility-related risks"

* status MS
* subject 1..1 MS
* occurrence[x] MS
* prediction MS
  * outcome MS
  * probability[x] MS
  * qualitativeRisk MS

* method MS
  * coding ^slicing.discriminator.type = #pattern
  * coding ^slicing.discriminator.path = "$this"
  * coding ^slicing.rules = #open
  * coding contains
      mobilityAssessment 1..1 MS

* method.coding[mobilityAssessment] = https://github.com/RicardoLSantos/shorthand/CodeSystem/mobility-assessment-method#standardized "Standardized Mobility Assessment"

* prediction ^slicing.discriminator.type = #pattern
* prediction ^slicing.discriminator.path = "outcome"
* prediction ^slicing.rules = #open

* prediction contains
    fallRisk 0..1 MS and
    mobilityDecline 0..1 MS and
    assistanceNeeded 0..1 MS

* prediction[fallRisk].outcome from https://github.com/RicardoLSantos/shorthand/ValueSet/fall-risk-outcomes
* prediction[fallRisk].probabilityDecimal 0..1 MS
* prediction[fallRisk].qualitativeRisk from https://github.com/RicardoLSantos/shorthand/ValueSet/risk-level

* prediction[mobilityDecline].outcome from https://github.com/RicardoLSantos/shorthand/ValueSet/mobility-decline-outcomes
* prediction[mobilityDecline].probabilityDecimal 0..1 MS
* prediction[mobilityDecline].qualitativeRisk from https://github.com/RicardoLSantos/shorthand/ValueSet/risk-level

* prediction[assistanceNeeded].outcome from https://github.com/RicardoLSantos/shorthand/ValueSet/assistance-level-outcomes
* prediction[assistanceNeeded].probabilityDecimal 0..1 MS
* prediction[assistanceNeeded].qualitativeRisk from https://github.com/RicardoLSantos/shorthand/ValueSet/risk-level

* basis only Reference(MobilityProfile or Observation or QuestionnaireResponse)
* basis MS

* note MS



// ===== Conteúdo de: EnvironmentalProfiles.fsh =====

Alias: $SCT = http://snomed.info/sct
Alias: $LOINC = http://loinc.org
Alias: $UCUM = http://unitsofmeasure.org

Profile: EnvironmentalObservation
Parent: Observation
Id: environmental-observation
Title: "Environmental Observation Profile"
Description: "Base profile for environmental measurements from iOS Health App"

* ^version = "0.1.0"
* ^status = #draft
* ^publisher = "HL7 International"
* ^contact.name = "Environmental Health Working Group"

* status MS
* category 1..1 MS
* category = http://terminology.hl7.org/CodeSystem/observation-category#environment
* subject 1..1 MS
* effectiveDateTime 1..1 MS
* device 0..1 MS
* method 0..1 MS
* note 0..* MS

Profile: NoiseExposureObservation
Parent: EnvironmentalObservation
Id: noise-exposure-observation
Title: "Noise Exposure Observation Profile"
Description: "Profile for noise exposure measurements from iOS Health App"

* code = $LOINC#28573-7 "Noise exposure time"
* component ^slicing.discriminator.type = #pattern
* component ^slicing.discriminator.path = "code"
* component ^slicing.rules = #open
* component ^short = "Noise exposure components"
* component ^definition = "Components of noise exposure measurement"

* component contains
    level 1..1 MS and
    duration 1..1 MS and
    peakLevel 0..1 MS and
    backgroundNoise 0..1 MS

* component[level].code = $LOINC#89020-2 "Environmental noise average"
* component[level].valueQuantity.system = $UCUM
* component[level].valueQuantity.code = #dB
* component[level].valueQuantity ^short = "Noise level in decibels"

* component[duration].code = $LOINC#89021-0 "Environmental noise duration"
* component[duration].valueQuantity.system = $UCUM
* component[duration].valueQuantity.code = #min
* component[duration].valueQuantity ^short = "Duration of exposure"

* component[peakLevel].code = $LOINC#89024-4 "Peak sound level"
* component[peakLevel].valueQuantity.system = $UCUM
* component[peakLevel].valueQuantity.code = #dB
* component[peakLevel].valueQuantity ^short = "Peak noise level"

* component[backgroundNoise].code = $LOINC#89025-1 "Background noise level"
* component[backgroundNoise].valueQuantity.system = $UCUM
* component[backgroundNoise].valueQuantity.code = #dB
* component[backgroundNoise].valueQuantity ^short = "Background noise level"

Profile: UVExposureObservation
Parent: EnvironmentalObservation
Id: uv-exposure-observation
Title: "UV Exposure Observation Profile"
Description: "Profile for UV exposure measurements from iOS Health App"

* code = $LOINC#28574-5 "UV exposure"
* component ^slicing.discriminator.type = #pattern
* component ^slicing.discriminator.path = "code"
* component ^slicing.rules = #open
* component ^short = "UV exposure components"
* component ^definition = "Components of UV exposure measurement"

* component contains
    index 1..1 MS and
    duration 1..1 MS and
    timeOfDay 0..1 MS and
    intensity 0..1 MS

* component[index].code = $LOINC#89022-8 "UV index"
* component[index].valueQuantity.system = $UCUM
* component[index].valueQuantity.code = #{index}
* component[index].valueQuantity ^short = "UV index value"

* component[duration].code = $LOINC#89023-6 "UV exposure duration"
* component[duration].valueQuantity.system = $UCUM
* component[duration].valueQuantity.code = #min
* component[duration].valueQuantity ^short = "Duration of UV exposure"

* component[timeOfDay].code = $LOINC#89026-9 "Time of exposure"
* component[timeOfDay].valueDateTime 1..1
* component[timeOfDay].valueDateTime ^short = "Time of UV exposure"

* component[intensity].code = $LOINC#89027-7 "UV intensity"
* component[intensity].valueQuantity.system = $UCUM
* component[intensity].valueQuantity.code = #W/m2
* component[intensity].valueQuantity ^short = "UV radiation intensity"

Extension: EnvironmentalContext
Id: environmental-context
Title: "Environmental Context Extension"
Description: "Additional context about environmental measurements"

* value[x] only CodeableConcept
* valueCodeableConcept from https://github.com/RicardoLSantos/shorthand/fhir/ValueSet/environmental-context (required)



// ===== Conteúdo de: SocialInteractionProfile.fsh =====

Profile: SocialInteractionProfile
Parent: Observation
Id: social-interaction
Title: "Social Interaction Profile"
Description: "Profile for recording social interaction data from iOS Health App"

* ^version = "0.1.0"
* ^status = #active
* ^date = "2024-01-03"
* ^publisher = "FMUP HEADS2"

* status MS
* category 1..1 MS
* category = http://terminology.hl7.org/CodeSystem/observation-category#social-history
* code 1..1 MS
* code = $LOINC#96766-1 "Social interaction pattern"
* subject 1..1 MS
* effectiveDateTime 1..1 MS
* value[x] only CodeableConcept
* valueCodeableConcept from SocialInteractionTypeVS (required)

* component ^slicing.discriminator.type = #pattern
* component ^slicing.discriminator.path = "code"
* component ^slicing.rules = #open

* component contains
    duration 0..1 MS and
    quality 0..1 MS and
    medium 0..1 MS and
    participants 0..1 MS

* component[duration]
  * code = $LOINC#89597-9 "Social interaction duration"
  * valueQuantity only Quantity
  * valueQuantity.system = $UCUM
  * valueQuantity.code = #min

* component[quality]
  * code = $LOINC#89598-7 "Social interaction quality"
  * valueCodeableConcept from SocialInteractionQualityVS (required)

* component[medium]
  * code = $LOINC#89599-5 "Social interaction medium"
  * valueCodeableConcept from SocialInteractionMediumVS (required)

* component[participants]
  * code = $LOINC#89600-1 "Social interaction participants"
  * valueInteger only integer

* extension contains
    SocialContext named context 0..1 MS and
    SocialSupport named support 0..1 MS and
    SocialActivity named activity 0..* MS



// ===== Conteúdo de: StressLevelProfile.fsh =====

Profile: StressLevelProfile
Parent: Observation
Id: stress-level
Title: "Stress Level Profile"
Description: "Profile for recording stress level measurements from iOS Health App"

* ^version = "0.1.0"
* ^status = #active
* ^date = "2024-01-03"
* ^publisher = "FMUP HEADS2"

* status MS
* category 1..1 MS
* category = http://terminology.hl7.org/CodeSystem/observation-category#vital-signs
* code 1..1 MS
* code = $LOINC#89592-0 "Stress level score"
* subject 1..1 MS
* effectiveDateTime 1..1 MS
* value[x] only Quantity
* valueQuantity MS

* component ^slicing.discriminator.type = #pattern
* component ^slicing.discriminator.path = "code"
* component ^slicing.rules = #open

* component contains
    physiologicalStress 0..1 MS and
    psychologicalStress 0..1 MS and
    chronicity 0..1 MS and 
    impact 0..1 MS

* component[physiologicalStress]
  * code = $LOINC#89593-8 "Physiological stress"
  * valueQuantity only Quantity
  * valueQuantity.system = $UCUM
  * valueQuantity.code = #{score}

* component[psychologicalStress]
  * code = $LOINC#89594-6 "Psychological stress"
  * valueQuantity only Quantity
  * valueQuantity.system = $UCUM
  * valueQuantity.code = #{score}

* component[chronicity]
  * code = $LOINC#89595-3 "Stress chronicity"
  * valueCodeableConcept from StressChronicityVS (required)

* component[impact]
  * code = $LOINC#89596-1 "Stress impact"
  * valueCodeableConcept from StressImpactVS (required)

* extension contains
    MeasurementContext named context 0..1 MS and
    StressTriggers named triggers 0..* MS and 
    StressCoping named coping 0..* MS



// ===== Conteúdo de: NutritionProfiles.fsh =====

Alias: $SCT = http://snomed.info/sct
Alias: $LOINC = http://loinc.org
Alias: $UCUM = http://unitsofmeasure.org

Profile: NutritionIntakeObservation
Parent: Observation
Id: nutrition-intake-observation
Title: "Nutrition Intake Observation Profile"
Description: "Profile for nutrition intake data from iOS Health App and user input"

* ^version = "0.1.0"
* ^status = #draft
* ^publisher = "Ricardo Lourenço dos Santos"

* status MS
* category 1..1 MS
* category = http://terminology.hl7.org/CodeSystem/observation-category#nutrition
* subject 1..1 MS
* effectiveDateTime 1..1 MS
* code 1..1 MS
* method 0..1 MS

Profile: WaterIntakeObservation
Parent: NutritionIntakeObservation 
Id: water-intake-observation
Title: "Water Intake Observation Profile"
Description: "Profile for water intake measurements"

* ^version = "0.1.0"
* ^status = #draft
* ^publisher = "Ricardo Lourenço dos Santos"

* code = $LOINC#77111-4 "Water intake"
* valueQuantity only Quantity
* valueQuantity.system = $UCUM
* valueQuantity.code = #mL
* valueQuantity.unit = "milliliter"

Profile: CalorieIntakeObservation
Parent: NutritionIntakeObservation
Id: calorie-intake-observation
Title: "Calorie Intake Observation Profile"
Description: "Profile for caloric intake measurements"

* ^version = "0.1.0"
* ^status = #draft
* ^publisher = "Ricardo Lourenço dos Santos"

* code = $LOINC#9051-4 "Caloric intake total"
* valueQuantity only Quantity
* valueQuantity.system = $UCUM
* valueQuantity.code = #kcal
* valueQuantity.unit = "kilocalorie"

Profile: MacronutrientsObservation
Parent: NutritionIntakeObservation
Id: macronutrients-observation
Title: "Macronutrients Observation Profile"
Description: "Profile for macronutrient intake measurements"

* ^version = "0.1.0"
* ^status = #draft
* ^publisher = "Ricardo Lourenço dos Santos"

* code = $LOINC#LP199119-9 "Macronutrients panel"
* component ^slicing.discriminator.type = #pattern
* component ^slicing.discriminator.path = "code"
* component ^slicing.rules = #open

* component contains
    carbohydrates 0..1 MS and
    proteins 0..1 MS and
    fats 0..1 MS

* component[carbohydrates].code = $LOINC#LP35925-4 "Carbohydrates"
* component[carbohydrates].valueQuantity.system = $UCUM
* component[carbohydrates].valueQuantity.code = #g
* component[carbohydrates].valueQuantity.unit = "gram"

* component[proteins].code = $LOINC#LP35921-3 "Proteins" 
* component[proteins].valueQuantity.system = $UCUM
* component[proteins].valueQuantity.code = #g
* component[proteins].valueQuantity.unit = "gram"

* component[fats].code = $LOINC#LP35922-1 "Fats"
* component[fats].valueQuantity.system = $UCUM
* component[fats].valueQuantity.code = #g
* component[fats].valueQuantity.unit = "gram"



// ===== Conteúdo de: MindfulnessMessaging.fsh =====

Alias: $MsgEvents = https://github.com/RicardoLSantos/shorthand/fhir/CodeSystem/mindfulness-message-events
Alias: $MsgTypes = http://terminology.hl7.org/CodeSystem/message-type

Profile: MindfulnessMessageDefinition
Parent: MessageDefinition
Id: mindfulness-message-definition
Title: "Mindfulness Message Definition" 
Description: "Definition for mindfulness session messages"

* url 1..1 MS
* date 1..1 MS
* status 1..1 MS
* event[x] 1..1 MS
* category 0..1 MS
* focus 1..* MS
* focus.min 1..1

Instance: StartSessionMessage
InstanceOf: MindfulnessMessageDefinition
Title: "Start Session Message"
Description: "Message definition for starting a mindfulness session"

* url = "https://github.com/RicardoLSantos/shorthand/fhir/MessageDefinition/start-session"
* date = "2024-03-19"
* status = #active
* eventCoding = $MsgEvents#session-start "Session Start"
* category = #notification
* focus.code = #Observation
* focus.min = 1
* focus.profile = "https://github.com/RicardoLSantos/shorthand/fhir/StructureDefinition/mindfulness-session"

Instance: EndSessionMessage  
InstanceOf: MindfulnessMessageDefinition
Title: "End Session Message"
Description: "Message definition for ending a mindfulness session"

* url = "https://github.com/RicardoLSantos/shorthand/fhir/MessageDefinition/end-session"
* date = "2024-03-19"
* status = #active
* eventCoding = $MsgEvents#session-end "Session End"
* category = #notification
* focus.code = #Observation
* focus.min = 1
* focus.profile = "https://github.com/RicardoLSantos/shorthand/fhir/StructureDefinition/mindfulness-session"



// ===== Conteúdo de: MindfulnessReports.fsh =====

Instance: MindfulnessProgressReport
InstanceOf: Measure
Usage: #definition
Title: "Mindfulness Practice Progress Report"

* status = #active
* experimental = false
* date = "2024-03-19"
* publisher = "Example Organization"
* description = "Measures progress in mindfulness practice over time"

* scoring = #continuous-variable
* type = #process
* riskAdjustment = "none"
* rateAggregation = "Average values over time period"

* group[0]
  * code = #practice-frequency
  * description = "Frequency of mindfulness practice"
  * population[0]
    * code = #denominator
    * criteria.language = #text/fhirpath
    * criteria.expression = "Observation.where(code.coding.code='711020003')"
  * stratifier[0]
    * code = #weekly
    * criteria.language = #text/fhirpath
    * criteria.expression = "Observation.effective.as(DateTime).truncate(@T).truncate(@W)"

* group[1]
  * code = #stress-reduction
  * description = "Stress level changes over time"
  * population[0]
    * code = #denominator
    * criteria.language = #text/fhirpath
    * criteria.expression = "Observation.where(component.code.coding.code='725854004')"
  * stratifier[0]
    * code = #trend
    * criteria.language = #text/fhirpath
    * criteria.expression = "component.where(code.coding.code='725854004').value.value"

RuleSet: ReportingMetrics
* group[+]
  * code = #session-duration
  * description = "Duration of practice sessions"
  * population[0]
    * code = #denominator
    * criteria.language = #text/fhirpath
    * criteria.expression = "Observation.component.where(code.coding.code='118682006')"
  * stratifier[0]
    * code = #average
    * criteria.language = #text/fhirpath
    * criteria.expression = "component.where(code.coding.code='118682006').value.value"

* group[+]
  * code = #mood-changes
  * description = "Mood state changes"
  * population[0]
    * code = #denominator
    * criteria.language = #text/fhirpath
    * criteria.expression = "Observation.component.where(code.coding.code='373931001')"



// ===== Conteúdo de: MindfulnessCapabilities.fsh =====

Instance: MindfulnessCapabilityStatement
InstanceOf: CapabilityStatement
Usage: #definition
Title: "Mindfulness Module Capabilities"
Description: "Capabilities supported by the mindfulness module implementation"

* status = #draft
* date = "2024-03-19"
* kind = #requirements
* fhirVersion = #4.0.1
* format[0] = #json
* format[1] = #xml

* rest[0]
  * mode = #server
  * documentation = "RESTful server capabilities for mindfulness data"
  
  * resource[0]
    * type = #Observation
    * documentation = "Supports mindfulness session observations"
    * profile = "https://github.com/RicardoLSantos/shorthand/StructureDefinition/mindfulness-observation"
    * interaction[0]
      * code = #read
    * interaction[1]
      * code = #create
    * interaction[2]
      * code = #update
    * interaction[3]
      * code = #search-type
    * searchParam[0]
      * name = "patient"
      * type = #reference
      * documentation = "Search by patient reference"
    * searchParam[1]
      * name = "date"
      * type = #date
      * documentation = "Search by session date"
    * searchParam[2]
      * name = "code"
      * type = #token
      * documentation = "Search by observation type"
      
  * resource[1]
    * type = #Questionnaire
    * documentation = "Supports mindfulness questionnaires"
    * profile = "https://github.com/RicardoLSantos/shorthand/StructureDefinition/mindfulness-questionnaire"
    * interaction[0]
      * code = #read
    * interaction[1]
      * code = #search-type
    * searchParam[0]
      * name = "title"
      * type = #string
      * documentation = "Search by questionnaire title"
      
  * resource[2]
    * type = #QuestionnaireResponse
    * documentation = "Supports mindfulness questionnaire responses"
    * profile = "https://github.com/RicardoLSantos/shorthand/StructureDefinition/mindfulness-questionnaire-response"
    * interaction[0]
      * code = #create
    * interaction[1]
      * code = #read
    * interaction[2]
      * code = #search-type
    * searchParam[0]
      * name = "patient"
      * type = #reference
      * documentation = "Search by patient reference"
    * searchParam[1]
      * name = "authored"
      * type = #date
      * documentation = "Search by response date"



// ===== Conteúdo de: MindfulnessQuestionnaires.fsh =====

Instance: DailyMindfulnessQuestionnaire
InstanceOf: Questionnaire
Usage: #definition
Title: "Daily Mindfulness Questionnaire"
Description: "Questionnaire for capturing daily mindfulness practice and associated effects"

* url = "https://github.com/RicardoLSantos/shorthand/Questionnaire/daily-mindfulness"
* status = #active
* title = "Daily Mindfulness Practice"
* subjectType = #Patient
* version = "1.0.0"
* name = "DailyMindfulnessQuestionnaire"
* date = "2024-03-19"

* item[0]
  * linkId = "mindful_session"
  * text = "Mindfulness Session"
  * type = #group
  * repeats = false

  * item[0]
    * linkId = "session_duration"
    * text = "Session duration (minutes)"
    * type = #integer
    * required = true
    * extension[0].url = "http://hl7.org/fhir/StructureDefinition/minValue"
    * extension[0].valueInteger = 1

  * item[1]
    * linkId = "practice_type"
    * text = "Practice type"
    * type = #choice
    * required = true
    * answerOption[0].valueString = "Meditation"
    * answerOption[1].valueString = "Breathing exercise"
    * answerOption[2].valueString = "Body scan"
    * answerOption[3].valueString = "Mindful walking"

* item[1]
  * linkId = "mood_assessment"
  * text = "Mood Assessment"
  * type = #group

  * item[0]
    * linkId = "current_mood"
    * text = "How is your mood now?"
    * type = #choice
    * required = true
    * answerValueSet = "https://github.com/RicardoLSantos/shorthand/fhir/ValueSet/mood-vs"

  * item[1]
    * linkId = "mood_intensity"
    * text = "Mood intensity (1-5)"
    * type = #integer
    * required = true

* item[2]
  * linkId = "stress_assessment"
  * text = "Stress Assessment"
  * type = #group

  * item[0]
    * linkId = "stress_level"
    * text = "Stress level (0-10)"
    * type = #integer
    * required = true

  * item[1]
    * linkId = "stress_symptoms"
    * text = "Stress symptoms"
    * type = #choice
    * repeats = true
    * answerOption[0].valueString = "Muscle tension"
    * answerOption[1].valueString = "Anxiety"
    * answerOption[2].valueString = "Headache"
    * answerOption[3].valueString = "Fatigue"

* item[3]
  * linkId = "relaxation"
  * text = "Relaxation"
  * type = #group

  * item[0]
    * linkId = "relaxation_duration"
    * text = "Relaxation time (minutes)"
    * type = #integer
    * required = true

  * item[1]
    * linkId = "relaxation_technique"
    * text = "Technique used"
    * type = #choice
    * required = true
    * answerOption[0].valueString = "Deep breathing"
    * answerOption[1].valueString = "Progressive relaxation"
    * answerOption[2].valueString = "Visualization"
    * answerOption[3].valueString = "Mindful awareness"



// ===== Conteúdo de: NutritionQuestionnaires.fsh =====

Instance: DailyNutritionQuestionnaire
InstanceOf: Questionnaire
Usage: #definition
Title: "Daily Nutrition Intake Questionnaire"
Description: "Questionnaire for daily nutrition intake tracking"

* url = "https://github.com/RicardoLSantos/shorthand/Questionnaire/daily-nutrition"
* version = "0.1.0"
* name = "DailyNutritionQuestionnaire"
* title = "Daily Nutrition Intake"
* status = #active
* experimental = false
* date = "2024-12-14"
* publisher = "Ricardo Lourenço dos Santos"

* item[0]
  * linkId = "water_intake"
  * text = "How much water did you drink today?"
  * type = #quantity
  * required = true
  * repeats = false
  * initial.valueQuantity = 0 'mL'

* item[1]
  * linkId = "meal_record"
  * text = "Meal Records"
  * type = #group
  * repeats = true

  * item[0]
    * linkId = "meal_time"
    * text = "Meal Time"
    * type = #dateTime
    * required = true

  * item[1]
    * linkId = "meal_type"
    * text = "Meal Type"
    * type = #choice
    * required = true
    * answerOption[0].valueString = "Breakfast"
    * answerOption[1].valueString = "Lunch"
    * answerOption[2].valueString = "Dinner"
    * answerOption[3].valueString = "Snack"

  * item[2]
    * linkId = "calories"
    * text = "Estimated Calories"
    * type = #integer
    * required = true

  * item[3]
    * linkId = "macronutrients"
    * text = "Macronutrients"
    * type = #group

    * item[0]
      * linkId = "carbs"
      * text = "Carbohydrates (g)"
      * type = #decimal
      * required = true

    * item[1]
      * linkId = "protein"
      * text = "Proteins (g)"
      * type = #decimal
      * required = true

    * item[2]
      * linkId = "fat"
      * text = "Fats (g)"
      * type = #decimal
      * required = true

* item[2]
  * linkId = "caffeine"
  * text = "Caffeine Intake"
  * type = #group

  * item[0]
    * linkId = "caffeine_amount"
    * text = "Caffeine amount (mg)"
    * type = #integer
    * required = false

  * item[1]
    * linkId = "caffeine_source"
    * text = "Caffeine source"
    * type = #choice
    * repeats = true
    * answerOption[0].valueString = "Coffee"
    * answerOption[1].valueString = "Tea"
    * answerOption[2].valueString = "Soft Drink"
    * answerOption[3].valueString = "Energy Drink"



// ===== Conteúdo de: ReproductiveQuestionnaire.fsh =====

Instance: ReproductiveHealthQuestionnaire
InstanceOf: Questionnaire
Usage: #definition
Title: "Reproductive Health Tracking Questionnaire"
Description: "Daily questionnaire for reproductive health tracking"
 
* status = #active
* url = "https://github.com/RicardoLSantos/shorthand/Questionnaire/reproductive-health"
* name = "ReproductiveHealthQuestionnaire"
* title = "Reproductive Health Monitoring"
* date = "2024-03-19"
 
* item[0]
  * linkId = "menstrual_cycle"
  * text = "Menstrual Cycle"
  * type = #group
 
  * item[0]
    * linkId = "cycle_start"
    * text = "Cycle started today?"
    * type = #boolean
 
  * item[1]
    * linkId = "flow_intensity"
    * text = "Flow intensity"
    * type = #choice
    * enableWhen
      * question = "cycle_start"
      * operator = #=
      * answerBoolean = true
    * answerOption[0].valueString = "Light"
    * answerOption[1].valueString = "Moderate"
    * answerOption[2].valueString = "Heavy"
 
* item[1]
  * linkId = "symptoms"
  * text = "Symptoms"
  * type = #group
  * repeats = true
 
  * item[0]
    * linkId = "symptom_type"
    * text = "Symptom type"
    * type = #choice
    * answerValueSet = "https://github.com/RicardoLSantos/shorthand/ValueSet/reproductive-symptoms"
 
  * item[1]
    * linkId = "symptom_severity"
    * text = "Intensity (0-10)"
    * type = #integer
    * extension[0]
      * url = "http://hl7.org/fhir/StructureDefinition/minValue"
      * valueInteger = 0
    * extension[1]
      * url = "http://hl7.org/fhir/StructureDefinition/maxValue"
      * valueInteger = 10
 
* item[2]
  * linkId = "mood_changes"
  * text = "Mood Changes"
  * type = #group

  * item[0]
    * linkId = "mood_type"
    * text = "Current mood"
    * type = #choice
    * answerValueSet = "https://github.com/RicardoLSantos/shorthand/ValueSet/mood-types"

  * item[1]
    * linkId = "mood_severity"
    * text = "Intensity (0-10)"
    * type = #integer
    * extension[0]
      * url = "http://hl7.org/fhir/StructureDefinition/minValue"
      * valueInteger = 0
    * extension[1]
      * url = "http://hl7.org/fhir/StructureDefinition/maxValue"
      * valueInteger = 10



// ===== Conteúdo de: aliases.fsh =====

Alias: SCT = http://snomed.info/sct
Alias: LOINC = http://loinc.org
Alias: UCUM = http://unitsofmeasure.org



// ===== Conteúdo de: MindfulnessTerminology.fsh =====

CodeSystem: MindfulnessOutcomeCS
Id: mindfulness-outcome-cs
Title: "Mindfulness Outcomes"
Description: "Outcomes and effects of mindfulness practice"

* ^experimental = false
* ^caseSensitive = true
* #increasedAwareness "Increased Awareness" "Greater awareness of thoughts and sensations"
* #improvedFocus "Improved Focus" "Enhanced ability to concentrate"
* #stressReduction "Stress Reduction" "Decreased levels of stress and tension"
* #emotionalBalance "Emotional Balance" "Better emotional regulation"
* #improvedSleep "Improved Sleep" "Enhanced sleep quality"

ValueSet: MindfulnessOutcomeVS
Id: mindfulness-outcome-vs
Title: "Mindfulness Outcomes Value Set"
Description: "Value set for mindfulness practice outcomes"

* ^experimental = false
* include codes from system MindfulnessOutcomeCS
* include $SCT#365949003 "Finding of level of stress"
* include $SCT#373931001 "Mood finding"

CodeSystem: MindfulnessQualifierCS
Id: mindfulness-qualifier-cs
Title: "Mindfulness Practice Qualifiers"
Description: "Qualifiers for mindfulness practice characteristics"

* ^experimental = false
* ^caseSensitive = true
* #guided "Guided Practice" "Practice with guidance or instruction"
* #selfDirected "Self-Directed" "Independent practice"
* #group "Group Practice" "Practice in group setting"
* #individual "Individual Practice" "Solo practice session"

ValueSet: MindfulnessQualifierVS
Id: mindfulness-qualifier-vs
Title: "Mindfulness Practice Qualifiers Value Set"
Description: "Value set for mindfulness practice qualifiers"

* ^experimental = false
* include codes from system MindfulnessQualifierCS
* include $SCT#410534003 "Guided meditation"
* include $SCT#225386006 "Exercise therapy"

* ^copyright = "This value set includes content from SNOMED CT, which is copyright © 2002+ International Health Terminology Standards Development Organisation (IHTSDO)"



// ===== Conteúdo de: MindfulnessConfig.fsh =====

Extension: MindfulnessSessionDuration
Id: mindfulness-session-duration
Title: "Mindfulness Session Duration"
Description: "Default duration for mindfulness sessions in minutes"
* value[x] only integer

Extension: MindfulnessReminderTime
Id: mindfulness-reminder-time
Title: "Mindfulness Reminder Time"
Description: "Default time for daily reminders"
* value[x] only time

Extension: MindfulnessPreferredGuide
Id: mindfulness-preferred-guide
Title: "Mindfulness Preferred Guide"
Description: "Preferred guide for mindfulness sessions"
* value[x] only string

Extension: MindfulnessNotificationEnabled
Id: mindfulness-notification-enabled
Title: "Mindfulness Notification Enabled"
Description: "Whether notifications are enabled for mindfulness sessions"
* value[x] only boolean

Profile: MindfulnessConfiguration
Parent: Basic
Id: mindfulness-configuration
Title: "Mindfulness Configuration"
Description: "Configuration settings for mindfulness sessions"

* code 1..1 MS
* code = https://github.com/RicardoLSantos/shorthand/CodeSystem/mindfulness-config-type#settings "Mindfulness Settings"

* extension contains
    MindfulnessSessionDuration named sessionDuration 1..1 MS and
    MindfulnessReminderTime named reminderTime 1..1 MS and
    MindfulnessPreferredGuide named preferredGuide 0..1 MS and
    MindfulnessNotificationEnabled named notificationEnabled 1..1 MS

Instance: DefaultMindfulnessConfig
InstanceOf: MindfulnessConfiguration
Title: "Default Mindfulness Configuration"
Description: "Default configuration settings for mindfulness sessions"

* code = https://github.com/RicardoLSantos/shorthand/CodeSystem/mindfulness-config-type#settings "Mindfulness Settings"
* extension[sessionDuration].valueInteger = 15
* extension[reminderTime].valueTime = "08:00:00"
* extension[preferredGuide].valueString = "Jane Smith"
* extension[notificationEnabled].valueBoolean = true



// ===== Conteúdo de: MindfulnessAuditConfig.fsh =====

Extension: MindfulnessAuditLevel
Id: mindfulness-audit-level
Title: "Mindfulness Audit Level"
Description: "Level of detail for audit records"
* value[x] only code
* valueCode from https://github.com/RicardoLSantos/shorthand/fhir/ValueSet/audit-levels (required)

Extension: MindfulnessAuditRetention
Id: mindfulness-audit-retention
Title: "Mindfulness Audit Retention"
Description: "Period to retain audit records"
* value[x] only Duration

Extension: MindfulnessAuditFormat
Id: mindfulness-audit-format
Title: "Mindfulness Audit Format"
Description: "Format for audit records"
* value[x] only code
* valueCode from https://github.com/RicardoLSantos/shorthand/fhir/ValueSet/audit-formats (required)

Profile: MindfulnessAuditConfig
Parent: Basic
Id: mindfulness-audit-config
Title: "Mindfulness Audit Configuration"
Description: "Configuration for mindfulness session auditing"

* code 1..1 MS
* code = https://github.com/RicardoLSantos/shorthand/CodeSystem/mindfulness-config-type#audit "Audit Configuration"

* extension contains
    MindfulnessAuditLevel named auditLevel 1..1 MS and
    MindfulnessAuditRetention named auditRetention 1..1 MS and
    MindfulnessAuditFormat named auditFormat 1..1 MS

Instance: DefaultAuditConfig
InstanceOf: MindfulnessAuditConfig
Title: "Default Audit Configuration"
Description: "Default configuration for mindfulness session auditing"

* code = https://github.com/RicardoLSantos/shorthand/CodeSystem/mindfulness-config-type#audit "Audit Configuration"
* extension[auditLevel].valueCode = #detailed
* extension[auditRetention].valueDuration = 90 'days'
* extension[auditFormat].valueCode = #fhir



// ===== Conteúdo de: MindfulnessSecurity.fsh =====

Instance: MindfulnessSecurityDefinition
InstanceOf: Consent
Usage: #definition
Title: "Mindfulness Data Security Policy"

* status = #active
* scope = http://terminology.hl7.org/CodeSystem/consentscope#patient-privacy
* category = http://loinc.org#59284-0 "Consent Document"

* policy[0]
  * authority = "https://github.com/RicardoLSantos/shorthand/privacy-policy"
  * uri = "https://github.com/RicardoLSantos/shorthand/mindfulness-privacy"

* provision
  * type = #permit
  * period
    * start = "2024-03-19"
  * actor[0]
    * role = http://terminology.hl7.org/CodeSystem/v3-ParticipationType#PRCP
    * reference
      * identifier.system = "https://github.com/RicardoLSantos/shorthand/practitioners"
      * identifier.value = "mindfulness-practitioners"

RuleSet: SecurityRequirements
* meta.security from http://terminology.hl7.org/ValueSet/v3-SecurityPolicy (required)
* meta.tag from http://terminology.hl7.org/ValueSet/v3-Confidentiality (required)

* extension contains
    http://hl7.org/fhir/StructureDefinition/resource-security-category named securityCategory 0..1 MS and
    http://hl7.org/fhir/StructureDefinition/patient-confidentiality named confidentiality 0..1 MS

Instance: MindfulnessAccessPolicy
InstanceOf: Consent
Usage: #definition
Title: "Mindfulness Data Access Policy"

* status = #active
* scope = http://terminology.hl7.org/CodeSystem/consentscope#patient-privacy
* category = http://loinc.org#59284-0 "Consent Document"

* policy[0]
  * authority = "https://github.com/RicardoLSantos/shorthand/access-policy"
  * uri = "https://github.com/RicardoLSantos/shorthand/mindfulness-access"

* provision
  * type = #permit
  * period
    * start = "2024-03-19"
  * actor[0]
    * role = http://terminology.hl7.org/CodeSystem/v3-ParticipationType#PRCP
    * reference
      * identifier.system = "https://github.com/RicardoLSantos/shorthand/practitioners"
      * identifier.value = "mindfulness-practitioners"
  * action = http://terminology.hl7.org/CodeSystem/consentaction#access "Access"



// ===== Conteúdo de: MindfulnessResources.fsh =====

CodeSystem: MindfulnessTypeCS
Id: mindfulness-type-cs
Title: "Mindfulness Practice Types"
Description: "Types of mindfulness practices and techniques"
* ^experimental = false
* ^caseSensitive = true
* #meditation "Meditation" "Focused meditation practice"
* #breathing "Breathing Exercise" "Conscious breathing techniques"
* #bodyScan "Body Scan" "Progressive body awareness practice"
* #walking "Mindful Walking" "Walking meditation practice"
* #movement "Mindful Movement" "Conscious movement practice"

CodeSystem: EnvironmentTypeCS
Id: environment-type-cs
Title: "Practice Environment Types"
Description: "Types of environments for mindfulness practice"
* ^experimental = false
* ^caseSensitive = true
* #indoor "Indoor" "Indoor environment"
* #outdoor "Outdoor" "Outdoor environment"
* #quiet "Quiet Space" "Quiet or silent environment"
* #group "Group Setting" "Group practice environment"

ValueSet: MindfulnessTypeVS
Id: mindfulness-type-vs
Title: "Mindfulness Practice Types Value Set"
Description: "Value set of mindfulness practice types"
* ^experimental = false
* include codes from system MindfulnessTypeCS

ValueSet: EnvironmentTypeVS
Id: environment-type-vs
Title: "Practice Environment Types Value Set"
Description: "Value set of practice environment types"
* ^experimental = false
* include codes from system EnvironmentTypeCS

Instance: MindfulnessSettingCS
InstanceOf: CodeSystem
Usage: #definition
* url = "https://github.com/RicardoLSantos/shorthand/CodeSystem/mindfulness-setting"
* version = "1.0.0"
* name = "MindfulnessSettingCS"
* title = "Mindfulness Setting CodeSystem"
* status = #active
* experimental = false
* caseSensitive = true
* content = #complete
* count = 5
* concept[+].code = #home
* concept[=].display = "Home Practice"
* concept[+].code = #clinic
* concept[=].display = "Clinical Setting"
* concept[+].code = #group
* concept[=].display = "Group Setting"
* concept[+].code = #retreat
* concept[=].display = "Retreat Setting"
* concept[+].code = #workplace
* concept[=].display = "Workplace Setting"



// ===== Conteúdo de: code-replacements.fsh =====

// SUBSTITUIÇÕES DE CÓDIGOS CONFIRMADAS COMO VÁLIDAS

// Walking - usar código LOINC correto
Alias: WALKING_SPEED = http://loinc.org#41950-7 "Number of steps in 24 hour"

// Sleep - códigos LOINC válidos
Alias: SLEEP_DURATION = http://loinc.org#93832-4 "Sleep duration"

// Mindfulness - usar código genérico de terapia
Alias: MINDFULNESS = http://snomed.info/sct#182840001 "Drug treatment education"

// Body Composition - usar códigos que existem
Alias: BODY_FAT = http://loinc.org#41982-0 "Percentage of body fat Measured"

// UV Exposure - usar código ambiental genérico  
Alias: UV_EXPOSURE = http://loinc.org#82612-7 "UV index"



// ===== Conteúdo de: MindfulnessNarrative.fsh =====

RuleSet: MindfulnessObservationNarrative
* text.status = #generated
* text.div = "<div xmlns=\"http://www.w3.org/1999/xhtml\">
    <p><b>Generated Narrative</b></p>
    <p><b>Session Type:</b> Mindfulness Practice Session</p>
    <p><b>Date:</b> {effectiveDateTime}</p>
    <p><b>Duration:</b> {component[sessionDuration].value} minutes</p>
    <p><b>Stress Level:</b> {component[stressLevel].value} / 10</p>
    <p><b>Mood:</b> {component[moodState].value}</p>
    <p><b>Technique:</b> {component[relaxationResponse].value}</p>
    <p><b>Location:</b> {extension[mindfulness-context].extension[location].value}</p>
  </div>"

RuleSet: MindfulnessQuestionnaireNarrative
* text.status = #generated
* text.div = "<div xmlns=\"http://www.w3.org/1999/xhtml\">
    <p><b>Generated Narrative</b></p>
    <p><b>Title:</b> {title}</p>
    <p><b>Status:</b> {status}</p>
    <h3>Sections</h3>
    <ul>
      <li>Mindfulness Session</li>
      <li>Mood Assessment</li>
      <li>Stress Assessment</li>
      <li>Relaxation</li>
    </ul>
  </div>"

RuleSet: MindfulnessResponseNarrative
* text.status = #generated
* text.div = "<div xmlns=\"http://www.w3.org/1999/xhtml\">
    <p><b>Generated Narrative</b></p>
    <p><b>Date:</b> {authored}</p>
    <p><b>Session Duration:</b> {item[session_duration].answer.value} minutes</p>
    <p><b>Practice Type:</b> {item[practice_type].answer.value}</p>
    <p><b>Mood:</b> {item[current_mood].answer.value}</p>
    <p><b>Stress Level:</b> {item[stress_level].answer.value} / 10</p>
    <p><b>Relaxation Technique:</b> {item[relaxation_technique].answer.value}</p>
  </div>"

RuleSet: MindfulnessConfigNarrative
* text.status = #generated
* text.div = "<div xmlns=\"http://www.w3.org/1999/xhtml\">
    <p><b>Generated Narrative</b></p>
    <p><b>Default Duration:</b> {extension[defaultDuration].value} minutes</p>
    <p><b>Reminders:</b> {extension[reminderSettings].value}</p>
    <p><b>Data Sync:</b> {extension[dataSync].value}</p>
  </div>"



// ===== Conteúdo de: StressInvariants.fsh =====

Invariant: stress-level-range
Description: "Stress level score must be between 0 and 10"
Expression: "valueQuantity.exists() implies (valueQuantity.value >= 0 and valueQuantity.value <= 10)"
Severity: #error

Invariant: stress-component-consistency
Description: "Physiological and psychological stress scores must be consistent with overall score"
Expression: "component.where(code.coding.code='89593-8').value.exists() and component.where(code.coding.code='89594-6').value.exists() implies (component.where(code.coding.code='89593-8').value + component.where(code.coding.code='89594-6').value) div 2 = valueQuantity"
Severity: #warning



// ===== Conteúdo de: SocialInteractionInvariants.fsh =====

Invariant: social-interaction-duration
Description: "Social interaction duration must be positive"
Expression: "component.where(code.coding.code='89597-9').value.exists() implies component.where(code.coding.code='89597-9').value > 0"
Severity: #error

Invariant: social-interaction-participants
Description: "Number of participants must be at least 2 for social interaction"
Expression: "component.where(code.coding.code='89600-1').value.exists() implies component.where(code.coding.code='89600-1').value >= 2"
Severity: #error



// ===== Conteúdo de: MindfulnessInvariants.fsh =====

Invariant: mindfulness-session-duration
Description: "Mindfulness session duration must be between 1 and 180 minutes"
Expression: "component.where(code.coding.system='http://snomed.info/sct' and code.coding.code='118682006').value.ofType(Quantity).value.exists() implies (component.where(code.coding.system='http://snomed.info/sct' and code.coding.code='118682006').value.ofType(Quantity).value >= 1 and component.where(code.coding.system='http://snomed.info/sct' and code.coding.code='118682006').value.ofType(Quantity).value <= 180)"
Severity: #error

Invariant: mindfulness-stress-level
Description: "Stress level must be between 0 and 10"
Expression: "component.where(code.coding.system='http://snomed.info/sct' and code.coding.code='725854004').value.ofType(Integer).exists() implies (component.where(code.coding.system='http://snomed.info/sct' and code.coding.code='725854004').value.ofType(Integer) >= 0 and component.where(code.coding.system='http://snomed.info/sct' and code.coding.code='725854004').value.ofType(Integer) <= 10)"
Severity: #error

Invariant: mindfulness-mood-required
Description: "Mood assessment must include a mood state and intensity"
Expression: "component.where(code.coding.system='http://snomed.info/sct' and code.coding.code='373931001').exists() implies component.where(code.coding.system='http://snomed.info/sct' and code.coding.code='373931001').value.exists()"
Severity: #warning

Invariant: mindfulness-context-complete
Description: "Mindfulness context should include location and environment"
Expression: "extension.where(url='https://github.com/RicardoLSantos/shorthand/StructureDefinition/mindfulness-context').exists() implies (extension.where(url='https://github.com/RicardoLSantos/shorthand/StructureDefinition/mindfulness-context').extension.where(url='location').exists() and extension.where(url='https://github.com/RicardoLSantos/shorthand/StructureDefinition/mindfulness-context').extension.where(url='environment').exists())"
Severity: #warning

Invariant: sequential-measurements
Description: "Sequential measurements must have increasing effectiveDateTime"
Expression: "component.where(code.coding.system='http://snomed.info/sct' and code.coding.code='118682006').exists() implies (effectiveDateTime > previous().effectiveDateTime)"
Severity: #warning



// ===== Conteúdo de: MindfulnessOperations.fsh =====

Profile: MindfulnessOperation
Parent: OperationDefinition 
Id: mindfulness-operation
Title: "Mindfulness Operation"
Description: "Base definition for mindfulness operations"

* status 1..1
* kind 1..1
* name 1..1
* code 1..1
* resource 1..1
* system 1..1
* type 1..1
* instance 1..1
* parameter 0..*
* parameter.name 1..1

Instance: StartSessionOperation
InstanceOf: MindfulnessOperation
Title: "Start Session Operation"
Description: "Operation to start a new mindfulness session"

* status = #active
* kind = #operation
* name = "start-session"
* code = #start
* resource = #Observation
* system = false
* type = true
* instance = false
* parameter[+]
  * name = #duration
  * use = #in
  * min = 1
  * max = "1" 
  * type = #integer
  * documentation = "Duration in minutes"

Instance: EndSessionOperation
InstanceOf: MindfulnessOperation
Title: "End Session Operation"
Description: "Operation to end an ongoing mindfulness session"

* status = #active
* kind = #operation
* name = "end-session"
* code = #end
* resource = #Observation
* system = false
* type = true
* instance = true
* parameter[+]
  * name = #session
  * use = #in
  * min = 1
  * max = "1"
  * type = #string
  * documentation = "ID of the session to end"



// ===== Conteúdo de: VitalSignsExtensions.fsh =====

Extension: MeasurementContext
Id: measurement-context
Title: "Measurement Context Extension"
Description: "Additional context about the vital sign measurement"
* value[x] only CodeableConcept
* valueCodeableConcept from MeasurementContextVS (required)

ValueSet: MeasurementContextVitalSigns
Id: measurement-context-vital-signs
Title: "Measurement Context Value Set"
* $SCT#255214003 "At rest"
* $SCT#309604004 "During exercise"
* $SCT#309605003 "Post exercise"
* $SCT#248626006 "During sleep"



// ===== Conteúdo de: NutritionExtensions.fsh =====

Extension: NutritionDataSource
Id: nutrition-data-source
Title: "Nutrition Data Source Extension"
Description: "Indicates the source of nutrition data"

* ^version = "0.1.0"
* ^status = #draft
* ^experimental = false
* ^date = "2024-12-14"
* ^publisher = "Ricardo Lourenço dos Santos"
* ^context[0].type = #element
* ^context[0].expression = "Observation"

* value[x] only CodeableConcept
* valueCodeableConcept from NutritionDataSourceVS (required)

ValueSet: NutritionDataSourceVS
Id: nutrition-data-source-vs
Title: "Nutrition Data Source Value Set"
Description: "Value set for nutrition data sources"

* ^version = "0.1.0"
* ^status = #draft
* ^experimental = false
* ^date = "2024-12-14"
* ^publisher = "Ricardo Lourenço dos Santos"

* codes from system NutritionDataSourceCS

CodeSystem: NutritionDataSourceCS
Id: nutrition-data-source-cs
Title: "Nutrition Data Source Code System"
Description: "Code system for nutrition data sources"

* ^version = "0.1.0"
* ^status = #draft
* ^experimental = false
* ^date = "2024-12-14"
* ^publisher = "Ricardo Lourenço dos Santos"
* ^caseSensitive = true

* #manual "Manual Entry" "Data entered manually by user"
* #app "App Integration" "Data from integrated third-party apps"
* #device "Connected Device" "Data from connected nutrition tracking devices"
* #questionnaire "Questionnaire Response" "Data collected through questionnaires"



// ===== Conteúdo de: AdvancedVitalSignsExtensions.fsh =====

Alias: $UCUM = http://unitsofmeasure.org

Extension: PhysiologicalStressIndex
Id: physiological-stress-index
Title: "Physiological Stress Index Extension"
Description: "Index representing overall physiological stress based on multiple parameters"

* ^version = "0.1.0"
* ^status = #draft
* ^context[+].type = #element
* ^context[=].expression = "Observation"

* value[x] only Quantity
* valueQuantity.system = $UCUM
* valueQuantity.code = #{index}
* valueQuantity ^short = "Physiological stress index value"
* valueQuantity ^definition = "Normalized index value representing overall physiological stress"

Extension: HomeostasisIndex
Id: homeostasis-index
Title: "Homeostasis Index Extension"
Description: "Composite measure of physiological balance and adaptation"

* ^version = "0.1.0"
* ^status = #draft
* ^context[+].type = #element
* ^context[=].expression = "Observation"

* value[x] only Quantity
* valueQuantity.system = $UCUM
* valueQuantity.code = #{ratio}
* valueQuantity ^short = "Homeostasis index value"
* valueQuantity ^definition = "Normalized ratio representing physiological balance"

Extension: RecoveryEfficiency
Id: recovery-efficiency
Title: "Recovery Efficiency Extension"
Description: "Measure of how efficiently the body recovers from stress or exertion"

* ^version = "0.1.0"
* ^status = #draft
* ^context[+].type = #element
* ^context[=].expression = "Observation"

* value[x] only Quantity
* valueQuantity.system = $UCUM
* valueQuantity.code = #%
* valueQuantity ^short = "Recovery efficiency percentage"
* valueQuantity ^definition = "Percentage indicating recovery efficiency"

Extension: AllostaticLoad
Id: allostatic-load
Title: "Allostatic Load Extension"
Description: "Measure of cumulative physiological burden over time"

* ^version = "0.1.0"
* ^status = #draft
* ^context[+].type = #element
* ^context[=].expression = "Observation"

* value[x] only Quantity
* valueQuantity.system = $UCUM
* valueQuantity.code = #{score}
* valueQuantity ^short = "Allostatic load score"
* valueQuantity ^definition = "Score representing cumulative physiological burden"

Extension: CircadianPhase
Id: circadian-phase
Title: "Circadian Phase Extension"
Description: "Indicator of position in circadian rhythm cycle"

* ^version = "0.1.0"
* ^status = #draft
* ^context[+].type = #element
* ^context[=].expression = "Observation"

* value[x] only CodeableConcept
* valueCodeableConcept from CircadianPhaseVS (required)

ValueSet: CircadianPhaseVS
Id: circadian-phase-vs
Title: "Circadian Phase Value Set"
Description: "Value set for circadian rhythm phases"

* ^experimental = true
* codes from system CircadianPhaseCS

CodeSystem: CircadianPhaseCS
Id: circadian-phase-cs
Title: "Circadian Phase Code System"
Description: "Code system for circadian rhythm phases"

* ^experimental = true
* ^caseSensitive = true

* #early-morning "Early Morning Phase" "Period shortly after awakening"
* #mid-morning "Mid Morning Phase" "Mid-morning period"
* #afternoon "Afternoon Phase" "Afternoon period"
* #evening "Evening Phase" "Evening period"
* #night "Night Phase" "Nighttime period"
* #deep-night "Deep Night Phase" "Deep night period"

Extension: MeasurementQuality
Id: measurement-quality
Title: "Measurement Quality Extension"
Description: "Indicator of the quality and reliability of the measurement"

* ^version = "0.1.0"
* ^status = #draft
* ^context[+].type = #element
* ^context[=].expression = "Observation"

* value[x] only CodeableConcept
* valueCodeableConcept from MeasurementQualityVS (required)

ValueSet: MeasurementQualityVS
Id: measurement-quality-vs
Title: "Measurement Quality Value Set"
Description: "Value set for measurement quality indicators"

* ^experimental = true
* codes from system MeasurementQualityCS

CodeSystem: MeasurementQualityCS
Id: measurement-quality-cs
Title: "Measurement Quality Code System"
Description: "Code system for measurement quality indicators"

* ^experimental = true
* ^caseSensitive = true

* #excellent "Excellent Quality" "High quality measurement with minimal noise"
* #good "Good Quality" "Good quality measurement with acceptable noise"
* #fair "Fair Quality" "Fair quality measurement with some interference"
* #poor "Poor Quality" "Poor quality measurement with significant interference"
* #unreliable "Unreliable" "Unreliable measurement requiring verification"



// ===== Conteúdo de: StressExtensions.fsh =====

Extension: StressTriggers
Id: stress-triggers
Title: "Stress Triggers Extension"
Description: "Extension for recording identified stress triggers"
* value[x] only CodeableConcept
* valueCodeableConcept from StressTriggersVS (required)

Extension: StressCoping
Id: stress-coping
Title: "Stress Coping Extension"
Description: "Extension for recording stress coping mechanisms"
* value[x] only CodeableConcept
* valueCodeableConcept from StressCopingVS (required)

ValueSet: StressTriggersVS
Id: stress-triggers-vs
Title: "Stress Triggers Value Set"
Description: "Value set for common stress triggers"
* codes from system StressTriggersCS

ValueSet: StressCopingVS
Id: stress-coping-vs
Title: "Stress Coping Value Set"
Description: "Value set for stress coping mechanisms"
* codes from system StressCopingCS

CodeSystem: StressTriggersCS
Id: stress-triggers-cs
Title: "Stress Triggers Code System"
Description: "Code system for common stress triggers"
* #work "Work-related" "Stress from work or professional activities"
* #financial "Financial" "Financial-related stress"
* #relationships "Relationships" "Stress from personal relationships"
* #health "Health" "Health-related concerns"
* #environment "Environmental" "Environmental factors"
* #time "Time Management" "Time pressure and deadlines"
* #change "Life Changes" "Major life changes or transitions"

CodeSystem: StressCopingCS
Id: stress-coping-cs
Title: "Stress Coping Code System"
Description: "Code system for stress coping mechanisms"
* #exercise "Physical Exercise" "Using exercise to manage stress"
* #meditation "Meditation" "Meditation and mindfulness practices"
* #social "Social Support" "Seeking social support"
* #professional "Professional Help" "Seeking professional assistance"
* #relaxation "Relaxation" "Relaxation techniques"
* #creative "Creative Activities" "Engaging in creative activities"
* #nature "Nature" "Spending time in nature"



// ===== Conteúdo de: EnvironmentalExtensions.fsh =====

Extension: ExposureLocation
Id: exposure-location
Title: "Exposure Location Extension"
Description: "Extension for recording location of environmental exposure measurement"

* ^version = "0.1.0"
* ^status = #draft
* ^context[+].type = #element
* ^context[=].expression = "Observation"

* value[x] only CodeableConcept
* valueCodeableConcept from ExposureLocationVS (required)
* valueCodeableConcept ^short = "Location type of exposure"
* valueCodeableConcept ^definition = "Categorizes the type of location where environmental exposure occurred"

Extension: ExposureConditions
Id: exposure-conditions
Title: "Exposure Conditions Extension"
Description: "Additional conditions during environmental exposure measurement"

* ^version = "0.1.0"
* ^status = #draft
* ^context[+].type = #element
* ^context[=].expression = "Observation"

* value[x] only CodeableConcept
* valueCodeableConcept from ExposureConditionsVS (required)
* valueCodeableConcept ^short = "Conditions during exposure"

ValueSet: ExposureLocationVS
Id: exposure-location-vs
Title: "Exposure Location Value Set"
Description: "Value set for environmental exposure locations"

* ^version = "0.1.0"
* ^status = #draft
* ^experimental = true
* codes from system ExposureLocationCS

ValueSet: ExposureConditionsVS
Id: exposure-conditions-vs
Title: "Exposure Conditions Value Set"
Description: "Value set for environmental exposure conditions"

* ^version = "0.1.0"
* ^status = #draft
* ^experimental = true
* codes from system ExposureConditionsCS

CodeSystem: ExposureLocationCS
Id: exposure-location-cs
Title: "Exposure Location Code System"
Description: "Code system for environmental exposure locations"

* ^version = "0.1.0"
* ^status = #draft
* ^caseSensitive = true
* ^experimental = true

* #indoor "Indoor environment" "Environment within buildings or enclosed spaces"
* #outdoor "Outdoor environment" "Open-air environment"
* #workplace "Workplace" "Professional or occupational environment"
* #transit "In transit" "While in transportation or commuting"
* #recreational "Recreational area" "Leisure or sports facilities"
* #urban "Urban area" "City or densely populated area"
* #rural "Rural area" "Countryside or sparsely populated area"

CodeSystem: ExposureConditionsCS
Id: exposure-conditions-cs
Title: "Exposure Conditions Code System"
Description: "Code system for conditions during environmental exposure"

* ^version = "0.1.0"
* ^status = #draft
* ^caseSensitive = true
* ^experimental = true

* #normal "Normal conditions" "Standard environmental conditions"
* #extreme "Extreme conditions" "Unusual or severe environmental conditions"
* #controlled "Controlled environment" "Environment with controlled conditions"
* #variable "Variable conditions" "Changing environmental conditions"



// ===== Conteúdo de: BodyMetricsExtensions.fsh =====

Alias: $SCT = http://snomed.info/sct

Extension: MeasurementConditions
Id: measurement-conditions
Title: "Measurement Conditions Extension"
Description: "Records the conditions under which body measurements were taken"

* ^version = "0.1.0"
* ^status = #draft
* ^context[0].type = #element
* ^context[0].expression = "Observation"

* value[x] only CodeableConcept
* valueCodeableConcept from MeasurementConditionsVS (required)

Extension: MeasurementDevice
Id: measurement-device-type
Title: "Measurement Device Type Extension"
Description: "Specifies the type of device used for body measurements"

* ^version = "0.1.0"
* ^status = #draft
* ^context[0].type = #element
* ^context[0].expression = "Observation"

* value[x] only CodeableConcept
* valueCodeableConcept from MeasurementDeviceTypeVS (required)

ValueSet: MeasurementConditionsVS
Id: measurement-conditions-vs
Title: "Measurement Conditions Value Set"
Description: "Standard conditions under which measurements are taken"

* ^version = "0.1.0"
* ^status = #draft

* $SCT#307818003 "Pre-breakfast"
* $SCT#307819006 "Post-exercise"
* $SCT#307820000 "Wearing light clothing"
* $SCT#255203001 "First thing in morning"
* $SCT#255214005 "After void"
* $SCT#309604004 "During rest"

ValueSet: MeasurementDeviceTypeVS
Id: measurement-device-type-vs
Title: "Measurement Device Type Value Set"
Description: "Types of devices used for health and body measurements"

* ^version = "0.1.0"
* ^status = #draft

* $SCT#469576000 "Smart watch"
* $SCT#706767009 "Body composition analyzer"
* $SCT#131009002 "Height measuring device"
* $SCT#706889009 "Blood pressure monitor"
* $SCT#444699000 "Tape measure"
* $SCT#44056008  "Digital scale"

Instance: WeightWithConditions
InstanceOf: WeightObservation
Usage: #example
Title: "Weight Measurement with Conditions Example"

* status = #final
* category = http://terminology.hl7.org/CodeSystem/observation-category#vital-signs
* code = $LOINC#29463-7 "Body weight"
* subject = Reference(Patient/example)
* effectiveDateTime = "2024-03-19T08:00:00Z"
* valueQuantity = 70.5 'kg'

* extension[measurement-conditions].url = "https://github.com/RicardoLSantos/shorthand/StructureDefinition/measurement-conditions"
* extension[measurement-conditions].valueCodeableConcept = $SCT#307818003 "Pre-breakfast"

* extension[measurement-device-type].url = "https://github.com/RicardoLSantos/shorthand/StructureDefinition/measurement-device-type"
* extension[measurement-device-type].valueCodeableConcept = $SCT#469576000 "Smart scale device"



// ===== Conteúdo de: SleepQuality.fsh =====

Extension: SleepQuality
Id: sleep-quality
Title: "Sleep Quality Extension"
Description: "Extension for recording subjective sleep quality"
* value[x] only CodeableConcept
* valueCodeableConcept from SleepQualityExtendedVS (required)
 
ValueSet: SleepQualityExtendedVS
Id: sleep-quality-extended-vs
Title: "Sleep Quality Value Set"
* $SCT#248220008 "Very good quality sleep"
* $SCT#248221007 "Good quality sleep"
* $SCT#248222000 "Poor quality sleep"
* $SCT#248223005 "Very poor quality sleep"



// ===== Conteúdo de: MindfulnessExtensions.fsh =====

Extension: MindfulnessContext
Id: mindfulness-context
Title: "Mindfulness Session Context"
Description: "Additional context about the mindfulness practice session"

* ^url = "https://github.com/RicardoLSantos/shorthand/StructureDefinition/mindfulness-context"
* ^version = "1.0.0"
* ^status = #draft
* ^date = "2024-03-19"
* ^publisher = "Example Organization"

* extension contains
    location 0..1 and
    environment 0..1 and
    guidance 0..1

* extension[location].value[x] only string
* extension[location].valueString 1..1
* extension[location] ^short = "Physical location of practice"
* extension[location] ^definition = "The physical location where the mindfulness practice took place"

* extension[environment].value[x] only CodeableConcept
* extension[environment].valueCodeableConcept from https://github.com/RicardoLSantos/shorthand/ValueSet/environment-type (required)
* extension[environment] ^short = "Environmental conditions"
* extension[environment] ^definition = "The environmental conditions during the practice session"

* extension[guidance].value[x] only boolean
* extension[guidance].valueBoolean 1..1
* extension[guidance] ^short = "Whether guidance was used"
* extension[guidance] ^definition = "Indicates if the session was guided or self-directed"



// ===== Conteúdo de: SocialInteractionExtensions.fsh =====

Extension: SocialContext
Id: social-context
Title: "Social Context Extension"
Description: "Extension for recording the context of social interaction"
* value[x] only CodeableConcept
* valueCodeableConcept from SocialContextVS (required)

Extension: SocialSupport
Id: social-support
Title: "Social Support Extension"
Description: "Extension for recording perceived social support"
* value[x] only CodeableConcept
* valueCodeableConcept from SocialSupportVS (required)

Extension: SocialActivity
Id: social-activity
Title: "Social Activity Extension"
Description: "Extension for recording specific social activities"
* value[x] only CodeableConcept
* valueCodeableConcept from SocialActivityVS (required)

ValueSet: SocialContextVS
Id: social-context-vs
Title: "Social Context Value Set"
Description: "Value set for social interaction contexts"
* codes from system SocialContextCS

ValueSet: SocialSupportVS
Id: social-support-vs
Title: "Social Support Value Set"
Description: "Value set for levels of social support"
* codes from system SocialSupportCS

ValueSet: SocialActivityVS
Id: social-activity-vs
Title: "Social Activity Value Set"
Description: "Value set for types of social activities"
* codes from system SocialActivityCS

CodeSystem: SocialContextCS
Id: social-context-cs
Title: "Social Context Code System"
Description: "Code system for social interaction contexts"
* #home "Home" "Home environment"
* #work "Work" "Work environment"
* #education "Educational" "Educational setting"
* #community "Community" "Community setting"
* #recreational "Recreational" "Recreational setting"
* #healthcare "Healthcare" "Healthcare setting"

CodeSystem: SocialSupportCS
Id: social-support-cs
Title: "Social Support Code System"
Description: "Code system for levels of social support"
* #strong "Strong Support" "Strong social support network"
* #adequate "Adequate Support" "Sufficient social support"
* #limited "Limited Support" "Limited social support"
* #minimal "Minimal Support" "Minimal social support"
* #none "No Support" "Absence of social support"

CodeSystem: SocialActivityCS
Id: social-activity-cs
Title: "Social Activity Code System"
Description: "Code system for types of social activities"
* #meal "Shared Meal" "Sharing a meal together"
* #exercise "Group Exercise" "Group physical activity"
* #entertainment "Entertainment" "Shared entertainment activity"
* #learning "Learning" "Group learning activity"
* #volunteering "Volunteering" "Community service activity"
* #celebration "Celebration" "Social celebration or event"



// ===== Conteúdo de: SleepExtensions.fsh =====




// ===== Conteúdo de: MobilityExtensions.fsh =====

Extension: MobilityAlertLevel
Id: mobility-alert-level
Title: "Mobility Alert Level Extension"
Description: "Extension for mobility measurements alert levels to indicate the severity or concern level of mobility changes detected by the device"
* ^status = #active
* ^context[0].type = #element
* ^context[0].expression = "Observation"
* . ^short = "Mobility alert level indicator"
* . ^definition = "Indicates the severity level of mobility changes or concerns based on device measurements"
* value[x] only CodeableConcept
* valueCodeableConcept from MobilityAlertLevelVS (required)
* valueCodeableConcept ^short = "Alert level code"
* valueCodeableConcept ^definition = "The specific alert level code indicating the severity of mobility changes"

ValueSet: MobilityAlertLevelVS
Id: mobility-alert-level-vs
Title: "Mobility Alert Level Value Set"
Description: "Value set for mobility measurement alert levels used to categorize the severity of mobility changes or concerns"
* ^status = #active
* ^experimental = false
* ^purpose = "To provide standardized alert levels for mobility measurements"
* codes from system MobilityAlertLevelCS

CodeSystem: MobilityAlertLevelCS
Id: mobility-alert-level-cs
Title: "Mobility Alert Level Code System"
Description: "Code system defining alert levels for mobility measurements, indicating the severity of changes in mobility patterns"
* ^status = #active
* ^experimental = false
* ^caseSensitive = true
* ^content = #complete
* #green "Normal - No concern" "Mobility measurements are within normal range and show no concerning patterns"
* #yellow "Caution - Monitor closely" "Mobility measurements show slight deviations that warrant closer monitoring"
* #red "Alert - Significant change" "Mobility measurements indicate significant changes that require immediate attention"
* ^property[0].code = #status
* ^property[0].type = #code
* ^property[0].description = "The status of the alert level"
* ^property[1].code = #severity
* ^property[1].type = #integer
* ^property[1].description = "Numeric value indicating severity (1=low, 3=high)"



// ===== Conteúdo de: ActivityExtensions.fsh =====




// ===== Conteúdo de: MobilityRiskValueSets.fsh =====

ValueSet: FallRiskOutcomesValueSet
Id: fall-risk-outcomes
Title: "Fall Risk Outcomes Value Set"
Description: "Value set for fall risk assessment outcomes"
* ^url = "https://github.com/RicardoLSantos/shorthand/fhir/ValueSet/fall-risk-outcomes"
* ^status = #active
* include codes from system https://github.com/RicardoLSantos/shorthand/fhir/CodeSystem/fall-risk-outcomes

ValueSet: RiskLevelValueSet
Id: risk-level
Title: "Risk Level Value Set"
Description: "Value set for general risk levels"
* ^url = "https://github.com/RicardoLSantos/shorthand/fhir/ValueSet/risk-level"
* ^status = #active
* include codes from system https://github.com/RicardoLSantos/shorthand/fhir/CodeSystem/risk-level

ValueSet: MobilityDeclineOutcomesValueSet
Id: mobility-decline-outcomes
Title: "Mobility Decline Outcomes Value Set"
Description: "Value set for mobility decline assessment outcomes"
* ^url = "https://github.com/RicardoLSantos/shorthand/fhir/ValueSet/mobility-decline-outcomes"
* ^status = #active
* include codes from system https://github.com/RicardoLSantos/shorthand/fhir/CodeSystem/mobility-decline-outcomes

ValueSet: AssistanceLevelOutcomesValueSet
Id: assistance-level-outcomes
Title: "Assistance Level Outcomes Value Set"
Description: "Value set for assistance level assessment outcomes"
* ^url = "https://github.com/RicardoLSantos/shorthand/fhir/ValueSet/assistance-level-outcomes"
* ^status = #active
* include codes from system https://github.com/RicardoLSantos/shorthand/fhir/CodeSystem/assistance-level-outcomes



// ===== Conteúdo de: SymptomValueSets.fsh =====

CodeSystem: SymptomSeverityCS
Id: symptom-severity-cs
Title: "Symptom Severity Code System"
Description: "Severity levels for symptoms"

* #1-3 "Light" "Symptom barely noticeable"
* #4-6 "Mild" "Symptom noticeable but not interfering with daily activities"
* #7-8 "Intense" "Symptom interfering with daily activities"
* #9-10 "Severe" "Symptom preventing daily activities"

ValueSet: BodyLocationsVS
Id: body-locations-vs
Title: "Body Locations Value Set"
Description: "Anatomical locations for symptom recording"
* $SCT#12738006 "Brain"
* $SCT#69536005 "Head"
* $SCT#45048000 "Neck"
* $SCT#51185008 "Chest"
* $SCT#62413002 "Abdomen"
* $SCT#32849002 "Back"
* $SCT#53120007 "Upper limb"
* $SCT#61685007 "Lower limb"

ValueSet: DurationUnitsVS
Id: duration-units-vs
Title: "Duration Units Value Set"
Description: "Time units for symptom duration"
* $UCUM#min "Minutes"
* $UCUM#h "Hours"
* $UCUM#d "Days"
* $UCUM#wk "Weeks"
* $UCUM#mo "Months"

CodeSystem: SymptomFrequencyCS
Id: symptom-frequency-cs
Title: "Symptom Frequency Code System"
Description: "Frequency patterns for symptoms"
* #rare "Rare" "Less than once per month"
* #occasional "Occasional" "Several times per month"
* #frequent "Frequent" "Several times per week"
* #daily "Daily" "Once or more per day"
* #constant "Constant" "Present most of the time"

ValueSet: SymptomFrequencyVS
Id: symptom-frequency-vs
Title: "Symptom Frequency Value Set"
Description: "Frequency patterns for symptoms"
* codes from system SymptomFrequencyCS

CodeSystem: SymptomImpactCS
Id: symptom-impact-cs
Title: "Symptom Impact Code System"
Description: "Impact levels of symptoms on daily activities"
* #none "No impact"
* #mild "Mild impact"
* #moderate "Moderate impact"
* #severe "Severe impact"
* #complete "Complete impact"

ValueSet: SymptomImpactVS
Id: symptom-impact-vs
Title: "Symptom Impact Value Set"
Description: "Impact levels for symptoms"
* codes from system SymptomImpactCS

ValueSet: SymptomProgressionVS
Id: symptom-progression-vs
Title: "Symptom Progression Value Set"
Description: "Progression patterns for symptoms"
* $SCT#385633008 "Improving"
* $SCT#58158008 "Stable"
* $SCT#230993007 "Worsening"
* $SCT#255314001 "Fluctuating"

ValueSet: TimeOfDayVS
Id: time-of-day-vs
Title: "Time of Day Value Set"
Description: "Times of day for symptom occurrence"
* $SCT#73775008 "Morning"
* $SCT#255253008 "Afternoon"
* $SCT#2546009 "Evening"
* $SCT#73768005 "Night"



// ===== Conteúdo de: StressValueSets.fsh =====

ValueSet: StressChronicityVS
Id: stress-chronicity-vs
Title: "Stress Chronicity Value Set"
Description: "Value set for classifying stress chronicity"
* ^url = "https://github.com/RicardoLSantos/shorthand/ValueSet/stress-chronicity-vs"
* codes from system StressChronicityCS

ValueSet: StressImpactVS
Id: stress-impact-vs
Title: "Stress Impact Value Set"
Description: "Value set for describing stress impact levels"
* ^url = "https://github.com/RicardoLSantos/shorthand/ValueSet/stress-impact-vs"
* codes from system StressImpactCS

CodeSystem: StressChronicityCS
Id: stress-chronicity-cs
Title: "Stress Chronicity Code System"
Description: "Code system for stress chronicity classification"
* ^url = "https://github.com/RicardoLSantos/shorthand/CodeSystem/stress-chronicity-cs"
* #acute "Acute" "Short-term stress response"
* #subacute "Subacute" "Medium-term stress response"
* #chronic "Chronic" "Long-term stress response"
* #episodic "Episodic" "Recurring stress episodes"
* #persistent "Persistent" "Continuous stress state"

CodeSystem: StressImpactCS
Id: stress-impact-cs
Title: "Stress Impact Code System"
Description: "Code system for stress impact levels"
* ^url = "https://github.com/RicardoLSantos/shorthand/CodeSystem/stress-impact-cs"
* #minimal "Minimal Impact" "Little to no interference with daily activities"
* #mild "Mild Impact" "Some interference with daily activities"
* #moderate "Moderate Impact" "Significant interference with daily activities"
* #severe "Severe Impact" "Major interference with daily activities"
* #extreme "Extreme Impact" "Unable to perform daily activities"



// ===== Conteúdo de: ReproductiveValueSets.fsh =====

ValueSet: ReproductiveGoalVS
Id: reproductive-goal-vs
Title: "Reproductive Health Goals Value Set"
Description: "Goals related to reproductive health tracking and planning"

* ^status = #active
* ^experimental = false
* ^date = "2024-03-19"

* $LOINC#8708-0 "Menstrual cycle length"
* $LOINC#55284-4 "Blood pressure"
* $LOINC#8310-5 "Body temperature"
* $LOINC#8302-2 "Body height"
* $LOINC#29463-7 "Body weight"
* $SCT#364311006 "Menstrual cycle monitoring"
* $SCT#289530006 "Reproductive health finding"

ValueSet: ReproductiveActivityVS
Id: reproductive-activity-vs
Title: "Reproductive Health Activities Value Set"
Description: "Activities related to reproductive health monitoring"

* ^status = #active
* ^experimental = false
* ^date = "2024-03-19"

* codes from system ReproductiveActivityCS

CodeSystem: ReproductiveActivityCS
Id: reproductive-activity-cs
Title: "Reproductive Health Activities Code System"
Description: "Code system for reproductive health monitoring activities"

* ^status = #active
* ^experimental = false
* ^caseSensitive = true

* #cycle-tracking "Cycle Tracking" "Track menstrual cycle dates and characteristics"
* #temp-monitoring "Temperature Monitoring" "Monitor basal body temperature"
* #symptom-tracking "Symptom Tracking" "Track reproductive health symptoms"
* #vitals-monitoring "Vitals Monitoring" "Monitor vital signs related to reproductive health"
* #fertility-signs "Fertility Signs" "Monitor fertility signs and indicators"
* #mood-tracking "Mood Tracking" "Track mood changes related to reproductive cycle"
* #medication-log "Medication Log" "Log reproductive health medications"
* #exercise-tracking "Exercise Tracking" "Track physical activity during cycle"



// ===== Conteúdo de: AuditFormatsValueSet.fsh =====

ValueSet: AuditFormatsValueSet
Id: audit-formats
Title: "Audit Formats Value Set"
Description: "Value set for audit format types"
* ^url = "https://github.com/RicardoLSantos/shorthand/fhir/ValueSet/audit-formats"
* ^status = #active
* ^experimental = false
* ^date = "2024-12-27"
* include codes from system https://github.com/RicardoLSantos/shorthand/fhir/CodeSystem/audit-formats

CodeSystem: AuditFormatsCodeSystem
Id: audit-formats
Title: "Audit Formats Code System"
Description: "Code system for audit format types"
* ^url = "https://github.com/RicardoLSantos/shorthand/fhir/CodeSystem/audit-formats"
* ^status = #active
* ^experimental = false
* ^caseSensitive = true
* #text "Text Format"
* #structured "Structured Format"
* #mixed "Mixed Format"



// ===== Conteúdo de: MeasurementContextVS.fsh =====

ValueSet: MeasurementContextVS
Id: measurement-context-vs
Title: "Measurement Context Value Set"
Description: "Contexts in which measurements can be taken, including temporal and location-based contexts"
* ^status = #active
* ^experimental = false
* $SCT#272125009 "Assessment context value (qualifier value)"
* $SCT#307818003 "Before food"
* $SCT#307819006 "After food"
* $SCT#255214003 "After exercise"
* $SCT#264362003 "Time of day"



// ===== Conteúdo de: AuditLevelsValueSet.fsh =====

ValueSet: AuditLevelsValueSet
Id: audit-levels
Title: "Audit Levels Value Set"
Description: "Value set for audit level types"
* ^url = "https://github.com/RicardoLSantos/shorthand/fhir/ValueSet/audit-levels"
* ^status = #active
* ^experimental = false
* ^date = "2024-12-27"
* include codes from system https://github.com/RicardoLSantos/shorthand/fhir/CodeSystem/audit-levels

CodeSystem: AuditLevelsCodeSystem
Id: audit-levels
Title: "Audit Levels Code System"
Description: "Code system for audit level types"
* ^url = "https://github.com/RicardoLSantos/shorthand/fhir/CodeSystem/audit-levels"
* ^status = #active
* ^experimental = false
* ^caseSensitive = true
* #low "Low Level"
* #medium "Medium Level"
* #high "High Level"



// ===== Conteúdo de: SocialInteractionValueSets.fsh =====

ValueSet: SocialInteractionTypeVS
Id: social-interaction-type-vs
Title: "Social Interaction Type Value Set"
Description: "Types of social interactions"
* codes from system SocialInteractionTypeCS

ValueSet: SocialInteractionQualityVS
Id: social-interaction-quality-vs
Title: "Social Interaction Quality Value Set"
Description: "Quality measures for social interactions"
* codes from system SocialInteractionQualityCS

ValueSet: SocialInteractionMediumVS
Id: social-interaction-medium-vs
Title: "Social Interaction Medium Value Set"
Description: "Mediums through which social interaction occurs"
* codes from system SocialInteractionMediumCS

CodeSystem: SocialInteractionTypeCS
Id: social-interaction-type-cs
Title: "Social Interaction Type Code System"
Description: "Types of social interactions"
* #family "Family Interaction" "Interaction with family members"
* #friends "Friend Interaction" "Interaction with friends"
* #professional "Professional Interaction" "Work-related interactions"
* #community "Community Interaction" "Community-based interactions"
* #group "Group Activity" "Organized group activities"
* #casual "Casual Interaction" "Casual social encounters"

CodeSystem: SocialInteractionQualityCS
Id: social-interaction-quality-cs
Title: "Social Interaction Quality Code System"
Description: "Quality measures for social interactions"
* #meaningful "Meaningful" "Deep, meaningful interaction"
* #supportive "Supportive" "Supportive interaction"
* #neutral "Neutral" "Neither positive nor negative"
* #superficial "Superficial" "Surface-level interaction"
* #stressful "Stressful" "Stressful or difficult interaction"

CodeSystem: SocialInteractionMediumCS
Id: social-interaction-medium-cs
Title: "Social Interaction Medium Code System"
Description: "Mediums through which social interaction occurs"
* #inPerson "In Person" "Face-to-face interaction"
* #video "Video Call" "Video-based interaction"
* #voice "Voice Call" "Voice-only interaction"
* #text "Text Based" "Text-based communication"
* #social "Social Media" "Social media interaction"
* #mixed "Mixed Medium" "Multiple communication methods"



// ===== Conteúdo de: MoodValueSet.fsh =====

ValueSet: MoodValueSet
Id: mood
Title: "Mood Value Set"
Description: "Value set for mood states"
* ^url = "https://github.com/RicardoLSantos/shorthand/fhir/ValueSet/mood"
* ^status = #active
* ^experimental = false

CodeSystem: MoodCodeSystem
Id: mood
Title: "Mood Code System"
Description: "Code system for mood states"
* ^url = "https://github.com/RicardoLSantos/shorthand/fhir/CodeSystem/mood"
* ^status = #active
* ^caseSensitive = true
* #elevated "Elevated" "Mood is higher than normal"
* #neutral "Neutral" "Neither elevated nor depressed mood"
* #depressed "Depressed" "Mood is lower than normal"
* #anxious "Anxious" "Feeling worried or nervous"
* #irritable "Irritable" "Easily annoyed or angered"
* #calm "Calm" "Feeling peaceful and relaxed"



// ===== Conteúdo de: EnvironmentalContextVS.fsh =====

ValueSet: EnvironmentalContextValueSet
Id: environmental-context
Title: "Environmental Context Value Set"
Description: "Valid contexts for environmental measurements"

* ^status = #active
* ^experimental = false
* ^url = "https://github.com/RicardoLSantos/shorthand/fhir/ValueSet/environmental-context"
* include codes from system https://github.com/RicardoLSantos/shorthand/fhir/CodeSystem/environmental-context



// ===== Conteúdo de: ActivityTypeVS.fsh =====

ValueSet: PhysicalActivityTypeVS
Id: physical-activity-type-vs
Title: "Physical Activity Types Value Set"
Description: "Types of physical activities from iOS Health App"

* ^status = #active

* $SNOMED#255604002 "Physical activity (observable entity)"
* $SNOMED#228557008 "Walking"
* $SNOMED#229058003 "Running"
* $SNOMED#266938001 "Swimming"
* $SNOMED#266940006 "Cycling"
* $SNOMED#32147004 "Regular exercise"



// ===== Conteúdo de: MindfulnessValueSets.fsh =====

ValueSet: EnvironmentTypeValueSet
Id: environment-type
Title: "Environment Type Value Set"
Description: "Value set for environmental context types"
* ^url = "https://github.com/RicardoLSantos/shorthand/fhir/ValueSet/environment-type"
* ^status = #active
* include codes from system https://github.com/RicardoLSantos/shorthand/fhir/CodeSystem/environment-type

ValueSet: MindfulnessTypeValueSet
Id: mindfulness-type
Title: "Mindfulness Type Value Set"
Description: "Value set for types of mindfulness practices"
* ^url = "https://github.com/RicardoLSantos/shorthand/fhir/ValueSet/mindfulness-type"
* ^status = #active
* include codes from system https://github.com/RicardoLSantos/shorthand/fhir/CodeSystem/mindfulness-type



// ===== Conteúdo de: BalanceStatusValueSet.fsh =====

ValueSet: BalanceStatusValueSet
Id: balance-status
Title: "Balance Status Value Set"
Description: "Value set for walking steadiness balance status"
* ^url = "https://github.com/RicardoLSantos/shorthand/fhir/ValueSet/balance-status"
* ^status = #active
* include codes from system https://github.com/RicardoLSantos/shorthand/fhir/CodeSystem/balance-status

CodeSystem: BalanceStatusCodeSystem
Id: balance-status
Title: "Balance Status Code System"
Description: "Code system for balance status types"
* ^url = "https://github.com/RicardoLSantos/shorthand/fhir/CodeSystem/balance-status"
* ^status = #active
* ^experimental = false
* ^caseSensitive = true
* #veryStable "Very Stable"
* #stable "Stable"
* #slightlyUnstable "Slightly Unstable"
* #unstable "Unstable"
* #veryUnstable "Very Unstable"



// ===== Conteúdo de: SleepQualityVS.fsh =====

ValueSet: SleepQualityVS
Id: sleep-quality-vs
Title: "Sleep Quality Value Set"
Description: "Qualitative assessments of sleep quality including subjective measures"
* ^status = #active
* ^experimental = false
* $SCT#248254009 "Quality of sleep (observable entity)"
* $SCT#248255005 "Sleeping well"
* $SCT#248256006 "Difficulty sleeping"
* $SCT#301345002 "Poor sleep pattern"
* $SCT#301346001 "Good sleep pattern"




// ===== Conteúdo de: FertilityValueSets.fsh =====

ValueSet: CervicalMucusValueSet
Id: cervical-mucus-valueset
Title: "Cervical Mucus Value Set"
Description: "Value set for cervical mucus observations"
* ^url = "https://github.com/RicardoLSantos/shorthand/fhir/ValueSet/cervical-mucus-vs"
* ^status = #active
* include codes from system https://github.com/RicardoLSantos/shorthand/fhir/CodeSystem/cervical-mucus-cs

CodeSystem: CervicalMucusCodeSystem
Id: cervical-mucus-cs
Title: "Cervical Mucus Code System"
* ^url = "https://github.com/RicardoLSantos/shorthand/fhir/CodeSystem/cervical-mucus-cs"
* ^status = #active
* ^caseSensitive = true
* #dry "Dry"
* #sticky "Sticky"
* #creamy "Creamy"
* #watery "Watery"
* #eggWhite "Egg White"

ValueSet: OvulationTestValueSet
Id: ovulation-test-valueset
Title: "Ovulation Test Value Set"
Description: "Value set for ovulation test results"
* ^url = "https://github.com/RicardoLSantos/shorthand/fhir/ValueSet/ovulation-test-vs"
* ^status = #active
* include codes from system https://github.com/RicardoLSantos/shorthand/fhir/CodeSystem/ovulation-test-cs

CodeSystem: OvulationTestCodeSystem
Id: ovulation-test-cs
Title: "Ovulation Test Code System"
* ^url = "https://github.com/RicardoLSantos/shorthand/fhir/CodeSystem/ovulation-test-cs"
* ^status = #active
* ^caseSensitive = true
* #negative "Negative"
* #positive "Positive"
* #invalid "Invalid Test"

ValueSet: FertilityStatusValueSet
Id: fertility-status-valueset
Title: "Fertility Status Value Set"
Description: "Value set for fertility status"
* ^url = "https://github.com/RicardoLSantos/shorthand/fhir/ValueSet/fertility-status-vs"
* ^status = #active
* include codes from system https://github.com/RicardoLSantos/shorthand/fhir/CodeSystem/fertility-status-cs

CodeSystem: FertilityStatusCodeSystem
Id: fertility-status-cs
Title: "Fertility Status Code System"
* ^url = "https://github.com/RicardoLSantos/shorthand/fhir/CodeSystem/fertility-status-cs"
* ^status = #active
* ^caseSensitive = true
* #fertile "Fertile"
* #notFertile "Not Fertile"
* #uncertain "Uncertain"



// ===== Conteúdo de: MindfulnessSearchParameters.fsh =====

Instance: MindfulnessType
InstanceOf: SearchParameter
Usage: #definition
* status = #active
* code = #mindfulness-type
* name = "MindfulnessType"
* description = "Search for mindfulness observations by practice type"
* base = #Observation
* type = #token
* expression = "Observation.component.where(code.coding.where(system='http://snomed.info/sct' and code='711020003')).value.as(CodeableConcept)"
* xpath = "f:Observation/f:component[f:code/f:coding[f:system/@value='http://snomed.info/sct' and f:code/f:coding/f:code/@value='711020003']]/f:valueCodeableConcept"
* xpathUsage = #normal



// ===== Conteúdo de: MindfulnessAlerts.fsh =====

Extension: AlertTiming
Id: alert-timing
Title: "Alert Timing Extension"
Description: "Defines when alerts should be triggered"
* value[x] only Timing
* valueTiming.repeat 1..1 MS
* valueTiming.repeat.frequency MS
* valueTiming.repeat.period MS
* valueTiming.repeat.periodUnit MS

Extension: AlertMessage
Id: alert-message
Title: "Alert Message Extension"
Description: "Defines the alert message content"
* value[x] only string

Profile: MindfulnessAlert
Parent: Basic
Id: mindfulness-alert
Title: "Mindfulness Alert"
Description: "Alert configuration for mindfulness sessions"

* code 1..1 MS
* code = https://github.com/RicardoLSantos/shorthand/CodeSystem/mindfulness-alert-type#reminder "Mindfulness Reminder"

* extension contains
    alert-timing named alertTiming 0..1 MS and
    alert-message named alertMessage 1..1 MS

Instance: DailyMindfulnessAlert
InstanceOf: MindfulnessAlert
Title: "Daily Mindfulness Alert" 
Description: "Example of a daily mindfulness alert configuration"

* code = https://github.com/RicardoLSantos/shorthand/CodeSystem/mindfulness-alert-type#reminder "Mindfulness Reminder"
* extension[alertTiming].valueTiming.repeat
  * frequency = 1
  * period = 1
  * periodUnit = #d
* extension[alertMessage].valueString = "Time for your daily mindfulness practice"



// ===== Conteúdo de: MindfulnessTransforms.fsh =====

Instance: MindfulnessHealthKitTransform
InstanceOf: StructureMap
Usage: #definition
Title: "HealthKit to FHIR Mindfulness Transform"

* status = #draft
* name = "MindfulnessHealthKitTransform"
* structure[0]
  * url = "https://github.com/RicardoLSantos/shorthand/StructureDefinition/healthkit-mindfulness"
  * mode = #source
  * documentation = "HealthKit mindfulness session structure"

* structure[1]
  * url = "http://hl7.org/fhir/StructureDefinition/Observation"
  * mode = #target
  * documentation = "FHIR Observation resource"

* group[0]
  * name = "MindfulnessSessionToObservation"
  * typeMode = #none
  * input[0]
    * name = "source"
    * type = "HealthKitMindfulness"
    * mode = #source
  * input[1]
    * name = "target"
    * type = "Observation"
    * mode = #target
  * rule[0]
    * name = "Session"
    * source[0]
      * context = "source"
      * element = "startDate"
    * target[0]
      * context = "target"
      * element = "effectiveDateTime"
  * rule[1]
    * name = "Duration"
    * source[0]
      * context = "source"
      * element = "duration"
    * target[0]
      * context = "target"
      * element = "component.where(code.coding.code='118682006').valueQuantity"

Instance: MindfulnessCSVTransform
InstanceOf: StructureMap
Usage: #definition
Title: "CSV to FHIR Mindfulness Transform"

* status = #draft
* name = "MindfulnessCSVTransform"
* structure[0]
  * url = "https://github.com/RicardoLSantos/shorthand/StructureDefinition/csv-mindfulness"
  * mode = #source
  * documentation = "CSV mindfulness data structure"

* group[0]
  * name = "CSVToMindfulnessObservation"
  * typeMode = #none
  * input[0]
    * name = "source"
    * type = "CSVMindfulness"
    * mode = #source
  * input[1]
    * name = "target"
    * type = "Observation"
    * mode = #target
  * rule[0]
    * name = "MapDatetime"
    * source[0]
      * context = "source"
      * element = "date,time"
    * target[0]
      * context = "target"
      * element = "effectiveDateTime"
      * transform = #append

RuleSet: TransformValidationRules
* rule[+]
  * name = "ValidateStatus"
  * source[0]
    * context = "target"
    * element = "status"
  * assert[0]
    * description = "Status must be final"
    * expression = "%status = 'final'"

* rule[+]
  * name = "ValidateCode"
  * source[0]
    * context = "target"
    * element = "code"
  * assert[0]
    * description = "Must use SNOMED CT code"
    * expression = "%code.system = 'http://snomed.info/sct'"



// ===== Conteúdo de: MindfulnessAudit.fsh =====

Extension: AuditLevelExtension
Id: audit-level
Title: "Audit Level Extension"
Description: "Level of detail for audit records"
* value[x] only code
* valueCode from https://github.com/RicardoLSantos/shorthand/fhir/ValueSet/audit-levels (required)

Extension: AuditRetentionExtension
Id: audit-retention
Title: "Audit Retention Extension" 
Description: "Period to retain audit records"
* value[x] only Duration

Extension: AuditFormatExtension
Id: audit-format
Title: "Audit Format Extension"
Description: "Format for audit records"
* value[x] only code
* valueCode from https://github.com/RicardoLSantos/shorthand/fhir/ValueSet/audit-formats (required)

Profile: MindfulnessAudit
Parent: Basic
Id: mindfulness-audit
Title: "Mindfulness Audit"
Description: "Audit record for mindfulness sessions"

* code 1..1 MS
* code = https://github.com/RicardoLSantos/shorthand/CodeSystem/mindfulness-audit-type#session "Session Audit"
* created 1..1 MS

* extension contains
    audit-level named auditLevel 1..1 MS and
    audit-retention named auditRetention 1..1 MS and
    audit-format named auditFormat 1..1 MS

Instance: MindfulnessAuditExample
InstanceOf: MindfulnessAudit
Title: "Example Mindfulness Audit"
Description: "Example of a mindfulness session audit record"

* code = https://github.com/RicardoLSantos/shorthand/CodeSystem/mindfulness-audit-type#session "Session Audit"
* created = "2024-03-15"
* extension[auditLevel].valueCode = #detailed
* extension[auditRetention].valueDuration = 90 'days'
* extension[auditFormat].valueCode = #fhir



// ===== Conteúdo de: EnvironmentalExamples.fsh =====

Instance: NoiseExposureExample
InstanceOf: NoiseExposureObservation
Usage: #example
Title: "Noise Exposure Measurement Example"
Description: "Example of noise exposure measurement from iOS Health App"

* meta.security = http://terminology.hl7.org/CodeSystem/v3-Confidentiality#N
* status = #final
* category = http://terminology.hl7.org/CodeSystem/observation-category#environment
* code = $LOINC#28573-7 "Noise exposure time"
* subject = Reference(Patient/example)
* effectiveDateTime = "2024-03-19T15:30:00Z"
* device = Reference(Device/iphone-example)
* method = http://snomed.info/sct#37016008 "Automatic measurement"

* component[level]
  * code.coding[0] = $LOINC#89020-2 "Environmental noise average"
  * valueQuantity = 85 'dB'
  * interpretation = http://terminology.hl7.org/CodeSystem/v3-ObservationInterpretation#H "High"

* component[duration]
  * code.coding[0] = $LOINC#89021-0 "Environmental noise duration"
  * valueQuantity = 120 'min'

* component[peakLevel]
  * code.coding[0] = $LOINC#89024-4 "Peak sound level"
  * valueQuantity = 95 'dB'

* component[backgroundNoise]
  * code.coding[0] = $LOINC#89025-1 "Background noise level"
  * valueQuantity = 45 'dB'

* note.text = "Measurement taken during urban commute"

Instance: UVExposureExample
InstanceOf: UVExposureObservation
Usage: #example
Title: "UV Exposure Measurement Example"
Description: "Example of UV exposure measurement from iOS Health App"

* meta.security = http://terminology.hl7.org/CodeSystem/v3-Confidentiality#N
* status = #final
* category = http://terminology.hl7.org/CodeSystem/observation-category#environment
* code = $LOINC#28574-5 "UV exposure"
* subject = Reference(Patient/example)
* effectiveDateTime = "2024-03-19T12:00:00Z"
* device = Reference(Device/iphone-example)
* method = http://snomed.info/sct#37016008 "Automatic measurement"

* component[index]
  * code.coding[0] = $LOINC#89022-8 "UV index"
  * valueQuantity = 8 '{index}'
  * interpretation = http://terminology.hl7.org/CodeSystem/v3-ObservationInterpretation#H "High"

* component[duration]
  * code.coding[0] = $LOINC#89023-6 "UV exposure duration"
  * valueQuantity = 45 'min'

* component[timeOfDay]
  * code.coding[0] = $LOINC#89026-9 "Time of exposure"
  * valueDateTime = "2024-03-19T12:00:00Z"

* component[intensity]
  * code.coding[0] = $LOINC#89027-7 "UV intensity"
  * valueQuantity = 0.3 'W/m2'

* note.text = "Measurement taken during outdoor activity"

Instance: EnvironmentalDeviceExample
InstanceOf: Device
Usage: #example
Title: "Environmental Monitoring Device"
Description: "Example of iOS device used for environmental monitoring"

* identifier.system = "https://github.com/RicardoLSantos/shorthand/devices"
* identifier.value = "iPhone-ENV-001"
* manufacturer = "Apple Inc."
* modelNumber = "iPhone 15 Pro"
* type = $SCT#706689003 "Environmental monitoring device"
* status = #active



// ===== Conteúdo de: NutritionExamples.fsh =====

Instance: NutritionQuestionnaireResponseExample
InstanceOf: QuestionnaireResponse
Usage: #example
Title: "Daily Nutrition Questionnaire Response Example"

* questionnaire = "https://github.com/RicardoLSantos/shorthand/Questionnaire/daily-nutrition"
* status = #completed
* subject = Reference(Patient/PatientExample)
* authored = "2024-12-14T20:00:00Z"

* item[0]
  * linkId = "water_intake"
  * answer.valueQuantity = 2000 'mL'

* item[1]
  * linkId = "meal_record"

  * item[0]
    * linkId = "meal_time"
    * answer.valueDateTime = "2024-12-14T12:00:00Z"

  * item[1]
    * linkId = "meal_type"
    * answer.valueString = "Lunch"

  * item[2]
    * linkId = "calories"
    * answer.valueInteger = 650

  * item[3]
    * linkId = "macronutrients"
   
    * item[0]
      * linkId = "carbs"
      * answer.valueDecimal = 75
   
    * item[1]
      * linkId = "protein"
      * answer.valueDecimal = 30
   
    * item[2]
      * linkId = "fat"
      * answer.valueDecimal = 25

* item[2]
  * linkId = "caffeine"

  * item[0]
    * linkId = "caffeine_amount"
    * answer.valueInteger = 80

  * item[1]
    * linkId = "caffeine_source"
    * answer.valueString = "Coffee"



// ===== Conteúdo de: SleepExamples.fsh =====

Instance: SleepObservationExample1
InstanceOf: SleepObservation
Usage: #example
Title: "Example of Sleep Record"
Description: "Example of nightly sleep data from iOS Health App"
 
* status = #final
* category = http://terminology.hl7.org/CodeSystem/observation-category#sleep
* code = $LOINC#93832-4 "Sleep pattern panel"
* subject = Reference(PatientExample)
* effectivePeriod.start = "2024-03-19T22:00:00Z"
* effectivePeriod.end = "2024-03-20T06:30:00Z"
* device = Reference(DeviceSleepMonitor)
 
* component[timeInBed].code = $LOINC#93831-6 "Time in bed"
* component[timeInBed].valueQuantity = 510 'min' "minute"
* component[timeInBed].valueQuantity.system = $UCUM
* component[timeInBed].valueQuantity.unit = "minute"
 
* component[totalSleepTime].code = $LOINC#93833-2 "Sleep duration"
* component[totalSleepTime].valueQuantity = 472 'min' "minute"
* component[totalSleepTime].valueQuantity.system = $UCUM
* component[totalSleepTime].valueQuantity.unit = "minute"
 
* component[deepSleep].code = $LOINC#93834-0 "Deep sleep duration"
* component[deepSleep].valueQuantity = 95 'min' "minute"
* component[deepSleep].valueQuantity.system = $UCUM
* component[deepSleep].valueQuantity.unit = "minute"
 
* component[remSleep].code = $LOINC#93835-7 "REM sleep duration"
* component[remSleep].valueQuantity = 118 'min' "minute"
* component[remSleep].valueQuantity.system = $UCUM
* component[remSleep].valueQuantity.unit = "minute"
 
* component[lightSleep].code = $LOINC#93836-5 "Light sleep duration"
* component[lightSleep].valueQuantity = 259 'min' "minute"
* component[lightSleep].valueQuantity.system = $UCUM
* component[lightSleep].valueQuantity.unit = "minute"
 
* component[respiratoryRate].code = $LOINC#9279-1 "Respiratory rate"
* component[respiratoryRate].valueQuantity = 14 '/min' "per minute"
* component[respiratoryRate].valueQuantity.system = $UCUM
* component[respiratoryRate].valueQuantity.unit = "per minute"
 
* component[heartRateVariability].code = $LOINC#80404-7 "R-R interval.standard deviation (Heart rate variability)"
* component[heartRateVariability].valueQuantity = 45 'ms' "millisecond"
* component[heartRateVariability].valueQuantity.system = $UCUM
* component[heartRateVariability].valueQuantity.unit = "millisecond"
 
* component[interruptions].code = $LOINC#93837-3 "Number of awakenings during sleep"
* component[interruptions].valueQuantity = 3 '{count}' "count"
* component[interruptions].valueQuantity.system = $UCUM
* component[interruptions].valueQuantity.unit = "count"

Instance: DeviceSleepMonitor
InstanceOf: Device
Usage: #example
Title: "Sleep Monitoring Device"
* deviceName.name = "Sleep Quality Monitor"
* deviceName.type = #user-friendly-name
* manufacturer = "HealthTech Devices"
* modelNumber = "SQM-2024"
* type = $SCT#706172001 "Sleep monitor"



// ===== Conteúdo de: StressExamples.fsh =====

Instance: StressLevelExample
InstanceOf: StressLevelProfile
Usage: #example
Title: "Stress Level Measurement Example"

* status = #final
* category = http://terminology.hl7.org/CodeSystem/observation-category#vital-signs
* code = $LOINC#89592-0 "Stress level score"
* subject = Reference(Patient/example)
* effectiveDateTime = "2024-01-03T15:30:00Z"
* valueQuantity = 7 '{score}' "score"

* component[physiologicalStress].valueQuantity = 6 '{score}' "score"
* component[psychologicalStress].valueQuantity = 8 '{score}' "score"
* component[chronicity].valueCodeableConcept = StressChronicityCS#subacute
* component[impact].valueCodeableConcept = StressImpactCS#moderate

* extension[triggers].valueCodeableConcept = StressTriggersCS#work
* extension[coping].valueCodeableConcept = StressCopingCS#meditation



// ===== Conteúdo de: PatientExample.fsh =====

Instance: PatientExample
InstanceOf: Patient
Usage: #example
* identifier[0].system = "urn:oid:2.16.858.1.1.1"
* identifier[0].value = "12345"
* name.given = "John"
* name.family = "Doe"
* gender = #male
* birthDate = "1970-01-01"



// ===== Conteúdo de: MobilityExamples.fsh =====

Profile: WalkingSteadinessObservation
Parent: MobilityProfile
Id: walking-steadiness-observation
Title: "Walking Steadiness Observation Profile"
Description: "Profile for walking steadiness measurements from iPhone Motion Sensors"

* code = $LOINC#LA32-8 "Balance"
* component contains
    balanceScore 0..1 MS and
    balanceStatus 0..1 MS

* component[balanceScore]
  * code = $LOINC#LA32-8 "Balance score"
  * valueQuantity.system = $UCUM
  * valueQuantity.code = #%

* component[balanceStatus]
  * code = $LOINC#LA32-9 "Balance status"
  * valueCodeableConcept from https://github.com/RicardoLSantos/shorthand/fhir/ValueSet/balance-status (required)

Profile: WalkingSpeedObservation
Parent: MobilityProfile
Id: walking-speed-observation
Title: "Walking Speed Observation Profile"
Description: "Profile for walking speed measurements from iPhone Motion Sensors"

* code = $LOINC#LA29042-4 "Walking speed"
* component contains
    speed 0..1 MS and
    distance 0..1 MS

* component[speed]
  * code = $LOINC#LA29042-4 "Walking speed measurement"
  * valueQuantity.system = $UCUM
  * valueQuantity.code = #m/s

* component[distance]
  * code = $LOINC#LA29043-2 "Walking distance"
  * valueQuantity.system = $UCUM
  * valueQuantity.code = #m

Instance: WalkingSteadinessExample
InstanceOf: WalkingSteadinessObservation
Usage: #example
Title: "Walking Steadiness Measurement Example"
Description: "Example of walking steadiness measurement from iPhone Motion Sensors"

* status = #final
* category = http://terminology.hl7.org/CodeSystem/observation-category#activity
* code = $LOINC#LA32-8 "Balance"
* subject = Reference(Patient/example)
* effectiveDateTime = "2024-03-19T15:30:00Z"
* valueQuantity = 85 '1' "score"
* device = Reference(Device/iphone-example)

* component[balanceScore].valueQuantity = 85 '%' "percent"
* component[balanceStatus].valueCodeableConcept = $LOINC#LA32-10 "OK"

Instance: WalkingSpeedExample
InstanceOf: WalkingSpeedObservation
Usage: #example
Title: "Walking Speed Measurement Example"
Description: "Example of walking speed measurement from iPhone Motion Sensors"

* status = #final
* category = http://terminology.hl7.org/CodeSystem/observation-category#activity
* code = $LOINC#LA29042-4 "Walking speed"
* subject = Reference(Patient/example)
* effectiveDateTime = "2024-03-19T15:30:00Z"
* valueQuantity = 1.2 'm/s' "meters per second"
* device = Reference(Device/iphone-example)

* component[speed].valueQuantity = 1.2 'm/s' "meters per second"
* component[distance].valueQuantity = 10 'm' "meters"



// ===== Conteúdo de: PhysicalActivityExamples.fsh =====

Instance: PhysicalActivityExample1
InstanceOf: PhysicalActivityObservation
Usage: #example
Title: "Example of Walking Activity"
Description: "Example of walking activity data from iOS Health App"
* status = #final
* category = http://terminology.hl7.org/CodeSystem/observation-category#activity
* code = $SNOMED#228557008 "Walking"
* subject = Reference(PatientExample)
* effectiveDateTime = "2024-03-19T15:30:00Z"
* device = Reference(DeviceActivityTracker)
* component[steps].code = $LOINC#55423-8 "Number of steps in 24 hour Measured"
* component[steps].valueQuantity = 8546 '1' "count"
* component[steps].valueQuantity.system = $UCUM
* component[steps].valueQuantity.unit = "count"
* component[distance].code = $LOINC#55430-3 "Distance walked"
* component[distance].valueQuantity = 6.2 'km' "kilometer"
* component[distance].valueQuantity.system = $UCUM
* component[distance].valueQuantity.unit = "kilometer"
* component[duration].code = $LOINC#55411-3 "Exercise duration"
* component[duration].valueQuantity = 72 'min' "minute"
* component[duration].valueQuantity.system = $UCUM
* component[duration].valueQuantity.unit = "minute"
* component[energy].code = $LOINC#55424-6 "Energy expenditure"
* component[energy].valueQuantity = 320 'kcal' "kilocalorie"
* component[energy].valueQuantity.system = $UCUM
* component[energy].valueQuantity.unit = "kilocalorie"

Instance: DeviceActivityTracker
InstanceOf: Device
Usage: #example
Title: "Activity Tracking Device"
* deviceName.name = "Health Activity Tracker"
* deviceName.type = #user-friendly-name
* manufacturer = "HealthTech Devices"
* modelNumber = "HAT-2024"
* type = $SCT#258158006 "Activity monitor"



// ===== Conteúdo de: BodyMetricsExamples.fsh =====

Instance: WeightExample
InstanceOf: WeightObservation
Usage: #example
Title: "Weight Measurement Example"
Description: "Example of a weight measurement from a smart scale"
* status = #final
* category = http://terminology.hl7.org/CodeSystem/observation-category#vital-signs
* code = $LOINC#29463-7 "Body weight"
* subject = Reference(PatientExample)
* performer = Reference(PractitionerExample)
* effectiveDateTime = "2024-03-19T08:00:00Z"
* valueQuantity = 70.5 'kg' "kilogram"
* valueQuantity.system = $UCUM
* valueQuantity.unit = "kilogram"
* device = Reference(SmartScale)

Instance: HeightExample
InstanceOf: HeightObservation
Usage: #example
Title: "Height Measurement Example"
Description: "Example of a height measurement"
* status = #final
* category = http://terminology.hl7.org/CodeSystem/observation-category#vital-signs
* code = $LOINC#8302-2 "Body height"
* subject = Reference(PatientExample)
* performer = Reference(PractitionerExample)
* effectiveDateTime = "2024-03-19T08:00:00Z"
* valueQuantity = 175 'cm' "centimeter"
* valueQuantity.system = $UCUM
* valueQuantity.unit = "centimeter"

Instance: BMIExample
InstanceOf: BMIObservation
Usage: #example
Title: "BMI Calculation Example"
Description: "Example of a BMI calculation based on weight and height measurements"
* status = #final
* category = http://terminology.hl7.org/CodeSystem/observation-category#vital-signs
* code = $LOINC#39156-5 "Body mass index (BMI)"
* subject = Reference(PatientExample)
* performer = Reference(PractitionerExample)
* effectiveDateTime = "2024-03-19T08:00:00Z"
* valueQuantity = 23.0 'kg/m2' "kilogram per square meter"
* valueQuantity.system = $UCUM
* valueQuantity.unit = "kilogram per square meter"
* derivedFrom[0] = Reference(Observation/WeightExample)
* derivedFrom[1] = Reference(Observation/HeightExample)

Instance: BodyCompositionExample
InstanceOf: BodyCompositionObservation
Usage: #example
Title: "Body Composition Measurement Example" 
Description: "Example of comprehensive body composition measurements from a bioimpedance device"
* status = #final
* category = http://terminology.hl7.org/CodeSystem/observation-category#vital-signs
* code = $LOINC#88365-2 "Body composition panel"
* subject = Reference(PatientExample)
* performer = Reference(PractitionerExample)
* effectiveDateTime = "2024-03-19T08:00:00Z"
* device = Reference(BioimpedanceAnalyzer)

* component[bodyFat].code = $LOINC#41982-0 "Percentage body fat"
* component[bodyFat].valueQuantity = 22.5 '%' "percent"
* component[bodyFat].valueQuantity.system = $UCUM
* component[bodyFat].valueQuantity.unit = "percent"

* component[leanMass].code = $LOINC#291-7 "Lean body mass"
* component[leanMass].valueQuantity = 54.6 'kg' "kilogram"
* component[leanMass].valueQuantity.system = $UCUM
* component[leanMass].valueQuantity.unit = "kilogram"

* component[bodyWater].code = $LOINC#73708-0 "Total body water"
* component[bodyWater].valueQuantity = 39.2 'L' "liter"
* component[bodyWater].valueQuantity.system = $UCUM
* component[bodyWater].valueQuantity.unit = "liter"

* component[muscleMass].code = $LOINC#73713-0 "Muscle mass"
* component[muscleMass].valueQuantity = 51.8 'kg' "kilogram"
* component[muscleMass].valueQuantity.system = $UCUM
* component[muscleMass].valueQuantity.unit = "kilogram"

* component[boneMass].code = $LOINC#73711-4 "Bone mass"
* component[boneMass].valueQuantity = 2.8 'kg' "kilogram"
* component[boneMass].valueQuantity.system = $UCUM
* component[boneMass].valueQuantity.unit = "kilogram"

Instance: SmartScale
InstanceOf: Device
Usage: #example
Title: "Smart Scale Device"
* deviceName.name = "Smart Body Analyzer"
* deviceName.type = #user-friendly-name
* manufacturer = "HealthTech Devices"
* modelNumber = "SBA-2024"
* type = $SCT#469576000 "Digital scale device"

Instance: BioimpedanceAnalyzer  
InstanceOf: Device
Usage: #example
Title: "Bioimpedance Analyzer Device"
* deviceName.name = "Professional Body Composition Analyzer"
* deviceName.type = #user-friendly-name
* manufacturer = "MedTech Solutions"
* modelNumber = "BCA-Pro"
* type = $SCT#706767009 "Body composition analyzer"



// ===== Conteúdo de: SymptomExamples.fsh =====

Instance: ChronicSymptomExample
InstanceOf: Observation
Usage: #example
* status = #final
* category = http://terminology.hl7.org/CodeSystem/observation-category#survey
* code = $SCT#267036007 "Fatigue"
* subject = Reference(Patient/example)
* performer = Reference(Practitioner/practitioner-example)
* effectiveDateTime = "2024-03-19T14:00:00Z"
// ... resto do exemplo ...

Instance: ExampleSymptomSeverity
InstanceOf: Observation
Usage: #example
* status = #final
* category = http://terminology.hl7.org/CodeSystem/observation-category#survey
* code = $SCT#246604007 "Symptom severity"
* subject = Reference(Patient/example)
* performer = Reference(Practitioner/practitioner-example)
* effectiveDateTime = "2024-03-19T10:30:00Z"
// ... resto do exemplo ...



// ===== Conteúdo de: SocialInteractionExamples.fsh =====

Instance: SocialInteractionExample
InstanceOf: SocialInteractionProfile
Usage: #example
Title: "Social Interaction Example"

* status = #final
* category = http://terminology.hl7.org/CodeSystem/observation-category#social-history
* code = $LOINC#96766-1 "Social interaction pattern"
* subject = Reference(Patient/example)
* effectiveDateTime = "2024-01-03T14:00:00Z"
* valueCodeableConcept = SocialInteractionTypeCS#family

* component[duration].valueQuantity = 120 'min' "minutes"
* component[quality].valueCodeableConcept = SocialInteractionQualityCS#meaningful
* component[medium].valueCodeableConcept = SocialInteractionMediumCS#inPerson
* component[participants].valueInteger = 4

* extension[context].valueCodeableConcept = SocialContextCS#home
* extension[support].valueCodeableConcept = SocialSupportCS#strong
* extension[activity].valueCodeableConcept = SocialActivityCS#meal



// ===== Conteúdo de: VitalSignsExamples.fsh =====

Instance: HeartRateExample
InstanceOf: HeartRateObservation
Usage: #example
Title: "Heart Rate Measurement Example"
* status = #final
* code = $LOINC#8867-4 "Heart rate"
* subject = Reference(PatientExample)
* effectiveDateTime = "2024-03-19T15:30:00Z"
* valueQuantity = 72 '/min' "per minute"
* valueQuantity.system = $UCUM
* valueQuantity.unit = "per minute"
* device = Reference(DeviceHeartRateMonitor)
* performer = Reference(PractitionerExample)
* component[heartRateVariability].code = $LOINC#80404-7 "R-R interval.standard deviation (Heart rate variability)"
* component[heartRateVariability].valueQuantity = 45 'ms' "millisecond"
* component[heartRateVariability].valueQuantity.system = $UCUM
* component[heartRateVariability].valueQuantity.unit = "millisecond"

Instance: BloodPressureExample
InstanceOf: BloodPressureObservation
Usage: #example
Title: "Blood Pressure Measurement Example"
* status = #final
* code = $LOINC#85354-9 "Blood pressure panel with all children optional"
* subject = Reference(PatientExample)
* effectiveDateTime = "2024-03-19T15:30:00Z"
* device = Reference(DeviceBloodPressureMonitor)
* performer = Reference(PractitionerExample)
* component[systolic].code = $LOINC#8480-6 "Systolic blood pressure"
* component[systolic].valueQuantity = 120 'mm[Hg]' "millimeter of mercury"
* component[systolic].valueQuantity.system = $UCUM
* component[systolic].valueQuantity.unit = "millimeter of mercury"
* component[diastolic].code = $LOINC#8462-4 "Diastolic blood pressure"
* component[diastolic].valueQuantity = 80 'mm[Hg]' "millimeter of mercury"
* component[diastolic].valueQuantity.system = $UCUM
* component[diastolic].valueQuantity.unit = "millimeter of mercury"

Instance: DeviceHeartRateMonitor
InstanceOf: Device
Usage: #example
Title: "Heart Rate Monitor Device"
* deviceName.name = "Continuous Heart Rate Monitor"
* deviceName.type = #user-friendly-name
* manufacturer = "HealthTech Devices"
* modelNumber = "HRM-2024"
* type = $SCT#720737000 "Pulse rate monitoring device"

Instance: DeviceBloodPressureMonitor
InstanceOf: Device
Usage: #example
Title: "Blood Pressure Monitor Device"
* deviceName.name = "Digital Blood Pressure Monitor"
* deviceName.type = #user-friendly-name
* manufacturer = "HealthTech Devices"
* modelNumber = "BPM-2024"
* type = $SCT#43770009 "Blood pressure monitor"



// ===== Conteúdo de: PractitionerExample.fsh =====

Instance: PractitionerExample
InstanceOf: Practitioner
Usage: #example
* identifier[0].system = "http://hl7.org/fhir/sid/us-npi"
* identifier[0].value = "9941339108"
* name.given = "Jane"
* name.family = "Smith"



// ===== Conteúdo de: MindfulnessCompleteExamples.fsh =====

Instance: CompleteMindfulnessSession
InstanceOf: MindfulnessObservation
Usage: #example
Title: "Complete Mindfulness Session Example"

* status = #final
* code = $SCT#711020003 "Meditation"
* subject = Reference(Patient/PatientExample)
* effectiveDateTime = "2024-03-19T08:00:00Z"
* performer = Reference(Practitioner/practitioner-example)

* component[sessionDuration].code = $SCT#118682006 "Duration"
* component[sessionDuration].valueQuantity = 20 'min'

* component[stressLevel].code = $SCT#725854004 "Assessment of stress level"
* component[stressLevel].valueInteger = 3

* component[moodState].code = $SCT#373931001 "Mood finding"
* component[moodState].valueCodeableConcept = $SCT#130991005 "Neutral mood"

* component[relaxationResponse].code = $SCT#276241001 "Relaxation technique"
* component[relaxationResponse].valueString = "Deep breathing exercises with progressive relaxation"

* component[mindfulnessType].code = $SCT#711020003 "Meditation"
* component[mindfulnessType].valueCodeableConcept = $SCT#711020003 "Meditation"

* extension[mindfulness-context].extension[location].valueString = "Home meditation room"
* extension[mindfulness-context].extension[environment].valueCodeableConcept = #quiet "Quiet Space"
* extension[mindfulness-context].extension[guidance].valueBoolean = true

Instance: CompleteMindfulnessResponse
InstanceOf: QuestionnaireResponse
Usage: #example
Title: "Complete Mindfulness Session Response"

* questionnaire = "https://github.com/RicardoLSantos/shorthand/Questionnaire/daily-mindfulness"
* status = #completed
* subject = Reference(Patient/PatientExample)
* authored = "2024-03-19T08:30:00Z"

* item[0]
  * linkId = "mindful_session"
  * item[0]
    * linkId = "session_duration"
    * answer.valueInteger = 20
  * item[1]
    * linkId = "practice_type"
    * answer.valueString = "Meditation"

* item[1]
  * linkId = "mood_assessment"
  * item[0]
    * linkId = "current_mood"
    * answer.valueCoding = $SCT#130991005 "Neutral mood"
  * item[1]
    * linkId = "mood_intensity"
    * answer.valueInteger = 3

* item[2]
  * linkId = "stress_assessment"
  * item[0]
    * linkId = "stress_level"
    * answer.valueInteger = 3
  * item[1]
    * linkId = "stress_symptoms"
    * answer[0].valueString = "Slight tension"

* item[3]
  * linkId = "relaxation"
  * item[0]
    * linkId = "relaxation_duration"
    * answer.valueInteger = 15
  * item[1]
    * linkId = "relaxation_technique"
    * answer.valueString = "Deep breathing"



// ===== Conteúdo de: MindfulnessExamples.fsh =====

Instance: MindfulnessObservationExample
InstanceOf: MindfulnessObservation
Usage: #example
Title: "Example of Mindfulness Session Observation"

* status = #final
* code = $SCT#711020003 "Meditation"
* subject = Reference(Patient/PatientExample)
* effectiveDateTime = "2024-03-19T09:30:00Z"
* performer = Reference(Practitioner/practitioner-example)

* component[sessionDuration].code = $SCT#118682006 "Duration"
* component[sessionDuration].valueQuantity = 20 'min'

* component[stressLevel].code = $SCT#725854004 "Assessment of stress level"
* component[stressLevel].valueInteger = 4

* component[moodState].code = $SCT#373931001 "Mood finding"
* component[moodState].valueCodeableConcept = $SCT#130991005 "Neutral mood"

* component[relaxationResponse].code = $SCT#276241001 "Relaxation technique"
* component[relaxationResponse].valueString = "Deep breathing exercises helped reduce tension"

* component[mindfulnessType].code = $SCT#711020003 "Meditation"
* component[mindfulnessType].valueCodeableConcept = $SCT#711020003 "Meditation"

// New example for MindfulnessQuestionnaire
Instance: MindfulnessQuestionnaireExample
InstanceOf: Questionnaire
Usage: #example
Title: "Example of Mindfulness Questionnaire"

* url = "https://github.com/RicardoLSantos/shorthand/Questionnaire/mindfulness-example"
* status = #active
* title = "Daily Mindfulness Assessment"
* version = "1.0"
* name = "MindfulnessQuestionnaireExample"
* date = "2024-03-19"
* publisher = "Example Organization"
* description = "Example questionnaire for daily mindfulness practice assessment"

* item[0]
  * linkId = "session_details"
  * text = "Session Details"
  * type = #group
  
  * item[0]
    * linkId = "duration"
    * text = "Duration (minutes)"
    * type = #integer
    * required = true
    
  * item[1]
    * linkId = "technique"
    * text = "Technique Used"
    * type = #choice
    * required = true
    * answerOption[0].valueString = "Mindful Breathing"
    * answerOption[1].valueString = "Body Scan"
    * answerOption[2].valueString = "Walking Meditation"



// ===== Conteúdo de: ReproductiveExamples.fsh =====

Instance: ExampleReproductiveActivity
InstanceOf: CarePlan
Usage: #example
* status = #active
* intent = #plan
* subject = Reference(Patient/example)
* activity.detail.kind = #Observation
* activity.detail.code = ReproductiveActivityCS#cycle-tracking
* activity.detail.status = #scheduled



// ===== Conteúdo de: MindfulnessWorkflow.fsh =====

Profile: MindfulnessSchedule
Parent: Basic
Id: mindfulness-schedule
Title: "Mindfulness Schedule"
Description: "Schedule configuration for mindfulness sessions"

* code 1..1 MS
* code = https://github.com/RicardoLSantos/shorthand/CodeSystem/mindfulness-schedule-type#recurring "Recurring Schedule"

Extension: MindfulnessScheduleTiming
Id: mindfulness-schedule-timing
Title: "Mindfulness Schedule Timing"
Description: "Timing configuration for mindfulness sessions"
* value[x] only Timing

Instance: WeeklyMindfulnessSchedule
InstanceOf: MindfulnessSchedule
Title: "Weekly Mindfulness Schedule"
Description: "Example of a weekly mindfulness schedule"

* code = https://github.com/RicardoLSantos/shorthand/CodeSystem/mindfulness-schedule-type#recurring "Recurring Schedule"
* extension[mindfulness-schedule-timing].valueTiming.repeat.frequency = 1
* extension[mindfulness-schedule-timing].valueTiming.repeat.period = 1
* extension[mindfulness-schedule-timing].valueTiming.repeat.periodUnit = #wk
* extension[mindfulness-schedule-timing].valueTiming.repeat.dayOfWeek = #mon
* extension[mindfulness-schedule-timing].valueTiming.repeat.dayOfWeek[+] = #wed
* extension[mindfulness-schedule-timing].valueTiming.repeat.dayOfWeek[+] = #fri



// ===== Conteúdo de: MindfulnessRules.fsh =====

RuleSet: MindfulnessValidation
* ^extension[0].url = "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice"
* ^extension[0].valueBoolean = true

* status MS
* code MS
* subject MS
* effective[x] MS
* value[x] MS
* component MS

* status from http://hl7.org/fhir/ValueSet/observation-status
* code from http://snomed.info/sct?fhir_vs=isa/711020003
* subject only Reference(Patient)
* effective[x] only dateTime

* obeys mindfulness-session-duration
* obeys mindfulness-stress-level
* obeys mindfulness-mood-required
* obeys mindfulness-context-complete
* obeys sequential-measurements

RuleSet: MindfulnessQuestionnaireValidation
* status MS
* title MS
* item MS

* status = #active
* subjectType = #Patient
* item ^slicing.discriminator.type = #pattern
* item ^slicing.discriminator.path = "linkId"
* item ^slicing.rules = #open
* item contains 
    session 0..1 MS and
    mood 0..1 MS and
    stress 0..1 MS and
    relaxation 0..1 MS

* item[session]
  * linkId = "mindful_session"
  * text = "Mindfulness Session"
  * type = #group
  * required = true
  * repeats = false

* item[mood]
  * linkId = "mood_assessment"
  * text = "Mood Assessment"
  * type = #group
  * required = true
  * repeats = false

* item[stress]
  * linkId = "stress_assessment"
  * text = "Stress Assessment"
  * type = #group
  * required = true
  * repeats = false

* item[relaxation]
  * linkId = "relaxation"
  * text = "Relaxation"
  * type = #group
  * required = true
  * repeats = false

RuleSet: MindfulnessResponseValidation
* status MS
* subject MS
* authored MS
* item MS

* status = #completed
* subject only Reference(Patient)
* authored 1..1
* item ^slicing.discriminator.type = #pattern
* item ^slicing.discriminator.path = "linkId"
* item ^slicing.rules = #open



// ===== Conteúdo de: missing-instances.fsh =====

Instance: example
InstanceOf: Patient
Usage: #example
* identifier.system = "http://example.org/fhir/sid/patients"
* identifier.value = "12345"
* active = true
* name.family = "Doe"
* name.given = "John"
* gender = #male
* birthDate = "1980-01-01"

Instance: practitioner-example
InstanceOf: Practitioner
Usage: #example
* identifier.system = "http://example.org/fhir/sid/practitioners"
* identifier.value = "99999"
* active = true
* name.family = "Smith"
* name.given = "Jane"

Instance: iphone-example
InstanceOf: Device
Usage: #example
* status = #active
* manufacturer = "Apple Inc."
* deviceName.name = "iPhone 14"
* deviceName.type = #user-friendly-name



// ===== Conteúdo de: MindfulnessMappings.fsh =====

Mapping: MindfulnessToHealthKit
Id: mindfulness-to-healthkit
Title: "Mapping to Apple HealthKit"
Source: MindfulnessObservation
Target: "http://developer.apple.com/documentation/healthkit"

* -> "HKCategoryTypeIdentifierMindfulSession" "Root mapping"
* effectiveDateTime -> "startDate and endDate" "Session timing"
* component[sessionDuration].valueQuantity -> "duration" "Session duration"

Mapping: MindfulnessToLOINC
Id: mindfulness-to-loinc
Title: "Mapping to LOINC codes"
Source: MindfulnessObservation
Target: "http://loinc.org"

* -> "89555-7" "Mindfulness safety questionnaire"
* component[stressLevel] -> "89556-5" "Stress level score"
* component[sessionDuration] -> "89557-3" "Duration of mindfulness practice"
* component[moodState] -> "89558-1" "Mood pattern"

Mapping: MindfulnessToSNOMED
Id: mindfulness-to-snomed
Title: "Mapping to SNOMED CT"
Source: MindfulnessObservation
Target: "http://snomed.info/sct"

* -> "711020003" "Meditation"
* component[stressLevel] -> "725854004" "Assessment of stress level"
* component[moodState] -> "373931001" "Mood finding"
* component[relaxationResponse] -> "276241001" "Relaxation technique"

Extension: MindfulnessImportMap
Id: mindfulness-import-map
Title: "Mindfulness Import Mapping"
Description: "Mapping instructions for importing mindfulness data"

* ^url = "https://github.com/RicardoLSantos/shorthand/StructureDefinition/mindfulness-import-map"
* ^version = "1.0.0"
* ^status = #draft

* extension contains
    source 1..1 MS and
    target 1..1 MS and
    mapping 1..1 MS

* extension[source].value[x] only string
* extension[target].value[x] only string
* extension[mapping].value[x] only string

Instance: HealthKitMappingConfig
InstanceOf: MindfulnessImportMap
Usage: #inline

* extension[source].valueString = "HKCategoryTypeIdentifierMindfulSession"
* extension[target].valueString = "Observation"
* extension[mapping].valueString = "duration->component[sessionDuration].valueQuantity"



// ===== Conteúdo de: SocialInteractionMappings.fsh =====

Mapping: SocialInteractionToHealthKit
Id: social-interaction-to-healthkit
Title: "Mapping to Apple HealthKit"
Source: SocialInteractionProfile
Target: "http://developer.apple.com/documentation/healthkit"

* -> "HKCategoryTypeIdentifierSocialInteraction" "Root mapping"
* valueCodeableConcept -> "interactionType" "Type of interaction"
* component[duration] -> "duration" "Duration of interaction"
* component[participants] -> "participantCount" "Number of participants"

Mapping: SocialInteractionToLOINC
Id: social-interaction-to-loinc
Title: "Mapping to LOINC codes"
Source: SocialInteractionProfile
Target: "http://loinc.org"

* -> "96766-1" "Social Interaction Panel"
* component[duration] -> "89597-9" "Interaction duration"
* component[quality] -> "89598-7" "Interaction quality"



// ===== Conteúdo de: MindfulnessDiagnosticMappings.fsh =====

Instance: MindfulnessDiagnosticMap
InstanceOf: ConceptMap
Usage: #definition
Title: "Mindfulness Diagnostic Mappings"
Description: "Mapping of mindfulness outcomes to diagnostic codes"

* status = #draft
* experimental = false
* purpose = "Map mindfulness outcomes to standard diagnostic codes"
* sourceUri = "https://github.com/RicardoLSantos/shorthand/ValueSet/mindfulness-outcome-vs"
* targetUri = "http://snomed.info/sct"

* group[0].source = "https://github.com/RicardoLSantos/shorthand/CodeSystem/mindfulness-outcome-cs"
* group[0].target = "http://snomed.info/sct"
* group[0].element[0]
  * code = #stressReduction
  * target[0]
    * code = #73595000
    * display = "Stress"
    * equivalence = #narrower
    * comment = "Indicates reduction in stress levels"

* group[0].element[1]
  * code = #improvedSleep
  * target[0]
    * code = #248234008
    * display = "Sleep pattern"
    * equivalence = #narrower
    * comment = "Indicates improvement in sleep quality"

* group[0].element[2]
  * code = #emotionalBalance
  * target[0]
    * code = #285854004
    * display = "Emotional state"
    * equivalence = #equivalent
    * comment = "Maps to emotional state finding"

* group[0].element[3]
  * code = #increasedAwareness
  * target[0]
    * code = #736253002
    * display = "Mental state, behavior and/or psychosocial functioning"
    * equivalence = #relatedto
    * comment = "General improvement in mental state"

RuleSet: MindfulnessDiagnosticRules
* status MS
* code MS
* subject MS
* effective[x] MS
* value[x] MS
* method MS

* method from https://github.com/RicardoLSantos/shorthand/ValueSet/mindfulness-diagnostic-method-vs (required)
* code from https://github.com/RicardoLSantos/shorthand/ValueSet/mindfulness-diagnostic-code-vs (required)

* extension contains 
    diagnosticCertainty 0..1 MS and
    diagnosticTiming 0..1 MS



// ===== Conteúdo de: StressMappings.fsh =====

Mapping: StressToHealthKit
Id: stress-to-healthkit
Title: "Mapping to Apple HealthKit"
Source: StressLevelProfile
Target: "http://developer.apple.com/documentation/healthkit"

* -> "HKCategoryTypeIdentifierStressLevel" "Root mapping"
* valueQuantity -> "stressLevel" "Overall stress score"
* component[physiologicalStress] -> "physiologicalStress" "Physical stress indicators"
* component[psychologicalStress] -> "mentalStress" "Mental stress indicators"

Mapping: StressToLOINC
Id: stress-to-loinc
Title: "Mapping to LOINC codes"
Source: StressLevelProfile
Target: "http://loinc.org"

* -> "89592-0" "Stress Level Panel"
* component[physiologicalStress] -> "89593-8" "Physical stress score"
* component[psychologicalStress] -> "89594-6" "Mental stress score"



// ===== Conteúdo de: BodyMetricsProfiles.fsh =====

Alias: $SCT = http://snomed.info/sct
Alias: $LOINC = http://loinc.org
Alias: $UCUM = http://unitsofmeasure.org

Profile: BodyMetricsObservation
Parent: Observation
Id: body-metrics-observation
Title: "Body Metrics Observation Profile"
Description: "Profile for body measurements from iOS Health App"

* ^version = "0.1.0"
* ^status = #draft
* ^publisher = "Open Health Manager"

* status MS
* category 1..1 MS
* category = http://terminology.hl7.org/CodeSystem/observation-category#vital-signs
* subject 1..1 MS
* effectiveDateTime 1..1 MS
* device 0..1 MS

Profile: WeightObservation
Parent: BodyMetricsObservation
Id: weight-observation  
Title: "Weight Measurement Profile"
Description: "Profile for body weight measurements"

* ^version = "0.1.0"
* ^status = #draft

* code = $LOINC#29463-7 "Body weight"
* valueQuantity only Quantity
* valueQuantity.system = $UCUM
* valueQuantity.code = #kg

Profile: HeightObservation
Parent: BodyMetricsObservation
Id: height-observation
Title: "Height Measurement Profile" 
Description: "Profile for body height measurements"

* ^version = "0.1.0"
* ^status = #draft

* code = $LOINC#8302-2 "Body height"
* valueQuantity only Quantity
* valueQuantity.system = $UCUM
* valueQuantity.code = #cm

Profile: BMIObservation
Parent: BodyMetricsObservation
Id: bmi-observation
Title: "BMI Measurement Profile"
Description: "Profile for Body Mass Index calculations"

* ^version = "0.1.0"
* ^status = #draft

* code = $LOINC#39156-5 "Body mass index (BMI)"
* valueQuantity only Quantity
* valueQuantity.system = $UCUM
* valueQuantity.code = #kg/m2

Profile: BodyCompositionObservation
Parent: BodyMetricsObservation
Id: body-composition-observation
Title: "Body Composition Profile"
Description: "Profile for body composition measurements including fat, lean mass, and other metrics"

* ^version = "0.1.0"
* ^status = #draft

* code = $LOINC#88365-2 "Body composition panel"
* component ^slicing.discriminator.type = #pattern
* component ^slicing.discriminator.path = "code"
* component ^slicing.rules = #open

* component contains
    bodyFat 0..1 MS and
    leanMass 0..1 MS and
    bodyWater 0..1 MS and
    muscleMass 0..1 MS and
    boneMass 0..1 MS

* component[bodyFat].code = $LOINC#41982-0 "Percentage body fat"
* component[bodyFat].valueQuantity.system = $UCUM
* component[bodyFat].valueQuantity.code = #%

* component[leanMass].code = $LOINC#291-7 "Lean body mass"
* component[leanMass].valueQuantity.system = $UCUM
* component[leanMass].valueQuantity.code = #kg

* component[bodyWater].code = $LOINC#73708-0 "Total body water"
* component[bodyWater].valueQuantity.system = $UCUM  
* component[bodyWater].valueQuantity.code = #L

* component[muscleMass].code = $LOINC#73713-0 "Muscle mass"
* component[muscleMass].valueQuantity.system = $UCUM
* component[muscleMass].valueQuantity.code = #kg

* component[boneMass].code = $LOINC#73711-4 "Bone mass" 
* component[boneMass].valueQuantity.system = $UCUM
* component[boneMass].valueQuantity.code = #kg



// ===== Conteúdo de: AdvancedVitalSignsProfiles.fsh =====

Alias: $SCT = http://snomed.info/sct
Alias: $LOINC = http://loinc.org
Alias: $UCUM = http://unitsofmeasure.org

Profile: AdvancedVitalSigns
Parent: Observation
Id: advanced-vital-signs
Title: "Advanced Vital Signs Profile"
Description: "Profile for advanced vital signs data from iOS Health App"

* ^version = "0.1.0"
* ^status = #draft
* ^publisher = "HL7 International"
* ^contact.name = "Advanced Vital Signs Working Group"

* status MS
* category 1..1 MS
* category = http://terminology.hl7.org/CodeSystem/observation-category#vital-signs
* code 1..1 MS
* subject 1..1 MS
* effectiveDateTime 1..1 MS
* device 0..1 MS
* method 0..1 MS
* note 0..* MS

* component ^slicing.discriminator.type = #pattern
* component ^slicing.discriminator.path = "code"
* component ^slicing.rules = #open
* component ^short = "Advanced vital signs components"
* component ^definition = "Components of advanced vital sign measurements"

* component contains
    hrvSpectral 0..1 MS and
    hrvEntropy 0..1 MS and
    meanArterialPressure 0..1 MS and
    pulseWaveAnalysis 0..1 MS and
    respiratoryVariability 0..1 MS and
    oxygenationIndex 0..1 MS and
    stressIndex 0..1 MS and
    thermalGradient 0..1 MS and
    autonomicBalance 0..1 MS and
    recoveryRate 0..1 MS and
    allostaticLoad 0..1 MS

* component[hrvSpectral].code = $LOINC#87834-8 "Heart rate variability [Frequency band]"
* component[hrvSpectral].valueQuantity.system = $UCUM
* component[hrvSpectral].valueQuantity.code = #ms
* component[hrvSpectral] ^short = "Spectral analysis of heart rate variability"

* component[hrvEntropy].code = $LOINC#87835-5 "Heart rate variability entropy"
* component[hrvEntropy].valueQuantity.system = $UCUM
* component[hrvEntropy].valueQuantity.code = #{entropy}
* component[hrvEntropy] ^short = "Sample entropy of heart rate variability"

* component[meanArterialPressure].code = $LOINC#8478-0 "Mean blood pressure"
* component[meanArterialPressure].valueQuantity.system = $UCUM
* component[meanArterialPressure].valueQuantity.code = #mmHg
* component[meanArterialPressure] ^short = "Mean arterial blood pressure"

* component[pulseWaveAnalysis].code = $LOINC#87836-3 "Pulse wave analysis"
* component[pulseWaveAnalysis].valueQuantity.system = $UCUM
* component[pulseWaveAnalysis].valueQuantity.code = #{index}
* component[pulseWaveAnalysis] ^short = "Analysis of arterial pulse wave"

* component[respiratoryVariability].code = $LOINC#87837-1 "Respiratory rate variability"
* component[respiratoryVariability].valueQuantity.system = $UCUM
* component[respiratoryVariability].valueQuantity.code = #{coefficient}
* component[respiratoryVariability] ^short = "Variability in respiratory rate"

* component[oxygenationIndex].code = $LOINC#87838-9 "Oxygenation index"
* component[oxygenationIndex].valueQuantity.system = $UCUM
* component[oxygenationIndex].valueQuantity.code = #{ratio}
* component[oxygenationIndex] ^short = "Index of blood oxygenation"

* component[stressIndex].code = $LOINC#87839-7 "Physiological stress index"
* component[stressIndex].valueQuantity.system = $UCUM
* component[stressIndex].valueQuantity.code = #{index}
* component[stressIndex] ^short = "Index of physiological stress"

* component[thermalGradient].code = $LOINC#87840-5 "Temperature gradient"
* component[thermalGradient].valueQuantity.system = $UCUM
* component[thermalGradient].valueQuantity.code = #Cel
* component[thermalGradient] ^short = "Gradient of body temperature"

* component[autonomicBalance].code = $LOINC#87841-3 "Autonomic balance index"
* component[autonomicBalance].valueQuantity.system = $UCUM
* component[autonomicBalance].valueQuantity.code = #{ratio}
* component[autonomicBalance] ^short = "Balance of autonomic nervous system"

* component[recoveryRate].code = $LOINC#87842-1 "Recovery rate index"
* component[recoveryRate].valueQuantity.system = $UCUM
* component[recoveryRate].valueQuantity.code = #{rate}
* component[recoveryRate] ^short = "Rate of physiological recovery"

* component[allostaticLoad].code = $LOINC#87843-9 "Allostatic load index"
* component[allostaticLoad].valueQuantity.system = $UCUM
* component[allostaticLoad].valueQuantity.code = #{score}
* component[allostaticLoad] ^short = "Measure of cumulative physiological burden"

Extension: AdvancedVitalSignsContext
Id: advanced-vital-signs-context
Title: "Advanced Vital Signs Context Extension"
Description: "Additional context about advanced vital sign measurements"

* value[x] only CodeableConcept
* valueCodeableConcept from AdvancedVitalSignsContextVS (required)

ValueSet: AdvancedVitalSignsContextVS
Id: advanced-vital-signs-context-vs
Title: "Advanced Vital Signs Context Value Set"
Description: "Context codes for advanced vital sign measurements"

* ^experimental = true
* codes from system AdvancedVitalSignsContextCS

CodeSystem: AdvancedVitalSignsContextCS
Id: advanced-vital-signs-context-cs
Title: "Advanced Vital Signs Context Code System"
Description: "Codes for advanced vital signs measurement context"

* ^experimental = true
* ^caseSensitive = true

* #resting "Resting state" "Measurement taken during rest"
* #active "Active state" "Measurement taken during activity"
* #recovery "Recovery state" "Measurement taken during recovery"
* #sleep "Sleep state" "Measurement taken during sleep"
* #stress "Stress state" "Measurement taken during stress"



// ===== Conteúdo de: MobilityProfiles.fsh =====

Profile: MobilityProfile
Parent: Observation
Id: mobility-profile
Title: "Mobility Profile"
Description: "Profile for mobility data from iOS Health App"

* status MS
* category 1..1 MS
* category = http://terminology.hl7.org/CodeSystem/observation-category#activity
* code 1..1 MS
* subject 1..1 MS
* effectiveDateTime 1..1 MS
* device 0..1 MS

* component ^slicing.discriminator.type = #pattern
* component ^slicing.discriminator.path = "code"
* component ^slicing.rules = #open

* component contains
    steadiness 0..1 MS and
    balance 0..1 MS and
    gait 0..1 MS and 
    movement 0..1 MS

* component[steadiness].code = $LOINC#LA32-8
* component[balance].code = $LOINC#LA32-9
* component[gait].code = $LOINC#LA29042-4
* component[movement].code = $LOINC#LA29043-2



// ===== Conteúdo de: VitalSignsProfiles.fsh =====

Alias: $SCT = http://snomed.info/sct
Alias: $LOINC = http://loinc.org
Alias: $UCUM = http://unitsofmeasure.org
Alias: $vitalsigns = http://hl7.org/fhir/StructureDefinition/vitalsigns

Profile: LifestyleVitalSigns
Parent: $vitalsigns
Id: lifestyle-vital-signs
Title: "Lifestyle Medicine Vital Signs Profile"
Description: "Profile for vital signs data from iOS Health App"

* status MS
* category 1..* MS
* subject 1..1 MS
* effectiveDateTime 1..1 MS
* code 1..1 MS
* value[x] 0..1 MS
* device 0..1 MS

Profile: HeartRateObservation
Parent: LifestyleVitalSigns
Id: heart-rate-observation
Title: "Heart Rate Observation Profile"
Description: "Profile for heart rate measurements from iOS Health App"

* code = $LOINC#8867-4 "Heart rate"
* valueQuantity only Quantity
* valueQuantity.system = $UCUM
* valueQuantity.code = #/min
* component ^slicing.discriminator.type = #pattern
* component ^slicing.discriminator.path = "code"
* component ^slicing.rules = #open

* component contains
    restingHeartRate 0..1 MS and
    exerciseHeartRate 0..1 MS and
    recoveryHeartRate 0..1 MS and
    heartRateVariability 0..1 MS

* component[heartRateVariability].code = $LOINC#80404-7 "R-R interval.standard deviation (Heart rate variability)"
* component[heartRateVariability].valueQuantity.system = $UCUM
* component[heartRateVariability].valueQuantity.code = #ms

Profile: BloodPressureObservation
Parent: LifestyleVitalSigns
Id: blood-pressure-observation
Title: "Blood Pressure Observation Profile"
Description: "Profile for blood pressure measurements from iOS Health App"

* code = $LOINC#85354-9 "Blood pressure panel with all children optional"
* component 2..2 MS
* component ^slicing.discriminator.type = #pattern
* component ^slicing.discriminator.path = "code"
* component ^slicing.rules = #closed

* component contains
    systolic 1..1 MS and
    diastolic 1..1 MS

* component[systolic].code = $LOINC#8480-6 "Systolic blood pressure"
* component[systolic].valueQuantity only Quantity
* component[systolic].valueQuantity.system = $UCUM
* component[systolic].valueQuantity.code = #mm[Hg]

* component[diastolic].code = $LOINC#8462-4 "Diastolic blood pressure"
* component[diastolic].valueQuantity only Quantity
* component[diastolic].valueQuantity.system = $UCUM
* component[diastolic].valueQuantity.code = #mm[Hg]

Profile: OxygenSaturationObservation
Parent: LifestyleVitalSigns
Id: oxygen-saturation-observation
Title: "Oxygen Saturation Observation Profile"
Description: "Profile for SpO2 measurements from iOS Health App"

* code = $LOINC#2708-6 "Oxygen saturation in Arterial blood"
* valueQuantity.system = $UCUM
* valueQuantity.code = #%



// ===== Conteúdo de: PhysicalActivityProfile.fsh =====

Alias: $LOINC = http://loinc.org
Alias: $SNOMED = http://snomed.info/sct
Alias: $UCUM = http://unitsofmeasure.org
Alias: $ActivityCodes = https://github.com/RicardoLSantos/shorthand/activity-codes

Profile: PhysicalActivityObservation
Parent: Observation
Id: physical-activity-observation
Title: "Physical Activity Observation Profile"
Description: "Profile for recording physical activity data from iOS Health App"

* status MS
* category 1..1 MS
* category = http://terminology.hl7.org/CodeSystem/observation-category#activity
* code 1..1 MS
* code from PhysicalActivityTypeVS (required)
* subject 1..1 MS
* subject only Reference(Patient)
* effectiveDateTime 1..1 MS
* device 0..1 MS
* value[x] only Quantity
* component ^slicing.discriminator.type = #pattern
* component ^slicing.discriminator.path = "code"
* component ^slicing.rules = #open

* component contains
    steps 0..1 MS and
    distance 0..1 MS and
    duration 0..1 MS and
    energy 0..1 MS

* component[steps].code = $LOINC#55423-8 "Number of steps in 24 hour Measured"
* component[steps].valueQuantity only Quantity
* component[steps].valueQuantity.system = $UCUM
* component[steps].valueQuantity.code = #1 "count"

* component[distance].code = $LOINC#55430-3 "Distance walked"
* component[distance].valueQuantity only Quantity
* component[distance].valueQuantity.system = $UCUM
* component[distance].valueQuantity.code = #km "kilometer"

* component[duration].code = $LOINC#55411-3 "Exercise duration"
* component[duration].valueQuantity only Quantity
* component[duration].valueQuantity.system = $UCUM
* component[duration].valueQuantity.code = #min "minute"

* component[energy].code = $LOINC#55424-6 "Energy expenditure"
* component[energy].valueQuantity only Quantity
* component[energy].valueQuantity.system = $UCUM
* component[energy].valueQuantity.code = #kcal "kilocalorie"



// ===== Conteúdo de: ReproductiveObservation.fsh =====

Profile: ReproductiveObservation
Parent: Observation
Id: reproductive-observation
Title: "Reproductive Health Base Profile"
Description: "Base profile for reproductive health observations"

* ^version = "1.0.0"
* ^status = #active
* ^date = "2024-03-19"

* status MS
* category 1..1 MS
* category = http://terminology.hl7.org/CodeSystem/observation-category#reproductive
* code 1..1 MS
* subject 1..1 MS
* subject only Reference(Patient)
* effectiveDateTime 1..1 MS
* value[x] MS

* component ^slicing.discriminator.type = #pattern
* component ^slicing.discriminator.path = "code"
* component ^slicing.rules = #open

* component contains
    severity 0..1 MS and
    duration 0..1 MS and
    frequency 0..1 MS and
    pattern 0..1 MS

* component[severity]
  * code = $LOINC#72514-3
  * value[x] only integer
  * valueInteger 1..1 
  * valueInteger obeys rep-1

* component[duration]
  * code = $LOINC#103332-8
  * value[x] only Quantity
  * valueQuantity from DurationUnitsVS (required)

* component[frequency]
  * code = $LOINC#103334-4
  * value[x] only CodeableConcept
  * valueCodeableConcept from SymptomFrequencyVS (required)

* component[pattern]
  * code = $LOINC#103335-1
  * value[x] only CodeableConcept
  * valueCodeableConcept from SymptomProgressionVS (required)

Invariant: rep-1
Description: "Severity must be between 0 and 10"
Expression: "$this >= 0 and $this <= 10"
Severity: #error



// ===== Conteúdo de: SymptomProfiles.fsh =====

Profile: SymptomQuestionnaire
Parent: Questionnaire
Id: symptom-questionnaire
Title: "Symptom Assessment Questionnaire"
Description: "Questionnaire template for symptom assessments"

* status MS
* title MS
* item MS

* item ^slicing.discriminator.type = #pattern
* item ^slicing.discriminator.path = "linkId"
* item ^slicing.rules = #open

* item contains
    symptomType 1..1 MS and
    location 0..1 MS and
    onset 0..1 MS and
    description 0..1 MS

* item[symptomType].linkId = "symptom-type"
* item[symptomType].text = "Type of Symptom"
* item[symptomType].type = #choice
* item[symptomType].required = true

* item[location].linkId = "location"
* item[location].text = "Location"
* item[location].type = #string

* item[onset].linkId = "onset"
* item[onset].text = "When did it start?"
* item[onset].type = #dateTime

* item[description].linkId = "description"
* item[description].text = "Description"
* item[description].type = #text



// ===== Conteúdo de: ReproductiveProfiles.fsh =====

Profile: FertilityObservation
Parent: Observation
Id: fertility-observation
Title: "Fertility Observation Profile"
Description: "Profile for fertility signs and symptoms"

* status MS
* category 1..1 MS
* category = http://terminology.hl7.org/CodeSystem/observation-category#reproductive
* code = $LOINC#8669-4 "Ovulation status"
* subject 1..1 MS
* effectiveDateTime 1..1 MS

* component ^slicing.discriminator.type = #pattern
* component ^slicing.discriminator.path = "code"
* component ^slicing.rules = #open

* component contains
    cervicalMucus 0..1 MS and
    ovulationTest 0..1 MS and
    fertilityStatus 0..1 MS

* component[cervicalMucus].valueCodeableConcept from https://github.com/RicardoLSantos/shorthand/fhir/ValueSet/cervical-mucus-vs (required)
* component[ovulationTest].valueCodeableConcept from https://github.com/RicardoLSantos/shorthand/fhir/ValueSet/ovulation-test-vs (required)
* component[fertilityStatus].valueCodeableConcept from https://github.com/RicardoLSantos/shorthand/fhir/ValueSet/fertility-status-vs (required)



// ===== Conteúdo de: MindfulnessProfiles.fsh =====

Profile: MindfulnessObservation
Parent: Observation
Id: mindfulness-observation
Title: "Mindfulness Session Observation"
Description: "Profile for recording mindfulness practice sessions and outcomes"

* status MS
* code MS
* subject MS
* effectiveDateTime MS
* performer MS
* value[x] MS
* component MS

* status = #final
* code = $SCT#711020003 "Meditation"
* subject only Reference(Patient)
* effectiveDateTime 1..1
* performer only Reference(Practitioner or PractitionerRole)

* component ^slicing.discriminator.type = #pattern
* component ^slicing.discriminator.path = "code"
* component ^slicing.rules = #open

* component contains
    sessionDuration 0..1 and
    stressLevel 0..1 and
    moodState 0..1 and
    relaxationResponse 0..1 and
    mindfulnessType 0..1

* component[sessionDuration]
  * code = $SCT#118682006 "Duration"
  * value[x] only Quantity
  * valueQuantity
    * value 1..1
    * unit = "min"
    * system = "http://unitsofmeasure.org"
    * code = #min

* component[stressLevel]
  * code = $SCT#725854004 "Assessment of stress level"
  * value[x] only integer
  * valueInteger
    * ^extension[0].url = "http://hl7.org/fhir/StructureDefinition/elementdefinition-minValueInteger"
    * ^extension[0].valueInteger = 0
    * ^extension[1].url = "http://hl7.org/fhir/StructureDefinition/elementdefinition-maxValueInteger"
    * ^extension[1].valueInteger = 10

* component[moodState]
  * code = $SCT#373931001 "Mood finding"
  * value[x] only CodeableConcept
  * valueCodeableConcept from https://github.com/RicardoLSantos/shorthand/fhir/ValueSet/mood (required)

* component[relaxationResponse]
  * code = $SCT#276241001 "Relaxation technique"
  * value[x] only string

* component[mindfulnessType]
  * code = $SCT#711020003 "Meditation"
  * value[x] only CodeableConcept
  * valueCodeableConcept from https://github.com/RicardoLSantos/shorthand/ValueSet/mindfulness-type (required)



// ===== Conteúdo de: SleepProfile.fsh =====

Alias: $SCT = http://snomed.info/sct
Alias: $LOINC = http://loinc.org
Alias: $UCUM = http://unitsofmeasure.org
 
Profile: SleepObservation
Parent: Observation
Id: sleep-observation
Title: "Sleep Observation Profile"
Description: "Profile for recording sleep data from iOS Health App"
 
* status MS
* category 1..1 MS
* category = http://terminology.hl7.org/CodeSystem/observation-category#sleep
* code 1..1 MS
* code = $LOINC#93832-4 "Sleep pattern panel"
* subject 1..1 MS
* subject only Reference(Patient)
* effectiveDateTime 0..1 MS
* effectivePeriod 0..1 MS
* device 0..1 MS
 
* component ^slicing.discriminator.type = #pattern
* component ^slicing.discriminator.path = "code"
* component ^slicing.rules = #open
 
* component contains
    timeInBed 1..1 MS and
    totalSleepTime 1..1 MS and
    deepSleep 0..1 MS and
    remSleep 0..1 MS and
    lightSleep 0..1 MS and
    respiratoryRate 0..1 MS and
    heartRateVariability 0..1 MS and
    interruptions 0..1 MS
 
* component[timeInBed].code = $LOINC#93831-6 "Time in bed"
* component[timeInBed].valueQuantity only Quantity
* component[timeInBed].valueQuantity.system = $UCUM
* component[timeInBed].valueQuantity.code = #min
 
* component[totalSleepTime].code = $LOINC#93833-2 "Sleep duration"
* component[totalSleepTime].valueQuantity only Quantity
* component[totalSleepTime].valueQuantity.system = $UCUM
* component[totalSleepTime].valueQuantity.code = #min
 
* component[deepSleep].code = $LOINC#93834-0 "Deep sleep duration"
* component[deepSleep].valueQuantity only Quantity
* component[deepSleep].valueQuantity.system = $UCUM
* component[deepSleep].valueQuantity.code = #min
 
* component[remSleep].code = $LOINC#93835-7 "REM sleep duration"
* component[remSleep].valueQuantity only Quantity
* component[remSleep].valueQuantity.system = $UCUM
* component[remSleep].valueQuantity.code = #min
 
* component[lightSleep].code = $LOINC#93836-5 "Light sleep duration"
* component[lightSleep].valueQuantity only Quantity
* component[lightSleep].valueQuantity.system = $UCUM
* component[lightSleep].valueQuantity.code = #min
 
* component[respiratoryRate].code = $LOINC#9279-1 "Respiratory rate"
* component[respiratoryRate].valueQuantity only Quantity
* component[respiratoryRate].valueQuantity.system = $UCUM
* component[respiratoryRate].valueQuantity.code = #/min
 
* component[heartRateVariability].code = $LOINC#80404-7 "R-R interval.standard deviation (Heart rate variability)"
* component[heartRateVariability].valueQuantity only Quantity
* component[heartRateVariability].valueQuantity.system = $UCUM
* component[heartRateVariability].valueQuantity.code = #ms
 
* component[interruptions].code = $LOINC#93837-3 "Number of awakenings during sleep"
* component[interruptions].valueQuantity only Quantity
* component[interruptions].valueQuantity.system = $UCUM
* component[interruptions].valueQuantity.code = #{count}
* extension contains SleepQuality named quality 0..1



// ===== Conteúdo de: MobilityRiskAssessment.fsh =====

Profile: MobilityRiskAssessment
Parent: RiskAssessment
Id: mobility-risk-assessment
Title: "Mobility Risk Assessment Profile"
Description: "Profile for assessing mobility-related risks"

* status MS
* subject 1..1 MS
* occurrence[x] MS
* prediction MS
  * outcome MS
  * probability[x] MS
  * qualitativeRisk MS

* method MS
  * coding ^slicing.discriminator.type = #pattern
  * coding ^slicing.discriminator.path = "$this"
  * coding ^slicing.rules = #open
  * coding contains
      mobilityAssessment 1..1 MS

* method.coding[mobilityAssessment] = https://github.com/RicardoLSantos/shorthand/CodeSystem/mobility-assessment-method#standardized "Standardized Mobility Assessment"

* prediction ^slicing.discriminator.type = #pattern
* prediction ^slicing.discriminator.path = "outcome"
* prediction ^slicing.rules = #open

* prediction contains
    fallRisk 0..1 MS and
    mobilityDecline 0..1 MS and
    assistanceNeeded 0..1 MS

* prediction[fallRisk].outcome from https://github.com/RicardoLSantos/shorthand/ValueSet/fall-risk-outcomes
* prediction[fallRisk].probabilityDecimal 0..1 MS
* prediction[fallRisk].qualitativeRisk from https://github.com/RicardoLSantos/shorthand/ValueSet/risk-level

* prediction[mobilityDecline].outcome from https://github.com/RicardoLSantos/shorthand/ValueSet/mobility-decline-outcomes
* prediction[mobilityDecline].probabilityDecimal 0..1 MS
* prediction[mobilityDecline].qualitativeRisk from https://github.com/RicardoLSantos/shorthand/ValueSet/risk-level

* prediction[assistanceNeeded].outcome from https://github.com/RicardoLSantos/shorthand/ValueSet/assistance-level-outcomes
* prediction[assistanceNeeded].probabilityDecimal 0..1 MS
* prediction[assistanceNeeded].qualitativeRisk from https://github.com/RicardoLSantos/shorthand/ValueSet/risk-level

* basis only Reference(MobilityProfile or Observation or QuestionnaireResponse)
* basis MS

* note MS



// ===== Conteúdo de: EnvironmentalProfiles.fsh =====

Alias: $SCT = http://snomed.info/sct
Alias: $LOINC = http://loinc.org
Alias: $UCUM = http://unitsofmeasure.org

Profile: EnvironmentalObservation
Parent: Observation
Id: environmental-observation
Title: "Environmental Observation Profile"
Description: "Base profile for environmental measurements from iOS Health App"

* ^version = "0.1.0"
* ^status = #draft
* ^publisher = "HL7 International"
* ^contact.name = "Environmental Health Working Group"

* status MS
* category 1..1 MS
* category = http://terminology.hl7.org/CodeSystem/observation-category#environment
* subject 1..1 MS
* effectiveDateTime 1..1 MS
* device 0..1 MS
* method 0..1 MS
* note 0..* MS

Profile: NoiseExposureObservation
Parent: EnvironmentalObservation
Id: noise-exposure-observation
Title: "Noise Exposure Observation Profile"
Description: "Profile for noise exposure measurements from iOS Health App"

* code = $LOINC#28573-7 "Noise exposure time"
* component ^slicing.discriminator.type = #pattern
* component ^slicing.discriminator.path = "code"
* component ^slicing.rules = #open
* component ^short = "Noise exposure components"
* component ^definition = "Components of noise exposure measurement"

* component contains
    level 1..1 MS and
    duration 1..1 MS and
    peakLevel 0..1 MS and
    backgroundNoise 0..1 MS

* component[level].code = $LOINC#89020-2 "Environmental noise average"
* component[level].valueQuantity.system = $UCUM
* component[level].valueQuantity.code = #dB
* component[level].valueQuantity ^short = "Noise level in decibels"

* component[duration].code = $LOINC#89021-0 "Environmental noise duration"
* component[duration].valueQuantity.system = $UCUM
* component[duration].valueQuantity.code = #min
* component[duration].valueQuantity ^short = "Duration of exposure"

* component[peakLevel].code = $LOINC#89024-4 "Peak sound level"
* component[peakLevel].valueQuantity.system = $UCUM
* component[peakLevel].valueQuantity.code = #dB
* component[peakLevel].valueQuantity ^short = "Peak noise level"

* component[backgroundNoise].code = $LOINC#89025-1 "Background noise level"
* component[backgroundNoise].valueQuantity.system = $UCUM
* component[backgroundNoise].valueQuantity.code = #dB
* component[backgroundNoise].valueQuantity ^short = "Background noise level"

Profile: UVExposureObservation
Parent: EnvironmentalObservation
Id: uv-exposure-observation
Title: "UV Exposure Observation Profile"
Description: "Profile for UV exposure measurements from iOS Health App"

* code = $LOINC#28574-5 "UV exposure"
* component ^slicing.discriminator.type = #pattern
* component ^slicing.discriminator.path = "code"
* component ^slicing.rules = #open
* component ^short = "UV exposure components"
* component ^definition = "Components of UV exposure measurement"

* component contains
    index 1..1 MS and
    duration 1..1 MS and
    timeOfDay 0..1 MS and
    intensity 0..1 MS

* component[index].code = $LOINC#89022-8 "UV index"
* component[index].valueQuantity.system = $UCUM
* component[index].valueQuantity.code = #{index}
* component[index].valueQuantity ^short = "UV index value"

* component[duration].code = $LOINC#89023-6 "UV exposure duration"
* component[duration].valueQuantity.system = $UCUM
* component[duration].valueQuantity.code = #min
* component[duration].valueQuantity ^short = "Duration of UV exposure"

* component[timeOfDay].code = $LOINC#89026-9 "Time of exposure"
* component[timeOfDay].valueDateTime 1..1
* component[timeOfDay].valueDateTime ^short = "Time of UV exposure"

* component[intensity].code = $LOINC#89027-7 "UV intensity"
* component[intensity].valueQuantity.system = $UCUM
* component[intensity].valueQuantity.code = #W/m2
* component[intensity].valueQuantity ^short = "UV radiation intensity"

Extension: EnvironmentalContext
Id: environmental-context
Title: "Environmental Context Extension"
Description: "Additional context about environmental measurements"

* value[x] only CodeableConcept
* valueCodeableConcept from https://github.com/RicardoLSantos/shorthand/fhir/ValueSet/environmental-context (required)



// ===== Conteúdo de: SocialInteractionProfile.fsh =====

Profile: SocialInteractionProfile
Parent: Observation
Id: social-interaction
Title: "Social Interaction Profile"
Description: "Profile for recording social interaction data from iOS Health App"

* ^version = "0.1.0"
* ^status = #active
* ^date = "2024-01-03"
* ^publisher = "FMUP HEADS2"

* status MS
* category 1..1 MS
* category = http://terminology.hl7.org/CodeSystem/observation-category#social-history
* code 1..1 MS
* code = $LOINC#96766-1 "Social interaction pattern"
* subject 1..1 MS
* effectiveDateTime 1..1 MS
* value[x] only CodeableConcept
* valueCodeableConcept from SocialInteractionTypeVS (required)

* component ^slicing.discriminator.type = #pattern
* component ^slicing.discriminator.path = "code"
* component ^slicing.rules = #open

* component contains
    duration 0..1 MS and
    quality 0..1 MS and
    medium 0..1 MS and
    participants 0..1 MS

* component[duration]
  * code = $LOINC#89597-9 "Social interaction duration"
  * valueQuantity only Quantity
  * valueQuantity.system = $UCUM
  * valueQuantity.code = #min

* component[quality]
  * code = $LOINC#89598-7 "Social interaction quality"
  * valueCodeableConcept from SocialInteractionQualityVS (required)

* component[medium]
  * code = $LOINC#89599-5 "Social interaction medium"
  * valueCodeableConcept from SocialInteractionMediumVS (required)

* component[participants]
  * code = $LOINC#89600-1 "Social interaction participants"
  * valueInteger only integer

* extension contains
    SocialContext named context 0..1 MS and
    SocialSupport named support 0..1 MS and
    SocialActivity named activity 0..* MS



// ===== Conteúdo de: StressLevelProfile.fsh =====

Profile: StressLevelProfile
Parent: Observation
Id: stress-level
Title: "Stress Level Profile"
Description: "Profile for recording stress level measurements from iOS Health App"

* ^version = "0.1.0"
* ^status = #active
* ^date = "2024-01-03"
* ^publisher = "FMUP HEADS2"

* status MS
* category 1..1 MS
* category = http://terminology.hl7.org/CodeSystem/observation-category#vital-signs
* code 1..1 MS
* code = $LOINC#89592-0 "Stress level score"
* subject 1..1 MS
* effectiveDateTime 1..1 MS
* value[x] only Quantity
* valueQuantity MS

* component ^slicing.discriminator.type = #pattern
* component ^slicing.discriminator.path = "code"
* component ^slicing.rules = #open

* component contains
    physiologicalStress 0..1 MS and
    psychologicalStress 0..1 MS and
    chronicity 0..1 MS and 
    impact 0..1 MS

* component[physiologicalStress]
  * code = $LOINC#89593-8 "Physiological stress"
  * valueQuantity only Quantity
  * valueQuantity.system = $UCUM
  * valueQuantity.code = #{score}

* component[psychologicalStress]
  * code = $LOINC#89594-6 "Psychological stress"
  * valueQuantity only Quantity
  * valueQuantity.system = $UCUM
  * valueQuantity.code = #{score}

* component[chronicity]
  * code = $LOINC#89595-3 "Stress chronicity"
  * valueCodeableConcept from StressChronicityVS (required)

* component[impact]
  * code = $LOINC#89596-1 "Stress impact"
  * valueCodeableConcept from StressImpactVS (required)

* extension contains
    MeasurementContext named context 0..1 MS and
    StressTriggers named triggers 0..* MS and 
    StressCoping named coping 0..* MS



// ===== Conteúdo de: NutritionProfiles.fsh =====

Alias: $SCT = http://snomed.info/sct
Alias: $LOINC = http://loinc.org
Alias: $UCUM = http://unitsofmeasure.org

Profile: NutritionIntakeObservation
Parent: Observation
Id: nutrition-intake-observation
Title: "Nutrition Intake Observation Profile"
Description: "Profile for nutrition intake data from iOS Health App and user input"

* ^version = "0.1.0"
* ^status = #draft
* ^publisher = "Ricardo Lourenço dos Santos"

* status MS
* category 1..1 MS
* category = http://terminology.hl7.org/CodeSystem/observation-category#nutrition
* subject 1..1 MS
* effectiveDateTime 1..1 MS
* code 1..1 MS
* method 0..1 MS

Profile: WaterIntakeObservation
Parent: NutritionIntakeObservation 
Id: water-intake-observation
Title: "Water Intake Observation Profile"
Description: "Profile for water intake measurements"

* ^version = "0.1.0"
* ^status = #draft
* ^publisher = "Ricardo Lourenço dos Santos"

* code = $LOINC#77111-4 "Water intake"
* valueQuantity only Quantity
* valueQuantity.system = $UCUM
* valueQuantity.code = #mL
* valueQuantity.unit = "milliliter"

Profile: CalorieIntakeObservation
Parent: NutritionIntakeObservation
Id: calorie-intake-observation
Title: "Calorie Intake Observation Profile"
Description: "Profile for caloric intake measurements"

* ^version = "0.1.0"
* ^status = #draft
* ^publisher = "Ricardo Lourenço dos Santos"

* code = $LOINC#9051-4 "Caloric intake total"
* valueQuantity only Quantity
* valueQuantity.system = $UCUM
* valueQuantity.code = #kcal
* valueQuantity.unit = "kilocalorie"

Profile: MacronutrientsObservation
Parent: NutritionIntakeObservation
Id: macronutrients-observation
Title: "Macronutrients Observation Profile"
Description: "Profile for macronutrient intake measurements"

* ^version = "0.1.0"
* ^status = #draft
* ^publisher = "Ricardo Lourenço dos Santos"

* code = $LOINC#LP199119-9 "Macronutrients panel"
* component ^slicing.discriminator.type = #pattern
* component ^slicing.discriminator.path = "code"
* component ^slicing.rules = #open

* component contains
    carbohydrates 0..1 MS and
    proteins 0..1 MS and
    fats 0..1 MS

* component[carbohydrates].code = $LOINC#LP35925-4 "Carbohydrates"
* component[carbohydrates].valueQuantity.system = $UCUM
* component[carbohydrates].valueQuantity.code = #g
* component[carbohydrates].valueQuantity.unit = "gram"

* component[proteins].code = $LOINC#LP35921-3 "Proteins" 
* component[proteins].valueQuantity.system = $UCUM
* component[proteins].valueQuantity.code = #g
* component[proteins].valueQuantity.unit = "gram"

* component[fats].code = $LOINC#LP35922-1 "Fats"
* component[fats].valueQuantity.system = $UCUM
* component[fats].valueQuantity.code = #g
* component[fats].valueQuantity.unit = "gram"



// ===== Conteúdo de: MindfulnessMessaging.fsh =====

Alias: $MsgEvents = https://github.com/RicardoLSantos/shorthand/fhir/CodeSystem/mindfulness-message-events
Alias: $MsgTypes = http://terminology.hl7.org/CodeSystem/message-type

Profile: MindfulnessMessageDefinition
Parent: MessageDefinition
Id: mindfulness-message-definition
Title: "Mindfulness Message Definition" 
Description: "Definition for mindfulness session messages"

* url 1..1 MS
* date 1..1 MS
* status 1..1 MS
* event[x] 1..1 MS
* category 0..1 MS
* focus 1..* MS
* focus.min 1..1

Instance: StartSessionMessage
InstanceOf: MindfulnessMessageDefinition
Title: "Start Session Message"
Description: "Message definition for starting a mindfulness session"

* url = "https://github.com/RicardoLSantos/shorthand/fhir/MessageDefinition/start-session"
* date = "2024-03-19"
* status = #active
* eventCoding = $MsgEvents#session-start "Session Start"
* category = #notification
* focus.code = #Observation
* focus.min = 1
* focus.profile = "https://github.com/RicardoLSantos/shorthand/fhir/StructureDefinition/mindfulness-session"

Instance: EndSessionMessage  
InstanceOf: MindfulnessMessageDefinition
Title: "End Session Message"
Description: "Message definition for ending a mindfulness session"

* url = "https://github.com/RicardoLSantos/shorthand/fhir/MessageDefinition/end-session"
* date = "2024-03-19"
* status = #active
* eventCoding = $MsgEvents#session-end "Session End"
* category = #notification
* focus.code = #Observation
* focus.min = 1
* focus.profile = "https://github.com/RicardoLSantos/shorthand/fhir/StructureDefinition/mindfulness-session"



// ===== Conteúdo de: MindfulnessReports.fsh =====

Instance: MindfulnessProgressReport
InstanceOf: Measure
Usage: #definition
Title: "Mindfulness Practice Progress Report"

* status = #active
* experimental = false
* date = "2024-03-19"
* publisher = "Example Organization"
* description = "Measures progress in mindfulness practice over time"

* scoring = #continuous-variable
* type = #process
* riskAdjustment = "none"
* rateAggregation = "Average values over time period"

* group[0]
  * code = #practice-frequency
  * description = "Frequency of mindfulness practice"
  * population[0]
    * code = #denominator
    * criteria.language = #text/fhirpath
    * criteria.expression = "Observation.where(code.coding.code='711020003')"
  * stratifier[0]
    * code = #weekly
    * criteria.language = #text/fhirpath
    * criteria.expression = "Observation.effective.as(DateTime).truncate(@T).truncate(@W)"

* group[1]
  * code = #stress-reduction
  * description = "Stress level changes over time"
  * population[0]
    * code = #denominator
    * criteria.language = #text/fhirpath
    * criteria.expression = "Observation.where(component.code.coding.code='725854004')"
  * stratifier[0]
    * code = #trend
    * criteria.language = #text/fhirpath
    * criteria.expression = "component.where(code.coding.code='725854004').value.value"

RuleSet: ReportingMetrics
* group[+]
  * code = #session-duration
  * description = "Duration of practice sessions"
  * population[0]
    * code = #denominator
    * criteria.language = #text/fhirpath
    * criteria.expression = "Observation.component.where(code.coding.code='118682006')"
  * stratifier[0]
    * code = #average
    * criteria.language = #text/fhirpath
    * criteria.expression = "component.where(code.coding.code='118682006').value.value"

* group[+]
  * code = #mood-changes
  * description = "Mood state changes"
  * population[0]
    * code = #denominator
    * criteria.language = #text/fhirpath
    * criteria.expression = "Observation.component.where(code.coding.code='373931001')"



// ===== Conteúdo de: code-replacements.fsh =====

// SUBSTITUIÇÕES DE CÓDIGOS CONFIRMADAS COMO VÁLIDAS

// Walking - usar código LOINC correto
Alias: WALKING_SPEED = http://loinc.org#41950-7 "Number of steps in 24 hour"

// Sleep - códigos LOINC válidos
Alias: SLEEP_DURATION = http://loinc.org#93832-4 "Sleep duration"

// Mindfulness - usar código genérico de terapia
Alias: MINDFULNESS = http://snomed.info/sct#182840001 "Drug treatment education"

// Body Composition - usar códigos que existem
Alias: BODY_FAT = http://loinc.org#41982-0 "Percentage of body fat Measured"

// UV Exposure - usar código ambiental genérico  
Alias: UV_EXPOSURE = http://loinc.org#82612-7 "UV index"



// ===== Conteúdo de: MindfulnessCapabilities.fsh =====

Instance: MindfulnessCapabilityStatement
InstanceOf: CapabilityStatement
Usage: #definition
Title: "Mindfulness Module Capabilities"
Description: "Capabilities supported by the mindfulness module implementation"

* status = #draft
* date = "2024-03-19"
* kind = #requirements
* fhirVersion = #4.0.1
* format[0] = #json
* format[1] = #xml

* rest[0]
  * mode = #server
  * documentation = "RESTful server capabilities for mindfulness data"
  
  * resource[0]
    * type = #Observation
    * documentation = "Supports mindfulness session observations"
    * profile = "https://example.org/StructureDefinition/mindfulness-observation"
    * interaction[0]
      * code = #read
    * interaction[1]
      * code = #create
    * interaction[2]
      * code = #update
    * interaction[3]
      * code = #search-type
    * searchParam[0]
      * name = "patient"
      * type = #reference
      * documentation = "Search by patient reference"
    * searchParam[1]
      * name = "date"
      * type = #date
      * documentation = "Search by session date"
    * searchParam[2]
      * name = "code"
      * type = #token
      * documentation = "Search by observation type"
      
  * resource[1]
    * type = #Questionnaire
    * documentation = "Supports mindfulness questionnaires"
    * profile = "https://example.org/StructureDefinition/mindfulness-questionnaire"
    * interaction[0]
      * code = #read
    * interaction[1]
      * code = #search-type
    * searchParam[0]
      * name = "title"
      * type = #string
      * documentation = "Search by questionnaire title"
      
  * resource[2]
    * type = #QuestionnaireResponse
    * documentation = "Supports mindfulness questionnaire responses"
    * profile = "https://example.org/StructureDefinition/mindfulness-questionnaire-response"
    * interaction[0]
      * code = #create
    * interaction[1]
      * code = #read
    * interaction[2]
      * code = #search-type
    * searchParam[0]
      * name = "patient"
      * type = #reference
      * documentation = "Search by patient reference"
    * searchParam[1]
      * name = "authored"
      * type = #date
      * documentation = "Search by response date"



// ===== Conteúdo de: MindfulnessQuestionnaires.fsh =====

Instance: DailyMindfulnessQuestionnaire
InstanceOf: Questionnaire
Usage: #definition
Title: "Daily Mindfulness Questionnaire"
Description: "Questionnaire for capturing daily mindfulness practice and associated effects"

* url = "http://example.org/Questionnaire/daily-mindfulness"
* status = #active
* title = "Daily Mindfulness Practice"
* subjectType = #Patient
* version = "1.0.0"
* name = "DailyMindfulnessQuestionnaire"
* date = "2024-03-19"

* item[0]
  * linkId = "mindful_session"
  * text = "Mindfulness Session"
  * type = #group
  * repeats = false

  * item[0]
    * linkId = "session_duration"
    * text = "Session duration (minutes)"
    * type = #integer
    * required = true
    * extension[0].url = "http://hl7.org/fhir/StructureDefinition/minValue"
    * extension[0].valueInteger = 1

  * item[1]
    * linkId = "practice_type"
    * text = "Practice type"
    * type = #choice
    * required = true
    * answerOption[0].valueString = "Meditation"
    * answerOption[1].valueString = "Breathing exercise"
    * answerOption[2].valueString = "Body scan"
    * answerOption[3].valueString = "Mindful walking"

* item[1]
  * linkId = "mood_assessment"
  * text = "Mood Assessment"
  * type = #group

  * item[0]
    * linkId = "current_mood"
    * text = "How is your mood now?"
    * type = #choice
    * required = true
    * answerValueSet = "https://example.org/fhir/ValueSet/mood-vs"

  * item[1]
    * linkId = "mood_intensity"
    * text = "Mood intensity (1-5)"
    * type = #integer
    * required = true

* item[2]
  * linkId = "stress_assessment"
  * text = "Stress Assessment"
  * type = #group

  * item[0]
    * linkId = "stress_level"
    * text = "Stress level (0-10)"
    * type = #integer
    * required = true

  * item[1]
    * linkId = "stress_symptoms"
    * text = "Stress symptoms"
    * type = #choice
    * repeats = true
    * answerOption[0].valueString = "Muscle tension"
    * answerOption[1].valueString = "Anxiety"
    * answerOption[2].valueString = "Headache"
    * answerOption[3].valueString = "Fatigue"

* item[3]
  * linkId = "relaxation"
  * text = "Relaxation"
  * type = #group

  * item[0]
    * linkId = "relaxation_duration"
    * text = "Relaxation time (minutes)"
    * type = #integer
    * required = true

  * item[1]
    * linkId = "relaxation_technique"
    * text = "Technique used"
    * type = #choice
    * required = true
    * answerOption[0].valueString = "Deep breathing"
    * answerOption[1].valueString = "Progressive relaxation"
    * answerOption[2].valueString = "Visualization"
    * answerOption[3].valueString = "Mindful awareness"



// ===== Conteúdo de: NutritionQuestionnaires.fsh =====

Instance: DailyNutritionQuestionnaire
InstanceOf: Questionnaire
Usage: #definition
Title: "Daily Nutrition Intake Questionnaire"
Description: "Questionnaire for daily nutrition intake tracking"

* url = "https://github.com/RicardoLSantos/shorthand/Questionnaire/daily-nutrition"
* version = "0.1.0"
* name = "DailyNutritionQuestionnaire"
* title = "Daily Nutrition Intake"
* status = #active
* experimental = false
* date = "2024-12-14"
* publisher = "Ricardo Lourenço dos Santos"

* item[0]
  * linkId = "water_intake"
  * text = "How much water did you drink today?"
  * type = #quantity
  * required = true
  * repeats = false
  * initial.valueQuantity = 0 'mL'

* item[1]
  * linkId = "meal_record"
  * text = "Meal Records"
  * type = #group
  * repeats = true

  * item[0]
    * linkId = "meal_time"
    * text = "Meal Time"
    * type = #dateTime
    * required = true

  * item[1]
    * linkId = "meal_type"
    * text = "Meal Type"
    * type = #choice
    * required = true
    * answerOption[0].valueString = "Breakfast"
    * answerOption[1].valueString = "Lunch"
    * answerOption[2].valueString = "Dinner"
    * answerOption[3].valueString = "Snack"

  * item[2]
    * linkId = "calories"
    * text = "Estimated Calories"
    * type = #integer
    * required = true

  * item[3]
    * linkId = "macronutrients"
    * text = "Macronutrients"
    * type = #group

    * item[0]
      * linkId = "carbs"
      * text = "Carbohydrates (g)"
      * type = #decimal
      * required = true

    * item[1]
      * linkId = "protein"
      * text = "Proteins (g)"
      * type = #decimal
      * required = true

    * item[2]
      * linkId = "fat"
      * text = "Fats (g)"
      * type = #decimal
      * required = true

* item[2]
  * linkId = "caffeine"
  * text = "Caffeine Intake"
  * type = #group

  * item[0]
    * linkId = "caffeine_amount"
    * text = "Caffeine amount (mg)"
    * type = #integer
    * required = false

  * item[1]
    * linkId = "caffeine_source"
    * text = "Caffeine source"
    * type = #choice
    * repeats = true
    * answerOption[0].valueString = "Coffee"
    * answerOption[1].valueString = "Tea"
    * answerOption[2].valueString = "Soft Drink"
    * answerOption[3].valueString = "Energy Drink"



// ===== Conteúdo de: ReproductiveQuestionnaire.fsh =====

Instance: ReproductiveHealthQuestionnaire
InstanceOf: Questionnaire
Usage: #definition
Title: "Reproductive Health Tracking Questionnaire"
Description: "Daily questionnaire for reproductive health tracking"
 
* status = #active
* url = "http://example.org/Questionnaire/reproductive-health"
* name = "ReproductiveHealthQuestionnaire"
* title = "Reproductive Health Monitoring"
* date = "2024-03-19"
 
* item[0]
  * linkId = "menstrual_cycle"
  * text = "Menstrual Cycle"
  * type = #group
 
  * item[0]
    * linkId = "cycle_start"
    * text = "Cycle started today?"
    * type = #boolean
 
  * item[1]
    * linkId = "flow_intensity"
    * text = "Flow intensity"
    * type = #choice
    * enableWhen
      * question = "cycle_start"
      * operator = #=
      * answerBoolean = true
    * answerOption[0].valueString = "Light"
    * answerOption[1].valueString = "Moderate"
    * answerOption[2].valueString = "Heavy"
 
* item[1]
  * linkId = "symptoms"
  * text = "Symptoms"
  * type = #group
  * repeats = true
 
  * item[0]
    * linkId = "symptom_type"
    * text = "Symptom type"
    * type = #choice
    * answerValueSet = "http://example.org/ValueSet/reproductive-symptoms"
 
  * item[1]
    * linkId = "symptom_severity"
    * text = "Intensity (0-10)"
    * type = #integer
    * extension[0]
      * url = "http://hl7.org/fhir/StructureDefinition/minValue"
      * valueInteger = 0
    * extension[1]
      * url = "http://hl7.org/fhir/StructureDefinition/maxValue"
      * valueInteger = 10
 
* item[2]
  * linkId = "mood_changes"
  * text = "Mood Changes"
  * type = #group

  * item[0]
    * linkId = "mood_type"
    * text = "Current mood"
    * type = #choice
    * answerValueSet = "http://example.org/ValueSet/mood-types"

  * item[1]
    * linkId = "mood_severity"
    * text = "Intensity (0-10)"
    * type = #integer
    * extension[0]
      * url = "http://hl7.org/fhir/StructureDefinition/minValue"
      * valueInteger = 0
    * extension[1]
      * url = "http://hl7.org/fhir/StructureDefinition/maxValue"
      * valueInteger = 10



// ===== Conteúdo de: aliases.fsh =====

Alias: SCT = http://snomed.info/sct
Alias: LOINC = http://loinc.org
Alias: UCUM = http://unitsofmeasure.org



// ===== Conteúdo de: MindfulnessTerminology.fsh =====

CodeSystem: MindfulnessOutcomeCS
Id: mindfulness-outcome-cs
Title: "Mindfulness Outcomes"
Description: "Outcomes and effects of mindfulness practice"

* ^experimental = false
* ^caseSensitive = true
* #increasedAwareness "Increased Awareness" "Greater awareness of thoughts and sensations"
* #improvedFocus "Improved Focus" "Enhanced ability to concentrate"
* #stressReduction "Stress Reduction" "Decreased levels of stress and tension"
* #emotionalBalance "Emotional Balance" "Better emotional regulation"
* #improvedSleep "Improved Sleep" "Enhanced sleep quality"

ValueSet: MindfulnessOutcomeVS
Id: mindfulness-outcome-vs
Title: "Mindfulness Outcomes Value Set"
Description: "Value set for mindfulness practice outcomes"

* ^experimental = false
* include codes from system MindfulnessOutcomeCS
* include $SCT#365949003 "Finding of level of stress"
* include $SCT#373931001 "Mood finding"

CodeSystem: MindfulnessQualifierCS
Id: mindfulness-qualifier-cs
Title: "Mindfulness Practice Qualifiers"
Description: "Qualifiers for mindfulness practice characteristics"

* ^experimental = false
* ^caseSensitive = true
* #guided "Guided Practice" "Practice with guidance or instruction"
* #selfDirected "Self-Directed" "Independent practice"
* #group "Group Practice" "Practice in group setting"
* #individual "Individual Practice" "Solo practice session"

ValueSet: MindfulnessQualifierVS
Id: mindfulness-qualifier-vs
Title: "Mindfulness Practice Qualifiers Value Set"
Description: "Value set for mindfulness practice qualifiers"

* ^experimental = false
* include codes from system MindfulnessQualifierCS
* include $SCT#410534003 "Guided meditation"
* include $SCT#225386006 "Exercise therapy"

* ^copyright = "This value set includes content from SNOMED CT, which is copyright © 2002+ International Health Terminology Standards Development Organisation (IHTSDO)"



// ===== Conteúdo de: MindfulnessConfig.fsh =====

Extension: MindfulnessSessionDuration
Id: mindfulness-session-duration
Title: "Mindfulness Session Duration"
Description: "Default duration for mindfulness sessions in minutes"
* value[x] only integer

Extension: MindfulnessReminderTime
Id: mindfulness-reminder-time
Title: "Mindfulness Reminder Time"
Description: "Default time for daily reminders"
* value[x] only time

Extension: MindfulnessPreferredGuide
Id: mindfulness-preferred-guide
Title: "Mindfulness Preferred Guide"
Description: "Preferred guide for mindfulness sessions"
* value[x] only string

Extension: MindfulnessNotificationEnabled
Id: mindfulness-notification-enabled
Title: "Mindfulness Notification Enabled"
Description: "Whether notifications are enabled for mindfulness sessions"
* value[x] only boolean

Profile: MindfulnessConfiguration
Parent: Basic
Id: mindfulness-configuration
Title: "Mindfulness Configuration"
Description: "Configuration settings for mindfulness sessions"

* code 1..1 MS
* code = http://example.org/CodeSystem/mindfulness-config-type#settings "Mindfulness Settings"

* extension contains
    MindfulnessSessionDuration named sessionDuration 1..1 MS and
    MindfulnessReminderTime named reminderTime 1..1 MS and
    MindfulnessPreferredGuide named preferredGuide 0..1 MS and
    MindfulnessNotificationEnabled named notificationEnabled 1..1 MS

Instance: DefaultMindfulnessConfig
InstanceOf: MindfulnessConfiguration
Title: "Default Mindfulness Configuration"
Description: "Default configuration settings for mindfulness sessions"

* code = http://example.org/CodeSystem/mindfulness-config-type#settings "Mindfulness Settings"
* extension[sessionDuration].valueInteger = 15
* extension[reminderTime].valueTime = "08:00:00"
* extension[preferredGuide].valueString = "Jane Smith"
* extension[notificationEnabled].valueBoolean = true



// ===== Conteúdo de: MindfulnessAuditConfig.fsh =====

Extension: MindfulnessAuditLevel
Id: mindfulness-audit-level
Title: "Mindfulness Audit Level"
Description: "Level of detail for audit records"
* value[x] only code
* valueCode from http://example.org/fhir/ValueSet/audit-levels (required)

Extension: MindfulnessAuditRetention
Id: mindfulness-audit-retention
Title: "Mindfulness Audit Retention"
Description: "Period to retain audit records"
* value[x] only Duration

Extension: MindfulnessAuditFormat
Id: mindfulness-audit-format
Title: "Mindfulness Audit Format"
Description: "Format for audit records"
* value[x] only code
* valueCode from http://example.org/fhir/ValueSet/audit-formats (required)

Profile: MindfulnessAuditConfig
Parent: Basic
Id: mindfulness-audit-config
Title: "Mindfulness Audit Configuration"
Description: "Configuration for mindfulness session auditing"

* code 1..1 MS
* code = http://example.org/CodeSystem/mindfulness-config-type#audit "Audit Configuration"

* extension contains
    MindfulnessAuditLevel named auditLevel 1..1 MS and
    MindfulnessAuditRetention named auditRetention 1..1 MS and
    MindfulnessAuditFormat named auditFormat 1..1 MS

Instance: DefaultAuditConfig
InstanceOf: MindfulnessAuditConfig
Title: "Default Audit Configuration"
Description: "Default configuration for mindfulness session auditing"

* code = http://example.org/CodeSystem/mindfulness-config-type#audit "Audit Configuration"
* extension[auditLevel].valueCode = #detailed
* extension[auditRetention].valueDuration = 90 'days'
* extension[auditFormat].valueCode = #fhir



// ===== Conteúdo de: MindfulnessSecurity.fsh =====

Instance: MindfulnessSecurityDefinition
InstanceOf: Consent
Usage: #definition
Title: "Mindfulness Data Security Policy"

* status = #active
* scope = http://terminology.hl7.org/CodeSystem/consentscope#patient-privacy
* category = http://loinc.org#59284-0 "Consent Document"

* policy[0]
  * authority = "http://example.org/privacy-policy"
  * uri = "http://example.org/mindfulness-privacy"

* provision
  * type = #permit
  * period
    * start = "2024-03-19"
  * actor[0]
    * role = http://terminology.hl7.org/CodeSystem/v3-ParticipationType#PRCP
    * reference
      * identifier.system = "http://example.org/practitioners"
      * identifier.value = "mindfulness-practitioners"

RuleSet: SecurityRequirements
* meta.security from http://terminology.hl7.org/ValueSet/v3-SecurityPolicy (required)
* meta.tag from http://terminology.hl7.org/ValueSet/v3-Confidentiality (required)

* extension contains
    http://hl7.org/fhir/StructureDefinition/resource-security-category named securityCategory 0..1 MS and
    http://hl7.org/fhir/StructureDefinition/patient-confidentiality named confidentiality 0..1 MS

Instance: MindfulnessAccessPolicy
InstanceOf: Consent
Usage: #definition
Title: "Mindfulness Data Access Policy"

* status = #active
* scope = http://terminology.hl7.org/CodeSystem/consentscope#patient-privacy
* category = http://loinc.org#59284-0 "Consent Document"

* policy[0]
  * authority = "http://example.org/access-policy"
  * uri = "http://example.org/mindfulness-access"

* provision
  * type = #permit
  * period
    * start = "2024-03-19"
  * actor[0]
    * role = http://terminology.hl7.org/CodeSystem/v3-ParticipationType#PRCP
    * reference
      * identifier.system = "http://example.org/practitioners"
      * identifier.value = "mindfulness-practitioners"
  * action = http://terminology.hl7.org/CodeSystem/consentaction#access "Access"



// ===== Conteúdo de: MindfulnessResources.fsh =====

CodeSystem: MindfulnessTypeCS
Id: mindfulness-type-cs
Title: "Mindfulness Practice Types"
Description: "Types of mindfulness practices and techniques"
* ^experimental = false
* ^caseSensitive = true
* #meditation "Meditation" "Focused meditation practice"
* #breathing "Breathing Exercise" "Conscious breathing techniques"
* #bodyScan "Body Scan" "Progressive body awareness practice"
* #walking "Mindful Walking" "Walking meditation practice"
* #movement "Mindful Movement" "Conscious movement practice"

CodeSystem: EnvironmentTypeCS
Id: environment-type-cs
Title: "Practice Environment Types"
Description: "Types of environments for mindfulness practice"
* ^experimental = false
* ^caseSensitive = true
* #indoor "Indoor" "Indoor environment"
* #outdoor "Outdoor" "Outdoor environment"
* #quiet "Quiet Space" "Quiet or silent environment"
* #group "Group Setting" "Group practice environment"

ValueSet: MindfulnessTypeVS
Id: mindfulness-type-vs
Title: "Mindfulness Practice Types Value Set"
Description: "Value set of mindfulness practice types"
* ^experimental = false
* include codes from system MindfulnessTypeCS

ValueSet: EnvironmentTypeVS
Id: environment-type-vs
Title: "Practice Environment Types Value Set"
Description: "Value set of practice environment types"
* ^experimental = false
* include codes from system EnvironmentTypeCS

Instance: MindfulnessSettingCS
InstanceOf: CodeSystem
Usage: #definition
* url = "http://example.org/CodeSystem/mindfulness-setting"
* version = "1.0.0"
* name = "MindfulnessSettingCS"
* title = "Mindfulness Setting CodeSystem"
* status = #active
* experimental = false
* caseSensitive = true
* content = #complete
* count = 5
* concept[+].code = #home
* concept[=].display = "Home Practice"
* concept[+].code = #clinic
* concept[=].display = "Clinical Setting"
* concept[+].code = #group
* concept[=].display = "Group Setting"
* concept[+].code = #retreat
* concept[=].display = "Retreat Setting"
* concept[+].code = #workplace
* concept[=].display = "Workplace Setting"



// ===== Conteúdo de: MindfulnessNarrative.fsh =====

RuleSet: MindfulnessObservationNarrative
* text.status = #generated
* text.div = "<div xmlns=\"http://www.w3.org/1999/xhtml\">
    <p><b>Generated Narrative</b></p>
    <p><b>Session Type:</b> Mindfulness Practice Session</p>
    <p><b>Date:</b> {effectiveDateTime}</p>
    <p><b>Duration:</b> {component[sessionDuration].value} minutes</p>
    <p><b>Stress Level:</b> {component[stressLevel].value} / 10</p>
    <p><b>Mood:</b> {component[moodState].value}</p>
    <p><b>Technique:</b> {component[relaxationResponse].value}</p>
    <p><b>Location:</b> {extension[mindfulness-context].extension[location].value}</p>
  </div>"

RuleSet: MindfulnessQuestionnaireNarrative
* text.status = #generated
* text.div = "<div xmlns=\"http://www.w3.org/1999/xhtml\">
    <p><b>Generated Narrative</b></p>
    <p><b>Title:</b> {title}</p>
    <p><b>Status:</b> {status}</p>
    <h3>Sections</h3>
    <ul>
      <li>Mindfulness Session</li>
      <li>Mood Assessment</li>
      <li>Stress Assessment</li>
      <li>Relaxation</li>
    </ul>
  </div>"

RuleSet: MindfulnessResponseNarrative
* text.status = #generated
* text.div = "<div xmlns=\"http://www.w3.org/1999/xhtml\">
    <p><b>Generated Narrative</b></p>
    <p><b>Date:</b> {authored}</p>
    <p><b>Session Duration:</b> {item[session_duration].answer.value} minutes</p>
    <p><b>Practice Type:</b> {item[practice_type].answer.value}</p>
    <p><b>Mood:</b> {item[current_mood].answer.value}</p>
    <p><b>Stress Level:</b> {item[stress_level].answer.value} / 10</p>
    <p><b>Relaxation Technique:</b> {item[relaxation_technique].answer.value}</p>
  </div>"

RuleSet: MindfulnessConfigNarrative
* text.status = #generated
* text.div = "<div xmlns=\"http://www.w3.org/1999/xhtml\">
    <p><b>Generated Narrative</b></p>
    <p><b>Default Duration:</b> {extension[defaultDuration].value} minutes</p>
    <p><b>Reminders:</b> {extension[reminderSettings].value}</p>
    <p><b>Data Sync:</b> {extension[dataSync].value}</p>
  </div>"



// ===== Conteúdo de: StressInvariants.fsh =====

Invariant: stress-level-range
Description: "Stress level score must be between 0 and 10"
Expression: "valueQuantity.exists() implies (valueQuantity.value >= 0 and valueQuantity.value <= 10)"
Severity: #error

Invariant: stress-component-consistency
Description: "Physiological and psychological stress scores must be consistent with overall score"
Expression: "component.where(code.coding.code='89593-8').value.exists() and component.where(code.coding.code='89594-6').value.exists() implies (component.where(code.coding.code='89593-8').value + component.where(code.coding.code='89594-6').value) div 2 = valueQuantity"
Severity: #warning



// ===== Conteúdo de: SocialInteractionInvariants.fsh =====

Invariant: social-interaction-duration
Description: "Social interaction duration must be positive"
Expression: "component.where(code.coding.code='89597-9').value.exists() implies component.where(code.coding.code='89597-9').value > 0"
Severity: #error

Invariant: social-interaction-participants
Description: "Number of participants must be at least 2 for social interaction"
Expression: "component.where(code.coding.code='89600-1').value.exists() implies component.where(code.coding.code='89600-1').value >= 2"
Severity: #error



// ===== Conteúdo de: MindfulnessInvariants.fsh =====

Invariant: mindfulness-session-duration
Description: "Mindfulness session duration must be between 1 and 180 minutes"
Expression: "component.where(code.coding.system='http://snomed.info/sct' and code.coding.code='118682006').value.ofType(Quantity).value.exists() implies (component.where(code.coding.system='http://snomed.info/sct' and code.coding.code='118682006').value.ofType(Quantity).value >= 1 and component.where(code.coding.system='http://snomed.info/sct' and code.coding.code='118682006').value.ofType(Quantity).value <= 180)"
Severity: #error

Invariant: mindfulness-stress-level
Description: "Stress level must be between 0 and 10"
Expression: "component.where(code.coding.system='http://snomed.info/sct' and code.coding.code='725854004').value.ofType(Integer).exists() implies (component.where(code.coding.system='http://snomed.info/sct' and code.coding.code='725854004').value.ofType(Integer) >= 0 and component.where(code.coding.system='http://snomed.info/sct' and code.coding.code='725854004').value.ofType(Integer) <= 10)"
Severity: #error

Invariant: mindfulness-mood-required
Description: "Mood assessment must include a mood state and intensity"
Expression: "component.where(code.coding.system='http://snomed.info/sct' and code.coding.code='373931001').exists() implies component.where(code.coding.system='http://snomed.info/sct' and code.coding.code='373931001').value.exists()"
Severity: #warning

Invariant: mindfulness-context-complete
Description: "Mindfulness context should include location and environment"
Expression: "extension.where(url='https://example.org/StructureDefinition/mindfulness-context').exists() implies (extension.where(url='https://example.org/StructureDefinition/mindfulness-context').extension.where(url='location').exists() and extension.where(url='https://example.org/StructureDefinition/mindfulness-context').extension.where(url='environment').exists())"
Severity: #warning

Invariant: sequential-measurements
Description: "Sequential measurements must have increasing effectiveDateTime"
Expression: "component.where(code.coding.system='http://snomed.info/sct' and code.coding.code='118682006').exists() implies (effectiveDateTime > previous().effectiveDateTime)"
Severity: #warning



// ===== Conteúdo de: MindfulnessOperations.fsh =====

Profile: MindfulnessOperation
Parent: OperationDefinition 
Id: mindfulness-operation
Title: "Mindfulness Operation"
Description: "Base definition for mindfulness operations"

* status 1..1
* kind 1..1
* name 1..1
* code 1..1
* resource 1..1
* system 1..1
* type 1..1
* instance 1..1
* parameter 0..*
* parameter.name 1..1

Instance: StartSessionOperation
InstanceOf: MindfulnessOperation
Title: "Start Session Operation"
Description: "Operation to start a new mindfulness session"

* status = #active
* kind = #operation
* name = "start-session"
* code = #start
* resource = #Observation
* system = false
* type = true
* instance = false
* parameter[+]
  * name = #duration
  * use = #in
  * min = 1
  * max = "1" 
  * type = #integer
  * documentation = "Duration in minutes"

Instance: EndSessionOperation
InstanceOf: MindfulnessOperation
Title: "End Session Operation"
Description: "Operation to end an ongoing mindfulness session"

* status = #active
* kind = #operation
* name = "end-session"
* code = #end
* resource = #Observation
* system = false
* type = true
* instance = true
* parameter[+]
  * name = #session
  * use = #in
  * min = 1
  * max = "1"
  * type = #string
  * documentation = "ID of the session to end"



// ===== Conteúdo de: VitalSignsExtensions.fsh =====

Extension: MeasurementContext
Id: measurement-context
Title: "Measurement Context Extension"
Description: "Additional context about the vital sign measurement"
* value[x] only CodeableConcept
* valueCodeableConcept from MeasurementContextVS (required)

ValueSet: MeasurementContextVitalSigns
Id: measurement-context-vital-signs
Title: "Measurement Context Value Set"
* $SCT#255214003 "At rest"
* $SCT#309604004 "During exercise"
* $SCT#309605003 "Post exercise"
* $SCT#248626006 "During sleep"



// ===== Conteúdo de: NutritionExtensions.fsh =====

Extension: NutritionDataSource
Id: nutrition-data-source
Title: "Nutrition Data Source Extension"
Description: "Indicates the source of nutrition data"

* ^version = "0.1.0"
* ^status = #draft
* ^experimental = false
* ^date = "2024-12-14"
* ^publisher = "Ricardo Lourenço dos Santos"
* ^context[0].type = #element
* ^context[0].expression = "Observation"

* value[x] only CodeableConcept
* valueCodeableConcept from NutritionDataSourceVS (required)

ValueSet: NutritionDataSourceVS
Id: nutrition-data-source-vs
Title: "Nutrition Data Source Value Set"
Description: "Value set for nutrition data sources"

* ^version = "0.1.0"
* ^status = #draft
* ^experimental = false
* ^date = "2024-12-14"
* ^publisher = "Ricardo Lourenço dos Santos"

* codes from system NutritionDataSourceCS

CodeSystem: NutritionDataSourceCS
Id: nutrition-data-source-cs
Title: "Nutrition Data Source Code System"
Description: "Code system for nutrition data sources"

* ^version = "0.1.0"
* ^status = #draft
* ^experimental = false
* ^date = "2024-12-14"
* ^publisher = "Ricardo Lourenço dos Santos"
* ^caseSensitive = true

* #manual "Manual Entry" "Data entered manually by user"
* #app "App Integration" "Data from integrated third-party apps"
* #device "Connected Device" "Data from connected nutrition tracking devices"
* #questionnaire "Questionnaire Response" "Data collected through questionnaires"



// ===== Conteúdo de: AdvancedVitalSignsExtensions.fsh =====

Alias: $UCUM = http://unitsofmeasure.org

Extension: PhysiologicalStressIndex
Id: physiological-stress-index
Title: "Physiological Stress Index Extension"
Description: "Index representing overall physiological stress based on multiple parameters"

* ^version = "0.1.0"
* ^status = #draft
* ^context[+].type = #element
* ^context[=].expression = "Observation"

* value[x] only Quantity
* valueQuantity.system = $UCUM
* valueQuantity.code = #{index}
* valueQuantity ^short = "Physiological stress index value"
* valueQuantity ^definition = "Normalized index value representing overall physiological stress"

Extension: HomeostasisIndex
Id: homeostasis-index
Title: "Homeostasis Index Extension"
Description: "Composite measure of physiological balance and adaptation"

* ^version = "0.1.0"
* ^status = #draft
* ^context[+].type = #element
* ^context[=].expression = "Observation"

* value[x] only Quantity
* valueQuantity.system = $UCUM
* valueQuantity.code = #{ratio}
* valueQuantity ^short = "Homeostasis index value"
* valueQuantity ^definition = "Normalized ratio representing physiological balance"

Extension: RecoveryEfficiency
Id: recovery-efficiency
Title: "Recovery Efficiency Extension"
Description: "Measure of how efficiently the body recovers from stress or exertion"

* ^version = "0.1.0"
* ^status = #draft
* ^context[+].type = #element
* ^context[=].expression = "Observation"

* value[x] only Quantity
* valueQuantity.system = $UCUM
* valueQuantity.code = #%
* valueQuantity ^short = "Recovery efficiency percentage"
* valueQuantity ^definition = "Percentage indicating recovery efficiency"

Extension: AllostaticLoad
Id: allostatic-load
Title: "Allostatic Load Extension"
Description: "Measure of cumulative physiological burden over time"

* ^version = "0.1.0"
* ^status = #draft
* ^context[+].type = #element
* ^context[=].expression = "Observation"

* value[x] only Quantity
* valueQuantity.system = $UCUM
* valueQuantity.code = #{score}
* valueQuantity ^short = "Allostatic load score"
* valueQuantity ^definition = "Score representing cumulative physiological burden"

Extension: CircadianPhase
Id: circadian-phase
Title: "Circadian Phase Extension"
Description: "Indicator of position in circadian rhythm cycle"

* ^version = "0.1.0"
* ^status = #draft
* ^context[+].type = #element
* ^context[=].expression = "Observation"

* value[x] only CodeableConcept
* valueCodeableConcept from CircadianPhaseVS (required)

ValueSet: CircadianPhaseVS
Id: circadian-phase-vs
Title: "Circadian Phase Value Set"
Description: "Value set for circadian rhythm phases"

* ^experimental = true
* codes from system CircadianPhaseCS

CodeSystem: CircadianPhaseCS
Id: circadian-phase-cs
Title: "Circadian Phase Code System"
Description: "Code system for circadian rhythm phases"

* ^experimental = true
* ^caseSensitive = true

* #early-morning "Early Morning Phase" "Period shortly after awakening"
* #mid-morning "Mid Morning Phase" "Mid-morning period"
* #afternoon "Afternoon Phase" "Afternoon period"
* #evening "Evening Phase" "Evening period"
* #night "Night Phase" "Nighttime period"
* #deep-night "Deep Night Phase" "Deep night period"

Extension: MeasurementQuality
Id: measurement-quality
Title: "Measurement Quality Extension"
Description: "Indicator of the quality and reliability of the measurement"

* ^version = "0.1.0"
* ^status = #draft
* ^context[+].type = #element
* ^context[=].expression = "Observation"

* value[x] only CodeableConcept
* valueCodeableConcept from MeasurementQualityVS (required)

ValueSet: MeasurementQualityVS
Id: measurement-quality-vs
Title: "Measurement Quality Value Set"
Description: "Value set for measurement quality indicators"

* ^experimental = true
* codes from system MeasurementQualityCS

CodeSystem: MeasurementQualityCS
Id: measurement-quality-cs
Title: "Measurement Quality Code System"
Description: "Code system for measurement quality indicators"

* ^experimental = true
* ^caseSensitive = true

* #excellent "Excellent Quality" "High quality measurement with minimal noise"
* #good "Good Quality" "Good quality measurement with acceptable noise"
* #fair "Fair Quality" "Fair quality measurement with some interference"
* #poor "Poor Quality" "Poor quality measurement with significant interference"
* #unreliable "Unreliable" "Unreliable measurement requiring verification"



// ===== Conteúdo de: StressExtensions.fsh =====

Extension: StressTriggers
Id: stress-triggers
Title: "Stress Triggers Extension"
Description: "Extension for recording identified stress triggers"
* value[x] only CodeableConcept
* valueCodeableConcept from StressTriggersVS (required)

Extension: StressCoping
Id: stress-coping
Title: "Stress Coping Extension"
Description: "Extension for recording stress coping mechanisms"
* value[x] only CodeableConcept
* valueCodeableConcept from StressCopingVS (required)

ValueSet: StressTriggersVS
Id: stress-triggers-vs
Title: "Stress Triggers Value Set"
Description: "Value set for common stress triggers"
* codes from system StressTriggersCS

ValueSet: StressCopingVS
Id: stress-coping-vs
Title: "Stress Coping Value Set"
Description: "Value set for stress coping mechanisms"
* codes from system StressCopingCS

CodeSystem: StressTriggersCS
Id: stress-triggers-cs
Title: "Stress Triggers Code System"
Description: "Code system for common stress triggers"
* #work "Work-related" "Stress from work or professional activities"
* #financial "Financial" "Financial-related stress"
* #relationships "Relationships" "Stress from personal relationships"
* #health "Health" "Health-related concerns"
* #environment "Environmental" "Environmental factors"
* #time "Time Management" "Time pressure and deadlines"
* #change "Life Changes" "Major life changes or transitions"

CodeSystem: StressCopingCS
Id: stress-coping-cs
Title: "Stress Coping Code System"
Description: "Code system for stress coping mechanisms"
* #exercise "Physical Exercise" "Using exercise to manage stress"
* #meditation "Meditation" "Meditation and mindfulness practices"
* #social "Social Support" "Seeking social support"
* #professional "Professional Help" "Seeking professional assistance"
* #relaxation "Relaxation" "Relaxation techniques"
* #creative "Creative Activities" "Engaging in creative activities"
* #nature "Nature" "Spending time in nature"



// ===== Conteúdo de: EnvironmentalExtensions.fsh =====

Extension: ExposureLocation
Id: exposure-location
Title: "Exposure Location Extension"
Description: "Extension for recording location of environmental exposure measurement"

* ^version = "0.1.0"
* ^status = #draft
* ^context[+].type = #element
* ^context[=].expression = "Observation"

* value[x] only CodeableConcept
* valueCodeableConcept from ExposureLocationVS (required)
* valueCodeableConcept ^short = "Location type of exposure"
* valueCodeableConcept ^definition = "Categorizes the type of location where environmental exposure occurred"

Extension: ExposureConditions
Id: exposure-conditions
Title: "Exposure Conditions Extension"
Description: "Additional conditions during environmental exposure measurement"

* ^version = "0.1.0"
* ^status = #draft
* ^context[+].type = #element
* ^context[=].expression = "Observation"

* value[x] only CodeableConcept
* valueCodeableConcept from ExposureConditionsVS (required)
* valueCodeableConcept ^short = "Conditions during exposure"

ValueSet: ExposureLocationVS
Id: exposure-location-vs
Title: "Exposure Location Value Set"
Description: "Value set for environmental exposure locations"

* ^version = "0.1.0"
* ^status = #draft
* ^experimental = true
* codes from system ExposureLocationCS

ValueSet: ExposureConditionsVS
Id: exposure-conditions-vs
Title: "Exposure Conditions Value Set"
Description: "Value set for environmental exposure conditions"

* ^version = "0.1.0"
* ^status = #draft
* ^experimental = true
* codes from system ExposureConditionsCS

CodeSystem: ExposureLocationCS
Id: exposure-location-cs
Title: "Exposure Location Code System"
Description: "Code system for environmental exposure locations"

* ^version = "0.1.0"
* ^status = #draft
* ^caseSensitive = true
* ^experimental = true

* #indoor "Indoor environment" "Environment within buildings or enclosed spaces"
* #outdoor "Outdoor environment" "Open-air environment"
* #workplace "Workplace" "Professional or occupational environment"
* #transit "In transit" "While in transportation or commuting"
* #recreational "Recreational area" "Leisure or sports facilities"
* #urban "Urban area" "City or densely populated area"
* #rural "Rural area" "Countryside or sparsely populated area"

CodeSystem: ExposureConditionsCS
Id: exposure-conditions-cs
Title: "Exposure Conditions Code System"
Description: "Code system for conditions during environmental exposure"

* ^version = "0.1.0"
* ^status = #draft
* ^caseSensitive = true
* ^experimental = true

* #normal "Normal conditions" "Standard environmental conditions"
* #extreme "Extreme conditions" "Unusual or severe environmental conditions"
* #controlled "Controlled environment" "Environment with controlled conditions"
* #variable "Variable conditions" "Changing environmental conditions"



// ===== Conteúdo de: BodyMetricsExtensions.fsh =====

Alias: $SCT = http://snomed.info/sct

Extension: MeasurementConditions
Id: measurement-conditions
Title: "Measurement Conditions Extension"
Description: "Records the conditions under which body measurements were taken"

* ^version = "0.1.0"
* ^status = #draft
* ^context[0].type = #element
* ^context[0].expression = "Observation"

* value[x] only CodeableConcept
* valueCodeableConcept from MeasurementConditionsVS (required)

Extension: MeasurementDevice
Id: measurement-device-type
Title: "Measurement Device Type Extension"
Description: "Specifies the type of device used for body measurements"

* ^version = "0.1.0"
* ^status = #draft
* ^context[0].type = #element
* ^context[0].expression = "Observation"

* value[x] only CodeableConcept
* valueCodeableConcept from MeasurementDeviceTypeVS (required)

ValueSet: MeasurementConditionsVS
Id: measurement-conditions-vs
Title: "Measurement Conditions Value Set"
Description: "Standard conditions under which measurements are taken"

* ^version = "0.1.0"
* ^status = #draft

* $SCT#307818003 "Pre-breakfast"
* $SCT#307819006 "Post-exercise"
* $SCT#307820000 "Wearing light clothing"
* $SCT#255203001 "First thing in morning"
* $SCT#255214005 "After void"
* $SCT#309604004 "During rest"

ValueSet: MeasurementDeviceTypeVS
Id: measurement-device-type-vs
Title: "Measurement Device Type Value Set"
Description: "Types of devices used for health and body measurements"

* ^version = "0.1.0"
* ^status = #draft

* $SCT#469576000 "Smart watch"
* $SCT#706767009 "Body composition analyzer"
* $SCT#131009002 "Height measuring device"
* $SCT#706889009 "Blood pressure monitor"
* $SCT#444699000 "Tape measure"
* $SCT#44056008  "Digital scale"

Instance: WeightWithConditions
InstanceOf: WeightObservation
Usage: #example
Title: "Weight Measurement with Conditions Example"

* status = #final
* category = http://terminology.hl7.org/CodeSystem/observation-category#vital-signs
* code = $LOINC#29463-7 "Body weight"
* subject = Reference(Patient/example)
* effectiveDateTime = "2024-03-19T08:00:00Z"
* valueQuantity = 70.5 'kg'

* extension[measurement-conditions].url = "https://github.com/RicardoLSantos/shorthand/StructureDefinition/measurement-conditions"
* extension[measurement-conditions].valueCodeableConcept = $SCT#307818003 "Pre-breakfast"

* extension[measurement-device-type].url = "https://github.com/RicardoLSantos/shorthand/StructureDefinition/measurement-device-type"
* extension[measurement-device-type].valueCodeableConcept = $SCT#469576000 "Smart scale device"



// ===== Conteúdo de: SleepQuality.fsh =====

Extension: SleepQuality
Id: sleep-quality
Title: "Sleep Quality Extension"
Description: "Extension for recording subjective sleep quality"
* value[x] only CodeableConcept
* valueCodeableConcept from SleepQualityExtendedVS (required)
 
ValueSet: SleepQualityExtendedVS
Id: sleep-quality-extended-vs
Title: "Sleep Quality Value Set"
* $SCT#248220008 "Very good quality sleep"
* $SCT#248221007 "Good quality sleep"
* $SCT#248222000 "Poor quality sleep"
* $SCT#248223005 "Very poor quality sleep"



// ===== Conteúdo de: MindfulnessExtensions.fsh =====

Extension: MindfulnessContext
Id: mindfulness-context
Title: "Mindfulness Session Context"
Description: "Additional context about the mindfulness practice session"

* ^url = "https://example.org/StructureDefinition/mindfulness-context"
* ^version = "1.0.0"
* ^status = #draft
* ^date = "2024-03-19"
* ^publisher = "Example Organization"

* extension contains
    location 0..1 and
    environment 0..1 and
    guidance 0..1

* extension[location].value[x] only string
* extension[location].valueString 1..1
* extension[location] ^short = "Physical location of practice"
* extension[location] ^definition = "The physical location where the mindfulness practice took place"

* extension[environment].value[x] only CodeableConcept
* extension[environment].valueCodeableConcept from http://example.org/ValueSet/environment-type (required)
* extension[environment] ^short = "Environmental conditions"
* extension[environment] ^definition = "The environmental conditions during the practice session"

* extension[guidance].value[x] only boolean
* extension[guidance].valueBoolean 1..1
* extension[guidance] ^short = "Whether guidance was used"
* extension[guidance] ^definition = "Indicates if the session was guided or self-directed"



// ===== Conteúdo de: SocialInteractionExtensions.fsh =====

Extension: SocialContext
Id: social-context
Title: "Social Context Extension"
Description: "Extension for recording the context of social interaction"
* value[x] only CodeableConcept
* valueCodeableConcept from SocialContextVS (required)

Extension: SocialSupport
Id: social-support
Title: "Social Support Extension"
Description: "Extension for recording perceived social support"
* value[x] only CodeableConcept
* valueCodeableConcept from SocialSupportVS (required)

Extension: SocialActivity
Id: social-activity
Title: "Social Activity Extension"
Description: "Extension for recording specific social activities"
* value[x] only CodeableConcept
* valueCodeableConcept from SocialActivityVS (required)

ValueSet: SocialContextVS
Id: social-context-vs
Title: "Social Context Value Set"
Description: "Value set for social interaction contexts"
* codes from system SocialContextCS

ValueSet: SocialSupportVS
Id: social-support-vs
Title: "Social Support Value Set"
Description: "Value set for levels of social support"
* codes from system SocialSupportCS

ValueSet: SocialActivityVS
Id: social-activity-vs
Title: "Social Activity Value Set"
Description: "Value set for types of social activities"
* codes from system SocialActivityCS

CodeSystem: SocialContextCS
Id: social-context-cs
Title: "Social Context Code System"
Description: "Code system for social interaction contexts"
* #home "Home" "Home environment"
* #work "Work" "Work environment"
* #education "Educational" "Educational setting"
* #community "Community" "Community setting"
* #recreational "Recreational" "Recreational setting"
* #healthcare "Healthcare" "Healthcare setting"

CodeSystem: SocialSupportCS
Id: social-support-cs
Title: "Social Support Code System"
Description: "Code system for levels of social support"
* #strong "Strong Support" "Strong social support network"
* #adequate "Adequate Support" "Sufficient social support"
* #limited "Limited Support" "Limited social support"
* #minimal "Minimal Support" "Minimal social support"
* #none "No Support" "Absence of social support"

CodeSystem: SocialActivityCS
Id: social-activity-cs
Title: "Social Activity Code System"
Description: "Code system for types of social activities"
* #meal "Shared Meal" "Sharing a meal together"
* #exercise "Group Exercise" "Group physical activity"
* #entertainment "Entertainment" "Shared entertainment activity"
* #learning "Learning" "Group learning activity"
* #volunteering "Volunteering" "Community service activity"
* #celebration "Celebration" "Social celebration or event"



// ===== Conteúdo de: SleepExtensions.fsh =====




// ===== Conteúdo de: MobilityExtensions.fsh =====

Extension: MobilityAlertLevel
Id: mobility-alert-level
Title: "Mobility Alert Level Extension"
Description: "Extension for mobility measurements alert levels to indicate the severity or concern level of mobility changes detected by the device"
* ^status = #active
* ^context[0].type = #element
* ^context[0].expression = "Observation"
* . ^short = "Mobility alert level indicator"
* . ^definition = "Indicates the severity level of mobility changes or concerns based on device measurements"
* value[x] only CodeableConcept
* valueCodeableConcept from MobilityAlertLevelVS (required)
* valueCodeableConcept ^short = "Alert level code"
* valueCodeableConcept ^definition = "The specific alert level code indicating the severity of mobility changes"

ValueSet: MobilityAlertLevelVS
Id: mobility-alert-level-vs
Title: "Mobility Alert Level Value Set"
Description: "Value set for mobility measurement alert levels used to categorize the severity of mobility changes or concerns"
* ^status = #active
* ^experimental = false
* ^purpose = "To provide standardized alert levels for mobility measurements"
* codes from system MobilityAlertLevelCS

CodeSystem: MobilityAlertLevelCS
Id: mobility-alert-level-cs
Title: "Mobility Alert Level Code System"
Description: "Code system defining alert levels for mobility measurements, indicating the severity of changes in mobility patterns"
* ^status = #active
* ^experimental = false
* ^caseSensitive = true
* ^content = #complete
* #green "Normal - No concern" "Mobility measurements are within normal range and show no concerning patterns"
* #yellow "Caution - Monitor closely" "Mobility measurements show slight deviations that warrant closer monitoring"
* #red "Alert - Significant change" "Mobility measurements indicate significant changes that require immediate attention"
* ^property[0].code = #status
* ^property[0].type = #code
* ^property[0].description = "The status of the alert level"
* ^property[1].code = #severity
* ^property[1].type = #integer
* ^property[1].description = "Numeric value indicating severity (1=low, 3=high)"



// ===== Conteúdo de: ActivityExtensions.fsh =====




// ===== Conteúdo de: MobilityRiskValueSets.fsh =====

ValueSet: FallRiskOutcomesValueSet
Id: fall-risk-outcomes
Title: "Fall Risk Outcomes Value Set"
Description: "Value set for fall risk assessment outcomes"
* ^url = "http://example.org/fhir/ValueSet/fall-risk-outcomes"
* ^status = #active
* include codes from system http://example.org/fhir/CodeSystem/fall-risk-outcomes

ValueSet: RiskLevelValueSet
Id: risk-level
Title: "Risk Level Value Set"
Description: "Value set for general risk levels"
* ^url = "http://example.org/fhir/ValueSet/risk-level"
* ^status = #active
* include codes from system http://example.org/fhir/CodeSystem/risk-level

ValueSet: MobilityDeclineOutcomesValueSet
Id: mobility-decline-outcomes
Title: "Mobility Decline Outcomes Value Set"
Description: "Value set for mobility decline assessment outcomes"
* ^url = "http://example.org/fhir/ValueSet/mobility-decline-outcomes"
* ^status = #active
* include codes from system http://example.org/fhir/CodeSystem/mobility-decline-outcomes

ValueSet: AssistanceLevelOutcomesValueSet
Id: assistance-level-outcomes
Title: "Assistance Level Outcomes Value Set"
Description: "Value set for assistance level assessment outcomes"
* ^url = "http://example.org/fhir/ValueSet/assistance-level-outcomes"
* ^status = #active
* include codes from system http://example.org/fhir/CodeSystem/assistance-level-outcomes



// ===== Conteúdo de: SymptomValueSets.fsh =====

CodeSystem: SymptomSeverityCS
Id: symptom-severity-cs
Title: "Symptom Severity Code System"
Description: "Severity levels for symptoms"

* #1-3 "Light" "Symptom barely noticeable"
* #4-6 "Mild" "Symptom noticeable but not interfering with daily activities"
* #7-8 "Intense" "Symptom interfering with daily activities"
* #9-10 "Severe" "Symptom preventing daily activities"

ValueSet: BodyLocationsVS
Id: body-locations-vs
Title: "Body Locations Value Set"
Description: "Anatomical locations for symptom recording"
* $SCT#12738006 "Brain"
* $SCT#69536005 "Head"
* $SCT#45048000 "Neck"
* $SCT#51185008 "Chest"
* $SCT#62413002 "Abdomen"
* $SCT#32849002 "Back"
* $SCT#53120007 "Upper limb"
* $SCT#61685007 "Lower limb"

ValueSet: DurationUnitsVS
Id: duration-units-vs
Title: "Duration Units Value Set"
Description: "Time units for symptom duration"
* $UCUM#min "Minutes"
* $UCUM#h "Hours"
* $UCUM#d "Days"
* $UCUM#wk "Weeks"
* $UCUM#mo "Months"

CodeSystem: SymptomFrequencyCS
Id: symptom-frequency-cs
Title: "Symptom Frequency Code System"
Description: "Frequency patterns for symptoms"
* #rare "Rare" "Less than once per month"
* #occasional "Occasional" "Several times per month"
* #frequent "Frequent" "Several times per week"
* #daily "Daily" "Once or more per day"
* #constant "Constant" "Present most of the time"

ValueSet: SymptomFrequencyVS
Id: symptom-frequency-vs
Title: "Symptom Frequency Value Set"
Description: "Frequency patterns for symptoms"
* codes from system SymptomFrequencyCS

CodeSystem: SymptomImpactCS
Id: symptom-impact-cs
Title: "Symptom Impact Code System"
Description: "Impact levels of symptoms on daily activities"
* #none "No impact"
* #mild "Mild impact"
* #moderate "Moderate impact"
* #severe "Severe impact"
* #complete "Complete impact"

ValueSet: SymptomImpactVS
Id: symptom-impact-vs
Title: "Symptom Impact Value Set"
Description: "Impact levels for symptoms"
* codes from system SymptomImpactCS

ValueSet: SymptomProgressionVS
Id: symptom-progression-vs
Title: "Symptom Progression Value Set"
Description: "Progression patterns for symptoms"
* $SCT#385633008 "Improving"
* $SCT#58158008 "Stable"
* $SCT#230993007 "Worsening"
* $SCT#255314001 "Fluctuating"

ValueSet: TimeOfDayVS
Id: time-of-day-vs
Title: "Time of Day Value Set"
Description: "Times of day for symptom occurrence"
* $SCT#73775008 "Morning"
* $SCT#255253008 "Afternoon"
* $SCT#2546009 "Evening"
* $SCT#73768005 "Night"



// ===== Conteúdo de: StressValueSets.fsh =====

ValueSet: StressChronicityVS
Id: stress-chronicity-vs
Title: "Stress Chronicity Value Set"
Description: "Value set for classifying stress chronicity"
* ^url = "https://github.com/RicardoLSantos/shorthand/ValueSet/stress-chronicity-vs"
* codes from system StressChronicityCS

ValueSet: StressImpactVS
Id: stress-impact-vs
Title: "Stress Impact Value Set"
Description: "Value set for describing stress impact levels"
* ^url = "https://github.com/RicardoLSantos/shorthand/ValueSet/stress-impact-vs"
* codes from system StressImpactCS

CodeSystem: StressChronicityCS
Id: stress-chronicity-cs
Title: "Stress Chronicity Code System"
Description: "Code system for stress chronicity classification"
* ^url = "https://github.com/RicardoLSantos/shorthand/CodeSystem/stress-chronicity-cs"
* #acute "Acute" "Short-term stress response"
* #subacute "Subacute" "Medium-term stress response"
* #chronic "Chronic" "Long-term stress response"
* #episodic "Episodic" "Recurring stress episodes"
* #persistent "Persistent" "Continuous stress state"

CodeSystem: StressImpactCS
Id: stress-impact-cs
Title: "Stress Impact Code System"
Description: "Code system for stress impact levels"
* ^url = "https://github.com/RicardoLSantos/shorthand/CodeSystem/stress-impact-cs"
* #minimal "Minimal Impact" "Little to no interference with daily activities"
* #mild "Mild Impact" "Some interference with daily activities"
* #moderate "Moderate Impact" "Significant interference with daily activities"
* #severe "Severe Impact" "Major interference with daily activities"
* #extreme "Extreme Impact" "Unable to perform daily activities"



// ===== Conteúdo de: ReproductiveValueSets.fsh =====

ValueSet: ReproductiveGoalVS
Id: reproductive-goal-vs
Title: "Reproductive Health Goals Value Set"
Description: "Goals related to reproductive health tracking and planning"

* ^status = #active
* ^experimental = false
* ^date = "2024-03-19"

* $LOINC#8708-0 "Menstrual cycle length"
* $LOINC#55284-4 "Blood pressure"
* $LOINC#8310-5 "Body temperature"
* $LOINC#8302-2 "Body height"
* $LOINC#29463-7 "Body weight"
* $SCT#364311006 "Menstrual cycle monitoring"
* $SCT#289530006 "Reproductive health finding"

ValueSet: ReproductiveActivityVS
Id: reproductive-activity-vs
Title: "Reproductive Health Activities Value Set"
Description: "Activities related to reproductive health monitoring"

* ^status = #active
* ^experimental = false
* ^date = "2024-03-19"

* codes from system ReproductiveActivityCS

CodeSystem: ReproductiveActivityCS
Id: reproductive-activity-cs
Title: "Reproductive Health Activities Code System"
Description: "Code system for reproductive health monitoring activities"

* ^status = #active
* ^experimental = false
* ^caseSensitive = true

* #cycle-tracking "Cycle Tracking" "Track menstrual cycle dates and characteristics"
* #temp-monitoring "Temperature Monitoring" "Monitor basal body temperature"
* #symptom-tracking "Symptom Tracking" "Track reproductive health symptoms"
* #vitals-monitoring "Vitals Monitoring" "Monitor vital signs related to reproductive health"
* #fertility-signs "Fertility Signs" "Monitor fertility signs and indicators"
* #mood-tracking "Mood Tracking" "Track mood changes related to reproductive cycle"
* #medication-log "Medication Log" "Log reproductive health medications"
* #exercise-tracking "Exercise Tracking" "Track physical activity during cycle"



// ===== Conteúdo de: AuditFormatsValueSet.fsh =====

ValueSet: AuditFormatsValueSet
Id: audit-formats
Title: "Audit Formats Value Set"
Description: "Value set for audit format types"
* ^url = "http://example.org/fhir/ValueSet/audit-formats"
* ^status = #active
* ^experimental = false
* ^date = "2024-12-27"
* include codes from system http://example.org/fhir/CodeSystem/audit-formats

CodeSystem: AuditFormatsCodeSystem
Id: audit-formats
Title: "Audit Formats Code System"
Description: "Code system for audit format types"
* ^url = "http://example.org/fhir/CodeSystem/audit-formats"
* ^status = #active
* ^experimental = false
* ^caseSensitive = true
* #text "Text Format"
* #structured "Structured Format"
* #mixed "Mixed Format"



// ===== Conteúdo de: MeasurementContextVS.fsh =====

ValueSet: MeasurementContextVS
Id: measurement-context-vs
Title: "Measurement Context Value Set"
Description: "Contexts in which measurements can be taken, including temporal and location-based contexts"
* ^status = #active
* ^experimental = false
* $SCT#272125009 "Assessment context value (qualifier value)"
* $SCT#307818003 "Before food"
* $SCT#307819006 "After food"
* $SCT#255214003 "After exercise"
* $SCT#264362003 "Time of day"



// ===== Conteúdo de: AuditLevelsValueSet.fsh =====

ValueSet: AuditLevelsValueSet
Id: audit-levels
Title: "Audit Levels Value Set"
Description: "Value set for audit level types"
* ^url = "http://example.org/fhir/ValueSet/audit-levels"
* ^status = #active
* ^experimental = false
* ^date = "2024-12-27"
* include codes from system http://example.org/fhir/CodeSystem/audit-levels

CodeSystem: AuditLevelsCodeSystem
Id: audit-levels
Title: "Audit Levels Code System"
Description: "Code system for audit level types"
* ^url = "http://example.org/fhir/CodeSystem/audit-levels"
* ^status = #active
* ^experimental = false
* ^caseSensitive = true
* #low "Low Level"
* #medium "Medium Level"
* #high "High Level"



// ===== Conteúdo de: SocialInteractionValueSets.fsh =====

ValueSet: SocialInteractionTypeVS
Id: social-interaction-type-vs
Title: "Social Interaction Type Value Set"
Description: "Types of social interactions"
* codes from system SocialInteractionTypeCS

ValueSet: SocialInteractionQualityVS
Id: social-interaction-quality-vs
Title: "Social Interaction Quality Value Set"
Description: "Quality measures for social interactions"
* codes from system SocialInteractionQualityCS

ValueSet: SocialInteractionMediumVS
Id: social-interaction-medium-vs
Title: "Social Interaction Medium Value Set"
Description: "Mediums through which social interaction occurs"
* codes from system SocialInteractionMediumCS

CodeSystem: SocialInteractionTypeCS
Id: social-interaction-type-cs
Title: "Social Interaction Type Code System"
Description: "Types of social interactions"
* #family "Family Interaction" "Interaction with family members"
* #friends "Friend Interaction" "Interaction with friends"
* #professional "Professional Interaction" "Work-related interactions"
* #community "Community Interaction" "Community-based interactions"
* #group "Group Activity" "Organized group activities"
* #casual "Casual Interaction" "Casual social encounters"

CodeSystem: SocialInteractionQualityCS
Id: social-interaction-quality-cs
Title: "Social Interaction Quality Code System"
Description: "Quality measures for social interactions"
* #meaningful "Meaningful" "Deep, meaningful interaction"
* #supportive "Supportive" "Supportive interaction"
* #neutral "Neutral" "Neither positive nor negative"
* #superficial "Superficial" "Surface-level interaction"
* #stressful "Stressful" "Stressful or difficult interaction"

CodeSystem: SocialInteractionMediumCS
Id: social-interaction-medium-cs
Title: "Social Interaction Medium Code System"
Description: "Mediums through which social interaction occurs"
* #inPerson "In Person" "Face-to-face interaction"
* #video "Video Call" "Video-based interaction"
* #voice "Voice Call" "Voice-only interaction"
* #text "Text Based" "Text-based communication"
* #social "Social Media" "Social media interaction"
* #mixed "Mixed Medium" "Multiple communication methods"



// ===== Conteúdo de: MoodValueSet.fsh =====

ValueSet: MoodValueSet
Id: mood
Title: "Mood Value Set"
Description: "Value set for mood states"
* ^url = "http://example.org/fhir/ValueSet/mood"
* ^status = #active
* ^experimental = false

CodeSystem: MoodCodeSystem
Id: mood
Title: "Mood Code System"
Description: "Code system for mood states"
* ^url = "http://example.org/fhir/CodeSystem/mood"
* ^status = #active
* ^caseSensitive = true
* #elevated "Elevated" "Mood is higher than normal"
* #neutral "Neutral" "Neither elevated nor depressed mood"
* #depressed "Depressed" "Mood is lower than normal"
* #anxious "Anxious" "Feeling worried or nervous"
* #irritable "Irritable" "Easily annoyed or angered"
* #calm "Calm" "Feeling peaceful and relaxed"



// ===== Conteúdo de: EnvironmentalContextVS.fsh =====

ValueSet: EnvironmentalContextValueSet
Id: environmental-context
Title: "Environmental Context Value Set"
Description: "Valid contexts for environmental measurements"

* ^status = #active
* ^experimental = false
* ^url = "http://example.org/fhir/ValueSet/environmental-context"
* include codes from system http://example.org/fhir/CodeSystem/environmental-context



// ===== Conteúdo de: ActivityTypeVS.fsh =====

ValueSet: PhysicalActivityTypeVS
Id: physical-activity-type-vs
Title: "Physical Activity Types Value Set"
Description: "Types of physical activities from iOS Health App"

* ^status = #active

* $SNOMED#255604002 "Physical activity (observable entity)"
* $SNOMED#228557008 "Walking"
* $SNOMED#229058003 "Running"
* $SNOMED#266938001 "Swimming"
* $SNOMED#266940006 "Cycling"
* $SNOMED#32147004 "Regular exercise"



// ===== Conteúdo de: MindfulnessValueSets.fsh =====

ValueSet: EnvironmentTypeValueSet
Id: environment-type
Title: "Environment Type Value Set"
Description: "Value set for environmental context types"
* ^url = "http://example.org/fhir/ValueSet/environment-type"
* ^status = #active
* include codes from system http://example.org/fhir/CodeSystem/environment-type

ValueSet: MindfulnessTypeValueSet
Id: mindfulness-type
Title: "Mindfulness Type Value Set"
Description: "Value set for types of mindfulness practices"
* ^url = "http://example.org/fhir/ValueSet/mindfulness-type"
* ^status = #active
* include codes from system http://example.org/fhir/CodeSystem/mindfulness-type



// ===== Conteúdo de: BalanceStatusValueSet.fsh =====

ValueSet: BalanceStatusValueSet
Id: balance-status
Title: "Balance Status Value Set"
Description: "Value set for walking steadiness balance status"
* ^url = "http://example.org/fhir/ValueSet/balance-status"
* ^status = #active
* include codes from system http://example.org/fhir/CodeSystem/balance-status

CodeSystem: BalanceStatusCodeSystem
Id: balance-status
Title: "Balance Status Code System"
Description: "Code system for balance status types"
* ^url = "http://example.org/fhir/CodeSystem/balance-status"
* ^status = #active
* ^experimental = false
* ^caseSensitive = true
* #veryStable "Very Stable"
* #stable "Stable"
* #slightlyUnstable "Slightly Unstable"
* #unstable "Unstable"
* #veryUnstable "Very Unstable"



// ===== Conteúdo de: SleepQualityVS.fsh =====

ValueSet: SleepQualityVS
Id: sleep-quality-vs
Title: "Sleep Quality Value Set"
Description: "Qualitative assessments of sleep quality including subjective measures"
* ^status = #active
* ^experimental = false
* $SCT#248254009 "Quality of sleep (observable entity)"
* $SCT#248255005 "Sleeping well"
* $SCT#248256006 "Difficulty sleeping"
* $SCT#301345002 "Poor sleep pattern"
* $SCT#301346001 "Good sleep pattern"




// ===== Conteúdo de: FertilityValueSets.fsh =====

ValueSet: CervicalMucusValueSet
Id: cervical-mucus-valueset
Title: "Cervical Mucus Value Set"
Description: "Value set for cervical mucus observations"
* ^url = "http://example.org/fhir/ValueSet/cervical-mucus-vs"
* ^status = #active
* include codes from system http://example.org/fhir/CodeSystem/cervical-mucus-cs

CodeSystem: CervicalMucusCodeSystem
Id: cervical-mucus-cs
Title: "Cervical Mucus Code System"
* ^url = "http://example.org/fhir/CodeSystem/cervical-mucus-cs"
* ^status = #active
* ^caseSensitive = true
* #dry "Dry"
* #sticky "Sticky"
* #creamy "Creamy"
* #watery "Watery"
* #eggWhite "Egg White"

ValueSet: OvulationTestValueSet
Id: ovulation-test-valueset
Title: "Ovulation Test Value Set"
Description: "Value set for ovulation test results"
* ^url = "http://example.org/fhir/ValueSet/ovulation-test-vs"
* ^status = #active
* include codes from system http://example.org/fhir/CodeSystem/ovulation-test-cs

CodeSystem: OvulationTestCodeSystem
Id: ovulation-test-cs
Title: "Ovulation Test Code System"
* ^url = "http://example.org/fhir/CodeSystem/ovulation-test-cs"
* ^status = #active
* ^caseSensitive = true
* #negative "Negative"
* #positive "Positive"
* #invalid "Invalid Test"

ValueSet: FertilityStatusValueSet
Id: fertility-status-valueset
Title: "Fertility Status Value Set"
Description: "Value set for fertility status"
* ^url = "http://example.org/fhir/ValueSet/fertility-status-vs"
* ^status = #active
* include codes from system http://example.org/fhir/CodeSystem/fertility-status-cs

CodeSystem: FertilityStatusCodeSystem
Id: fertility-status-cs
Title: "Fertility Status Code System"
* ^url = "http://example.org/fhir/CodeSystem/fertility-status-cs"
* ^status = #active
* ^caseSensitive = true
* #fertile "Fertile"
* #notFertile "Not Fertile"
* #uncertain "Uncertain"



// ===== Conteúdo de: MindfulnessSearchParameters.fsh =====

Instance: MindfulnessType
InstanceOf: SearchParameter
Usage: #definition
* status = #active
* code = #mindfulness-type
* name = "MindfulnessType"
* description = "Search for mindfulness observations by practice type"
* base = #Observation
* type = #token
* expression = "Observation.component.where(code.coding.where(system='http://snomed.info/sct' and code='711020003')).value.as(CodeableConcept)"
* xpath = "f:Observation/f:component[f:code/f:coding[f:system/@value='http://snomed.info/sct' and f:code/f:coding/f:code/@value='711020003']]/f:valueCodeableConcept"
* xpathUsage = #normal



// ===== Conteúdo de: MindfulnessAlerts.fsh =====

Extension: AlertTiming
Id: alert-timing
Title: "Alert Timing Extension"
Description: "Defines when alerts should be triggered"
* value[x] only Timing
* valueTiming.repeat 1..1 MS
* valueTiming.repeat.frequency MS
* valueTiming.repeat.period MS
* valueTiming.repeat.periodUnit MS

Extension: AlertMessage
Id: alert-message
Title: "Alert Message Extension"
Description: "Defines the alert message content"
* value[x] only string

Profile: MindfulnessAlert
Parent: Basic
Id: mindfulness-alert
Title: "Mindfulness Alert"
Description: "Alert configuration for mindfulness sessions"

* code 1..1 MS
* code = http://example.org/CodeSystem/mindfulness-alert-type#reminder "Mindfulness Reminder"

* extension contains
    alert-timing named alertTiming 0..1 MS and
    alert-message named alertMessage 1..1 MS

Instance: DailyMindfulnessAlert
InstanceOf: MindfulnessAlert
Title: "Daily Mindfulness Alert" 
Description: "Example of a daily mindfulness alert configuration"

* code = http://example.org/CodeSystem/mindfulness-alert-type#reminder "Mindfulness Reminder"
* extension[alertTiming].valueTiming.repeat
  * frequency = 1
  * period = 1
  * periodUnit = #d
* extension[alertMessage].valueString = "Time for your daily mindfulness practice"



// ===== Conteúdo de: MindfulnessTransforms.fsh =====

Instance: MindfulnessHealthKitTransform
InstanceOf: StructureMap
Usage: #definition
Title: "HealthKit to FHIR Mindfulness Transform"

* status = #draft
* name = "MindfulnessHealthKitTransform"
* structure[0]
  * url = "http://example.org/StructureDefinition/healthkit-mindfulness"
  * mode = #source
  * documentation = "HealthKit mindfulness session structure"

* structure[1]
  * url = "http://hl7.org/fhir/StructureDefinition/Observation"
  * mode = #target
  * documentation = "FHIR Observation resource"

* group[0]
  * name = "MindfulnessSessionToObservation"
  * typeMode = #none
  * input[0]
    * name = "source"
    * type = "HealthKitMindfulness"
    * mode = #source
  * input[1]
    * name = "target"
    * type = "Observation"
    * mode = #target
  * rule[0]
    * name = "Session"
    * source[0]
      * context = "source"
      * element = "startDate"
    * target[0]
      * context = "target"
      * element = "effectiveDateTime"
  * rule[1]
    * name = "Duration"
    * source[0]
      * context = "source"
      * element = "duration"
    * target[0]
      * context = "target"
      * element = "component.where(code.coding.code='118682006').valueQuantity"

Instance: MindfulnessCSVTransform
InstanceOf: StructureMap
Usage: #definition
Title: "CSV to FHIR Mindfulness Transform"

* status = #draft
* name = "MindfulnessCSVTransform"
* structure[0]
  * url = "http://example.org/StructureDefinition/csv-mindfulness"
  * mode = #source
  * documentation = "CSV mindfulness data structure"

* group[0]
  * name = "CSVToMindfulnessObservation"
  * typeMode = #none
  * input[0]
    * name = "source"
    * type = "CSVMindfulness"
    * mode = #source
  * input[1]
    * name = "target"
    * type = "Observation"
    * mode = #target
  * rule[0]
    * name = "MapDatetime"
    * source[0]
      * context = "source"
      * element = "date,time"
    * target[0]
      * context = "target"
      * element = "effectiveDateTime"
      * transform = #append

RuleSet: TransformValidationRules
* rule[+]
  * name = "ValidateStatus"
  * source[0]
    * context = "target"
    * element = "status"
  * assert[0]
    * description = "Status must be final"
    * expression = "%status = 'final'"

* rule[+]
  * name = "ValidateCode"
  * source[0]
    * context = "target"
    * element = "code"
  * assert[0]
    * description = "Must use SNOMED CT code"
    * expression = "%code.system = 'http://snomed.info/sct'"



// ===== Conteúdo de: MindfulnessAudit.fsh =====

Extension: AuditLevelExtension
Id: audit-level
Title: "Audit Level Extension"
Description: "Level of detail for audit records"
* value[x] only code
* valueCode from http://example.org/fhir/ValueSet/audit-levels (required)

Extension: AuditRetentionExtension
Id: audit-retention
Title: "Audit Retention Extension" 
Description: "Period to retain audit records"
* value[x] only Duration

Extension: AuditFormatExtension
Id: audit-format
Title: "Audit Format Extension"
Description: "Format for audit records"
* value[x] only code
* valueCode from http://example.org/fhir/ValueSet/audit-formats (required)

Profile: MindfulnessAudit
Parent: Basic
Id: mindfulness-audit
Title: "Mindfulness Audit"
Description: "Audit record for mindfulness sessions"

* code 1..1 MS
* code = http://example.org/CodeSystem/mindfulness-audit-type#session "Session Audit"
* created 1..1 MS

* extension contains
    audit-level named auditLevel 1..1 MS and
    audit-retention named auditRetention 1..1 MS and
    audit-format named auditFormat 1..1 MS

Instance: MindfulnessAuditExample
InstanceOf: MindfulnessAudit
Title: "Example Mindfulness Audit"
Description: "Example of a mindfulness session audit record"

* code = http://example.org/CodeSystem/mindfulness-audit-type#session "Session Audit"
* created = "2024-03-15"
* extension[auditLevel].valueCode = #detailed
* extension[auditRetention].valueDuration = 90 'days'
* extension[auditFormat].valueCode = #fhir



// ===== Conteúdo de: EnvironmentalExamples.fsh =====

Instance: NoiseExposureExample
InstanceOf: NoiseExposureObservation
Usage: #example
Title: "Noise Exposure Measurement Example"
Description: "Example of noise exposure measurement from iOS Health App"

* meta.security = http://terminology.hl7.org/CodeSystem/v3-Confidentiality#N
* status = #final
* category = http://terminology.hl7.org/CodeSystem/observation-category#environment
* code = $LOINC#28573-7 "Noise exposure time"
* subject = Reference(Patient/example)
* effectiveDateTime = "2024-03-19T15:30:00Z"
* device = Reference(Device/iphone-example)
* method = http://snomed.info/sct#37016008 "Automatic measurement"

* component[level]
  * code.coding[0] = $LOINC#89020-2 "Environmental noise average"
  * valueQuantity = 85 'dB'
  * interpretation = http://terminology.hl7.org/CodeSystem/v3-ObservationInterpretation#H "High"

* component[duration]
  * code.coding[0] = $LOINC#89021-0 "Environmental noise duration"
  * valueQuantity = 120 'min'

* component[peakLevel]
  * code.coding[0] = $LOINC#89024-4 "Peak sound level"
  * valueQuantity = 95 'dB'

* component[backgroundNoise]
  * code.coding[0] = $LOINC#89025-1 "Background noise level"
  * valueQuantity = 45 'dB'

* note.text = "Measurement taken during urban commute"

Instance: UVExposureExample
InstanceOf: UVExposureObservation
Usage: #example
Title: "UV Exposure Measurement Example"
Description: "Example of UV exposure measurement from iOS Health App"

* meta.security = http://terminology.hl7.org/CodeSystem/v3-Confidentiality#N
* status = #final
* category = http://terminology.hl7.org/CodeSystem/observation-category#environment
* code = $LOINC#28574-5 "UV exposure"
* subject = Reference(Patient/example)
* effectiveDateTime = "2024-03-19T12:00:00Z"
* device = Reference(Device/iphone-example)
* method = http://snomed.info/sct#37016008 "Automatic measurement"

* component[index]
  * code.coding[0] = $LOINC#89022-8 "UV index"
  * valueQuantity = 8 '{index}'
  * interpretation = http://terminology.hl7.org/CodeSystem/v3-ObservationInterpretation#H "High"

* component[duration]
  * code.coding[0] = $LOINC#89023-6 "UV exposure duration"
  * valueQuantity = 45 'min'

* component[timeOfDay]
  * code.coding[0] = $LOINC#89026-9 "Time of exposure"
  * valueDateTime = "2024-03-19T12:00:00Z"

* component[intensity]
  * code.coding[0] = $LOINC#89027-7 "UV intensity"
  * valueQuantity = 0.3 'W/m2'

* note.text = "Measurement taken during outdoor activity"

Instance: EnvironmentalDeviceExample
InstanceOf: Device
Usage: #example
Title: "Environmental Monitoring Device"
Description: "Example of iOS device used for environmental monitoring"

* identifier.system = "http://example.org/devices"
* identifier.value = "iPhone-ENV-001"
* manufacturer = "Apple Inc."
* modelNumber = "iPhone 15 Pro"
* type = $SCT#706689003 "Environmental monitoring device"
* status = #active



// ===== Conteúdo de: NutritionExamples.fsh =====

Instance: NutritionQuestionnaireResponseExample
InstanceOf: QuestionnaireResponse
Usage: #example
Title: "Daily Nutrition Questionnaire Response Example"

* questionnaire = "https://github.com/RicardoLSantos/shorthand/Questionnaire/daily-nutrition"
* status = #completed
* subject = Reference(Patient/PatientExample)
* authored = "2024-12-14T20:00:00Z"

* item[0]
  * linkId = "water_intake"
  * answer.valueQuantity = 2000 'mL'

* item[1]
  * linkId = "meal_record"

  * item[0]
    * linkId = "meal_time"
    * answer.valueDateTime = "2024-12-14T12:00:00Z"

  * item[1]
    * linkId = "meal_type"
    * answer.valueString = "Lunch"

  * item[2]
    * linkId = "calories"
    * answer.valueInteger = 650

  * item[3]
    * linkId = "macronutrients"
   
    * item[0]
      * linkId = "carbs"
      * answer.valueDecimal = 75
   
    * item[1]
      * linkId = "protein"
      * answer.valueDecimal = 30
   
    * item[2]
      * linkId = "fat"
      * answer.valueDecimal = 25

* item[2]
  * linkId = "caffeine"

  * item[0]
    * linkId = "caffeine_amount"
    * answer.valueInteger = 80

  * item[1]
    * linkId = "caffeine_source"
    * answer.valueString = "Coffee"



// ===== Conteúdo de: SleepExamples.fsh =====

Instance: SleepObservationExample1
InstanceOf: SleepObservation
Usage: #example
Title: "Example of Sleep Record"
Description: "Example of nightly sleep data from iOS Health App"
 
* status = #final
* category = http://terminology.hl7.org/CodeSystem/observation-category#sleep
* code = $LOINC#93832-4 "Sleep pattern panel"
* subject = Reference(PatientExample)
* effectivePeriod.start = "2024-03-19T22:00:00Z"
* effectivePeriod.end = "2024-03-20T06:30:00Z"
* device = Reference(DeviceSleepMonitor)
 
* component[timeInBed].code = $LOINC#93831-6 "Time in bed"
* component[timeInBed].valueQuantity = 510 'min' "minute"
* component[timeInBed].valueQuantity.system = $UCUM
* component[timeInBed].valueQuantity.unit = "minute"
 
* component[totalSleepTime].code = $LOINC#93833-2 "Sleep duration"
* component[totalSleepTime].valueQuantity = 472 'min' "minute"
* component[totalSleepTime].valueQuantity.system = $UCUM
* component[totalSleepTime].valueQuantity.unit = "minute"
 
* component[deepSleep].code = $LOINC#93834-0 "Deep sleep duration"
* component[deepSleep].valueQuantity = 95 'min' "minute"
* component[deepSleep].valueQuantity.system = $UCUM
* component[deepSleep].valueQuantity.unit = "minute"
 
* component[remSleep].code = $LOINC#93835-7 "REM sleep duration"
* component[remSleep].valueQuantity = 118 'min' "minute"
* component[remSleep].valueQuantity.system = $UCUM
* component[remSleep].valueQuantity.unit = "minute"
 
* component[lightSleep].code = $LOINC#93836-5 "Light sleep duration"
* component[lightSleep].valueQuantity = 259 'min' "minute"
* component[lightSleep].valueQuantity.system = $UCUM
* component[lightSleep].valueQuantity.unit = "minute"
 
* component[respiratoryRate].code = $LOINC#9279-1 "Respiratory rate"
* component[respiratoryRate].valueQuantity = 14 '/min' "per minute"
* component[respiratoryRate].valueQuantity.system = $UCUM
* component[respiratoryRate].valueQuantity.unit = "per minute"
 
* component[heartRateVariability].code = $LOINC#80404-7 "R-R interval.standard deviation (Heart rate variability)"
* component[heartRateVariability].valueQuantity = 45 'ms' "millisecond"
* component[heartRateVariability].valueQuantity.system = $UCUM
* component[heartRateVariability].valueQuantity.unit = "millisecond"
 
* component[interruptions].code = $LOINC#93837-3 "Number of awakenings during sleep"
* component[interruptions].valueQuantity = 3 '{count}' "count"
* component[interruptions].valueQuantity.system = $UCUM
* component[interruptions].valueQuantity.unit = "count"

Instance: DeviceSleepMonitor
InstanceOf: Device
Usage: #example
Title: "Sleep Monitoring Device"
* deviceName.name = "Sleep Quality Monitor"
* deviceName.type = #user-friendly-name
* manufacturer = "HealthTech Devices"
* modelNumber = "SQM-2024"
* type = $SCT#706172001 "Sleep monitor"



// ===== Conteúdo de: StressExamples.fsh =====

Instance: StressLevelExample
InstanceOf: StressLevelProfile
Usage: #example
Title: "Stress Level Measurement Example"

* status = #final
* category = http://terminology.hl7.org/CodeSystem/observation-category#vital-signs
* code = $LOINC#89592-0 "Stress level score"
* subject = Reference(Patient/example)
* effectiveDateTime = "2024-01-03T15:30:00Z"
* valueQuantity = 7 '{score}' "score"

* component[physiologicalStress].valueQuantity = 6 '{score}' "score"
* component[psychologicalStress].valueQuantity = 8 '{score}' "score"
* component[chronicity].valueCodeableConcept = StressChronicityCS#subacute
* component[impact].valueCodeableConcept = StressImpactCS#moderate

* extension[triggers].valueCodeableConcept = StressTriggersCS#work
* extension[coping].valueCodeableConcept = StressCopingCS#meditation



// ===== Conteúdo de: PatientExample.fsh =====

Instance: PatientExample
InstanceOf: Patient
Usage: #example
* identifier[0].system = "urn:oid:2.16.858.1.1.1"
* identifier[0].value = "12345"
* name.given = "John"
* name.family = "Doe"
* gender = #male
* birthDate = "1970-01-01"



// ===== Conteúdo de: MobilityExamples.fsh =====

Profile: WalkingSteadinessObservation
Parent: MobilityProfile
Id: walking-steadiness-observation
Title: "Walking Steadiness Observation Profile"
Description: "Profile for walking steadiness measurements from iPhone Motion Sensors"

* code = $LOINC#LA32-8 "Balance"
* component contains
    balanceScore 0..1 MS and
    balanceStatus 0..1 MS

* component[balanceScore]
  * code = $LOINC#LA32-8 "Balance score"
  * valueQuantity.system = $UCUM
  * valueQuantity.code = #%

* component[balanceStatus]
  * code = $LOINC#LA32-9 "Balance status"
  * valueCodeableConcept from http://example.org/fhir/ValueSet/balance-status (required)

Profile: WalkingSpeedObservation
Parent: MobilityProfile
Id: walking-speed-observation
Title: "Walking Speed Observation Profile"
Description: "Profile for walking speed measurements from iPhone Motion Sensors"

* code = $LOINC#LA29042-4 "Walking speed"
* component contains
    speed 0..1 MS and
    distance 0..1 MS

* component[speed]
  * code = $LOINC#LA29042-4 "Walking speed measurement"
  * valueQuantity.system = $UCUM
  * valueQuantity.code = #m/s

* component[distance]
  * code = $LOINC#LA29043-2 "Walking distance"
  * valueQuantity.system = $UCUM
  * valueQuantity.code = #m

Instance: WalkingSteadinessExample
InstanceOf: WalkingSteadinessObservation
Usage: #example
Title: "Walking Steadiness Measurement Example"
Description: "Example of walking steadiness measurement from iPhone Motion Sensors"

* status = #final
* category = http://terminology.hl7.org/CodeSystem/observation-category#activity
* code = $LOINC#LA32-8 "Balance"
* subject = Reference(Patient/example)
* effectiveDateTime = "2024-03-19T15:30:00Z"
* valueQuantity = 85 '1' "score"
* device = Reference(Device/iphone-example)

* component[balanceScore].valueQuantity = 85 '%' "percent"
* component[balanceStatus].valueCodeableConcept = $LOINC#LA32-10 "OK"

Instance: WalkingSpeedExample
InstanceOf: WalkingSpeedObservation
Usage: #example
Title: "Walking Speed Measurement Example"
Description: "Example of walking speed measurement from iPhone Motion Sensors"

* status = #final
* category = http://terminology.hl7.org/CodeSystem/observation-category#activity
* code = $LOINC#LA29042-4 "Walking speed"
* subject = Reference(Patient/example)
* effectiveDateTime = "2024-03-19T15:30:00Z"
* valueQuantity = 1.2 'm/s' "meters per second"
* device = Reference(Device/iphone-example)

* component[speed].valueQuantity = 1.2 'm/s' "meters per second"
* component[distance].valueQuantity = 10 'm' "meters"



// ===== Conteúdo de: PhysicalActivityExamples.fsh =====

Instance: PhysicalActivityExample1
InstanceOf: PhysicalActivityObservation
Usage: #example
Title: "Example of Walking Activity"
Description: "Example of walking activity data from iOS Health App"
* status = #final
* category = http://terminology.hl7.org/CodeSystem/observation-category#activity
* code = $SNOMED#228557008 "Walking"
* subject = Reference(PatientExample)
* effectiveDateTime = "2024-03-19T15:30:00Z"
* device = Reference(DeviceActivityTracker)
* component[steps].code = $LOINC#55423-8 "Number of steps in 24 hour Measured"
* component[steps].valueQuantity = 8546 '1' "count"
* component[steps].valueQuantity.system = $UCUM
* component[steps].valueQuantity.unit = "count"
* component[distance].code = $LOINC#55430-3 "Distance walked"
* component[distance].valueQuantity = 6.2 'km' "kilometer"
* component[distance].valueQuantity.system = $UCUM
* component[distance].valueQuantity.unit = "kilometer"
* component[duration].code = $LOINC#55411-3 "Exercise duration"
* component[duration].valueQuantity = 72 'min' "minute"
* component[duration].valueQuantity.system = $UCUM
* component[duration].valueQuantity.unit = "minute"
* component[energy].code = $LOINC#55424-6 "Energy expenditure"
* component[energy].valueQuantity = 320 'kcal' "kilocalorie"
* component[energy].valueQuantity.system = $UCUM
* component[energy].valueQuantity.unit = "kilocalorie"

Instance: DeviceActivityTracker
InstanceOf: Device
Usage: #example
Title: "Activity Tracking Device"
* deviceName.name = "Health Activity Tracker"
* deviceName.type = #user-friendly-name
* manufacturer = "HealthTech Devices"
* modelNumber = "HAT-2024"
* type = $SCT#258158006 "Activity monitor"



// ===== Conteúdo de: BodyMetricsExamples.fsh =====

Instance: WeightExample
InstanceOf: WeightObservation
Usage: #example
Title: "Weight Measurement Example"
Description: "Example of a weight measurement from a smart scale"
* status = #final
* category = http://terminology.hl7.org/CodeSystem/observation-category#vital-signs
* code = $LOINC#29463-7 "Body weight"
* subject = Reference(PatientExample)
* performer = Reference(PractitionerExample)
* effectiveDateTime = "2024-03-19T08:00:00Z"
* valueQuantity = 70.5 'kg' "kilogram"
* valueQuantity.system = $UCUM
* valueQuantity.unit = "kilogram"
* device = Reference(SmartScale)

Instance: HeightExample
InstanceOf: HeightObservation
Usage: #example
Title: "Height Measurement Example"
Description: "Example of a height measurement"
* status = #final
* category = http://terminology.hl7.org/CodeSystem/observation-category#vital-signs
* code = $LOINC#8302-2 "Body height"
* subject = Reference(PatientExample)
* performer = Reference(PractitionerExample)
* effectiveDateTime = "2024-03-19T08:00:00Z"
* valueQuantity = 175 'cm' "centimeter"
* valueQuantity.system = $UCUM
* valueQuantity.unit = "centimeter"

Instance: BMIExample
InstanceOf: BMIObservation
Usage: #example
Title: "BMI Calculation Example"
Description: "Example of a BMI calculation based on weight and height measurements"
* status = #final
* category = http://terminology.hl7.org/CodeSystem/observation-category#vital-signs
* code = $LOINC#39156-5 "Body mass index (BMI)"
* subject = Reference(PatientExample)
* performer = Reference(PractitionerExample)
* effectiveDateTime = "2024-03-19T08:00:00Z"
* valueQuantity = 23.0 'kg/m2' "kilogram per square meter"
* valueQuantity.system = $UCUM
* valueQuantity.unit = "kilogram per square meter"
* derivedFrom[0] = Reference(Observation/WeightExample)
* derivedFrom[1] = Reference(Observation/HeightExample)

Instance: BodyCompositionExample
InstanceOf: BodyCompositionObservation
Usage: #example
Title: "Body Composition Measurement Example" 
Description: "Example of comprehensive body composition measurements from a bioimpedance device"
* status = #final
* category = http://terminology.hl7.org/CodeSystem/observation-category#vital-signs
* code = $LOINC#88365-2 "Body composition panel"
* subject = Reference(PatientExample)
* performer = Reference(PractitionerExample)
* effectiveDateTime = "2024-03-19T08:00:00Z"
* device = Reference(BioimpedanceAnalyzer)

* component[bodyFat].code = $LOINC#41982-0 "Percentage body fat"
* component[bodyFat].valueQuantity = 22.5 '%' "percent"
* component[bodyFat].valueQuantity.system = $UCUM
* component[bodyFat].valueQuantity.unit = "percent"

* component[leanMass].code = $LOINC#291-7 "Lean body mass"
* component[leanMass].valueQuantity = 54.6 'kg' "kilogram"
* component[leanMass].valueQuantity.system = $UCUM
* component[leanMass].valueQuantity.unit = "kilogram"

* component[bodyWater].code = $LOINC#73708-0 "Total body water"
* component[bodyWater].valueQuantity = 39.2 'L' "liter"
* component[bodyWater].valueQuantity.system = $UCUM
* component[bodyWater].valueQuantity.unit = "liter"

* component[muscleMass].code = $LOINC#73713-0 "Muscle mass"
* component[muscleMass].valueQuantity = 51.8 'kg' "kilogram"
* component[muscleMass].valueQuantity.system = $UCUM
* component[muscleMass].valueQuantity.unit = "kilogram"

* component[boneMass].code = $LOINC#73711-4 "Bone mass"
* component[boneMass].valueQuantity = 2.8 'kg' "kilogram"
* component[boneMass].valueQuantity.system = $UCUM
* component[boneMass].valueQuantity.unit = "kilogram"

Instance: SmartScale
InstanceOf: Device
Usage: #example
Title: "Smart Scale Device"
* deviceName.name = "Smart Body Analyzer"
* deviceName.type = #user-friendly-name
* manufacturer = "HealthTech Devices"
* modelNumber = "SBA-2024"
* type = $SCT#469576000 "Digital scale device"

Instance: BioimpedanceAnalyzer  
InstanceOf: Device
Usage: #example
Title: "Bioimpedance Analyzer Device"
* deviceName.name = "Professional Body Composition Analyzer"
* deviceName.type = #user-friendly-name
* manufacturer = "MedTech Solutions"
* modelNumber = "BCA-Pro"
* type = $SCT#706767009 "Body composition analyzer"



// ===== Conteúdo de: SymptomExamples.fsh =====

Instance: ChronicSymptomExample
InstanceOf: Observation
Usage: #example
* status = #final
* category = http://terminology.hl7.org/CodeSystem/observation-category#survey
* code = $SCT#267036007 "Fatigue"
* subject = Reference(Patient/example)
* performer = Reference(Practitioner/example)
* effectiveDateTime = "2024-03-19T14:00:00Z"
// ... resto do exemplo ...

Instance: ExampleSymptomSeverity
InstanceOf: Observation
Usage: #example
* status = #final
* category = http://terminology.hl7.org/CodeSystem/observation-category#survey
* code = $SCT#246604007 "Symptom severity"
* subject = Reference(Patient/example)
* performer = Reference(Practitioner/example)
* effectiveDateTime = "2024-03-19T10:30:00Z"
// ... resto do exemplo ...



// ===== Conteúdo de: SocialInteractionExamples.fsh =====

Instance: SocialInteractionExample
InstanceOf: SocialInteractionProfile
Usage: #example
Title: "Social Interaction Example"

* status = #final
* category = http://terminology.hl7.org/CodeSystem/observation-category#social-history
* code = $LOINC#96766-1 "Social interaction pattern"
* subject = Reference(Patient/example)
* effectiveDateTime = "2024-01-03T14:00:00Z"
* valueCodeableConcept = SocialInteractionTypeCS#family

* component[duration].valueQuantity = 120 'min' "minutes"
* component[quality].valueCodeableConcept = SocialInteractionQualityCS#meaningful
* component[medium].valueCodeableConcept = SocialInteractionMediumCS#inPerson
* component[participants].valueInteger = 4

* extension[context].valueCodeableConcept = SocialContextCS#home
* extension[support].valueCodeableConcept = SocialSupportCS#strong
* extension[activity].valueCodeableConcept = SocialActivityCS#meal



// ===== Conteúdo de: VitalSignsExamples.fsh =====

Instance: HeartRateExample
InstanceOf: HeartRateObservation
Usage: #example
Title: "Heart Rate Measurement Example"
* status = #final
* code = $LOINC#8867-4 "Heart rate"
* subject = Reference(PatientExample)
* effectiveDateTime = "2024-03-19T15:30:00Z"
* valueQuantity = 72 '/min' "per minute"
* valueQuantity.system = $UCUM
* valueQuantity.unit = "per minute"
* device = Reference(DeviceHeartRateMonitor)
* performer = Reference(PractitionerExample)
* component[heartRateVariability].code = $LOINC#80404-7 "R-R interval.standard deviation (Heart rate variability)"
* component[heartRateVariability].valueQuantity = 45 'ms' "millisecond"
* component[heartRateVariability].valueQuantity.system = $UCUM
* component[heartRateVariability].valueQuantity.unit = "millisecond"

Instance: BloodPressureExample
InstanceOf: BloodPressureObservation
Usage: #example
Title: "Blood Pressure Measurement Example"
* status = #final
* code = $LOINC#85354-9 "Blood pressure panel with all children optional"
* subject = Reference(PatientExample)
* effectiveDateTime = "2024-03-19T15:30:00Z"
* device = Reference(DeviceBloodPressureMonitor)
* performer = Reference(PractitionerExample)
* component[systolic].code = $LOINC#8480-6 "Systolic blood pressure"
* component[systolic].valueQuantity = 120 'mm[Hg]' "millimeter of mercury"
* component[systolic].valueQuantity.system = $UCUM
* component[systolic].valueQuantity.unit = "millimeter of mercury"
* component[diastolic].code = $LOINC#8462-4 "Diastolic blood pressure"
* component[diastolic].valueQuantity = 80 'mm[Hg]' "millimeter of mercury"
* component[diastolic].valueQuantity.system = $UCUM
* component[diastolic].valueQuantity.unit = "millimeter of mercury"

Instance: DeviceHeartRateMonitor
InstanceOf: Device
Usage: #example
Title: "Heart Rate Monitor Device"
* deviceName.name = "Continuous Heart Rate Monitor"
* deviceName.type = #user-friendly-name
* manufacturer = "HealthTech Devices"
* modelNumber = "HRM-2024"
* type = $SCT#720737000 "Pulse rate monitoring device"

Instance: DeviceBloodPressureMonitor
InstanceOf: Device
Usage: #example
Title: "Blood Pressure Monitor Device"
* deviceName.name = "Digital Blood Pressure Monitor"
* deviceName.type = #user-friendly-name
* manufacturer = "HealthTech Devices"
* modelNumber = "BPM-2024"
* type = $SCT#43770009 "Blood pressure monitor"



// ===== Conteúdo de: PractitionerExample.fsh =====

Instance: PractitionerExample
InstanceOf: Practitioner
Usage: #example
* identifier[0].system = "http://hl7.org/fhir/sid/us-npi"
* identifier[0].value = "9941339108"
* name.given = "Jane"
* name.family = "Smith"



// ===== Conteúdo de: MindfulnessCompleteExamples.fsh =====

Instance: CompleteMindfulnessSession
InstanceOf: MindfulnessObservation
Usage: #example
Title: "Complete Mindfulness Session Example"

* status = #final
* code = $SCT#711020003 "Meditation"
* subject = Reference(Patient/PatientExample)
* effectiveDateTime = "2024-03-19T08:00:00Z"
* performer = Reference(Practitioner/example)

* component[sessionDuration].code = $SCT#118682006 "Duration"
* component[sessionDuration].valueQuantity = 20 'min'

* component[stressLevel].code = $SCT#725854004 "Assessment of stress level"
* component[stressLevel].valueInteger = 3

* component[moodState].code = $SCT#373931001 "Mood finding"
* component[moodState].valueCodeableConcept = $SCT#130991005 "Neutral mood"

* component[relaxationResponse].code = $SCT#276241001 "Relaxation technique"
* component[relaxationResponse].valueString = "Deep breathing exercises with progressive relaxation"

* component[mindfulnessType].code = $SCT#711020003 "Meditation"
* component[mindfulnessType].valueCodeableConcept = $SCT#711020003 "Meditation"

* extension[mindfulness-context].extension[location].valueString = "Home meditation room"
* extension[mindfulness-context].extension[environment].valueCodeableConcept = #quiet "Quiet Space"
* extension[mindfulness-context].extension[guidance].valueBoolean = true

Instance: CompleteMindfulnessResponse
InstanceOf: QuestionnaireResponse
Usage: #example
Title: "Complete Mindfulness Session Response"

* questionnaire = "http://example.org/Questionnaire/daily-mindfulness"
* status = #completed
* subject = Reference(Patient/PatientExample)
* authored = "2024-03-19T08:30:00Z"

* item[0]
  * linkId = "mindful_session"
  * item[0]
    * linkId = "session_duration"
    * answer.valueInteger = 20
  * item[1]
    * linkId = "practice_type"
    * answer.valueString = "Meditation"

* item[1]
  * linkId = "mood_assessment"
  * item[0]
    * linkId = "current_mood"
    * answer.valueCoding = $SCT#130991005 "Neutral mood"
  * item[1]
    * linkId = "mood_intensity"
    * answer.valueInteger = 3

* item[2]
  * linkId = "stress_assessment"
  * item[0]
    * linkId = "stress_level"
    * answer.valueInteger = 3
  * item[1]
    * linkId = "stress_symptoms"
    * answer[0].valueString = "Slight tension"

* item[3]
  * linkId = "relaxation"
  * item[0]
    * linkId = "relaxation_duration"
    * answer.valueInteger = 15
  * item[1]
    * linkId = "relaxation_technique"
    * answer.valueString = "Deep breathing"



// ===== Conteúdo de: MindfulnessExamples.fsh =====

Instance: MindfulnessObservationExample
InstanceOf: MindfulnessObservation
Usage: #example
Title: "Example of Mindfulness Session Observation"

* status = #final
* code = $SCT#711020003 "Meditation"
* subject = Reference(Patient/PatientExample)
* effectiveDateTime = "2024-03-19T09:30:00Z"
* performer = Reference(Practitioner/example)

* component[sessionDuration].code = $SCT#118682006 "Duration"
* component[sessionDuration].valueQuantity = 20 'min'

* component[stressLevel].code = $SCT#725854004 "Assessment of stress level"
* component[stressLevel].valueInteger = 4

* component[moodState].code = $SCT#373931001 "Mood finding"
* component[moodState].valueCodeableConcept = $SCT#130991005 "Neutral mood"

* component[relaxationResponse].code = $SCT#276241001 "Relaxation technique"
* component[relaxationResponse].valueString = "Deep breathing exercises helped reduce tension"

* component[mindfulnessType].code = $SCT#711020003 "Meditation"
* component[mindfulnessType].valueCodeableConcept = $SCT#711020003 "Meditation"

// New example for MindfulnessQuestionnaire
Instance: MindfulnessQuestionnaireExample
InstanceOf: Questionnaire
Usage: #example
Title: "Example of Mindfulness Questionnaire"

* url = "http://example.org/Questionnaire/mindfulness-example"
* status = #active
* title = "Daily Mindfulness Assessment"
* version = "1.0"
* name = "MindfulnessQuestionnaireExample"
* date = "2024-03-19"
* publisher = "Example Organization"
* description = "Example questionnaire for daily mindfulness practice assessment"

* item[0]
  * linkId = "session_details"
  * text = "Session Details"
  * type = #group
  
  * item[0]
    * linkId = "duration"
    * text = "Duration (minutes)"
    * type = #integer
    * required = true
    
  * item[1]
    * linkId = "technique"
    * text = "Technique Used"
    * type = #choice
    * required = true
    * answerOption[0].valueString = "Mindful Breathing"
    * answerOption[1].valueString = "Body Scan"
    * answerOption[2].valueString = "Walking Meditation"



// ===== Conteúdo de: ReproductiveExamples.fsh =====

Instance: ExampleReproductiveActivity
InstanceOf: CarePlan
Usage: #example
* status = #active
* intent = #plan
* subject = Reference(Patient/example)
* activity.detail.kind = #Observation
* activity.detail.code = ReproductiveActivityCS#cycle-tracking
* activity.detail.status = #scheduled



// ===== Conteúdo de: MindfulnessWorkflow.fsh =====

Profile: MindfulnessSchedule
Parent: Basic
Id: mindfulness-schedule
Title: "Mindfulness Schedule"
Description: "Schedule configuration for mindfulness sessions"

* code 1..1 MS
* code = http://example.org/CodeSystem/mindfulness-schedule-type#recurring "Recurring Schedule"

Extension: MindfulnessScheduleTiming
Id: mindfulness-schedule-timing
Title: "Mindfulness Schedule Timing"
Description: "Timing configuration for mindfulness sessions"
* value[x] only Timing

Instance: WeeklyMindfulnessSchedule
InstanceOf: MindfulnessSchedule
Title: "Weekly Mindfulness Schedule"
Description: "Example of a weekly mindfulness schedule"

* code = http://example.org/CodeSystem/mindfulness-schedule-type#recurring "Recurring Schedule"
* extension[mindfulness-schedule-timing].valueTiming.repeat.frequency = 1
* extension[mindfulness-schedule-timing].valueTiming.repeat.period = 1
* extension[mindfulness-schedule-timing].valueTiming.repeat.periodUnit = #wk
* extension[mindfulness-schedule-timing].valueTiming.repeat.dayOfWeek = #mon
* extension[mindfulness-schedule-timing].valueTiming.repeat.dayOfWeek[+] = #wed
* extension[mindfulness-schedule-timing].valueTiming.repeat.dayOfWeek[+] = #fri



// ===== Conteúdo de: MindfulnessRules.fsh =====

RuleSet: MindfulnessValidation
* ^extension[0].url = "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice"
* ^extension[0].valueBoolean = true

* status MS
* code MS
* subject MS
* effective[x] MS
* value[x] MS
* component MS

* status from http://hl7.org/fhir/ValueSet/observation-status
* code from http://snomed.info/sct?fhir_vs=isa/711020003
* subject only Reference(Patient)
* effective[x] only dateTime

* obeys mindfulness-session-duration
* obeys mindfulness-stress-level
* obeys mindfulness-mood-required
* obeys mindfulness-context-complete
* obeys sequential-measurements

RuleSet: MindfulnessQuestionnaireValidation
* status MS
* title MS
* item MS

* status = #active
* subjectType = #Patient
* item ^slicing.discriminator.type = #pattern
* item ^slicing.discriminator.path = "linkId"
* item ^slicing.rules = #open
* item contains 
    session 0..1 MS and
    mood 0..1 MS and
    stress 0..1 MS and
    relaxation 0..1 MS

* item[session]
  * linkId = "mindful_session"
  * text = "Mindfulness Session"
  * type = #group
  * required = true
  * repeats = false

* item[mood]
  * linkId = "mood_assessment"
  * text = "Mood Assessment"
  * type = #group
  * required = true
  * repeats = false

* item[stress]
  * linkId = "stress_assessment"
  * text = "Stress Assessment"
  * type = #group
  * required = true
  * repeats = false

* item[relaxation]
  * linkId = "relaxation"
  * text = "Relaxation"
  * type = #group
  * required = true
  * repeats = false

RuleSet: MindfulnessResponseValidation
* status MS
* subject MS
* authored MS
* item MS

* status = #completed
* subject only Reference(Patient)
* authored 1..1
* item ^slicing.discriminator.type = #pattern
* item ^slicing.discriminator.path = "linkId"
* item ^slicing.rules = #open



// ===== Conteúdo de: MindfulnessMappings.fsh =====

Mapping: MindfulnessToHealthKit
Id: mindfulness-to-healthkit
Title: "Mapping to Apple HealthKit"
Source: MindfulnessObservation
Target: "http://developer.apple.com/documentation/healthkit"

* -> "HKCategoryTypeIdentifierMindfulSession" "Root mapping"
* effectiveDateTime -> "startDate and endDate" "Session timing"
* component[sessionDuration].valueQuantity -> "duration" "Session duration"

Mapping: MindfulnessToLOINC
Id: mindfulness-to-loinc
Title: "Mapping to LOINC codes"
Source: MindfulnessObservation
Target: "http://loinc.org"

* -> "89555-7" "Mindfulness safety questionnaire"
* component[stressLevel] -> "89556-5" "Stress level score"
* component[sessionDuration] -> "89557-3" "Duration of mindfulness practice"
* component[moodState] -> "89558-1" "Mood pattern"

Mapping: MindfulnessToSNOMED
Id: mindfulness-to-snomed
Title: "Mapping to SNOMED CT"
Source: MindfulnessObservation
Target: "http://snomed.info/sct"

* -> "711020003" "Meditation"
* component[stressLevel] -> "725854004" "Assessment of stress level"
* component[moodState] -> "373931001" "Mood finding"
* component[relaxationResponse] -> "276241001" "Relaxation technique"

Extension: MindfulnessImportMap
Id: mindfulness-import-map
Title: "Mindfulness Import Mapping"
Description: "Mapping instructions for importing mindfulness data"

* ^url = "https://example.org/StructureDefinition/mindfulness-import-map"
* ^version = "1.0.0"
* ^status = #draft

* extension contains
    source 1..1 MS and
    target 1..1 MS and
    mapping 1..1 MS

* extension[source].value[x] only string
* extension[target].value[x] only string
* extension[mapping].value[x] only string

Instance: HealthKitMappingConfig
InstanceOf: MindfulnessImportMap
Usage: #inline

* extension[source].valueString = "HKCategoryTypeIdentifierMindfulSession"
* extension[target].valueString = "Observation"
* extension[mapping].valueString = "duration->component[sessionDuration].valueQuantity"



// ===== Conteúdo de: SocialInteractionMappings.fsh =====

Mapping: SocialInteractionToHealthKit
Id: social-interaction-to-healthkit
Title: "Mapping to Apple HealthKit"
Source: SocialInteractionProfile
Target: "http://developer.apple.com/documentation/healthkit"

* -> "HKCategoryTypeIdentifierSocialInteraction" "Root mapping"
* valueCodeableConcept -> "interactionType" "Type of interaction"
* component[duration] -> "duration" "Duration of interaction"
* component[participants] -> "participantCount" "Number of participants"

Mapping: SocialInteractionToLOINC
Id: social-interaction-to-loinc
Title: "Mapping to LOINC codes"
Source: SocialInteractionProfile
Target: "http://loinc.org"

* -> "96766-1" "Social Interaction Panel"
* component[duration] -> "89597-9" "Interaction duration"
* component[quality] -> "89598-7" "Interaction quality"



// ===== Conteúdo de: MindfulnessDiagnosticMappings.fsh =====

Instance: MindfulnessDiagnosticMap
InstanceOf: ConceptMap
Usage: #definition
Title: "Mindfulness Diagnostic Mappings"
Description: "Mapping of mindfulness outcomes to diagnostic codes"

* status = #draft
* experimental = false
* purpose = "Map mindfulness outcomes to standard diagnostic codes"
* sourceUri = "https://example.org/ValueSet/mindfulness-outcome-vs"
* targetUri = "http://snomed.info/sct"

* group[0].source = "https://example.org/CodeSystem/mindfulness-outcome-cs"
* group[0].target = "http://snomed.info/sct"
* group[0].element[0]
  * code = #stressReduction
  * target[0]
    * code = #73595000
    * display = "Stress"
    * equivalence = #narrower
    * comment = "Indicates reduction in stress levels"

* group[0].element[1]
  * code = #improvedSleep
  * target[0]
    * code = #248234008
    * display = "Sleep pattern"
    * equivalence = #narrower
    * comment = "Indicates improvement in sleep quality"

* group[0].element[2]
  * code = #emotionalBalance
  * target[0]
    * code = #285854004
    * display = "Emotional state"
    * equivalence = #equivalent
    * comment = "Maps to emotional state finding"

* group[0].element[3]
  * code = #increasedAwareness
  * target[0]
    * code = #736253002
    * display = "Mental state, behavior and/or psychosocial functioning"
    * equivalence = #relatedto
    * comment = "General improvement in mental state"

RuleSet: MindfulnessDiagnosticRules
* status MS
* code MS
* subject MS
* effective[x] MS
* value[x] MS
* method MS

* method from http://example.org/ValueSet/mindfulness-diagnostic-method-vs (required)
* code from http://example.org/ValueSet/mindfulness-diagnostic-code-vs (required)

* extension contains 
    diagnosticCertainty 0..1 MS and
    diagnosticTiming 0..1 MS



// ===== Conteúdo de: StressMappings.fsh =====

Mapping: StressToHealthKit
Id: stress-to-healthkit
Title: "Mapping to Apple HealthKit"
Source: StressLevelProfile
Target: "http://developer.apple.com/documentation/healthkit"

* -> "HKCategoryTypeIdentifierStressLevel" "Root mapping"
* valueQuantity -> "stressLevel" "Overall stress score"
* component[physiologicalStress] -> "physiologicalStress" "Physical stress indicators"
* component[psychologicalStress] -> "mentalStress" "Mental stress indicators"

Mapping: StressToLOINC
Id: stress-to-loinc
Title: "Mapping to LOINC codes"
Source: StressLevelProfile
Target: "http://loinc.org"

* -> "89592-0" "Stress Level Panel"
* component[physiologicalStress] -> "89593-8" "Physical stress score"
* component[psychologicalStress] -> "89594-6" "Mental stress score"



// ===== Conteúdo de: BodyMetricsProfiles.fsh =====

Alias: $SCT = http://snomed.info/sct
Alias: $LOINC = http://loinc.org
Alias: $UCUM = http://unitsofmeasure.org

Profile: BodyMetricsObservation
Parent: Observation
Id: body-metrics-observation
Title: "Body Metrics Observation Profile"
Description: "Profile for body measurements from iOS Health App"

* ^version = "0.1.0"
* ^status = #draft
* ^publisher = "Open Health Manager"

* status MS
* category 1..1 MS
* category = http://terminology.hl7.org/CodeSystem/observation-category#vital-signs
* subject 1..1 MS
* effectiveDateTime 1..1 MS
* device 0..1 MS

Profile: WeightObservation
Parent: BodyMetricsObservation
Id: weight-observation  
Title: "Weight Measurement Profile"
Description: "Profile for body weight measurements"

* ^version = "0.1.0"
* ^status = #draft

* code = $LOINC#29463-7 "Body weight"
* valueQuantity only Quantity
* valueQuantity.system = $UCUM
* valueQuantity.code = #kg

Profile: HeightObservation
Parent: BodyMetricsObservation
Id: height-observation
Title: "Height Measurement Profile" 
Description: "Profile for body height measurements"

* ^version = "0.1.0"
* ^status = #draft

* code = $LOINC#8302-2 "Body height"
* valueQuantity only Quantity
* valueQuantity.system = $UCUM
* valueQuantity.code = #cm

Profile: BMIObservation
Parent: BodyMetricsObservation
Id: bmi-observation
Title: "BMI Measurement Profile"
Description: "Profile for Body Mass Index calculations"

* ^version = "0.1.0"
* ^status = #draft

* code = $LOINC#39156-5 "Body mass index (BMI)"
* valueQuantity only Quantity
* valueQuantity.system = $UCUM
* valueQuantity.code = #kg/m2

Profile: BodyCompositionObservation
Parent: BodyMetricsObservation
Id: body-composition-observation
Title: "Body Composition Profile"
Description: "Profile for body composition measurements including fat, lean mass, and other metrics"

* ^version = "0.1.0"
* ^status = #draft

* code = $LOINC#88365-2 "Body composition panel"
* component ^slicing.discriminator.type = #pattern
* component ^slicing.discriminator.path = "code"
* component ^slicing.rules = #open

* component contains
    bodyFat 0..1 MS and
    leanMass 0..1 MS and
    bodyWater 0..1 MS and
    muscleMass 0..1 MS and
    boneMass 0..1 MS

* component[bodyFat].code = $LOINC#41982-0 "Percentage body fat"
* component[bodyFat].valueQuantity.system = $UCUM
* component[bodyFat].valueQuantity.code = #%

* component[leanMass].code = $LOINC#291-7 "Lean body mass"
* component[leanMass].valueQuantity.system = $UCUM
* component[leanMass].valueQuantity.code = #kg

* component[bodyWater].code = $LOINC#73708-0 "Total body water"
* component[bodyWater].valueQuantity.system = $UCUM  
* component[bodyWater].valueQuantity.code = #L

* component[muscleMass].code = $LOINC#73713-0 "Muscle mass"
* component[muscleMass].valueQuantity.system = $UCUM
* component[muscleMass].valueQuantity.code = #kg

* component[boneMass].code = $LOINC#73711-4 "Bone mass" 
* component[boneMass].valueQuantity.system = $UCUM
* component[boneMass].valueQuantity.code = #kg



// ===== Conteúdo de: AdvancedVitalSignsProfiles.fsh =====

Alias: $SCT = http://snomed.info/sct
Alias: $LOINC = http://loinc.org
Alias: $UCUM = http://unitsofmeasure.org

Profile: AdvancedVitalSigns
Parent: Observation
Id: advanced-vital-signs
Title: "Advanced Vital Signs Profile"
Description: "Profile for advanced vital signs data from iOS Health App"

* ^version = "0.1.0"
* ^status = #draft
* ^publisher = "HL7 International"
* ^contact.name = "Advanced Vital Signs Working Group"

* status MS
* category 1..1 MS
* category = http://terminology.hl7.org/CodeSystem/observation-category#vital-signs
* code 1..1 MS
* subject 1..1 MS
* effectiveDateTime 1..1 MS
* device 0..1 MS
* method 0..1 MS
* note 0..* MS

* component ^slicing.discriminator.type = #pattern
* component ^slicing.discriminator.path = "code"
* component ^slicing.rules = #open
* component ^short = "Advanced vital signs components"
* component ^definition = "Components of advanced vital sign measurements"

* component contains
    hrvSpectral 0..1 MS and
    hrvEntropy 0..1 MS and
    meanArterialPressure 0..1 MS and
    pulseWaveAnalysis 0..1 MS and
    respiratoryVariability 0..1 MS and
    oxygenationIndex 0..1 MS and
    stressIndex 0..1 MS and
    thermalGradient 0..1 MS and
    autonomicBalance 0..1 MS and
    recoveryRate 0..1 MS and
    allostaticLoad 0..1 MS

* component[hrvSpectral].code = $LOINC#87834-8 "Heart rate variability [Frequency band]"
* component[hrvSpectral].valueQuantity.system = $UCUM
* component[hrvSpectral].valueQuantity.code = #ms
* component[hrvSpectral] ^short = "Spectral analysis of heart rate variability"

* component[hrvEntropy].code = $LOINC#87835-5 "Heart rate variability entropy"
* component[hrvEntropy].valueQuantity.system = $UCUM
* component[hrvEntropy].valueQuantity.code = #{entropy}
* component[hrvEntropy] ^short = "Sample entropy of heart rate variability"

* component[meanArterialPressure].code = $LOINC#8478-0 "Mean blood pressure"
* component[meanArterialPressure].valueQuantity.system = $UCUM
* component[meanArterialPressure].valueQuantity.code = #mmHg
* component[meanArterialPressure] ^short = "Mean arterial blood pressure"

* component[pulseWaveAnalysis].code = $LOINC#87836-3 "Pulse wave analysis"
* component[pulseWaveAnalysis].valueQuantity.system = $UCUM
* component[pulseWaveAnalysis].valueQuantity.code = #{index}
* component[pulseWaveAnalysis] ^short = "Analysis of arterial pulse wave"

* component[respiratoryVariability].code = $LOINC#87837-1 "Respiratory rate variability"
* component[respiratoryVariability].valueQuantity.system = $UCUM
* component[respiratoryVariability].valueQuantity.code = #{coefficient}
* component[respiratoryVariability] ^short = "Variability in respiratory rate"

* component[oxygenationIndex].code = $LOINC#87838-9 "Oxygenation index"
* component[oxygenationIndex].valueQuantity.system = $UCUM
* component[oxygenationIndex].valueQuantity.code = #{ratio}
* component[oxygenationIndex] ^short = "Index of blood oxygenation"

* component[stressIndex].code = $LOINC#87839-7 "Physiological stress index"
* component[stressIndex].valueQuantity.system = $UCUM
* component[stressIndex].valueQuantity.code = #{index}
* component[stressIndex] ^short = "Index of physiological stress"

* component[thermalGradient].code = $LOINC#87840-5 "Temperature gradient"
* component[thermalGradient].valueQuantity.system = $UCUM
* component[thermalGradient].valueQuantity.code = #Cel
* component[thermalGradient] ^short = "Gradient of body temperature"

* component[autonomicBalance].code = $LOINC#87841-3 "Autonomic balance index"
* component[autonomicBalance].valueQuantity.system = $UCUM
* component[autonomicBalance].valueQuantity.code = #{ratio}
* component[autonomicBalance] ^short = "Balance of autonomic nervous system"

* component[recoveryRate].code = $LOINC#87842-1 "Recovery rate index"
* component[recoveryRate].valueQuantity.system = $UCUM
* component[recoveryRate].valueQuantity.code = #{rate}
* component[recoveryRate] ^short = "Rate of physiological recovery"

* component[allostaticLoad].code = $LOINC#87843-9 "Allostatic load index"
* component[allostaticLoad].valueQuantity.system = $UCUM
* component[allostaticLoad].valueQuantity.code = #{score}
* component[allostaticLoad] ^short = "Measure of cumulative physiological burden"

Extension: AdvancedVitalSignsContext
Id: advanced-vital-signs-context
Title: "Advanced Vital Signs Context Extension"
Description: "Additional context about advanced vital sign measurements"

* value[x] only CodeableConcept
* valueCodeableConcept from AdvancedVitalSignsContextVS (required)

ValueSet: AdvancedVitalSignsContextVS
Id: advanced-vital-signs-context-vs
Title: "Advanced Vital Signs Context Value Set"
Description: "Context codes for advanced vital sign measurements"

* ^experimental = true
* codes from system AdvancedVitalSignsContextCS

CodeSystem: AdvancedVitalSignsContextCS
Id: advanced-vital-signs-context-cs
Title: "Advanced Vital Signs Context Code System"
Description: "Codes for advanced vital signs measurement context"

* ^experimental = true
* ^caseSensitive = true

* #resting "Resting state" "Measurement taken during rest"
* #active "Active state" "Measurement taken during activity"
* #recovery "Recovery state" "Measurement taken during recovery"
* #sleep "Sleep state" "Measurement taken during sleep"
* #stress "Stress state" "Measurement taken during stress"



// ===== Conteúdo de: MobilityProfiles.fsh =====

Profile: MobilityProfile
Parent: Observation
Id: mobility-profile
Title: "Mobility Profile"
Description: "Profile for mobility data from iOS Health App"

* status MS
* category 1..1 MS
* category = http://terminology.hl7.org/CodeSystem/observation-category#activity
* code 1..1 MS
* subject 1..1 MS
* effectiveDateTime 1..1 MS
* device 0..1 MS

* component ^slicing.discriminator.type = #pattern
* component ^slicing.discriminator.path = "code"
* component ^slicing.rules = #open

* component contains
    steadiness 0..1 MS and
    balance 0..1 MS and
    gait 0..1 MS and 
    movement 0..1 MS

* component[steadiness].code = $LOINC#LA32-8
* component[balance].code = $LOINC#LA32-9
* component[gait].code = $LOINC#LA29042-4
* component[movement].code = $LOINC#LA29043-2



// ===== Conteúdo de: VitalSignsProfiles.fsh =====

Alias: $SCT = http://snomed.info/sct
Alias: $LOINC = http://loinc.org
Alias: $UCUM = http://unitsofmeasure.org
Alias: $vitalsigns = http://hl7.org/fhir/StructureDefinition/vitalsigns

Profile: LifestyleVitalSigns
Parent: $vitalsigns
Id: lifestyle-vital-signs
Title: "Lifestyle Medicine Vital Signs Profile"
Description: "Profile for vital signs data from iOS Health App"

* status MS
* category 1..* MS
* subject 1..1 MS
* effectiveDateTime 1..1 MS
* code 1..1 MS
* value[x] 0..1 MS
* device 0..1 MS

Profile: HeartRateObservation
Parent: LifestyleVitalSigns
Id: heart-rate-observation
Title: "Heart Rate Observation Profile"
Description: "Profile for heart rate measurements from iOS Health App"

* code = $LOINC#8867-4 "Heart rate"
* valueQuantity only Quantity
* valueQuantity.system = $UCUM
* valueQuantity.code = #/min
* component ^slicing.discriminator.type = #pattern
* component ^slicing.discriminator.path = "code"
* component ^slicing.rules = #open

* component contains
    restingHeartRate 0..1 MS and
    exerciseHeartRate 0..1 MS and
    recoveryHeartRate 0..1 MS and
    heartRateVariability 0..1 MS

* component[heartRateVariability].code = $LOINC#80404-7 "R-R interval.standard deviation (Heart rate variability)"
* component[heartRateVariability].valueQuantity.system = $UCUM
* component[heartRateVariability].valueQuantity.code = #ms

Profile: BloodPressureObservation
Parent: LifestyleVitalSigns
Id: blood-pressure-observation
Title: "Blood Pressure Observation Profile"
Description: "Profile for blood pressure measurements from iOS Health App"

* code = $LOINC#85354-9 "Blood pressure panel with all children optional"
* component 2..2 MS
* component ^slicing.discriminator.type = #pattern
* component ^slicing.discriminator.path = "code"
* component ^slicing.rules = #closed

* component contains
    systolic 1..1 MS and
    diastolic 1..1 MS

* component[systolic].code = $LOINC#8480-6 "Systolic blood pressure"
* component[systolic].valueQuantity only Quantity
* component[systolic].valueQuantity.system = $UCUM
* component[systolic].valueQuantity.code = #mm[Hg]

* component[diastolic].code = $LOINC#8462-4 "Diastolic blood pressure"
* component[diastolic].valueQuantity only Quantity
* component[diastolic].valueQuantity.system = $UCUM
* component[diastolic].valueQuantity.code = #mm[Hg]

Profile: OxygenSaturationObservation
Parent: LifestyleVitalSigns
Id: oxygen-saturation-observation
Title: "Oxygen Saturation Observation Profile"
Description: "Profile for SpO2 measurements from iOS Health App"

* code = $LOINC#2708-6 "Oxygen saturation in Arterial blood"
* valueQuantity.system = $UCUM
* valueQuantity.code = #%



// ===== Conteúdo de: PhysicalActivityProfile.fsh =====

Alias: $LOINC = http://loinc.org
Alias: $SNOMED = http://snomed.info/sct
Alias: $UCUM = http://unitsofmeasure.org
Alias: $ActivityCodes = http://example.org/activity-codes

Profile: PhysicalActivityObservation
Parent: Observation
Id: physical-activity-observation
Title: "Physical Activity Observation Profile"
Description: "Profile for recording physical activity data from iOS Health App"

* status MS
* category 1..1 MS
* category = http://terminology.hl7.org/CodeSystem/observation-category#activity
* code 1..1 MS
* code from PhysicalActivityTypeVS (required)
* subject 1..1 MS
* subject only Reference(Patient)
* effectiveDateTime 1..1 MS
* device 0..1 MS
* value[x] only Quantity
* component ^slicing.discriminator.type = #pattern
* component ^slicing.discriminator.path = "code"
* component ^slicing.rules = #open

* component contains
    steps 0..1 MS and
    distance 0..1 MS and
    duration 0..1 MS and
    energy 0..1 MS

* component[steps].code = $LOINC#55423-8 "Number of steps in 24 hour Measured"
* component[steps].valueQuantity only Quantity
* component[steps].valueQuantity.system = $UCUM
* component[steps].valueQuantity.code = #1 "count"

* component[distance].code = $LOINC#55430-3 "Distance walked"
* component[distance].valueQuantity only Quantity
* component[distance].valueQuantity.system = $UCUM
* component[distance].valueQuantity.code = #km "kilometer"

* component[duration].code = $LOINC#55411-3 "Exercise duration"
* component[duration].valueQuantity only Quantity
* component[duration].valueQuantity.system = $UCUM
* component[duration].valueQuantity.code = #min "minute"

* component[energy].code = $LOINC#55424-6 "Energy expenditure"
* component[energy].valueQuantity only Quantity
* component[energy].valueQuantity.system = $UCUM
* component[energy].valueQuantity.code = #kcal "kilocalorie"



// ===== Conteúdo de: ReproductiveObservation.fsh =====

Profile: ReproductiveObservation
Parent: Observation
Id: reproductive-observation
Title: "Reproductive Health Base Profile"
Description: "Base profile for reproductive health observations"

* ^version = "1.0.0"
* ^status = #active
* ^date = "2024-03-19"

* status MS
* category 1..1 MS
* category = http://terminology.hl7.org/CodeSystem/observation-category#reproductive
* code 1..1 MS
* subject 1..1 MS
* subject only Reference(Patient)
* effectiveDateTime 1..1 MS
* value[x] MS

* component ^slicing.discriminator.type = #pattern
* component ^slicing.discriminator.path = "code"
* component ^slicing.rules = #open

* component contains
    severity 0..1 MS and
    duration 0..1 MS and
    frequency 0..1 MS and
    pattern 0..1 MS

* component[severity]
  * code = $LOINC#72514-3
  * value[x] only integer
  * valueInteger 1..1 
  * valueInteger obeys rep-1

* component[duration]
  * code = $LOINC#103332-8
  * value[x] only Quantity
  * valueQuantity from DurationUnitsVS (required)

* component[frequency]
  * code = $LOINC#103334-4
  * value[x] only CodeableConcept
  * valueCodeableConcept from SymptomFrequencyVS (required)

* component[pattern]
  * code = $LOINC#103335-1
  * value[x] only CodeableConcept
  * valueCodeableConcept from SymptomProgressionVS (required)

Invariant: rep-1
Description: "Severity must be between 0 and 10"
Expression: "$this >= 0 and $this <= 10"
Severity: #error



// ===== Conteúdo de: SymptomProfiles.fsh =====

Profile: SymptomQuestionnaire
Parent: Questionnaire
Id: symptom-questionnaire
Title: "Symptom Assessment Questionnaire"
Description: "Questionnaire template for symptom assessments"

* status MS
* title MS
* item MS

* item ^slicing.discriminator.type = #pattern
* item ^slicing.discriminator.path = "linkId"
* item ^slicing.rules = #open

* item contains
    symptomType 1..1 MS and
    location 0..1 MS and
    onset 0..1 MS and
    description 0..1 MS

* item[symptomType].linkId = "symptom-type"
* item[symptomType].text = "Type of Symptom"
* item[symptomType].type = #choice
* item[symptomType].required = true

* item[location].linkId = "location"
* item[location].text = "Location"
* item[location].type = #string

* item[onset].linkId = "onset"
* item[onset].text = "When did it start?"
* item[onset].type = #dateTime

* item[description].linkId = "description"
* item[description].text = "Description"
* item[description].type = #text



// ===== Conteúdo de: ReproductiveProfiles.fsh =====

Profile: FertilityObservation
Parent: Observation
Id: fertility-observation
Title: "Fertility Observation Profile"
Description: "Profile for fertility signs and symptoms"

* status MS
* category 1..1 MS
* category = http://terminology.hl7.org/CodeSystem/observation-category#reproductive
* code = $LOINC#8669-4 "Ovulation status"
* subject 1..1 MS
* effectiveDateTime 1..1 MS

* component ^slicing.discriminator.type = #pattern
* component ^slicing.discriminator.path = "code"
* component ^slicing.rules = #open

* component contains
    cervicalMucus 0..1 MS and
    ovulationTest 0..1 MS and
    fertilityStatus 0..1 MS

* component[cervicalMucus].valueCodeableConcept from http://example.org/fhir/ValueSet/cervical-mucus-vs (required)
* component[ovulationTest].valueCodeableConcept from http://example.org/fhir/ValueSet/ovulation-test-vs (required)
* component[fertilityStatus].valueCodeableConcept from http://example.org/fhir/ValueSet/fertility-status-vs (required)



// ===== Conteúdo de: MindfulnessProfiles.fsh =====

Profile: MindfulnessObservation
Parent: Observation
Id: mindfulness-observation
Title: "Mindfulness Session Observation"
Description: "Profile for recording mindfulness practice sessions and outcomes"

* status MS
* code MS
* subject MS
* effectiveDateTime MS
* performer MS
* value[x] MS
* component MS

* status = #final
* code = $SCT#711020003 "Meditation"
* subject only Reference(Patient)
* effectiveDateTime 1..1
* performer only Reference(Practitioner or PractitionerRole)

* component ^slicing.discriminator.type = #pattern
* component ^slicing.discriminator.path = "code"
* component ^slicing.rules = #open

* component contains
    sessionDuration 0..1 and
    stressLevel 0..1 and
    moodState 0..1 and
    relaxationResponse 0..1 and
    mindfulnessType 0..1

* component[sessionDuration]
  * code = $SCT#118682006 "Duration"
  * value[x] only Quantity
  * valueQuantity
    * value 1..1
    * unit = "min"
    * system = "http://unitsofmeasure.org"
    * code = #min

* component[stressLevel]
  * code = $SCT#725854004 "Assessment of stress level"
  * value[x] only integer
  * valueInteger
    * ^extension[0].url = "http://hl7.org/fhir/StructureDefinition/elementdefinition-minValueInteger"
    * ^extension[0].valueInteger = 0
    * ^extension[1].url = "http://hl7.org/fhir/StructureDefinition/elementdefinition-maxValueInteger"
    * ^extension[1].valueInteger = 10

* component[moodState]
  * code = $SCT#373931001 "Mood finding"
  * value[x] only CodeableConcept
  * valueCodeableConcept from http://example.org/fhir/ValueSet/mood (required)

* component[relaxationResponse]
  * code = $SCT#276241001 "Relaxation technique"
  * value[x] only string

* component[mindfulnessType]
  * code = $SCT#711020003 "Meditation"
  * value[x] only CodeableConcept
  * valueCodeableConcept from http://example.org/ValueSet/mindfulness-type (required)



// ===== Conteúdo de: SleepProfile.fsh =====

Alias: $SCT = http://snomed.info/sct
Alias: $LOINC = http://loinc.org
Alias: $UCUM = http://unitsofmeasure.org
 
Profile: SleepObservation
Parent: Observation
Id: sleep-observation
Title: "Sleep Observation Profile"
Description: "Profile for recording sleep data from iOS Health App"
 
* status MS
* category 1..1 MS
* category = http://terminology.hl7.org/CodeSystem/observation-category#sleep
* code 1..1 MS
* code = $LOINC#93832-4 "Sleep pattern panel"
* subject 1..1 MS
* subject only Reference(Patient)
* effectiveDateTime 0..1 MS
* effectivePeriod 0..1 MS
* device 0..1 MS
 
* component ^slicing.discriminator.type = #pattern
* component ^slicing.discriminator.path = "code"
* component ^slicing.rules = #open
 
* component contains
    timeInBed 1..1 MS and
    totalSleepTime 1..1 MS and
    deepSleep 0..1 MS and
    remSleep 0..1 MS and
    lightSleep 0..1 MS and
    respiratoryRate 0..1 MS and
    heartRateVariability 0..1 MS and
    interruptions 0..1 MS
 
* component[timeInBed].code = $LOINC#93831-6 "Time in bed"
* component[timeInBed].valueQuantity only Quantity
* component[timeInBed].valueQuantity.system = $UCUM
* component[timeInBed].valueQuantity.code = #min
 
* component[totalSleepTime].code = $LOINC#93833-2 "Sleep duration"
* component[totalSleepTime].valueQuantity only Quantity
* component[totalSleepTime].valueQuantity.system = $UCUM
* component[totalSleepTime].valueQuantity.code = #min
 
* component[deepSleep].code = $LOINC#93834-0 "Deep sleep duration"
* component[deepSleep].valueQuantity only Quantity
* component[deepSleep].valueQuantity.system = $UCUM
* component[deepSleep].valueQuantity.code = #min
 
* component[remSleep].code = $LOINC#93835-7 "REM sleep duration"
* component[remSleep].valueQuantity only Quantity
* component[remSleep].valueQuantity.system = $UCUM
* component[remSleep].valueQuantity.code = #min
 
* component[lightSleep].code = $LOINC#93836-5 "Light sleep duration"
* component[lightSleep].valueQuantity only Quantity
* component[lightSleep].valueQuantity.system = $UCUM
* component[lightSleep].valueQuantity.code = #min
 
* component[respiratoryRate].code = $LOINC#9279-1 "Respiratory rate"
* component[respiratoryRate].valueQuantity only Quantity
* component[respiratoryRate].valueQuantity.system = $UCUM
* component[respiratoryRate].valueQuantity.code = #/min
 
* component[heartRateVariability].code = $LOINC#80404-7 "R-R interval.standard deviation (Heart rate variability)"
* component[heartRateVariability].valueQuantity only Quantity
* component[heartRateVariability].valueQuantity.system = $UCUM
* component[heartRateVariability].valueQuantity.code = #ms
 
* component[interruptions].code = $LOINC#93837-3 "Number of awakenings during sleep"
* component[interruptions].valueQuantity only Quantity
* component[interruptions].valueQuantity.system = $UCUM
* component[interruptions].valueQuantity.code = #{count}
* extension contains SleepQuality named quality 0..1



// ===== Conteúdo de: MobilityRiskAssessment.fsh =====

Profile: MobilityRiskAssessment
Parent: RiskAssessment
Id: mobility-risk-assessment
Title: "Mobility Risk Assessment Profile"
Description: "Profile for assessing mobility-related risks"

* status MS
* subject 1..1 MS
* occurrence[x] MS
* prediction MS
  * outcome MS
  * probability[x] MS
  * qualitativeRisk MS

* method MS
  * coding ^slicing.discriminator.type = #pattern
  * coding ^slicing.discriminator.path = "$this"
  * coding ^slicing.rules = #open
  * coding contains
      mobilityAssessment 1..1 MS

* method.coding[mobilityAssessment] = http://example.org/CodeSystem/mobility-assessment-method#standardized "Standardized Mobility Assessment"

* prediction ^slicing.discriminator.type = #pattern
* prediction ^slicing.discriminator.path = "outcome"
* prediction ^slicing.rules = #open

* prediction contains
    fallRisk 0..1 MS and
    mobilityDecline 0..1 MS and
    assistanceNeeded 0..1 MS

* prediction[fallRisk].outcome from http://example.org/ValueSet/fall-risk-outcomes
* prediction[fallRisk].probabilityDecimal 0..1 MS
* prediction[fallRisk].qualitativeRisk from http://example.org/ValueSet/risk-level

* prediction[mobilityDecline].outcome from http://example.org/ValueSet/mobility-decline-outcomes
* prediction[mobilityDecline].probabilityDecimal 0..1 MS
* prediction[mobilityDecline].qualitativeRisk from http://example.org/ValueSet/risk-level

* prediction[assistanceNeeded].outcome from http://example.org/ValueSet/assistance-level-outcomes
* prediction[assistanceNeeded].probabilityDecimal 0..1 MS
* prediction[assistanceNeeded].qualitativeRisk from http://example.org/ValueSet/risk-level

* basis only Reference(MobilityProfile or Observation or QuestionnaireResponse)
* basis MS

* note MS



// ===== Conteúdo de: EnvironmentalProfiles.fsh =====

Alias: $SCT = http://snomed.info/sct
Alias: $LOINC = http://loinc.org
Alias: $UCUM = http://unitsofmeasure.org

Profile: EnvironmentalObservation
Parent: Observation
Id: environmental-observation
Title: "Environmental Observation Profile"
Description: "Base profile for environmental measurements from iOS Health App"

* ^version = "0.1.0"
* ^status = #draft
* ^publisher = "HL7 International"
* ^contact.name = "Environmental Health Working Group"

* status MS
* category 1..1 MS
* category = http://terminology.hl7.org/CodeSystem/observation-category#environment
* subject 1..1 MS
* effectiveDateTime 1..1 MS
* device 0..1 MS
* method 0..1 MS
* note 0..* MS

Profile: NoiseExposureObservation
Parent: EnvironmentalObservation
Id: noise-exposure-observation
Title: "Noise Exposure Observation Profile"
Description: "Profile for noise exposure measurements from iOS Health App"

* code = $LOINC#28573-7 "Noise exposure time"
* component ^slicing.discriminator.type = #pattern
* component ^slicing.discriminator.path = "code"
* component ^slicing.rules = #open
* component ^short = "Noise exposure components"
* component ^definition = "Components of noise exposure measurement"

* component contains
    level 1..1 MS and
    duration 1..1 MS and
    peakLevel 0..1 MS and
    backgroundNoise 0..1 MS

* component[level].code = $LOINC#89020-2 "Environmental noise average"
* component[level].valueQuantity.system = $UCUM
* component[level].valueQuantity.code = #dB
* component[level].valueQuantity ^short = "Noise level in decibels"

* component[duration].code = $LOINC#89021-0 "Environmental noise duration"
* component[duration].valueQuantity.system = $UCUM
* component[duration].valueQuantity.code = #min
* component[duration].valueQuantity ^short = "Duration of exposure"

* component[peakLevel].code = $LOINC#89024-4 "Peak sound level"
* component[peakLevel].valueQuantity.system = $UCUM
* component[peakLevel].valueQuantity.code = #dB
* component[peakLevel].valueQuantity ^short = "Peak noise level"

* component[backgroundNoise].code = $LOINC#89025-1 "Background noise level"
* component[backgroundNoise].valueQuantity.system = $UCUM
* component[backgroundNoise].valueQuantity.code = #dB
* component[backgroundNoise].valueQuantity ^short = "Background noise level"

Profile: UVExposureObservation
Parent: EnvironmentalObservation
Id: uv-exposure-observation
Title: "UV Exposure Observation Profile"
Description: "Profile for UV exposure measurements from iOS Health App"

* code = $LOINC#28574-5 "UV exposure"
* component ^slicing.discriminator.type = #pattern
* component ^slicing.discriminator.path = "code"
* component ^slicing.rules = #open
* component ^short = "UV exposure components"
* component ^definition = "Components of UV exposure measurement"

* component contains
    index 1..1 MS and
    duration 1..1 MS and
    timeOfDay 0..1 MS and
    intensity 0..1 MS

* component[index].code = $LOINC#89022-8 "UV index"
* component[index].valueQuantity.system = $UCUM
* component[index].valueQuantity.code = #{index}
* component[index].valueQuantity ^short = "UV index value"

* component[duration].code = $LOINC#89023-6 "UV exposure duration"
* component[duration].valueQuantity.system = $UCUM
* component[duration].valueQuantity.code = #min
* component[duration].valueQuantity ^short = "Duration of UV exposure"

* component[timeOfDay].code = $LOINC#89026-9 "Time of exposure"
* component[timeOfDay].valueDateTime 1..1
* component[timeOfDay].valueDateTime ^short = "Time of UV exposure"

* component[intensity].code = $LOINC#89027-7 "UV intensity"
* component[intensity].valueQuantity.system = $UCUM
* component[intensity].valueQuantity.code = #W/m2
* component[intensity].valueQuantity ^short = "UV radiation intensity"

Extension: EnvironmentalContext
Id: environmental-context
Title: "Environmental Context Extension"
Description: "Additional context about environmental measurements"

* value[x] only CodeableConcept
* valueCodeableConcept from http://example.org/fhir/ValueSet/environmental-context (required)



// ===== Conteúdo de: SocialInteractionProfile.fsh =====

Profile: SocialInteractionProfile
Parent: Observation
Id: social-interaction
Title: "Social Interaction Profile"
Description: "Profile for recording social interaction data from iOS Health App"

* ^version = "0.1.0"
* ^status = #active
* ^date = "2024-01-03"
* ^publisher = "FMUP HEADS2"

* status MS
* category 1..1 MS
* category = http://terminology.hl7.org/CodeSystem/observation-category#social-history
* code 1..1 MS
* code = $LOINC#96766-1 "Social interaction pattern"
* subject 1..1 MS
* effectiveDateTime 1..1 MS
* value[x] only CodeableConcept
* valueCodeableConcept from SocialInteractionTypeVS (required)

* component ^slicing.discriminator.type = #pattern
* component ^slicing.discriminator.path = "code"
* component ^slicing.rules = #open

* component contains
    duration 0..1 MS and
    quality 0..1 MS and
    medium 0..1 MS and
    participants 0..1 MS

* component[duration]
  * code = $LOINC#89597-9 "Social interaction duration"
  * valueQuantity only Quantity
  * valueQuantity.system = $UCUM
  * valueQuantity.code = #min

* component[quality]
  * code = $LOINC#89598-7 "Social interaction quality"
  * valueCodeableConcept from SocialInteractionQualityVS (required)

* component[medium]
  * code = $LOINC#89599-5 "Social interaction medium"
  * valueCodeableConcept from SocialInteractionMediumVS (required)

* component[participants]
  * code = $LOINC#89600-1 "Social interaction participants"
  * valueInteger only integer

* extension contains
    SocialContext named context 0..1 MS and
    SocialSupport named support 0..1 MS and
    SocialActivity named activity 0..* MS



// ===== Conteúdo de: StressLevelProfile.fsh =====

Profile: StressLevelProfile
Parent: Observation
Id: stress-level
Title: "Stress Level Profile"
Description: "Profile for recording stress level measurements from iOS Health App"

* ^version = "0.1.0"
* ^status = #active
* ^date = "2024-01-03"
* ^publisher = "FMUP HEADS2"

* status MS
* category 1..1 MS
* category = http://terminology.hl7.org/CodeSystem/observation-category#vital-signs
* code 1..1 MS
* code = $LOINC#89592-0 "Stress level score"
* subject 1..1 MS
* effectiveDateTime 1..1 MS
* value[x] only Quantity
* valueQuantity MS

* component ^slicing.discriminator.type = #pattern
* component ^slicing.discriminator.path = "code"
* component ^slicing.rules = #open

* component contains
    physiologicalStress 0..1 MS and
    psychologicalStress 0..1 MS and
    chronicity 0..1 MS and 
    impact 0..1 MS

* component[physiologicalStress]
  * code = $LOINC#89593-8 "Physiological stress"
  * valueQuantity only Quantity
  * valueQuantity.system = $UCUM
  * valueQuantity.code = #{score}

* component[psychologicalStress]
  * code = $LOINC#89594-6 "Psychological stress"
  * valueQuantity only Quantity
  * valueQuantity.system = $UCUM
  * valueQuantity.code = #{score}

* component[chronicity]
  * code = $LOINC#89595-3 "Stress chronicity"
  * valueCodeableConcept from StressChronicityVS (required)

* component[impact]
  * code = $LOINC#89596-1 "Stress impact"
  * valueCodeableConcept from StressImpactVS (required)

* extension contains
    MeasurementContext named context 0..1 MS and
    StressTriggers named triggers 0..* MS and 
    StressCoping named coping 0..* MS



// ===== Conteúdo de: NutritionProfiles.fsh =====

Alias: $SCT = http://snomed.info/sct
Alias: $LOINC = http://loinc.org
Alias: $UCUM = http://unitsofmeasure.org

Profile: NutritionIntakeObservation
Parent: Observation
Id: nutrition-intake-observation
Title: "Nutrition Intake Observation Profile"
Description: "Profile for nutrition intake data from iOS Health App and user input"

* ^version = "0.1.0"
* ^status = #draft
* ^publisher = "Ricardo Lourenço dos Santos"

* status MS
* category 1..1 MS
* category = http://terminology.hl7.org/CodeSystem/observation-category#nutrition
* subject 1..1 MS
* effectiveDateTime 1..1 MS
* code 1..1 MS
* method 0..1 MS

Profile: WaterIntakeObservation
Parent: NutritionIntakeObservation 
Id: water-intake-observation
Title: "Water Intake Observation Profile"
Description: "Profile for water intake measurements"

* ^version = "0.1.0"
* ^status = #draft
* ^publisher = "Ricardo Lourenço dos Santos"

* code = $LOINC#77111-4 "Water intake"
* valueQuantity only Quantity
* valueQuantity.system = $UCUM
* valueQuantity.code = #mL
* valueQuantity.unit = "milliliter"

Profile: CalorieIntakeObservation
Parent: NutritionIntakeObservation
Id: calorie-intake-observation
Title: "Calorie Intake Observation Profile"
Description: "Profile for caloric intake measurements"

* ^version = "0.1.0"
* ^status = #draft
* ^publisher = "Ricardo Lourenço dos Santos"

* code = $LOINC#9051-4 "Caloric intake total"
* valueQuantity only Quantity
* valueQuantity.system = $UCUM
* valueQuantity.code = #kcal
* valueQuantity.unit = "kilocalorie"

Profile: MacronutrientsObservation
Parent: NutritionIntakeObservation
Id: macronutrients-observation
Title: "Macronutrients Observation Profile"
Description: "Profile for macronutrient intake measurements"

* ^version = "0.1.0"
* ^status = #draft
* ^publisher = "Ricardo Lourenço dos Santos"

* code = $LOINC#LP199119-9 "Macronutrients panel"
* component ^slicing.discriminator.type = #pattern
* component ^slicing.discriminator.path = "code"
* component ^slicing.rules = #open

* component contains
    carbohydrates 0..1 MS and
    proteins 0..1 MS and
    fats 0..1 MS

* component[carbohydrates].code = $LOINC#LP35925-4 "Carbohydrates"
* component[carbohydrates].valueQuantity.system = $UCUM
* component[carbohydrates].valueQuantity.code = #g
* component[carbohydrates].valueQuantity.unit = "gram"

* component[proteins].code = $LOINC#LP35921-3 "Proteins" 
* component[proteins].valueQuantity.system = $UCUM
* component[proteins].valueQuantity.code = #g
* component[proteins].valueQuantity.unit = "gram"

* component[fats].code = $LOINC#LP35922-1 "Fats"
* component[fats].valueQuantity.system = $UCUM
* component[fats].valueQuantity.code = #g
* component[fats].valueQuantity.unit = "gram"



// ===== Conteúdo de: MindfulnessMessaging.fsh =====

Alias: $MsgEvents = http://example.org/fhir/CodeSystem/mindfulness-message-events
Alias: $MsgTypes = http://terminology.hl7.org/CodeSystem/message-type

Profile: MindfulnessMessageDefinition
Parent: MessageDefinition
Id: mindfulness-message-definition
Title: "Mindfulness Message Definition" 
Description: "Definition for mindfulness session messages"

* url 1..1 MS
* date 1..1 MS
* status 1..1 MS
* event[x] 1..1 MS
* category 0..1 MS
* focus 1..* MS
* focus.min 1..1

Instance: StartSessionMessage
InstanceOf: MindfulnessMessageDefinition
Title: "Start Session Message"
Description: "Message definition for starting a mindfulness session"

* url = "http://example.org/fhir/MessageDefinition/start-session"
* date = "2024-03-19"
* status = #active
* eventCoding = $MsgEvents#session-start "Session Start"
* category = #notification
* focus.code = #Observation
* focus.min = 1
* focus.profile = "http://example.org/fhir/StructureDefinition/mindfulness-session"

Instance: EndSessionMessage  
InstanceOf: MindfulnessMessageDefinition
Title: "End Session Message"
Description: "Message definition for ending a mindfulness session"

* url = "http://example.org/fhir/MessageDefinition/end-session"
* date = "2024-03-19"
* status = #active
* eventCoding = $MsgEvents#session-end "Session End"
* category = #notification
* focus.code = #Observation
* focus.min = 1
* focus.profile = "http://example.org/fhir/StructureDefinition/mindfulness-session"



// ===== Conteúdo de: MindfulnessReports.fsh =====

Instance: MindfulnessProgressReport
InstanceOf: Measure
Usage: #definition
Title: "Mindfulness Practice Progress Report"

* status = #active
* experimental = false
* date = "2024-03-19"
* publisher = "Example Organization"
* description = "Measures progress in mindfulness practice over time"

* scoring = #continuous-variable
* type = #process
* riskAdjustment = "none"
* rateAggregation = "Average values over time period"

* group[0]
  * code = #practice-frequency
  * description = "Frequency of mindfulness practice"
  * population[0]
    * code = #denominator
    * criteria.language = #text/fhirpath
    * criteria.expression = "Observation.where(code.coding.code='711020003')"
  * stratifier[0]
    * code = #weekly
    * criteria.language = #text/fhirpath
    * criteria.expression = "Observation.effective.as(DateTime).truncate(@T).truncate(@W)"

* group[1]
  * code = #stress-reduction
  * description = "Stress level changes over time"
  * population[0]
    * code = #denominator
    * criteria.language = #text/fhirpath
    * criteria.expression = "Observation.where(component.code.coding.code='725854004')"
  * stratifier[0]
    * code = #trend
    * criteria.language = #text/fhirpath
    * criteria.expression = "component.where(code.coding.code='725854004').value.value"

RuleSet: ReportingMetrics
* group[+]
  * code = #session-duration
  * description = "Duration of practice sessions"
  * population[0]
    * code = #denominator
    * criteria.language = #text/fhirpath
    * criteria.expression = "Observation.component.where(code.coding.code='118682006')"
  * stratifier[0]
    * code = #average
    * criteria.language = #text/fhirpath
    * criteria.expression = "component.where(code.coding.code='118682006').value.value"

* group[+]
  * code = #mood-changes
  * description = "Mood state changes"
  * population[0]
    * code = #denominator
    * criteria.language = #text/fhirpath
    * criteria.expression = "Observation.component.where(code.coding.code='373931001')"



// ===== Conteúdo de: missing-instances.fsh =====

Instance: example
InstanceOf: Patient
Usage: #example
* identifier.system = "http://github.com/RicardoLSantos/shorthand/sid/patients"
* identifier.value = "12345"
* active = true
* name.family = "Doe"
* name.given = "John"
* gender = #male
* birthDate = "1980-01-01"

Instance: practitioner-example
InstanceOf: Practitioner
Usage: #example
* identifier.system = "http://github.com/RicardoLSantos/shorthand/sid/practitioners"
* identifier.value = "99999"
* active = true
* name.family = "Smith"
* name.given = "Jane"

Instance: iphone-example
InstanceOf: Device
Usage: #example
* status = #active
* manufacturer = "Apple Inc."
* deviceName.name = "iPhone 14"
* deviceName.type = #user-friendly-name



// ===== Conteúdo de: EnvironmentalValueSets.fsh =====

ValueSet: EnvironmentalContextValueSet
Id: environmental-context
Title: "Environmental Context Value Set"
Description: "Value set for environmental context"
* ^url = "http://example.org/fhir/ValueSet/environmental-context"
* ^status = #active
* include codes from system http://example.org/fhir/CodeSystem/environmental-context



// ===== Conteúdo de: MindfulnessCapabilities.fsh =====

Instance: MindfulnessCapabilityStatement
InstanceOf: CapabilityStatement
Usage: #definition
Title: "Mindfulness Module Capabilities"
Description: "Capabilities supported by the mindfulness module implementation"

* status = #draft
* date = "2024-03-19"
* kind = #requirements
* fhirVersion = #4.0.1
* format[0] = #json
* format[1] = #xml

* rest[0]
  * mode = #server
  * documentation = "RESTful server capabilities for mindfulness data"
  
  * resource[0]
    * type = #Observation
    * documentation = "Supports mindfulness session observations"
    * profile = "https://example.org/StructureDefinition/mindfulness-observation"
    * interaction[0]
      * code = #read
    * interaction[1]
      * code = #create
    * interaction[2]
      * code = #update
    * interaction[3]
      * code = #search-type
    * searchParam[0]
      * name = "patient"
      * type = #reference
      * documentation = "Search by patient reference"
    * searchParam[1]
      * name = "date"
      * type = #date
      * documentation = "Search by session date"
    * searchParam[2]
      * name = "code"
      * type = #token
      * documentation = "Search by observation type"
      
  * resource[1]
    * type = #Questionnaire
    * documentation = "Supports mindfulness questionnaires"
    * profile = "https://example.org/StructureDefinition/mindfulness-questionnaire"
    * interaction[0]
      * code = #read
    * interaction[1]
      * code = #search-type
    * searchParam[0]
      * name = "title"
      * type = #string
      * documentation = "Search by questionnaire title"
      
  * resource[2]
    * type = #QuestionnaireResponse
    * documentation = "Supports mindfulness questionnaire responses"
    * profile = "https://example.org/StructureDefinition/mindfulness-questionnaire-response"
    * interaction[0]
      * code = #create
    * interaction[1]
      * code = #read
    * interaction[2]
      * code = #search-type
    * searchParam[0]
      * name = "patient"
      * type = #reference
      * documentation = "Search by patient reference"
    * searchParam[1]
      * name = "authored"
      * type = #date
      * documentation = "Search by response date"



// ===== Conteúdo de: MindfulnessQuestionnaires.fsh =====

Instance: DailyMindfulnessQuestionnaire
InstanceOf: Questionnaire
Usage: #definition
Title: "Daily Mindfulness Questionnaire"
Description: "Questionnaire for capturing daily mindfulness practice and associated effects"

* url = "http://example.org/Questionnaire/daily-mindfulness"
* status = #active
* title = "Daily Mindfulness Practice"
* subjectType = #Patient
* version = "1.0.0"
* name = "DailyMindfulnessQuestionnaire"
* date = "2024-03-19"

* item[0]
  * linkId = "mindful_session"
  * text = "Mindfulness Session"
  * type = #group
  * repeats = false

  * item[0]
    * linkId = "session_duration"
    * text = "Session duration (minutes)"
    * type = #integer
    * required = true
    * extension[0].url = "http://hl7.org/fhir/StructureDefinition/minValue"
    * extension[0].valueInteger = 1

  * item[1]
    * linkId = "practice_type"
    * text = "Practice type"
    * type = #choice
    * required = true
    * answerOption[0].valueString = "Meditation"
    * answerOption[1].valueString = "Breathing exercise"
    * answerOption[2].valueString = "Body scan"
    * answerOption[3].valueString = "Mindful walking"

* item[1]
  * linkId = "mood_assessment"
  * text = "Mood Assessment"
  * type = #group

  * item[0]
    * linkId = "current_mood"
    * text = "How is your mood now?"
    * type = #choice
    * required = true
    * answerValueSet = "https://example.org/fhir/ValueSet/mood-vs"

  * item[1]
    * linkId = "mood_intensity"
    * text = "Mood intensity (1-5)"
    * type = #integer
    * required = true

* item[2]
  * linkId = "stress_assessment"
  * text = "Stress Assessment"
  * type = #group

  * item[0]
    * linkId = "stress_level"
    * text = "Stress level (0-10)"
    * type = #integer
    * required = true

  * item[1]
    * linkId = "stress_symptoms"
    * text = "Stress symptoms"
    * type = #choice
    * repeats = true
    * answerOption[0].valueString = "Muscle tension"
    * answerOption[1].valueString = "Anxiety"
    * answerOption[2].valueString = "Headache"
    * answerOption[3].valueString = "Fatigue"

* item[3]
  * linkId = "relaxation"
  * text = "Relaxation"
  * type = #group

  * item[0]
    * linkId = "relaxation_duration"
    * text = "Relaxation time (minutes)"
    * type = #integer
    * required = true

  * item[1]
    * linkId = "relaxation_technique"
    * text = "Technique used"
    * type = #choice
    * required = true
    * answerOption[0].valueString = "Deep breathing"
    * answerOption[1].valueString = "Progressive relaxation"
    * answerOption[2].valueString = "Visualization"
    * answerOption[3].valueString = "Mindful awareness"



// ===== Conteúdo de: NutritionQuestionnaires.fsh =====

Instance: DailyNutritionQuestionnaire
InstanceOf: Questionnaire
Usage: #definition
Title: "Daily Nutrition Intake Questionnaire"
Description: "Questionnaire for daily nutrition intake tracking"

* url = "https://github.com/RicardoLSantos/shorthand/Questionnaire/daily-nutrition"
* version = "0.1.0"
* name = "DailyNutritionQuestionnaire"
* title = "Daily Nutrition Intake"
* status = #active
* experimental = false
* date = "2024-12-14"
* publisher = "Ricardo Lourenço dos Santos"

* item[0]
  * linkId = "water_intake"
  * text = "How much water did you drink today?"
  * type = #quantity
  * required = true
  * repeats = false
  * initial.valueQuantity = 0 'mL'

* item[1]
  * linkId = "meal_record"
  * text = "Meal Records"
  * type = #group
  * repeats = true

  * item[0]
    * linkId = "meal_time"
    * text = "Meal Time"
    * type = #dateTime
    * required = true

  * item[1]
    * linkId = "meal_type"
    * text = "Meal Type"
    * type = #choice
    * required = true
    * answerOption[0].valueString = "Breakfast"
    * answerOption[1].valueString = "Lunch"
    * answerOption[2].valueString = "Dinner"
    * answerOption[3].valueString = "Snack"

  * item[2]
    * linkId = "calories"
    * text = "Estimated Calories"
    * type = #integer
    * required = true

  * item[3]
    * linkId = "macronutrients"
    * text = "Macronutrients"
    * type = #group

    * item[0]
      * linkId = "carbs"
      * text = "Carbohydrates (g)"
      * type = #decimal
      * required = true

    * item[1]
      * linkId = "protein"
      * text = "Proteins (g)"
      * type = #decimal
      * required = true

    * item[2]
      * linkId = "fat"
      * text = "Fats (g)"
      * type = #decimal
      * required = true

* item[2]
  * linkId = "caffeine"
  * text = "Caffeine Intake"
  * type = #group

  * item[0]
    * linkId = "caffeine_amount"
    * text = "Caffeine amount (mg)"
    * type = #integer
    * required = false

  * item[1]
    * linkId = "caffeine_source"
    * text = "Caffeine source"
    * type = #choice
    * repeats = true
    * answerOption[0].valueString = "Coffee"
    * answerOption[1].valueString = "Tea"
    * answerOption[2].valueString = "Soft Drink"
    * answerOption[3].valueString = "Energy Drink"



// ===== Conteúdo de: ReproductiveQuestionnaire.fsh =====

Instance: ReproductiveHealthQuestionnaire
InstanceOf: Questionnaire
Usage: #definition
Title: "Reproductive Health Tracking Questionnaire"
Description: "Daily questionnaire for reproductive health tracking"
 
* status = #active
* url = "http://example.org/Questionnaire/reproductive-health"
* name = "ReproductiveHealthQuestionnaire"
* title = "Reproductive Health Monitoring"
* date = "2024-03-19"
 
* item[0]
  * linkId = "menstrual_cycle"
  * text = "Menstrual Cycle"
  * type = #group
 
  * item[0]
    * linkId = "cycle_start"
    * text = "Cycle started today?"
    * type = #boolean
 
  * item[1]
    * linkId = "flow_intensity"
    * text = "Flow intensity"
    * type = #choice
    * enableWhen
      * question = "cycle_start"
      * operator = #=
      * answerBoolean = true
    * answerOption[0].valueString = "Light"
    * answerOption[1].valueString = "Moderate"
    * answerOption[2].valueString = "Heavy"
 
* item[1]
  * linkId = "symptoms"
  * text = "Symptoms"
  * type = #group
  * repeats = true
 
  * item[0]
    * linkId = "symptom_type"
    * text = "Symptom type"
    * type = #choice
    * answerValueSet = "http://example.org/ValueSet/reproductive-symptoms"
 
  * item[1]
    * linkId = "symptom_severity"
    * text = "Intensity (0-10)"
    * type = #integer
    * extension[0]
      * url = "http://hl7.org/fhir/StructureDefinition/minValue"
      * valueInteger = 0
    * extension[1]
      * url = "http://hl7.org/fhir/StructureDefinition/maxValue"
      * valueInteger = 10
 
* item[2]
  * linkId = "mood_changes"
  * text = "Mood Changes"
  * type = #group

  * item[0]
    * linkId = "mood_type"
    * text = "Current mood"
    * type = #choice
    * answerValueSet = "http://example.org/ValueSet/mood-types"

  * item[1]
    * linkId = "mood_severity"
    * text = "Intensity (0-10)"
    * type = #integer
    * extension[0]
      * url = "http://hl7.org/fhir/StructureDefinition/minValue"
      * valueInteger = 0
    * extension[1]
      * url = "http://hl7.org/fhir/StructureDefinition/maxValue"
      * valueInteger = 10



// ===== Conteúdo de: aliases.fsh =====

Alias: SCT = http://snomed.info/sct
Alias: LOINC = http://loinc.org
Alias: UCUM = http://unitsofmeasure.org



// ===== Conteúdo de: MindfulnessTerminology.fsh =====

CodeSystem: MindfulnessOutcomeCS
Id: mindfulness-outcome-cs
Title: "Mindfulness Outcomes"
Description: "Outcomes and effects of mindfulness practice"

* ^experimental = false
* ^caseSensitive = true
* #increasedAwareness "Increased Awareness" "Greater awareness of thoughts and sensations"
* #improvedFocus "Improved Focus" "Enhanced ability to concentrate"
* #stressReduction "Stress Reduction" "Decreased levels of stress and tension"
* #emotionalBalance "Emotional Balance" "Better emotional regulation"
* #improvedSleep "Improved Sleep" "Enhanced sleep quality"

ValueSet: MindfulnessOutcomeVS
Id: mindfulness-outcome-vs
Title: "Mindfulness Outcomes Value Set"
Description: "Value set for mindfulness practice outcomes"

* ^experimental = false
* include codes from system MindfulnessOutcomeCS
* include $SCT#365949003 "Finding of level of stress"
* include $SCT#373931001 "Mood finding"

CodeSystem: MindfulnessQualifierCS
Id: mindfulness-qualifier-cs
Title: "Mindfulness Practice Qualifiers"
Description: "Qualifiers for mindfulness practice characteristics"

* ^experimental = false
* ^caseSensitive = true
* #guided "Guided Practice" "Practice with guidance or instruction"
* #selfDirected "Self-Directed" "Independent practice"
* #group "Group Practice" "Practice in group setting"
* #individual "Individual Practice" "Solo practice session"

ValueSet: MindfulnessQualifierVS
Id: mindfulness-qualifier-vs
Title: "Mindfulness Practice Qualifiers Value Set"
Description: "Value set for mindfulness practice qualifiers"

* ^experimental = false
* include codes from system MindfulnessQualifierCS
* include $SCT#410534003 "Guided meditation"
* include $SCT#225386006 "Exercise therapy"

* ^copyright = "This value set includes content from SNOMED CT, which is copyright © 2002+ International Health Terminology Standards Development Organisation (IHTSDO)"



// ===== Conteúdo de: MindfulnessConfig.fsh =====

Extension: MindfulnessSessionDuration
Id: mindfulness-session-duration
Title: "Mindfulness Session Duration"
Description: "Default duration for mindfulness sessions in minutes"
* value[x] only integer

Extension: MindfulnessReminderTime
Id: mindfulness-reminder-time
Title: "Mindfulness Reminder Time"
Description: "Default time for daily reminders"
* value[x] only time

Extension: MindfulnessPreferredGuide
Id: mindfulness-preferred-guide
Title: "Mindfulness Preferred Guide"
Description: "Preferred guide for mindfulness sessions"
* value[x] only string

Extension: MindfulnessNotificationEnabled
Id: mindfulness-notification-enabled
Title: "Mindfulness Notification Enabled"
Description: "Whether notifications are enabled for mindfulness sessions"
* value[x] only boolean

Profile: MindfulnessConfiguration
Parent: Basic
Id: mindfulness-configuration
Title: "Mindfulness Configuration"
Description: "Configuration settings for mindfulness sessions"

* code 1..1 MS
* code = http://example.org/CodeSystem/mindfulness-config-type#settings "Mindfulness Settings"

* extension contains
    MindfulnessSessionDuration named sessionDuration 1..1 MS and
    MindfulnessReminderTime named reminderTime 1..1 MS and
    MindfulnessPreferredGuide named preferredGuide 0..1 MS and
    MindfulnessNotificationEnabled named notificationEnabled 1..1 MS

Instance: DefaultMindfulnessConfig
InstanceOf: MindfulnessConfiguration
Title: "Default Mindfulness Configuration"
Description: "Default configuration settings for mindfulness sessions"

* code = http://example.org/CodeSystem/mindfulness-config-type#settings "Mindfulness Settings"
* extension[sessionDuration].valueInteger = 15
* extension[reminderTime].valueTime = "08:00:00"
* extension[preferredGuide].valueString = "Jane Smith"
* extension[notificationEnabled].valueBoolean = true



// ===== Conteúdo de: MindfulnessAuditConfig.fsh =====

Extension: MindfulnessAuditLevel
Id: mindfulness-audit-level
Title: "Mindfulness Audit Level"
Description: "Level of detail for audit records"
* value[x] only code
* valueCode from http://example.org/fhir/ValueSet/audit-levels (required)

Extension: MindfulnessAuditRetention
Id: mindfulness-audit-retention
Title: "Mindfulness Audit Retention"
Description: "Period to retain audit records"
* value[x] only Duration

Extension: MindfulnessAuditFormat
Id: mindfulness-audit-format
Title: "Mindfulness Audit Format"
Description: "Format for audit records"
* value[x] only code
* valueCode from http://example.org/fhir/ValueSet/audit-formats (required)

Profile: MindfulnessAuditConfig
Parent: Basic
Id: mindfulness-audit-config
Title: "Mindfulness Audit Configuration"
Description: "Configuration for mindfulness session auditing"

* code 1..1 MS
* code = http://example.org/CodeSystem/mindfulness-config-type#audit "Audit Configuration"

* extension contains
    MindfulnessAuditLevel named auditLevel 1..1 MS and
    MindfulnessAuditRetention named auditRetention 1..1 MS and
    MindfulnessAuditFormat named auditFormat 1..1 MS

Instance: DefaultAuditConfig
InstanceOf: MindfulnessAuditConfig
Title: "Default Audit Configuration"
Description: "Default configuration for mindfulness session auditing"

* code = http://example.org/CodeSystem/mindfulness-config-type#audit "Audit Configuration"
* extension[auditLevel].valueCode = #detailed
* extension[auditRetention].valueDuration = 90 'days'
* extension[auditFormat].valueCode = #fhir



// ===== Conteúdo de: MindfulnessSecurity.fsh =====

Instance: MindfulnessSecurityDefinition
InstanceOf: Consent
Usage: #definition
Title: "Mindfulness Data Security Policy"

* status = #active
* scope = http://terminology.hl7.org/CodeSystem/consentscope#patient-privacy
* category = http://loinc.org#59284-0 "Consent Document"

* policy[0]
  * authority = "http://example.org/privacy-policy"
  * uri = "http://example.org/mindfulness-privacy"

* provision
  * type = #permit
  * period
    * start = "2024-03-19"
  * actor[0]
    * role = http://terminology.hl7.org/CodeSystem/v3-ParticipationType#PRCP
    * reference
      * identifier.system = "http://example.org/practitioners"
      * identifier.value = "mindfulness-practitioners"

RuleSet: SecurityRequirements
* meta.security from http://terminology.hl7.org/ValueSet/v3-SecurityPolicy (required)
* meta.tag from http://terminology.hl7.org/ValueSet/v3-Confidentiality (required)

* extension contains
    http://hl7.org/fhir/StructureDefinition/resource-security-category named securityCategory 0..1 MS and
    http://hl7.org/fhir/StructureDefinition/patient-confidentiality named confidentiality 0..1 MS

Instance: MindfulnessAccessPolicy
InstanceOf: Consent
Usage: #definition
Title: "Mindfulness Data Access Policy"

* status = #active
* scope = http://terminology.hl7.org/CodeSystem/consentscope#patient-privacy
* category = http://loinc.org#59284-0 "Consent Document"

* policy[0]
  * authority = "http://example.org/access-policy"
  * uri = "http://example.org/mindfulness-access"

* provision
  * type = #permit
  * period
    * start = "2024-03-19"
  * actor[0]
    * role = http://terminology.hl7.org/CodeSystem/v3-ParticipationType#PRCP
    * reference
      * identifier.system = "http://example.org/practitioners"
      * identifier.value = "mindfulness-practitioners"
  * action = http://terminology.hl7.org/CodeSystem/consentaction#access "Access"



// ===== Conteúdo de: MindfulnessResources.fsh =====

CodeSystem: MindfulnessTypeCS
Id: mindfulness-type-cs
Title: "Mindfulness Practice Types"
Description: "Types of mindfulness practices and techniques"
* ^experimental = false
* ^caseSensitive = true
* #meditation "Meditation" "Focused meditation practice"
* #breathing "Breathing Exercise" "Conscious breathing techniques"
* #bodyScan "Body Scan" "Progressive body awareness practice"
* #walking "Mindful Walking" "Walking meditation practice"
* #movement "Mindful Movement" "Conscious movement practice"

CodeSystem: EnvironmentTypeCS
Id: environment-type-cs
Title: "Practice Environment Types"
Description: "Types of environments for mindfulness practice"
* ^experimental = false
* ^caseSensitive = true
* #indoor "Indoor" "Indoor environment"
* #outdoor "Outdoor" "Outdoor environment"
* #quiet "Quiet Space" "Quiet or silent environment"
* #group "Group Setting" "Group practice environment"

ValueSet: MindfulnessTypeVS
Id: mindfulness-type-vs
Title: "Mindfulness Practice Types Value Set"
Description: "Value set of mindfulness practice types"
* ^experimental = false
* include codes from system MindfulnessTypeCS

ValueSet: EnvironmentTypeVS
Id: environment-type-vs
Title: "Practice Environment Types Value Set"
Description: "Value set of practice environment types"
* ^experimental = false
* include codes from system EnvironmentTypeCS

Instance: MindfulnessSettingCS
InstanceOf: CodeSystem
Usage: #definition
* url = "http://example.org/CodeSystem/mindfulness-setting"
* version = "1.0.0"
* name = "MindfulnessSettingCS"
* title = "Mindfulness Setting CodeSystem"
* status = #active
* experimental = false
* caseSensitive = true
* content = #complete
* count = 5
* concept[+].code = #home
* concept[=].display = "Home Practice"
* concept[+].code = #clinic
* concept[=].display = "Clinical Setting"
* concept[+].code = #group
* concept[=].display = "Group Setting"
* concept[+].code = #retreat
* concept[=].display = "Retreat Setting"
* concept[+].code = #workplace
* concept[=].display = "Workplace Setting"



// ===== Conteúdo de: MindfulnessNarrative.fsh =====

RuleSet: MindfulnessObservationNarrative
* text.status = #generated
* text.div = "<div xmlns=\"http://www.w3.org/1999/xhtml\">
    <p><b>Generated Narrative</b></p>
    <p><b>Session Type:</b> Mindfulness Practice Session</p>
    <p><b>Date:</b> {effectiveDateTime}</p>
    <p><b>Duration:</b> {component[sessionDuration].value} minutes</p>
    <p><b>Stress Level:</b> {component[stressLevel].value} / 10</p>
    <p><b>Mood:</b> {component[moodState].value}</p>
    <p><b>Technique:</b> {component[relaxationResponse].value}</p>
    <p><b>Location:</b> {extension[mindfulness-context].extension[location].value}</p>
  </div>"

RuleSet: MindfulnessQuestionnaireNarrative
* text.status = #generated
* text.div = "<div xmlns=\"http://www.w3.org/1999/xhtml\">
    <p><b>Generated Narrative</b></p>
    <p><b>Title:</b> {title}</p>
    <p><b>Status:</b> {status}</p>
    <h3>Sections</h3>
    <ul>
      <li>Mindfulness Session</li>
      <li>Mood Assessment</li>
      <li>Stress Assessment</li>
      <li>Relaxation</li>
    </ul>
  </div>"

RuleSet: MindfulnessResponseNarrative
* text.status = #generated
* text.div = "<div xmlns=\"http://www.w3.org/1999/xhtml\">
    <p><b>Generated Narrative</b></p>
    <p><b>Date:</b> {authored}</p>
    <p><b>Session Duration:</b> {item[session_duration].answer.value} minutes</p>
    <p><b>Practice Type:</b> {item[practice_type].answer.value}</p>
    <p><b>Mood:</b> {item[current_mood].answer.value}</p>
    <p><b>Stress Level:</b> {item[stress_level].answer.value} / 10</p>
    <p><b>Relaxation Technique:</b> {item[relaxation_technique].answer.value}</p>
  </div>"

RuleSet: MindfulnessConfigNarrative
* text.status = #generated
* text.div = "<div xmlns=\"http://www.w3.org/1999/xhtml\">
    <p><b>Generated Narrative</b></p>
    <p><b>Default Duration:</b> {extension[defaultDuration].value} minutes</p>
    <p><b>Reminders:</b> {extension[reminderSettings].value}</p>
    <p><b>Data Sync:</b> {extension[dataSync].value}</p>
  </div>"



// ===== Conteúdo de: StressInvariants.fsh =====

Invariant: stress-level-range
Description: "Stress level score must be between 0 and 10"
Expression: "valueQuantity.exists() implies (valueQuantity.value >= 0 and valueQuantity.value <= 10)"
Severity: #error

Invariant: stress-component-consistency
Description: "Physiological and psychological stress scores must be consistent with overall score"
Expression: "component.where(code.coding.code='89593-8').value.exists() and component.where(code.coding.code='89594-6').value.exists() implies (component.where(code.coding.code='89593-8').value + component.where(code.coding.code='89594-6').value) div 2 = valueQuantity"
Severity: #warning



// ===== Conteúdo de: SocialInteractionInvariants.fsh =====

Invariant: social-interaction-duration
Description: "Social interaction duration must be positive"
Expression: "component.where(code.coding.code='89597-9').value.exists() implies component.where(code.coding.code='89597-9').value > 0"
Severity: #error

Invariant: social-interaction-participants
Description: "Number of participants must be at least 2 for social interaction"
Expression: "component.where(code.coding.code='89600-1').value.exists() implies component.where(code.coding.code='89600-1').value >= 2"
Severity: #error



// ===== Conteúdo de: MindfulnessInvariants.fsh =====

Invariant: mindfulness-session-duration
Description: "Mindfulness session duration must be between 1 and 180 minutes"
Expression: "component.where(code.coding.system='http://snomed.info/sct' and code.coding.code='118682006').value.ofType(Quantity).value.exists() implies (component.where(code.coding.system='http://snomed.info/sct' and code.coding.code='118682006').value.ofType(Quantity).value >= 1 and component.where(code.coding.system='http://snomed.info/sct' and code.coding.code='118682006').value.ofType(Quantity).value <= 180)"
Severity: #error

Invariant: mindfulness-stress-level
Description: "Stress level must be between 0 and 10"
Expression: "component.where(code.coding.system='http://snomed.info/sct' and code.coding.code='725854004').value.ofType(Integer).exists() implies (component.where(code.coding.system='http://snomed.info/sct' and code.coding.code='725854004').value.ofType(Integer) >= 0 and component.where(code.coding.system='http://snomed.info/sct' and code.coding.code='725854004').value.ofType(Integer) <= 10)"
Severity: #error

Invariant: mindfulness-mood-required
Description: "Mood assessment must include a mood state and intensity"
Expression: "component.where(code.coding.system='http://snomed.info/sct' and code.coding.code='373931001').exists() implies component.where(code.coding.system='http://snomed.info/sct' and code.coding.code='373931001').value.exists()"
Severity: #warning

Invariant: mindfulness-context-complete
Description: "Mindfulness context should include location and environment"
Expression: "extension.where(url='https://example.org/StructureDefinition/mindfulness-context').exists() implies (extension.where(url='https://example.org/StructureDefinition/mindfulness-context').extension.where(url='location').exists() and extension.where(url='https://example.org/StructureDefinition/mindfulness-context').extension.where(url='environment').exists())"
Severity: #warning

Invariant: sequential-measurements
Description: "Sequential measurements must have increasing effectiveDateTime"
Expression: "component.where(code.coding.system='http://snomed.info/sct' and code.coding.code='118682006').exists() implies (effectiveDateTime > previous().effectiveDateTime)"
Severity: #warning



// ===== Conteúdo de: MindfulnessOperations.fsh =====

Profile: MindfulnessOperation
Parent: OperationDefinition 
Id: mindfulness-operation
Title: "Mindfulness Operation"
Description: "Base definition for mindfulness operations"

* status 1..1
* kind 1..1
* name 1..1
* code 1..1
* resource 1..1
* system 1..1
* type 1..1
* instance 1..1
* parameter 0..*
* parameter.name 1..1

Instance: StartSessionOperation
InstanceOf: MindfulnessOperation
Title: "Start Session Operation"
Description: "Operation to start a new mindfulness session"

* status = #active
* kind = #operation
* name = "start-session"
* code = #start
* resource = #Observation
* system = false
* type = true
* instance = false
* parameter[+]
  * name = #duration
  * use = #in
  * min = 1
  * max = "1" 
  * type = #integer
  * documentation = "Duration in minutes"

Instance: EndSessionOperation
InstanceOf: MindfulnessOperation
Title: "End Session Operation"
Description: "Operation to end an ongoing mindfulness session"

* status = #active
* kind = #operation
* name = "end-session"
* code = #end
* resource = #Observation
* system = false
* type = true
* instance = true
* parameter[+]
  * name = #session
  * use = #in
  * min = 1
  * max = "1"
  * type = #string
  * documentation = "ID of the session to end"



// ===== Conteúdo de: VitalSignsExtensions.fsh =====

Extension: MeasurementContext
Id: measurement-context
Title: "Measurement Context Extension"
Description: "Additional context about the vital sign measurement"
* value[x] only CodeableConcept
* valueCodeableConcept from MeasurementContextVS (required)

ValueSet: MeasurementContextVitalSigns
Id: measurement-context-vital-signs
Title: "Measurement Context Value Set"
* $SCT#255214003 "At rest"
* $SCT#309604004 "During exercise"
* $SCT#309605003 "Post exercise"
* $SCT#248626006 "During sleep"



// ===== Conteúdo de: NutritionExtensions.fsh =====

Extension: NutritionDataSource
Id: nutrition-data-source
Title: "Nutrition Data Source Extension"
Description: "Indicates the source of nutrition data"

* ^version = "0.1.0"
* ^status = #draft
* ^experimental = false
* ^date = "2024-12-14"
* ^publisher = "Ricardo Lourenço dos Santos"
* ^context[0].type = #element
* ^context[0].expression = "Observation"

* value[x] only CodeableConcept
* valueCodeableConcept from NutritionDataSourceVS (required)

ValueSet: NutritionDataSourceVS
Id: nutrition-data-source-vs
Title: "Nutrition Data Source Value Set"
Description: "Value set for nutrition data sources"

* ^version = "0.1.0"
* ^status = #draft
* ^experimental = false
* ^date = "2024-12-14"
* ^publisher = "Ricardo Lourenço dos Santos"

* codes from system NutritionDataSourceCS

CodeSystem: NutritionDataSourceCS
Id: nutrition-data-source-cs
Title: "Nutrition Data Source Code System"
Description: "Code system for nutrition data sources"

* ^version = "0.1.0"
* ^status = #draft
* ^experimental = false
* ^date = "2024-12-14"
* ^publisher = "Ricardo Lourenço dos Santos"
* ^caseSensitive = true

* #manual "Manual Entry" "Data entered manually by user"
* #app "App Integration" "Data from integrated third-party apps"
* #device "Connected Device" "Data from connected nutrition tracking devices"
* #questionnaire "Questionnaire Response" "Data collected through questionnaires"



// ===== Conteúdo de: AdvancedVitalSignsExtensions.fsh =====

Alias: $UCUM = http://unitsofmeasure.org

Extension: PhysiologicalStressIndex
Id: physiological-stress-index
Title: "Physiological Stress Index Extension"
Description: "Index representing overall physiological stress based on multiple parameters"

* ^version = "0.1.0"
* ^status = #draft
* ^context[+].type = #element
* ^context[=].expression = "Observation"

* value[x] only Quantity
* valueQuantity.system = $UCUM
* valueQuantity.code = #{index}
* valueQuantity ^short = "Physiological stress index value"
* valueQuantity ^definition = "Normalized index value representing overall physiological stress"

Extension: HomeostasisIndex
Id: homeostasis-index
Title: "Homeostasis Index Extension"
Description: "Composite measure of physiological balance and adaptation"

* ^version = "0.1.0"
* ^status = #draft
* ^context[+].type = #element
* ^context[=].expression = "Observation"

* value[x] only Quantity
* valueQuantity.system = $UCUM
* valueQuantity.code = #{ratio}
* valueQuantity ^short = "Homeostasis index value"
* valueQuantity ^definition = "Normalized ratio representing physiological balance"

Extension: RecoveryEfficiency
Id: recovery-efficiency
Title: "Recovery Efficiency Extension"
Description: "Measure of how efficiently the body recovers from stress or exertion"

* ^version = "0.1.0"
* ^status = #draft
* ^context[+].type = #element
* ^context[=].expression = "Observation"

* value[x] only Quantity
* valueQuantity.system = $UCUM
* valueQuantity.code = #%
* valueQuantity ^short = "Recovery efficiency percentage"
* valueQuantity ^definition = "Percentage indicating recovery efficiency"

Extension: AllostaticLoad
Id: allostatic-load
Title: "Allostatic Load Extension"
Description: "Measure of cumulative physiological burden over time"

* ^version = "0.1.0"
* ^status = #draft
* ^context[+].type = #element
* ^context[=].expression = "Observation"

* value[x] only Quantity
* valueQuantity.system = $UCUM
* valueQuantity.code = #{score}
* valueQuantity ^short = "Allostatic load score"
* valueQuantity ^definition = "Score representing cumulative physiological burden"

Extension: CircadianPhase
Id: circadian-phase
Title: "Circadian Phase Extension"
Description: "Indicator of position in circadian rhythm cycle"

* ^version = "0.1.0"
* ^status = #draft
* ^context[+].type = #element
* ^context[=].expression = "Observation"

* value[x] only CodeableConcept
* valueCodeableConcept from CircadianPhaseVS (required)

ValueSet: CircadianPhaseVS
Id: circadian-phase-vs
Title: "Circadian Phase Value Set"
Description: "Value set for circadian rhythm phases"

* ^experimental = true
* codes from system CircadianPhaseCS

CodeSystem: CircadianPhaseCS
Id: circadian-phase-cs
Title: "Circadian Phase Code System"
Description: "Code system for circadian rhythm phases"

* ^experimental = true
* ^caseSensitive = true

* #early-morning "Early Morning Phase" "Period shortly after awakening"
* #mid-morning "Mid Morning Phase" "Mid-morning period"
* #afternoon "Afternoon Phase" "Afternoon period"
* #evening "Evening Phase" "Evening period"
* #night "Night Phase" "Nighttime period"
* #deep-night "Deep Night Phase" "Deep night period"

Extension: MeasurementQuality
Id: measurement-quality
Title: "Measurement Quality Extension"
Description: "Indicator of the quality and reliability of the measurement"

* ^version = "0.1.0"
* ^status = #draft
* ^context[+].type = #element
* ^context[=].expression = "Observation"

* value[x] only CodeableConcept
* valueCodeableConcept from MeasurementQualityVS (required)

ValueSet: MeasurementQualityVS
Id: measurement-quality-vs
Title: "Measurement Quality Value Set"
Description: "Value set for measurement quality indicators"

* ^experimental = true
* codes from system MeasurementQualityCS

CodeSystem: MeasurementQualityCS
Id: measurement-quality-cs
Title: "Measurement Quality Code System"
Description: "Code system for measurement quality indicators"

* ^experimental = true
* ^caseSensitive = true

* #excellent "Excellent Quality" "High quality measurement with minimal noise"
* #good "Good Quality" "Good quality measurement with acceptable noise"
* #fair "Fair Quality" "Fair quality measurement with some interference"
* #poor "Poor Quality" "Poor quality measurement with significant interference"
* #unreliable "Unreliable" "Unreliable measurement requiring verification"



// ===== Conteúdo de: StressExtensions.fsh =====

Extension: StressTriggers
Id: stress-triggers
Title: "Stress Triggers Extension"
Description: "Extension for recording identified stress triggers"
* value[x] only CodeableConcept
* valueCodeableConcept from StressTriggersVS (required)

Extension: StressCoping
Id: stress-coping
Title: "Stress Coping Extension"
Description: "Extension for recording stress coping mechanisms"
* value[x] only CodeableConcept
* valueCodeableConcept from StressCopingVS (required)

ValueSet: StressTriggersVS
Id: stress-triggers-vs
Title: "Stress Triggers Value Set"
Description: "Value set for common stress triggers"
* codes from system StressTriggersCS

ValueSet: StressCopingVS
Id: stress-coping-vs
Title: "Stress Coping Value Set"
Description: "Value set for stress coping mechanisms"
* codes from system StressCopingCS

CodeSystem: StressTriggersCS
Id: stress-triggers-cs
Title: "Stress Triggers Code System"
Description: "Code system for common stress triggers"
* #work "Work-related" "Stress from work or professional activities"
* #financial "Financial" "Financial-related stress"
* #relationships "Relationships" "Stress from personal relationships"
* #health "Health" "Health-related concerns"
* #environment "Environmental" "Environmental factors"
* #time "Time Management" "Time pressure and deadlines"
* #change "Life Changes" "Major life changes or transitions"

CodeSystem: StressCopingCS
Id: stress-coping-cs
Title: "Stress Coping Code System"
Description: "Code system for stress coping mechanisms"
* #exercise "Physical Exercise" "Using exercise to manage stress"
* #meditation "Meditation" "Meditation and mindfulness practices"
* #social "Social Support" "Seeking social support"
* #professional "Professional Help" "Seeking professional assistance"
* #relaxation "Relaxation" "Relaxation techniques"
* #creative "Creative Activities" "Engaging in creative activities"
* #nature "Nature" "Spending time in nature"



// ===== Conteúdo de: EnvironmentalExtensions.fsh =====

Extension: ExposureLocation
Id: exposure-location
Title: "Exposure Location Extension"
Description: "Extension for recording location of environmental exposure measurement"

* ^version = "0.1.0"
* ^status = #draft
* ^context[+].type = #element
* ^context[=].expression = "Observation"

* value[x] only CodeableConcept
* valueCodeableConcept from ExposureLocationVS (required)
* valueCodeableConcept ^short = "Location type of exposure"
* valueCodeableConcept ^definition = "Categorizes the type of location where environmental exposure occurred"

Extension: ExposureConditions
Id: exposure-conditions
Title: "Exposure Conditions Extension"
Description: "Additional conditions during environmental exposure measurement"

* ^version = "0.1.0"
* ^status = #draft
* ^context[+].type = #element
* ^context[=].expression = "Observation"

* value[x] only CodeableConcept
* valueCodeableConcept from ExposureConditionsVS (required)
* valueCodeableConcept ^short = "Conditions during exposure"

ValueSet: ExposureLocationVS
Id: exposure-location-vs
Title: "Exposure Location Value Set"
Description: "Value set for environmental exposure locations"

* ^version = "0.1.0"
* ^status = #draft
* ^experimental = true
* codes from system ExposureLocationCS

ValueSet: ExposureConditionsVS
Id: exposure-conditions-vs
Title: "Exposure Conditions Value Set"
Description: "Value set for environmental exposure conditions"

* ^version = "0.1.0"
* ^status = #draft
* ^experimental = true
* codes from system ExposureConditionsCS

CodeSystem: ExposureLocationCS
Id: exposure-location-cs
Title: "Exposure Location Code System"
Description: "Code system for environmental exposure locations"

* ^version = "0.1.0"
* ^status = #draft
* ^caseSensitive = true
* ^experimental = true

* #indoor "Indoor environment" "Environment within buildings or enclosed spaces"
* #outdoor "Outdoor environment" "Open-air environment"
* #workplace "Workplace" "Professional or occupational environment"
* #transit "In transit" "While in transportation or commuting"
* #recreational "Recreational area" "Leisure or sports facilities"
* #urban "Urban area" "City or densely populated area"
* #rural "Rural area" "Countryside or sparsely populated area"

CodeSystem: ExposureConditionsCS
Id: exposure-conditions-cs
Title: "Exposure Conditions Code System"
Description: "Code system for conditions during environmental exposure"

* ^version = "0.1.0"
* ^status = #draft
* ^caseSensitive = true
* ^experimental = true

* #normal "Normal conditions" "Standard environmental conditions"
* #extreme "Extreme conditions" "Unusual or severe environmental conditions"
* #controlled "Controlled environment" "Environment with controlled conditions"
* #variable "Variable conditions" "Changing environmental conditions"



// ===== Conteúdo de: BodyMetricsExtensions.fsh =====

Alias: $SCT = http://snomed.info/sct

Extension: MeasurementConditions
Id: measurement-conditions
Title: "Measurement Conditions Extension"
Description: "Records the conditions under which body measurements were taken"

* ^version = "0.1.0"
* ^status = #draft
* ^context[0].type = #element
* ^context[0].expression = "Observation"

* value[x] only CodeableConcept
* valueCodeableConcept from MeasurementConditionsVS (required)

Extension: MeasurementDevice
Id: measurement-device-type
Title: "Measurement Device Type Extension"
Description: "Specifies the type of device used for body measurements"

* ^version = "0.1.0"
* ^status = #draft
* ^context[0].type = #element
* ^context[0].expression = "Observation"

* value[x] only CodeableConcept
* valueCodeableConcept from MeasurementDeviceTypeVS (required)

ValueSet: MeasurementConditionsVS
Id: measurement-conditions-vs
Title: "Measurement Conditions Value Set"
Description: "Standard conditions under which measurements are taken"

* ^version = "0.1.0"
* ^status = #draft

* $SCT#307818003 "Pre-breakfast"
* $SCT#307819006 "Post-exercise"
* $SCT#307820000 "Wearing light clothing"
* $SCT#255203001 "First thing in morning"
* $SCT#255214005 "After void"
* $SCT#309604004 "During rest"

ValueSet: MeasurementDeviceTypeVS
Id: measurement-device-type-vs
Title: "Measurement Device Type Value Set"
Description: "Types of devices used for health and body measurements"

* ^version = "0.1.0"
* ^status = #draft

* $SCT#469576000 "Smart watch"
* $SCT#706767009 "Body composition analyzer"
* $SCT#131009002 "Height measuring device"
* $SCT#706889009 "Blood pressure monitor"
* $SCT#444699000 "Tape measure"
* $SCT#44056008  "Digital scale"

Instance: WeightWithConditions
InstanceOf: WeightObservation
Usage: #example
Title: "Weight Measurement with Conditions Example"

* status = #final
* category = http://terminology.hl7.org/CodeSystem/observation-category#vital-signs
* code = $LOINC#29463-7 "Body weight"
* subject = Reference(Patient/example)
* effectiveDateTime = "2024-03-19T08:00:00Z"
* valueQuantity = 70.5 'kg'

* extension[measurement-conditions].url = "https://github.com/RicardoLSantos/shorthand/StructureDefinition/measurement-conditions"
* extension[measurement-conditions].valueCodeableConcept = $SCT#307818003 "Pre-breakfast"

* extension[measurement-device-type].url = "https://github.com/RicardoLSantos/shorthand/StructureDefinition/measurement-device-type"
* extension[measurement-device-type].valueCodeableConcept = $SCT#469576000 "Smart scale device"



// ===== Conteúdo de: SleepQuality.fsh =====

Extension: SleepQuality
Id: sleep-quality
Title: "Sleep Quality Extension"
Description: "Extension for recording subjective sleep quality"
* value[x] only CodeableConcept
* valueCodeableConcept from SleepQualityExtendedVS (required)
 
ValueSet: SleepQualityExtendedVS
Id: sleep-quality-extended-vs
Title: "Sleep Quality Value Set"
* $SCT#248220008 "Very good quality sleep"
* $SCT#248221007 "Good quality sleep"
* $SCT#248222000 "Poor quality sleep"
* $SCT#248223005 "Very poor quality sleep"



// ===== Conteúdo de: MindfulnessExtensions.fsh =====

Extension: MindfulnessContext
Id: mindfulness-context
Title: "Mindfulness Session Context"
Description: "Additional context about the mindfulness practice session"

* ^url = "https://example.org/StructureDefinition/mindfulness-context"
* ^version = "1.0.0"
* ^status = #draft
* ^date = "2024-03-19"
* ^publisher = "Example Organization"

* extension contains
    location 0..1 and
    environment 0..1 and
    guidance 0..1

* extension[location].value[x] only string
* extension[location].valueString 1..1
* extension[location] ^short = "Physical location of practice"
* extension[location] ^definition = "The physical location where the mindfulness practice took place"

* extension[environment].value[x] only CodeableConcept
* extension[environment].valueCodeableConcept from http://example.org/ValueSet/environment-type (required)
* extension[environment] ^short = "Environmental conditions"
* extension[environment] ^definition = "The environmental conditions during the practice session"

* extension[guidance].value[x] only boolean
* extension[guidance].valueBoolean 1..1
* extension[guidance] ^short = "Whether guidance was used"
* extension[guidance] ^definition = "Indicates if the session was guided or self-directed"



// ===== Conteúdo de: SocialInteractionExtensions.fsh =====

Extension: SocialContext
Id: social-context
Title: "Social Context Extension"
Description: "Extension for recording the context of social interaction"
* value[x] only CodeableConcept
* valueCodeableConcept from SocialContextVS (required)

Extension: SocialSupport
Id: social-support
Title: "Social Support Extension"
Description: "Extension for recording perceived social support"
* value[x] only CodeableConcept
* valueCodeableConcept from SocialSupportVS (required)

Extension: SocialActivity
Id: social-activity
Title: "Social Activity Extension"
Description: "Extension for recording specific social activities"
* value[x] only CodeableConcept
* valueCodeableConcept from SocialActivityVS (required)

ValueSet: SocialContextVS
Id: social-context-vs
Title: "Social Context Value Set"
Description: "Value set for social interaction contexts"
* codes from system SocialContextCS

ValueSet: SocialSupportVS
Id: social-support-vs
Title: "Social Support Value Set"
Description: "Value set for levels of social support"
* codes from system SocialSupportCS

ValueSet: SocialActivityVS
Id: social-activity-vs
Title: "Social Activity Value Set"
Description: "Value set for types of social activities"
* codes from system SocialActivityCS

CodeSystem: SocialContextCS
Id: social-context-cs
Title: "Social Context Code System"
Description: "Code system for social interaction contexts"
* #home "Home" "Home environment"
* #work "Work" "Work environment"
* #education "Educational" "Educational setting"
* #community "Community" "Community setting"
* #recreational "Recreational" "Recreational setting"
* #healthcare "Healthcare" "Healthcare setting"

CodeSystem: SocialSupportCS
Id: social-support-cs
Title: "Social Support Code System"
Description: "Code system for levels of social support"
* #strong "Strong Support" "Strong social support network"
* #adequate "Adequate Support" "Sufficient social support"
* #limited "Limited Support" "Limited social support"
* #minimal "Minimal Support" "Minimal social support"
* #none "No Support" "Absence of social support"

CodeSystem: SocialActivityCS
Id: social-activity-cs
Title: "Social Activity Code System"
Description: "Code system for types of social activities"
* #meal "Shared Meal" "Sharing a meal together"
* #exercise "Group Exercise" "Group physical activity"
* #entertainment "Entertainment" "Shared entertainment activity"
* #learning "Learning" "Group learning activity"
* #volunteering "Volunteering" "Community service activity"
* #celebration "Celebration" "Social celebration or event"



// ===== Conteúdo de: SleepExtensions.fsh =====




// ===== Conteúdo de: MobilityExtensions.fsh =====

Extension: MobilityAlertLevel
Id: mobility-alert-level
Title: "Mobility Alert Level Extension"
Description: "Extension for mobility measurements alert levels to indicate the severity or concern level of mobility changes detected by the device"
* ^status = #active
* ^context[0].type = #element
* ^context[0].expression = "Observation"
* . ^short = "Mobility alert level indicator"
* . ^definition = "Indicates the severity level of mobility changes or concerns based on device measurements"
* value[x] only CodeableConcept
* valueCodeableConcept from MobilityAlertLevelVS (required)
* valueCodeableConcept ^short = "Alert level code"
* valueCodeableConcept ^definition = "The specific alert level code indicating the severity of mobility changes"

ValueSet: MobilityAlertLevelVS
Id: mobility-alert-level-vs
Title: "Mobility Alert Level Value Set"
Description: "Value set for mobility measurement alert levels used to categorize the severity of mobility changes or concerns"
* ^status = #active
* ^experimental = false
* ^purpose = "To provide standardized alert levels for mobility measurements"
* codes from system MobilityAlertLevelCS

CodeSystem: MobilityAlertLevelCS
Id: mobility-alert-level-cs
Title: "Mobility Alert Level Code System"
Description: "Code system defining alert levels for mobility measurements, indicating the severity of changes in mobility patterns"
* ^status = #active
* ^experimental = false
* ^caseSensitive = true
* ^content = #complete
* #green "Normal - No concern" "Mobility measurements are within normal range and show no concerning patterns"
* #yellow "Caution - Monitor closely" "Mobility measurements show slight deviations that warrant closer monitoring"
* #red "Alert - Significant change" "Mobility measurements indicate significant changes that require immediate attention"
* ^property[0].code = #status
* ^property[0].type = #code
* ^property[0].description = "The status of the alert level"
* ^property[1].code = #severity
* ^property[1].type = #integer
* ^property[1].description = "Numeric value indicating severity (1=low, 3=high)"



// ===== Conteúdo de: ActivityExtensions.fsh =====




// ===== Conteúdo de: MobilityRiskValueSets.fsh =====

ValueSet: FallRiskOutcomesValueSet
Id: fall-risk-outcomes
Title: "Fall Risk Outcomes Value Set"
Description: "Value set for fall risk assessment outcomes"
* ^url = "http://example.org/fhir/ValueSet/fall-risk-outcomes"
* ^status = #active
* include codes from system http://example.org/fhir/CodeSystem/fall-risk-outcomes

ValueSet: RiskLevelValueSet
Id: risk-level
Title: "Risk Level Value Set"
Description: "Value set for general risk levels"
* ^url = "http://example.org/fhir/ValueSet/risk-level"
* ^status = #active
* include codes from system http://example.org/fhir/CodeSystem/risk-level

ValueSet: MobilityDeclineOutcomesValueSet
Id: mobility-decline-outcomes
Title: "Mobility Decline Outcomes Value Set"
Description: "Value set for mobility decline assessment outcomes"
* ^url = "http://example.org/fhir/ValueSet/mobility-decline-outcomes"
* ^status = #active
* include codes from system http://example.org/fhir/CodeSystem/mobility-decline-outcomes

ValueSet: AssistanceLevelOutcomesValueSet
Id: assistance-level-outcomes
Title: "Assistance Level Outcomes Value Set"
Description: "Value set for assistance level assessment outcomes"
* ^url = "http://example.org/fhir/ValueSet/assistance-level-outcomes"
* ^status = #active
* include codes from system http://example.org/fhir/CodeSystem/assistance-level-outcomes



// ===== Conteúdo de: SymptomValueSets.fsh =====

CodeSystem: SymptomSeverityCS
Id: symptom-severity-cs
Title: "Symptom Severity Code System"
Description: "Severity levels for symptoms"

* #1-3 "Light" "Symptom barely noticeable"
* #4-6 "Mild" "Symptom noticeable but not interfering with daily activities"
* #7-8 "Intense" "Symptom interfering with daily activities"
* #9-10 "Severe" "Symptom preventing daily activities"

ValueSet: BodyLocationsVS
Id: body-locations-vs
Title: "Body Locations Value Set"
Description: "Anatomical locations for symptom recording"
* $SCT#12738006 "Brain"
* $SCT#69536005 "Head"
* $SCT#45048000 "Neck"
* $SCT#51185008 "Chest"
* $SCT#62413002 "Abdomen"
* $SCT#32849002 "Back"
* $SCT#53120007 "Upper limb"
* $SCT#61685007 "Lower limb"

ValueSet: DurationUnitsVS
Id: duration-units-vs
Title: "Duration Units Value Set"
Description: "Time units for symptom duration"
* $UCUM#min "Minutes"
* $UCUM#h "Hours"
* $UCUM#d "Days"
* $UCUM#wk "Weeks"
* $UCUM#mo "Months"

CodeSystem: SymptomFrequencyCS
Id: symptom-frequency-cs
Title: "Symptom Frequency Code System"
Description: "Frequency patterns for symptoms"
* #rare "Rare" "Less than once per month"
* #occasional "Occasional" "Several times per month"
* #frequent "Frequent" "Several times per week"
* #daily "Daily" "Once or more per day"
* #constant "Constant" "Present most of the time"

ValueSet: SymptomFrequencyVS
Id: symptom-frequency-vs
Title: "Symptom Frequency Value Set"
Description: "Frequency patterns for symptoms"
* codes from system SymptomFrequencyCS

CodeSystem: SymptomImpactCS
Id: symptom-impact-cs
Title: "Symptom Impact Code System"
Description: "Impact levels of symptoms on daily activities"
* #none "No impact"
* #mild "Mild impact"
* #moderate "Moderate impact"
* #severe "Severe impact"
* #complete "Complete impact"

ValueSet: SymptomImpactVS
Id: symptom-impact-vs
Title: "Symptom Impact Value Set"
Description: "Impact levels for symptoms"
* codes from system SymptomImpactCS

ValueSet: SymptomProgressionVS
Id: symptom-progression-vs
Title: "Symptom Progression Value Set"
Description: "Progression patterns for symptoms"
* $SCT#385633008 "Improving"
* $SCT#58158008 "Stable"
* $SCT#230993007 "Worsening"
* $SCT#255314001 "Fluctuating"

ValueSet: TimeOfDayVS
Id: time-of-day-vs
Title: "Time of Day Value Set"
Description: "Times of day for symptom occurrence"
* $SCT#73775008 "Morning"
* $SCT#255253008 "Afternoon"
* $SCT#2546009 "Evening"
* $SCT#73768005 "Night"



// ===== Conteúdo de: StressValueSets.fsh =====

ValueSet: StressChronicityVS
Id: stress-chronicity-vs
Title: "Stress Chronicity Value Set"
Description: "Value set for classifying stress chronicity"
* ^url = "https://github.com/RicardoLSantos/shorthand/ValueSet/stress-chronicity-vs"
* codes from system StressChronicityCS

ValueSet: StressImpactVS
Id: stress-impact-vs
Title: "Stress Impact Value Set"
Description: "Value set for describing stress impact levels"
* ^url = "https://github.com/RicardoLSantos/shorthand/ValueSet/stress-impact-vs"
* codes from system StressImpactCS

CodeSystem: StressChronicityCS
Id: stress-chronicity-cs
Title: "Stress Chronicity Code System"
Description: "Code system for stress chronicity classification"
* ^url = "https://github.com/RicardoLSantos/shorthand/CodeSystem/stress-chronicity-cs"
* #acute "Acute" "Short-term stress response"
* #subacute "Subacute" "Medium-term stress response"
* #chronic "Chronic" "Long-term stress response"
* #episodic "Episodic" "Recurring stress episodes"
* #persistent "Persistent" "Continuous stress state"

CodeSystem: StressImpactCS
Id: stress-impact-cs
Title: "Stress Impact Code System"
Description: "Code system for stress impact levels"
* ^url = "https://github.com/RicardoLSantos/shorthand/CodeSystem/stress-impact-cs"
* #minimal "Minimal Impact" "Little to no interference with daily activities"
* #mild "Mild Impact" "Some interference with daily activities"
* #moderate "Moderate Impact" "Significant interference with daily activities"
* #severe "Severe Impact" "Major interference with daily activities"
* #extreme "Extreme Impact" "Unable to perform daily activities"



// ===== Conteúdo de: ReproductiveValueSets.fsh =====

ValueSet: ReproductiveGoalVS
Id: reproductive-goal-vs
Title: "Reproductive Health Goals Value Set"
Description: "Goals related to reproductive health tracking and planning"

* ^status = #active
* ^experimental = false
* ^date = "2024-03-19"

* $LOINC#8708-0 "Menstrual cycle length"
* $LOINC#55284-4 "Blood pressure"
* $LOINC#8310-5 "Body temperature"
* $LOINC#8302-2 "Body height"
* $LOINC#29463-7 "Body weight"
* $SCT#364311006 "Menstrual cycle monitoring"
* $SCT#289530006 "Reproductive health finding"

ValueSet: ReproductiveActivityVS
Id: reproductive-activity-vs
Title: "Reproductive Health Activities Value Set"
Description: "Activities related to reproductive health monitoring"

* ^status = #active
* ^experimental = false
* ^date = "2024-03-19"

* codes from system ReproductiveActivityCS

CodeSystem: ReproductiveActivityCS
Id: reproductive-activity-cs
Title: "Reproductive Health Activities Code System"
Description: "Code system for reproductive health monitoring activities"

* ^status = #active
* ^experimental = false
* ^caseSensitive = true

* #cycle-tracking "Cycle Tracking" "Track menstrual cycle dates and characteristics"
* #temp-monitoring "Temperature Monitoring" "Monitor basal body temperature"
* #symptom-tracking "Symptom Tracking" "Track reproductive health symptoms"
* #vitals-monitoring "Vitals Monitoring" "Monitor vital signs related to reproductive health"
* #fertility-signs "Fertility Signs" "Monitor fertility signs and indicators"
* #mood-tracking "Mood Tracking" "Track mood changes related to reproductive cycle"
* #medication-log "Medication Log" "Log reproductive health medications"
* #exercise-tracking "Exercise Tracking" "Track physical activity during cycle"



// ===== Conteúdo de: AuditFormatsValueSet.fsh =====

ValueSet: AuditFormatsValueSet
Id: audit-formats
Title: "Audit Formats Value Set"
Description: "Value set for audit format types"
* ^url = "http://example.org/fhir/ValueSet/audit-formats"
* ^status = #active
* ^experimental = false
* ^date = "2024-12-27"
* include codes from system http://example.org/fhir/CodeSystem/audit-formats

CodeSystem: AuditFormatsCodeSystem
Id: audit-formats
Title: "Audit Formats Code System"
Description: "Code system for audit format types"
* ^url = "http://example.org/fhir/CodeSystem/audit-formats"
* ^status = #active
* ^experimental = false
* ^caseSensitive = true
* #text "Text Format"
* #structured "Structured Format"
* #mixed "Mixed Format"



// ===== Conteúdo de: MeasurementContextVS.fsh =====

ValueSet: MeasurementContextVS
Id: measurement-context-vs
Title: "Measurement Context Value Set"
Description: "Contexts in which measurements can be taken, including temporal and location-based contexts"
* ^status = #active
* ^experimental = false
* $SCT#272125009 "Assessment context value (qualifier value)"
* $SCT#307818003 "Before food"
* $SCT#307819006 "After food"
* $SCT#255214003 "After exercise"
* $SCT#264362003 "Time of day"



// ===== Conteúdo de: AuditLevelsValueSet.fsh =====

ValueSet: AuditLevelsValueSet
Id: audit-levels
Title: "Audit Levels Value Set"
Description: "Value set for audit level types"
* ^url = "http://example.org/fhir/ValueSet/audit-levels"
* ^status = #active
* ^experimental = false
* ^date = "2024-12-27"
* include codes from system http://example.org/fhir/CodeSystem/audit-levels

CodeSystem: AuditLevelsCodeSystem
Id: audit-levels
Title: "Audit Levels Code System"
Description: "Code system for audit level types"
* ^url = "http://example.org/fhir/CodeSystem/audit-levels"
* ^status = #active
* ^experimental = false
* ^caseSensitive = true
* #low "Low Level"
* #medium "Medium Level"
* #high "High Level"



// ===== Conteúdo de: SocialInteractionValueSets.fsh =====

ValueSet: SocialInteractionTypeVS
Id: social-interaction-type-vs
Title: "Social Interaction Type Value Set"
Description: "Types of social interactions"
* codes from system SocialInteractionTypeCS

ValueSet: SocialInteractionQualityVS
Id: social-interaction-quality-vs
Title: "Social Interaction Quality Value Set"
Description: "Quality measures for social interactions"
* codes from system SocialInteractionQualityCS

ValueSet: SocialInteractionMediumVS
Id: social-interaction-medium-vs
Title: "Social Interaction Medium Value Set"
Description: "Mediums through which social interaction occurs"
* codes from system SocialInteractionMediumCS

CodeSystem: SocialInteractionTypeCS
Id: social-interaction-type-cs
Title: "Social Interaction Type Code System"
Description: "Types of social interactions"
* #family "Family Interaction" "Interaction with family members"
* #friends "Friend Interaction" "Interaction with friends"
* #professional "Professional Interaction" "Work-related interactions"
* #community "Community Interaction" "Community-based interactions"
* #group "Group Activity" "Organized group activities"
* #casual "Casual Interaction" "Casual social encounters"

CodeSystem: SocialInteractionQualityCS
Id: social-interaction-quality-cs
Title: "Social Interaction Quality Code System"
Description: "Quality measures for social interactions"
* #meaningful "Meaningful" "Deep, meaningful interaction"
* #supportive "Supportive" "Supportive interaction"
* #neutral "Neutral" "Neither positive nor negative"
* #superficial "Superficial" "Surface-level interaction"
* #stressful "Stressful" "Stressful or difficult interaction"

CodeSystem: SocialInteractionMediumCS
Id: social-interaction-medium-cs
Title: "Social Interaction Medium Code System"
Description: "Mediums through which social interaction occurs"
* #inPerson "In Person" "Face-to-face interaction"
* #video "Video Call" "Video-based interaction"
* #voice "Voice Call" "Voice-only interaction"
* #text "Text Based" "Text-based communication"
* #social "Social Media" "Social media interaction"
* #mixed "Mixed Medium" "Multiple communication methods"



// ===== Conteúdo de: MoodValueSet.fsh =====

ValueSet: MoodValueSet
Id: mood
Title: "Mood Value Set"
Description: "Value set for mood states"
* ^url = "http://example.org/fhir/ValueSet/mood"
* ^status = #active
* ^experimental = false

CodeSystem: MoodCodeSystem
Id: mood
Title: "Mood Code System"
Description: "Code system for mood states"
* ^url = "http://example.org/fhir/CodeSystem/mood"
* ^status = #active
* ^caseSensitive = true
* #elevated "Elevated" "Mood is higher than normal"
* #neutral "Neutral" "Neither elevated nor depressed mood"
* #depressed "Depressed" "Mood is lower than normal"
* #anxious "Anxious" "Feeling worried or nervous"
* #irritable "Irritable" "Easily annoyed or angered"
* #calm "Calm" "Feeling peaceful and relaxed"



// ===== Conteúdo de: EnvironmentalContextVS.fsh =====

ValueSet: EnvironmentalContextValueSet
Id: environmental-context
Title: "Environmental Context Value Set"
Description: "Valid contexts for environmental measurements"

* ^status = #active
* ^experimental = false
* ^url = "http://example.org/fhir/ValueSet/environmental-context"
* include codes from system http://example.org/fhir/CodeSystem/environmental-context



// ===== Conteúdo de: ActivityTypeVS.fsh =====

ValueSet: PhysicalActivityTypeVS
Id: physical-activity-type-vs
Title: "Physical Activity Types Value Set"
Description: "Types of physical activities from iOS Health App"

* ^status = #active

* $SNOMED#255604002 "Physical activity (observable entity)"
* $SNOMED#228557008 "Walking"
* $SNOMED#229058003 "Running"
* $SNOMED#266938001 "Swimming"
* $SNOMED#266940006 "Cycling"
* $SNOMED#32147004 "Regular exercise"



// ===== Conteúdo de: MindfulnessValueSets.fsh =====

ValueSet: EnvironmentTypeValueSet
Id: environment-type
Title: "Environment Type Value Set"
Description: "Value set for environmental context types"
* ^url = "http://example.org/fhir/ValueSet/environment-type"
* ^status = #active
* include codes from system http://example.org/fhir/CodeSystem/environment-type

ValueSet: MindfulnessTypeValueSet
Id: mindfulness-type
Title: "Mindfulness Type Value Set"
Description: "Value set for types of mindfulness practices"
* ^url = "http://example.org/fhir/ValueSet/mindfulness-type"
* ^status = #active
* include codes from system http://example.org/fhir/CodeSystem/mindfulness-type



// ===== Conteúdo de: BalanceStatusValueSet.fsh =====

ValueSet: BalanceStatusValueSet
Id: balance-status
Title: "Balance Status Value Set"
Description: "Value set for walking steadiness balance status"
* ^url = "http://example.org/fhir/ValueSet/balance-status"
* ^status = #active
* include codes from system http://example.org/fhir/CodeSystem/balance-status

CodeSystem: BalanceStatusCodeSystem
Id: balance-status
Title: "Balance Status Code System"
Description: "Code system for balance status types"
* ^url = "http://example.org/fhir/CodeSystem/balance-status"
* ^status = #active
* ^experimental = false
* ^caseSensitive = true
* #veryStable "Very Stable"
* #stable "Stable"
* #slightlyUnstable "Slightly Unstable"
* #unstable "Unstable"
* #veryUnstable "Very Unstable"



// ===== Conteúdo de: SleepQualityVS.fsh =====

ValueSet: SleepQualityVS
Id: sleep-quality-vs
Title: "Sleep Quality Value Set"
Description: "Qualitative assessments of sleep quality including subjective measures"
* ^status = #active
* ^experimental = false
* $SCT#248254009 "Quality of sleep (observable entity)"
* $SCT#248255005 "Sleeping well"
* $SCT#248256006 "Difficulty sleeping"
* $SCT#301345002 "Poor sleep pattern"
* $SCT#301346001 "Good sleep pattern"




// ===== Conteúdo de: FertilityValueSets.fsh =====

ValueSet: CervicalMucusValueSet
Id: cervical-mucus-valueset
Title: "Cervical Mucus Value Set"
Description: "Value set for cervical mucus observations"
* ^url = "http://example.org/fhir/ValueSet/cervical-mucus-vs"
* ^status = #active
* include codes from system http://example.org/fhir/CodeSystem/cervical-mucus-cs

CodeSystem: CervicalMucusCodeSystem
Id: cervical-mucus-cs
Title: "Cervical Mucus Code System"
* ^url = "http://example.org/fhir/CodeSystem/cervical-mucus-cs"
* ^status = #active
* ^caseSensitive = true
* #dry "Dry"
* #sticky "Sticky"
* #creamy "Creamy"
* #watery "Watery"
* #eggWhite "Egg White"

ValueSet: OvulationTestValueSet
Id: ovulation-test-valueset
Title: "Ovulation Test Value Set"
Description: "Value set for ovulation test results"
* ^url = "http://example.org/fhir/ValueSet/ovulation-test-vs"
* ^status = #active
* include codes from system http://example.org/fhir/CodeSystem/ovulation-test-cs

CodeSystem: OvulationTestCodeSystem
Id: ovulation-test-cs
Title: "Ovulation Test Code System"
* ^url = "http://example.org/fhir/CodeSystem/ovulation-test-cs"
* ^status = #active
* ^caseSensitive = true
* #negative "Negative"
* #positive "Positive"
* #invalid "Invalid Test"

ValueSet: FertilityStatusValueSet
Id: fertility-status-valueset
Title: "Fertility Status Value Set"
Description: "Value set for fertility status"
* ^url = "http://example.org/fhir/ValueSet/fertility-status-vs"
* ^status = #active
* include codes from system http://example.org/fhir/CodeSystem/fertility-status-cs

CodeSystem: FertilityStatusCodeSystem
Id: fertility-status-cs
Title: "Fertility Status Code System"
* ^url = "http://example.org/fhir/CodeSystem/fertility-status-cs"
* ^status = #active
* ^caseSensitive = true
* #fertile "Fertile"
* #notFertile "Not Fertile"
* #uncertain "Uncertain"



// ===== Conteúdo de: MindfulnessSearchParameters.fsh =====

Instance: MindfulnessType
InstanceOf: SearchParameter
Usage: #definition
* status = #active
* code = #mindfulness-type
* name = "MindfulnessType"
* description = "Search for mindfulness observations by practice type"
* base = #Observation
* type = #token
* expression = "Observation.component.where(code.coding.where(system='http://snomed.info/sct' and code='711020003')).value.as(CodeableConcept)"
* xpath = "f:Observation/f:component[f:code/f:coding[f:system/@value='http://snomed.info/sct' and f:code/f:coding/f:code/@value='711020003']]/f:valueCodeableConcept"
* xpathUsage = #normal



// ===== Conteúdo de: MindfulnessAlerts.fsh =====

Extension: AlertTiming
Id: alert-timing
Title: "Alert Timing Extension"
Description: "Defines when alerts should be triggered"
* value[x] only Timing
* valueTiming.repeat 1..1 MS
* valueTiming.repeat.frequency MS
* valueTiming.repeat.period MS
* valueTiming.repeat.periodUnit MS

Extension: AlertMessage
Id: alert-message
Title: "Alert Message Extension"
Description: "Defines the alert message content"
* value[x] only string

Profile: MindfulnessAlert
Parent: Basic
Id: mindfulness-alert
Title: "Mindfulness Alert"
Description: "Alert configuration for mindfulness sessions"

* code 1..1 MS
* code = http://example.org/CodeSystem/mindfulness-alert-type#reminder "Mindfulness Reminder"

* extension contains
    alert-timing named alertTiming 0..1 MS and
    alert-message named alertMessage 1..1 MS

Instance: DailyMindfulnessAlert
InstanceOf: MindfulnessAlert
Title: "Daily Mindfulness Alert" 
Description: "Example of a daily mindfulness alert configuration"

* code = http://example.org/CodeSystem/mindfulness-alert-type#reminder "Mindfulness Reminder"
* extension[alertTiming].valueTiming.repeat
  * frequency = 1
  * period = 1
  * periodUnit = #d
* extension[alertMessage].valueString = "Time for your daily mindfulness practice"



// ===== Conteúdo de: MindfulnessTransforms.fsh =====

Instance: MindfulnessHealthKitTransform
InstanceOf: StructureMap
Usage: #definition
Title: "HealthKit to FHIR Mindfulness Transform"

* status = #draft
* name = "MindfulnessHealthKitTransform"
* structure[0]
  * url = "http://example.org/StructureDefinition/healthkit-mindfulness"
  * mode = #source
  * documentation = "HealthKit mindfulness session structure"

* structure[1]
  * url = "http://hl7.org/fhir/StructureDefinition/Observation"
  * mode = #target
  * documentation = "FHIR Observation resource"

* group[0]
  * name = "MindfulnessSessionToObservation"
  * typeMode = #none
  * input[0]
    * name = "source"
    * type = "HealthKitMindfulness"
    * mode = #source
  * input[1]
    * name = "target"
    * type = "Observation"
    * mode = #target
  * rule[0]
    * name = "Session"
    * source[0]
      * context = "source"
      * element = "startDate"
    * target[0]
      * context = "target"
      * element = "effectiveDateTime"
  * rule[1]
    * name = "Duration"
    * source[0]
      * context = "source"
      * element = "duration"
    * target[0]
      * context = "target"
      * element = "component.where(code.coding.code='118682006').valueQuantity"

Instance: MindfulnessCSVTransform
InstanceOf: StructureMap
Usage: #definition
Title: "CSV to FHIR Mindfulness Transform"

* status = #draft
* name = "MindfulnessCSVTransform"
* structure[0]
  * url = "http://example.org/StructureDefinition/csv-mindfulness"
  * mode = #source
  * documentation = "CSV mindfulness data structure"

* group[0]
  * name = "CSVToMindfulnessObservation"
  * typeMode = #none
  * input[0]
    * name = "source"
    * type = "CSVMindfulness"
    * mode = #source
  * input[1]
    * name = "target"
    * type = "Observation"
    * mode = #target
  * rule[0]
    * name = "MapDatetime"
    * source[0]
      * context = "source"
      * element = "date,time"
    * target[0]
      * context = "target"
      * element = "effectiveDateTime"
      * transform = #append

RuleSet: TransformValidationRules
* rule[+]
  * name = "ValidateStatus"
  * source[0]
    * context = "target"
    * element = "status"
  * assert[0]
    * description = "Status must be final"
    * expression = "%status = 'final'"

* rule[+]
  * name = "ValidateCode"
  * source[0]
    * context = "target"
    * element = "code"
  * assert[0]
    * description = "Must use SNOMED CT code"
    * expression = "%code.system = 'http://snomed.info/sct'"



// ===== Conteúdo de: MindfulnessAudit.fsh =====

Extension: AuditLevelExtension
Id: audit-level
Title: "Audit Level Extension"
Description: "Level of detail for audit records"
* value[x] only code
* valueCode from http://example.org/fhir/ValueSet/audit-levels (required)

Extension: AuditRetentionExtension
Id: audit-retention
Title: "Audit Retention Extension" 
Description: "Period to retain audit records"
* value[x] only Duration

Extension: AuditFormatExtension
Id: audit-format
Title: "Audit Format Extension"
Description: "Format for audit records"
* value[x] only code
* valueCode from http://example.org/fhir/ValueSet/audit-formats (required)

Profile: MindfulnessAudit
Parent: Basic
Id: mindfulness-audit
Title: "Mindfulness Audit"
Description: "Audit record for mindfulness sessions"

* code 1..1 MS
* code = http://example.org/CodeSystem/mindfulness-audit-type#session "Session Audit"
* created 1..1 MS

* extension contains
    audit-level named auditLevel 1..1 MS and
    audit-retention named auditRetention 1..1 MS and
    audit-format named auditFormat 1..1 MS

Instance: MindfulnessAuditExample
InstanceOf: MindfulnessAudit
Title: "Example Mindfulness Audit"
Description: "Example of a mindfulness session audit record"

* code = http://example.org/CodeSystem/mindfulness-audit-type#session "Session Audit"
* created = "2024-03-15"
* extension[auditLevel].valueCode = #detailed
* extension[auditRetention].valueDuration = 90 'days'
* extension[auditFormat].valueCode = #fhir



// ===== Conteúdo de: EnvironmentalExamples.fsh =====

Instance: NoiseExposureExample
InstanceOf: NoiseExposureObservation
Usage: #example
Title: "Noise Exposure Measurement Example"
Description: "Example of noise exposure measurement from iOS Health App"

* meta.security = http://terminology.hl7.org/CodeSystem/v3-Confidentiality#N
* status = #final
* category = http://terminology.hl7.org/CodeSystem/observation-category#environment
* code = $LOINC#28573-7 "Noise exposure time"
* subject = Reference(Patient/example)
* effectiveDateTime = "2024-03-19T15:30:00Z"
* device = Reference(Device/iphone-example)
* method = http://snomed.info/sct#37016008 "Automatic measurement"

* component[level]
  * code.coding[0] = $LOINC#89020-2 "Environmental noise average"
  * valueQuantity = 85 'dB'
  * interpretation = http://terminology.hl7.org/CodeSystem/v3-ObservationInterpretation#H "High"

* component[duration]
  * code.coding[0] = $LOINC#89021-0 "Environmental noise duration"
  * valueQuantity = 120 'min'

* component[peakLevel]
  * code.coding[0] = $LOINC#89024-4 "Peak sound level"
  * valueQuantity = 95 'dB'

* component[backgroundNoise]
  * code.coding[0] = $LOINC#89025-1 "Background noise level"
  * valueQuantity = 45 'dB'

* note.text = "Measurement taken during urban commute"

Instance: UVExposureExample
InstanceOf: UVExposureObservation
Usage: #example
Title: "UV Exposure Measurement Example"
Description: "Example of UV exposure measurement from iOS Health App"

* meta.security = http://terminology.hl7.org/CodeSystem/v3-Confidentiality#N
* status = #final
* category = http://terminology.hl7.org/CodeSystem/observation-category#environment
* code = $LOINC#28574-5 "UV exposure"
* subject = Reference(Patient/example)
* effectiveDateTime = "2024-03-19T12:00:00Z"
* device = Reference(Device/iphone-example)
* method = http://snomed.info/sct#37016008 "Automatic measurement"

* component[index]
  * code.coding[0] = $LOINC#89022-8 "UV index"
  * valueQuantity = 8 '{index}'
  * interpretation = http://terminology.hl7.org/CodeSystem/v3-ObservationInterpretation#H "High"

* component[duration]
  * code.coding[0] = $LOINC#89023-6 "UV exposure duration"
  * valueQuantity = 45 'min'

* component[timeOfDay]
  * code.coding[0] = $LOINC#89026-9 "Time of exposure"
  * valueDateTime = "2024-03-19T12:00:00Z"

* component[intensity]
  * code.coding[0] = $LOINC#89027-7 "UV intensity"
  * valueQuantity = 0.3 'W/m2'

* note.text = "Measurement taken during outdoor activity"

Instance: EnvironmentalDeviceExample
InstanceOf: Device
Usage: #example
Title: "Environmental Monitoring Device"
Description: "Example of iOS device used for environmental monitoring"

* identifier.system = "http://example.org/devices"
* identifier.value = "iPhone-ENV-001"
* manufacturer = "Apple Inc."
* modelNumber = "iPhone 15 Pro"
* type = $SCT#706689003 "Environmental monitoring device"
* status = #active



// ===== Conteúdo de: NutritionExamples.fsh =====

Instance: NutritionQuestionnaireResponseExample
InstanceOf: QuestionnaireResponse
Usage: #example
Title: "Daily Nutrition Questionnaire Response Example"

* questionnaire = "https://github.com/RicardoLSantos/shorthand/Questionnaire/daily-nutrition"
* status = #completed
* subject = Reference(Patient/PatientExample)
* authored = "2024-12-14T20:00:00Z"

* item[0]
  * linkId = "water_intake"
  * answer.valueQuantity = 2000 'mL'

* item[1]
  * linkId = "meal_record"

  * item[0]
    * linkId = "meal_time"
    * answer.valueDateTime = "2024-12-14T12:00:00Z"

  * item[1]
    * linkId = "meal_type"
    * answer.valueString = "Lunch"

  * item[2]
    * linkId = "calories"
    * answer.valueInteger = 650

  * item[3]
    * linkId = "macronutrients"
   
    * item[0]
      * linkId = "carbs"
      * answer.valueDecimal = 75
   
    * item[1]
      * linkId = "protein"
      * answer.valueDecimal = 30
   
    * item[2]
      * linkId = "fat"
      * answer.valueDecimal = 25

* item[2]
  * linkId = "caffeine"

  * item[0]
    * linkId = "caffeine_amount"
    * answer.valueInteger = 80

  * item[1]
    * linkId = "caffeine_source"
    * answer.valueString = "Coffee"



// ===== Conteúdo de: SleepExamples.fsh =====

Instance: SleepObservationExample1
InstanceOf: SleepObservation
Usage: #example
Title: "Example of Sleep Record"
Description: "Example of nightly sleep data from iOS Health App"
 
* status = #final
* category = http://terminology.hl7.org/CodeSystem/observation-category#sleep
* code = $LOINC#93832-4 "Sleep pattern panel"
* subject = Reference(PatientExample)
* effectivePeriod.start = "2024-03-19T22:00:00Z"
* effectivePeriod.end = "2024-03-20T06:30:00Z"
* device = Reference(DeviceSleepMonitor)
 
* component[timeInBed].code = $LOINC#93831-6 "Time in bed"
* component[timeInBed].valueQuantity = 510 'min' "minute"
* component[timeInBed].valueQuantity.system = $UCUM
* component[timeInBed].valueQuantity.unit = "minute"
 
* component[totalSleepTime].code = $LOINC#93833-2 "Sleep duration"
* component[totalSleepTime].valueQuantity = 472 'min' "minute"
* component[totalSleepTime].valueQuantity.system = $UCUM
* component[totalSleepTime].valueQuantity.unit = "minute"
 
* component[deepSleep].code = $LOINC#93834-0 "Deep sleep duration"
* component[deepSleep].valueQuantity = 95 'min' "minute"
* component[deepSleep].valueQuantity.system = $UCUM
* component[deepSleep].valueQuantity.unit = "minute"
 
* component[remSleep].code = $LOINC#93835-7 "REM sleep duration"
* component[remSleep].valueQuantity = 118 'min' "minute"
* component[remSleep].valueQuantity.system = $UCUM
* component[remSleep].valueQuantity.unit = "minute"
 
* component[lightSleep].code = $LOINC#93836-5 "Light sleep duration"
* component[lightSleep].valueQuantity = 259 'min' "minute"
* component[lightSleep].valueQuantity.system = $UCUM
* component[lightSleep].valueQuantity.unit = "minute"
 
* component[respiratoryRate].code = $LOINC#9279-1 "Respiratory rate"
* component[respiratoryRate].valueQuantity = 14 '/min' "per minute"
* component[respiratoryRate].valueQuantity.system = $UCUM
* component[respiratoryRate].valueQuantity.unit = "per minute"
 
* component[heartRateVariability].code = $LOINC#80404-7 "R-R interval.standard deviation (Heart rate variability)"
* component[heartRateVariability].valueQuantity = 45 'ms' "millisecond"
* component[heartRateVariability].valueQuantity.system = $UCUM
* component[heartRateVariability].valueQuantity.unit = "millisecond"
 
* component[interruptions].code = $LOINC#93837-3 "Number of awakenings during sleep"
* component[interruptions].valueQuantity = 3 '{count}' "count"
* component[interruptions].valueQuantity.system = $UCUM
* component[interruptions].valueQuantity.unit = "count"

Instance: DeviceSleepMonitor
InstanceOf: Device
Usage: #example
Title: "Sleep Monitoring Device"
* deviceName.name = "Sleep Quality Monitor"
* deviceName.type = #user-friendly-name
* manufacturer = "HealthTech Devices"
* modelNumber = "SQM-2024"
* type = $SCT#706172001 "Sleep monitor"



// ===== Conteúdo de: StressExamples.fsh =====

Instance: StressLevelExample
InstanceOf: StressLevelProfile
Usage: #example
Title: "Stress Level Measurement Example"

* status = #final
* category = http://terminology.hl7.org/CodeSystem/observation-category#vital-signs
* code = $LOINC#89592-0 "Stress level score"
* subject = Reference(Patient/example)
* effectiveDateTime = "2024-01-03T15:30:00Z"
* valueQuantity = 7 '{score}' "score"

* component[physiologicalStress].valueQuantity = 6 '{score}' "score"
* component[psychologicalStress].valueQuantity = 8 '{score}' "score"
* component[chronicity].valueCodeableConcept = StressChronicityCS#subacute
* component[impact].valueCodeableConcept = StressImpactCS#moderate

* extension[triggers].valueCodeableConcept = StressTriggersCS#work
* extension[coping].valueCodeableConcept = StressCopingCS#meditation



// ===== Conteúdo de: PatientExample.fsh =====

Instance: PatientExample
InstanceOf: Patient
Usage: #example
* identifier[0].system = "urn:oid:2.16.858.1.1.1"
* identifier[0].value = "12345"
* name.given = "John"
* name.family = "Doe"
* gender = #male
* birthDate = "1970-01-01"



// ===== Conteúdo de: MobilityExamples.fsh =====

Profile: WalkingSteadinessObservation
Parent: MobilityProfile
Id: walking-steadiness-observation
Title: "Walking Steadiness Observation Profile"
Description: "Profile for walking steadiness measurements from iPhone Motion Sensors"

* code = $LOINC#LA32-8 "Balance"
* component contains
    balanceScore 0..1 MS and
    balanceStatus 0..1 MS

* component[balanceScore]
  * code = $LOINC#LA32-8 "Balance score"
  * valueQuantity.system = $UCUM
  * valueQuantity.code = #%

* component[balanceStatus]
  * code = $LOINC#LA32-9 "Balance status"
  * valueCodeableConcept from http://example.org/fhir/ValueSet/balance-status (required)

Profile: WalkingSpeedObservation
Parent: MobilityProfile
Id: walking-speed-observation
Title: "Walking Speed Observation Profile"
Description: "Profile for walking speed measurements from iPhone Motion Sensors"

* code = $LOINC#LA29042-4 "Walking speed"
* component contains
    speed 0..1 MS and
    distance 0..1 MS

* component[speed]
  * code = $LOINC#LA29042-4 "Walking speed measurement"
  * valueQuantity.system = $UCUM
  * valueQuantity.code = #m/s

* component[distance]
  * code = $LOINC#LA29043-2 "Walking distance"
  * valueQuantity.system = $UCUM
  * valueQuantity.code = #m

Instance: WalkingSteadinessExample
InstanceOf: WalkingSteadinessObservation
Usage: #example
Title: "Walking Steadiness Measurement Example"
Description: "Example of walking steadiness measurement from iPhone Motion Sensors"

* status = #final
* category = http://terminology.hl7.org/CodeSystem/observation-category#activity
* code = $LOINC#LA32-8 "Balance"
* subject = Reference(Patient/example)
* effectiveDateTime = "2024-03-19T15:30:00Z"
* valueQuantity = 85 '1' "score"
* device = Reference(Device/iphone-example)

* component[balanceScore].valueQuantity = 85 '%' "percent"
* component[balanceStatus].valueCodeableConcept = $LOINC#LA32-10 "OK"

Instance: WalkingSpeedExample
InstanceOf: WalkingSpeedObservation
Usage: #example
Title: "Walking Speed Measurement Example"
Description: "Example of walking speed measurement from iPhone Motion Sensors"

* status = #final
* category = http://terminology.hl7.org/CodeSystem/observation-category#activity
* code = $LOINC#LA29042-4 "Walking speed"
* subject = Reference(Patient/example)
* effectiveDateTime = "2024-03-19T15:30:00Z"
* valueQuantity = 1.2 'm/s' "meters per second"
* device = Reference(Device/iphone-example)

* component[speed].valueQuantity = 1.2 'm/s' "meters per second"
* component[distance].valueQuantity = 10 'm' "meters"



// ===== Conteúdo de: PhysicalActivityExamples.fsh =====

Instance: PhysicalActivityExample1
InstanceOf: PhysicalActivityObservation
Usage: #example
Title: "Example of Walking Activity"
Description: "Example of walking activity data from iOS Health App"
* status = #final
* category = http://terminology.hl7.org/CodeSystem/observation-category#activity
* code = $SNOMED#228557008 "Walking"
* subject = Reference(PatientExample)
* effectiveDateTime = "2024-03-19T15:30:00Z"
* device = Reference(DeviceActivityTracker)
* component[steps].code = $LOINC#55423-8 "Number of steps in 24 hour Measured"
* component[steps].valueQuantity = 8546 '1' "count"
* component[steps].valueQuantity.system = $UCUM
* component[steps].valueQuantity.unit = "count"
* component[distance].code = $LOINC#55430-3 "Distance walked"
* component[distance].valueQuantity = 6.2 'km' "kilometer"
* component[distance].valueQuantity.system = $UCUM
* component[distance].valueQuantity.unit = "kilometer"
* component[duration].code = $LOINC#55411-3 "Exercise duration"
* component[duration].valueQuantity = 72 'min' "minute"
* component[duration].valueQuantity.system = $UCUM
* component[duration].valueQuantity.unit = "minute"
* component[energy].code = $LOINC#55424-6 "Energy expenditure"
* component[energy].valueQuantity = 320 'kcal' "kilocalorie"
* component[energy].valueQuantity.system = $UCUM
* component[energy].valueQuantity.unit = "kilocalorie"

Instance: DeviceActivityTracker
InstanceOf: Device
Usage: #example
Title: "Activity Tracking Device"
* deviceName.name = "Health Activity Tracker"
* deviceName.type = #user-friendly-name
* manufacturer = "HealthTech Devices"
* modelNumber = "HAT-2024"
* type = $SCT#258158006 "Activity monitor"



// ===== Conteúdo de: BodyMetricsExamples.fsh =====

Instance: WeightExample
InstanceOf: WeightObservation
Usage: #example
Title: "Weight Measurement Example"
Description: "Example of a weight measurement from a smart scale"
* status = #final
* category = http://terminology.hl7.org/CodeSystem/observation-category#vital-signs
* code = $LOINC#29463-7 "Body weight"
* subject = Reference(PatientExample)
* performer = Reference(PractitionerExample)
* effectiveDateTime = "2024-03-19T08:00:00Z"
* valueQuantity = 70.5 'kg' "kilogram"
* valueQuantity.system = $UCUM
* valueQuantity.unit = "kilogram"
* device = Reference(SmartScale)

Instance: HeightExample
InstanceOf: HeightObservation
Usage: #example
Title: "Height Measurement Example"
Description: "Example of a height measurement"
* status = #final
* category = http://terminology.hl7.org/CodeSystem/observation-category#vital-signs
* code = $LOINC#8302-2 "Body height"
* subject = Reference(PatientExample)
* performer = Reference(PractitionerExample)
* effectiveDateTime = "2024-03-19T08:00:00Z"
* valueQuantity = 175 'cm' "centimeter"
* valueQuantity.system = $UCUM
* valueQuantity.unit = "centimeter"

Instance: BMIExample
InstanceOf: BMIObservation
Usage: #example
Title: "BMI Calculation Example"
Description: "Example of a BMI calculation based on weight and height measurements"
* status = #final
* category = http://terminology.hl7.org/CodeSystem/observation-category#vital-signs
* code = $LOINC#39156-5 "Body mass index (BMI)"
* subject = Reference(PatientExample)
* performer = Reference(PractitionerExample)
* effectiveDateTime = "2024-03-19T08:00:00Z"
* valueQuantity = 23.0 'kg/m2' "kilogram per square meter"
* valueQuantity.system = $UCUM
* valueQuantity.unit = "kilogram per square meter"
* derivedFrom[0] = Reference(Observation/WeightExample)
* derivedFrom[1] = Reference(Observation/HeightExample)

Instance: BodyCompositionExample
InstanceOf: BodyCompositionObservation
Usage: #example
Title: "Body Composition Measurement Example" 
Description: "Example of comprehensive body composition measurements from a bioimpedance device"
* status = #final
* category = http://terminology.hl7.org/CodeSystem/observation-category#vital-signs
* code = $LOINC#88365-2 "Body composition panel"
* subject = Reference(PatientExample)
* performer = Reference(PractitionerExample)
* effectiveDateTime = "2024-03-19T08:00:00Z"
* device = Reference(BioimpedanceAnalyzer)

* component[bodyFat].code = $LOINC#41982-0 "Percentage body fat"
* component[bodyFat].valueQuantity = 22.5 '%' "percent"
* component[bodyFat].valueQuantity.system = $UCUM
* component[bodyFat].valueQuantity.unit = "percent"

* component[leanMass].code = $LOINC#291-7 "Lean body mass"
* component[leanMass].valueQuantity = 54.6 'kg' "kilogram"
* component[leanMass].valueQuantity.system = $UCUM
* component[leanMass].valueQuantity.unit = "kilogram"

* component[bodyWater].code = $LOINC#73708-0 "Total body water"
* component[bodyWater].valueQuantity = 39.2 'L' "liter"
* component[bodyWater].valueQuantity.system = $UCUM
* component[bodyWater].valueQuantity.unit = "liter"

* component[muscleMass].code = $LOINC#73713-0 "Muscle mass"
* component[muscleMass].valueQuantity = 51.8 'kg' "kilogram"
* component[muscleMass].valueQuantity.system = $UCUM
* component[muscleMass].valueQuantity.unit = "kilogram"

* component[boneMass].code = $LOINC#73711-4 "Bone mass"
* component[boneMass].valueQuantity = 2.8 'kg' "kilogram"
* component[boneMass].valueQuantity.system = $UCUM
* component[boneMass].valueQuantity.unit = "kilogram"

Instance: SmartScale
InstanceOf: Device
Usage: #example
Title: "Smart Scale Device"
* deviceName.name = "Smart Body Analyzer"
* deviceName.type = #user-friendly-name
* manufacturer = "HealthTech Devices"
* modelNumber = "SBA-2024"
* type = $SCT#469576000 "Digital scale device"

Instance: BioimpedanceAnalyzer  
InstanceOf: Device
Usage: #example
Title: "Bioimpedance Analyzer Device"
* deviceName.name = "Professional Body Composition Analyzer"
* deviceName.type = #user-friendly-name
* manufacturer = "MedTech Solutions"
* modelNumber = "BCA-Pro"
* type = $SCT#706767009 "Body composition analyzer"



// ===== Conteúdo de: SymptomExamples.fsh =====

Instance: ChronicSymptomExample
InstanceOf: Observation
Usage: #example
* status = #final
* category = http://terminology.hl7.org/CodeSystem/observation-category#survey
* code = $SCT#267036007 "Fatigue"
* subject = Reference(Patient/example)
* performer = Reference(Practitioner/example)
* effectiveDateTime = "2024-03-19T14:00:00Z"
// ... resto do exemplo ...

Instance: ExampleSymptomSeverity
InstanceOf: Observation
Usage: #example
* status = #final
* category = http://terminology.hl7.org/CodeSystem/observation-category#survey
* code = $SCT#246604007 "Symptom severity"
* subject = Reference(Patient/example)
* performer = Reference(Practitioner/example)
* effectiveDateTime = "2024-03-19T10:30:00Z"
// ... resto do exemplo ...



// ===== Conteúdo de: SocialInteractionExamples.fsh =====

Instance: SocialInteractionExample
InstanceOf: SocialInteractionProfile
Usage: #example
Title: "Social Interaction Example"

* status = #final
* category = http://terminology.hl7.org/CodeSystem/observation-category#social-history
* code = $LOINC#96766-1 "Social interaction pattern"
* subject = Reference(Patient/example)
* effectiveDateTime = "2024-01-03T14:00:00Z"
* valueCodeableConcept = SocialInteractionTypeCS#family

* component[duration].valueQuantity = 120 'min' "minutes"
* component[quality].valueCodeableConcept = SocialInteractionQualityCS#meaningful
* component[medium].valueCodeableConcept = SocialInteractionMediumCS#inPerson
* component[participants].valueInteger = 4

* extension[context].valueCodeableConcept = SocialContextCS#home
* extension[support].valueCodeableConcept = SocialSupportCS#strong
* extension[activity].valueCodeableConcept = SocialActivityCS#meal



// ===== Conteúdo de: VitalSignsExamples.fsh =====

Instance: HeartRateExample
InstanceOf: HeartRateObservation
Usage: #example
Title: "Heart Rate Measurement Example"
* status = #final
* code = $LOINC#8867-4 "Heart rate"
* subject = Reference(PatientExample)
* effectiveDateTime = "2024-03-19T15:30:00Z"
* valueQuantity = 72 '/min' "per minute"
* valueQuantity.system = $UCUM
* valueQuantity.unit = "per minute"
* device = Reference(DeviceHeartRateMonitor)
* performer = Reference(PractitionerExample)
* component[heartRateVariability].code = $LOINC#80404-7 "R-R interval.standard deviation (Heart rate variability)"
* component[heartRateVariability].valueQuantity = 45 'ms' "millisecond"
* component[heartRateVariability].valueQuantity.system = $UCUM
* component[heartRateVariability].valueQuantity.unit = "millisecond"

Instance: BloodPressureExample
InstanceOf: BloodPressureObservation
Usage: #example
Title: "Blood Pressure Measurement Example"
* status = #final
* code = $LOINC#85354-9 "Blood pressure panel with all children optional"
* subject = Reference(PatientExample)
* effectiveDateTime = "2024-03-19T15:30:00Z"
* device = Reference(DeviceBloodPressureMonitor)
* performer = Reference(PractitionerExample)
* component[systolic].code = $LOINC#8480-6 "Systolic blood pressure"
* component[systolic].valueQuantity = 120 'mm[Hg]' "millimeter of mercury"
* component[systolic].valueQuantity.system = $UCUM
* component[systolic].valueQuantity.unit = "millimeter of mercury"
* component[diastolic].code = $LOINC#8462-4 "Diastolic blood pressure"
* component[diastolic].valueQuantity = 80 'mm[Hg]' "millimeter of mercury"
* component[diastolic].valueQuantity.system = $UCUM
* component[diastolic].valueQuantity.unit = "millimeter of mercury"

Instance: DeviceHeartRateMonitor
InstanceOf: Device
Usage: #example
Title: "Heart Rate Monitor Device"
* deviceName.name = "Continuous Heart Rate Monitor"
* deviceName.type = #user-friendly-name
* manufacturer = "HealthTech Devices"
* modelNumber = "HRM-2024"
* type = $SCT#720737000 "Pulse rate monitoring device"

Instance: DeviceBloodPressureMonitor
InstanceOf: Device
Usage: #example
Title: "Blood Pressure Monitor Device"
* deviceName.name = "Digital Blood Pressure Monitor"
* deviceName.type = #user-friendly-name
* manufacturer = "HealthTech Devices"
* modelNumber = "BPM-2024"
* type = $SCT#43770009 "Blood pressure monitor"



// ===== Conteúdo de: PractitionerExample.fsh =====

Instance: PractitionerExample
InstanceOf: Practitioner
Usage: #example
* identifier[0].system = "http://hl7.org/fhir/sid/us-npi"
* identifier[0].value = "9941339108"
* name.given = "Jane"
* name.family = "Smith"



// ===== Conteúdo de: MindfulnessCompleteExamples.fsh =====

Instance: CompleteMindfulnessSession
InstanceOf: MindfulnessObservation
Usage: #example
Title: "Complete Mindfulness Session Example"

* status = #final
* code = $SCT#711020003 "Meditation"
* subject = Reference(Patient/PatientExample)
* effectiveDateTime = "2024-03-19T08:00:00Z"
* performer = Reference(Practitioner/example)

* component[sessionDuration].code = $SCT#118682006 "Duration"
* component[sessionDuration].valueQuantity = 20 'min'

* component[stressLevel].code = $SCT#725854004 "Assessment of stress level"
* component[stressLevel].valueInteger = 3

* component[moodState].code = $SCT#373931001 "Mood finding"
* component[moodState].valueCodeableConcept = $SCT#130991005 "Neutral mood"

* component[relaxationResponse].code = $SCT#276241001 "Relaxation technique"
* component[relaxationResponse].valueString = "Deep breathing exercises with progressive relaxation"

* component[mindfulnessType].code = $SCT#711020003 "Meditation"
* component[mindfulnessType].valueCodeableConcept = $SCT#711020003 "Meditation"

* extension[mindfulness-context].extension[location].valueString = "Home meditation room"
* extension[mindfulness-context].extension[environment].valueCodeableConcept = #quiet "Quiet Space"
* extension[mindfulness-context].extension[guidance].valueBoolean = true

Instance: CompleteMindfulnessResponse
InstanceOf: QuestionnaireResponse
Usage: #example
Title: "Complete Mindfulness Session Response"

* questionnaire = "http://example.org/Questionnaire/daily-mindfulness"
* status = #completed
* subject = Reference(Patient/PatientExample)
* authored = "2024-03-19T08:30:00Z"

* item[0]
  * linkId = "mindful_session"
  * item[0]
    * linkId = "session_duration"
    * answer.valueInteger = 20
  * item[1]
    * linkId = "practice_type"
    * answer.valueString = "Meditation"

* item[1]
  * linkId = "mood_assessment"
  * item[0]
    * linkId = "current_mood"
    * answer.valueCoding = $SCT#130991005 "Neutral mood"
  * item[1]
    * linkId = "mood_intensity"
    * answer.valueInteger = 3

* item[2]
  * linkId = "stress_assessment"
  * item[0]
    * linkId = "stress_level"
    * answer.valueInteger = 3
  * item[1]
    * linkId = "stress_symptoms"
    * answer[0].valueString = "Slight tension"

* item[3]
  * linkId = "relaxation"
  * item[0]
    * linkId = "relaxation_duration"
    * answer.valueInteger = 15
  * item[1]
    * linkId = "relaxation_technique"
    * answer.valueString = "Deep breathing"



// ===== Conteúdo de: MindfulnessExamples.fsh =====

Instance: MindfulnessObservationExample
InstanceOf: MindfulnessObservation
Usage: #example
Title: "Example of Mindfulness Session Observation"

* status = #final
* code = $SCT#711020003 "Meditation"
* subject = Reference(Patient/PatientExample)
* effectiveDateTime = "2024-03-19T09:30:00Z"
* performer = Reference(Practitioner/example)

* component[sessionDuration].code = $SCT#118682006 "Duration"
* component[sessionDuration].valueQuantity = 20 'min'

* component[stressLevel].code = $SCT#725854004 "Assessment of stress level"
* component[stressLevel].valueInteger = 4

* component[moodState].code = $SCT#373931001 "Mood finding"
* component[moodState].valueCodeableConcept = $SCT#130991005 "Neutral mood"

* component[relaxationResponse].code = $SCT#276241001 "Relaxation technique"
* component[relaxationResponse].valueString = "Deep breathing exercises helped reduce tension"

* component[mindfulnessType].code = $SCT#711020003 "Meditation"
* component[mindfulnessType].valueCodeableConcept = $SCT#711020003 "Meditation"

// New example for MindfulnessQuestionnaire
Instance: MindfulnessQuestionnaireExample
InstanceOf: Questionnaire
Usage: #example
Title: "Example of Mindfulness Questionnaire"

* url = "http://example.org/Questionnaire/mindfulness-example"
* status = #active
* title = "Daily Mindfulness Assessment"
* version = "1.0"
* name = "MindfulnessQuestionnaireExample"
* date = "2024-03-19"
* publisher = "Example Organization"
* description = "Example questionnaire for daily mindfulness practice assessment"

* item[0]
  * linkId = "session_details"
  * text = "Session Details"
  * type = #group
  
  * item[0]
    * linkId = "duration"
    * text = "Duration (minutes)"
    * type = #integer
    * required = true
    
  * item[1]
    * linkId = "technique"
    * text = "Technique Used"
    * type = #choice
    * required = true
    * answerOption[0].valueString = "Mindful Breathing"
    * answerOption[1].valueString = "Body Scan"
    * answerOption[2].valueString = "Walking Meditation"



// ===== Conteúdo de: ReproductiveExamples.fsh =====

Instance: ExampleReproductiveActivity
InstanceOf: CarePlan
Usage: #example
* status = #active
* intent = #plan
* subject = Reference(Patient/example)
* activity.detail.kind = #Observation
* activity.detail.code = ReproductiveActivityCS#cycle-tracking
* activity.detail.status = #scheduled



// ===== Conteúdo de: MindfulnessWorkflow.fsh =====

Profile: MindfulnessSchedule
Parent: Basic
Id: mindfulness-schedule
Title: "Mindfulness Schedule"
Description: "Schedule configuration for mindfulness sessions"

* code 1..1 MS
* code = http://example.org/CodeSystem/mindfulness-schedule-type#recurring "Recurring Schedule"

Extension: MindfulnessScheduleTiming
Id: mindfulness-schedule-timing
Title: "Mindfulness Schedule Timing"
Description: "Timing configuration for mindfulness sessions"
* value[x] only Timing

Instance: WeeklyMindfulnessSchedule
InstanceOf: MindfulnessSchedule
Title: "Weekly Mindfulness Schedule"
Description: "Example of a weekly mindfulness schedule"

* code = http://example.org/CodeSystem/mindfulness-schedule-type#recurring "Recurring Schedule"
* extension[mindfulness-schedule-timing].valueTiming.repeat.frequency = 1
* extension[mindfulness-schedule-timing].valueTiming.repeat.period = 1
* extension[mindfulness-schedule-timing].valueTiming.repeat.periodUnit = #wk
* extension[mindfulness-schedule-timing].valueTiming.repeat.dayOfWeek = #mon
* extension[mindfulness-schedule-timing].valueTiming.repeat.dayOfWeek[+] = #wed
* extension[mindfulness-schedule-timing].valueTiming.repeat.dayOfWeek[+] = #fri



// ===== Conteúdo de: MindfulnessRules.fsh =====

RuleSet: MindfulnessValidation
* ^extension[0].url = "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice"
* ^extension[0].valueBoolean = true

* status MS
* code MS
* subject MS
* effective[x] MS
* value[x] MS
* component MS

* status from http://hl7.org/fhir/ValueSet/observation-status
* code from http://snomed.info/sct?fhir_vs=isa/711020003
* subject only Reference(Patient)
* effective[x] only dateTime

* obeys mindfulness-session-duration
* obeys mindfulness-stress-level
* obeys mindfulness-mood-required
* obeys mindfulness-context-complete
* obeys sequential-measurements

RuleSet: MindfulnessQuestionnaireValidation
* status MS
* title MS
* item MS

* status = #active
* subjectType = #Patient
* item ^slicing.discriminator.type = #pattern
* item ^slicing.discriminator.path = "linkId"
* item ^slicing.rules = #open
* item contains 
    session 0..1 MS and
    mood 0..1 MS and
    stress 0..1 MS and
    relaxation 0..1 MS

* item[session]
  * linkId = "mindful_session"
  * text = "Mindfulness Session"
  * type = #group
  * required = true
  * repeats = false

* item[mood]
  * linkId = "mood_assessment"
  * text = "Mood Assessment"
  * type = #group
  * required = true
  * repeats = false

* item[stress]
  * linkId = "stress_assessment"
  * text = "Stress Assessment"
  * type = #group
  * required = true
  * repeats = false

* item[relaxation]
  * linkId = "relaxation"
  * text = "Relaxation"
  * type = #group
  * required = true
  * repeats = false

RuleSet: MindfulnessResponseValidation
* status MS
* subject MS
* authored MS
* item MS

* status = #completed
* subject only Reference(Patient)
* authored 1..1
* item ^slicing.discriminator.type = #pattern
* item ^slicing.discriminator.path = "linkId"
* item ^slicing.rules = #open



// ===== Conteúdo de: MindfulnessMappings.fsh =====

Mapping: MindfulnessToHealthKit
Id: mindfulness-to-healthkit
Title: "Mapping to Apple HealthKit"
Source: MindfulnessObservation
Target: "http://developer.apple.com/documentation/healthkit"

* -> "HKCategoryTypeIdentifierMindfulSession" "Root mapping"
* effectiveDateTime -> "startDate and endDate" "Session timing"
* component[sessionDuration].valueQuantity -> "duration" "Session duration"

Mapping: MindfulnessToLOINC
Id: mindfulness-to-loinc
Title: "Mapping to LOINC codes"
Source: MindfulnessObservation
Target: "http://loinc.org"

* -> "89555-7" "Mindfulness safety questionnaire"
* component[stressLevel] -> "89556-5" "Stress level score"
* component[sessionDuration] -> "89557-3" "Duration of mindfulness practice"
* component[moodState] -> "89558-1" "Mood pattern"

Mapping: MindfulnessToSNOMED
Id: mindfulness-to-snomed
Title: "Mapping to SNOMED CT"
Source: MindfulnessObservation
Target: "http://snomed.info/sct"

* -> "711020003" "Meditation"
* component[stressLevel] -> "725854004" "Assessment of stress level"
* component[moodState] -> "373931001" "Mood finding"
* component[relaxationResponse] -> "276241001" "Relaxation technique"

Extension: MindfulnessImportMap
Id: mindfulness-import-map
Title: "Mindfulness Import Mapping"
Description: "Mapping instructions for importing mindfulness data"

* ^url = "https://example.org/StructureDefinition/mindfulness-import-map"
* ^version = "1.0.0"
* ^status = #draft

* extension contains
    source 1..1 MS and
    target 1..1 MS and
    mapping 1..1 MS

* extension[source].value[x] only string
* extension[target].value[x] only string
* extension[mapping].value[x] only string

Instance: HealthKitMappingConfig
InstanceOf: MindfulnessImportMap
Usage: #inline

* extension[source].valueString = "HKCategoryTypeIdentifierMindfulSession"
* extension[target].valueString = "Observation"
* extension[mapping].valueString = "duration->component[sessionDuration].valueQuantity"



// ===== Conteúdo de: SocialInteractionMappings.fsh =====

Mapping: SocialInteractionToHealthKit
Id: social-interaction-to-healthkit
Title: "Mapping to Apple HealthKit"
Source: SocialInteractionProfile
Target: "http://developer.apple.com/documentation/healthkit"

* -> "HKCategoryTypeIdentifierSocialInteraction" "Root mapping"
* valueCodeableConcept -> "interactionType" "Type of interaction"
* component[duration] -> "duration" "Duration of interaction"
* component[participants] -> "participantCount" "Number of participants"

Mapping: SocialInteractionToLOINC
Id: social-interaction-to-loinc
Title: "Mapping to LOINC codes"
Source: SocialInteractionProfile
Target: "http://loinc.org"

* -> "96766-1" "Social Interaction Panel"
* component[duration] -> "89597-9" "Interaction duration"
* component[quality] -> "89598-7" "Interaction quality"



// ===== Conteúdo de: MindfulnessDiagnosticMappings.fsh =====

Instance: MindfulnessDiagnosticMap
InstanceOf: ConceptMap
Usage: #definition
Title: "Mindfulness Diagnostic Mappings"
Description: "Mapping of mindfulness outcomes to diagnostic codes"

* status = #draft
* experimental = false
* purpose = "Map mindfulness outcomes to standard diagnostic codes"
* sourceUri = "https://example.org/ValueSet/mindfulness-outcome-vs"
* targetUri = "http://snomed.info/sct"

* group[0].source = "https://example.org/CodeSystem/mindfulness-outcome-cs"
* group[0].target = "http://snomed.info/sct"
* group[0].element[0]
  * code = #stressReduction
  * target[0]
    * code = #73595000
    * display = "Stress"
    * equivalence = #narrower
    * comment = "Indicates reduction in stress levels"

* group[0].element[1]
  * code = #improvedSleep
  * target[0]
    * code = #248234008
    * display = "Sleep pattern"
    * equivalence = #narrower
    * comment = "Indicates improvement in sleep quality"

* group[0].element[2]
  * code = #emotionalBalance
  * target[0]
    * code = #285854004
    * display = "Emotional state"
    * equivalence = #equivalent
    * comment = "Maps to emotional state finding"

* group[0].element[3]
  * code = #increasedAwareness
  * target[0]
    * code = #736253002
    * display = "Mental state, behavior and/or psychosocial functioning"
    * equivalence = #relatedto
    * comment = "General improvement in mental state"

RuleSet: MindfulnessDiagnosticRules
* status MS
* code MS
* subject MS
* effective[x] MS
* value[x] MS
* method MS

* method from http://example.org/ValueSet/mindfulness-diagnostic-method-vs (required)
* code from http://example.org/ValueSet/mindfulness-diagnostic-code-vs (required)

* extension contains 
    diagnosticCertainty 0..1 MS and
    diagnosticTiming 0..1 MS



// ===== Conteúdo de: StressMappings.fsh =====

Mapping: StressToHealthKit
Id: stress-to-healthkit
Title: "Mapping to Apple HealthKit"
Source: StressLevelProfile
Target: "http://developer.apple.com/documentation/healthkit"

* -> "HKCategoryTypeIdentifierStressLevel" "Root mapping"
* valueQuantity -> "stressLevel" "Overall stress score"
* component[physiologicalStress] -> "physiologicalStress" "Physical stress indicators"
* component[psychologicalStress] -> "mentalStress" "Mental stress indicators"

Mapping: StressToLOINC
Id: stress-to-loinc
Title: "Mapping to LOINC codes"
Source: StressLevelProfile
Target: "http://loinc.org"

* -> "89592-0" "Stress Level Panel"
* component[physiologicalStress] -> "89593-8" "Physical stress score"
* component[psychologicalStress] -> "89594-6" "Mental stress score"



// ===== Conteúdo de: BodyMetricsProfiles.fsh =====

Alias: $SCT = http://snomed.info/sct
Alias: $LOINC = http://loinc.org
Alias: $UCUM = http://unitsofmeasure.org

Profile: BodyMetricsObservation
Parent: Observation
Id: body-metrics-observation
Title: "Body Metrics Observation Profile"
Description: "Profile for body measurements from iOS Health App"

* ^version = "0.1.0"
* ^status = #draft
* ^publisher = "Open Health Manager"

* status MS
* category 1..1 MS
* category = http://terminology.hl7.org/CodeSystem/observation-category#vital-signs
* subject 1..1 MS
* effectiveDateTime 1..1 MS
* device 0..1 MS

Profile: WeightObservation
Parent: BodyMetricsObservation
Id: weight-observation  
Title: "Weight Measurement Profile"
Description: "Profile for body weight measurements"

* ^version = "0.1.0"
* ^status = #draft

* code = $LOINC#29463-7 "Body weight"
* valueQuantity only Quantity
* valueQuantity.system = $UCUM
* valueQuantity.code = #kg

Profile: HeightObservation
Parent: BodyMetricsObservation
Id: height-observation
Title: "Height Measurement Profile" 
Description: "Profile for body height measurements"

* ^version = "0.1.0"
* ^status = #draft

* code = $LOINC#8302-2 "Body height"
* valueQuantity only Quantity
* valueQuantity.system = $UCUM
* valueQuantity.code = #cm

Profile: BMIObservation
Parent: BodyMetricsObservation
Id: bmi-observation
Title: "BMI Measurement Profile"
Description: "Profile for Body Mass Index calculations"

* ^version = "0.1.0"
* ^status = #draft

* code = $LOINC#39156-5 "Body mass index (BMI)"
* valueQuantity only Quantity
* valueQuantity.system = $UCUM
* valueQuantity.code = #kg/m2

Profile: BodyCompositionObservation
Parent: BodyMetricsObservation
Id: body-composition-observation
Title: "Body Composition Profile"
Description: "Profile for body composition measurements including fat, lean mass, and other metrics"

* ^version = "0.1.0"
* ^status = #draft

* code = $LOINC#88365-2 "Body composition panel"
* component ^slicing.discriminator.type = #pattern
* component ^slicing.discriminator.path = "code"
* component ^slicing.rules = #open

* component contains
    bodyFat 0..1 MS and
    leanMass 0..1 MS and
    bodyWater 0..1 MS and
    muscleMass 0..1 MS and
    boneMass 0..1 MS

* component[bodyFat].code = $LOINC#41982-0 "Percentage body fat"
* component[bodyFat].valueQuantity.system = $UCUM
* component[bodyFat].valueQuantity.code = #%

* component[leanMass].code = $LOINC#291-7 "Lean body mass"
* component[leanMass].valueQuantity.system = $UCUM
* component[leanMass].valueQuantity.code = #kg

* component[bodyWater].code = $LOINC#73708-0 "Total body water"
* component[bodyWater].valueQuantity.system = $UCUM  
* component[bodyWater].valueQuantity.code = #L

* component[muscleMass].code = $LOINC#73713-0 "Muscle mass"
* component[muscleMass].valueQuantity.system = $UCUM
* component[muscleMass].valueQuantity.code = #kg

* component[boneMass].code = $LOINC#73711-4 "Bone mass" 
* component[boneMass].valueQuantity.system = $UCUM
* component[boneMass].valueQuantity.code = #kg



// ===== Conteúdo de: AdvancedVitalSignsProfiles.fsh =====

Alias: $SCT = http://snomed.info/sct
Alias: $LOINC = http://loinc.org
Alias: $UCUM = http://unitsofmeasure.org

Profile: AdvancedVitalSigns
Parent: Observation
Id: advanced-vital-signs
Title: "Advanced Vital Signs Profile"
Description: "Profile for advanced vital signs data from iOS Health App"

* ^version = "0.1.0"
* ^status = #draft
* ^publisher = "HL7 International"
* ^contact.name = "Advanced Vital Signs Working Group"

* status MS
* category 1..1 MS
* category = http://terminology.hl7.org/CodeSystem/observation-category#vital-signs
* code 1..1 MS
* subject 1..1 MS
* effectiveDateTime 1..1 MS
* device 0..1 MS
* method 0..1 MS
* note 0..* MS

* component ^slicing.discriminator.type = #pattern
* component ^slicing.discriminator.path = "code"
* component ^slicing.rules = #open
* component ^short = "Advanced vital signs components"
* component ^definition = "Components of advanced vital sign measurements"

* component contains
    hrvSpectral 0..1 MS and
    hrvEntropy 0..1 MS and
    meanArterialPressure 0..1 MS and
    pulseWaveAnalysis 0..1 MS and
    respiratoryVariability 0..1 MS and
    oxygenationIndex 0..1 MS and
    stressIndex 0..1 MS and
    thermalGradient 0..1 MS and
    autonomicBalance 0..1 MS and
    recoveryRate 0..1 MS and
    allostaticLoad 0..1 MS

* component[hrvSpectral].code = $LOINC#87834-8 "Heart rate variability [Frequency band]"
* component[hrvSpectral].valueQuantity.system = $UCUM
* component[hrvSpectral].valueQuantity.code = #ms
* component[hrvSpectral] ^short = "Spectral analysis of heart rate variability"

* component[hrvEntropy].code = $LOINC#87835-5 "Heart rate variability entropy"
* component[hrvEntropy].valueQuantity.system = $UCUM
* component[hrvEntropy].valueQuantity.code = #{entropy}
* component[hrvEntropy] ^short = "Sample entropy of heart rate variability"

* component[meanArterialPressure].code = $LOINC#8478-0 "Mean blood pressure"
* component[meanArterialPressure].valueQuantity.system = $UCUM
* component[meanArterialPressure].valueQuantity.code = #mmHg
* component[meanArterialPressure] ^short = "Mean arterial blood pressure"

* component[pulseWaveAnalysis].code = $LOINC#87836-3 "Pulse wave analysis"
* component[pulseWaveAnalysis].valueQuantity.system = $UCUM
* component[pulseWaveAnalysis].valueQuantity.code = #{index}
* component[pulseWaveAnalysis] ^short = "Analysis of arterial pulse wave"

* component[respiratoryVariability].code = $LOINC#87837-1 "Respiratory rate variability"
* component[respiratoryVariability].valueQuantity.system = $UCUM
* component[respiratoryVariability].valueQuantity.code = #{coefficient}
* component[respiratoryVariability] ^short = "Variability in respiratory rate"

* component[oxygenationIndex].code = $LOINC#87838-9 "Oxygenation index"
* component[oxygenationIndex].valueQuantity.system = $UCUM
* component[oxygenationIndex].valueQuantity.code = #{ratio}
* component[oxygenationIndex] ^short = "Index of blood oxygenation"

* component[stressIndex].code = $LOINC#87839-7 "Physiological stress index"
* component[stressIndex].valueQuantity.system = $UCUM
* component[stressIndex].valueQuantity.code = #{index}
* component[stressIndex] ^short = "Index of physiological stress"

* component[thermalGradient].code = $LOINC#87840-5 "Temperature gradient"
* component[thermalGradient].valueQuantity.system = $UCUM
* component[thermalGradient].valueQuantity.code = #Cel
* component[thermalGradient] ^short = "Gradient of body temperature"

* component[autonomicBalance].code = $LOINC#87841-3 "Autonomic balance index"
* component[autonomicBalance].valueQuantity.system = $UCUM
* component[autonomicBalance].valueQuantity.code = #{ratio}
* component[autonomicBalance] ^short = "Balance of autonomic nervous system"

* component[recoveryRate].code = $LOINC#87842-1 "Recovery rate index"
* component[recoveryRate].valueQuantity.system = $UCUM
* component[recoveryRate].valueQuantity.code = #{rate}
* component[recoveryRate] ^short = "Rate of physiological recovery"

* component[allostaticLoad].code = $LOINC#87843-9 "Allostatic load index"
* component[allostaticLoad].valueQuantity.system = $UCUM
* component[allostaticLoad].valueQuantity.code = #{score}
* component[allostaticLoad] ^short = "Measure of cumulative physiological burden"

Extension: AdvancedVitalSignsContext
Id: advanced-vital-signs-context
Title: "Advanced Vital Signs Context Extension"
Description: "Additional context about advanced vital sign measurements"

* value[x] only CodeableConcept
* valueCodeableConcept from AdvancedVitalSignsContextVS (required)

ValueSet: AdvancedVitalSignsContextVS
Id: advanced-vital-signs-context-vs
Title: "Advanced Vital Signs Context Value Set"
Description: "Context codes for advanced vital sign measurements"

* ^experimental = true
* codes from system AdvancedVitalSignsContextCS

CodeSystem: AdvancedVitalSignsContextCS
Id: advanced-vital-signs-context-cs
Title: "Advanced Vital Signs Context Code System"
Description: "Codes for advanced vital signs measurement context"

* ^experimental = true
* ^caseSensitive = true

* #resting "Resting state" "Measurement taken during rest"
* #active "Active state" "Measurement taken during activity"
* #recovery "Recovery state" "Measurement taken during recovery"
* #sleep "Sleep state" "Measurement taken during sleep"
* #stress "Stress state" "Measurement taken during stress"



// ===== Conteúdo de: MobilityProfiles.fsh =====

Profile: MobilityProfile
Parent: Observation
Id: mobility-profile
Title: "Mobility Profile"
Description: "Profile for mobility data from iOS Health App"

* status MS
* category 1..1 MS
* category = http://terminology.hl7.org/CodeSystem/observation-category#activity
* code 1..1 MS
* subject 1..1 MS
* effectiveDateTime 1..1 MS
* device 0..1 MS

* component ^slicing.discriminator.type = #pattern
* component ^slicing.discriminator.path = "code"
* component ^slicing.rules = #open

* component contains
    steadiness 0..1 MS and
    balance 0..1 MS and
    gait 0..1 MS and 
    movement 0..1 MS

* component[steadiness].code = $LOINC#LA32-8
* component[balance].code = $LOINC#LA32-9
* component[gait].code = $LOINC#LA29042-4
* component[movement].code = $LOINC#LA29043-2



// ===== Conteúdo de: VitalSignsProfiles.fsh =====

Alias: $SCT = http://snomed.info/sct
Alias: $LOINC = http://loinc.org
Alias: $UCUM = http://unitsofmeasure.org
Alias: $vitalsigns = http://hl7.org/fhir/StructureDefinition/vitalsigns

Profile: LifestyleVitalSigns
Parent: $vitalsigns
Id: lifestyle-vital-signs
Title: "Lifestyle Medicine Vital Signs Profile"
Description: "Profile for vital signs data from iOS Health App"

* status MS
* category 1..* MS
* subject 1..1 MS
* effectiveDateTime 1..1 MS
* code 1..1 MS
* value[x] 0..1 MS
* device 0..1 MS

Profile: HeartRateObservation
Parent: LifestyleVitalSigns
Id: heart-rate-observation
Title: "Heart Rate Observation Profile"
Description: "Profile for heart rate measurements from iOS Health App"

* code = $LOINC#8867-4 "Heart rate"
* valueQuantity only Quantity
* valueQuantity.system = $UCUM
* valueQuantity.code = #/min
* component ^slicing.discriminator.type = #pattern
* component ^slicing.discriminator.path = "code"
* component ^slicing.rules = #open

* component contains
    restingHeartRate 0..1 MS and
    exerciseHeartRate 0..1 MS and
    recoveryHeartRate 0..1 MS and
    heartRateVariability 0..1 MS

* component[heartRateVariability].code = $LOINC#80404-7 "R-R interval.standard deviation (Heart rate variability)"
* component[heartRateVariability].valueQuantity.system = $UCUM
* component[heartRateVariability].valueQuantity.code = #ms

Profile: BloodPressureObservation
Parent: LifestyleVitalSigns
Id: blood-pressure-observation
Title: "Blood Pressure Observation Profile"
Description: "Profile for blood pressure measurements from iOS Health App"

* code = $LOINC#85354-9 "Blood pressure panel with all children optional"
* component 2..2 MS
* component ^slicing.discriminator.type = #pattern
* component ^slicing.discriminator.path = "code"
* component ^slicing.rules = #closed

* component contains
    systolic 1..1 MS and
    diastolic 1..1 MS

* component[systolic].code = $LOINC#8480-6 "Systolic blood pressure"
* component[systolic].valueQuantity only Quantity
* component[systolic].valueQuantity.system = $UCUM
* component[systolic].valueQuantity.code = #mm[Hg]

* component[diastolic].code = $LOINC#8462-4 "Diastolic blood pressure"
* component[diastolic].valueQuantity only Quantity
* component[diastolic].valueQuantity.system = $UCUM
* component[diastolic].valueQuantity.code = #mm[Hg]

Profile: OxygenSaturationObservation
Parent: LifestyleVitalSigns
Id: oxygen-saturation-observation
Title: "Oxygen Saturation Observation Profile"
Description: "Profile for SpO2 measurements from iOS Health App"

* code = $LOINC#2708-6 "Oxygen saturation in Arterial blood"
* valueQuantity.system = $UCUM
* valueQuantity.code = #%



// ===== Conteúdo de: PhysicalActivityProfile.fsh =====

Alias: $LOINC = http://loinc.org
Alias: $SNOMED = http://snomed.info/sct
Alias: $UCUM = http://unitsofmeasure.org
Alias: $ActivityCodes = http://example.org/activity-codes

Profile: PhysicalActivityObservation
Parent: Observation
Id: physical-activity-observation
Title: "Physical Activity Observation Profile"
Description: "Profile for recording physical activity data from iOS Health App"

* status MS
* category 1..1 MS
* category = http://terminology.hl7.org/CodeSystem/observation-category#activity
* code 1..1 MS
* code from PhysicalActivityTypeVS (required)
* subject 1..1 MS
* subject only Reference(Patient)
* effectiveDateTime 1..1 MS
* device 0..1 MS
* value[x] only Quantity
* component ^slicing.discriminator.type = #pattern
* component ^slicing.discriminator.path = "code"
* component ^slicing.rules = #open

* component contains
    steps 0..1 MS and
    distance 0..1 MS and
    duration 0..1 MS and
    energy 0..1 MS

* component[steps].code = $LOINC#55423-8 "Number of steps in 24 hour Measured"
* component[steps].valueQuantity only Quantity
* component[steps].valueQuantity.system = $UCUM
* component[steps].valueQuantity.code = #1 "count"

* component[distance].code = $LOINC#55430-3 "Distance walked"
* component[distance].valueQuantity only Quantity
* component[distance].valueQuantity.system = $UCUM
* component[distance].valueQuantity.code = #km "kilometer"

* component[duration].code = $LOINC#55411-3 "Exercise duration"
* component[duration].valueQuantity only Quantity
* component[duration].valueQuantity.system = $UCUM
* component[duration].valueQuantity.code = #min "minute"

* component[energy].code = $LOINC#55424-6 "Energy expenditure"
* component[energy].valueQuantity only Quantity
* component[energy].valueQuantity.system = $UCUM
* component[energy].valueQuantity.code = #kcal "kilocalorie"



// ===== Conteúdo de: ReproductiveObservation.fsh =====

Profile: ReproductiveObservation
Parent: Observation
Id: reproductive-observation
Title: "Reproductive Health Base Profile"
Description: "Base profile for reproductive health observations"

* ^version = "1.0.0"
* ^status = #active
* ^date = "2024-03-19"

* status MS
* category 1..1 MS
* category = http://terminology.hl7.org/CodeSystem/observation-category#reproductive
* code 1..1 MS
* subject 1..1 MS
* subject only Reference(Patient)
* effectiveDateTime 1..1 MS
* value[x] MS

* component ^slicing.discriminator.type = #pattern
* component ^slicing.discriminator.path = "code"
* component ^slicing.rules = #open

* component contains
    severity 0..1 MS and
    duration 0..1 MS and
    frequency 0..1 MS and
    pattern 0..1 MS

* component[severity]
  * code = $LOINC#72514-3
  * value[x] only integer
  * valueInteger 1..1 
  * valueInteger obeys rep-1

* component[duration]
  * code = $LOINC#103332-8
  * value[x] only Quantity
  * valueQuantity from DurationUnitsVS (required)

* component[frequency]
  * code = $LOINC#103334-4
  * value[x] only CodeableConcept
  * valueCodeableConcept from SymptomFrequencyVS (required)

* component[pattern]
  * code = $LOINC#103335-1
  * value[x] only CodeableConcept
  * valueCodeableConcept from SymptomProgressionVS (required)

Invariant: rep-1
Description: "Severity must be between 0 and 10"
Expression: "$this >= 0 and $this <= 10"
Severity: #error



// ===== Conteúdo de: SymptomProfiles.fsh =====

Profile: SymptomQuestionnaire
Parent: Questionnaire
Id: symptom-questionnaire
Title: "Symptom Assessment Questionnaire"
Description: "Questionnaire template for symptom assessments"

* status MS
* title MS
* item MS

* item ^slicing.discriminator.type = #pattern
* item ^slicing.discriminator.path = "linkId"
* item ^slicing.rules = #open

* item contains
    symptomType 1..1 MS and
    location 0..1 MS and
    onset 0..1 MS and
    description 0..1 MS

* item[symptomType].linkId = "symptom-type"
* item[symptomType].text = "Type of Symptom"
* item[symptomType].type = #choice
* item[symptomType].required = true

* item[location].linkId = "location"
* item[location].text = "Location"
* item[location].type = #string

* item[onset].linkId = "onset"
* item[onset].text = "When did it start?"
* item[onset].type = #dateTime

* item[description].linkId = "description"
* item[description].text = "Description"
* item[description].type = #text



// ===== Conteúdo de: ReproductiveProfiles.fsh =====

Profile: FertilityObservation
Parent: Observation
Id: fertility-observation
Title: "Fertility Observation Profile"
Description: "Profile for fertility signs and symptoms"

* status MS
* category 1..1 MS
* category = http://terminology.hl7.org/CodeSystem/observation-category#reproductive
* code = $LOINC#8669-4 "Ovulation status"
* subject 1..1 MS
* effectiveDateTime 1..1 MS

* component ^slicing.discriminator.type = #pattern
* component ^slicing.discriminator.path = "code"
* component ^slicing.rules = #open

* component contains
    cervicalMucus 0..1 MS and
    ovulationTest 0..1 MS and
    fertilityStatus 0..1 MS

* component[cervicalMucus].valueCodeableConcept from http://example.org/fhir/ValueSet/cervical-mucus-vs (required)
* component[ovulationTest].valueCodeableConcept from http://example.org/fhir/ValueSet/ovulation-test-vs (required)
* component[fertilityStatus].valueCodeableConcept from http://example.org/fhir/ValueSet/fertility-status-vs (required)



// ===== Conteúdo de: MindfulnessProfiles.fsh =====

Profile: MindfulnessObservation
Parent: Observation
Id: mindfulness-observation
Title: "Mindfulness Session Observation"
Description: "Profile for recording mindfulness practice sessions and outcomes"

* status MS
* code MS
* subject MS
* effectiveDateTime MS
* performer MS
* value[x] MS
* component MS

* status = #final
* code = $SCT#711020003 "Meditation"
* subject only Reference(Patient)
* effectiveDateTime 1..1
* performer only Reference(Practitioner or PractitionerRole)

* component ^slicing.discriminator.type = #pattern
* component ^slicing.discriminator.path = "code"
* component ^slicing.rules = #open

* component contains
    sessionDuration 0..1 and
    stressLevel 0..1 and
    moodState 0..1 and
    relaxationResponse 0..1 and
    mindfulnessType 0..1

* component[sessionDuration]
  * code = $SCT#118682006 "Duration"
  * value[x] only Quantity
  * valueQuantity
    * value 1..1
    * unit = "min"
    * system = "http://unitsofmeasure.org"
    * code = #min

* component[stressLevel]
  * code = $SCT#725854004 "Assessment of stress level"
  * value[x] only integer
  * valueInteger
    * ^extension[0].url = "http://hl7.org/fhir/StructureDefinition/elementdefinition-minValueInteger"
    * ^extension[0].valueInteger = 0
    * ^extension[1].url = "http://hl7.org/fhir/StructureDefinition/elementdefinition-maxValueInteger"
    * ^extension[1].valueInteger = 10

* component[moodState]
  * code = $SCT#373931001 "Mood finding"
  * value[x] only CodeableConcept
  * valueCodeableConcept from http://example.org/fhir/ValueSet/mood (required)

* component[relaxationResponse]
  * code = $SCT#276241001 "Relaxation technique"
  * value[x] only string

* component[mindfulnessType]
  * code = $SCT#711020003 "Meditation"
  * value[x] only CodeableConcept
  * valueCodeableConcept from http://example.org/ValueSet/mindfulness-type (required)



// ===== Conteúdo de: SleepProfile.fsh =====

Alias: $SCT = http://snomed.info/sct
Alias: $LOINC = http://loinc.org
Alias: $UCUM = http://unitsofmeasure.org
 
Profile: SleepObservation
Parent: Observation
Id: sleep-observation
Title: "Sleep Observation Profile"
Description: "Profile for recording sleep data from iOS Health App"
 
* status MS
* category 1..1 MS
* category = http://terminology.hl7.org/CodeSystem/observation-category#sleep
* code 1..1 MS
* code = $LOINC#93832-4 "Sleep pattern panel"
* subject 1..1 MS
* subject only Reference(Patient)
* effectiveDateTime 0..1 MS
* effectivePeriod 0..1 MS
* device 0..1 MS
 
* component ^slicing.discriminator.type = #pattern
* component ^slicing.discriminator.path = "code"
* component ^slicing.rules = #open
 
* component contains
    timeInBed 1..1 MS and
    totalSleepTime 1..1 MS and
    deepSleep 0..1 MS and
    remSleep 0..1 MS and
    lightSleep 0..1 MS and
    respiratoryRate 0..1 MS and
    heartRateVariability 0..1 MS and
    interruptions 0..1 MS
 
* component[timeInBed].code = $LOINC#93831-6 "Time in bed"
* component[timeInBed].valueQuantity only Quantity
* component[timeInBed].valueQuantity.system = $UCUM
* component[timeInBed].valueQuantity.code = #min
 
* component[totalSleepTime].code = $LOINC#93833-2 "Sleep duration"
* component[totalSleepTime].valueQuantity only Quantity
* component[totalSleepTime].valueQuantity.system = $UCUM
* component[totalSleepTime].valueQuantity.code = #min
 
* component[deepSleep].code = $LOINC#93834-0 "Deep sleep duration"
* component[deepSleep].valueQuantity only Quantity
* component[deepSleep].valueQuantity.system = $UCUM
* component[deepSleep].valueQuantity.code = #min
 
* component[remSleep].code = $LOINC#93835-7 "REM sleep duration"
* component[remSleep].valueQuantity only Quantity
* component[remSleep].valueQuantity.system = $UCUM
* component[remSleep].valueQuantity.code = #min
 
* component[lightSleep].code = $LOINC#93836-5 "Light sleep duration"
* component[lightSleep].valueQuantity only Quantity
* component[lightSleep].valueQuantity.system = $UCUM
* component[lightSleep].valueQuantity.code = #min
 
* component[respiratoryRate].code = $LOINC#9279-1 "Respiratory rate"
* component[respiratoryRate].valueQuantity only Quantity
* component[respiratoryRate].valueQuantity.system = $UCUM
* component[respiratoryRate].valueQuantity.code = #/min
 
* component[heartRateVariability].code = $LOINC#80404-7 "R-R interval.standard deviation (Heart rate variability)"
* component[heartRateVariability].valueQuantity only Quantity
* component[heartRateVariability].valueQuantity.system = $UCUM
* component[heartRateVariability].valueQuantity.code = #ms
 
* component[interruptions].code = $LOINC#93837-3 "Number of awakenings during sleep"
* component[interruptions].valueQuantity only Quantity
* component[interruptions].valueQuantity.system = $UCUM
* component[interruptions].valueQuantity.code = #{count}
* extension contains SleepQuality named quality 0..1



// ===== Conteúdo de: MobilityRiskAssessment.fsh =====

Profile: MobilityRiskAssessment
Parent: RiskAssessment
Id: mobility-risk-assessment
Title: "Mobility Risk Assessment Profile"
Description: "Profile for assessing mobility-related risks"

* status MS
* subject 1..1 MS
* occurrence[x] MS
* prediction MS
  * outcome MS
  * probability[x] MS
  * qualitativeRisk MS

* method MS
  * coding ^slicing.discriminator.type = #pattern
  * coding ^slicing.discriminator.path = "$this"
  * coding ^slicing.rules = #open
  * coding contains
      mobilityAssessment 1..1 MS

* method.coding[mobilityAssessment] = http://example.org/CodeSystem/mobility-assessment-method#standardized "Standardized Mobility Assessment"

* prediction ^slicing.discriminator.type = #pattern
* prediction ^slicing.discriminator.path = "outcome"
* prediction ^slicing.rules = #open

* prediction contains
    fallRisk 0..1 MS and
    mobilityDecline 0..1 MS and
    assistanceNeeded 0..1 MS

* prediction[fallRisk].outcome from http://example.org/ValueSet/fall-risk-outcomes
* prediction[fallRisk].probabilityDecimal 0..1 MS
* prediction[fallRisk].qualitativeRisk from http://example.org/ValueSet/risk-level

* prediction[mobilityDecline].outcome from http://example.org/ValueSet/mobility-decline-outcomes
* prediction[mobilityDecline].probabilityDecimal 0..1 MS
* prediction[mobilityDecline].qualitativeRisk from http://example.org/ValueSet/risk-level

* prediction[assistanceNeeded].outcome from http://example.org/ValueSet/assistance-level-outcomes
* prediction[assistanceNeeded].probabilityDecimal 0..1 MS
* prediction[assistanceNeeded].qualitativeRisk from http://example.org/ValueSet/risk-level

* basis only Reference(MobilityProfile or Observation or QuestionnaireResponse)
* basis MS

* note MS



// ===== Conteúdo de: EnvironmentalProfiles.fsh =====

Alias: $SCT = http://snomed.info/sct
Alias: $LOINC = http://loinc.org
Alias: $UCUM = http://unitsofmeasure.org

Profile: EnvironmentalObservation
Parent: Observation
Id: environmental-observation
Title: "Environmental Observation Profile"
Description: "Base profile for environmental measurements from iOS Health App"

* ^version = "0.1.0"
* ^status = #draft
* ^publisher = "HL7 International"
* ^contact.name = "Environmental Health Working Group"

* status MS
* category 1..1 MS
* category = http://terminology.hl7.org/CodeSystem/observation-category#environment
* subject 1..1 MS
* effectiveDateTime 1..1 MS
* device 0..1 MS
* method 0..1 MS
* note 0..* MS

Profile: NoiseExposureObservation
Parent: EnvironmentalObservation
Id: noise-exposure-observation
Title: "Noise Exposure Observation Profile"
Description: "Profile for noise exposure measurements from iOS Health App"

* code = $LOINC#28573-7 "Noise exposure time"
* component ^slicing.discriminator.type = #pattern
* component ^slicing.discriminator.path = "code"
* component ^slicing.rules = #open
* component ^short = "Noise exposure components"
* component ^definition = "Components of noise exposure measurement"

* component contains
    level 1..1 MS and
    duration 1..1 MS and
    peakLevel 0..1 MS and
    backgroundNoise 0..1 MS

* component[level].code = $LOINC#89020-2 "Environmental noise average"
* component[level].valueQuantity.system = $UCUM
* component[level].valueQuantity.code = #dB
* component[level].valueQuantity ^short = "Noise level in decibels"

* component[duration].code = $LOINC#89021-0 "Environmental noise duration"
* component[duration].valueQuantity.system = $UCUM
* component[duration].valueQuantity.code = #min
* component[duration].valueQuantity ^short = "Duration of exposure"

* component[peakLevel].code = $LOINC#89024-4 "Peak sound level"
* component[peakLevel].valueQuantity.system = $UCUM
* component[peakLevel].valueQuantity.code = #dB
* component[peakLevel].valueQuantity ^short = "Peak noise level"

* component[backgroundNoise].code = $LOINC#89025-1 "Background noise level"
* component[backgroundNoise].valueQuantity.system = $UCUM
* component[backgroundNoise].valueQuantity.code = #dB
* component[backgroundNoise].valueQuantity ^short = "Background noise level"

Profile: UVExposureObservation
Parent: EnvironmentalObservation
Id: uv-exposure-observation
Title: "UV Exposure Observation Profile"
Description: "Profile for UV exposure measurements from iOS Health App"

* code = $LOINC#28574-5 "UV exposure"
* component ^slicing.discriminator.type = #pattern
* component ^slicing.discriminator.path = "code"
* component ^slicing.rules = #open
* component ^short = "UV exposure components"
* component ^definition = "Components of UV exposure measurement"

* component contains
    index 1..1 MS and
    duration 1..1 MS and
    timeOfDay 0..1 MS and
    intensity 0..1 MS

* component[index].code = $LOINC#89022-8 "UV index"
* component[index].valueQuantity.system = $UCUM
* component[index].valueQuantity.code = #{index}
* component[index].valueQuantity ^short = "UV index value"

* component[duration].code = $LOINC#89023-6 "UV exposure duration"
* component[duration].valueQuantity.system = $UCUM
* component[duration].valueQuantity.code = #min
* component[duration].valueQuantity ^short = "Duration of UV exposure"

* component[timeOfDay].code = $LOINC#89026-9 "Time of exposure"
* component[timeOfDay].valueDateTime 1..1
* component[timeOfDay].valueDateTime ^short = "Time of UV exposure"

* component[intensity].code = $LOINC#89027-7 "UV intensity"
* component[intensity].valueQuantity.system = $UCUM
* component[intensity].valueQuantity.code = #W/m2
* component[intensity].valueQuantity ^short = "UV radiation intensity"

Extension: EnvironmentalContext
Id: environmental-context
Title: "Environmental Context Extension"
Description: "Additional context about environmental measurements"

* value[x] only CodeableConcept
* valueCodeableConcept from http://example.org/fhir/ValueSet/environmental-context (required)



// ===== Conteúdo de: SocialInteractionProfile.fsh =====

Profile: SocialInteractionProfile
Parent: Observation
Id: social-interaction
Title: "Social Interaction Profile"
Description: "Profile for recording social interaction data from iOS Health App"

* ^version = "0.1.0"
* ^status = #active
* ^date = "2024-01-03"
* ^publisher = "FMUP HEADS2"

* status MS
* category 1..1 MS
* category = http://terminology.hl7.org/CodeSystem/observation-category#social-history
* code 1..1 MS
* code = $LOINC#96766-1 "Social interaction pattern"
* subject 1..1 MS
* effectiveDateTime 1..1 MS
* value[x] only CodeableConcept
* valueCodeableConcept from SocialInteractionTypeVS (required)

* component ^slicing.discriminator.type = #pattern
* component ^slicing.discriminator.path = "code"
* component ^slicing.rules = #open

* component contains
    duration 0..1 MS and
    quality 0..1 MS and
    medium 0..1 MS and
    participants 0..1 MS

* component[duration]
  * code = $LOINC#89597-9 "Social interaction duration"
  * valueQuantity only Quantity
  * valueQuantity.system = $UCUM
  * valueQuantity.code = #min

* component[quality]
  * code = $LOINC#89598-7 "Social interaction quality"
  * valueCodeableConcept from SocialInteractionQualityVS (required)

* component[medium]
  * code = $LOINC#89599-5 "Social interaction medium"
  * valueCodeableConcept from SocialInteractionMediumVS (required)

* component[participants]
  * code = $LOINC#89600-1 "Social interaction participants"
  * valueInteger only integer

* extension contains
    SocialContext named context 0..1 MS and
    SocialSupport named support 0..1 MS and
    SocialActivity named activity 0..* MS



// ===== Conteúdo de: StressLevelProfile.fsh =====

Profile: StressLevelProfile
Parent: Observation
Id: stress-level
Title: "Stress Level Profile"
Description: "Profile for recording stress level measurements from iOS Health App"

* ^version = "0.1.0"
* ^status = #active
* ^date = "2024-01-03"
* ^publisher = "FMUP HEADS2"

* status MS
* category 1..1 MS
* category = http://terminology.hl7.org/CodeSystem/observation-category#vital-signs
* code 1..1 MS
* code = $LOINC#89592-0 "Stress level score"
* subject 1..1 MS
* effectiveDateTime 1..1 MS
* value[x] only Quantity
* valueQuantity MS

* component ^slicing.discriminator.type = #pattern
* component ^slicing.discriminator.path = "code"
* component ^slicing.rules = #open

* component contains
    physiologicalStress 0..1 MS and
    psychologicalStress 0..1 MS and
    chronicity 0..1 MS and 
    impact 0..1 MS

* component[physiologicalStress]
  * code = $LOINC#89593-8 "Physiological stress"
  * valueQuantity only Quantity
  * valueQuantity.system = $UCUM
  * valueQuantity.code = #{score}

* component[psychologicalStress]
  * code = $LOINC#89594-6 "Psychological stress"
  * valueQuantity only Quantity
  * valueQuantity.system = $UCUM
  * valueQuantity.code = #{score}

* component[chronicity]
  * code = $LOINC#89595-3 "Stress chronicity"
  * valueCodeableConcept from StressChronicityVS (required)

* component[impact]
  * code = $LOINC#89596-1 "Stress impact"
  * valueCodeableConcept from StressImpactVS (required)

* extension contains
    MeasurementContext named context 0..1 MS and
    StressTriggers named triggers 0..* MS and 
    StressCoping named coping 0..* MS



// ===== Conteúdo de: NutritionProfiles.fsh =====

Alias: $SCT = http://snomed.info/sct
Alias: $LOINC = http://loinc.org
Alias: $UCUM = http://unitsofmeasure.org

Profile: NutritionIntakeObservation
Parent: Observation
Id: nutrition-intake-observation
Title: "Nutrition Intake Observation Profile"
Description: "Profile for nutrition intake data from iOS Health App and user input"

* ^version = "0.1.0"
* ^status = #draft
* ^publisher = "Ricardo Lourenço dos Santos"

* status MS
* category 1..1 MS
* category = http://terminology.hl7.org/CodeSystem/observation-category#nutrition
* subject 1..1 MS
* effectiveDateTime 1..1 MS
* code 1..1 MS
* method 0..1 MS

Profile: WaterIntakeObservation
Parent: NutritionIntakeObservation 
Id: water-intake-observation
Title: "Water Intake Observation Profile"
Description: "Profile for water intake measurements"

* ^version = "0.1.0"
* ^status = #draft
* ^publisher = "Ricardo Lourenço dos Santos"

* code = $LOINC#77111-4 "Water intake"
* valueQuantity only Quantity
* valueQuantity.system = $UCUM
* valueQuantity.code = #mL
* valueQuantity.unit = "milliliter"

Profile: CalorieIntakeObservation
Parent: NutritionIntakeObservation
Id: calorie-intake-observation
Title: "Calorie Intake Observation Profile"
Description: "Profile for caloric intake measurements"

* ^version = "0.1.0"
* ^status = #draft
* ^publisher = "Ricardo Lourenço dos Santos"

* code = $LOINC#9051-4 "Caloric intake total"
* valueQuantity only Quantity
* valueQuantity.system = $UCUM
* valueQuantity.code = #kcal
* valueQuantity.unit = "kilocalorie"

Profile: MacronutrientsObservation
Parent: NutritionIntakeObservation
Id: macronutrients-observation
Title: "Macronutrients Observation Profile"
Description: "Profile for macronutrient intake measurements"

* ^version = "0.1.0"
* ^status = #draft
* ^publisher = "Ricardo Lourenço dos Santos"

* code = $LOINC#LP199119-9 "Macronutrients panel"
* component ^slicing.discriminator.type = #pattern
* component ^slicing.discriminator.path = "code"
* component ^slicing.rules = #open

* component contains
    carbohydrates 0..1 MS and
    proteins 0..1 MS and
    fats 0..1 MS

* component[carbohydrates].code = $LOINC#LP35925-4 "Carbohydrates"
* component[carbohydrates].valueQuantity.system = $UCUM
* component[carbohydrates].valueQuantity.code = #g
* component[carbohydrates].valueQuantity.unit = "gram"

* component[proteins].code = $LOINC#LP35921-3 "Proteins" 
* component[proteins].valueQuantity.system = $UCUM
* component[proteins].valueQuantity.code = #g
* component[proteins].valueQuantity.unit = "gram"

* component[fats].code = $LOINC#LP35922-1 "Fats"
* component[fats].valueQuantity.system = $UCUM
* component[fats].valueQuantity.code = #g
* component[fats].valueQuantity.unit = "gram"



// ===== Conteúdo de: MindfulnessMessaging.fsh =====

Alias: $MsgEvents = http://example.org/fhir/CodeSystem/mindfulness-message-events
Alias: $MsgTypes = http://terminology.hl7.org/CodeSystem/message-type

Profile: MindfulnessMessageDefinition
Parent: MessageDefinition
Id: mindfulness-message-definition
Title: "Mindfulness Message Definition" 
Description: "Definition for mindfulness session messages"

* url 1..1 MS
* date 1..1 MS
* status 1..1 MS
* event[x] 1..1 MS
* category 0..1 MS
* focus 1..* MS
* focus.min 1..1

Instance: StartSessionMessage
InstanceOf: MindfulnessMessageDefinition
Title: "Start Session Message"
Description: "Message definition for starting a mindfulness session"

* url = "http://example.org/fhir/MessageDefinition/start-session"
* date = "2024-03-19"
* status = #active
* eventCoding = $MsgEvents#session-start "Session Start"
* category = #notification
* focus.code = #Observation
* focus.min = 1
* focus.profile = "http://example.org/fhir/StructureDefinition/mindfulness-session"

Instance: EndSessionMessage  
InstanceOf: MindfulnessMessageDefinition
Title: "End Session Message"
Description: "Message definition for ending a mindfulness session"

* url = "http://example.org/fhir/MessageDefinition/end-session"
* date = "2024-03-19"
* status = #active
* eventCoding = $MsgEvents#session-end "Session End"
* category = #notification
* focus.code = #Observation
* focus.min = 1
* focus.profile = "http://example.org/fhir/StructureDefinition/mindfulness-session"



// ===== Conteúdo de: MindfulnessReports.fsh =====

Instance: MindfulnessProgressReport
InstanceOf: Measure
Usage: #definition
Title: "Mindfulness Practice Progress Report"

* status = #active
* experimental = false
* date = "2024-03-19"
* publisher = "Example Organization"
* description = "Measures progress in mindfulness practice over time"

* scoring = #continuous-variable
* type = #process
* riskAdjustment = "none"
* rateAggregation = "Average values over time period"

* group[0]
  * code = #practice-frequency
  * description = "Frequency of mindfulness practice"
  * population[0]
    * code = #denominator
    * criteria.language = #text/fhirpath
    * criteria.expression = "Observation.where(code.coding.code='711020003')"
  * stratifier[0]
    * code = #weekly
    * criteria.language = #text/fhirpath
    * criteria.expression = "Observation.effective.as(DateTime).truncate(@T).truncate(@W)"

* group[1]
  * code = #stress-reduction
  * description = "Stress level changes over time"
  * population[0]
    * code = #denominator
    * criteria.language = #text/fhirpath
    * criteria.expression = "Observation.where(component.code.coding.code='725854004')"
  * stratifier[0]
    * code = #trend
    * criteria.language = #text/fhirpath
    * criteria.expression = "component.where(code.coding.code='725854004').value.value"

RuleSet: ReportingMetrics
* group[+]
  * code = #session-duration
  * description = "Duration of practice sessions"
  * population[0]
    * code = #denominator
    * criteria.language = #text/fhirpath
    * criteria.expression = "Observation.component.where(code.coding.code='118682006')"
  * stratifier[0]
    * code = #average
    * criteria.language = #text/fhirpath
    * criteria.expression = "component.where(code.coding.code='118682006').value.value"

* group[+]
  * code = #mood-changes
  * description = "Mood state changes"
  * population[0]
    * code = #denominator
    * criteria.language = #text/fhirpath
    * criteria.expression = "Observation.component.where(code.coding.code='373931001')"



// ===== Conteúdo de: MindfulnessCapabilities.fsh =====

Instance: MindfulnessCapabilityStatement
InstanceOf: CapabilityStatement
Usage: #definition
Title: "Mindfulness Module Capabilities"
Description: "Capabilities supported by the mindfulness module implementation"

* status = #draft
* date = "2024-03-19"
* kind = #requirements
* fhirVersion = #4.0.1
* format[0] = #json
* format[1] = #xml

* rest[0]
  * mode = #server
  * documentation = "RESTful server capabilities for mindfulness data"
  
  * resource[0]
    * type = #Observation
    * documentation = "Supports mindfulness session observations"
    * profile = "https://example.org/StructureDefinition/mindfulness-observation"
    * interaction[0]
      * code = #read
    * interaction[1]
      * code = #create
    * interaction[2]
      * code = #update
    * interaction[3]
      * code = #search-type
    * searchParam[0]
      * name = "patient"
      * type = #reference
      * documentation = "Search by patient reference"
    * searchParam[1]
      * name = "date"
      * type = #date
      * documentation = "Search by session date"
    * searchParam[2]
      * name = "code"
      * type = #token
      * documentation = "Search by observation type"
      
  * resource[1]
    * type = #Questionnaire
    * documentation = "Supports mindfulness questionnaires"
    * profile = "https://example.org/StructureDefinition/mindfulness-questionnaire"
    * interaction[0]
      * code = #read
    * interaction[1]
      * code = #search-type
    * searchParam[0]
      * name = "title"
      * type = #string
      * documentation = "Search by questionnaire title"
      
  * resource[2]
    * type = #QuestionnaireResponse
    * documentation = "Supports mindfulness questionnaire responses"
    * profile = "https://example.org/StructureDefinition/mindfulness-questionnaire-response"
    * interaction[0]
      * code = #create
    * interaction[1]
      * code = #read
    * interaction[2]
      * code = #search-type
    * searchParam[0]
      * name = "patient"
      * type = #reference
      * documentation = "Search by patient reference"
    * searchParam[1]
      * name = "authored"
      * type = #date
      * documentation = "Search by response date"



// ===== Conteúdo de: MindfulnessQuestionnaires.fsh =====

Instance: DailyMindfulnessQuestionnaire
InstanceOf: Questionnaire
Usage: #definition
Title: "Daily Mindfulness Questionnaire"
Description: "Questionnaire for capturing daily mindfulness practice and associated effects"

* url = "http://example.org/Questionnaire/daily-mindfulness"
* status = #active
* title = "Daily Mindfulness Practice"
* subjectType = #Patient
* version = "1.0.0"
* name = "DailyMindfulnessQuestionnaire"
* date = "2024-03-19"

* item[0]
  * linkId = "mindful_session"
  * text = "Mindfulness Session"
  * type = #group
  * repeats = false

  * item[0]
    * linkId = "session_duration"
    * text = "Session duration (minutes)"
    * type = #integer
    * required = true
    * extension[0].url = "http://hl7.org/fhir/StructureDefinition/minValue"
    * extension[0].valueInteger = 1

  * item[1]
    * linkId = "practice_type"
    * text = "Practice type"
    * type = #choice
    * required = true
    * answerOption[0].valueString = "Meditation"
    * answerOption[1].valueString = "Breathing exercise"
    * answerOption[2].valueString = "Body scan"
    * answerOption[3].valueString = "Mindful walking"

* item[1]
  * linkId = "mood_assessment"
  * text = "Mood Assessment"
  * type = #group

  * item[0]
    * linkId = "current_mood"
    * text = "How is your mood now?"
    * type = #choice
    * required = true
    * answerValueSet = "https://example.org/fhir/ValueSet/mood-vs"

  * item[1]
    * linkId = "mood_intensity"
    * text = "Mood intensity (1-5)"
    * type = #integer
    * required = true

* item[2]
  * linkId = "stress_assessment"
  * text = "Stress Assessment"
  * type = #group

  * item[0]
    * linkId = "stress_level"
    * text = "Stress level (0-10)"
    * type = #integer
    * required = true

  * item[1]
    * linkId = "stress_symptoms"
    * text = "Stress symptoms"
    * type = #choice
    * repeats = true
    * answerOption[0].valueString = "Muscle tension"
    * answerOption[1].valueString = "Anxiety"
    * answerOption[2].valueString = "Headache"
    * answerOption[3].valueString = "Fatigue"

* item[3]
  * linkId = "relaxation"
  * text = "Relaxation"
  * type = #group

  * item[0]
    * linkId = "relaxation_duration"
    * text = "Relaxation time (minutes)"
    * type = #integer
    * required = true

  * item[1]
    * linkId = "relaxation_technique"
    * text = "Technique used"
    * type = #choice
    * required = true
    * answerOption[0].valueString = "Deep breathing"
    * answerOption[1].valueString = "Progressive relaxation"
    * answerOption[2].valueString = "Visualization"
    * answerOption[3].valueString = "Mindful awareness"



// ===== Conteúdo de: NutritionQuestionnaires.fsh =====

Instance: DailyNutritionQuestionnaire
InstanceOf: Questionnaire
Usage: #definition
Title: "Daily Nutrition Intake Questionnaire"
Description: "Questionnaire for daily nutrition intake tracking"

* url = "https://github.com/RicardoLSantos/shorthand/Questionnaire/daily-nutrition"
* version = "0.1.0"
* name = "DailyNutritionQuestionnaire"
* title = "Daily Nutrition Intake"
* status = #active
* experimental = false
* date = "2024-12-14"
* publisher = "Ricardo Lourenço dos Santos"

* item[0]
  * linkId = "water_intake"
  * text = "How much water did you drink today?"
  * type = #quantity
  * required = true
  * repeats = false
  * initial.valueQuantity = 0 'mL'

* item[1]
  * linkId = "meal_record"
  * text = "Meal Records"
  * type = #group
  * repeats = true

  * item[0]
    * linkId = "meal_time"
    * text = "Meal Time"
    * type = #dateTime
    * required = true

  * item[1]
    * linkId = "meal_type"
    * text = "Meal Type"
    * type = #choice
    * required = true
    * answerOption[0].valueString = "Breakfast"
    * answerOption[1].valueString = "Lunch"
    * answerOption[2].valueString = "Dinner"
    * answerOption[3].valueString = "Snack"

  * item[2]
    * linkId = "calories"
    * text = "Estimated Calories"
    * type = #integer
    * required = true

  * item[3]
    * linkId = "macronutrients"
    * text = "Macronutrients"
    * type = #group

    * item[0]
      * linkId = "carbs"
      * text = "Carbohydrates (g)"
      * type = #decimal
      * required = true

    * item[1]
      * linkId = "protein"
      * text = "Proteins (g)"
      * type = #decimal
      * required = true

    * item[2]
      * linkId = "fat"
      * text = "Fats (g)"
      * type = #decimal
      * required = true

* item[2]
  * linkId = "caffeine"
  * text = "Caffeine Intake"
  * type = #group

  * item[0]
    * linkId = "caffeine_amount"
    * text = "Caffeine amount (mg)"
    * type = #integer
    * required = false

  * item[1]
    * linkId = "caffeine_source"
    * text = "Caffeine source"
    * type = #choice
    * repeats = true
    * answerOption[0].valueString = "Coffee"
    * answerOption[1].valueString = "Tea"
    * answerOption[2].valueString = "Soft Drink"
    * answerOption[3].valueString = "Energy Drink"



// ===== Conteúdo de: ReproductiveQuestionnaire.fsh =====

Instance: ReproductiveHealthQuestionnaire
InstanceOf: Questionnaire
Usage: #definition
Title: "Reproductive Health Tracking Questionnaire"
Description: "Daily questionnaire for reproductive health tracking"
 
* status = #active
* url = "http://example.org/Questionnaire/reproductive-health"
* name = "ReproductiveHealthQuestionnaire"
* title = "Reproductive Health Monitoring"
* date = "2024-03-19"
 
* item[0]
  * linkId = "menstrual_cycle"
  * text = "Menstrual Cycle"
  * type = #group
 
  * item[0]
    * linkId = "cycle_start"
    * text = "Cycle started today?"
    * type = #boolean
 
  * item[1]
    * linkId = "flow_intensity"
    * text = "Flow intensity"
    * type = #choice
    * enableWhen
      * question = "cycle_start"
      * operator = #=
      * answerBoolean = true
    * answerOption[0].valueString = "Light"
    * answerOption[1].valueString = "Moderate"
    * answerOption[2].valueString = "Heavy"
 
* item[1]
  * linkId = "symptoms"
  * text = "Symptoms"
  * type = #group
  * repeats = true
 
  * item[0]
    * linkId = "symptom_type"
    * text = "Symptom type"
    * type = #choice
    * answerValueSet = "http://example.org/ValueSet/reproductive-symptoms"
 
  * item[1]
    * linkId = "symptom_severity"
    * text = "Intensity (0-10)"
    * type = #integer
    * extension[0]
      * url = "http://hl7.org/fhir/StructureDefinition/minValue"
      * valueInteger = 0
    * extension[1]
      * url = "http://hl7.org/fhir/StructureDefinition/maxValue"
      * valueInteger = 10
 
* item[2]
  * linkId = "mood_changes"
  * text = "Mood Changes"
  * type = #group

  * item[0]
    * linkId = "mood_type"
    * text = "Current mood"
    * type = #choice
    * answerValueSet = "http://example.org/ValueSet/mood-types"

  * item[1]
    * linkId = "mood_severity"
    * text = "Intensity (0-10)"
    * type = #integer
    * extension[0]
      * url = "http://hl7.org/fhir/StructureDefinition/minValue"
      * valueInteger = 0
    * extension[1]
      * url = "http://hl7.org/fhir/StructureDefinition/maxValue"
      * valueInteger = 10



// ===== Conteúdo de: aliases.fsh =====

Alias: SCT = http://snomed.info/sct
Alias: LOINC = http://loinc.org
Alias: UCUM = http://unitsofmeasure.org



// ===== Conteúdo de: MindfulnessTerminology.fsh =====

CodeSystem: MindfulnessOutcomeCS
Id: mindfulness-outcome-cs
Title: "Mindfulness Outcomes"
Description: "Outcomes and effects of mindfulness practice"

* ^experimental = false
* ^caseSensitive = true
* #increasedAwareness "Increased Awareness" "Greater awareness of thoughts and sensations"
* #improvedFocus "Improved Focus" "Enhanced ability to concentrate"
* #stressReduction "Stress Reduction" "Decreased levels of stress and tension"
* #emotionalBalance "Emotional Balance" "Better emotional regulation"
* #improvedSleep "Improved Sleep" "Enhanced sleep quality"

ValueSet: MindfulnessOutcomeVS
Id: mindfulness-outcome-vs
Title: "Mindfulness Outcomes Value Set"
Description: "Value set for mindfulness practice outcomes"

* ^experimental = false
* include codes from system MindfulnessOutcomeCS
* include $SCT#365949003 "Finding of level of stress"
* include $SCT#373931001 "Mood finding"

CodeSystem: MindfulnessQualifierCS
Id: mindfulness-qualifier-cs
Title: "Mindfulness Practice Qualifiers"
Description: "Qualifiers for mindfulness practice characteristics"

* ^experimental = false
* ^caseSensitive = true
* #guided "Guided Practice" "Practice with guidance or instruction"
* #selfDirected "Self-Directed" "Independent practice"
* #group "Group Practice" "Practice in group setting"
* #individual "Individual Practice" "Solo practice session"

ValueSet: MindfulnessQualifierVS
Id: mindfulness-qualifier-vs
Title: "Mindfulness Practice Qualifiers Value Set"
Description: "Value set for mindfulness practice qualifiers"

* ^experimental = false
* include codes from system MindfulnessQualifierCS
* include $SCT#410534003 "Guided meditation"
* include $SCT#225386006 "Exercise therapy"

* ^copyright = "This value set includes content from SNOMED CT, which is copyright © 2002+ International Health Terminology Standards Development Organisation (IHTSDO)"



// ===== Conteúdo de: MindfulnessConfig.fsh =====

Extension: MindfulnessSessionDuration
Id: mindfulness-session-duration
Title: "Mindfulness Session Duration"
Description: "Default duration for mindfulness sessions in minutes"
* value[x] only integer

Extension: MindfulnessReminderTime
Id: mindfulness-reminder-time
Title: "Mindfulness Reminder Time"
Description: "Default time for daily reminders"
* value[x] only time

Extension: MindfulnessPreferredGuide
Id: mindfulness-preferred-guide
Title: "Mindfulness Preferred Guide"
Description: "Preferred guide for mindfulness sessions"
* value[x] only string

Extension: MindfulnessNotificationEnabled
Id: mindfulness-notification-enabled
Title: "Mindfulness Notification Enabled"
Description: "Whether notifications are enabled for mindfulness sessions"
* value[x] only boolean

Profile: MindfulnessConfiguration
Parent: Basic
Id: mindfulness-configuration
Title: "Mindfulness Configuration"
Description: "Configuration settings for mindfulness sessions"

* code 1..1 MS
* code = http://example.org/CodeSystem/mindfulness-config-type#settings "Mindfulness Settings"

* extension contains
    MindfulnessSessionDuration named sessionDuration 1..1 MS and
    MindfulnessReminderTime named reminderTime 1..1 MS and
    MindfulnessPreferredGuide named preferredGuide 0..1 MS and
    MindfulnessNotificationEnabled named notificationEnabled 1..1 MS

Instance: DefaultMindfulnessConfig
InstanceOf: MindfulnessConfiguration
Title: "Default Mindfulness Configuration"
Description: "Default configuration settings for mindfulness sessions"

* code = http://example.org/CodeSystem/mindfulness-config-type#settings "Mindfulness Settings"
* extension[sessionDuration].valueInteger = 15
* extension[reminderTime].valueTime = "08:00:00"
* extension[preferredGuide].valueString = "Jane Smith"
* extension[notificationEnabled].valueBoolean = true



// ===== Conteúdo de: MindfulnessAuditConfig.fsh =====

Extension: MindfulnessAuditLevel
Id: mindfulness-audit-level
Title: "Mindfulness Audit Level"
Description: "Level of detail for audit records"
* value[x] only code
* valueCode from http://example.org/fhir/ValueSet/audit-levels (required)

Extension: MindfulnessAuditRetention
Id: mindfulness-audit-retention
Title: "Mindfulness Audit Retention"
Description: "Period to retain audit records"
* value[x] only Duration

Extension: MindfulnessAuditFormat
Id: mindfulness-audit-format
Title: "Mindfulness Audit Format"
Description: "Format for audit records"
* value[x] only code
* valueCode from http://example.org/fhir/ValueSet/audit-formats (required)

Profile: MindfulnessAuditConfig
Parent: Basic
Id: mindfulness-audit-config
Title: "Mindfulness Audit Configuration"
Description: "Configuration for mindfulness session auditing"

* code 1..1 MS
* code = http://example.org/CodeSystem/mindfulness-config-type#audit "Audit Configuration"

* extension contains
    MindfulnessAuditLevel named auditLevel 1..1 MS and
    MindfulnessAuditRetention named auditRetention 1..1 MS and
    MindfulnessAuditFormat named auditFormat 1..1 MS

Instance: DefaultAuditConfig
InstanceOf: MindfulnessAuditConfig
Title: "Default Audit Configuration"
Description: "Default configuration for mindfulness session auditing"

* code = http://example.org/CodeSystem/mindfulness-config-type#audit "Audit Configuration"
* extension[auditLevel].valueCode = #detailed
* extension[auditRetention].valueDuration = 90 'days'
* extension[auditFormat].valueCode = #fhir



// ===== Conteúdo de: MindfulnessSecurity.fsh =====

Instance: MindfulnessSecurityDefinition
InstanceOf: Consent
Usage: #definition
Title: "Mindfulness Data Security Policy"

* status = #active
* scope = http://terminology.hl7.org/CodeSystem/consentscope#patient-privacy
* category = http://loinc.org#59284-0 "Consent Document"

* policy[0]
  * authority = "http://example.org/privacy-policy"
  * uri = "http://example.org/mindfulness-privacy"

* provision
  * type = #permit
  * period
    * start = "2024-03-19"
  * actor[0]
    * role = http://terminology.hl7.org/CodeSystem/v3-ParticipationType#PRCP
    * reference
      * identifier.system = "http://example.org/practitioners"
      * identifier.value = "mindfulness-practitioners"

RuleSet: SecurityRequirements
* meta.security from http://terminology.hl7.org/ValueSet/v3-SecurityPolicy (required)
* meta.tag from http://terminology.hl7.org/ValueSet/v3-Confidentiality (required)

* extension contains
    http://hl7.org/fhir/StructureDefinition/resource-security-category named securityCategory 0..1 MS and
    http://hl7.org/fhir/StructureDefinition/patient-confidentiality named confidentiality 0..1 MS

Instance: MindfulnessAccessPolicy
InstanceOf: Consent
Usage: #definition
Title: "Mindfulness Data Access Policy"

* status = #active
* scope = http://terminology.hl7.org/CodeSystem/consentscope#patient-privacy
* category = http://loinc.org#59284-0 "Consent Document"

* policy[0]
  * authority = "http://example.org/access-policy"
  * uri = "http://example.org/mindfulness-access"

* provision
  * type = #permit
  * period
    * start = "2024-03-19"
  * actor[0]
    * role = http://terminology.hl7.org/CodeSystem/v3-ParticipationType#PRCP
    * reference
      * identifier.system = "http://example.org/practitioners"
      * identifier.value = "mindfulness-practitioners"
  * action = http://terminology.hl7.org/CodeSystem/consentaction#access "Access"



// ===== Conteúdo de: MindfulnessResources.fsh =====

CodeSystem: MindfulnessTypeCS
Id: mindfulness-type-cs
Title: "Mindfulness Practice Types"
Description: "Types of mindfulness practices and techniques"
* ^experimental = false
* ^caseSensitive = true
* #meditation "Meditation" "Focused meditation practice"
* #breathing "Breathing Exercise" "Conscious breathing techniques"
* #bodyScan "Body Scan" "Progressive body awareness practice"
* #walking "Mindful Walking" "Walking meditation practice"
* #movement "Mindful Movement" "Conscious movement practice"

CodeSystem: EnvironmentTypeCS
Id: environment-type-cs
Title: "Practice Environment Types"
Description: "Types of environments for mindfulness practice"
* ^experimental = false
* ^caseSensitive = true
* #indoor "Indoor" "Indoor environment"
* #outdoor "Outdoor" "Outdoor environment"
* #quiet "Quiet Space" "Quiet or silent environment"
* #group "Group Setting" "Group practice environment"

ValueSet: MindfulnessTypeVS
Id: mindfulness-type-vs
Title: "Mindfulness Practice Types Value Set"
Description: "Value set of mindfulness practice types"
* ^experimental = false
* include codes from system MindfulnessTypeCS

ValueSet: EnvironmentTypeVS
Id: environment-type-vs
Title: "Practice Environment Types Value Set"
Description: "Value set of practice environment types"
* ^experimental = false
* include codes from system EnvironmentTypeCS

Instance: MindfulnessSettingCS
InstanceOf: CodeSystem
Usage: #definition
* url = "http://example.org/CodeSystem/mindfulness-setting"
* version = "1.0.0"
* name = "MindfulnessSettingCS"
* title = "Mindfulness Setting CodeSystem"
* status = #active
* experimental = false
* caseSensitive = true
* content = #complete
* count = 5
* concept[+].code = #home
* concept[=].display = "Home Practice"
* concept[+].code = #clinic
* concept[=].display = "Clinical Setting"
* concept[+].code = #group
* concept[=].display = "Group Setting"
* concept[+].code = #retreat
* concept[=].display = "Retreat Setting"
* concept[+].code = #workplace
* concept[=].display = "Workplace Setting"



// ===== Conteúdo de: MindfulnessNarrative.fsh =====

RuleSet: MindfulnessObservationNarrative
* text.status = #generated
* text.div = "<div xmlns=\"http://www.w3.org/1999/xhtml\">
    <p><b>Generated Narrative</b></p>
    <p><b>Session Type:</b> Mindfulness Practice Session</p>
    <p><b>Date:</b> {effectiveDateTime}</p>
    <p><b>Duration:</b> {component[sessionDuration].value} minutes</p>
    <p><b>Stress Level:</b> {component[stressLevel].value} / 10</p>
    <p><b>Mood:</b> {component[moodState].value}</p>
    <p><b>Technique:</b> {component[relaxationResponse].value}</p>
    <p><b>Location:</b> {extension[mindfulness-context].extension[location].value}</p>
  </div>"

RuleSet: MindfulnessQuestionnaireNarrative
* text.status = #generated
* text.div = "<div xmlns=\"http://www.w3.org/1999/xhtml\">
    <p><b>Generated Narrative</b></p>
    <p><b>Title:</b> {title}</p>
    <p><b>Status:</b> {status}</p>
    <h3>Sections</h3>
    <ul>
      <li>Mindfulness Session</li>
      <li>Mood Assessment</li>
      <li>Stress Assessment</li>
      <li>Relaxation</li>
    </ul>
  </div>"

RuleSet: MindfulnessResponseNarrative
* text.status = #generated
* text.div = "<div xmlns=\"http://www.w3.org/1999/xhtml\">
    <p><b>Generated Narrative</b></p>
    <p><b>Date:</b> {authored}</p>
    <p><b>Session Duration:</b> {item[session_duration].answer.value} minutes</p>
    <p><b>Practice Type:</b> {item[practice_type].answer.value}</p>
    <p><b>Mood:</b> {item[current_mood].answer.value}</p>
    <p><b>Stress Level:</b> {item[stress_level].answer.value} / 10</p>
    <p><b>Relaxation Technique:</b> {item[relaxation_technique].answer.value}</p>
  </div>"

RuleSet: MindfulnessConfigNarrative
* text.status = #generated
* text.div = "<div xmlns=\"http://www.w3.org/1999/xhtml\">
    <p><b>Generated Narrative</b></p>
    <p><b>Default Duration:</b> {extension[defaultDuration].value} minutes</p>
    <p><b>Reminders:</b> {extension[reminderSettings].value}</p>
    <p><b>Data Sync:</b> {extension[dataSync].value}</p>
  </div>"



// ===== Conteúdo de: StressInvariants.fsh =====

Invariant: stress-level-range
Description: "Stress level score must be between 0 and 10"
Expression: "valueQuantity.exists() implies (valueQuantity.value >= 0 and valueQuantity.value <= 10)"
Severity: #error

Invariant: stress-component-consistency
Description: "Physiological and psychological stress scores must be consistent with overall score"
Expression: "component.where(code.coding.code='89593-8').value.exists() and component.where(code.coding.code='89594-6').value.exists() implies (component.where(code.coding.code='89593-8').value + component.where(code.coding.code='89594-6').value) div 2 = valueQuantity"
Severity: #warning



// ===== Conteúdo de: SocialInteractionInvariants.fsh =====

Invariant: social-interaction-duration
Description: "Social interaction duration must be positive"
Expression: "component.where(code.coding.code='89597-9').value.exists() implies component.where(code.coding.code='89597-9').value > 0"
Severity: #error

Invariant: social-interaction-participants
Description: "Number of participants must be at least 2 for social interaction"
Expression: "component.where(code.coding.code='89600-1').value.exists() implies component.where(code.coding.code='89600-1').value >= 2"
Severity: #error



// ===== Conteúdo de: MindfulnessInvariants.fsh =====

Invariant: mindfulness-session-duration
Description: "Mindfulness session duration must be between 1 and 180 minutes"
Expression: "component.where(code.coding.system='http://snomed.info/sct' and code.coding.code='118682006').value.ofType(Quantity).value.exists() implies (component.where(code.coding.system='http://snomed.info/sct' and code.coding.code='118682006').value.ofType(Quantity).value >= 1 and component.where(code.coding.system='http://snomed.info/sct' and code.coding.code='118682006').value.ofType(Quantity).value <= 180)"
Severity: #error

Invariant: mindfulness-stress-level
Description: "Stress level must be between 0 and 10"
Expression: "component.where(code.coding.system='http://snomed.info/sct' and code.coding.code='725854004').value.ofType(Integer).exists() implies (component.where(code.coding.system='http://snomed.info/sct' and code.coding.code='725854004').value.ofType(Integer) >= 0 and component.where(code.coding.system='http://snomed.info/sct' and code.coding.code='725854004').value.ofType(Integer) <= 10)"
Severity: #error

Invariant: mindfulness-mood-required
Description: "Mood assessment must include a mood state and intensity"
Expression: "component.where(code.coding.system='http://snomed.info/sct' and code.coding.code='373931001').exists() implies component.where(code.coding.system='http://snomed.info/sct' and code.coding.code='373931001').value.exists()"
Severity: #warning

Invariant: mindfulness-context-complete
Description: "Mindfulness context should include location and environment"
Expression: "extension.where(url='https://example.org/StructureDefinition/mindfulness-context').exists() implies (extension.where(url='https://example.org/StructureDefinition/mindfulness-context').extension.where(url='location').exists() and extension.where(url='https://example.org/StructureDefinition/mindfulness-context').extension.where(url='environment').exists())"
Severity: #warning

Invariant: sequential-measurements
Description: "Sequential measurements must have increasing effectiveDateTime"
Expression: "component.where(code.coding.system='http://snomed.info/sct' and code.coding.code='118682006').exists() implies (effectiveDateTime > previous().effectiveDateTime)"
Severity: #warning



// ===== Conteúdo de: MindfulnessOperations.fsh =====

Profile: MindfulnessOperation
Parent: OperationDefinition 
Id: mindfulness-operation
Title: "Mindfulness Operation"
Description: "Base definition for mindfulness operations"

* status 1..1
* kind 1..1
* name 1..1
* code 1..1
* resource 1..1
* system 1..1
* type 1..1
* instance 1..1
* parameter 0..*
* parameter.name 1..1

Instance: StartSessionOperation
InstanceOf: MindfulnessOperation
Title: "Start Session Operation"
Description: "Operation to start a new mindfulness session"

* status = #active
* kind = #operation
* name = "start-session"
* code = #start
* resource = #Observation
* system = false
* type = true
* instance = false
* parameter[+]
  * name = #duration
  * use = #in
  * min = 1
  * max = "1" 
  * type = #integer
  * documentation = "Duration in minutes"

Instance: EndSessionOperation
InstanceOf: MindfulnessOperation
Title: "End Session Operation"
Description: "Operation to end an ongoing mindfulness session"

* status = #active
* kind = #operation
* name = "end-session"
* code = #end
* resource = #Observation
* system = false
* type = true
* instance = true
* parameter[+]
  * name = #session
  * use = #in
  * min = 1
  * max = "1"
  * type = #string
  * documentation = "ID of the session to end"



// ===== Conteúdo de: VitalSignsExtensions.fsh =====

Extension: MeasurementContext
Id: measurement-context
Title: "Measurement Context Extension"
Description: "Additional context about the vital sign measurement"
* value[x] only CodeableConcept
* valueCodeableConcept from MeasurementContextVS (required)

ValueSet: MeasurementContextVitalSigns
Id: measurement-context-vital-signs
Title: "Measurement Context Value Set"
* $SCT#255214003 "At rest"
* $SCT#309604004 "During exercise"
* $SCT#309605003 "Post exercise"
* $SCT#248626006 "During sleep"



// ===== Conteúdo de: NutritionExtensions.fsh =====

Extension: NutritionDataSource
Id: nutrition-data-source
Title: "Nutrition Data Source Extension"
Description: "Indicates the source of nutrition data"

* ^version = "0.1.0"
* ^status = #draft
* ^experimental = false
* ^date = "2024-12-14"
* ^publisher = "Ricardo Lourenço dos Santos"
* ^context[0].type = #element
* ^context[0].expression = "Observation"

* value[x] only CodeableConcept
* valueCodeableConcept from NutritionDataSourceVS (required)

ValueSet: NutritionDataSourceVS
Id: nutrition-data-source-vs
Title: "Nutrition Data Source Value Set"
Description: "Value set for nutrition data sources"

* ^version = "0.1.0"
* ^status = #draft
* ^experimental = false
* ^date = "2024-12-14"
* ^publisher = "Ricardo Lourenço dos Santos"

* codes from system NutritionDataSourceCS

CodeSystem: NutritionDataSourceCS
Id: nutrition-data-source-cs
Title: "Nutrition Data Source Code System"
Description: "Code system for nutrition data sources"

* ^version = "0.1.0"
* ^status = #draft
* ^experimental = false
* ^date = "2024-12-14"
* ^publisher = "Ricardo Lourenço dos Santos"
* ^caseSensitive = true

* #manual "Manual Entry" "Data entered manually by user"
* #app "App Integration" "Data from integrated third-party apps"
* #device "Connected Device" "Data from connected nutrition tracking devices"
* #questionnaire "Questionnaire Response" "Data collected through questionnaires"



// ===== Conteúdo de: AdvancedVitalSignsExtensions.fsh =====

Alias: $UCUM = http://unitsofmeasure.org

Extension: PhysiologicalStressIndex
Id: physiological-stress-index
Title: "Physiological Stress Index Extension"
Description: "Index representing overall physiological stress based on multiple parameters"

* ^version = "0.1.0"
* ^status = #draft
* ^context[+].type = #element
* ^context[=].expression = "Observation"

* value[x] only Quantity
* valueQuantity.system = $UCUM
* valueQuantity.code = #{index}
* valueQuantity ^short = "Physiological stress index value"
* valueQuantity ^definition = "Normalized index value representing overall physiological stress"

Extension: HomeostasisIndex
Id: homeostasis-index
Title: "Homeostasis Index Extension"
Description: "Composite measure of physiological balance and adaptation"

* ^version = "0.1.0"
* ^status = #draft
* ^context[+].type = #element
* ^context[=].expression = "Observation"

* value[x] only Quantity
* valueQuantity.system = $UCUM
* valueQuantity.code = #{ratio}
* valueQuantity ^short = "Homeostasis index value"
* valueQuantity ^definition = "Normalized ratio representing physiological balance"

Extension: RecoveryEfficiency
Id: recovery-efficiency
Title: "Recovery Efficiency Extension"
Description: "Measure of how efficiently the body recovers from stress or exertion"

* ^version = "0.1.0"
* ^status = #draft
* ^context[+].type = #element
* ^context[=].expression = "Observation"

* value[x] only Quantity
* valueQuantity.system = $UCUM
* valueQuantity.code = #%
* valueQuantity ^short = "Recovery efficiency percentage"
* valueQuantity ^definition = "Percentage indicating recovery efficiency"

Extension: AllostaticLoad
Id: allostatic-load
Title: "Allostatic Load Extension"
Description: "Measure of cumulative physiological burden over time"

* ^version = "0.1.0"
* ^status = #draft
* ^context[+].type = #element
* ^context[=].expression = "Observation"

* value[x] only Quantity
* valueQuantity.system = $UCUM
* valueQuantity.code = #{score}
* valueQuantity ^short = "Allostatic load score"
* valueQuantity ^definition = "Score representing cumulative physiological burden"

Extension: CircadianPhase
Id: circadian-phase
Title: "Circadian Phase Extension"
Description: "Indicator of position in circadian rhythm cycle"

* ^version = "0.1.0"
* ^status = #draft
* ^context[+].type = #element
* ^context[=].expression = "Observation"

* value[x] only CodeableConcept
* valueCodeableConcept from CircadianPhaseVS (required)

ValueSet: CircadianPhaseVS
Id: circadian-phase-vs
Title: "Circadian Phase Value Set"
Description: "Value set for circadian rhythm phases"

* ^experimental = true
* codes from system CircadianPhaseCS

CodeSystem: CircadianPhaseCS
Id: circadian-phase-cs
Title: "Circadian Phase Code System"
Description: "Code system for circadian rhythm phases"

* ^experimental = true
* ^caseSensitive = true

* #early-morning "Early Morning Phase" "Period shortly after awakening"
* #mid-morning "Mid Morning Phase" "Mid-morning period"
* #afternoon "Afternoon Phase" "Afternoon period"
* #evening "Evening Phase" "Evening period"
* #night "Night Phase" "Nighttime period"
* #deep-night "Deep Night Phase" "Deep night period"

Extension: MeasurementQuality
Id: measurement-quality
Title: "Measurement Quality Extension"
Description: "Indicator of the quality and reliability of the measurement"

* ^version = "0.1.0"
* ^status = #draft
* ^context[+].type = #element
* ^context[=].expression = "Observation"

* value[x] only CodeableConcept
* valueCodeableConcept from MeasurementQualityVS (required)

ValueSet: MeasurementQualityVS
Id: measurement-quality-vs
Title: "Measurement Quality Value Set"
Description: "Value set for measurement quality indicators"

* ^experimental = true
* codes from system MeasurementQualityCS

CodeSystem: MeasurementQualityCS
Id: measurement-quality-cs
Title: "Measurement Quality Code System"
Description: "Code system for measurement quality indicators"

* ^experimental = true
* ^caseSensitive = true

* #excellent "Excellent Quality" "High quality measurement with minimal noise"
* #good "Good Quality" "Good quality measurement with acceptable noise"
* #fair "Fair Quality" "Fair quality measurement with some interference"
* #poor "Poor Quality" "Poor quality measurement with significant interference"
* #unreliable "Unreliable" "Unreliable measurement requiring verification"



// ===== Conteúdo de: StressExtensions.fsh =====

Extension: StressTriggers
Id: stress-triggers
Title: "Stress Triggers Extension"
Description: "Extension for recording identified stress triggers"
* value[x] only CodeableConcept
* valueCodeableConcept from StressTriggersVS (required)

Extension: StressCoping
Id: stress-coping
Title: "Stress Coping Extension"
Description: "Extension for recording stress coping mechanisms"
* value[x] only CodeableConcept
* valueCodeableConcept from StressCopingVS (required)

ValueSet: StressTriggersVS
Id: stress-triggers-vs
Title: "Stress Triggers Value Set"
Description: "Value set for common stress triggers"
* codes from system StressTriggersCS

ValueSet: StressCopingVS
Id: stress-coping-vs
Title: "Stress Coping Value Set"
Description: "Value set for stress coping mechanisms"
* codes from system StressCopingCS

CodeSystem: StressTriggersCS
Id: stress-triggers-cs
Title: "Stress Triggers Code System"
Description: "Code system for common stress triggers"
* #work "Work-related" "Stress from work or professional activities"
* #financial "Financial" "Financial-related stress"
* #relationships "Relationships" "Stress from personal relationships"
* #health "Health" "Health-related concerns"
* #environment "Environmental" "Environmental factors"
* #time "Time Management" "Time pressure and deadlines"
* #change "Life Changes" "Major life changes or transitions"

CodeSystem: StressCopingCS
Id: stress-coping-cs
Title: "Stress Coping Code System"
Description: "Code system for stress coping mechanisms"
* #exercise "Physical Exercise" "Using exercise to manage stress"
* #meditation "Meditation" "Meditation and mindfulness practices"
* #social "Social Support" "Seeking social support"
* #professional "Professional Help" "Seeking professional assistance"
* #relaxation "Relaxation" "Relaxation techniques"
* #creative "Creative Activities" "Engaging in creative activities"
* #nature "Nature" "Spending time in nature"



// ===== Conteúdo de: EnvironmentalExtensions.fsh =====

Extension: ExposureLocation
Id: exposure-location
Title: "Exposure Location Extension"
Description: "Extension for recording location of environmental exposure measurement"

* ^version = "0.1.0"
* ^status = #draft
* ^context[+].type = #element
* ^context[=].expression = "Observation"

* value[x] only CodeableConcept
* valueCodeableConcept from ExposureLocationVS (required)
* valueCodeableConcept ^short = "Location type of exposure"
* valueCodeableConcept ^definition = "Categorizes the type of location where environmental exposure occurred"

Extension: ExposureConditions
Id: exposure-conditions
Title: "Exposure Conditions Extension"
Description: "Additional conditions during environmental exposure measurement"

* ^version = "0.1.0"
* ^status = #draft
* ^context[+].type = #element
* ^context[=].expression = "Observation"

* value[x] only CodeableConcept
* valueCodeableConcept from ExposureConditionsVS (required)
* valueCodeableConcept ^short = "Conditions during exposure"

ValueSet: ExposureLocationVS
Id: exposure-location-vs
Title: "Exposure Location Value Set"
Description: "Value set for environmental exposure locations"

* ^version = "0.1.0"
* ^status = #draft
* ^experimental = true
* codes from system ExposureLocationCS

ValueSet: ExposureConditionsVS
Id: exposure-conditions-vs
Title: "Exposure Conditions Value Set"
Description: "Value set for environmental exposure conditions"

* ^version = "0.1.0"
* ^status = #draft
* ^experimental = true
* codes from system ExposureConditionsCS

CodeSystem: ExposureLocationCS
Id: exposure-location-cs
Title: "Exposure Location Code System"
Description: "Code system for environmental exposure locations"

* ^version = "0.1.0"
* ^status = #draft
* ^caseSensitive = true
* ^experimental = true

* #indoor "Indoor environment" "Environment within buildings or enclosed spaces"
* #outdoor "Outdoor environment" "Open-air environment"
* #workplace "Workplace" "Professional or occupational environment"
* #transit "In transit" "While in transportation or commuting"
* #recreational "Recreational area" "Leisure or sports facilities"
* #urban "Urban area" "City or densely populated area"
* #rural "Rural area" "Countryside or sparsely populated area"

CodeSystem: ExposureConditionsCS
Id: exposure-conditions-cs
Title: "Exposure Conditions Code System"
Description: "Code system for conditions during environmental exposure"

* ^version = "0.1.0"
* ^status = #draft
* ^caseSensitive = true
* ^experimental = true

* #normal "Normal conditions" "Standard environmental conditions"
* #extreme "Extreme conditions" "Unusual or severe environmental conditions"
* #controlled "Controlled environment" "Environment with controlled conditions"
* #variable "Variable conditions" "Changing environmental conditions"



// ===== Conteúdo de: BodyMetricsExtensions.fsh =====

Alias: $SCT = http://snomed.info/sct

Extension: MeasurementConditions
Id: measurement-conditions
Title: "Measurement Conditions Extension"
Description: "Records the conditions under which body measurements were taken"

* ^version = "0.1.0"
* ^status = #draft
* ^context[0].type = #element
* ^context[0].expression = "Observation"

* value[x] only CodeableConcept
* valueCodeableConcept from MeasurementConditionsVS (required)

Extension: MeasurementDevice
Id: measurement-device-type
Title: "Measurement Device Type Extension"
Description: "Specifies the type of device used for body measurements"

* ^version = "0.1.0"
* ^status = #draft
* ^context[0].type = #element
* ^context[0].expression = "Observation"

* value[x] only CodeableConcept
* valueCodeableConcept from MeasurementDeviceTypeVS (required)

ValueSet: MeasurementConditionsVS
Id: measurement-conditions-vs
Title: "Measurement Conditions Value Set"
Description: "Standard conditions under which measurements are taken"

* ^version = "0.1.0"
* ^status = #draft

* $SCT#307818003 "Pre-breakfast"
* $SCT#307819006 "Post-exercise"
* $SCT#307820000 "Wearing light clothing"
* $SCT#255203001 "First thing in morning"
* $SCT#255214005 "After void"
* $SCT#309604004 "During rest"

ValueSet: MeasurementDeviceTypeVS
Id: measurement-device-type-vs
Title: "Measurement Device Type Value Set"
Description: "Types of devices used for health and body measurements"

* ^version = "0.1.0"
* ^status = #draft

* $SCT#469576000 "Smart watch"
* $SCT#706767009 "Body composition analyzer"
* $SCT#131009002 "Height measuring device"
* $SCT#706889009 "Blood pressure monitor"
* $SCT#444699000 "Tape measure"
* $SCT#44056008  "Digital scale"

Instance: WeightWithConditions
InstanceOf: WeightObservation
Usage: #example
Title: "Weight Measurement with Conditions Example"

* status = #final
* category = http://terminology.hl7.org/CodeSystem/observation-category#vital-signs
* code = $LOINC#29463-7 "Body weight"
* subject = Reference(Patient/example)
* effectiveDateTime = "2024-03-19T08:00:00Z"
* valueQuantity = 70.5 'kg'

* extension[measurement-conditions].url = "https://github.com/RicardoLSantos/shorthand/StructureDefinition/measurement-conditions"
* extension[measurement-conditions].valueCodeableConcept = $SCT#307818003 "Pre-breakfast"

* extension[measurement-device-type].url = "https://github.com/RicardoLSantos/shorthand/StructureDefinition/measurement-device-type"
* extension[measurement-device-type].valueCodeableConcept = $SCT#469576000 "Smart scale device"



// ===== Conteúdo de: SleepQuality.fsh =====

Extension: SleepQuality
Id: sleep-quality
Title: "Sleep Quality Extension"
Description: "Extension for recording subjective sleep quality"
* value[x] only CodeableConcept
* valueCodeableConcept from SleepQualityExtendedVS (required)
 
ValueSet: SleepQualityExtendedVS
Id: sleep-quality-extended-vs
Title: "Sleep Quality Value Set"
* $SCT#248220008 "Very good quality sleep"
* $SCT#248221007 "Good quality sleep"
* $SCT#248222000 "Poor quality sleep"
* $SCT#248223005 "Very poor quality sleep"



// ===== Conteúdo de: MindfulnessExtensions.fsh =====

Extension: MindfulnessContext
Id: mindfulness-context
Title: "Mindfulness Session Context"
Description: "Additional context about the mindfulness practice session"

* ^url = "https://example.org/StructureDefinition/mindfulness-context"
* ^version = "1.0.0"
* ^status = #draft
* ^date = "2024-03-19"
* ^publisher = "Example Organization"

* extension contains
    location 0..1 and
    environment 0..1 and
    guidance 0..1

* extension[location].value[x] only string
* extension[location].valueString 1..1
* extension[location] ^short = "Physical location of practice"
* extension[location] ^definition = "The physical location where the mindfulness practice took place"

* extension[environment].value[x] only CodeableConcept
* extension[environment].valueCodeableConcept from http://example.org/ValueSet/environment-type (required)
* extension[environment] ^short = "Environmental conditions"
* extension[environment] ^definition = "The environmental conditions during the practice session"

* extension[guidance].value[x] only boolean
* extension[guidance].valueBoolean 1..1
* extension[guidance] ^short = "Whether guidance was used"
* extension[guidance] ^definition = "Indicates if the session was guided or self-directed"



// ===== Conteúdo de: SocialInteractionExtensions.fsh =====

Extension: SocialContext
Id: social-context
Title: "Social Context Extension"
Description: "Extension for recording the context of social interaction"
* value[x] only CodeableConcept
* valueCodeableConcept from SocialContextVS (required)

Extension: SocialSupport
Id: social-support
Title: "Social Support Extension"
Description: "Extension for recording perceived social support"
* value[x] only CodeableConcept
* valueCodeableConcept from SocialSupportVS (required)

Extension: SocialActivity
Id: social-activity
Title: "Social Activity Extension"
Description: "Extension for recording specific social activities"
* value[x] only CodeableConcept
* valueCodeableConcept from SocialActivityVS (required)

ValueSet: SocialContextVS
Id: social-context-vs
Title: "Social Context Value Set"
Description: "Value set for social interaction contexts"
* codes from system SocialContextCS

ValueSet: SocialSupportVS
Id: social-support-vs
Title: "Social Support Value Set"
Description: "Value set for levels of social support"
* codes from system SocialSupportCS

ValueSet: SocialActivityVS
Id: social-activity-vs
Title: "Social Activity Value Set"
Description: "Value set for types of social activities"
* codes from system SocialActivityCS

CodeSystem: SocialContextCS
Id: social-context-cs
Title: "Social Context Code System"
Description: "Code system for social interaction contexts"
* #home "Home" "Home environment"
* #work "Work" "Work environment"
* #education "Educational" "Educational setting"
* #community "Community" "Community setting"
* #recreational "Recreational" "Recreational setting"
* #healthcare "Healthcare" "Healthcare setting"

CodeSystem: SocialSupportCS
Id: social-support-cs
Title: "Social Support Code System"
Description: "Code system for levels of social support"
* #strong "Strong Support" "Strong social support network"
* #adequate "Adequate Support" "Sufficient social support"
* #limited "Limited Support" "Limited social support"
* #minimal "Minimal Support" "Minimal social support"
* #none "No Support" "Absence of social support"

CodeSystem: SocialActivityCS
Id: social-activity-cs
Title: "Social Activity Code System"
Description: "Code system for types of social activities"
* #meal "Shared Meal" "Sharing a meal together"
* #exercise "Group Exercise" "Group physical activity"
* #entertainment "Entertainment" "Shared entertainment activity"
* #learning "Learning" "Group learning activity"
* #volunteering "Volunteering" "Community service activity"
* #celebration "Celebration" "Social celebration or event"



// ===== Conteúdo de: SleepExtensions.fsh =====




// ===== Conteúdo de: MobilityExtensions.fsh =====

Extension: MobilityAlertLevel
Id: mobility-alert-level
Title: "Mobility Alert Level Extension"
Description: "Extension for mobility measurements alert levels to indicate the severity or concern level of mobility changes detected by the device"
* ^status = #active
* ^context[0].type = #element
* ^context[0].expression = "Observation"
* . ^short = "Mobility alert level indicator"
* . ^definition = "Indicates the severity level of mobility changes or concerns based on device measurements"
* value[x] only CodeableConcept
* valueCodeableConcept from MobilityAlertLevelVS (required)
* valueCodeableConcept ^short = "Alert level code"
* valueCodeableConcept ^definition = "The specific alert level code indicating the severity of mobility changes"

ValueSet: MobilityAlertLevelVS
Id: mobility-alert-level-vs
Title: "Mobility Alert Level Value Set"
Description: "Value set for mobility measurement alert levels used to categorize the severity of mobility changes or concerns"
* ^status = #active
* ^experimental = false
* ^purpose = "To provide standardized alert levels for mobility measurements"
* codes from system MobilityAlertLevelCS

CodeSystem: MobilityAlertLevelCS
Id: mobility-alert-level-cs
Title: "Mobility Alert Level Code System"
Description: "Code system defining alert levels for mobility measurements, indicating the severity of changes in mobility patterns"
* ^status = #active
* ^experimental = false
* ^caseSensitive = true
* ^content = #complete
* #green "Normal - No concern" "Mobility measurements are within normal range and show no concerning patterns"
* #yellow "Caution - Monitor closely" "Mobility measurements show slight deviations that warrant closer monitoring"
* #red "Alert - Significant change" "Mobility measurements indicate significant changes that require immediate attention"
* ^property[0].code = #status
* ^property[0].type = #code
* ^property[0].description = "The status of the alert level"
* ^property[1].code = #severity
* ^property[1].type = #integer
* ^property[1].description = "Numeric value indicating severity (1=low, 3=high)"



// ===== Conteúdo de: ActivityExtensions.fsh =====




// ===== Conteúdo de: MobilityRiskValueSets.fsh =====

ValueSet: FallRiskOutcomesValueSet
Id: fall-risk-outcomes
Title: "Fall Risk Outcomes Value Set"
Description: "Value set for fall risk assessment outcomes"
* ^url = "http://example.org/fhir/ValueSet/fall-risk-outcomes"
* ^status = #active
* include codes from system http://example.org/fhir/CodeSystem/fall-risk-outcomes

ValueSet: RiskLevelValueSet
Id: risk-level
Title: "Risk Level Value Set"
Description: "Value set for general risk levels"
* ^url = "http://example.org/fhir/ValueSet/risk-level"
* ^status = #active
* include codes from system http://example.org/fhir/CodeSystem/risk-level

ValueSet: MobilityDeclineOutcomesValueSet
Id: mobility-decline-outcomes
Title: "Mobility Decline Outcomes Value Set"
Description: "Value set for mobility decline assessment outcomes"
* ^url = "http://example.org/fhir/ValueSet/mobility-decline-outcomes"
* ^status = #active
* include codes from system http://example.org/fhir/CodeSystem/mobility-decline-outcomes

ValueSet: AssistanceLevelOutcomesValueSet
Id: assistance-level-outcomes
Title: "Assistance Level Outcomes Value Set"
Description: "Value set for assistance level assessment outcomes"
* ^url = "http://example.org/fhir/ValueSet/assistance-level-outcomes"
* ^status = #active
* include codes from system http://example.org/fhir/CodeSystem/assistance-level-outcomes



// ===== Conteúdo de: SymptomValueSets.fsh =====

CodeSystem: SymptomSeverityCS
Id: symptom-severity-cs
Title: "Symptom Severity Code System"
Description: "Severity levels for symptoms"

* #1-3 "Light" "Symptom barely noticeable"
* #4-6 "Mild" "Symptom noticeable but not interfering with daily activities"
* #7-8 "Intense" "Symptom interfering with daily activities"
* #9-10 "Severe" "Symptom preventing daily activities"

ValueSet: BodyLocationsVS
Id: body-locations-vs
Title: "Body Locations Value Set"
Description: "Anatomical locations for symptom recording"
* $SCT#12738006 "Brain"
* $SCT#69536005 "Head"
* $SCT#45048000 "Neck"
* $SCT#51185008 "Chest"
* $SCT#62413002 "Abdomen"
* $SCT#32849002 "Back"
* $SCT#53120007 "Upper limb"
* $SCT#61685007 "Lower limb"

ValueSet: DurationUnitsVS
Id: duration-units-vs
Title: "Duration Units Value Set"
Description: "Time units for symptom duration"
* $UCUM#min "Minutes"
* $UCUM#h "Hours"
* $UCUM#d "Days"
* $UCUM#wk "Weeks"
* $UCUM#mo "Months"

CodeSystem: SymptomFrequencyCS
Id: symptom-frequency-cs
Title: "Symptom Frequency Code System"
Description: "Frequency patterns for symptoms"
* #rare "Rare" "Less than once per month"
* #occasional "Occasional" "Several times per month"
* #frequent "Frequent" "Several times per week"
* #daily "Daily" "Once or more per day"
* #constant "Constant" "Present most of the time"

ValueSet: SymptomFrequencyVS
Id: symptom-frequency-vs
Title: "Symptom Frequency Value Set"
Description: "Frequency patterns for symptoms"
* codes from system SymptomFrequencyCS

CodeSystem: SymptomImpactCS
Id: symptom-impact-cs
Title: "Symptom Impact Code System"
Description: "Impact levels of symptoms on daily activities"
* #none "No impact"
* #mild "Mild impact"
* #moderate "Moderate impact"
* #severe "Severe impact"
* #complete "Complete impact"

ValueSet: SymptomImpactVS
Id: symptom-impact-vs
Title: "Symptom Impact Value Set"
Description: "Impact levels for symptoms"
* codes from system SymptomImpactCS

ValueSet: SymptomProgressionVS
Id: symptom-progression-vs
Title: "Symptom Progression Value Set"
Description: "Progression patterns for symptoms"
* $SCT#385633008 "Improving"
* $SCT#58158008 "Stable"
* $SCT#230993007 "Worsening"
* $SCT#255314001 "Fluctuating"

ValueSet: TimeOfDayVS
Id: time-of-day-vs
Title: "Time of Day Value Set"
Description: "Times of day for symptom occurrence"
* $SCT#73775008 "Morning"
* $SCT#255253008 "Afternoon"
* $SCT#2546009 "Evening"
* $SCT#73768005 "Night"



// ===== Conteúdo de: StressValueSets.fsh =====

ValueSet: StressChronicityVS
Id: stress-chronicity-vs
Title: "Stress Chronicity Value Set"
Description: "Value set for classifying stress chronicity"
* ^url = "https://github.com/RicardoLSantos/shorthand/ValueSet/stress-chronicity-vs"
* codes from system StressChronicityCS

ValueSet: StressImpactVS
Id: stress-impact-vs
Title: "Stress Impact Value Set"
Description: "Value set for describing stress impact levels"
* ^url = "https://github.com/RicardoLSantos/shorthand/ValueSet/stress-impact-vs"
* codes from system StressImpactCS

CodeSystem: StressChronicityCS
Id: stress-chronicity-cs
Title: "Stress Chronicity Code System"
Description: "Code system for stress chronicity classification"
* ^url = "https://github.com/RicardoLSantos/shorthand/CodeSystem/stress-chronicity-cs"
* #acute "Acute" "Short-term stress response"
* #subacute "Subacute" "Medium-term stress response"
* #chronic "Chronic" "Long-term stress response"
* #episodic "Episodic" "Recurring stress episodes"
* #persistent "Persistent" "Continuous stress state"

CodeSystem: StressImpactCS
Id: stress-impact-cs
Title: "Stress Impact Code System"
Description: "Code system for stress impact levels"
* ^url = "https://github.com/RicardoLSantos/shorthand/CodeSystem/stress-impact-cs"
* #minimal "Minimal Impact" "Little to no interference with daily activities"
* #mild "Mild Impact" "Some interference with daily activities"
* #moderate "Moderate Impact" "Significant interference with daily activities"
* #severe "Severe Impact" "Major interference with daily activities"
* #extreme "Extreme Impact" "Unable to perform daily activities"



// ===== Conteúdo de: ReproductiveValueSets.fsh =====

ValueSet: ReproductiveGoalVS
Id: reproductive-goal-vs
Title: "Reproductive Health Goals Value Set"
Description: "Goals related to reproductive health tracking and planning"

* ^status = #active
* ^experimental = false
* ^date = "2024-03-19"

* $LOINC#8708-0 "Menstrual cycle length"
* $LOINC#55284-4 "Blood pressure"
* $LOINC#8310-5 "Body temperature"
* $LOINC#8302-2 "Body height"
* $LOINC#29463-7 "Body weight"
* $SCT#364311006 "Menstrual cycle monitoring"
* $SCT#289530006 "Reproductive health finding"

ValueSet: ReproductiveActivityVS
Id: reproductive-activity-vs
Title: "Reproductive Health Activities Value Set"
Description: "Activities related to reproductive health monitoring"

* ^status = #active
* ^experimental = false
* ^date = "2024-03-19"

* codes from system ReproductiveActivityCS

CodeSystem: ReproductiveActivityCS
Id: reproductive-activity-cs
Title: "Reproductive Health Activities Code System"
Description: "Code system for reproductive health monitoring activities"

* ^status = #active
* ^experimental = false
* ^caseSensitive = true

* #cycle-tracking "Cycle Tracking" "Track menstrual cycle dates and characteristics"
* #temp-monitoring "Temperature Monitoring" "Monitor basal body temperature"
* #symptom-tracking "Symptom Tracking" "Track reproductive health symptoms"
* #vitals-monitoring "Vitals Monitoring" "Monitor vital signs related to reproductive health"
* #fertility-signs "Fertility Signs" "Monitor fertility signs and indicators"
* #mood-tracking "Mood Tracking" "Track mood changes related to reproductive cycle"
* #medication-log "Medication Log" "Log reproductive health medications"
* #exercise-tracking "Exercise Tracking" "Track physical activity during cycle"



// ===== Conteúdo de: AuditFormatsValueSet.fsh =====

ValueSet: AuditFormatsValueSet
Id: audit-formats
Title: "Audit Formats Value Set"
Description: "Value set for audit format types"
* ^url = "http://example.org/fhir/ValueSet/audit-formats"
* ^status = #active
* ^experimental = false
* ^date = "2024-12-27"
* include codes from system http://example.org/fhir/CodeSystem/audit-formats

CodeSystem: AuditFormatsCodeSystem
Id: audit-formats
Title: "Audit Formats Code System"
Description: "Code system for audit format types"
* ^url = "http://example.org/fhir/CodeSystem/audit-formats"
* ^status = #active
* ^experimental = false
* ^caseSensitive = true
* #text "Text Format"
* #structured "Structured Format"
* #mixed "Mixed Format"



// ===== Conteúdo de: MeasurementContextVS.fsh =====

ValueSet: MeasurementContextVS
Id: measurement-context-vs
Title: "Measurement Context Value Set"
Description: "Contexts in which measurements can be taken, including temporal and location-based contexts"
* ^status = #active
* ^experimental = false
* $SCT#272125009 "Assessment context value (qualifier value)"
* $SCT#307818003 "Before food"
* $SCT#307819006 "After food"
* $SCT#255214003 "After exercise"
* $SCT#264362003 "Time of day"



// ===== Conteúdo de: AuditLevelsValueSet.fsh =====

ValueSet: AuditLevelsValueSet
Id: audit-levels
Title: "Audit Levels Value Set"
Description: "Value set for audit level types"
* ^url = "http://example.org/fhir/ValueSet/audit-levels"
* ^status = #active
* ^experimental = false
* ^date = "2024-12-27"
* include codes from system http://example.org/fhir/CodeSystem/audit-levels

CodeSystem: AuditLevelsCodeSystem
Id: audit-levels
Title: "Audit Levels Code System"
Description: "Code system for audit level types"
* ^url = "http://example.org/fhir/CodeSystem/audit-levels"
* ^status = #active
* ^experimental = false
* ^caseSensitive = true
* #low "Low Level"
* #medium "Medium Level"
* #high "High Level"



// ===== Conteúdo de: SocialInteractionValueSets.fsh =====

ValueSet: SocialInteractionTypeVS
Id: social-interaction-type-vs
Title: "Social Interaction Type Value Set"
Description: "Types of social interactions"
* codes from system SocialInteractionTypeCS

ValueSet: SocialInteractionQualityVS
Id: social-interaction-quality-vs
Title: "Social Interaction Quality Value Set"
Description: "Quality measures for social interactions"
* codes from system SocialInteractionQualityCS

ValueSet: SocialInteractionMediumVS
Id: social-interaction-medium-vs
Title: "Social Interaction Medium Value Set"
Description: "Mediums through which social interaction occurs"
* codes from system SocialInteractionMediumCS

CodeSystem: SocialInteractionTypeCS
Id: social-interaction-type-cs
Title: "Social Interaction Type Code System"
Description: "Types of social interactions"
* #family "Family Interaction" "Interaction with family members"
* #friends "Friend Interaction" "Interaction with friends"
* #professional "Professional Interaction" "Work-related interactions"
* #community "Community Interaction" "Community-based interactions"
* #group "Group Activity" "Organized group activities"
* #casual "Casual Interaction" "Casual social encounters"

CodeSystem: SocialInteractionQualityCS
Id: social-interaction-quality-cs
Title: "Social Interaction Quality Code System"
Description: "Quality measures for social interactions"
* #meaningful "Meaningful" "Deep, meaningful interaction"
* #supportive "Supportive" "Supportive interaction"
* #neutral "Neutral" "Neither positive nor negative"
* #superficial "Superficial" "Surface-level interaction"
* #stressful "Stressful" "Stressful or difficult interaction"

CodeSystem: SocialInteractionMediumCS
Id: social-interaction-medium-cs
Title: "Social Interaction Medium Code System"
Description: "Mediums through which social interaction occurs"
* #inPerson "In Person" "Face-to-face interaction"
* #video "Video Call" "Video-based interaction"
* #voice "Voice Call" "Voice-only interaction"
* #text "Text Based" "Text-based communication"
* #social "Social Media" "Social media interaction"
* #mixed "Mixed Medium" "Multiple communication methods"



// ===== Conteúdo de: MoodValueSet.fsh =====

ValueSet: MoodValueSet
Id: mood
Title: "Mood Value Set"
Description: "Value set for mood states"
* ^url = "http://example.org/fhir/ValueSet/mood"
* ^status = #active
* ^experimental = false

CodeSystem: MoodCodeSystem
Id: mood
Title: "Mood Code System"
Description: "Code system for mood states"
* ^url = "http://example.org/fhir/CodeSystem/mood"
* ^status = #active
* ^caseSensitive = true
* #elevated "Elevated" "Mood is higher than normal"
* #neutral "Neutral" "Neither elevated nor depressed mood"
* #depressed "Depressed" "Mood is lower than normal"
* #anxious "Anxious" "Feeling worried or nervous"
* #irritable "Irritable" "Easily annoyed or angered"
* #calm "Calm" "Feeling peaceful and relaxed"



// ===== Conteúdo de: EnvironmentalContextVS.fsh =====

ValueSet: EnvironmentalContextValueSet
Id: environmental-context
Title: "Environmental Context Value Set"
Description: "Valid contexts for environmental measurements"

* ^status = #active
* ^experimental = false
* ^url = "http://example.org/fhir/ValueSet/environmental-context"
* include codes from system http://example.org/fhir/CodeSystem/environmental-context



// ===== Conteúdo de: ActivityTypeVS.fsh =====

ValueSet: PhysicalActivityTypeVS
Id: physical-activity-type-vs
Title: "Physical Activity Types Value Set"
Description: "Types of physical activities from iOS Health App"

* ^status = #active

* $SNOMED#255604002 "Physical activity (observable entity)"
* $SNOMED#228557008 "Walking"
* $SNOMED#229058003 "Running"
* $SNOMED#266938001 "Swimming"
* $SNOMED#266940006 "Cycling"
* $SNOMED#32147004 "Regular exercise"



// ===== Conteúdo de: MindfulnessValueSets.fsh =====

ValueSet: EnvironmentTypeValueSet
Id: environment-type
Title: "Environment Type Value Set"
Description: "Value set for environmental context types"
* ^url = "http://example.org/fhir/ValueSet/environment-type"
* ^status = #active
* include codes from system http://example.org/fhir/CodeSystem/environment-type

ValueSet: MindfulnessTypeValueSet
Id: mindfulness-type
Title: "Mindfulness Type Value Set"
Description: "Value set for types of mindfulness practices"
* ^url = "http://example.org/fhir/ValueSet/mindfulness-type"
* ^status = #active
* include codes from system http://example.org/fhir/CodeSystem/mindfulness-type



// ===== Conteúdo de: BalanceStatusValueSet.fsh =====

ValueSet: BalanceStatusValueSet
Id: balance-status
Title: "Balance Status Value Set"
Description: "Value set for walking steadiness balance status"
* ^url = "http://example.org/fhir/ValueSet/balance-status"
* ^status = #active
* include codes from system http://example.org/fhir/CodeSystem/balance-status

CodeSystem: BalanceStatusCodeSystem
Id: balance-status
Title: "Balance Status Code System"
Description: "Code system for balance status types"
* ^url = "http://example.org/fhir/CodeSystem/balance-status"
* ^status = #active
* ^experimental = false
* ^caseSensitive = true
* #veryStable "Very Stable"
* #stable "Stable"
* #slightlyUnstable "Slightly Unstable"
* #unstable "Unstable"
* #veryUnstable "Very Unstable"



// ===== Conteúdo de: SleepQualityVS.fsh =====

ValueSet: SleepQualityVS
Id: sleep-quality-vs
Title: "Sleep Quality Value Set"
Description: "Qualitative assessments of sleep quality including subjective measures"
* ^status = #active
* ^experimental = false
* $SCT#248254009 "Quality of sleep (observable entity)"
* $SCT#248255005 "Sleeping well"
* $SCT#248256006 "Difficulty sleeping"
* $SCT#301345002 "Poor sleep pattern"
* $SCT#301346001 "Good sleep pattern"




// ===== Conteúdo de: FertilityValueSets.fsh =====

ValueSet: CervicalMucusValueSet
Id: cervical-mucus-valueset
Title: "Cervical Mucus Value Set"
Description: "Value set for cervical mucus observations"
* ^url = "http://example.org/fhir/ValueSet/cervical-mucus-vs"
* ^status = #active
* include codes from system http://example.org/fhir/CodeSystem/cervical-mucus-cs

CodeSystem: CervicalMucusCodeSystem
Id: cervical-mucus-cs
Title: "Cervical Mucus Code System"
* ^url = "http://example.org/fhir/CodeSystem/cervical-mucus-cs"
* ^status = #active
* ^caseSensitive = true
* #dry "Dry"
* #sticky "Sticky"
* #creamy "Creamy"
* #watery "Watery"
* #eggWhite "Egg White"

ValueSet: OvulationTestValueSet
Id: ovulation-test-valueset
Title: "Ovulation Test Value Set"
Description: "Value set for ovulation test results"
* ^url = "http://example.org/fhir/ValueSet/ovulation-test-vs"
* ^status = #active
* include codes from system http://example.org/fhir/CodeSystem/ovulation-test-cs

CodeSystem: OvulationTestCodeSystem
Id: ovulation-test-cs
Title: "Ovulation Test Code System"
* ^url = "http://example.org/fhir/CodeSystem/ovulation-test-cs"
* ^status = #active
* ^caseSensitive = true
* #negative "Negative"
* #positive "Positive"
* #invalid "Invalid Test"

ValueSet: FertilityStatusValueSet
Id: fertility-status-valueset
Title: "Fertility Status Value Set"
Description: "Value set for fertility status"
* ^url = "http://example.org/fhir/ValueSet/fertility-status-vs"
* ^status = #active
* include codes from system http://example.org/fhir/CodeSystem/fertility-status-cs

CodeSystem: FertilityStatusCodeSystem
Id: fertility-status-cs
Title: "Fertility Status Code System"
* ^url = "http://example.org/fhir/CodeSystem/fertility-status-cs"
* ^status = #active
* ^caseSensitive = true
* #fertile "Fertile"
* #notFertile "Not Fertile"
* #uncertain "Uncertain"



// ===== Conteúdo de: MindfulnessSearchParameters.fsh =====

Instance: MindfulnessType
InstanceOf: SearchParameter
Usage: #definition
* status = #active
* code = #mindfulness-type
* name = "MindfulnessType"
* description = "Search for mindfulness observations by practice type"
* base = #Observation
* type = #token
* expression = "Observation.component.where(code.coding.where(system='http://snomed.info/sct' and code='711020003')).value.as(CodeableConcept)"
* xpath = "f:Observation/f:component[f:code/f:coding[f:system/@value='http://snomed.info/sct' and f:code/f:coding/f:code/@value='711020003']]/f:valueCodeableConcept"
* xpathUsage = #normal



// ===== Conteúdo de: MindfulnessAlerts.fsh =====

Extension: AlertTiming
Id: alert-timing
Title: "Alert Timing Extension"
Description: "Defines when alerts should be triggered"
* value[x] only Timing
* valueTiming.repeat 1..1 MS
* valueTiming.repeat.frequency MS
* valueTiming.repeat.period MS
* valueTiming.repeat.periodUnit MS

Extension: AlertMessage
Id: alert-message
Title: "Alert Message Extension"
Description: "Defines the alert message content"
* value[x] only string

Profile: MindfulnessAlert
Parent: Basic
Id: mindfulness-alert
Title: "Mindfulness Alert"
Description: "Alert configuration for mindfulness sessions"

* code 1..1 MS
* code = http://example.org/CodeSystem/mindfulness-alert-type#reminder "Mindfulness Reminder"

* extension contains
    alert-timing named alertTiming 0..1 MS and
    alert-message named alertMessage 1..1 MS

Instance: DailyMindfulnessAlert
InstanceOf: MindfulnessAlert
Title: "Daily Mindfulness Alert" 
Description: "Example of a daily mindfulness alert configuration"

* code = http://example.org/CodeSystem/mindfulness-alert-type#reminder "Mindfulness Reminder"
* extension[alertTiming].valueTiming.repeat
  * frequency = 1
  * period = 1
  * periodUnit = #d
* extension[alertMessage].valueString = "Time for your daily mindfulness practice"



// ===== Conteúdo de: MindfulnessTransforms.fsh =====

Instance: MindfulnessHealthKitTransform
InstanceOf: StructureMap
Usage: #definition
Title: "HealthKit to FHIR Mindfulness Transform"

* status = #draft
* name = "MindfulnessHealthKitTransform"
* structure[0]
  * url = "http://example.org/StructureDefinition/healthkit-mindfulness"
  * mode = #source
  * documentation = "HealthKit mindfulness session structure"

* structure[1]
  * url = "http://hl7.org/fhir/StructureDefinition/Observation"
  * mode = #target
  * documentation = "FHIR Observation resource"

* group[0]
  * name = "MindfulnessSessionToObservation"
  * typeMode = #none
  * input[0]
    * name = "source"
    * type = "HealthKitMindfulness"
    * mode = #source
  * input[1]
    * name = "target"
    * type = "Observation"
    * mode = #target
  * rule[0]
    * name = "Session"
    * source[0]
      * context = "source"
      * element = "startDate"
    * target[0]
      * context = "target"
      * element = "effectiveDateTime"
  * rule[1]
    * name = "Duration"
    * source[0]
      * context = "source"
      * element = "duration"
    * target[0]
      * context = "target"
      * element = "component.where(code.coding.code='118682006').valueQuantity"

Instance: MindfulnessCSVTransform
InstanceOf: StructureMap
Usage: #definition
Title: "CSV to FHIR Mindfulness Transform"

* status = #draft
* name = "MindfulnessCSVTransform"
* structure[0]
  * url = "http://example.org/StructureDefinition/csv-mindfulness"
  * mode = #source
  * documentation = "CSV mindfulness data structure"

* group[0]
  * name = "CSVToMindfulnessObservation"
  * typeMode = #none
  * input[0]
    * name = "source"
    * type = "CSVMindfulness"
    * mode = #source
  * input[1]
    * name = "target"
    * type = "Observation"
    * mode = #target
  * rule[0]
    * name = "MapDatetime"
    * source[0]
      * context = "source"
      * element = "date,time"
    * target[0]
      * context = "target"
      * element = "effectiveDateTime"
      * transform = #append

RuleSet: TransformValidationRules
* rule[+]
  * name = "ValidateStatus"
  * source[0]
    * context = "target"
    * element = "status"
  * assert[0]
    * description = "Status must be final"
    * expression = "%status = 'final'"

* rule[+]
  * name = "ValidateCode"
  * source[0]
    * context = "target"
    * element = "code"
  * assert[0]
    * description = "Must use SNOMED CT code"
    * expression = "%code.system = 'http://snomed.info/sct'"



// ===== Conteúdo de: MindfulnessAudit.fsh =====

Extension: AuditLevelExtension
Id: audit-level
Title: "Audit Level Extension"
Description: "Level of detail for audit records"
* value[x] only code
* valueCode from http://example.org/fhir/ValueSet/audit-levels (required)

Extension: AuditRetentionExtension
Id: audit-retention
Title: "Audit Retention Extension" 
Description: "Period to retain audit records"
* value[x] only Duration

Extension: AuditFormatExtension
Id: audit-format
Title: "Audit Format Extension"
Description: "Format for audit records"
* value[x] only code
* valueCode from http://example.org/fhir/ValueSet/audit-formats (required)

Profile: MindfulnessAudit
Parent: Basic
Id: mindfulness-audit
Title: "Mindfulness Audit"
Description: "Audit record for mindfulness sessions"

* code 1..1 MS
* code = http://example.org/CodeSystem/mindfulness-audit-type#session "Session Audit"
* created 1..1 MS

* extension contains
    audit-level named auditLevel 1..1 MS and
    audit-retention named auditRetention 1..1 MS and
    audit-format named auditFormat 1..1 MS

Instance: MindfulnessAuditExample
InstanceOf: MindfulnessAudit
Title: "Example Mindfulness Audit"
Description: "Example of a mindfulness session audit record"

* code = http://example.org/CodeSystem/mindfulness-audit-type#session "Session Audit"
* created = "2024-03-15"
* extension[auditLevel].valueCode = #detailed
* extension[auditRetention].valueDuration = 90 'days'
* extension[auditFormat].valueCode = #fhir



// ===== Conteúdo de: EnvironmentalExamples.fsh =====

Instance: NoiseExposureExample
InstanceOf: NoiseExposureObservation
Usage: #example
Title: "Noise Exposure Measurement Example"
Description: "Example of noise exposure measurement from iOS Health App"

* meta.security = http://terminology.hl7.org/CodeSystem/v3-Confidentiality#N
* status = #final
* category = http://terminology.hl7.org/CodeSystem/observation-category#environment
* code = $LOINC#28573-7 "Noise exposure time"
* subject = Reference(Patient/example)
* effectiveDateTime = "2024-03-19T15:30:00Z"
* device = Reference(Device/iphone-example)
* method = http://snomed.info/sct#37016008 "Automatic measurement"

* component[level]
  * code.coding[0] = $LOINC#89020-2 "Environmental noise average"
  * valueQuantity = 85 'dB'
  * interpretation = http://terminology.hl7.org/CodeSystem/v3-ObservationInterpretation#H "High"

* component[duration]
  * code.coding[0] = $LOINC#89021-0 "Environmental noise duration"
  * valueQuantity = 120 'min'

* component[peakLevel]
  * code.coding[0] = $LOINC#89024-4 "Peak sound level"
  * valueQuantity = 95 'dB'

* component[backgroundNoise]
  * code.coding[0] = $LOINC#89025-1 "Background noise level"
  * valueQuantity = 45 'dB'

* note.text = "Measurement taken during urban commute"

Instance: UVExposureExample
InstanceOf: UVExposureObservation
Usage: #example
Title: "UV Exposure Measurement Example"
Description: "Example of UV exposure measurement from iOS Health App"

* meta.security = http://terminology.hl7.org/CodeSystem/v3-Confidentiality#N
* status = #final
* category = http://terminology.hl7.org/CodeSystem/observation-category#environment
* code = $LOINC#28574-5 "UV exposure"
* subject = Reference(Patient/example)
* effectiveDateTime = "2024-03-19T12:00:00Z"
* device = Reference(Device/iphone-example)
* method = http://snomed.info/sct#37016008 "Automatic measurement"

* component[index]
  * code.coding[0] = $LOINC#89022-8 "UV index"
  * valueQuantity = 8 '{index}'
  * interpretation = http://terminology.hl7.org/CodeSystem/v3-ObservationInterpretation#H "High"

* component[duration]
  * code.coding[0] = $LOINC#89023-6 "UV exposure duration"
  * valueQuantity = 45 'min'

* component[timeOfDay]
  * code.coding[0] = $LOINC#89026-9 "Time of exposure"
  * valueDateTime = "2024-03-19T12:00:00Z"

* component[intensity]
  * code.coding[0] = $LOINC#89027-7 "UV intensity"
  * valueQuantity = 0.3 'W/m2'

* note.text = "Measurement taken during outdoor activity"

Instance: EnvironmentalDeviceExample
InstanceOf: Device
Usage: #example
Title: "Environmental Monitoring Device"
Description: "Example of iOS device used for environmental monitoring"

* identifier.system = "http://example.org/devices"
* identifier.value = "iPhone-ENV-001"
* manufacturer = "Apple Inc."
* modelNumber = "iPhone 15 Pro"
* type = $SCT#706689003 "Environmental monitoring device"
* status = #active



// ===== Conteúdo de: NutritionExamples.fsh =====

Instance: NutritionQuestionnaireResponseExample
InstanceOf: QuestionnaireResponse
Usage: #example
Title: "Daily Nutrition Questionnaire Response Example"

* questionnaire = "https://github.com/RicardoLSantos/shorthand/Questionnaire/daily-nutrition"
* status = #completed
* subject = Reference(Patient/PatientExample)
* authored = "2024-12-14T20:00:00Z"

* item[0]
  * linkId = "water_intake"
  * answer.valueQuantity = 2000 'mL'

* item[1]
  * linkId = "meal_record"

  * item[0]
    * linkId = "meal_time"
    * answer.valueDateTime = "2024-12-14T12:00:00Z"

  * item[1]
    * linkId = "meal_type"
    * answer.valueString = "Lunch"

  * item[2]
    * linkId = "calories"
    * answer.valueInteger = 650

  * item[3]
    * linkId = "macronutrients"
   
    * item[0]
      * linkId = "carbs"
      * answer.valueDecimal = 75
   
    * item[1]
      * linkId = "protein"
      * answer.valueDecimal = 30
   
    * item[2]
      * linkId = "fat"
      * answer.valueDecimal = 25

* item[2]
  * linkId = "caffeine"

  * item[0]
    * linkId = "caffeine_amount"
    * answer.valueInteger = 80

  * item[1]
    * linkId = "caffeine_source"
    * answer.valueString = "Coffee"



// ===== Conteúdo de: SleepExamples.fsh =====

Instance: SleepObservationExample1
InstanceOf: SleepObservation
Usage: #example
Title: "Example of Sleep Record"
Description: "Example of nightly sleep data from iOS Health App"
 
* status = #final
* category = http://terminology.hl7.org/CodeSystem/observation-category#sleep
* code = $LOINC#93832-4 "Sleep pattern panel"
* subject = Reference(PatientExample)
* effectivePeriod.start = "2024-03-19T22:00:00Z"
* effectivePeriod.end = "2024-03-20T06:30:00Z"
* device = Reference(DeviceSleepMonitor)
 
* component[timeInBed].code = $LOINC#93831-6 "Time in bed"
* component[timeInBed].valueQuantity = 510 'min' "minute"
* component[timeInBed].valueQuantity.system = $UCUM
* component[timeInBed].valueQuantity.unit = "minute"
 
* component[totalSleepTime].code = $LOINC#93833-2 "Sleep duration"
* component[totalSleepTime].valueQuantity = 472 'min' "minute"
* component[totalSleepTime].valueQuantity.system = $UCUM
* component[totalSleepTime].valueQuantity.unit = "minute"
 
* component[deepSleep].code = $LOINC#93834-0 "Deep sleep duration"
* component[deepSleep].valueQuantity = 95 'min' "minute"
* component[deepSleep].valueQuantity.system = $UCUM
* component[deepSleep].valueQuantity.unit = "minute"
 
* component[remSleep].code = $LOINC#93835-7 "REM sleep duration"
* component[remSleep].valueQuantity = 118 'min' "minute"
* component[remSleep].valueQuantity.system = $UCUM
* component[remSleep].valueQuantity.unit = "minute"
 
* component[lightSleep].code = $LOINC#93836-5 "Light sleep duration"
* component[lightSleep].valueQuantity = 259 'min' "minute"
* component[lightSleep].valueQuantity.system = $UCUM
* component[lightSleep].valueQuantity.unit = "minute"
 
* component[respiratoryRate].code = $LOINC#9279-1 "Respiratory rate"
* component[respiratoryRate].valueQuantity = 14 '/min' "per minute"
* component[respiratoryRate].valueQuantity.system = $UCUM
* component[respiratoryRate].valueQuantity.unit = "per minute"
 
* component[heartRateVariability].code = $LOINC#80404-7 "R-R interval.standard deviation (Heart rate variability)"
* component[heartRateVariability].valueQuantity = 45 'ms' "millisecond"
* component[heartRateVariability].valueQuantity.system = $UCUM
* component[heartRateVariability].valueQuantity.unit = "millisecond"
 
* component[interruptions].code = $LOINC#93837-3 "Number of awakenings during sleep"
* component[interruptions].valueQuantity = 3 '{count}' "count"
* component[interruptions].valueQuantity.system = $UCUM
* component[interruptions].valueQuantity.unit = "count"

Instance: DeviceSleepMonitor
InstanceOf: Device
Usage: #example
Title: "Sleep Monitoring Device"
* deviceName.name = "Sleep Quality Monitor"
* deviceName.type = #user-friendly-name
* manufacturer = "HealthTech Devices"
* modelNumber = "SQM-2024"
* type = $SCT#706172001 "Sleep monitor"



// ===== Conteúdo de: StressExamples.fsh =====

Instance: StressLevelExample
InstanceOf: StressLevelProfile
Usage: #example
Title: "Stress Level Measurement Example"

* status = #final
* category = http://terminology.hl7.org/CodeSystem/observation-category#vital-signs
* code = $LOINC#89592-0 "Stress level score"
* subject = Reference(Patient/example)
* effectiveDateTime = "2024-01-03T15:30:00Z"
* valueQuantity = 7 '{score}' "score"

* component[physiologicalStress].valueQuantity = 6 '{score}' "score"
* component[psychologicalStress].valueQuantity = 8 '{score}' "score"
* component[chronicity].valueCodeableConcept = StressChronicityCS#subacute
* component[impact].valueCodeableConcept = StressImpactCS#moderate

* extension[triggers].valueCodeableConcept = StressTriggersCS#work
* extension[coping].valueCodeableConcept = StressCopingCS#meditation



// ===== Conteúdo de: PatientExample.fsh =====

Instance: PatientExample
InstanceOf: Patient
Usage: #example
* identifier[0].system = "urn:oid:2.16.858.1.1.1"
* identifier[0].value = "12345"
* name.given = "John"
* name.family = "Doe"
* gender = #male
* birthDate = "1970-01-01"



// ===== Conteúdo de: MobilityExamples.fsh =====

Profile: WalkingSteadinessObservation
Parent: MobilityProfile
Id: walking-steadiness-observation
Title: "Walking Steadiness Observation Profile"
Description: "Profile for walking steadiness measurements from iPhone Motion Sensors"

* code = $LOINC#LA32-8 "Balance"
* component contains
    balanceScore 0..1 MS and
    balanceStatus 0..1 MS

* component[balanceScore]
  * code = $LOINC#LA32-8 "Balance score"
  * valueQuantity.system = $UCUM
  * valueQuantity.code = #%

* component[balanceStatus]
  * code = $LOINC#LA32-9 "Balance status"
  * valueCodeableConcept from http://example.org/fhir/ValueSet/balance-status (required)

Profile: WalkingSpeedObservation
Parent: MobilityProfile
Id: walking-speed-observation
Title: "Walking Speed Observation Profile"
Description: "Profile for walking speed measurements from iPhone Motion Sensors"

* code = $LOINC#LA29042-4 "Walking speed"
* component contains
    speed 0..1 MS and
    distance 0..1 MS

* component[speed]
  * code = $LOINC#LA29042-4 "Walking speed measurement"
  * valueQuantity.system = $UCUM
  * valueQuantity.code = #m/s

* component[distance]
  * code = $LOINC#LA29043-2 "Walking distance"
  * valueQuantity.system = $UCUM
  * valueQuantity.code = #m

Instance: WalkingSteadinessExample
InstanceOf: WalkingSteadinessObservation
Usage: #example
Title: "Walking Steadiness Measurement Example"
Description: "Example of walking steadiness measurement from iPhone Motion Sensors"

* status = #final
* category = http://terminology.hl7.org/CodeSystem/observation-category#activity
* code = $LOINC#LA32-8 "Balance"
* subject = Reference(Patient/example)
* effectiveDateTime = "2024-03-19T15:30:00Z"
* valueQuantity = 85 '1' "score"
* device = Reference(Device/iphone-example)

* component[balanceScore].valueQuantity = 85 '%' "percent"
* component[balanceStatus].valueCodeableConcept = $LOINC#LA32-10 "OK"

Instance: WalkingSpeedExample
InstanceOf: WalkingSpeedObservation
Usage: #example
Title: "Walking Speed Measurement Example"
Description: "Example of walking speed measurement from iPhone Motion Sensors"

* status = #final
* category = http://terminology.hl7.org/CodeSystem/observation-category#activity
* code = $LOINC#LA29042-4 "Walking speed"
* subject = Reference(Patient/example)
* effectiveDateTime = "2024-03-19T15:30:00Z"
* valueQuantity = 1.2 'm/s' "meters per second"
* device = Reference(Device/iphone-example)

* component[speed].valueQuantity = 1.2 'm/s' "meters per second"
* component[distance].valueQuantity = 10 'm' "meters"



// ===== Conteúdo de: PhysicalActivityExamples.fsh =====

Instance: PhysicalActivityExample1
InstanceOf: PhysicalActivityObservation
Usage: #example
Title: "Example of Walking Activity"
Description: "Example of walking activity data from iOS Health App"
* status = #final
* category = http://terminology.hl7.org/CodeSystem/observation-category#activity
* code = $SNOMED#228557008 "Walking"
* subject = Reference(PatientExample)
* effectiveDateTime = "2024-03-19T15:30:00Z"
* device = Reference(DeviceActivityTracker)
* component[steps].code = $LOINC#55423-8 "Number of steps in 24 hour Measured"
* component[steps].valueQuantity = 8546 '1' "count"
* component[steps].valueQuantity.system = $UCUM
* component[steps].valueQuantity.unit = "count"
* component[distance].code = $LOINC#55430-3 "Distance walked"
* component[distance].valueQuantity = 6.2 'km' "kilometer"
* component[distance].valueQuantity.system = $UCUM
* component[distance].valueQuantity.unit = "kilometer"
* component[duration].code = $LOINC#55411-3 "Exercise duration"
* component[duration].valueQuantity = 72 'min' "minute"
* component[duration].valueQuantity.system = $UCUM
* component[duration].valueQuantity.unit = "minute"
* component[energy].code = $LOINC#55424-6 "Energy expenditure"
* component[energy].valueQuantity = 320 'kcal' "kilocalorie"
* component[energy].valueQuantity.system = $UCUM
* component[energy].valueQuantity.unit = "kilocalorie"

Instance: DeviceActivityTracker
InstanceOf: Device
Usage: #example
Title: "Activity Tracking Device"
* deviceName.name = "Health Activity Tracker"
* deviceName.type = #user-friendly-name
* manufacturer = "HealthTech Devices"
* modelNumber = "HAT-2024"
* type = $SCT#258158006 "Activity monitor"



// ===== Conteúdo de: BodyMetricsExamples.fsh =====

Instance: WeightExample
InstanceOf: WeightObservation
Usage: #example
Title: "Weight Measurement Example"
Description: "Example of a weight measurement from a smart scale"
* status = #final
* category = http://terminology.hl7.org/CodeSystem/observation-category#vital-signs
* code = $LOINC#29463-7 "Body weight"
* subject = Reference(PatientExample)
* performer = Reference(PractitionerExample)
* effectiveDateTime = "2024-03-19T08:00:00Z"
* valueQuantity = 70.5 'kg' "kilogram"
* valueQuantity.system = $UCUM
* valueQuantity.unit = "kilogram"
* device = Reference(SmartScale)

Instance: HeightExample
InstanceOf: HeightObservation
Usage: #example
Title: "Height Measurement Example"
Description: "Example of a height measurement"
* status = #final
* category = http://terminology.hl7.org/CodeSystem/observation-category#vital-signs
* code = $LOINC#8302-2 "Body height"
* subject = Reference(PatientExample)
* performer = Reference(PractitionerExample)
* effectiveDateTime = "2024-03-19T08:00:00Z"
* valueQuantity = 175 'cm' "centimeter"
* valueQuantity.system = $UCUM
* valueQuantity.unit = "centimeter"

Instance: BMIExample
InstanceOf: BMIObservation
Usage: #example
Title: "BMI Calculation Example"
Description: "Example of a BMI calculation based on weight and height measurements"
* status = #final
* category = http://terminology.hl7.org/CodeSystem/observation-category#vital-signs
* code = $LOINC#39156-5 "Body mass index (BMI)"
* subject = Reference(PatientExample)
* performer = Reference(PractitionerExample)
* effectiveDateTime = "2024-03-19T08:00:00Z"
* valueQuantity = 23.0 'kg/m2' "kilogram per square meter"
* valueQuantity.system = $UCUM
* valueQuantity.unit = "kilogram per square meter"
* derivedFrom[0] = Reference(Observation/WeightExample)
* derivedFrom[1] = Reference(Observation/HeightExample)

Instance: BodyCompositionExample
InstanceOf: BodyCompositionObservation
Usage: #example
Title: "Body Composition Measurement Example" 
Description: "Example of comprehensive body composition measurements from a bioimpedance device"
* status = #final
* category = http://terminology.hl7.org/CodeSystem/observation-category#vital-signs
* code = $LOINC#88365-2 "Body composition panel"
* subject = Reference(PatientExample)
* performer = Reference(PractitionerExample)
* effectiveDateTime = "2024-03-19T08:00:00Z"
* device = Reference(BioimpedanceAnalyzer)

* component[bodyFat].code = $LOINC#41982-0 "Percentage body fat"
* component[bodyFat].valueQuantity = 22.5 '%' "percent"
* component[bodyFat].valueQuantity.system = $UCUM
* component[bodyFat].valueQuantity.unit = "percent"

* component[leanMass].code = $LOINC#291-7 "Lean body mass"
* component[leanMass].valueQuantity = 54.6 'kg' "kilogram"
* component[leanMass].valueQuantity.system = $UCUM
* component[leanMass].valueQuantity.unit = "kilogram"

* component[bodyWater].code = $LOINC#73708-0 "Total body water"
* component[bodyWater].valueQuantity = 39.2 'L' "liter"
* component[bodyWater].valueQuantity.system = $UCUM
* component[bodyWater].valueQuantity.unit = "liter"

* component[muscleMass].code = $LOINC#73713-0 "Muscle mass"
* component[muscleMass].valueQuantity = 51.8 'kg' "kilogram"
* component[muscleMass].valueQuantity.system = $UCUM
* component[muscleMass].valueQuantity.unit = "kilogram"

* component[boneMass].code = $LOINC#73711-4 "Bone mass"
* component[boneMass].valueQuantity = 2.8 'kg' "kilogram"
* component[boneMass].valueQuantity.system = $UCUM
* component[boneMass].valueQuantity.unit = "kilogram"

Instance: SmartScale
InstanceOf: Device
Usage: #example
Title: "Smart Scale Device"
* deviceName.name = "Smart Body Analyzer"
* deviceName.type = #user-friendly-name
* manufacturer = "HealthTech Devices"
* modelNumber = "SBA-2024"
* type = $SCT#469576000 "Digital scale device"

Instance: BioimpedanceAnalyzer  
InstanceOf: Device
Usage: #example
Title: "Bioimpedance Analyzer Device"
* deviceName.name = "Professional Body Composition Analyzer"
* deviceName.type = #user-friendly-name
* manufacturer = "MedTech Solutions"
* modelNumber = "BCA-Pro"
* type = $SCT#706767009 "Body composition analyzer"



// ===== Conteúdo de: SymptomExamples.fsh =====

Instance: ChronicSymptomExample
InstanceOf: Observation
Usage: #example
* status = #final
* category = http://terminology.hl7.org/CodeSystem/observation-category#survey
* code = $SCT#267036007 "Fatigue"
* subject = Reference(Patient/example)
* performer = Reference(Practitioner/example)
* effectiveDateTime = "2024-03-19T14:00:00Z"
// ... resto do exemplo ...

Instance: ExampleSymptomSeverity
InstanceOf: Observation
Usage: #example
* status = #final
* category = http://terminology.hl7.org/CodeSystem/observation-category#survey
* code = $SCT#246604007 "Symptom severity"
* subject = Reference(Patient/example)
* performer = Reference(Practitioner/example)
* effectiveDateTime = "2024-03-19T10:30:00Z"
// ... resto do exemplo ...



// ===== Conteúdo de: SocialInteractionExamples.fsh =====

Instance: SocialInteractionExample
InstanceOf: SocialInteractionProfile
Usage: #example
Title: "Social Interaction Example"

* status = #final
* category = http://terminology.hl7.org/CodeSystem/observation-category#social-history
* code = $LOINC#96766-1 "Social interaction pattern"
* subject = Reference(Patient/example)
* effectiveDateTime = "2024-01-03T14:00:00Z"
* valueCodeableConcept = SocialInteractionTypeCS#family

* component[duration].valueQuantity = 120 'min' "minutes"
* component[quality].valueCodeableConcept = SocialInteractionQualityCS#meaningful
* component[medium].valueCodeableConcept = SocialInteractionMediumCS#inPerson
* component[participants].valueInteger = 4

* extension[context].valueCodeableConcept = SocialContextCS#home
* extension[support].valueCodeableConcept = SocialSupportCS#strong
* extension[activity].valueCodeableConcept = SocialActivityCS#meal



// ===== Conteúdo de: VitalSignsExamples.fsh =====

Instance: HeartRateExample
InstanceOf: HeartRateObservation
Usage: #example
Title: "Heart Rate Measurement Example"
* status = #final
* code = $LOINC#8867-4 "Heart rate"
* subject = Reference(PatientExample)
* effectiveDateTime = "2024-03-19T15:30:00Z"
* valueQuantity = 72 '/min' "per minute"
* valueQuantity.system = $UCUM
* valueQuantity.unit = "per minute"
* device = Reference(DeviceHeartRateMonitor)
* performer = Reference(PractitionerExample)
* component[heartRateVariability].code = $LOINC#80404-7 "R-R interval.standard deviation (Heart rate variability)"
* component[heartRateVariability].valueQuantity = 45 'ms' "millisecond"
* component[heartRateVariability].valueQuantity.system = $UCUM
* component[heartRateVariability].valueQuantity.unit = "millisecond"

Instance: BloodPressureExample
InstanceOf: BloodPressureObservation
Usage: #example
Title: "Blood Pressure Measurement Example"
* status = #final
* code = $LOINC#85354-9 "Blood pressure panel with all children optional"
* subject = Reference(PatientExample)
* effectiveDateTime = "2024-03-19T15:30:00Z"
* device = Reference(DeviceBloodPressureMonitor)
* performer = Reference(PractitionerExample)
* component[systolic].code = $LOINC#8480-6 "Systolic blood pressure"
* component[systolic].valueQuantity = 120 'mm[Hg]' "millimeter of mercury"
* component[systolic].valueQuantity.system = $UCUM
* component[systolic].valueQuantity.unit = "millimeter of mercury"
* component[diastolic].code = $LOINC#8462-4 "Diastolic blood pressure"
* component[diastolic].valueQuantity = 80 'mm[Hg]' "millimeter of mercury"
* component[diastolic].valueQuantity.system = $UCUM
* component[diastolic].valueQuantity.unit = "millimeter of mercury"

Instance: DeviceHeartRateMonitor
InstanceOf: Device
Usage: #example
Title: "Heart Rate Monitor Device"
* deviceName.name = "Continuous Heart Rate Monitor"
* deviceName.type = #user-friendly-name
* manufacturer = "HealthTech Devices"
* modelNumber = "HRM-2024"
* type = $SCT#720737000 "Pulse rate monitoring device"

Instance: DeviceBloodPressureMonitor
InstanceOf: Device
Usage: #example
Title: "Blood Pressure Monitor Device"
* deviceName.name = "Digital Blood Pressure Monitor"
* deviceName.type = #user-friendly-name
* manufacturer = "HealthTech Devices"
* modelNumber = "BPM-2024"
* type = $SCT#43770009 "Blood pressure monitor"



// ===== Conteúdo de: PractitionerExample.fsh =====

Instance: PractitionerExample
InstanceOf: Practitioner
Usage: #example
* identifier[0].system = "http://hl7.org/fhir/sid/us-npi"
* identifier[0].value = "9941339108"
* name.given = "Jane"
* name.family = "Smith"



// ===== Conteúdo de: MindfulnessCompleteExamples.fsh =====

Instance: CompleteMindfulnessSession
InstanceOf: MindfulnessObservation
Usage: #example
Title: "Complete Mindfulness Session Example"

* status = #final
* code = $SCT#711020003 "Meditation"
* subject = Reference(Patient/PatientExample)
* effectiveDateTime = "2024-03-19T08:00:00Z"
* performer = Reference(Practitioner/example)

* component[sessionDuration].code = $SCT#118682006 "Duration"
* component[sessionDuration].valueQuantity = 20 'min'

* component[stressLevel].code = $SCT#725854004 "Assessment of stress level"
* component[stressLevel].valueInteger = 3

* component[moodState].code = $SCT#373931001 "Mood finding"
* component[moodState].valueCodeableConcept = $SCT#130991005 "Neutral mood"

* component[relaxationResponse].code = $SCT#276241001 "Relaxation technique"
* component[relaxationResponse].valueString = "Deep breathing exercises with progressive relaxation"

* component[mindfulnessType].code = $SCT#711020003 "Meditation"
* component[mindfulnessType].valueCodeableConcept = $SCT#711020003 "Meditation"

* extension[mindfulness-context].extension[location].valueString = "Home meditation room"
* extension[mindfulness-context].extension[environment].valueCodeableConcept = #quiet "Quiet Space"
* extension[mindfulness-context].extension[guidance].valueBoolean = true

Instance: CompleteMindfulnessResponse
InstanceOf: QuestionnaireResponse
Usage: #example
Title: "Complete Mindfulness Session Response"

* questionnaire = "http://example.org/Questionnaire/daily-mindfulness"
* status = #completed
* subject = Reference(Patient/PatientExample)
* authored = "2024-03-19T08:30:00Z"

* item[0]
  * linkId = "mindful_session"
  * item[0]
    * linkId = "session_duration"
    * answer.valueInteger = 20
  * item[1]
    * linkId = "practice_type"
    * answer.valueString = "Meditation"

* item[1]
  * linkId = "mood_assessment"
  * item[0]
    * linkId = "current_mood"
    * answer.valueCoding = $SCT#130991005 "Neutral mood"
  * item[1]
    * linkId = "mood_intensity"
    * answer.valueInteger = 3

* item[2]
  * linkId = "stress_assessment"
  * item[0]
    * linkId = "stress_level"
    * answer.valueInteger = 3
  * item[1]
    * linkId = "stress_symptoms"
    * answer[0].valueString = "Slight tension"

* item[3]
  * linkId = "relaxation"
  * item[0]
    * linkId = "relaxation_duration"
    * answer.valueInteger = 15
  * item[1]
    * linkId = "relaxation_technique"
    * answer.valueString = "Deep breathing"



// ===== Conteúdo de: MindfulnessExamples.fsh =====

Instance: MindfulnessObservationExample
InstanceOf: MindfulnessObservation
Usage: #example
Title: "Example of Mindfulness Session Observation"

* status = #final
* code = $SCT#711020003 "Meditation"
* subject = Reference(Patient/PatientExample)
* effectiveDateTime = "2024-03-19T09:30:00Z"
* performer = Reference(Practitioner/example)

* component[sessionDuration].code = $SCT#118682006 "Duration"
* component[sessionDuration].valueQuantity = 20 'min'

* component[stressLevel].code = $SCT#725854004 "Assessment of stress level"
* component[stressLevel].valueInteger = 4

* component[moodState].code = $SCT#373931001 "Mood finding"
* component[moodState].valueCodeableConcept = $SCT#130991005 "Neutral mood"

* component[relaxationResponse].code = $SCT#276241001 "Relaxation technique"
* component[relaxationResponse].valueString = "Deep breathing exercises helped reduce tension"

* component[mindfulnessType].code = $SCT#711020003 "Meditation"
* component[mindfulnessType].valueCodeableConcept = $SCT#711020003 "Meditation"

// New example for MindfulnessQuestionnaire
Instance: MindfulnessQuestionnaireExample
InstanceOf: Questionnaire
Usage: #example
Title: "Example of Mindfulness Questionnaire"

* url = "http://example.org/Questionnaire/mindfulness-example"
* status = #active
* title = "Daily Mindfulness Assessment"
* version = "1.0"
* name = "MindfulnessQuestionnaireExample"
* date = "2024-03-19"
* publisher = "Example Organization"
* description = "Example questionnaire for daily mindfulness practice assessment"

* item[0]
  * linkId = "session_details"
  * text = "Session Details"
  * type = #group
  
  * item[0]
    * linkId = "duration"
    * text = "Duration (minutes)"
    * type = #integer
    * required = true
    
  * item[1]
    * linkId = "technique"
    * text = "Technique Used"
    * type = #choice
    * required = true
    * answerOption[0].valueString = "Mindful Breathing"
    * answerOption[1].valueString = "Body Scan"
    * answerOption[2].valueString = "Walking Meditation"



// ===== Conteúdo de: ReproductiveExamples.fsh =====

Instance: ExampleReproductiveActivity
InstanceOf: CarePlan
Usage: #example
* status = #active
* intent = #plan
* subject = Reference(Patient/example)
* activity.detail.kind = #Observation
* activity.detail.code = ReproductiveActivityCS#cycle-tracking
* activity.detail.status = #scheduled



// ===== Conteúdo de: MindfulnessWorkflow.fsh =====

Profile: MindfulnessSchedule
Parent: Basic
Id: mindfulness-schedule
Title: "Mindfulness Schedule"
Description: "Schedule configuration for mindfulness sessions"

* code 1..1 MS
* code = http://example.org/CodeSystem/mindfulness-schedule-type#recurring "Recurring Schedule"

Extension: MindfulnessScheduleTiming
Id: mindfulness-schedule-timing
Title: "Mindfulness Schedule Timing"
Description: "Timing configuration for mindfulness sessions"
* value[x] only Timing

Instance: WeeklyMindfulnessSchedule
InstanceOf: MindfulnessSchedule
Title: "Weekly Mindfulness Schedule"
Description: "Example of a weekly mindfulness schedule"

* code = http://example.org/CodeSystem/mindfulness-schedule-type#recurring "Recurring Schedule"
* extension[mindfulness-schedule-timing].valueTiming.repeat.frequency = 1
* extension[mindfulness-schedule-timing].valueTiming.repeat.period = 1
* extension[mindfulness-schedule-timing].valueTiming.repeat.periodUnit = #wk
* extension[mindfulness-schedule-timing].valueTiming.repeat.dayOfWeek = #mon
* extension[mindfulness-schedule-timing].valueTiming.repeat.dayOfWeek[+] = #wed
* extension[mindfulness-schedule-timing].valueTiming.repeat.dayOfWeek[+] = #fri



// ===== Conteúdo de: MindfulnessRules.fsh =====

RuleSet: MindfulnessValidation
* ^extension[0].url = "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice"
* ^extension[0].valueBoolean = true

* status MS
* code MS
* subject MS
* effective[x] MS
* value[x] MS
* component MS

* status from http://hl7.org/fhir/ValueSet/observation-status
* code from http://snomed.info/sct?fhir_vs=isa/711020003
* subject only Reference(Patient)
* effective[x] only dateTime

* obeys mindfulness-session-duration
* obeys mindfulness-stress-level
* obeys mindfulness-mood-required
* obeys mindfulness-context-complete
* obeys sequential-measurements

RuleSet: MindfulnessQuestionnaireValidation
* status MS
* title MS
* item MS

* status = #active
* subjectType = #Patient
* item ^slicing.discriminator.type = #pattern
* item ^slicing.discriminator.path = "linkId"
* item ^slicing.rules = #open
* item contains 
    session 0..1 MS and
    mood 0..1 MS and
    stress 0..1 MS and
    relaxation 0..1 MS

* item[session]
  * linkId = "mindful_session"
  * text = "Mindfulness Session"
  * type = #group
  * required = true
  * repeats = false

* item[mood]
  * linkId = "mood_assessment"
  * text = "Mood Assessment"
  * type = #group
  * required = true
  * repeats = false

* item[stress]
  * linkId = "stress_assessment"
  * text = "Stress Assessment"
  * type = #group
  * required = true
  * repeats = false

* item[relaxation]
  * linkId = "relaxation"
  * text = "Relaxation"
  * type = #group
  * required = true
  * repeats = false

RuleSet: MindfulnessResponseValidation
* status MS
* subject MS
* authored MS
* item MS

* status = #completed
* subject only Reference(Patient)
* authored 1..1
* item ^slicing.discriminator.type = #pattern
* item ^slicing.discriminator.path = "linkId"
* item ^slicing.rules = #open



// ===== Conteúdo de: MindfulnessMappings.fsh =====

Mapping: MindfulnessToHealthKit
Id: mindfulness-to-healthkit
Title: "Mapping to Apple HealthKit"
Source: MindfulnessObservation
Target: "http://developer.apple.com/documentation/healthkit"

* -> "HKCategoryTypeIdentifierMindfulSession" "Root mapping"
* effectiveDateTime -> "startDate and endDate" "Session timing"
* component[sessionDuration].valueQuantity -> "duration" "Session duration"

Mapping: MindfulnessToLOINC
Id: mindfulness-to-loinc
Title: "Mapping to LOINC codes"
Source: MindfulnessObservation
Target: "http://loinc.org"

* -> "89555-7" "Mindfulness safety questionnaire"
* component[stressLevel] -> "89556-5" "Stress level score"
* component[sessionDuration] -> "89557-3" "Duration of mindfulness practice"
* component[moodState] -> "89558-1" "Mood pattern"

Mapping: MindfulnessToSNOMED
Id: mindfulness-to-snomed
Title: "Mapping to SNOMED CT"
Source: MindfulnessObservation
Target: "http://snomed.info/sct"

* -> "711020003" "Meditation"
* component[stressLevel] -> "725854004" "Assessment of stress level"
* component[moodState] -> "373931001" "Mood finding"
* component[relaxationResponse] -> "276241001" "Relaxation technique"

Extension: MindfulnessImportMap
Id: mindfulness-import-map
Title: "Mindfulness Import Mapping"
Description: "Mapping instructions for importing mindfulness data"

* ^url = "https://example.org/StructureDefinition/mindfulness-import-map"
* ^version = "1.0.0"
* ^status = #draft

* extension contains
    source 1..1 MS and
    target 1..1 MS and
    mapping 1..1 MS

* extension[source].value[x] only string
* extension[target].value[x] only string
* extension[mapping].value[x] only string

Instance: HealthKitMappingConfig
InstanceOf: MindfulnessImportMap
Usage: #inline

* extension[source].valueString = "HKCategoryTypeIdentifierMindfulSession"
* extension[target].valueString = "Observation"
* extension[mapping].valueString = "duration->component[sessionDuration].valueQuantity"



// ===== Conteúdo de: SocialInteractionMappings.fsh =====

Mapping: SocialInteractionToHealthKit
Id: social-interaction-to-healthkit
Title: "Mapping to Apple HealthKit"
Source: SocialInteractionProfile
Target: "http://developer.apple.com/documentation/healthkit"

* -> "HKCategoryTypeIdentifierSocialInteraction" "Root mapping"
* valueCodeableConcept -> "interactionType" "Type of interaction"
* component[duration] -> "duration" "Duration of interaction"
* component[participants] -> "participantCount" "Number of participants"

Mapping: SocialInteractionToLOINC
Id: social-interaction-to-loinc
Title: "Mapping to LOINC codes"
Source: SocialInteractionProfile
Target: "http://loinc.org"

* -> "96766-1" "Social Interaction Panel"
* component[duration] -> "89597-9" "Interaction duration"
* component[quality] -> "89598-7" "Interaction quality"



// ===== Conteúdo de: MindfulnessDiagnosticMappings.fsh =====

Instance: MindfulnessDiagnosticMap
InstanceOf: ConceptMap
Usage: #definition
Title: "Mindfulness Diagnostic Mappings"
Description: "Mapping of mindfulness outcomes to diagnostic codes"

* status = #draft
* experimental = false
* purpose = "Map mindfulness outcomes to standard diagnostic codes"
* sourceUri = "https://example.org/ValueSet/mindfulness-outcome-vs"
* targetUri = "http://snomed.info/sct"

* group[0].source = "https://example.org/CodeSystem/mindfulness-outcome-cs"
* group[0].target = "http://snomed.info/sct"
* group[0].element[0]
  * code = #stressReduction
  * target[0]
    * code = #73595000
    * display = "Stress"
    * equivalence = #narrower
    * comment = "Indicates reduction in stress levels"

* group[0].element[1]
  * code = #improvedSleep
  * target[0]
    * code = #248234008
    * display = "Sleep pattern"
    * equivalence = #narrower
    * comment = "Indicates improvement in sleep quality"

* group[0].element[2]
  * code = #emotionalBalance
  * target[0]
    * code = #285854004
    * display = "Emotional state"
    * equivalence = #equivalent
    * comment = "Maps to emotional state finding"

* group[0].element[3]
  * code = #increasedAwareness
  * target[0]
    * code = #736253002
    * display = "Mental state, behavior and/or psychosocial functioning"
    * equivalence = #relatedto
    * comment = "General improvement in mental state"

RuleSet: MindfulnessDiagnosticRules
* status MS
* code MS
* subject MS
* effective[x] MS
* value[x] MS
* method MS

* method from http://example.org/ValueSet/mindfulness-diagnostic-method-vs (required)
* code from http://example.org/ValueSet/mindfulness-diagnostic-code-vs (required)

* extension contains 
    diagnosticCertainty 0..1 MS and
    diagnosticTiming 0..1 MS



// ===== Conteúdo de: StressMappings.fsh =====

Mapping: StressToHealthKit
Id: stress-to-healthkit
Title: "Mapping to Apple HealthKit"
Source: StressLevelProfile
Target: "http://developer.apple.com/documentation/healthkit"

* -> "HKCategoryTypeIdentifierStressLevel" "Root mapping"
* valueQuantity -> "stressLevel" "Overall stress score"
* component[physiologicalStress] -> "physiologicalStress" "Physical stress indicators"
* component[psychologicalStress] -> "mentalStress" "Mental stress indicators"

Mapping: StressToLOINC
Id: stress-to-loinc
Title: "Mapping to LOINC codes"
Source: StressLevelProfile
Target: "http://loinc.org"

* -> "89592-0" "Stress Level Panel"
* component[physiologicalStress] -> "89593-8" "Physical stress score"
* component[psychologicalStress] -> "89594-6" "Mental stress score"



// ===== Conteúdo de: BodyMetricsProfiles.fsh =====

Alias: $SCT = http://snomed.info/sct
Alias: $LOINC = http://loinc.org
Alias: $UCUM = http://unitsofmeasure.org

Profile: BodyMetricsObservation
Parent: Observation
Id: body-metrics-observation
Title: "Body Metrics Observation Profile"
Description: "Profile for body measurements from iOS Health App"

* ^version = "0.1.0"
* ^status = #draft
* ^publisher = "Open Health Manager"

* status MS
* category 1..1 MS
* category = http://terminology.hl7.org/CodeSystem/observation-category#vital-signs
* subject 1..1 MS
* effectiveDateTime 1..1 MS
* device 0..1 MS

Profile: WeightObservation
Parent: BodyMetricsObservation
Id: weight-observation  
Title: "Weight Measurement Profile"
Description: "Profile for body weight measurements"

* ^version = "0.1.0"
* ^status = #draft

* code = $LOINC#29463-7 "Body weight"
* valueQuantity only Quantity
* valueQuantity.system = $UCUM
* valueQuantity.code = #kg

Profile: HeightObservation
Parent: BodyMetricsObservation
Id: height-observation
Title: "Height Measurement Profile" 
Description: "Profile for body height measurements"

* ^version = "0.1.0"
* ^status = #draft

* code = $LOINC#8302-2 "Body height"
* valueQuantity only Quantity
* valueQuantity.system = $UCUM
* valueQuantity.code = #cm

Profile: BMIObservation
Parent: BodyMetricsObservation
Id: bmi-observation
Title: "BMI Measurement Profile"
Description: "Profile for Body Mass Index calculations"

* ^version = "0.1.0"
* ^status = #draft

* code = $LOINC#39156-5 "Body mass index (BMI)"
* valueQuantity only Quantity
* valueQuantity.system = $UCUM
* valueQuantity.code = #kg/m2

Profile: BodyCompositionObservation
Parent: BodyMetricsObservation
Id: body-composition-observation
Title: "Body Composition Profile"
Description: "Profile for body composition measurements including fat, lean mass, and other metrics"

* ^version = "0.1.0"
* ^status = #draft

* code = $LOINC#88365-2 "Body composition panel"
* component ^slicing.discriminator.type = #pattern
* component ^slicing.discriminator.path = "code"
* component ^slicing.rules = #open

* component contains
    bodyFat 0..1 MS and
    leanMass 0..1 MS and
    bodyWater 0..1 MS and
    muscleMass 0..1 MS and
    boneMass 0..1 MS

* component[bodyFat].code = $LOINC#41982-0 "Percentage body fat"
* component[bodyFat].valueQuantity.system = $UCUM
* component[bodyFat].valueQuantity.code = #%

* component[leanMass].code = $LOINC#291-7 "Lean body mass"
* component[leanMass].valueQuantity.system = $UCUM
* component[leanMass].valueQuantity.code = #kg

* component[bodyWater].code = $LOINC#73708-0 "Total body water"
* component[bodyWater].valueQuantity.system = $UCUM  
* component[bodyWater].valueQuantity.code = #L

* component[muscleMass].code = $LOINC#73713-0 "Muscle mass"
* component[muscleMass].valueQuantity.system = $UCUM
* component[muscleMass].valueQuantity.code = #kg

* component[boneMass].code = $LOINC#73711-4 "Bone mass" 
* component[boneMass].valueQuantity.system = $UCUM
* component[boneMass].valueQuantity.code = #kg



// ===== Conteúdo de: AdvancedVitalSignsProfiles.fsh =====

Alias: $SCT = http://snomed.info/sct
Alias: $LOINC = http://loinc.org
Alias: $UCUM = http://unitsofmeasure.org

Profile: AdvancedVitalSigns
Parent: Observation
Id: advanced-vital-signs
Title: "Advanced Vital Signs Profile"
Description: "Profile for advanced vital signs data from iOS Health App"

* ^version = "0.1.0"
* ^status = #draft
* ^publisher = "HL7 International"
* ^contact.name = "Advanced Vital Signs Working Group"

* status MS
* category 1..1 MS
* category = http://terminology.hl7.org/CodeSystem/observation-category#vital-signs
* code 1..1 MS
* subject 1..1 MS
* effectiveDateTime 1..1 MS
* device 0..1 MS
* method 0..1 MS
* note 0..* MS

* component ^slicing.discriminator.type = #pattern
* component ^slicing.discriminator.path = "code"
* component ^slicing.rules = #open
* component ^short = "Advanced vital signs components"
* component ^definition = "Components of advanced vital sign measurements"

* component contains
    hrvSpectral 0..1 MS and
    hrvEntropy 0..1 MS and
    meanArterialPressure 0..1 MS and
    pulseWaveAnalysis 0..1 MS and
    respiratoryVariability 0..1 MS and
    oxygenationIndex 0..1 MS and
    stressIndex 0..1 MS and
    thermalGradient 0..1 MS and
    autonomicBalance 0..1 MS and
    recoveryRate 0..1 MS and
    allostaticLoad 0..1 MS

* component[hrvSpectral].code = $LOINC#87834-8 "Heart rate variability [Frequency band]"
* component[hrvSpectral].valueQuantity.system = $UCUM
* component[hrvSpectral].valueQuantity.code = #ms
* component[hrvSpectral] ^short = "Spectral analysis of heart rate variability"

* component[hrvEntropy].code = $LOINC#87835-5 "Heart rate variability entropy"
* component[hrvEntropy].valueQuantity.system = $UCUM
* component[hrvEntropy].valueQuantity.code = #{entropy}
* component[hrvEntropy] ^short = "Sample entropy of heart rate variability"

* component[meanArterialPressure].code = $LOINC#8478-0 "Mean blood pressure"
* component[meanArterialPressure].valueQuantity.system = $UCUM
* component[meanArterialPressure].valueQuantity.code = #mmHg
* component[meanArterialPressure] ^short = "Mean arterial blood pressure"

* component[pulseWaveAnalysis].code = $LOINC#87836-3 "Pulse wave analysis"
* component[pulseWaveAnalysis].valueQuantity.system = $UCUM
* component[pulseWaveAnalysis].valueQuantity.code = #{index}
* component[pulseWaveAnalysis] ^short = "Analysis of arterial pulse wave"

* component[respiratoryVariability].code = $LOINC#87837-1 "Respiratory rate variability"
* component[respiratoryVariability].valueQuantity.system = $UCUM
* component[respiratoryVariability].valueQuantity.code = #{coefficient}
* component[respiratoryVariability] ^short = "Variability in respiratory rate"

* component[oxygenationIndex].code = $LOINC#87838-9 "Oxygenation index"
* component[oxygenationIndex].valueQuantity.system = $UCUM
* component[oxygenationIndex].valueQuantity.code = #{ratio}
* component[oxygenationIndex] ^short = "Index of blood oxygenation"

* component[stressIndex].code = $LOINC#87839-7 "Physiological stress index"
* component[stressIndex].valueQuantity.system = $UCUM
* component[stressIndex].valueQuantity.code = #{index}
* component[stressIndex] ^short = "Index of physiological stress"

* component[thermalGradient].code = $LOINC#87840-5 "Temperature gradient"
* component[thermalGradient].valueQuantity.system = $UCUM
* component[thermalGradient].valueQuantity.code = #Cel
* component[thermalGradient] ^short = "Gradient of body temperature"

* component[autonomicBalance].code = $LOINC#87841-3 "Autonomic balance index"
* component[autonomicBalance].valueQuantity.system = $UCUM
* component[autonomicBalance].valueQuantity.code = #{ratio}
* component[autonomicBalance] ^short = "Balance of autonomic nervous system"

* component[recoveryRate].code = $LOINC#87842-1 "Recovery rate index"
* component[recoveryRate].valueQuantity.system = $UCUM
* component[recoveryRate].valueQuantity.code = #{rate}
* component[recoveryRate] ^short = "Rate of physiological recovery"

* component[allostaticLoad].code = $LOINC#87843-9 "Allostatic load index"
* component[allostaticLoad].valueQuantity.system = $UCUM
* component[allostaticLoad].valueQuantity.code = #{score}
* component[allostaticLoad] ^short = "Measure of cumulative physiological burden"

Extension: AdvancedVitalSignsContext
Id: advanced-vital-signs-context
Title: "Advanced Vital Signs Context Extension"
Description: "Additional context about advanced vital sign measurements"

* value[x] only CodeableConcept
* valueCodeableConcept from AdvancedVitalSignsContextVS (required)

ValueSet: AdvancedVitalSignsContextVS
Id: advanced-vital-signs-context-vs
Title: "Advanced Vital Signs Context Value Set"
Description: "Context codes for advanced vital sign measurements"

* ^experimental = true
* codes from system AdvancedVitalSignsContextCS

CodeSystem: AdvancedVitalSignsContextCS
Id: advanced-vital-signs-context-cs
Title: "Advanced Vital Signs Context Code System"
Description: "Codes for advanced vital signs measurement context"

* ^experimental = true
* ^caseSensitive = true

* #resting "Resting state" "Measurement taken during rest"
* #active "Active state" "Measurement taken during activity"
* #recovery "Recovery state" "Measurement taken during recovery"
* #sleep "Sleep state" "Measurement taken during sleep"
* #stress "Stress state" "Measurement taken during stress"



// ===== Conteúdo de: MobilityProfiles.fsh =====

Profile: MobilityProfile
Parent: Observation
Id: mobility-profile
Title: "Mobility Profile"
Description: "Profile for mobility data from iOS Health App"

* status MS
* category 1..1 MS
* category = http://terminology.hl7.org/CodeSystem/observation-category#activity
* code 1..1 MS
* subject 1..1 MS
* effectiveDateTime 1..1 MS
* device 0..1 MS

* component ^slicing.discriminator.type = #pattern
* component ^slicing.discriminator.path = "code"
* component ^slicing.rules = #open

* component contains
    steadiness 0..1 MS and
    balance 0..1 MS and
    gait 0..1 MS and 
    movement 0..1 MS

* component[steadiness].code = $LOINC#LA32-8
* component[balance].code = $LOINC#LA32-9
* component[gait].code = $LOINC#LA29042-4
* component[movement].code = $LOINC#LA29043-2



// ===== Conteúdo de: VitalSignsProfiles.fsh =====

Alias: $SCT = http://snomed.info/sct
Alias: $LOINC = http://loinc.org
Alias: $UCUM = http://unitsofmeasure.org
Alias: $vitalsigns = http://hl7.org/fhir/StructureDefinition/vitalsigns

Profile: LifestyleVitalSigns
Parent: $vitalsigns
Id: lifestyle-vital-signs
Title: "Lifestyle Medicine Vital Signs Profile"
Description: "Profile for vital signs data from iOS Health App"

* status MS
* category 1..* MS
* subject 1..1 MS
* effectiveDateTime 1..1 MS
* code 1..1 MS
* value[x] 0..1 MS
* device 0..1 MS

Profile: HeartRateObservation
Parent: LifestyleVitalSigns
Id: heart-rate-observation
Title: "Heart Rate Observation Profile"
Description: "Profile for heart rate measurements from iOS Health App"

* code = $LOINC#8867-4 "Heart rate"
* valueQuantity only Quantity
* valueQuantity.system = $UCUM
* valueQuantity.code = #/min
* component ^slicing.discriminator.type = #pattern
* component ^slicing.discriminator.path = "code"
* component ^slicing.rules = #open

* component contains
    restingHeartRate 0..1 MS and
    exerciseHeartRate 0..1 MS and
    recoveryHeartRate 0..1 MS and
    heartRateVariability 0..1 MS

* component[heartRateVariability].code = $LOINC#80404-7 "R-R interval.standard deviation (Heart rate variability)"
* component[heartRateVariability].valueQuantity.system = $UCUM
* component[heartRateVariability].valueQuantity.code = #ms

Profile: BloodPressureObservation
Parent: LifestyleVitalSigns
Id: blood-pressure-observation
Title: "Blood Pressure Observation Profile"
Description: "Profile for blood pressure measurements from iOS Health App"

* code = $LOINC#85354-9 "Blood pressure panel with all children optional"
* component 2..2 MS
* component ^slicing.discriminator.type = #pattern
* component ^slicing.discriminator.path = "code"
* component ^slicing.rules = #closed

* component contains
    systolic 1..1 MS and
    diastolic 1..1 MS

* component[systolic].code = $LOINC#8480-6 "Systolic blood pressure"
* component[systolic].valueQuantity only Quantity
* component[systolic].valueQuantity.system = $UCUM
* component[systolic].valueQuantity.code = #mm[Hg]

* component[diastolic].code = $LOINC#8462-4 "Diastolic blood pressure"
* component[diastolic].valueQuantity only Quantity
* component[diastolic].valueQuantity.system = $UCUM
* component[diastolic].valueQuantity.code = #mm[Hg]

Profile: OxygenSaturationObservation
Parent: LifestyleVitalSigns
Id: oxygen-saturation-observation
Title: "Oxygen Saturation Observation Profile"
Description: "Profile for SpO2 measurements from iOS Health App"

* code = $LOINC#2708-6 "Oxygen saturation in Arterial blood"
* valueQuantity.system = $UCUM
* valueQuantity.code = #%



// ===== Conteúdo de: PhysicalActivityProfile.fsh =====

Alias: $LOINC = http://loinc.org
Alias: $SNOMED = http://snomed.info/sct
Alias: $UCUM = http://unitsofmeasure.org
Alias: $ActivityCodes = http://example.org/activity-codes

Profile: PhysicalActivityObservation
Parent: Observation
Id: physical-activity-observation
Title: "Physical Activity Observation Profile"
Description: "Profile for recording physical activity data from iOS Health App"

* status MS
* category 1..1 MS
* category = http://terminology.hl7.org/CodeSystem/observation-category#activity
* code 1..1 MS
* code from PhysicalActivityTypeVS (required)
* subject 1..1 MS
* subject only Reference(Patient)
* effectiveDateTime 1..1 MS
* device 0..1 MS
* value[x] only Quantity
* component ^slicing.discriminator.type = #pattern
* component ^slicing.discriminator.path = "code"
* component ^slicing.rules = #open

* component contains
    steps 0..1 MS and
    distance 0..1 MS and
    duration 0..1 MS and
    energy 0..1 MS

* component[steps].code = $LOINC#55423-8 "Number of steps in 24 hour Measured"
* component[steps].valueQuantity only Quantity
* component[steps].valueQuantity.system = $UCUM
* component[steps].valueQuantity.code = #1 "count"

* component[distance].code = $LOINC#55430-3 "Distance walked"
* component[distance].valueQuantity only Quantity
* component[distance].valueQuantity.system = $UCUM
* component[distance].valueQuantity.code = #km "kilometer"

* component[duration].code = $LOINC#55411-3 "Exercise duration"
* component[duration].valueQuantity only Quantity
* component[duration].valueQuantity.system = $UCUM
* component[duration].valueQuantity.code = #min "minute"

* component[energy].code = $LOINC#55424-6 "Energy expenditure"
* component[energy].valueQuantity only Quantity
* component[energy].valueQuantity.system = $UCUM
* component[energy].valueQuantity.code = #kcal "kilocalorie"



// ===== Conteúdo de: ReproductiveObservation.fsh =====

Profile: ReproductiveObservation
Parent: Observation
Id: reproductive-observation
Title: "Reproductive Health Base Profile"
Description: "Base profile for reproductive health observations"

* ^version = "1.0.0"
* ^status = #active
* ^date = "2024-03-19"

* status MS
* category 1..1 MS
* category = http://terminology.hl7.org/CodeSystem/observation-category#reproductive
* code 1..1 MS
* subject 1..1 MS
* subject only Reference(Patient)
* effectiveDateTime 1..1 MS
* value[x] MS

* component ^slicing.discriminator.type = #pattern
* component ^slicing.discriminator.path = "code"
* component ^slicing.rules = #open

* component contains
    severity 0..1 MS and
    duration 0..1 MS and
    frequency 0..1 MS and
    pattern 0..1 MS

* component[severity]
  * code = $LOINC#72514-3
  * value[x] only integer
  * valueInteger 1..1 
  * valueInteger obeys rep-1

* component[duration]
  * code = $LOINC#103332-8
  * value[x] only Quantity
  * valueQuantity from DurationUnitsVS (required)

* component[frequency]
  * code = $LOINC#103334-4
  * value[x] only CodeableConcept
  * valueCodeableConcept from SymptomFrequencyVS (required)

* component[pattern]
  * code = $LOINC#103335-1
  * value[x] only CodeableConcept
  * valueCodeableConcept from SymptomProgressionVS (required)

Invariant: rep-1
Description: "Severity must be between 0 and 10"
Expression: "$this >= 0 and $this <= 10"
Severity: #error



// ===== Conteúdo de: SymptomProfiles.fsh =====

Profile: SymptomQuestionnaire
Parent: Questionnaire
Id: symptom-questionnaire
Title: "Symptom Assessment Questionnaire"
Description: "Questionnaire template for symptom assessments"

* status MS
* title MS
* item MS

* item ^slicing.discriminator.type = #pattern
* item ^slicing.discriminator.path = "linkId"
* item ^slicing.rules = #open

* item contains
    symptomType 1..1 MS and
    location 0..1 MS and
    onset 0..1 MS and
    description 0..1 MS

* item[symptomType].linkId = "symptom-type"
* item[symptomType].text = "Type of Symptom"
* item[symptomType].type = #choice
* item[symptomType].required = true

* item[location].linkId = "location"
* item[location].text = "Location"
* item[location].type = #string

* item[onset].linkId = "onset"
* item[onset].text = "When did it start?"
* item[onset].type = #dateTime

* item[description].linkId = "description"
* item[description].text = "Description"
* item[description].type = #text



// ===== Conteúdo de: ReproductiveProfiles.fsh =====

Profile: FertilityObservation
Parent: Observation
Id: fertility-observation
Title: "Fertility Observation Profile"
Description: "Profile for fertility signs and symptoms"

* status MS
* category 1..1 MS
* category = http://terminology.hl7.org/CodeSystem/observation-category#reproductive
* code = $LOINC#8669-4 "Ovulation status"
* subject 1..1 MS
* effectiveDateTime 1..1 MS

* component ^slicing.discriminator.type = #pattern
* component ^slicing.discriminator.path = "code"
* component ^slicing.rules = #open

* component contains
    cervicalMucus 0..1 MS and
    ovulationTest 0..1 MS and
    fertilityStatus 0..1 MS

* component[cervicalMucus].valueCodeableConcept from http://example.org/fhir/ValueSet/cervical-mucus-vs (required)
* component[ovulationTest].valueCodeableConcept from http://example.org/fhir/ValueSet/ovulation-test-vs (required)
* component[fertilityStatus].valueCodeableConcept from http://example.org/fhir/ValueSet/fertility-status-vs (required)



// ===== Conteúdo de: MindfulnessProfiles.fsh =====

Profile: MindfulnessObservation
Parent: Observation
Id: mindfulness-observation
Title: "Mindfulness Session Observation"
Description: "Profile for recording mindfulness practice sessions and outcomes"

* status MS
* code MS
* subject MS
* effectiveDateTime MS
* performer MS
* value[x] MS
* component MS

* status = #final
* code = $SCT#711020003 "Meditation"
* subject only Reference(Patient)
* effectiveDateTime 1..1
* performer only Reference(Practitioner or PractitionerRole)

* component ^slicing.discriminator.type = #pattern
* component ^slicing.discriminator.path = "code"
* component ^slicing.rules = #open

* component contains
    sessionDuration 0..1 and
    stressLevel 0..1 and
    moodState 0..1 and
    relaxationResponse 0..1 and
    mindfulnessType 0..1

* component[sessionDuration]
  * code = $SCT#118682006 "Duration"
  * value[x] only Quantity
  * valueQuantity
    * value 1..1
    * unit = "min"
    * system = "http://unitsofmeasure.org"
    * code = #min

* component[stressLevel]
  * code = $SCT#725854004 "Assessment of stress level"
  * value[x] only integer
  * valueInteger
    * ^extension[0].url = "http://hl7.org/fhir/StructureDefinition/elementdefinition-minValueInteger"
    * ^extension[0].valueInteger = 0
    * ^extension[1].url = "http://hl7.org/fhir/StructureDefinition/elementdefinition-maxValueInteger"
    * ^extension[1].valueInteger = 10

* component[moodState]
  * code = $SCT#373931001 "Mood finding"
  * value[x] only CodeableConcept
  * valueCodeableConcept from http://example.org/fhir/ValueSet/mood (required)

* component[relaxationResponse]
  * code = $SCT#276241001 "Relaxation technique"
  * value[x] only string

* component[mindfulnessType]
  * code = $SCT#711020003 "Meditation"
  * value[x] only CodeableConcept
  * valueCodeableConcept from http://example.org/ValueSet/mindfulness-type (required)



// ===== Conteúdo de: SleepProfile.fsh =====

Alias: $SCT = http://snomed.info/sct
Alias: $LOINC = http://loinc.org
Alias: $UCUM = http://unitsofmeasure.org
 
Profile: SleepObservation
Parent: Observation
Id: sleep-observation
Title: "Sleep Observation Profile"
Description: "Profile for recording sleep data from iOS Health App"
 
* status MS
* category 1..1 MS
* category = http://terminology.hl7.org/CodeSystem/observation-category#sleep
* code 1..1 MS
* code = $LOINC#93832-4 "Sleep pattern panel"
* subject 1..1 MS
* subject only Reference(Patient)
* effectiveDateTime 0..1 MS
* effectivePeriod 0..1 MS
* device 0..1 MS
 
* component ^slicing.discriminator.type = #pattern
* component ^slicing.discriminator.path = "code"
* component ^slicing.rules = #open
 
* component contains
    timeInBed 1..1 MS and
    totalSleepTime 1..1 MS and
    deepSleep 0..1 MS and
    remSleep 0..1 MS and
    lightSleep 0..1 MS and
    respiratoryRate 0..1 MS and
    heartRateVariability 0..1 MS and
    interruptions 0..1 MS
 
* component[timeInBed].code = $LOINC#93831-6 "Time in bed"
* component[timeInBed].valueQuantity only Quantity
* component[timeInBed].valueQuantity.system = $UCUM
* component[timeInBed].valueQuantity.code = #min
 
* component[totalSleepTime].code = $LOINC#93833-2 "Sleep duration"
* component[totalSleepTime].valueQuantity only Quantity
* component[totalSleepTime].valueQuantity.system = $UCUM
* component[totalSleepTime].valueQuantity.code = #min
 
* component[deepSleep].code = $LOINC#93834-0 "Deep sleep duration"
* component[deepSleep].valueQuantity only Quantity
* component[deepSleep].valueQuantity.system = $UCUM
* component[deepSleep].valueQuantity.code = #min
 
* component[remSleep].code = $LOINC#93835-7 "REM sleep duration"
* component[remSleep].valueQuantity only Quantity
* component[remSleep].valueQuantity.system = $UCUM
* component[remSleep].valueQuantity.code = #min
 
* component[lightSleep].code = $LOINC#93836-5 "Light sleep duration"
* component[lightSleep].valueQuantity only Quantity
* component[lightSleep].valueQuantity.system = $UCUM
* component[lightSleep].valueQuantity.code = #min
 
* component[respiratoryRate].code = $LOINC#9279-1 "Respiratory rate"
* component[respiratoryRate].valueQuantity only Quantity
* component[respiratoryRate].valueQuantity.system = $UCUM
* component[respiratoryRate].valueQuantity.code = #/min
 
* component[heartRateVariability].code = $LOINC#80404-7 "R-R interval.standard deviation (Heart rate variability)"
* component[heartRateVariability].valueQuantity only Quantity
* component[heartRateVariability].valueQuantity.system = $UCUM
* component[heartRateVariability].valueQuantity.code = #ms
 
* component[interruptions].code = $LOINC#93837-3 "Number of awakenings during sleep"
* component[interruptions].valueQuantity only Quantity
* component[interruptions].valueQuantity.system = $UCUM
* component[interruptions].valueQuantity.code = #{count}
* extension contains SleepQuality named quality 0..1



// ===== Conteúdo de: MobilityRiskAssessment.fsh =====

Profile: MobilityRiskAssessment
Parent: RiskAssessment
Id: mobility-risk-assessment
Title: "Mobility Risk Assessment Profile"
Description: "Profile for assessing mobility-related risks"

* status MS
* subject 1..1 MS
* occurrence[x] MS
* prediction MS
  * outcome MS
  * probability[x] MS
  * qualitativeRisk MS

* method MS
  * coding ^slicing.discriminator.type = #pattern
  * coding ^slicing.discriminator.path = "$this"
  * coding ^slicing.rules = #open
  * coding contains
      mobilityAssessment 1..1 MS

* method.coding[mobilityAssessment] = http://example.org/CodeSystem/mobility-assessment-method#standardized "Standardized Mobility Assessment"

* prediction ^slicing.discriminator.type = #pattern
* prediction ^slicing.discriminator.path = "outcome"
* prediction ^slicing.rules = #open

* prediction contains
    fallRisk 0..1 MS and
    mobilityDecline 0..1 MS and
    assistanceNeeded 0..1 MS

* prediction[fallRisk].outcome from http://example.org/ValueSet/fall-risk-outcomes
* prediction[fallRisk].probabilityDecimal 0..1 MS
* prediction[fallRisk].qualitativeRisk from http://example.org/ValueSet/risk-level

* prediction[mobilityDecline].outcome from http://example.org/ValueSet/mobility-decline-outcomes
* prediction[mobilityDecline].probabilityDecimal 0..1 MS
* prediction[mobilityDecline].qualitativeRisk from http://example.org/ValueSet/risk-level

* prediction[assistanceNeeded].outcome from http://example.org/ValueSet/assistance-level-outcomes
* prediction[assistanceNeeded].probabilityDecimal 0..1 MS
* prediction[assistanceNeeded].qualitativeRisk from http://example.org/ValueSet/risk-level

* basis only Reference(MobilityProfile or Observation or QuestionnaireResponse)
* basis MS

* note MS



// ===== Conteúdo de: EnvironmentalProfiles.fsh =====

Alias: $SCT = http://snomed.info/sct
Alias: $LOINC = http://loinc.org
Alias: $UCUM = http://unitsofmeasure.org

Profile: EnvironmentalObservation
Parent: Observation
Id: environmental-observation
Title: "Environmental Observation Profile"
Description: "Base profile for environmental measurements from iOS Health App"

* ^version = "0.1.0"
* ^status = #draft
* ^publisher = "HL7 International"
* ^contact.name = "Environmental Health Working Group"

* status MS
* category 1..1 MS
* category = http://terminology.hl7.org/CodeSystem/observation-category#environment
* subject 1..1 MS
* effectiveDateTime 1..1 MS
* device 0..1 MS
* method 0..1 MS
* note 0..* MS

Profile: NoiseExposureObservation
Parent: EnvironmentalObservation
Id: noise-exposure-observation
Title: "Noise Exposure Observation Profile"
Description: "Profile for noise exposure measurements from iOS Health App"

* code = $LOINC#28573-7 "Noise exposure time"
* component ^slicing.discriminator.type = #pattern
* component ^slicing.discriminator.path = "code"
* component ^slicing.rules = #open
* component ^short = "Noise exposure components"
* component ^definition = "Components of noise exposure measurement"

* component contains
    level 1..1 MS and
    duration 1..1 MS and
    peakLevel 0..1 MS and
    backgroundNoise 0..1 MS

* component[level].code = $LOINC#89020-2 "Environmental noise average"
* component[level].valueQuantity.system = $UCUM
* component[level].valueQuantity.code = #dB
* component[level].valueQuantity ^short = "Noise level in decibels"

* component[duration].code = $LOINC#89021-0 "Environmental noise duration"
* component[duration].valueQuantity.system = $UCUM
* component[duration].valueQuantity.code = #min
* component[duration].valueQuantity ^short = "Duration of exposure"

* component[peakLevel].code = $LOINC#89024-4 "Peak sound level"
* component[peakLevel].valueQuantity.system = $UCUM
* component[peakLevel].valueQuantity.code = #dB
* component[peakLevel].valueQuantity ^short = "Peak noise level"

* component[backgroundNoise].code = $LOINC#89025-1 "Background noise level"
* component[backgroundNoise].valueQuantity.system = $UCUM
* component[backgroundNoise].valueQuantity.code = #dB
* component[backgroundNoise].valueQuantity ^short = "Background noise level"

Profile: UVExposureObservation
Parent: EnvironmentalObservation
Id: uv-exposure-observation
Title: "UV Exposure Observation Profile"
Description: "Profile for UV exposure measurements from iOS Health App"

* code = $LOINC#28574-5 "UV exposure"
* component ^slicing.discriminator.type = #pattern
* component ^slicing.discriminator.path = "code"
* component ^slicing.rules = #open
* component ^short = "UV exposure components"
* component ^definition = "Components of UV exposure measurement"

* component contains
    index 1..1 MS and
    duration 1..1 MS and
    timeOfDay 0..1 MS and
    intensity 0..1 MS

* component[index].code = $LOINC#89022-8 "UV index"
* component[index].valueQuantity.system = $UCUM
* component[index].valueQuantity.code = #{index}
* component[index].valueQuantity ^short = "UV index value"

* component[duration].code = $LOINC#89023-6 "UV exposure duration"
* component[duration].valueQuantity.system = $UCUM
* component[duration].valueQuantity.code = #min
* component[duration].valueQuantity ^short = "Duration of UV exposure"

* component[timeOfDay].code = $LOINC#89026-9 "Time of exposure"
* component[timeOfDay].valueDateTime 1..1
* component[timeOfDay].valueDateTime ^short = "Time of UV exposure"

* component[intensity].code = $LOINC#89027-7 "UV intensity"
* component[intensity].valueQuantity.system = $UCUM
* component[intensity].valueQuantity.code = #W/m2
* component[intensity].valueQuantity ^short = "UV radiation intensity"

Extension: EnvironmentalContext
Id: environmental-context
Title: "Environmental Context Extension"
Description: "Additional context about environmental measurements"

* value[x] only CodeableConcept
* valueCodeableConcept from http://example.org/fhir/ValueSet/environmental-context (required)



// ===== Conteúdo de: SocialInteractionProfile.fsh =====

Profile: SocialInteractionProfile
Parent: Observation
Id: social-interaction
Title: "Social Interaction Profile"
Description: "Profile for recording social interaction data from iOS Health App"

* ^version = "0.1.0"
* ^status = #active
* ^date = "2024-01-03"
* ^publisher = "FMUP HEADS2"

* status MS
* category 1..1 MS
* category = http://terminology.hl7.org/CodeSystem/observation-category#social-history
* code 1..1 MS
* code = $LOINC#96766-1 "Social interaction pattern"
* subject 1..1 MS
* effectiveDateTime 1..1 MS
* value[x] only CodeableConcept
* valueCodeableConcept from SocialInteractionTypeVS (required)

* component ^slicing.discriminator.type = #pattern
* component ^slicing.discriminator.path = "code"
* component ^slicing.rules = #open

* component contains
    duration 0..1 MS and
    quality 0..1 MS and
    medium 0..1 MS and
    participants 0..1 MS

* component[duration]
  * code = $LOINC#89597-9 "Social interaction duration"
  * valueQuantity only Quantity
  * valueQuantity.system = $UCUM
  * valueQuantity.code = #min

* component[quality]
  * code = $LOINC#89598-7 "Social interaction quality"
  * valueCodeableConcept from SocialInteractionQualityVS (required)

* component[medium]
  * code = $LOINC#89599-5 "Social interaction medium"
  * valueCodeableConcept from SocialInteractionMediumVS (required)

* component[participants]
  * code = $LOINC#89600-1 "Social interaction participants"
  * valueInteger only integer

* extension contains
    SocialContext named context 0..1 MS and
    SocialSupport named support 0..1 MS and
    SocialActivity named activity 0..* MS



// ===== Conteúdo de: StressLevelProfile.fsh =====

Profile: StressLevelProfile
Parent: Observation
Id: stress-level
Title: "Stress Level Profile"
Description: "Profile for recording stress level measurements from iOS Health App"

* ^version = "0.1.0"
* ^status = #active
* ^date = "2024-01-03"
* ^publisher = "FMUP HEADS2"

* status MS
* category 1..1 MS
* category = http://terminology.hl7.org/CodeSystem/observation-category#vital-signs
* code 1..1 MS
* code = $LOINC#89592-0 "Stress level score"
* subject 1..1 MS
* effectiveDateTime 1..1 MS
* value[x] only Quantity
* valueQuantity MS

* component ^slicing.discriminator.type = #pattern
* component ^slicing.discriminator.path = "code"
* component ^slicing.rules = #open

* component contains
    physiologicalStress 0..1 MS and
    psychologicalStress 0..1 MS and
    chronicity 0..1 MS and 
    impact 0..1 MS

* component[physiologicalStress]
  * code = $LOINC#89593-8 "Physiological stress"
  * valueQuantity only Quantity
  * valueQuantity.system = $UCUM
  * valueQuantity.code = #{score}

* component[psychologicalStress]
  * code = $LOINC#89594-6 "Psychological stress"
  * valueQuantity only Quantity
  * valueQuantity.system = $UCUM
  * valueQuantity.code = #{score}

* component[chronicity]
  * code = $LOINC#89595-3 "Stress chronicity"
  * valueCodeableConcept from StressChronicityVS (required)

* component[impact]
  * code = $LOINC#89596-1 "Stress impact"
  * valueCodeableConcept from StressImpactVS (required)

* extension contains
    MeasurementContext named context 0..1 MS and
    StressTriggers named triggers 0..* MS and 
    StressCoping named coping 0..* MS



// ===== Conteúdo de: NutritionProfiles.fsh =====

Alias: $SCT = http://snomed.info/sct
Alias: $LOINC = http://loinc.org
Alias: $UCUM = http://unitsofmeasure.org

Profile: NutritionIntakeObservation
Parent: Observation
Id: nutrition-intake-observation
Title: "Nutrition Intake Observation Profile"
Description: "Profile for nutrition intake data from iOS Health App and user input"

* ^version = "0.1.0"
* ^status = #draft
* ^publisher = "Ricardo Lourenço dos Santos"

* status MS
* category 1..1 MS
* category = http://terminology.hl7.org/CodeSystem/observation-category#nutrition
* subject 1..1 MS
* effectiveDateTime 1..1 MS
* code 1..1 MS
* method 0..1 MS

Profile: WaterIntakeObservation
Parent: NutritionIntakeObservation 
Id: water-intake-observation
Title: "Water Intake Observation Profile"
Description: "Profile for water intake measurements"

* ^version = "0.1.0"
* ^status = #draft
* ^publisher = "Ricardo Lourenço dos Santos"

* code = $LOINC#77111-4 "Water intake"
* valueQuantity only Quantity
* valueQuantity.system = $UCUM
* valueQuantity.code = #mL
* valueQuantity.unit = "milliliter"

Profile: CalorieIntakeObservation
Parent: NutritionIntakeObservation
Id: calorie-intake-observation
Title: "Calorie Intake Observation Profile"
Description: "Profile for caloric intake measurements"

* ^version = "0.1.0"
* ^status = #draft
* ^publisher = "Ricardo Lourenço dos Santos"

* code = $LOINC#9051-4 "Caloric intake total"
* valueQuantity only Quantity
* valueQuantity.system = $UCUM
* valueQuantity.code = #kcal
* valueQuantity.unit = "kilocalorie"

Profile: MacronutrientsObservation
Parent: NutritionIntakeObservation
Id: macronutrients-observation
Title: "Macronutrients Observation Profile"
Description: "Profile for macronutrient intake measurements"

* ^version = "0.1.0"
* ^status = #draft
* ^publisher = "Ricardo Lourenço dos Santos"

* code = $LOINC#LP199119-9 "Macronutrients panel"
* component ^slicing.discriminator.type = #pattern
* component ^slicing.discriminator.path = "code"
* component ^slicing.rules = #open

* component contains
    carbohydrates 0..1 MS and
    proteins 0..1 MS and
    fats 0..1 MS

* component[carbohydrates].code = $LOINC#LP35925-4 "Carbohydrates"
* component[carbohydrates].valueQuantity.system = $UCUM
* component[carbohydrates].valueQuantity.code = #g
* component[carbohydrates].valueQuantity.unit = "gram"

* component[proteins].code = $LOINC#LP35921-3 "Proteins" 
* component[proteins].valueQuantity.system = $UCUM
* component[proteins].valueQuantity.code = #g
* component[proteins].valueQuantity.unit = "gram"

* component[fats].code = $LOINC#LP35922-1 "Fats"
* component[fats].valueQuantity.system = $UCUM
* component[fats].valueQuantity.code = #g
* component[fats].valueQuantity.unit = "gram"



// ===== Conteúdo de: MindfulnessMessaging.fsh =====

Alias: $MsgEvents = http://example.org/fhir/CodeSystem/mindfulness-message-events
Alias: $MsgTypes = http://terminology.hl7.org/CodeSystem/message-type

Profile: MindfulnessMessageDefinition
Parent: MessageDefinition
Id: mindfulness-message-definition
Title: "Mindfulness Message Definition" 
Description: "Definition for mindfulness session messages"

* url 1..1 MS
* date 1..1 MS
* status 1..1 MS
* event[x] 1..1 MS
* category 0..1 MS
* focus 1..* MS
* focus.min 1..1

Instance: StartSessionMessage
InstanceOf: MindfulnessMessageDefinition
Title: "Start Session Message"
Description: "Message definition for starting a mindfulness session"

* url = "http://example.org/fhir/MessageDefinition/start-session"
* date = "2024-03-19"
* status = #active
* eventCoding = $MsgEvents#session-start "Session Start"
* category = #notification
* focus.code = #Observation
* focus.min = 1
* focus.profile = "http://example.org/fhir/StructureDefinition/mindfulness-session"

Instance: EndSessionMessage  
InstanceOf: MindfulnessMessageDefinition
Title: "End Session Message"
Description: "Message definition for ending a mindfulness session"

* url = "http://example.org/fhir/MessageDefinition/end-session"
* date = "2024-03-19"
* status = #active
* eventCoding = $MsgEvents#session-end "Session End"
* category = #notification
* focus.code = #Observation
* focus.min = 1
* focus.profile = "http://example.org/fhir/StructureDefinition/mindfulness-session"



// ===== Conteúdo de: MindfulnessReports.fsh =====

Instance: MindfulnessProgressReport
InstanceOf: Measure
Usage: #definition
Title: "Mindfulness Practice Progress Report"

* status = #active
* experimental = false
* date = "2024-03-19"
* publisher = "Example Organization"
* description = "Measures progress in mindfulness practice over time"

* scoring = #continuous-variable
* type = #process
* riskAdjustment = "none"
* rateAggregation = "Average values over time period"

* group[0]
  * code = #practice-frequency
  * description = "Frequency of mindfulness practice"
  * population[0]
    * code = #denominator
    * criteria.language = #text/fhirpath
    * criteria.expression = "Observation.where(code.coding.code='711020003')"
  * stratifier[0]
    * code = #weekly
    * criteria.language = #text/fhirpath
    * criteria.expression = "Observation.effective.as(DateTime).truncate(@T).truncate(@W)"

* group[1]
  * code = #stress-reduction
  * description = "Stress level changes over time"
  * population[0]
    * code = #denominator
    * criteria.language = #text/fhirpath
    * criteria.expression = "Observation.where(component.code.coding.code='725854004')"
  * stratifier[0]
    * code = #trend
    * criteria.language = #text/fhirpath
    * criteria.expression = "component.where(code.coding.code='725854004').value.value"

RuleSet: ReportingMetrics
* group[+]
  * code = #session-duration
  * description = "Duration of practice sessions"
  * population[0]
    * code = #denominator
    * criteria.language = #text/fhirpath
    * criteria.expression = "Observation.component.where(code.coding.code='118682006')"
  * stratifier[0]
    * code = #average
    * criteria.language = #text/fhirpath
    * criteria.expression = "component.where(code.coding.code='118682006').value.value"

* group[+]
  * code = #mood-changes
  * description = "Mood state changes"
  * population[0]
    * code = #denominator
    * criteria.language = #text/fhirpath
    * criteria.expression = "Observation.component.where(code.coding.code='373931001')"



// ===== Conteúdo de: MindfulnessCapabilities.fsh =====

Instance: MindfulnessCapabilityStatement
InstanceOf: CapabilityStatement
Usage: #definition
Title: "Mindfulness Module Capabilities"
Description: "Capabilities supported by the mindfulness module implementation"

* status = #draft
* date = "2024-03-19"
* kind = #requirements
* fhirVersion = #4.0.1
* format[0] = #json
* format[1] = #xml

* rest[0]
  * mode = #server
  * documentation = "RESTful server capabilities for mindfulness data"
  
  * resource[0]
    * type = #Observation
    * documentation = "Supports mindfulness session observations"
    * profile = "https://2rdoc.pt/ig/ios-lifestyle-medicine/StructureDefinition/mindfulness-observation"
    * interaction[0]
      * code = #read
    * interaction[1]
      * code = #create
    * interaction[2]
      * code = #update
    * interaction[3]
      * code = #search-type
    * searchParam[0]
      * name = "patient"
      * type = #reference
      * documentation = "Search by patient reference"
    * searchParam[1]
      * name = "date"
      * type = #date
      * documentation = "Search by session date"
    * searchParam[2]
      * name = "code"
      * type = #token
      * documentation = "Search by observation type"
      
  * resource[1]
    * type = #Questionnaire
    * documentation = "Supports mindfulness questionnaires"
    * profile = "https://2rdoc.pt/ig/ios-lifestyle-medicine/StructureDefinition/mindfulness-questionnaire"
    * interaction[0]
      * code = #read
    * interaction[1]
      * code = #search-type
    * searchParam[0]
      * name = "title"
      * type = #string
      * documentation = "Search by questionnaire title"
      
  * resource[2]
    * type = #QuestionnaireResponse
    * documentation = "Supports mindfulness questionnaire responses"
    * profile = "https://2rdoc.pt/ig/ios-lifestyle-medicine/StructureDefinition/mindfulness-questionnaire-response"
    * interaction[0]
      * code = #create
    * interaction[1]
      * code = #read
    * interaction[2]
      * code = #search-type
    * searchParam[0]
      * name = "patient"
      * type = #reference
      * documentation = "Search by patient reference"
    * searchParam[1]
      * name = "authored"
      * type = #date
      * documentation = "Search by response date"



// ===== Conteúdo de: MindfulnessQuestionnaires.fsh =====

Instance: DailyMindfulnessQuestionnaire
InstanceOf: Questionnaire
Usage: #definition
Title: "Daily Mindfulness Questionnaire"
Description: "Questionnaire for capturing daily mindfulness practice and associated effects"

* url = "https://2rdoc.pt/ig/ios-lifestyle-medicine/Questionnaire/daily-mindfulness"
* status = #active
* title = "Daily Mindfulness Practice"
* subjectType = #Patient
* version = "1.0.0"
* name = "DailyMindfulnessQuestionnaire"
* date = "2024-03-19"

* item[0]
  * linkId = "mindful_session"
  * text = "Mindfulness Session"
  * type = #group
  * repeats = false

  * item[0]
    * linkId = "session_duration"
    * text = "Session duration (minutes)"
    * type = #integer
    * required = true
    * extension[0].url = "http://hl7.org/fhir/StructureDefinition/minValue"
    * extension[0].valueInteger = 1

  * item[1]
    * linkId = "practice_type"
    * text = "Practice type"
    * type = #choice
    * required = true
    * answerOption[0].valueString = "Meditation"
    * answerOption[1].valueString = "Breathing exercise"
    * answerOption[2].valueString = "Body scan"
    * answerOption[3].valueString = "Mindful walking"

* item[1]
  * linkId = "mood_assessment"
  * text = "Mood Assessment"
  * type = #group

  * item[0]
    * linkId = "current_mood"
    * text = "How is your mood now?"
    * type = #choice
    * required = true
    * answerValueSet = "https://2rdoc.pt/fhir/ValueSet/mood-vs"

  * item[1]
    * linkId = "mood_intensity"
    * text = "Mood intensity (1-5)"
    * type = #integer
    * required = true

* item[2]
  * linkId = "stress_assessment"
  * text = "Stress Assessment"
  * type = #group

  * item[0]
    * linkId = "stress_level"
    * text = "Stress level (0-10)"
    * type = #integer
    * required = true

  * item[1]
    * linkId = "stress_symptoms"
    * text = "Stress symptoms"
    * type = #choice
    * repeats = true
    * answerOption[0].valueString = "Muscle tension"
    * answerOption[1].valueString = "Anxiety"
    * answerOption[2].valueString = "Headache"
    * answerOption[3].valueString = "Fatigue"

* item[3]
  * linkId = "relaxation"
  * text = "Relaxation"
  * type = #group

  * item[0]
    * linkId = "relaxation_duration"
    * text = "Relaxation time (minutes)"
    * type = #integer
    * required = true

  * item[1]
    * linkId = "relaxation_technique"
    * text = "Technique used"
    * type = #choice
    * required = true
    * answerOption[0].valueString = "Deep breathing"
    * answerOption[1].valueString = "Progressive relaxation"
    * answerOption[2].valueString = "Visualization"
    * answerOption[3].valueString = "Mindful awareness"



// ===== Conteúdo de: NutritionQuestionnaires.fsh =====

Instance: DailyNutritionQuestionnaire
InstanceOf: Questionnaire
Usage: #definition
Title: "Daily Nutrition Intake Questionnaire"
Description: "Questionnaire for daily nutrition intake tracking"

* url = "https://2rdoc.pt/ig/ios-lifestyle-medicine/Questionnaire/daily-nutrition"
* version = "0.1.0"
* name = "DailyNutritionQuestionnaire"
* title = "Daily Nutrition Intake"
* status = #active
* experimental = false
* date = "2024-12-14"
* publisher = "Ricardo Lourenço dos Santos"

* item[0]
  * linkId = "water_intake"
  * text = "How much water did you drink today?"
  * type = #quantity
  * required = true
  * repeats = false
  * initial.valueQuantity = 0 'mL'

* item[1]
  * linkId = "meal_record"
  * text = "Meal Records"
  * type = #group
  * repeats = true

  * item[0]
    * linkId = "meal_time"
    * text = "Meal Time"
    * type = #dateTime
    * required = true

  * item[1]
    * linkId = "meal_type"
    * text = "Meal Type"
    * type = #choice
    * required = true
    * answerOption[0].valueString = "Breakfast"
    * answerOption[1].valueString = "Lunch"
    * answerOption[2].valueString = "Dinner"
    * answerOption[3].valueString = "Snack"

  * item[2]
    * linkId = "calories"
    * text = "Estimated Calories"
    * type = #integer
    * required = true

  * item[3]
    * linkId = "macronutrients"
    * text = "Macronutrients"
    * type = #group

    * item[0]
      * linkId = "carbs"
      * text = "Carbohydrates (g)"
      * type = #decimal
      * required = true

    * item[1]
      * linkId = "protein"
      * text = "Proteins (g)"
      * type = #decimal
      * required = true

    * item[2]
      * linkId = "fat"
      * text = "Fats (g)"
      * type = #decimal
      * required = true

* item[2]
  * linkId = "caffeine"
  * text = "Caffeine Intake"
  * type = #group

  * item[0]
    * linkId = "caffeine_amount"
    * text = "Caffeine amount (mg)"
    * type = #integer
    * required = false

  * item[1]
    * linkId = "caffeine_source"
    * text = "Caffeine source"
    * type = #choice
    * repeats = true
    * answerOption[0].valueString = "Coffee"
    * answerOption[1].valueString = "Tea"
    * answerOption[2].valueString = "Soft Drink"
    * answerOption[3].valueString = "Energy Drink"



// ===== Conteúdo de: ReproductiveQuestionnaire.fsh =====

Instance: ReproductiveHealthQuestionnaire
InstanceOf: Questionnaire
Usage: #definition
Title: "Reproductive Health Tracking Questionnaire"
Description: "Daily questionnaire for reproductive health tracking"
 
* status = #active
* url = "https://2rdoc.pt/ig/ios-lifestyle-medicine/Questionnaire/reproductive-health"
* name = "ReproductiveHealthQuestionnaire"
* title = "Reproductive Health Monitoring"
* date = "2024-03-19"
 
* item[0]
  * linkId = "menstrual_cycle"
  * text = "Menstrual Cycle"
  * type = #group
 
  * item[0]
    * linkId = "cycle_start"
    * text = "Cycle started today?"
    * type = #boolean
 
  * item[1]
    * linkId = "flow_intensity"
    * text = "Flow intensity"
    * type = #choice
    * enableWhen
      * question = "cycle_start"
      * operator = #=
      * answerBoolean = true
    * answerOption[0].valueString = "Light"
    * answerOption[1].valueString = "Moderate"
    * answerOption[2].valueString = "Heavy"
 
* item[1]
  * linkId = "symptoms"
  * text = "Symptoms"
  * type = #group
  * repeats = true
 
  * item[0]
    * linkId = "symptom_type"
    * text = "Symptom type"
    * type = #choice
    * answerValueSet = "https://2rdoc.pt/fhir/ValueSet/reproductive-symptoms"
 
  * item[1]
    * linkId = "symptom_severity"
    * text = "Intensity (0-10)"
    * type = #integer
    * extension[0]
      * url = "http://hl7.org/fhir/StructureDefinition/minValue"
      * valueInteger = 0
    * extension[1]
      * url = "http://hl7.org/fhir/StructureDefinition/maxValue"
      * valueInteger = 10
 
* item[2]
  * linkId = "mood_changes"
  * text = "Mood Changes"
  * type = #group

  * item[0]
    * linkId = "mood_type"
    * text = "Current mood"
    * type = #choice
    * answerValueSet = "https://2rdoc.pt/fhir/ValueSet/mood-types"

  * item[1]
    * linkId = "mood_severity"
    * text = "Intensity (0-10)"
    * type = #integer
    * extension[0]
      * url = "http://hl7.org/fhir/StructureDefinition/minValue"
      * valueInteger = 0
    * extension[1]
      * url = "http://hl7.org/fhir/StructureDefinition/maxValue"
      * valueInteger = 10



// ===== Conteúdo de: aliases.fsh =====

Alias: SCT = http://snomed.info/sct
Alias: LOINC = http://loinc.org
Alias: UCUM = http://unitsofmeasure.org



// ===== Conteúdo de: MindfulnessTerminology.fsh =====

CodeSystem: MindfulnessOutcomeCS
Id: mindfulness-outcome-cs
Title: "Mindfulness Outcomes"
Description: "Outcomes and effects of mindfulness practice"

* ^experimental = false
* ^caseSensitive = true
* #increasedAwareness "Increased Awareness" "Greater awareness of thoughts and sensations"
* #improvedFocus "Improved Focus" "Enhanced ability to concentrate"
* #stressReduction "Stress Reduction" "Decreased levels of stress and tension"
* #emotionalBalance "Emotional Balance" "Better emotional regulation"
* #improvedSleep "Improved Sleep" "Enhanced sleep quality"

ValueSet: MindfulnessOutcomeVS
Id: mindfulness-outcome-vs
Title: "Mindfulness Outcomes Value Set"
Description: "Value set for mindfulness practice outcomes"

* ^experimental = false
* include codes from system MindfulnessOutcomeCS
* include $SCT#365949003 "Finding of level of stress"
* include $SCT#373931001 "Mood finding"

CodeSystem: MindfulnessQualifierCS
Id: mindfulness-qualifier-cs
Title: "Mindfulness Practice Qualifiers"
Description: "Qualifiers for mindfulness practice characteristics"

* ^experimental = false
* ^caseSensitive = true
* #guided "Guided Practice" "Practice with guidance or instruction"
* #selfDirected "Self-Directed" "Independent practice"
* #group "Group Practice" "Practice in group setting"
* #individual "Individual Practice" "Solo practice session"

ValueSet: MindfulnessQualifierVS
Id: mindfulness-qualifier-vs
Title: "Mindfulness Practice Qualifiers Value Set"
Description: "Value set for mindfulness practice qualifiers"

* ^experimental = false
* include codes from system MindfulnessQualifierCS
* include $SCT#410534003 "Guided meditation"
* include $SCT#225386006 "Exercise therapy"

* ^copyright = "This value set includes content from SNOMED CT, which is copyright © 2002+ International Health Terminology Standards Development Organisation (IHTSDO)"



// ===== Conteúdo de: MindfulnessConfig.fsh =====

Extension: MindfulnessSessionDuration
Id: mindfulness-session-duration
Title: "Mindfulness Session Duration"
Description: "Default duration for mindfulness sessions in minutes"
* value[x] only integer

Extension: MindfulnessReminderTime
Id: mindfulness-reminder-time
Title: "Mindfulness Reminder Time"
Description: "Default time for daily reminders"
* value[x] only time

Extension: MindfulnessPreferredGuide
Id: mindfulness-preferred-guide
Title: "Mindfulness Preferred Guide"
Description: "Preferred guide for mindfulness sessions"
* value[x] only string

Extension: MindfulnessNotificationEnabled
Id: mindfulness-notification-enabled
Title: "Mindfulness Notification Enabled"
Description: "Whether notifications are enabled for mindfulness sessions"
* value[x] only boolean

Profile: MindfulnessConfiguration
Parent: Basic
Id: mindfulness-configuration
Title: "Mindfulness Configuration"
Description: "Configuration settings for mindfulness sessions"

* code 1..1 MS
* code = https://2rdoc.pt/fhir/CodeSystem/mindfulness-config-type#settings "Mindfulness Settings"

* extension contains
    MindfulnessSessionDuration named sessionDuration 1..1 MS and
    MindfulnessReminderTime named reminderTime 1..1 MS and
    MindfulnessPreferredGuide named preferredGuide 0..1 MS and
    MindfulnessNotificationEnabled named notificationEnabled 1..1 MS

Instance: DefaultMindfulnessConfig
InstanceOf: MindfulnessConfiguration
Title: "Default Mindfulness Configuration"
Description: "Default configuration settings for mindfulness sessions"

* code = https://2rdoc.pt/fhir/CodeSystem/mindfulness-config-type#settings "Mindfulness Settings"
* extension[sessionDuration].valueInteger = 15
* extension[reminderTime].valueTime = "08:00:00"
* extension[preferredGuide].valueString = "Jane Smith"
* extension[notificationEnabled].valueBoolean = true



// ===== Conteúdo de: MindfulnessAuditConfig.fsh =====

Extension: MindfulnessAuditLevel
Id: mindfulness-audit-level
Title: "Mindfulness Audit Level"
Description: "Level of detail for audit records"
* value[x] only code
* valueCode from https://2rdoc.pt/fhir/ValueSet/audit-levels (required)

Extension: MindfulnessAuditRetention
Id: mindfulness-audit-retention
Title: "Mindfulness Audit Retention"
Description: "Period to retain audit records"
* value[x] only Duration

Extension: MindfulnessAuditFormat
Id: mindfulness-audit-format
Title: "Mindfulness Audit Format"
Description: "Format for audit records"
* value[x] only code
* valueCode from https://2rdoc.pt/fhir/ValueSet/audit-formats (required)

Profile: MindfulnessAuditConfig
Parent: Basic
Id: mindfulness-audit-config
Title: "Mindfulness Audit Configuration"
Description: "Configuration for mindfulness session auditing"

* code 1..1 MS
* code = https://2rdoc.pt/fhir/CodeSystem/mindfulness-config-type#audit "Audit Configuration"

* extension contains
    MindfulnessAuditLevel named auditLevel 1..1 MS and
    MindfulnessAuditRetention named auditRetention 1..1 MS and
    MindfulnessAuditFormat named auditFormat 1..1 MS

Instance: DefaultAuditConfig
InstanceOf: MindfulnessAuditConfig
Title: "Default Audit Configuration"
Description: "Default configuration for mindfulness session auditing"

* code = https://2rdoc.pt/fhir/CodeSystem/mindfulness-config-type#audit "Audit Configuration"
* extension[auditLevel].valueCode = #detailed
* extension[auditRetention].valueDuration = 90 'days'
* extension[auditFormat].valueCode = #fhir



// ===== Conteúdo de: MindfulnessSecurity.fsh =====

// ====== Mindfulness Security and Consent Resources ======

Instance: MindfulnessSecurityDefinition
InstanceOf: Consent
Usage: #example
* status = #active
* scope = $consentscope#patient-privacy "Privacy Consent"
* category[0] = $loinc#59284-0 "Patient Consent"
* patient = Reference(Patient/PatientMindfulness)
* dateTime = "2024-01-01"
* organization = Reference(Organization/Org2RDoc)
* policy[0].authority = "http://terminology.hl7.org/CodeSystem/consentpolicycodes"
* policy[0].uri = "http://terminology.hl7.org/CodeSystem/consentpolicycodes"
* provision.type = #permit
* provision.period.start = "2024-01-01"
* provision.period.end = "2025-12-31"
* provision.actor[0].role = $v3-RoleCode#TREAT "treatment"
* provision.actor[0].reference.identifier.system = "http://terminology.hl7.org/CodeSystem/practitioner-identifier"
* provision.actor[0].reference.identifier.value = "1234567890"
* provision.securityLabel[0] = $v3-Confidentiality#N "normal"
* provision.purpose[0] = $v3-ActReason#TREAT "treatment"
* provision.dataPeriod.start = "2024-01-01"
* provision.dataPeriod.end = "2025-12-31"

Instance: MindfulnessAccessPolicy
InstanceOf: Consent
Usage: #example
* status = #active
* scope = $consentscope#patient-privacy "Privacy Consent"
* category[0] = $loinc#59284-0 "Patient Consent"
* patient = Reference(Patient/PatientMindfulness)
* dateTime = "2024-01-01"
* organization = Reference(Organization/Org2RDoc)

// Políticas multi-jurisdicionais - começando do índice 0
* policy[0].authority = "http://terminology.hl7.org/CodeSystem/consentpolicycodes"
* policy[0].uri = "http://terminology.hl7.org/CodeSystem/consentpolicycodes"

// GDPR - Europa
* policy[1].authority = "https://eur-lex.europa.eu/eli/reg/2016/679/oj"
* policy[1].uri = "https://health.ec.europa.eu/ehealth-digital-health-and-care/european-health-data-space-regulation-ehds_en"

// HIPAA - Estados Unidos
* policy[2].authority = "https://www.hhs.gov/hipaa/index.html"
* policy[2].uri = "https://www.hhs.gov/hipaa/for-professionals/privacy/laws-regulations/index.html"

// LGPD - Brasil
* policy[3].authority = "http://www.planalto.gov.br/ccivil_03/_ato2015-2018/2018/lei/L13709compilado.htm"
* policy[3].uri = "https://www.gov.br/anpd/pt-br/"

* provision.type = #permit
* provision.period.start = "2024-01-01"
* provision.period.end = "2025-12-31"
* provision.actor[0].role = $v3-RoleCode#TREAT "treatment"
* provision.actor[0].reference.identifier.system = "http://terminology.hl7.org/CodeSystem/practitioner-identifier"
* provision.actor[0].reference.identifier.value = "1234567890"
* provision.action[0] = $consentaction#access "Access"
* provision.action[1] = $consentaction#use "Use"
* provision.purpose[0] = $v3-ActReason#TREAT "treatment"
* provision.purpose[1] = $v3-ActReason#HPAYMT "healthcare payment"
* provision.purpose[2] = $v3-ActReason#HOPERAT "healthcare operations"
* provision.dataPeriod.start = "2024-01-01"
* provision.dataPeriod.end = "2025-12-31"

// ====== Aliases para simplificar referências ======
Alias: $consentscope = http://terminology.hl7.org/CodeSystem/consentscope
Alias: $loinc = http://loinc.org
Alias: $v3-RoleCode = http://terminology.hl7.org/CodeSystem/v3-RoleCode
Alias: $v3-Confidentiality = http://terminology.hl7.org/CodeSystem/v3-Confidentiality
Alias: $v3-ActReason = http://terminology.hl7.org/CodeSystem/v3-ActReason
Alias: $consentaction = http://terminology.hl7.org/CodeSystem/consentaction



// ===== Conteúdo de: MindfulnessResources.fsh =====

CodeSystem: MindfulnessTypeCS
Id: mindfulness-type-cs
Title: "Mindfulness Practice Types"
Description: "Types of mindfulness practices and techniques"
* ^experimental = false
* ^caseSensitive = true
* #meditation "Meditation" "Focused meditation practice"
* #breathing "Breathing Exercise" "Conscious breathing techniques"
* #bodyScan "Body Scan" "Progressive body awareness practice"
* #walking "Mindful Walking" "Walking meditation practice"
* #movement "Mindful Movement" "Conscious movement practice"

CodeSystem: EnvironmentTypeCS
Id: environment-type-cs
Title: "Practice Environment Types"
Description: "Types of environments for mindfulness practice"
* ^experimental = false
* ^caseSensitive = true
* #indoor "Indoor" "Indoor environment"
* #outdoor "Outdoor" "Outdoor environment"
* #quiet "Quiet Space" "Quiet or silent environment"
* #group "Group Setting" "Group practice environment"

ValueSet: MindfulnessTypeVS
Id: mindfulness-type-vs
Title: "Mindfulness Practice Types Value Set"
Description: "Value set of mindfulness practice types"
* ^experimental = false
* include codes from system MindfulnessTypeCS

ValueSet: EnvironmentTypeVS
Id: environment-type-vs
Title: "Practice Environment Types Value Set"
Description: "Value set of practice environment types"
* ^experimental = false
* include codes from system EnvironmentTypeCS

Instance: MindfulnessSettingCS
InstanceOf: CodeSystem
Usage: #definition
* url = "https://2rdoc.pt/ig/ios-lifestyle-medicine/CodeSystem/mindfulness-setting"
* version = "1.0.0"
* name = "MindfulnessSettingCS"
* title = "Mindfulness Setting CodeSystem"
* status = #active
* experimental = false
* caseSensitive = true
* content = #complete
* count = 5
* concept[+].code = #home
* concept[=].display = "Home Practice"
* concept[+].code = #clinic
* concept[=].display = "Clinical Setting"
* concept[+].code = #group
* concept[=].display = "Group Setting"
* concept[+].code = #retreat
* concept[=].display = "Retreat Setting"
* concept[+].code = #workplace
* concept[=].display = "Workplace Setting"



// ===== Conteúdo de: MindfulnessNarrative.fsh =====

RuleSet: MindfulnessObservationNarrative
* text.status = #generated
* text.div = "<div xmlns=\"http://www.w3.org/1999/xhtml\">
    <p><b>Generated Narrative</b></p>
    <p><b>Session Type:</b> Mindfulness Practice Session</p>
    <p><b>Date:</b> {effectiveDateTime}</p>
    <p><b>Duration:</b> {component[sessionDuration].value} minutes</p>
    <p><b>Stress Level:</b> {component[stressLevel].value} / 10</p>
    <p><b>Mood:</b> {component[moodState].value}</p>
    <p><b>Technique:</b> {component[relaxationResponse].value}</p>
    <p><b>Location:</b> {extension[mindfulness-context].extension[location].value}</p>
  </div>"

RuleSet: MindfulnessQuestionnaireNarrative
* text.status = #generated
* text.div = "<div xmlns=\"http://www.w3.org/1999/xhtml\">
    <p><b>Generated Narrative</b></p>
    <p><b>Title:</b> {title}</p>
    <p><b>Status:</b> {status}</p>
    <h3>Sections</h3>
    <ul>
      <li>Mindfulness Session</li>
      <li>Mood Assessment</li>
      <li>Stress Assessment</li>
      <li>Relaxation</li>
    </ul>
  </div>"

RuleSet: MindfulnessResponseNarrative
* text.status = #generated
* text.div = "<div xmlns=\"http://www.w3.org/1999/xhtml\">
    <p><b>Generated Narrative</b></p>
    <p><b>Date:</b> {authored}</p>
    <p><b>Session Duration:</b> {item[session_duration].answer.value} minutes</p>
    <p><b>Practice Type:</b> {item[practice_type].answer.value}</p>
    <p><b>Mood:</b> {item[current_mood].answer.value}</p>
    <p><b>Stress Level:</b> {item[stress_level].answer.value} / 10</p>
    <p><b>Relaxation Technique:</b> {item[relaxation_technique].answer.value}</p>
  </div>"

RuleSet: MindfulnessConfigNarrative
* text.status = #generated
* text.div = "<div xmlns=\"http://www.w3.org/1999/xhtml\">
    <p><b>Generated Narrative</b></p>
    <p><b>Default Duration:</b> {extension[defaultDuration].value} minutes</p>
    <p><b>Reminders:</b> {extension[reminderSettings].value}</p>
    <p><b>Data Sync:</b> {extension[dataSync].value}</p>
  </div>"



// ===== Conteúdo de: StressInvariants.fsh =====

Invariant: stress-level-range
Description: "Stress level score must be between 0 and 10"
Expression: "valueQuantity.exists() implies (valueQuantity.value >= 0 and valueQuantity.value <= 10)"
Severity: #error

Invariant: stress-component-consistency
Description: "Physiological and psychological stress scores must be consistent with overall score"
Expression: "component.where(code.coding.code='89593-8').value.exists() and component.where(code.coding.code='89594-6').value.exists() implies (component.where(code.coding.code='89593-8').value + component.where(code.coding.code='89594-6').value) div 2 = valueQuantity"
Severity: #warning



// ===== Conteúdo de: SocialInteractionInvariants.fsh =====

Invariant: social-interaction-duration
Description: "Social interaction duration must be positive"
Expression: "component.where(code.coding.code='89597-9').value.exists() implies component.where(code.coding.code='89597-9').value > 0"
Severity: #error

Invariant: social-interaction-participants
Description: "Number of participants must be at least 2 for social interaction"
Expression: "component.where(code.coding.code='89600-1').value.exists() implies component.where(code.coding.code='89600-1').value >= 2"
Severity: #error



// ===== Conteúdo de: MindfulnessInvariants.fsh =====

Invariant: mindfulness-session-duration
Description: "Mindfulness session duration must be between 1 and 180 minutes"
Expression: "component.where(code.coding.system='http://snomed.info/sct' and code.coding.code='118682006').value.ofType(Quantity).value.exists() implies (component.where(code.coding.system='http://snomed.info/sct' and code.coding.code='118682006').value.ofType(Quantity).value >= 1 and component.where(code.coding.system='http://snomed.info/sct' and code.coding.code='118682006').value.ofType(Quantity).value <= 180)"
Severity: #error

Invariant: mindfulness-stress-level
Description: "Stress level must be between 0 and 10"
Expression: "component.where(code.coding.system='http://snomed.info/sct' and code.coding.code='725854004').value.ofType(Integer).exists() implies (component.where(code.coding.system='http://snomed.info/sct' and code.coding.code='725854004').value.ofType(Integer) >= 0 and component.where(code.coding.system='http://snomed.info/sct' and code.coding.code='725854004').value.ofType(Integer) <= 10)"
Severity: #error

Invariant: mindfulness-mood-required
Description: "Mood assessment must include a mood state and intensity"
Expression: "component.where(code.coding.system='http://snomed.info/sct' and code.coding.code='373931001').exists() implies component.where(code.coding.system='http://snomed.info/sct' and code.coding.code='373931001').value.exists()"
Severity: #warning

Invariant: mindfulness-context-complete
Description: "Mindfulness context should include location and environment"
Expression: "extension.where(url='https://2rdoc.pt/ig/ios-lifestyle-medicine/StructureDefinition/mindfulness-context').exists() implies (extension.where(url='https://2rdoc.pt/ig/ios-lifestyle-medicine/StructureDefinition/mindfulness-context').extension.where(url='location').exists() and extension.where(url='https://2rdoc.pt/ig/ios-lifestyle-medicine/StructureDefinition/mindfulness-context').extension.where(url='environment').exists())"
Severity: #warning

Invariant: sequential-measurements
Description: "Sequential measurements must have increasing effectiveDateTime"
Expression: "component.where(code.coding.system='http://snomed.info/sct' and code.coding.code='118682006').exists() implies (effectiveDateTime > previous().effectiveDateTime)"
Severity: #warning



// ===== Conteúdo de: MindfulnessOperations.fsh =====

Profile: MindfulnessOperation
Parent: OperationDefinition 
Id: mindfulness-operation
Title: "Mindfulness Operation"
Description: "Base definition for mindfulness operations"

* status 1..1
* kind 1..1
* name 1..1
* code 1..1
* resource 1..1
* system 1..1
* type 1..1
* instance 1..1
* parameter 0..*
* parameter.name 1..1

Instance: StartSessionOperation
InstanceOf: MindfulnessOperation
Title: "Start Session Operation"
Description: "Operation to start a new mindfulness session"

* status = #active
* kind = #operation
* name = "start-session"
* code = #start
* resource = #Observation
* system = false
* type = true
* instance = false
* parameter[+]
  * name = #duration
  * use = #in
  * min = 1
  * max = "1" 
  * type = #integer
  * documentation = "Duration in minutes"

Instance: EndSessionOperation
InstanceOf: MindfulnessOperation
Title: "End Session Operation"
Description: "Operation to end an ongoing mindfulness session"

* status = #active
* kind = #operation
* name = "end-session"
* code = #end
* resource = #Observation
* system = false
* type = true
* instance = true
* parameter[+]
  * name = #session
  * use = #in
  * min = 1
  * max = "1"
  * type = #string
  * documentation = "ID of the session to end"



// ===== Conteúdo de: VitalSignsExtensions.fsh =====

Extension: MeasurementContext
Id: measurement-context
Title: "Measurement Context Extension"
* ^experimental = false
Description: "Additional context about the vital sign measurement"
* value[x] only CodeableConcept
* valueCodeableConcept from MeasurementContextVS (required)

ValueSet: MeasurementContextVitalSigns
Id: measurement-context-vital-signs
Description: "Value set for measurement context in vital signs observations"Title: "Measurement Context Value Set"
* $SCT#255214003 "At rest"
* $SCT#309604004 "During exercise"
* $SCT#309605003 "Post exercise"
* $SCT#248626006 "During sleep"



// ===== Conteúdo de: NutritionExtensions.fsh =====

Extension: NutritionDataSource
Id: nutrition-data-source
Title: "Nutrition Data Source Extension"
Description: "Indicates the source of nutrition data"

* ^version = "0.1.0"
* ^status = #draft
* ^experimental = false
* ^date = "2024-12-14"
* ^publisher = "Ricardo Lourenço dos Santos"
* ^context[0].type = #element
* ^context[0].expression = "Observation"

* value[x] only CodeableConcept
* valueCodeableConcept from NutritionDataSourceVS (required)

ValueSet: NutritionDataSourceVS
Id: nutrition-data-source-vs
Title: "Nutrition Data Source Value Set"
Description: "Value set for nutrition data sources"

* ^version = "0.1.0"
* ^status = #draft
* ^experimental = false
* ^date = "2024-12-14"
* ^publisher = "Ricardo Lourenço dos Santos"

* codes from system NutritionDataSourceCS

CodeSystem: NutritionDataSourceCS
Id: nutrition-data-source-cs
Title: "Nutrition Data Source Code System"
Description: "Code system for nutrition data sources"

* ^version = "0.1.0"
* ^status = #draft
* ^experimental = false
* ^date = "2024-12-14"
* ^publisher = "Ricardo Lourenço dos Santos"
* ^caseSensitive = true

* #manual "Manual Entry" "Data entered manually by user"
* #app "App Integration" "Data from integrated third-party apps"
* #device "Connected Device" "Data from connected nutrition tracking devices"
* #questionnaire "Questionnaire Response" "Data collected through questionnaires"



// ===== Conteúdo de: AdvancedVitalSignsExtensions.fsh =====

Alias: $UCUM = http://unitsofmeasure.org

Extension: PhysiologicalStressIndex
Id: physiological-stress-index
Title: "Physiological Stress Index Extension"
Description: "Index representing overall physiological stress based on multiple parameters"

* ^version = "0.1.0"
* ^status = #draft
* ^context[+].type = #element
* ^context[=].expression = "Observation"

* value[x] only Quantity
* valueQuantity.system = $UCUM
* valueQuantity.code = #{index}
* valueQuantity ^short = "Physiological stress index value"
* valueQuantity ^definition = "Normalized index value representing overall physiological stress"

Extension: HomeostasisIndex
Id: homeostasis-index
Title: "Homeostasis Index Extension"
Description: "Composite measure of physiological balance and adaptation"

* ^version = "0.1.0"
* ^status = #draft
* ^context[+].type = #element
* ^context[=].expression = "Observation"

* value[x] only Quantity
* valueQuantity.system = $UCUM
* valueQuantity.code = #{ratio}
* valueQuantity ^short = "Homeostasis index value"
* valueQuantity ^definition = "Normalized ratio representing physiological balance"

Extension: RecoveryEfficiency
Id: recovery-efficiency
Title: "Recovery Efficiency Extension"
Description: "Measure of how efficiently the body recovers from stress or exertion"

* ^version = "0.1.0"
* ^status = #draft
* ^context[+].type = #element
* ^context[=].expression = "Observation"

* value[x] only Quantity
* valueQuantity.system = $UCUM
* valueQuantity.code = #%
* valueQuantity ^short = "Recovery efficiency percentage"
* valueQuantity ^definition = "Percentage indicating recovery efficiency"

Extension: AllostaticLoad
Id: allostatic-load
Title: "Allostatic Load Extension"
Description: "Measure of cumulative physiological burden over time"

* ^version = "0.1.0"
* ^status = #draft
* ^context[+].type = #element
* ^context[=].expression = "Observation"

* value[x] only Quantity
* valueQuantity.system = $UCUM
* valueQuantity.code = #{score}
* valueQuantity ^short = "Allostatic load score"
* valueQuantity ^definition = "Score representing cumulative physiological burden"

Extension: CircadianPhase
Id: circadian-phase
Title: "Circadian Phase Extension"
Description: "Indicator of position in circadian rhythm cycle"

* ^version = "0.1.0"
* ^status = #draft
* ^context[+].type = #element
* ^context[=].expression = "Observation"

* value[x] only CodeableConcept
* valueCodeableConcept from CircadianPhaseVS (required)

ValueSet: CircadianPhaseVS
Id: circadian-phase-vs
Title: "Circadian Phase Value Set"
Description: "Value set for circadian rhythm phases"

* ^experimental = true
* codes from system CircadianPhaseCS

CodeSystem: CircadianPhaseCS
Id: circadian-phase-cs
Title: "Circadian Phase Code System"
Description: "Code system for circadian rhythm phases"

* ^experimental = true
* ^caseSensitive = true

* #early-morning "Early Morning Phase" "Period shortly after awakening"
* #mid-morning "Mid Morning Phase" "Mid-morning period"
* #afternoon "Afternoon Phase" "Afternoon period"
* #evening "Evening Phase" "Evening period"
* #night "Night Phase" "Nighttime period"
* #deep-night "Deep Night Phase" "Deep night period"

Extension: MeasurementQuality
Id: measurement-quality
Title: "Measurement Quality Extension"
Description: "Indicator of the quality and reliability of the measurement"

* ^version = "0.1.0"
* ^status = #draft
* ^context[+].type = #element
* ^context[=].expression = "Observation"

* value[x] only CodeableConcept
* valueCodeableConcept from MeasurementQualityVS (required)

ValueSet: MeasurementQualityVS
Id: measurement-quality-vs
Title: "Measurement Quality Value Set"
Description: "Value set for measurement quality indicators"

* ^experimental = true
* codes from system MeasurementQualityCS

CodeSystem: MeasurementQualityCS
Id: measurement-quality-cs
Title: "Measurement Quality Code System"
Description: "Code system for measurement quality indicators"

* ^experimental = true
* ^caseSensitive = true

* #excellent "Excellent Quality" "High quality measurement with minimal noise"
* #good "Good Quality" "Good quality measurement with acceptable noise"
* #fair "Fair Quality" "Fair quality measurement with some interference"
* #poor "Poor Quality" "Poor quality measurement with significant interference"
* #unreliable "Unreliable" "Unreliable measurement requiring verification"



// ===== Conteúdo de: StressExtensions.fsh =====

Extension: StressTriggers
Id: stress-triggers
Title: "Stress Triggers Extension"
* ^experimental = false
Description: "Extension for recording identified stress triggers"
* value[x] only CodeableConcept
* valueCodeableConcept from StressTriggersVS (required)

Extension: StressCoping
Id: stress-coping
Title: "Stress Coping Extension"
* ^experimental = false
Description: "Extension for recording stress coping mechanisms"
* value[x] only CodeableConcept
* valueCodeableConcept from StressCopingVS (required)

ValueSet: StressTriggersVS
Id: stress-triggers-vs
Title: "Stress Triggers Value Set"
* ^experimental = false
Description: "Value set for common stress triggers"
* codes from system StressTriggersCS

ValueSet: StressCopingVS
Id: stress-coping-vs
Title: "Stress Coping Value Set"
* ^experimental = false
Description: "Value set for stress coping mechanisms"
* codes from system StressCopingCS

CodeSystem: StressTriggersCS
Id: stress-triggers-cs
Title: "Stress Triggers Code System"
* ^experimental = false
Description: "Code system for common stress triggers"
* #work "Work-related" "Stress from work or professional activities"
* #financial "Financial" "Financial-related stress"
* #relationships "Relationships" "Stress from personal relationships"
* #health "Health" "Health-related concerns"
* #environment "Environmental" "Environmental factors"
* #time "Time Management" "Time pressure and deadlines"
* #change "Life Changes" "Major life changes or transitions"

CodeSystem: StressCopingCS
Id: stress-coping-cs
Title: "Stress Coping Code System"
* ^experimental = false
Description: "Code system for stress coping mechanisms"
* #exercise "Physical Exercise" "Using exercise to manage stress"
* #meditation "Meditation" "Meditation and mindfulness practices"
* #social "Social Support" "Seeking social support"
* #professional "Professional Help" "Seeking professional assistance"
* #relaxation "Relaxation" "Relaxation techniques"
* #creative "Creative Activities" "Engaging in creative activities"
* #nature "Nature" "Spending time in nature"



// ===== Conteúdo de: EnvironmentalExtensions.fsh =====

Extension: ExposureLocation
Id: exposure-location
Title: "Exposure Location Extension"
Description: "Extension for recording location of environmental exposure measurement"

* ^version = "0.1.0"
* ^status = #draft
* ^context[+].type = #element
* ^context[=].expression = "Observation"

* value[x] only CodeableConcept
* valueCodeableConcept from ExposureLocationVS (required)
* valueCodeableConcept ^short = "Location type of exposure"
* valueCodeableConcept ^definition = "Categorizes the type of location where environmental exposure occurred"

Extension: ExposureConditions
Id: exposure-conditions
Title: "Exposure Conditions Extension"
Description: "Additional conditions during environmental exposure measurement"

* ^version = "0.1.0"
* ^status = #draft
* ^context[+].type = #element
* ^context[=].expression = "Observation"

* value[x] only CodeableConcept
* valueCodeableConcept from ExposureConditionsVS (required)
* valueCodeableConcept ^short = "Conditions during exposure"

ValueSet: ExposureLocationVS
Id: exposure-location-vs
Title: "Exposure Location Value Set"
Description: "Value set for environmental exposure locations"

* ^version = "0.1.0"
* ^status = #draft
* ^experimental = true
* codes from system ExposureLocationCS

ValueSet: ExposureConditionsVS
Id: exposure-conditions-vs
Title: "Exposure Conditions Value Set"
Description: "Value set for environmental exposure conditions"

* ^version = "0.1.0"
* ^status = #draft
* ^experimental = true
* codes from system ExposureConditionsCS

CodeSystem: ExposureLocationCS
Id: exposure-location-cs
Title: "Exposure Location Code System"
Description: "Code system for environmental exposure locations"

* ^version = "0.1.0"
* ^status = #draft
* ^caseSensitive = true
* ^experimental = true

* #indoor "Indoor environment" "Environment within buildings or enclosed spaces"
* #outdoor "Outdoor environment" "Open-air environment"
* #workplace "Workplace" "Professional or occupational environment"
* #transit "In transit" "While in transportation or commuting"
* #recreational "Recreational area" "Leisure or sports facilities"
* #urban "Urban area" "City or densely populated area"
* #rural "Rural area" "Countryside or sparsely populated area"

CodeSystem: ExposureConditionsCS
Id: exposure-conditions-cs
Title: "Exposure Conditions Code System"
Description: "Code system for conditions during environmental exposure"

* ^version = "0.1.0"
* ^status = #draft
* ^caseSensitive = true
* ^experimental = true

* #normal "Normal conditions" "Standard environmental conditions"
* #extreme "Extreme conditions" "Unusual or severe environmental conditions"
* #controlled "Controlled environment" "Environment with controlled conditions"
* #variable "Variable conditions" "Changing environmental conditions"



// ===== Conteúdo de: BodyMetricsExtensions.fsh =====

Alias: $SCT = http://snomed.info/sct

Extension: MeasurementConditions
Id: measurement-conditions
Title: "Measurement Conditions Extension"
* ^experimental = false
Description: "Records the conditions under which body measurements were taken"

* ^version = "0.1.0"
* ^status = #draft
* ^context[0].type = #element
* ^context[0].expression = "Observation"

* value[x] only CodeableConcept
* valueCodeableConcept from MeasurementConditionsVS (required)

Extension: MeasurementDevice
Id: measurement-device-type
Title: "Measurement Device Type Extension"
* ^experimental = false
Description: "Specifies the type of device used for body measurements"

* ^version = "0.1.0"
* ^status = #draft
* ^context[0].type = #element
* ^context[0].expression = "Observation"

* value[x] only CodeableConcept
* valueCodeableConcept from MeasurementDeviceTypeVS (required)

ValueSet: MeasurementConditionsVS
Id: measurement-conditions-vs
Title: "Measurement Conditions Value Set"
* ^experimental = false
Description: "Standard conditions under which measurements are taken"

* ^version = "0.1.0"
* ^status = #draft

* $SCT#307818003 "Pre-breakfast"
* $SCT#307819006 "Post-exercise"
* $SCT#307820000 "Wearing light clothing"
* $SCT#255203001 "First thing in morning"
* $SCT#255214005 "After void"
* $SCT#309604004 "During rest"

ValueSet: MeasurementDeviceTypeVS
Id: measurement-device-type-vs
Title: "Measurement Device Type Value Set"
* ^experimental = false
Description: "Types of devices used for health and body measurements"

* ^version = "0.1.0"
* ^status = #draft

* $SCT#469576000 "Smart watch"
* $SCT#706767009 "Patient data recorder"
* $SCT#131009002 "Height measuring device"
* $SCT#706889009 "Blood pressure monitor"
* $SCT#444699000 "Tape measure"
* $SCT#44056008  "Digital scale"

Instance: WeightWithConditions
InstanceOf: WeightObservation
Usage: #example
Description: "Weight with conditions observation example"
Title: "Weight Measurement with Conditions Example"

* status = #final
* category = http://terminology.hl7.org/CodeSystem/observation-category#vital-signs
* code = $LOINC#29463-7 "Body weight"
* subject = Reference(Patient/example)
* effectiveDateTime = "2024-03-19T08:00:00Z"
* valueQuantity = 70.5 'kg'

* extension[measurement-conditions].url = "https://2rdoc.pt/ig/ios-lifestyle-medicine/StructureDefinition/measurement-conditions"
* extension[measurement-conditions].valueCodeableConcept = $SCT#307818003 "Pre-breakfast"

* extension[measurement-device-type].url = "https://2rdoc.pt/ig/ios-lifestyle-medicine/StructureDefinition/measurement-device-type"
* extension[measurement-device-type].valueCodeableConcept = $SCT#469576000 "Smart scale device"



// ===== Conteúdo de: SleepQuality.fsh =====

Extension: SleepQuality
Id: sleep-quality
Title: "Sleep Quality Extension"
* ^experimental = false
Description: "Extension for recording subjective sleep quality"
* value[x] only CodeableConcept
* valueCodeableConcept from SleepQualityExtendedVS (required)
 
ValueSet: SleepQualityExtendedVS
Id: sleep-quality-extended-vs
Description: "Extended value set for sleep quality assessment"Title: "Sleep Quality Value Set"
* $SCT#248220008 "Very good quality sleep"
* $SCT#248221007 "Good quality sleep"
* $SCT#248222000 "Poor quality sleep"
* $SCT#248223005 "Very poor quality sleep"



// ===== Conteúdo de: MindfulnessExtensions.fsh =====

Extension: MindfulnessContext
Id: mindfulness-context
Title: "Mindfulness Session Context"
Description: "Additional context about the mindfulness practice session"

* ^url = "https://2rdoc.pt/ig/ios-lifestyle-medicine/StructureDefinition/mindfulness-context"
* ^version = "1.0.0"
* ^status = #draft
* ^date = "2024-03-19"
* ^publisher = "Example Organization"

* extension contains
    location 0..1 and
    environment 0..1 and
    guidance 0..1

* extension[location].value[x] only string
* extension[location].valueString 1..1
* extension[location] ^short = "Physical location of practice"
* extension[location] ^definition = "The physical location where the mindfulness practice took place"

* extension[environment].value[x] only CodeableConcept
* extension[environment].valueCodeableConcept from https://2rdoc.pt/fhir/ValueSet/environment-type (required)
* extension[environment] ^short = "Environmental conditions"
* extension[environment] ^definition = "The environmental conditions during the practice session"

* extension[guidance].value[x] only boolean
* extension[guidance].valueBoolean 1..1
* extension[guidance] ^short = "Whether guidance was used"
* extension[guidance] ^definition = "Indicates if the session was guided or self-directed"



// ===== Conteúdo de: SocialInteractionExtensions.fsh =====

Extension: SocialContext
Id: social-context
Title: "Social Context Extension"
* ^experimental = false
Description: "Extension for recording the context of social interaction"
* value[x] only CodeableConcept
* valueCodeableConcept from SocialContextVS (required)

Extension: SocialSupport
Id: social-support
Title: "Social Support Extension"
* ^experimental = false
Description: "Extension for recording perceived social support"
* value[x] only CodeableConcept
* valueCodeableConcept from SocialSupportVS (required)

Extension: SocialActivity
Id: social-activity
Title: "Social Activity Extension"
* ^experimental = false
Description: "Extension for recording specific social activities"
* value[x] only CodeableConcept
* valueCodeableConcept from SocialActivityVS (required)

ValueSet: SocialContextVS
Id: social-context-vs
Title: "Social Context Value Set"
* ^experimental = false
Description: "Value set for social interaction contexts"
* codes from system SocialContextCS

ValueSet: SocialSupportVS
Id: social-support-vs
Title: "Social Support Value Set"
* ^experimental = false
Description: "Value set for levels of social support"
* codes from system SocialSupportCS

ValueSet: SocialActivityVS
Id: social-activity-vs
Title: "Social Activity Value Set"
* ^experimental = false
Description: "Value set for types of social activities"
* codes from system SocialActivityCS

CodeSystem: SocialContextCS
Id: social-context-cs
Title: "Social Context Code System"
* ^experimental = false
Description: "Code system for social interaction contexts"
* #home "Home" "Home environment"
* #work "Work" "Work environment"
* #education "Educational" "Educational setting"
* #community "Community" "Community setting"
* #recreational "Recreational" "Recreational setting"
* #healthcare "Healthcare" "Healthcare setting"

CodeSystem: SocialSupportCS
Id: social-support-cs
Title: "Social Support Code System"
* ^experimental = false
Description: "Code system for levels of social support"
* #strong "Strong Support" "Strong social support network"
* #adequate "Adequate Support" "Sufficient social support"
* #limited "Limited Support" "Limited social support"
* #minimal "Minimal Support" "Minimal social support"
* #none "No Support" "Absence of social support"

CodeSystem: SocialActivityCS
Id: social-activity-cs
Title: "Social Activity Code System"
* ^experimental = false
Description: "Code system for types of social activities"
* #meal "Shared Meal" "Sharing a meal together"
* #exercise "Group Exercise" "Group physical activity"
* #entertainment "Entertainment" "Shared entertainment activity"
* #learning "Learning" "Group learning activity"
* #volunteering "Volunteering" "Community service activity"
* #celebration "Celebration" "Social celebration or event"



// ===== Conteúdo de: SleepExtensions.fsh =====




// ===== Conteúdo de: ComplianceExtensions.fsh =====

// ====== Extensões de Compliance Multi-Jurisdicional ======

Extension: RegulatoryBasis
Id: regulatory-basis
Title: "Regulatory Basis for Consent"
Description: "Identifies the regulatory framework(s) that govern this consent"
* value[x] only CodeableConcept
* valueCodeableConcept from RegulatoryFrameworkVS (extensible)

Extension: JurisdictionApplicability  
Id: jurisdiction-applicability
Title: "Jurisdiction Applicability"
Description: "Specifies which jurisdictions this consent applies to"
* value[x] only CodeableConcept
* valueCodeableConcept from http://hl7.org/fhir/ValueSet/jurisdiction (extensible)

Extension: DataLocalization
Id: data-localization
Title: "Data Localization Requirements"
Description: "Specifies data localization requirements per jurisdiction"
* extension contains
    jurisdiction 1..1 MS and
    storageLocation 1..1 MS and
    residencyRequired 1..1 MS
* extension[jurisdiction].value[x] only CodeableConcept
* extension[storageLocation].value[x] only string
* extension[residencyRequired].value[x] only boolean

// ====== ValueSets de Compliance ======

ValueSet: RegulatoryFrameworkVS
Id: regulatory-framework-vs
Title: "Regulatory Framework Value Set"
Description: "Regulatory frameworks for healthcare data protection"
* ^experimental = false
* include codes from system RegulatoryFrameworkCS

CodeSystem: RegulatoryFrameworkCS
Id: regulatory-framework-cs
Title: "Regulatory Framework Code System"
Description: "Codes for healthcare regulatory frameworks"
* ^experimental = false
* ^caseSensitive = true
* #gdpr "GDPR - General Data Protection Regulation" "European Union data protection regulation"
* #hipaa "HIPAA - Health Insurance Portability and Accountability Act" "United States healthcare privacy law"
* #lgpd "LGPD - Lei Geral de Proteção de Dados" "Brazilian general data protection law"
* #pipeda "PIPEDA - Personal Information Protection and Electronic Documents Act" "Canadian privacy law"
* #ehds "EHDS - European Health Data Space" "European health data framework"



// ===== Conteúdo de: MobilityExtensions.fsh =====

Extension: MobilityAlertLevel
Id: mobility-alert-level
Title: "Mobility Alert Level Extension"
Description: "Extension for mobility measurements alert levels to indicate the severity or concern level of mobility changes detected by the device"
* ^status = #active
* ^context[0].type = #element
* ^context[0].expression = "Observation"
* . ^short = "Mobility alert level indicator"
* . ^definition = "Indicates the severity level of mobility changes or concerns based on device measurements"
* value[x] only CodeableConcept
* valueCodeableConcept from MobilityAlertLevelVS (required)
* valueCodeableConcept ^short = "Alert level code"
* valueCodeableConcept ^definition = "The specific alert level code indicating the severity of mobility changes"

ValueSet: MobilityAlertLevelVS
Id: mobility-alert-level-vs
Title: "Mobility Alert Level Value Set"
Description: "Value set for mobility measurement alert levels used to categorize the severity of mobility changes or concerns"
* ^status = #active
* ^experimental = false
* ^purpose = "To provide standardized alert levels for mobility measurements"
* codes from system MobilityAlertLevelCS

CodeSystem: MobilityAlertLevelCS
Id: mobility-alert-level-cs
Title: "Mobility Alert Level Code System"
Description: "Code system defining alert levels for mobility measurements, indicating the severity of changes in mobility patterns"
* ^status = #active
* ^experimental = false
* ^caseSensitive = true
* ^content = #complete
* #green "Normal - No concern" "Mobility measurements are within normal range and show no concerning patterns"
* #yellow "Caution - Monitor closely" "Mobility measurements show slight deviations that warrant closer monitoring"
* #red "Alert - Significant change" "Mobility measurements indicate significant changes that require immediate attention"
* ^property[0].code = #status
* ^property[0].type = #code
* ^property[0].description = "The status of the alert level"
* ^property[1].code = #severity
* ^property[1].type = #integer
* ^property[1].description = "Numeric value indicating severity (1=low, 3=high)"



// ===== Conteúdo de: ActivityExtensions.fsh =====




// ===== Conteúdo de: MobilityRiskValueSets.fsh =====

ValueSet: FallRiskOutcomesValueSet
Id: fall-risk-outcomes
Title: "Fall Risk Outcomes Value Set"
* ^experimental = false
Description: "Value set for fall risk assessment outcomes"
* ^url = "https://2rdoc.pt/fhir/ValueSet/fall-risk-outcomes"
* ^status = #active
* include codes from system https://2rdoc.pt/fhir/CodeSystem/fall-risk-outcomes

ValueSet: RiskLevelValueSet
Id: risk-level
Title: "Risk Level Value Set"
* ^experimental = false
Description: "Value set for general risk levels"
* ^url = "https://2rdoc.pt/fhir/ValueSet/risk-level"
* ^status = #active
* include codes from system https://2rdoc.pt/fhir/CodeSystem/risk-level

ValueSet: MobilityDeclineOutcomesValueSet
Id: mobility-decline-outcomes
Title: "Mobility Decline Outcomes Value Set"
* ^experimental = false
Description: "Value set for mobility decline assessment outcomes"
* ^url = "https://2rdoc.pt/fhir/ValueSet/mobility-decline-outcomes"
* ^status = #active
* include codes from system https://2rdoc.pt/fhir/CodeSystem/mobility-decline-outcomes

ValueSet: AssistanceLevelOutcomesValueSet
Id: assistance-level-outcomes
Title: "Assistance Level Outcomes Value Set"
* ^experimental = false
Description: "Value set for assistance level assessment outcomes"
* ^url = "https://2rdoc.pt/fhir/ValueSet/assistance-level-outcomes"
* ^status = #active
* include codes from system https://2rdoc.pt/fhir/CodeSystem/assistance-level-outcomes



// ===== Conteúdo de: SymptomValueSets.fsh =====

CodeSystem: SymptomSeverityCS
Id: symptom-severity-cs
Title: "Symptom Severity Code System"
* ^experimental = false
Description: "Severity levels for symptoms"

* #1-3 "Light" "Symptom barely noticeable"
* #4-6 "Mild" "Symptom noticeable but not interfering with daily activities"
* #7-8 "Intense" "Symptom interfering with daily activities"
* #9-10 "Severe" "Symptom preventing daily activities"

ValueSet: BodyLocationsVS
Id: body-locations-vs
Title: "Body Locations Value Set"
* ^experimental = false
Description: "Anatomical locations for symptom recording"
* $SCT#12738006 "Brain"
* $SCT#69536005 "Head"
* $SCT#45048000 "Neck"
* $SCT#51185008 "Chest"
* $SCT#62413002 "Abdomen"
* $SCT#32849002 "Back"
* $SCT#53120007 "Upper limb"
* $SCT#61685007 "Lower limb"

ValueSet: DurationUnitsVS
Id: duration-units-vs
Title: "Duration Units Value Set"
* ^experimental = false
Description: "Time units for symptom duration"
* $UCUM#min "Minutes"
* $UCUM#h "Hours"
* $UCUM#d "Days"
* $UCUM#wk "Weeks"
* $UCUM#mo "Months"

CodeSystem: SymptomFrequencyCS
Id: symptom-frequency-cs
Title: "Symptom Frequency Code System"
* ^experimental = false
Description: "Frequency patterns for symptoms"
* #rare "Rare" "Less than once per month"
* #occasional "Occasional" "Several times per month"
* #frequent "Frequent" "Several times per week"
* #daily "Daily" "Once or more per day"
* #constant "Constant" "Present most of the time"

ValueSet: SymptomFrequencyVS
Id: symptom-frequency-vs
Title: "Symptom Frequency Value Set"
* ^experimental = false
Description: "Frequency patterns for symptoms"
* codes from system SymptomFrequencyCS

CodeSystem: SymptomImpactCS
Id: symptom-impact-cs
Title: "Symptom Impact Code System"
* ^experimental = false
Description: "Impact levels of symptoms on daily activities"
* #none "No impact"
* #mild "Mild impact"
* #moderate "Moderate impact"
* #severe "Severe impact"
* #complete "Complete impact"

ValueSet: SymptomImpactVS
Id: symptom-impact-vs
Title: "Symptom Impact Value Set"
* ^experimental = false
Description: "Impact levels for symptoms"
* codes from system SymptomImpactCS

ValueSet: SymptomProgressionVS
Id: symptom-progression-vs
Title: "Symptom Progression Value Set"
* ^experimental = false
Description: "Progression patterns for symptoms"
* $SCT#385633008 "Improving"
* $SCT#58158008 "Stable"
* $SCT#230993007 "Worsening"
* $SCT#255314001 "Fluctuating"

ValueSet: TimeOfDayVS
Id: time-of-day-vs
Title: "Time of Day Value Set"
* ^experimental = false
Description: "Times of day for symptom occurrence"
* $SCT#73775008 "Morning"
* $SCT#255214003 "After exercise"
* $SCT#2546009 "Evening"
* $SCT#73775008 "Morning"



// ===== Conteúdo de: StressValueSets.fsh =====

ValueSet: StressChronicityVS
Id: stress-chronicity-vs
Title: "Stress Chronicity Value Set"
* ^experimental = false
Description: "Value set for classifying stress chronicity"
* ^url = "https://2rdoc.pt/fhir/ValueSet/stress-chronicity-vs"
* codes from system StressChronicityCS

ValueSet: StressImpactVS
Id: stress-impact-vs
Title: "Stress Impact Value Set"
* ^experimental = false
Description: "Value set for describing stress impact levels"
* ^url = "https://2rdoc.pt/fhir/ValueSet/stress-impact-vs"
* codes from system StressImpactCS

CodeSystem: StressChronicityCS
Id: stress-chronicity-cs
Title: "Stress Chronicity Code System"
* ^experimental = false
Description: "Code system for stress chronicity classification"
* ^url = "https://2rdoc.pt/fhir/CodeSystem/stress-chronicity-cs"
* #acute "Acute" "Short-term stress response"
* #subacute "Subacute" "Medium-term stress response"
* #chronic "Chronic" "Long-term stress response"
* #episodic "Episodic" "Recurring stress episodes"
* #persistent "Persistent" "Continuous stress state"

CodeSystem: StressImpactCS
Id: stress-impact-cs
Title: "Stress Impact Code System"
* ^experimental = false
Description: "Code system for stress impact levels"
* ^url = "https://2rdoc.pt/fhir/CodeSystem/stress-impact-cs"
* #minimal "Minimal Impact" "Little to no interference with daily activities"
* #mild "Mild Impact" "Some interference with daily activities"
* #moderate "Moderate Impact" "Significant interference with daily activities"
* #severe "Severe Impact" "Major interference with daily activities"
* #extreme "Extreme Impact" "Unable to perform daily activities"



// ===== Conteúdo de: ReproductiveValueSets.fsh =====

ValueSet: ReproductiveGoalVS
Id: reproductive-goal-vs
Title: "Reproductive Health Goals Value Set"
Description: "Goals related to reproductive health tracking and planning"

* ^status = #active
* ^experimental = false
* ^date = "2024-03-19"

* $LOINC#8708-0 "Menstrual cycle length"
* $LOINC#55284-4 "Blood pressure"
* $LOINC#8310-5 "Body temperature"
* $LOINC#8302-2 "Body height"
* $LOINC#29463-7 "Body weight"
* $SCT#364311006 "Menstrual cycle monitoring"
* $SCT#289530006 "Reproductive health finding"

ValueSet: ReproductiveActivityVS
Id: reproductive-activity-vs
Title: "Reproductive Health Activities Value Set"
Description: "Activities related to reproductive health monitoring"

* ^status = #active
* ^experimental = false
* ^date = "2024-03-19"

* codes from system ReproductiveActivityCS

CodeSystem: ReproductiveActivityCS
Id: reproductive-activity-cs
Title: "Reproductive Health Activities Code System"
Description: "Code system for reproductive health monitoring activities"

* ^status = #active
* ^experimental = false
* ^caseSensitive = true

* #cycle-tracking "Cycle Tracking" "Track menstrual cycle dates and characteristics"
* #temp-monitoring "Temperature Monitoring" "Monitor basal body temperature"
* #symptom-tracking "Symptom Tracking" "Track reproductive health symptoms"
* #vitals-monitoring "Vitals Monitoring" "Monitor vital signs related to reproductive health"
* #fertility-signs "Fertility Signs" "Monitor fertility signs and indicators"
* #mood-tracking "Mood Tracking" "Track mood changes related to reproductive cycle"
* #medication-log "Medication Log" "Log reproductive health medications"
* #exercise-tracking "Exercise Tracking" "Track physical activity during cycle"



// ===== Conteúdo de: AuditFormatsValueSet.fsh =====

ValueSet: AuditFormatsValueSet
Id: audit-formats
Title: "Audit Formats Value Set"
Description: "Value set for audit format types"
* ^url = "https://2rdoc.pt/fhir/ValueSet/audit-formats"
* ^status = #active
* ^experimental = false
* ^date = "2024-12-27"
* include codes from system https://2rdoc.pt/fhir/CodeSystem/audit-formats

CodeSystem: AuditFormatsCodeSystem
Id: audit-formats
Title: "Audit Formats Code System"
Description: "Code system for audit format types"
* ^url = "https://2rdoc.pt/fhir/CodeSystem/audit-formats"
* ^status = #active
* ^experimental = false
* ^caseSensitive = true
* #text "Text Format"
* #structured "Structured Format"
* #mixed "Mixed Format"



// ===== Conteúdo de: MeasurementContextVS.fsh =====

ValueSet: MeasurementContextVS
Id: measurement-context-vs
Title: "Measurement Context Value Set"
Description: "Contexts in which measurements can be taken, including temporal and location-based contexts"
* ^status = #active
* ^experimental = false
* $SCT#272125009 "Assessment context value (qualifier value)"
* $SCT#307818003 "Before food"
* $SCT#307819006 "After food"
* $SCT#255214003 "After exercise"
* $SCT#264362003 "Time of day"



// ===== Conteúdo de: AuditLevelsValueSet.fsh =====

ValueSet: AuditLevelsValueSet
Id: audit-levels
Title: "Audit Levels Value Set"
Description: "Value set for audit level types"
* ^url = "https://2rdoc.pt/fhir/ValueSet/audit-levels"
* ^status = #active
* ^experimental = false
* ^date = "2024-12-27"
* include codes from system https://2rdoc.pt/fhir/CodeSystem/audit-levels

CodeSystem: AuditLevelsCodeSystem
Id: audit-levels
Title: "Audit Levels Code System"
Description: "Code system for audit level types"
* ^url = "https://2rdoc.pt/fhir/CodeSystem/audit-levels"
* ^status = #active
* ^experimental = false
* ^caseSensitive = true
* #low "Low Level"
* #medium "Medium Level"
* #high "High Level"



// ===== Conteúdo de: SocialInteractionValueSets.fsh =====

ValueSet: SocialInteractionTypeVS
Id: social-interaction-type-vs
Title: "Social Interaction Type Value Set"
* ^experimental = false
Description: "Types of social interactions"
* codes from system SocialInteractionTypeCS

ValueSet: SocialInteractionQualityVS
Id: social-interaction-quality-vs
Title: "Social Interaction Quality Value Set"
* ^experimental = false
Description: "Quality measures for social interactions"
* codes from system SocialInteractionQualityCS

ValueSet: SocialInteractionMediumVS
Id: social-interaction-medium-vs
Title: "Social Interaction Medium Value Set"
* ^experimental = false
Description: "Mediums through which social interaction occurs"
* codes from system SocialInteractionMediumCS

CodeSystem: SocialInteractionTypeCS
Id: social-interaction-type-cs
Title: "Social Interaction Type Code System"
* ^experimental = false
Description: "Types of social interactions"
* #family "Family Interaction" "Interaction with family members"
* #friends "Friend Interaction" "Interaction with friends"
* #professional "Professional Interaction" "Work-related interactions"
* #community "Community Interaction" "Community-based interactions"
* #group "Group Activity" "Organized group activities"
* #casual "Casual Interaction" "Casual social encounters"

CodeSystem: SocialInteractionQualityCS
Id: social-interaction-quality-cs
Title: "Social Interaction Quality Code System"
* ^experimental = false
Description: "Quality measures for social interactions"
* #meaningful "Meaningful" "Deep, meaningful interaction"
* #meaningful "Meaningful" "Deep and significant interaction"
* #supportive "Supportive" "Supportive interaction"
* #meaningful "Meaningful" "Deep and significant interaction"
* #neutral "Neutral" "Neither positive nor negative"
* #meaningful "Meaningful" "Deep and significant interaction"
* #superficial "Superficial" "Surface-level interaction"
* #meaningful "Meaningful" "Deep and significant interaction"
* #stressful "Stressful" "Stressful or difficult interaction"
* #meaningful "Meaningful" "Deep and significant interaction"

CodeSystem: SocialInteractionMediumCS
Id: social-interaction-medium-cs
Title: "Social Interaction Medium Code System"
* ^experimental = false
Description: "Mediums through which social interaction occurs"
* #inPerson "In Person" "Face-to-face interaction"
* #meaningful "Meaningful" "Deep and significant interaction"
* #video "Video Call" "Video-based interaction"
* #meaningful "Meaningful" "Deep and significant interaction"
* #voice "Voice Call" "Voice-only interaction"
* #meaningful "Meaningful" "Deep and significant interaction"
* #text "Text Based" "Text-based communication"
* #meaningful "Meaningful" "Deep and significant interaction"
* #social "Social Media" "Social media interaction"
* #meaningful "Meaningful" "Deep and significant interaction"
* #mixed "Mixed Medium" "Multiple communication methods"
* #meaningful "Meaningful" "Deep and significant interaction"



// ===== Conteúdo de: MoodValueSet.fsh =====

ValueSet: MoodValueSet
Id: mood
Title: "Mood Value Set"
Description: "Value set for mood states"
* ^url = "https://2rdoc.pt/fhir/ValueSet/mood"
* ^status = #active
* ^experimental = false

CodeSystem: MoodCodeSystem
Id: mood
Title: "Mood Code System"
Description: "Code system for mood states"
* ^url = "https://2rdoc.pt/fhir/CodeSystem/mood"
* ^status = #active
* ^caseSensitive = true
* #elevated "Elevated" "Mood is higher than normal"
* #neutral "Neutral" "Neither elevated nor depressed mood"
* #depressed "Depressed" "Mood is lower than normal"
* #anxious "Anxious" "Feeling worried or nervous"
* #irritable "Irritable" "Easily annoyed or angered"
* #calm "Calm" "Feeling peaceful and relaxed"



// ===== Conteúdo de: EnvironmentalContextVS.fsh =====

ValueSet: EnvironmentalContextValueSet
Id: environmental-context
Title: "Environmental Context Value Set"
Description: "Valid contexts for environmental measurements"

* ^status = #active
* ^experimental = false
* ^url = "https://2rdoc.pt/fhir/ValueSet/environmental-context"
* include codes from system https://2rdoc.pt/fhir/CodeSystem/environmental-context



// ===== Conteúdo de: ActivityTypeVS.fsh =====

ValueSet: PhysicalActivityTypeVS
Id: physical-activity-type-vs
Title: "Physical Activity Types Value Set"
* ^experimental = false
Description: "Types of physical activities from iOS Health App"

* ^status = #active

* $SNOMED#255604002 "Physical activity (observable entity)"
* $SNOMED#228557008 "Walking"
* $SNOMED#229058003 "Running"
* $SNOMED#266938001 "Swimming"
* $SNOMED#266940006 "Cycling"
* $SNOMED#32147004 "Regular exercise"



// ===== Conteúdo de: MindfulnessValueSets.fsh =====

ValueSet: EnvironmentTypeValueSet
Id: environment-type
Title: "Environment Type Value Set"
* ^experimental = false
Description: "Value set for environmental context types"
* ^url = "https://2rdoc.pt/fhir/ValueSet/environment-type"
* ^status = #active
* include codes from system https://2rdoc.pt/fhir/CodeSystem/environment-type

ValueSet: MindfulnessTypeValueSet
Id: mindfulness-type
Title: "Mindfulness Type Value Set"
* ^experimental = false
Description: "Value set for types of mindfulness practices"
* ^url = "https://2rdoc.pt/fhir/ValueSet/mindfulness-type"
* ^status = #active
* include codes from system https://2rdoc.pt/fhir/CodeSystem/mindfulness-type



// ===== Conteúdo de: BalanceStatusValueSet.fsh =====

ValueSet: BalanceStatusValueSet
Id: balance-status
Title: "Balance Status Value Set"
Description: "Value set for walking steadiness balance status"
* ^url = "https://2rdoc.pt/fhir/ValueSet/balance-status"
* ^status = #active
* include codes from system https://2rdoc.pt/fhir/CodeSystem/balance-status

CodeSystem: BalanceStatusCodeSystem
Id: balance-status
Title: "Balance Status Code System"
Description: "Code system for balance status types"
* ^url = "https://2rdoc.pt/fhir/CodeSystem/balance-status"
* ^status = #active
* ^experimental = false
* ^caseSensitive = true
* #veryStable "Very Stable"
* #stable "Stable"
* #slightlyUnstable "Slightly Unstable"
* #unstable "Unstable"
* #veryUnstable "Very Unstable"



// ===== Conteúdo de: SleepQualityVS.fsh =====

ValueSet: SleepQualityVS
Id: sleep-quality-vs
Title: "Sleep Quality Value Set"
Description: "Qualitative assessments of sleep quality including subjective measures"
* ^status = #active
* ^experimental = false
* $SCT#248254009 "Quality of sleep (observable entity)"
* $SCT#248255005 "Sleeping well"
* $SCT#248256006 "Difficulty sleeping"
* $SCT#301345002 "Poor sleep pattern"
* $SCT#301346001 "Good sleep pattern"




// ===== Conteúdo de: FertilityValueSets.fsh =====

ValueSet: CervicalMucusValueSet
Id: cervical-mucus-valueset
Title: "Cervical Mucus Value Set"
* ^experimental = false
Description: "Value set for cervical mucus observations"
* ^url = "https://2rdoc.pt/fhir/ValueSet/cervical-mucus-vs"
* ^status = #active
* include codes from system https://2rdoc.pt/fhir/CodeSystem/cervical-mucus-cs

CodeSystem: CervicalMucusCodeSystem
Id: cervical-mucus-cs
Description: "Code system for cervical mucus classification"Title: "Cervical Mucus Code System"
* ^url = "https://2rdoc.pt/fhir/CodeSystem/cervical-mucus-cs"
* ^status = #active
* ^caseSensitive = true
* #dry "Dry"
* #sticky "Sticky"
* #creamy "Creamy"
* #watery "Watery"
* #eggWhite "Egg White"

ValueSet: OvulationTestValueSet
Id: ovulation-test-valueset
Title: "Ovulation Test Value Set"
* ^experimental = false
Description: "Value set for ovulation test results"
* ^url = "https://2rdoc.pt/fhir/ValueSet/ovulation-test-vs"
* ^status = #active
* include codes from system https://2rdoc.pt/fhir/CodeSystem/ovulation-test-cs

CodeSystem: OvulationTestCodeSystem
Id: ovulation-test-cs
Description: "Code system for ovulation test results"Title: "Ovulation Test Code System"
* ^url = "https://2rdoc.pt/fhir/CodeSystem/ovulation-test-cs"
* ^status = #active
* ^caseSensitive = true
* #negative "Negative"
* #positive "Positive"
* #invalid "Invalid Test"

ValueSet: FertilityStatusValueSet
Id: fertility-status-valueset
Title: "Fertility Status Value Set"
* ^experimental = false
Description: "Value set for fertility status"
* ^url = "https://2rdoc.pt/fhir/ValueSet/fertility-status-vs"
* ^status = #active
* include codes from system https://2rdoc.pt/fhir/CodeSystem/fertility-status-cs

CodeSystem: FertilityStatusCodeSystem
Id: fertility-status-cs
Description: "Code system for fertility status indicators"Title: "Fertility Status Code System"
* ^url = "https://2rdoc.pt/fhir/CodeSystem/fertility-status-cs"
* ^status = #active
* ^caseSensitive = true
* #fertile "Fertile"
* #notFertile "Not Fertile"
* #uncertain "Uncertain"



// ===== Conteúdo de: MindfulnessSearchParameters.fsh =====

Instance: MindfulnessType
InstanceOf: SearchParameter
Description: "Example instance of MindfulnessType"Usage: #definition
* status = #active
* code = #mindfulness-type
* name = "MindfulnessType"
* description = "Search for mindfulness observations by practice type"
* base = #Observation
* type = #token
* expression = "Observation.component.where(code.coding.exists(system = 'http://snomed.info/sct' and code = '711415009')).value.as(CodeableConcept)"
* xpath = "f:Observation/f:component[f:code/f:coding[f:system/@value='http://snomed.info/sct' and f:code/f:coding/f:code/@value='711415009']]/f:valueCodeableConcept"
* xpathUsage = #normal



// ===== Conteúdo de: MindfulnessAlerts.fsh =====

Extension: AlertTiming
Id: alert-timing
Title: "Alert Timing Extension"
Description: "Defines when alerts should be triggered"
* value[x] only Timing
* valueTiming.repeat 1..1 MS
* valueTiming.repeat.frequency MS
* valueTiming.repeat.period MS
* valueTiming.repeat.periodUnit MS

Extension: AlertMessage
Id: alert-message
Title: "Alert Message Extension"
Description: "Defines the alert message content"
* value[x] only string

Profile: MindfulnessAlert
Parent: Basic
Id: mindfulness-alert
Title: "Mindfulness Alert"
Description: "Alert configuration for mindfulness sessions"

* code 1..1 MS
* code = https://2rdoc.pt/fhir/CodeSystem/mindfulness-alert-type#reminder "Mindfulness Reminder"

* extension contains
    alert-timing named alertTiming 0..1 MS and
    alert-message named alertMessage 1..1 MS

Instance: DailyMindfulnessAlert
InstanceOf: MindfulnessAlert
Title: "Daily Mindfulness Alert" 
Description: "Example of a daily mindfulness alert configuration"

* code = https://2rdoc.pt/fhir/CodeSystem/mindfulness-alert-type#reminder "Mindfulness Reminder"
* extension[alertTiming].valueTiming.repeat
  * frequency = 1
  * period = 1
  * periodUnit = #d
* extension[alertMessage].valueString = "Time for your daily mindfulness practice"



// ===== Conteúdo de: MindfulnessTransforms.fsh =====

Instance: MindfulnessHealthKitTransform
InstanceOf: StructureMap
Usage: #definition
Title: "HealthKit to FHIR Mindfulness Transform"

* status = #draft
* name = "MindfulnessHealthKitTransform"
* structure[0]
  * url = "https://2rdoc.pt/ig/ios-lifestyle-medicine/StructureDefinition/healthkit-mindfulness"
  * mode = #source
  * documentation = "HealthKit mindfulness session structure"

* structure[1]
  * url = "http://hl7.org/fhir/StructureDefinition/Observation"
  * mode = #target
  * documentation = "FHIR Observation resource"

* group[0]
  * name = "MindfulnessSessionToObservation"
  * typeMode = #none
  * input[0]
    * name = "source"
    * type = "HealthKitMindfulness"
    * mode = #source
  * input[1]
    * name = "target"
    * type = "Observation"
    * mode = #target
  * rule[0]
    * name = "Session"
    * source[0]
      * context = "source"
      * element = "startDate"
    * target[0]
      * context = "target"
      * element = "effectiveDateTime"
  * rule[1]
    * name = "Duration"
    * source[0]
      * context = "source"
      * element = "duration"
    * target[0]
      * context = "target"
      * element = "component.where(code.coding.code='118682006').valueQuantity"

Instance: MindfulnessCSVTransform
InstanceOf: StructureMap
Usage: #definition
Title: "CSV to FHIR Mindfulness Transform"

* status = #draft
* name = "MindfulnessCSVTransform"
* structure[0]
  * url = "https://2rdoc.pt/ig/ios-lifestyle-medicine/StructureDefinition/csv-mindfulness"
  * mode = #source
  * documentation = "CSV mindfulness data structure"

* group[0]
  * name = "CSVToMindfulnessObservation"
  * typeMode = #none
  * input[0]
    * name = "source"
    * type = "CSVMindfulness"
    * mode = #source
  * input[1]
    * name = "target"
    * type = "Observation"
    * mode = #target
  * rule[0]
    * name = "MapDatetime"
    * source[0]
      * context = "source"
      * element = "date,time"
    * target[0]
      * context = "target"
      * element = "effectiveDateTime"
      * transform = #append

RuleSet: TransformValidationRules
* rule[+]
  * name = "ValidateStatus"
  * source[0]
    * context = "target"
    * element = "status"
  * assert[0]
    * description = "Status must be final"
    * expression = "%status = 'final'"

* rule[+]
  * name = "ValidateCode"
  * source[0]
    * context = "target"
    * element = "code"
  * assert[0]
    * description = "Must use SNOMED CT code"
    * expression = "%code.system = 'http://snomed.info/sct'"



// ===== Conteúdo de: MindfulnessAudit.fsh =====

Extension: AuditLevelExtension
Id: audit-level
Title: "Audit Level Extension"
Description: "Level of detail for audit records"
* value[x] only code
* valueCode from https://2rdoc.pt/fhir/ValueSet/audit-levels (required)

Extension: AuditRetentionExtension
Id: audit-retention
Title: "Audit Retention Extension" 
Description: "Period to retain audit records"
* value[x] only Duration

Extension: AuditFormatExtension
Id: audit-format
Title: "Audit Format Extension"
Description: "Format for audit records"
* value[x] only code
* valueCode from https://2rdoc.pt/fhir/ValueSet/audit-formats (required)

Profile: MindfulnessAudit
Parent: Basic
Id: mindfulness-audit
Title: "Mindfulness Audit"
Description: "Audit record for mindfulness sessions"

* code 1..1 MS
* code = https://2rdoc.pt/fhir/CodeSystem/mindfulness-audit-type#session "Session Audit"
* created 1..1 MS

* extension contains
    audit-level named auditLevel 1..1 MS and
    audit-retention named auditRetention 1..1 MS and
    audit-format named auditFormat 1..1 MS

Instance: MindfulnessAuditExample
InstanceOf: MindfulnessAudit
Title: "Example Mindfulness Audit"
Description: "Example of a mindfulness session audit record"

* code = https://2rdoc.pt/fhir/CodeSystem/mindfulness-audit-type#session "Session Audit"
* created = "2024-03-15"
* extension[auditLevel].valueCode = #detailed
* extension[auditRetention].valueDuration = 90 'days'
* extension[auditFormat].valueCode = #fhir



// ===== Conteúdo de: EnvironmentalExamples.fsh =====

Instance: NoiseExposureExample
InstanceOf: NoiseExposureObservation
Usage: #example
Description: "Noise exposure observation example"
Title: "Noise Exposure Measurement Example"

* meta.security = http://terminology.hl7.org/CodeSystem/v3-Confidentiality#N
* status = #final
* performer = Reference(Practitioner/PractitionerExample)
* category = http://terminology.hl7.org/CodeSystem/observation-category#environment
* code = $LOINC#28573-7 "Noise exposure time"
* subject = Reference(Patient/PatientExample)
* effectiveDateTime = "2024-03-19T15:30:00Z"
* device = Reference(Device/iphone-example)
* method = http://snomed.info/sct#37016008 "Automatic measurement"

* component[level]
  * code.coding[0] = $LOINC#89020-2 "Environmental noise average"
  * valueQuantity = 85 'dB'
  * interpretation = http://terminology.hl7.org/CodeSystem/v3-ObservationInterpretation#H "High"

* component[duration]
  * code.coding[0] = $LOINC#89021-0 "Environmental noise duration"
  * valueQuantity = 120 'min'

* component[peakLevel]
  * code.coding[0] = $LOINC#89024-4 "Peak sound level"
  * valueQuantity = 95 'dB'

* component[backgroundNoise]
  * code.coding[0] = $LOINC#89025-1 "Background noise level"
  * valueQuantity = 45 'dB'

* note.text = "Measurement taken during urban commute"

Instance: UVExposureExample
InstanceOf: UVExposureObservation
Usage: #example
Description: "UV exposure observation example"
Title: "UV Exposure Measurement Example"

* meta.security = http://terminology.hl7.org/CodeSystem/v3-Confidentiality#N
* status = #final
* category = http://terminology.hl7.org/CodeSystem/observation-category#environment
* code = $LOINC#28574-5 "UV exposure"
* subject = Reference(Patient/PatientExample)
* effectiveDateTime = "2024-03-19T12:00:00Z"
* device = Reference(Device/iphone-example)
* method = http://snomed.info/sct#37016008 "Automatic measurement"

* component[index]
  * code.coding[0] = $LOINC#89022-8 "UV index"
  * valueQuantity = 8 '{index}'
  * interpretation = http://terminology.hl7.org/CodeSystem/v3-ObservationInterpretation#H "High"

* component[duration]
  * code.coding[0] = $LOINC#89023-6 "UV exposure duration"
  * valueQuantity = 45 'min'

* component[timeOfDay]
  * code.coding[0] = $LOINC#89026-9 "Time of exposure"
  * valueDateTime = "2024-03-19T12:00:00Z"

* component[intensity]
  * code.coding[0] = $LOINC#89027-7 "UV intensity"
  * valueQuantity = 0.3 'W/m2'

* note.text = "Measurement taken during outdoor activity"

Instance: EnvironmentalDeviceExample
InstanceOf: Device
Usage: #example
Description: "Environmental monitoring device example"
Title: "Environmental Monitoring Device"

* identifier.system = "https://2rdoc.pt/ig/ios-lifestyle-medicine/devices"
* identifier.value = "iPhone-ENV-001"
* manufacturer = "Apple Inc."
* modelNumber = "iPhone 15 Pro"
* type = $SCT#706689003 "Environmental monitoring device"
* status = #active



// ===== Conteúdo de: NutritionExamples.fsh =====

Instance: NutritionQuestionnaireResponseExample
InstanceOf: QuestionnaireResponse
Usage: #example
Description: "Nutrition questionnaire response example"
Title: "Daily Nutrition Questionnaire Response Example"

* questionnaire = "https://2rdoc.pt/fhir/Questionnaire/daily-nutrition"
* status = #completed
* subject = Reference(Patient/PatientExample)
* authored = "2024-12-14T20:00:00Z"

* item[0]
  * linkId = "water_intake"
  * answer.valueQuantity = 2000 'mL'

* item[1]
  * linkId = "meal_record"

  * item[0]
    * linkId = "meal_time"
    * answer.valueDateTime = "2024-12-14T12:00:00Z"

  * item[1]
    * linkId = "meal_type"
    * answer.valueString = "Lunch"

  * item[2]
    * linkId = "calories"
    * answer.valueInteger = 650

  * item[3]
    * linkId = "macronutrients"
   
    * item[0]
      * linkId = "carbs"
      * answer.valueDecimal = 75
   
    * item[1]
      * linkId = "protein"
      * answer.valueDecimal = 30
   
    * item[2]
      * linkId = "fat"
      * answer.valueDecimal = 25

* item[2]
  * linkId = "caffeine"

  * item[0]
    * linkId = "caffeine_amount"
    * answer.valueInteger = 80

  * item[1]
    * linkId = "caffeine_source"
    * answer.valueString = "Coffee"



// ===== Conteúdo de: SleepExamples.fsh =====

Instance: SleepObservationExample1
InstanceOf: SleepObservation
Usage: #example
Description: "Sleep observation example"
Title: "Example of Sleep Record"
 
* status = #final
* category = http://terminology.hl7.org/CodeSystem/observation-category#sleep
* code = $LOINC#93832-4 "Sleep pattern panel"
* subject = Reference(PatientExample)
* effectivePeriod.start = "2024-03-19T22:00:00Z"
* effectivePeriod.end = "2024-03-20T06:30:00Z"
* device = Reference(DeviceSleepMonitor)
 
* component[timeInBed].code = $LOINC#93831-6 "Time in bed"
* component[timeInBed].valueQuantity = 510 'min' "minute"
* component[timeInBed].valueQuantity.system = $UCUM
* component[timeInBed].valueQuantity.unit = "minute"
 
* component[totalSleepTime].code = $LOINC#93833-2 "Sleep duration"
* component[totalSleepTime].valueQuantity = 472 'min' "minute"
* component[totalSleepTime].valueQuantity.system = $UCUM
* component[totalSleepTime].valueQuantity.unit = "minute"
 
* component[deepSleep].code = $LOINC#93834-0 "Deep sleep duration"
* component[deepSleep].valueQuantity = 95 'min' "minute"
* component[deepSleep].valueQuantity.system = $UCUM
* component[deepSleep].valueQuantity.unit = "minute"
 
* component[remSleep].code = $LOINC#93835-7 "REM sleep duration"
* component[remSleep].valueQuantity = 118 'min' "minute"
* component[remSleep].valueQuantity.system = $UCUM
* component[remSleep].valueQuantity.unit = "minute"
 
* component[lightSleep].code = $LOINC#93836-5 "Light sleep duration"
* component[lightSleep].valueQuantity = 259 'min' "minute"
* component[lightSleep].valueQuantity.system = $UCUM
* component[lightSleep].valueQuantity.unit = "minute"
 
* component[respiratoryRate].code = $LOINC#9279-1 "Respiratory rate"
* component[respiratoryRate].valueQuantity = 14 '/min' "per minute"
* component[respiratoryRate].valueQuantity.system = $UCUM
* component[respiratoryRate].valueQuantity.unit = "per minute"
 
* component[heartRateVariability].code = $LOINC#80404-7 "R-R interval.standard deviation (Heart rate variability)"
* component[heartRateVariability].valueQuantity = 45 'ms' "millisecond"
* component[heartRateVariability].valueQuantity.system = $UCUM
* component[heartRateVariability].valueQuantity.unit = "millisecond"
 
* component[interruptions].code = $LOINC#93837-3 "Number of awakenings during sleep"
* component[interruptions].valueQuantity = 3 '{count}' "count"
* component[interruptions].valueQuantity.system = $UCUM
* component[interruptions].valueQuantity.unit = "count"

Instance: DeviceSleepMonitor
InstanceOf: Device
Usage: #example
Description: "Sleep monitor device example"
Title: "Sleep Monitoring Device"
* deviceName.name = "Sleep Quality Monitor"
* deviceName.type = #user-friendly-name
* manufacturer = "HealthTech Devices"
* modelNumber = "SQM-2024"
* type = $SCT#706172001 "Sleep monitor"



// ===== Conteúdo de: StressExamples.fsh =====

Instance: StressLevelExample
InstanceOf: StressLevelProfile
Usage: #example
Description: "Stress level observation example"
Title: "Stress Level Measurement Example"

* status = #final
* category = http://terminology.hl7.org/CodeSystem/observation-category#vital-signs
* code = $LOINC#89592-0 "Stress level score"
* subject = Reference(Patient/PatientExample)
* effectiveDateTime = "2024-01-03T15:30:00Z"
* valueQuantity = 7 '{score}' "score"

* component[physiologicalStress].valueQuantity = 6 '{score}' "score"
* component[psychologicalStress].valueQuantity = 8 '{score}' "score"
* component[chronicity].valueCodeableConcept = StressChronicityCS#subacute
* component[impact].valueCodeableConcept = StressImpactCS#moderate

* extension[triggers].valueCodeableConcept = StressTriggersCS#work
* extension[coping].valueCodeableConcept = StressCopingCS#meditation



// ===== Conteúdo de: PatientExample.fsh =====

Instance: PatientExample
InstanceOf: Patient
Usage: #example
Description: "Patient resource example"
* identifier[0].system = "urn:oid:2.16.858.1.1.1"
* identifier[0].value = "12345"
* name.given = "John"
* name.family = "Doe"
* gender = #male
* birthDate = "1970-01-01"



// ===== Conteúdo de: MobilityExamples.fsh =====

Profile: WalkingSteadinessObservation
Parent: MobilityProfile
Id: walking-steadiness-observation
Description: "Profile for assessing walking steadiness and balance"Title: "Walking Steadiness Observation Profile"

* code = $LOINC#LA32-8 "Balance"
* component contains
    balanceScore 0..1 MS and
    balanceStatus 0..1 MS

* component[balanceScore]
  * code = $LOINC#LA32-8 "Balance score"
  * valueQuantity.system = $UCUM
  * valueQuantity.code = #%

* component[balanceStatus]
  * code = $LOINC#LA32-9 "Balance status"
  * valueCodeableConcept from https://2rdoc.pt/fhir/ValueSet/balance-status (required)

Profile: WalkingSpeedObservation
Parent: MobilityProfile
Id: walking-speed-observation
Description: "Profile for measuring walking speed as part of mobility assessment"Title: "Walking Speed Observation Profile"

* code = $LOINC#LA29042-4 "Walking speed"
* component contains
    speed 0..1 MS and
    distance 0..1 MS

* component[speed]
  * code = $LOINC#LA29042-4 "Walking speed measurement"
  * valueQuantity.system = $UCUM
  * valueQuantity.code = #m/s

* component[distance]
  * code = $LOINC#LA29043-2 "Walking distance"
  * valueQuantity.system = $UCUM
  * valueQuantity.code = #m

Instance: WalkingSteadinessExample
InstanceOf: WalkingSteadinessObservation
Usage: #example
Description: "Walking steadiness observation example"
Title: "Walking Steadiness Measurement Example"

* status = #final
* category = http://terminology.hl7.org/CodeSystem/observation-category#activity
* code = $LOINC#LA32-8 "Balance"
* subject = Reference(Patient/PatientExample)
* effectiveDateTime = "2024-03-19T15:30:00Z"
* valueQuantity = 85 '1' "score"
* device = Reference(Device/iphone-example)

* component[balanceScore].valueQuantity = 85 '%' "percent"
* component[balanceStatus].valueCodeableConcept = $LOINC#LA32-10 "OK"

Instance: WalkingSpeedExample
InstanceOf: WalkingSpeedObservation
Usage: #example
Description: "Walking speed observation example"
Title: "Walking Speed Measurement Example"

* status = #final
* category = http://terminology.hl7.org/CodeSystem/observation-category#activity
* code = $LOINC#LA29042-4 "Walking speed"
* subject = Reference(Patient/PatientExample)
* effectiveDateTime = "2024-03-19T15:30:00Z"
* valueQuantity = 1.2 'm/s' "meters per second"
* device = Reference(Device/iphone-example)

* component[speed].valueQuantity = 1.2 'm/s' "meters per second"
* component[distance].valueQuantity = 10 'm' "meters"



// ===== Conteúdo de: PhysicalActivityExamples.fsh =====

Instance: PhysicalActivityExample1
InstanceOf: PhysicalActivityObservation
Usage: #example
Description: "Physical activity observation example"
Title: "Example of Walking Activity"
* status = #final
* category = http://terminology.hl7.org/CodeSystem/observation-category#activity
* code = $SNOMED#228557008 "Walking"
* subject = Reference(PatientExample)
* effectiveDateTime = "2024-03-19T15:30:00Z"
* device = Reference(DeviceActivityTracker)
* component[steps].code = $LOINC#55423-8 "Number of steps in 24 hour Measured"
* component[steps].valueQuantity = 8546 '1' "count"
* component[steps].valueQuantity.system = $UCUM
* component[steps].valueQuantity.unit = "count"
* component[distance].code = $LOINC#55430-3 "Distance walked"
* component[distance].valueQuantity = 6.2 'km' "kilometer"
* component[distance].valueQuantity.system = $UCUM
* component[distance].valueQuantity.unit = "kilometer"
* component[duration].code = $LOINC#55411-3 "Exercise duration"
* component[duration].valueQuantity = 72 'min' "minute"
* component[duration].valueQuantity.system = $UCUM
* component[duration].valueQuantity.unit = "minute"
* component[energy].code = $LOINC#55424-6 "Energy expenditure"
* component[energy].valueQuantity = 320 'kcal' "kilocalorie"
* component[energy].valueQuantity.system = $UCUM
* component[energy].valueQuantity.unit = "kilocalorie"

Instance: DeviceActivityTracker
InstanceOf: Device
Usage: #example
Description: "Activity tracker device example"
Title: "Activity Tracking Device"
* deviceName.name = "Health Activity Tracker"
* deviceName.type = #user-friendly-name
* manufacturer = "HealthTech Devices"
* modelNumber = "HAT-2024"
* type = $SCT#258158006 "Breathing rate"



// ===== Conteúdo de: BodyMetricsExamples.fsh =====

Instance: WeightExample
InstanceOf: WeightObservation
Usage: #example
Description: "Weight observation example"
Title: "Weight Measurement Example"
* status = #final
* category = http://terminology.hl7.org/CodeSystem/observation-category#vital-signs
* code = $LOINC#29463-7 "Body weight"
* subject = Reference(PatientExample)
* performer = Reference(PractitionerExample)
* effectiveDateTime = "2024-03-19T08:00:00Z"
* valueQuantity = 70.5 'kg' "kilogram"
* valueQuantity.system = $UCUM
* valueQuantity.unit = "kilogram"
* device = Reference(SmartScale)

Instance: HeightExample
InstanceOf: HeightObservation
Usage: #example
Description: "Height observation example"
Title: "Height Measurement Example"
* status = #final
* category = http://terminology.hl7.org/CodeSystem/observation-category#vital-signs
* code = $LOINC#8302-2 "Body height"
* subject = Reference(PatientExample)
* performer = Reference(PractitionerExample)
* effectiveDateTime = "2024-03-19T08:00:00Z"
* valueQuantity = 175 'cm' "centimeter"
* valueQuantity.system = $UCUM
* valueQuantity.unit = "centimeter"

Instance: BMIExample
InstanceOf: BMIObservation
Usage: #example
Description: "Body Mass Index observation example"
Title: "BMI Calculation Example"
* status = #final
* category = http://terminology.hl7.org/CodeSystem/observation-category#vital-signs
* code = $LOINC#39156-5 "Body mass index (BMI)"
* subject = Reference(PatientExample)
* performer = Reference(PractitionerExample)
* effectiveDateTime = "2024-03-19T08:00:00Z"
* valueQuantity = 23.0 'kg/m2' "kilogram per square meter"
* valueQuantity.system = $UCUM
* valueQuantity.unit = "kilogram per square meter"
* derivedFrom[0] = Reference(Observation/WeightExample)
* derivedFrom[1] = Reference(Observation/HeightExample)

Instance: BodyCompositionExample
InstanceOf: BodyCompositionObservation
Usage: #example
Description: "Body composition observation example"
Title: "Body Composition Measurement Example" 
* status = #final
* category = http://terminology.hl7.org/CodeSystem/observation-category#vital-signs
* code = $LOINC#88365-2 "Body composition panel"
* subject = Reference(PatientExample)
* performer = Reference(PractitionerExample)
* effectiveDateTime = "2024-03-19T08:00:00Z"
* device = Reference(BioimpedanceAnalyzer)

* component[bodyFat].code = $LOINC#41982-0 "Percentage body fat"
* component[bodyFat].valueQuantity = 22.5 '%' "percent"
* component[bodyFat].valueQuantity.system = $UCUM
* component[bodyFat].valueQuantity.unit = "percent"

* component[leanMass].code = $LOINC#291-7 "Lean body mass"
* component[leanMass].valueQuantity = 54.6 'kg' "kilogram"
* component[leanMass].valueQuantity.system = $UCUM
* component[leanMass].valueQuantity.unit = "kilogram"

* component[bodyWater].code = $LOINC#73708-0 "Total body water"
* component[bodyWater].valueQuantity = 39.2 'L' "liter"
* component[bodyWater].valueQuantity.system = $UCUM
* component[bodyWater].valueQuantity.unit = "liter"

* component[muscleMass].code = $LOINC#73713-0 "Muscle mass"
* component[muscleMass].valueQuantity = 51.8 'kg' "kilogram"
* component[muscleMass].valueQuantity.system = $UCUM
* component[muscleMass].valueQuantity.unit = "kilogram"

* component[boneMass].code = $LOINC#73711-4 "Bone mass"
* component[boneMass].valueQuantity = 2.8 'kg' "kilogram"
* component[boneMass].valueQuantity.system = $UCUM
* component[boneMass].valueQuantity.unit = "kilogram"

Instance: SmartScale
InstanceOf: Device
Usage: #example
Description: "Smart scale device example"
Title: "Smart Scale Device"
* deviceName.name = "Smart Body Analyzer"
* deviceName.type = #user-friendly-name
* manufacturer = "HealthTech Devices"
* modelNumber = "SBA-2024"
* type = $SCT#469576000 "Digital scale device"

Instance: BioimpedanceAnalyzer  
InstanceOf: Device
Usage: #example
Description: "Bioimpedance analyzer device example"
Title: "Bioimpedance Analyzer Device"
* deviceName.name = "Professional Body Composition Analyzer"
* deviceName.type = #user-friendly-name
* manufacturer = "MedTech Solutions"
* modelNumber = "BCA-Pro"
* type = $SCT#706767009 "Patient data recorder"



// ===== Conteúdo de: SymptomExamples.fsh =====

Instance: ChronicSymptomExample
InstanceOf: Observation
Usage: #example
Description: "Chronic symptom observation example"
* status = #final
* category = http://terminology.hl7.org/CodeSystem/observation-category#survey
* code = $SCT#267036007 "Fatigue"
* subject = Reference(Patient/PatientExample)
* performer = Reference(Practitioner/PractitionerExample)
* effectiveDateTime = "2024-03-19T14:00:00Z"
// ... resto do exemplo ...

Instance: ExampleSymptomSeverity
InstanceOf: Observation
Usage: #example
Description: "Symptom severity observation example"
* status = #final
* category = http://terminology.hl7.org/CodeSystem/observation-category#survey
* code = $SCT#246604007 "Symptom severity"
* subject = Reference(Patient/PatientExample)
* performer = Reference(Practitioner/PractitionerExample)
* effectiveDateTime = "2024-03-19T10:30:00Z"
// ... resto do exemplo ...



// ===== Conteúdo de: SocialInteractionExamples.fsh =====

Instance: SocialInteractionExample
InstanceOf: SocialInteractionProfile
Usage: #example
Description: "Social interaction observation example"
Title: "Social Interaction Example"

* status = #final
* category = http://terminology.hl7.org/CodeSystem/observation-category#social-history
* code = $LOINC#96766-1 "Social interaction pattern"
* subject = Reference(Patient/PatientExample)
* effectiveDateTime = "2024-01-03T14:00:00Z"
* valueCodeableConcept = SocialInteractionTypeCS#family

* component[duration].valueQuantity = 120 'min' "minutes"
* component[quality].valueCodeableConcept = SocialInteractionQualityCS#meaningful
* component[medium].valueCodeableConcept = SocialInteractionMediumCS#inPerson
* component[participants].valueInteger = 4

* extension[context].valueCodeableConcept = SocialContextCS#home
* extension[support].valueCodeableConcept = SocialSupportCS#strong
* extension[activity].valueCodeableConcept = SocialActivityCS#meal



// ===== Conteúdo de: VitalSignsExamples.fsh =====

Instance: HeartRateExample
InstanceOf: HeartRateObservation
Usage: #example
Description: "Heart rate observation example"
Title: "Heart Rate Measurement Example"
* status = #final
* code = $LOINC#8867-4 "Heart rate"
* subject = Reference(PatientExample)
* effectiveDateTime = "2024-03-19T15:30:00Z"
* valueQuantity = 72 '/min' "per minute"
* valueQuantity.system = $UCUM
* valueQuantity.unit = "per minute"
* device = Reference(DeviceHeartRateMonitor)
* performer = Reference(PractitionerExample)
* component[heartRateVariability].code = $LOINC#80404-7 "R-R interval.standard deviation (Heart rate variability)"
* component[heartRateVariability].valueQuantity = 45 'ms' "millisecond"
* component[heartRateVariability].valueQuantity.system = $UCUM
* component[heartRateVariability].valueQuantity.unit = "millisecond"

Instance: BloodPressureExample
InstanceOf: BloodPressureObservation
Usage: #example
Description: "Blood pressure observation example"
Title: "Blood Pressure Measurement Example"
* status = #final
* code = $LOINC#85354-9 "Blood pressure panel with all children optional"
* subject = Reference(PatientExample)
* effectiveDateTime = "2024-03-19T15:30:00Z"
* device = Reference(DeviceBloodPressureMonitor)
* performer = Reference(PractitionerExample)
* component[systolic].code = $LOINC#8480-6 "Systolic blood pressure"
* component[systolic].valueQuantity = 120 'mm[Hg]' "millimeter of mercury"
* component[systolic].valueQuantity.system = $UCUM
* component[systolic].valueQuantity.unit = "millimeter of mercury"
* component[diastolic].code = $LOINC#8462-4 "Diastolic blood pressure"
* component[diastolic].valueQuantity = 80 'mm[Hg]' "millimeter of mercury"
* component[diastolic].valueQuantity.system = $UCUM
* component[diastolic].valueQuantity.unit = "millimeter of mercury"

Instance: DeviceHeartRateMonitor
InstanceOf: Device
Usage: #example
Description: "Heart rate monitor device example"
Title: "Heart Rate Monitor Device"
* deviceName.name = "Continuous Heart Rate Monitor"
* deviceName.type = #user-friendly-name
* manufacturer = "HealthTech Devices"
* modelNumber = "HRM-2024"
* type = $SCT#720737000 "Pulse rate monitoring device"

Instance: DeviceBloodPressureMonitor
InstanceOf: Device
Usage: #example
Description: "Blood pressure monitor device example"
Title: "Blood Pressure Monitor Device"
* deviceName.name = "Digital Blood Pressure Monitor"
* deviceName.type = #user-friendly-name
* manufacturer = "HealthTech Devices"
* modelNumber = "BPM-2024"
* type = $SCT#43770009 "Blood pressure monitor"



// ===== Conteúdo de: PractitionerExample.fsh =====

Instance: PractitionerExample
InstanceOf: Practitioner
Usage: #example
Description: "Practitioner resource example"
* identifier[0].system = "http://terminology.hl7.org/CodeSystem/practitioner-identifier"
* identifier[0].value = "9941339108"
* name.given = "Jane"
* name.family = "Smith"



// ===== Conteúdo de: MindfulnessCompleteExamples.fsh =====

Instance: CompleteMindfulnessSession
InstanceOf: MindfulnessObservation
Usage: #example
Description: "Complete mindfulness session observation example"
Title: "Complete Mindfulness Session Example"

* status = #final
* code = $SCT#711415009 "Mindfulness"
* subject = Reference(Patient/PatientExample)
* effectiveDateTime = "2024-03-19T08:00:00Z"
* performer = Reference(Practitioner/PractitionerExample)

* component[sessionDuration].code = $SCT#118682006 "Duration"
* component[sessionDuration].valueQuantity = 20 'min'

* component[stressLevel].code = $SCT#725854004 "Assessment of stress level"
* component[stressLevel].valueInteger = 3

* component[moodState].code = $SCT#373931001 "Mood finding"
* component[moodState].valueCodeableConcept = $SCT#130991005 "Neutral mood"

* component[relaxationResponse].code = $SCT#276241001 "Relaxation technique"
* component[relaxationResponse].valueString = "Deep breathing exercises with progressive relaxation"

* component[mindfulnessType].code = $SCT#711415009 "Mindfulness"
* component[mindfulnessType].valueCodeableConcept = $SCT#711415009 "Mindfulness"

* extension[mindfulness-context].extension[location].valueString = "Home meditation room"
* extension[mindfulness-context].extension[environment].valueCodeableConcept = #quiet "Quiet Space"
* extension[mindfulness-context].extension[guidance].valueBoolean = true

Instance: CompleteMindfulnessResponse
InstanceOf: QuestionnaireResponse
Usage: #example
Description: "Complete mindfulness questionnaire response example"
Title: "Complete Mindfulness Session Response"

* questionnaire = "https://2rdoc.pt/fhir/Questionnaire/daily-mindfulness"
* status = #completed
* subject = Reference(Patient/PatientExample)
* authored = "2024-03-19T08:30:00Z"

* item[0]
  * linkId = "mindful_session"
  * item[0]
    * linkId = "session_duration"
    * answer.valueInteger = 20
  * item[1]
    * linkId = "practice_type"
    * answer.valueString = "Meditation"

* item[1]
  * linkId = "mood_assessment"
  * item[0]
    * linkId = "current_mood"
    * answer.valueCoding = $SCT#130991005 "Neutral mood"
  * item[1]
    * linkId = "mood_intensity"
    * answer.valueInteger = 3

* item[2]
  * linkId = "stress_assessment"
  * item[0]
    * linkId = "stress_level"
    * answer.valueInteger = 3
  * item[1]
    * linkId = "stress_symptoms"
    * answer[0].valueString = "Slight tension"

* item[3]
  * linkId = "relaxation"
  * item[0]
    * linkId = "relaxation_duration"
    * answer.valueInteger = 15
  * item[1]
    * linkId = "relaxation_technique"
    * answer.valueString = "Deep breathing"



// ===== Conteúdo de: MindfulnessExamples.fsh =====

Instance: MindfulnessObservationExample
InstanceOf: MindfulnessObservation
Usage: #example
Description: "Mindfulness observation example"
Title: "Example of Mindfulness Session Observation"

* status = #final
* code = $SCT#711415009 "Mindfulness"
* subject = Reference(Patient/PatientExample)
* effectiveDateTime = "2024-03-19T09:30:00Z"
* performer = Reference(Practitioner/PractitionerExample)

* component[sessionDuration].code = $SCT#118682006 "Duration"
* component[sessionDuration].valueQuantity = 20 'min'

* component[stressLevel].code = $SCT#725854004 "Assessment of stress level"
* component[stressLevel].valueInteger = 4

* component[moodState].code = $SCT#373931001 "Mood finding"
* component[moodState].valueCodeableConcept = $SCT#130991005 "Neutral mood"

* component[relaxationResponse].code = $SCT#276241001 "Relaxation technique"
* component[relaxationResponse].valueString = "Deep breathing exercises helped reduce tension"

* component[mindfulnessType].code = $SCT#711415009 "Mindfulness"
* component[mindfulnessType].valueCodeableConcept = $SCT#711415009 "Mindfulness"

// New example for MindfulnessQuestionnaire
Instance: MindfulnessQuestionnaireExample
InstanceOf: Questionnaire
Usage: #example
Title: "Example of Mindfulness Questionnaire"

* url = "https://2rdoc.pt/ig/ios-lifestyle-medicine/Questionnaire/mindfulness-example"
* status = #active
* title = "Daily Mindfulness Assessment"
* version = "1.0"
* name = "MindfulnessQuestionnaireExample"
* date = "2024-03-19"
* description = "Example questionnaire for daily mindfulness practice assessment"

* item[0]
  * linkId = "session_details"
  * text = "Session Details"
  * type = #group
  
  * item[0]
    * linkId = "duration"
    * text = "Duration (minutes)"
    * type = #integer
    * required = true
    
  * item[1]
    * linkId = "technique"
    * text = "Technique Used"
    * type = #choice
    * required = true
    * answerOption[0].valueString = "Mindful Breathing"
    * answerOption[1].valueString = "Body Scan"
    * answerOption[2].valueString = "Walking Meditation"



// ===== Conteúdo de: ReproductiveExamples.fsh =====

Instance: ExampleReproductiveActivity
InstanceOf: CarePlan
Usage: #example
Description: "Reproductive health care plan example"
* status = #active
* intent = #plan
* subject = Reference(Patient/PatientExample)
* activity.detail.kind = #ServiceRequest
* activity.detail.code = ReproductiveActivityCS#cycle-tracking
* activity.detail.status = #scheduled



// ===== Conteúdo de: MissingResources.fsh =====

// ====== Recursos Faltantes para Resolver Links Quebrados ======

Instance: example
InstanceOf: Patient
Usage: #example
* identifier.system = "http://example.org/patients"
* identifier.value = "example-patient"
* name.family = "Example"
* name.given = "Patient"
* gender = #unknown
* birthDate = "1970-01-01"

Instance: osa-practitioner-kyle-anydoc
InstanceOf: Practitioner
Usage: #example
* identifier.system = "http://example.org/practitioners"
* identifier.value = "kyle-anydoc"
* name.family = "Anydoc"
* name.given = "Kyle"
* name.prefix = "Dr."

Instance: PatientMindfulness
InstanceOf: Patient
Usage: #example
* identifier.system = "http://example.org/patients"
* identifier.value = "mindfulness-patient"
* name.family = "Mindfulness"
* name.given = "Test"
* gender = #other
* birthDate = "1980-01-01"

Instance: Org2RDoc
InstanceOf: Organization
Usage: #example
* identifier.system = "http://example.org/organizations"
* identifier.value = "2rdoc"
* name = "2RDoc Healthcare Solutions"
* active = true



// ===== Conteúdo de: MindfulnessWorkflow.fsh =====

Profile: MindfulnessSchedule
Parent: Basic
Id: mindfulness-schedule
Title: "Mindfulness Schedule"
Description: "Schedule configuration for mindfulness sessions"

* code 1..1 MS
* code = https://2rdoc.pt/fhir/CodeSystem/mindfulness-schedule-type#recurring "Recurring Schedule"

Extension: MindfulnessScheduleTiming
Id: mindfulness-schedule-timing
Title: "Mindfulness Schedule Timing"
Description: "Timing configuration for mindfulness sessions"
* value[x] only Timing

Instance: WeeklyMindfulnessSchedule
InstanceOf: MindfulnessSchedule
Title: "Weekly Mindfulness Schedule"
Description: "Example of a weekly mindfulness schedule"

* code = https://2rdoc.pt/fhir/CodeSystem/mindfulness-schedule-type#recurring "Recurring Schedule"
* extension[mindfulness-schedule-timing].valueTiming.repeat.frequency = 1
* extension[mindfulness-schedule-timing].valueTiming.repeat.period = 1
* extension[mindfulness-schedule-timing].valueTiming.repeat.periodUnit = #wk
* extension[mindfulness-schedule-timing].valueTiming.repeat.dayOfWeek = #mon
* extension[mindfulness-schedule-timing].valueTiming.repeat.dayOfWeek[+] = #wed
* extension[mindfulness-schedule-timing].valueTiming.repeat.dayOfWeek[+] = #fri



// ===== Conteúdo de: MindfulnessRules.fsh =====

RuleSet: MindfulnessValidation
* ^extension[0].url = "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice"
* ^extension[0].valueBoolean = true

* status MS
* code MS
* subject MS
* effective[x] MS
* value[x] MS
* component MS

* status from http://hl7.org/fhir/ValueSet/observation-status
* code from http://snomed.info/sct?fhir_vs=isa/711415009
* subject only Reference(Patient)
* effective[x] only dateTime

* obeys mindfulness-session-duration
* obeys mindfulness-stress-level
* obeys mindfulness-mood-required
* obeys mindfulness-context-complete
* obeys sequential-measurements

RuleSet: MindfulnessQuestionnaireValidation
* status MS
* title MS
* item MS

* status = #active
* subjectType = #Patient
* item ^slicing.discriminator.type = #pattern
* item ^slicing.discriminator.path = "linkId"
* item ^slicing.rules = #open
* item contains 
    session 0..1 MS and
    mood 0..1 MS and
    stress 0..1 MS and
    relaxation 0..1 MS

* item[session]
  * linkId = "mindful_session"
  * text = "Mindfulness Session"
  * type = #group
  * required = true
  * repeats = false

* item[mood]
  * linkId = "mood_assessment"
  * text = "Mood Assessment"
  * type = #group
  * required = true
  * repeats = false

* item[stress]
  * linkId = "stress_assessment"
  * text = "Stress Assessment"
  * type = #group
  * required = true
  * repeats = false

* item[relaxation]
  * linkId = "relaxation"
  * text = "Relaxation"
  * type = #group
  * required = true
  * repeats = false

RuleSet: MindfulnessResponseValidation
* status MS
* subject MS
* authored MS
* item MS

* status = #completed
* subject only Reference(Patient)
* authored 1..1
* item ^slicing.discriminator.type = #pattern
* item ^slicing.discriminator.path = "linkId"
* item ^slicing.rules = #open



// ===== Conteúdo de: MindfulnessMappings.fsh =====

Mapping: MindfulnessToHealthKit
Id: mindfulness-to-healthkit
Title: "Mapping to Apple HealthKit"
Source: MindfulnessObservation
Target: "http://developer.apple.com/documentation/healthkit"

* -> "HKCategoryTypeIdentifierMindfulSession" "Root mapping"
* effectiveDateTime -> "startDate and endDate" "Session timing"
* component[sessionDuration].valueQuantity -> "duration" "Session duration"

Mapping: MindfulnessToLOINC
Id: mindfulness-to-loinc
Title: "Mapping to LOINC codes"
Source: MindfulnessObservation
Target: "http://loinc.org"

* -> "89555-7" "Mindfulness safety questionnaire"
* component[stressLevel] -> "89556-5" "Stress level score"
* component[sessionDuration] -> "89557-3" "Duration of mindfulness practice"
* component[moodState] -> "89558-1" "Mood pattern"

Mapping: MindfulnessToSNOMED
Id: mindfulness-to-snomed
Title: "Mapping to SNOMED CT"
Source: MindfulnessObservation
Target: "http://snomed.info/sct"

* -> "711415009" "Meditation"
* component[stressLevel] -> "725854004" "Assessment of stress level"
* component[moodState] -> "373931001" "Mood finding"
* component[relaxationResponse] -> "276241001" "Relaxation technique"

Extension: MindfulnessImportMap
Id: mindfulness-import-map
Title: "Mindfulness Import Mapping"
Description: "Mapping instructions for importing mindfulness data"

* ^url = "https://2rdoc.pt/ig/ios-lifestyle-medicine/StructureDefinition/mindfulness-import-map"
* ^version = "1.0.0"
* ^status = #draft

* extension contains
    source 1..1 MS and
    target 1..1 MS and
    mapping 1..1 MS

* extension[source].value[x] only string
* extension[target].value[x] only string
* extension[mapping].value[x] only string

Instance: HealthKitMappingConfig
InstanceOf: MindfulnessImportMap
Usage: #inline

* extension[source].valueString = "HKCategoryTypeIdentifierMindfulSession"
* extension[target].valueString = "Observation"
* extension[mapping].valueString = "duration->component[sessionDuration].valueQuantity"



// ===== Conteúdo de: SocialInteractionMappings.fsh =====

Mapping: SocialInteractionToHealthKit
Id: social-interaction-to-healthkit
Description: "Definition for social-interaction-to-healthkit resource"Title: "Mapping to Apple HealthKit"
Source: SocialInteractionProfile
Target: "http://developer.apple.com/documentation/healthkit"

* -> "HKCategoryTypeIdentifierSocialInteraction" "Root mapping"
* valueCodeableConcept -> "interactionType" "Type of interaction"
* component[duration] -> "duration" "Duration of interaction"
* component[participants] -> "participantCount" "Number of participants"

Mapping: SocialInteractionToLOINC
Id: social-interaction-to-loinc
Title: "Mapping to LOINC codes"
Source: SocialInteractionProfile
Target: "http://loinc.org"

* -> "96766-1" "Social Interaction Panel"
* component[duration] -> "89597-9" "Interaction duration"
* component[quality] -> "89598-7" "Interaction quality"



// ===== Conteúdo de: MindfulnessDiagnosticMappings.fsh =====

Instance: MindfulnessDiagnosticMap
InstanceOf: ConceptMap
Usage: #definition
Title: "Mindfulness Diagnostic Mappings"
Description: "Mapping of mindfulness outcomes to diagnostic codes"

* status = #draft
* experimental = false
* purpose = "Map mindfulness outcomes to standard diagnostic codes"
* sourceUri = "https://2rdoc.pt/fhir/ValueSet/mindfulness-outcome-vs"
* targetUri = "http://snomed.info/sct"

* group[0].source = "https://2rdoc.pt/fhir/CodeSystem/mindfulness-outcome-cs"
* group[0].target = "http://snomed.info/sct"
* group[0].element[0]
  * code = #stressReduction
  * target[0]
    * code = #73595000
    * display = "Stress"
    * equivalence = #narrower
    * comment = "Indicates reduction in stress levels"

* group[0].element[1]
  * code = #improvedSleep
  * target[0]
    * code = #248234008
    * display = "Sleep pattern"
    * equivalence = #narrower
    * comment = "Indicates improvement in sleep quality"

* group[0].element[2]
  * code = #emotionalBalance
  * target[0]
    * code = #285854004
    * display = "Emotional state"
    * equivalence = #equivalent
    * comment = "Maps to emotional state finding"

* group[0].element[3]
  * code = #increasedAwareness
  * target[0]
    * code = #736253002
    * display = "Mental state, behavior and/or psychosocial functioning"
    * equivalence = #relatedto
    * comment = "General improvement in mental state"

RuleSet: MindfulnessDiagnosticRules
* status MS
* code MS
* subject MS
* effective[x] MS
* value[x] MS
* method MS

* method from https://2rdoc.pt/fhir/ValueSet/mindfulness-diagnostic-method-vs (required)
* code from https://2rdoc.pt/fhir/ValueSet/mindfulness-diagnostic-code-vs (required)

* extension contains 
    diagnosticCertainty 0..1 MS and
    diagnosticTiming 0..1 MS



// ===== Conteúdo de: StressMappings.fsh =====

Mapping: StressToHealthKit
Id: stress-to-healthkit
Description: "Definition for stress-to-healthkit resource"Title: "Mapping to Apple HealthKit"
Source: StressLevelProfile
Target: "http://developer.apple.com/documentation/healthkit"

* -> "HKCategoryTypeIdentifierStressLevel" "Root mapping"
* valueQuantity -> "stressLevel" "Overall stress score"
* component[physiologicalStress] -> "physiologicalStress" "Physical stress indicators"
* component[psychologicalStress] -> "mentalStress" "Mental stress indicators"

Mapping: StressToLOINC
Id: stress-to-loinc
Title: "Mapping to LOINC codes"
Source: StressLevelProfile
Target: "http://loinc.org"

* -> "89592-0" "Stress Level Panel"
* component[physiologicalStress] -> "89593-8" "Physical stress score"
* component[psychologicalStress] -> "89594-6" "Mental stress score"



// ===== Conteúdo de: BodyMetricsProfiles.fsh =====

Alias: $SCT = http://snomed.info/sct
Alias: $LOINC = http://loinc.org
Alias: $UCUM = http://unitsofmeasure.org

Profile: BodyMetricsObservation
Parent: Observation
Id: body-metrics-observation
Title: "Body Metrics Observation Profile"
Description: "Profile for body measurements from iOS Health App"

* ^version = "0.1.0"
* ^status = #draft
* ^publisher = "Open Health Manager"

* status MS
* category 1..1 MS
* category = http://terminology.hl7.org/CodeSystem/observation-category#vital-signs
* subject 1..1 MS
* effectiveDateTime 1..1 MS
* device 0..1 MS

Profile: WeightObservation
Parent: BodyMetricsObservation
Id: weight-observation  
Title: "Weight Measurement Profile"
Description: "Profile for body weight measurements"

* ^version = "0.1.0"
* ^status = #draft

* code = $LOINC#29463-7 "Body weight"
* valueQuantity only Quantity
* valueQuantity.system = $UCUM
* valueQuantity.code = #kg

Profile: HeightObservation
Parent: BodyMetricsObservation
Id: height-observation
Title: "Height Measurement Profile" 
Description: "Profile for body height measurements"

* ^version = "0.1.0"
* ^status = #draft

* code = $LOINC#8302-2 "Body height"
* valueQuantity only Quantity
* valueQuantity.system = $UCUM
* valueQuantity.code = #cm

Profile: BMIObservation
Parent: BodyMetricsObservation
Id: bmi-observation
Title: "BMI Measurement Profile"
Description: "Profile for Body Mass Index calculations"

* ^version = "0.1.0"
* ^status = #draft

* code = $LOINC#39156-5 "Body mass index (BMI)"
* valueQuantity only Quantity
* valueQuantity.system = $UCUM
* valueQuantity.code = #kg/m2

Profile: BodyCompositionObservation
Parent: BodyMetricsObservation
Id: body-composition-observation
Title: "Body Composition Profile"
Description: "Profile for body composition measurements including fat, lean mass, and other metrics"

* ^version = "0.1.0"
* ^status = #draft

* code = $LOINC#88365-2 "Body composition panel"
* component ^slicing.discriminator.type = #pattern
* component ^slicing.discriminator.path = "code"
* component ^slicing.rules = #open

* component contains
    bodyFat 0..1 MS and
    leanMass 0..1 MS and
    bodyWater 0..1 MS and
    muscleMass 0..1 MS and
    boneMass 0..1 MS

* component[bodyFat].code = $LOINC#41982-0 "Percentage body fat"
* component[bodyFat].valueQuantity.system = $UCUM
* component[bodyFat].valueQuantity.code = #%

* component[leanMass].code = $LOINC#291-7 "Lean body mass"
* component[leanMass].valueQuantity.system = $UCUM
* component[leanMass].valueQuantity.code = #kg

* component[bodyWater].code = $LOINC#73708-0 "Total body water"
* component[bodyWater].valueQuantity.system = $UCUM  
* component[bodyWater].valueQuantity.code = #L

* component[muscleMass].code = $LOINC#73713-0 "Muscle mass"
* component[muscleMass].valueQuantity.system = $UCUM
* component[muscleMass].valueQuantity.code = #kg

* component[boneMass].code = $LOINC#73711-4 "Bone mass" 
* component[boneMass].valueQuantity.system = $UCUM
* component[boneMass].valueQuantity.code = #kg



// ===== Conteúdo de: AdvancedVitalSignsProfiles.fsh =====

Alias: $SCT = http://snomed.info/sct
Alias: $LOINC = http://loinc.org
Alias: $UCUM = http://unitsofmeasure.org

Profile: AdvancedVitalSigns
Parent: Observation
Id: advanced-vital-signs
Title: "Advanced Vital Signs Profile"
Description: "Profile for advanced vital signs data from iOS Health App"

* ^version = "0.1.0"
* ^status = #draft
* ^publisher = "HL7 International"
* ^contact.name = "Advanced Vital Signs Working Group"

* status MS
* category 1..1 MS
* category = http://terminology.hl7.org/CodeSystem/observation-category#vital-signs
* code 1..1 MS
* subject 1..1 MS
* effectiveDateTime 1..1 MS
* device 0..1 MS
* method 0..1 MS
* note 0..* MS

* component ^slicing.discriminator.type = #pattern
* component ^slicing.discriminator.path = "code"
* component ^slicing.rules = #open
* component ^short = "Advanced vital signs components"
* component ^definition = "Components of advanced vital sign measurements"

* component contains
    hrvSpectral 0..1 MS and
    hrvEntropy 0..1 MS and
    meanArterialPressure 0..1 MS and
    pulseWaveAnalysis 0..1 MS and
    respiratoryVariability 0..1 MS and
    oxygenationIndex 0..1 MS and
    stressIndex 0..1 MS and
    thermalGradient 0..1 MS and
    autonomicBalance 0..1 MS and
    recoveryRate 0..1 MS and
    allostaticLoad 0..1 MS

* component[hrvSpectral].code = $LOINC#87834-8 "Heart rate variability [Frequency band]"
* component[hrvSpectral].valueQuantity.system = $UCUM
* component[hrvSpectral].valueQuantity.code = #ms
* component[hrvSpectral] ^short = "Spectral analysis of heart rate variability"

* component[hrvEntropy].code = $LOINC#87835-5 "Heart rate variability entropy"
* component[hrvEntropy].valueQuantity.system = $UCUM
* component[hrvEntropy].valueQuantity.code = #{entropy}
* component[hrvEntropy] ^short = "Sample entropy of heart rate variability"

* component[meanArterialPressure].code = $LOINC#8478-0 "Mean blood pressure"
* component[meanArterialPressure].valueQuantity.system = $UCUM
* component[meanArterialPressure].valueQuantity.code = #mmHg
* component[meanArterialPressure] ^short = "Mean arterial blood pressure"

* component[pulseWaveAnalysis].code = $LOINC#87836-3 "Pulse wave analysis"
* component[pulseWaveAnalysis].valueQuantity.system = $UCUM
* component[pulseWaveAnalysis].valueQuantity.code = #{index}
* component[pulseWaveAnalysis] ^short = "Analysis of arterial pulse wave"

* component[respiratoryVariability].code = $LOINC#87837-1 "Respiratory rate variability"
* component[respiratoryVariability].valueQuantity.system = $UCUM
* component[respiratoryVariability].valueQuantity.code = #{coefficient}
* component[respiratoryVariability] ^short = "Variability in respiratory rate"

* component[oxygenationIndex].code = $LOINC#87838-9 "Oxygenation index"
* component[oxygenationIndex].valueQuantity.system = $UCUM
* component[oxygenationIndex].valueQuantity.code = #{ratio}
* component[oxygenationIndex] ^short = "Index of blood oxygenation"

* component[stressIndex].code = $LOINC#87839-7 "Physiological stress index"
* component[stressIndex].valueQuantity.system = $UCUM
* component[stressIndex].valueQuantity.code = #{index}
* component[stressIndex] ^short = "Index of physiological stress"

* component[thermalGradient].code = $LOINC#87840-5 "Temperature gradient"
* component[thermalGradient].valueQuantity.system = $UCUM
* component[thermalGradient].valueQuantity.code = #Cel
* component[thermalGradient] ^short = "Gradient of body temperature"

* component[autonomicBalance].code = $LOINC#87841-3 "Autonomic balance index"
* component[autonomicBalance].valueQuantity.system = $UCUM
* component[autonomicBalance].valueQuantity.code = #{ratio}
* component[autonomicBalance] ^short = "Balance of autonomic nervous system"

* component[recoveryRate].code = $LOINC#87842-1 "Recovery rate index"
* component[recoveryRate].valueQuantity.system = $UCUM
* component[recoveryRate].valueQuantity.code = #{rate}
* component[recoveryRate] ^short = "Rate of physiological recovery"

* component[allostaticLoad].code = $LOINC#87843-9 "Allostatic load index"
* component[allostaticLoad].valueQuantity.system = $UCUM
* component[allostaticLoad].valueQuantity.code = #{score}
* component[allostaticLoad] ^short = "Measure of cumulative physiological burden"

Extension: AdvancedVitalSignsContext
Id: advanced-vital-signs-context
Title: "Advanced Vital Signs Context Extension"
Description: "Additional context about advanced vital sign measurements"

* value[x] only CodeableConcept
* valueCodeableConcept from AdvancedVitalSignsContextVS (required)

ValueSet: AdvancedVitalSignsContextVS
Id: advanced-vital-signs-context-vs
Title: "Advanced Vital Signs Context Value Set"
Description: "Context codes for advanced vital sign measurements"

* ^experimental = true
* codes from system AdvancedVitalSignsContextCS

CodeSystem: AdvancedVitalSignsContextCS
Id: advanced-vital-signs-context-cs
Title: "Advanced Vital Signs Context Code System"
Description: "Codes for advanced vital signs measurement context"

* ^experimental = true
* ^caseSensitive = true

* #resting "Resting state" "Measurement taken during rest"
* #active "Active state" "Measurement taken during activity"
* #recovery "Recovery state" "Measurement taken during recovery"
* #sleep "Sleep state" "Measurement taken during sleep"
* #stress "Stress state" "Measurement taken during stress"



// ===== Conteúdo de: MobilityProfiles.fsh =====

Profile: MobilityProfile
Parent: Observation
Id: mobility-profile
Title: "Mobility Profile"
Description: "Profile for mobility data from iOS Health App"

* status MS
* category 1..1 MS
* category = http://terminology.hl7.org/CodeSystem/observation-category#activity
* code 1..1 MS
* subject 1..1 MS
* effectiveDateTime 1..1 MS
* device 0..1 MS

* component ^slicing.discriminator.type = #pattern
* component ^slicing.discriminator.path = "code"
* component ^slicing.rules = #open

* component contains
    steadiness 0..1 MS and
    balance 0..1 MS and
    gait 0..1 MS and 
    movement 0..1 MS

* component[steadiness].code = $LOINC#LA32-8
* component[balance].code = $LOINC#LA32-9
* component[gait].code = $LOINC#LA29042-4
* component[movement].code = $LOINC#LA29043-2



// ===== Conteúdo de: VitalSignsProfiles.fsh =====

Alias: $SCT = http://snomed.info/sct
Alias: $LOINC = http://loinc.org
Alias: $UCUM = http://unitsofmeasure.org
Alias: $vitalsigns = http://hl7.org/fhir/StructureDefinition/vitalsigns

Profile: LifestyleVitalSigns
Parent: $vitalsigns
Id: lifestyle-vital-signs
Title: "Lifestyle Medicine Vital Signs Profile"
Description: "Profile for vital signs data from iOS Health App"

* status MS
* category 1..* MS
* subject 1..1 MS
* effectiveDateTime 1..1 MS
* code 1..1 MS
* value[x] 0..1 MS
* device 0..1 MS

Profile: HeartRateObservation
Parent: LifestyleVitalSigns
Id: heart-rate-observation
Title: "Heart Rate Observation Profile"
Description: "Profile for heart rate measurements from iOS Health App"

* code = $LOINC#8867-4 "Heart rate"
* valueQuantity only Quantity
* valueQuantity.system = $UCUM
* valueQuantity.code = #/min
* component ^slicing.discriminator.type = #pattern
* component ^slicing.discriminator.path = "code"
* component ^slicing.rules = #open

* component contains
    restingHeartRate 0..1 MS and
    exerciseHeartRate 0..1 MS and
    recoveryHeartRate 0..1 MS and
    heartRateVariability 0..1 MS

* component[heartRateVariability].code = $LOINC#80404-7 "R-R interval.standard deviation (Heart rate variability)"
* component[heartRateVariability].valueQuantity.system = $UCUM
* component[heartRateVariability].valueQuantity.code = #ms

Profile: BloodPressureObservation
Parent: LifestyleVitalSigns
Id: blood-pressure-observation
Title: "Blood Pressure Observation Profile"
Description: "Profile for blood pressure measurements from iOS Health App"

* code = $LOINC#85354-9 "Blood pressure panel with all children optional"
* component 2..2 MS
* component ^slicing.discriminator.type = #pattern
* component ^slicing.discriminator.path = "code"
* component ^slicing.rules = #closed

* component contains
    systolic 1..1 MS and
    diastolic 1..1 MS

* component[systolic].code = $LOINC#8480-6 "Systolic blood pressure"
* component[systolic].valueQuantity only Quantity
* component[systolic].valueQuantity.system = $UCUM
* component[systolic].valueQuantity.code = #mm[Hg]

* component[diastolic].code = $LOINC#8462-4 "Diastolic blood pressure"
* component[diastolic].valueQuantity only Quantity
* component[diastolic].valueQuantity.system = $UCUM
* component[diastolic].valueQuantity.code = #mm[Hg]

Profile: OxygenSaturationObservation
Parent: LifestyleVitalSigns
Id: oxygen-saturation-observation
Title: "Oxygen Saturation Observation Profile"
Description: "Profile for SpO2 measurements from iOS Health App"

* code = $LOINC#2708-6 "Oxygen saturation in Arterial blood"
* valueQuantity.system = $UCUM
* valueQuantity.code = #%



// ===== Conteúdo de: PhysicalActivityProfile.fsh =====

Alias: $LOINC = http://loinc.org
Alias: $SNOMED = http://snomed.info/sct
Alias: $UCUM = http://unitsofmeasure.org
Alias: $ActivityCodes = https://2rdoc.pt/ig/ios-lifestyle-medicine/activity-codes

Profile: PhysicalActivityObservation
Parent: Observation
Id: physical-activity-observation
Title: "Physical Activity Observation Profile"
Description: "Profile for recording physical activity data from iOS Health App"

* status MS
* category 1..1 MS
* category = http://terminology.hl7.org/CodeSystem/observation-category#activity
* code 1..1 MS
* code from PhysicalActivityTypeVS (required)
* subject 1..1 MS
* subject only Reference(Patient)
* effectiveDateTime 1..1 MS
* device 0..1 MS
* value[x] only Quantity
* component ^slicing.discriminator.type = #pattern
* component ^slicing.discriminator.path = "code"
* component ^slicing.rules = #open

* component contains
    steps 0..1 MS and
    distance 0..1 MS and
    duration 0..1 MS and
    energy 0..1 MS

* component[steps].code = $LOINC#55423-8 "Number of steps in 24 hour Measured"
* component[steps].valueQuantity only Quantity
* component[steps].valueQuantity.system = $UCUM
* component[steps].valueQuantity.code = #1 "count"

* component[distance].code = $LOINC#55430-3 "Distance walked"
* component[distance].valueQuantity only Quantity
* component[distance].valueQuantity.system = $UCUM
* component[distance].valueQuantity.code = #km "kilometer"

* component[duration].code = $LOINC#55411-3 "Exercise duration"
* component[duration].valueQuantity only Quantity
* component[duration].valueQuantity.system = $UCUM
* component[duration].valueQuantity.code = #min "minute"

* component[energy].code = $LOINC#55424-6 "Energy expenditure"
* component[energy].valueQuantity only Quantity
* component[energy].valueQuantity.system = $UCUM
* component[energy].valueQuantity.code = #kcal "kilocalorie"



// ===== Conteúdo de: ReproductiveObservation.fsh =====

Profile: ReproductiveObservation
Parent: Observation
Id: reproductive-observation
Title: "Reproductive Health Base Profile"
Description: "Base profile for reproductive health observations"

* ^version = "1.0.0"
* ^status = #active
* ^date = "2024-03-19"

* status MS
* category 1..1 MS
* category = http://terminology.hl7.org/CodeSystem/observation-category#reproductive
* code 1..1 MS
* subject 1..1 MS
* subject only Reference(Patient)
* effectiveDateTime 1..1 MS
* value[x] MS

* component ^slicing.discriminator.type = #pattern
* component ^slicing.discriminator.path = "code"
* component ^slicing.rules = #open

* component contains
    severity 0..1 MS and
    duration 0..1 MS and
    frequency 0..1 MS and
    pattern 0..1 MS

* component[severity]
  * code = $LOINC#72514-3
  * value[x] only integer
  * valueInteger 1..1 
  * valueInteger obeys rep-1

* component[duration]
  * code = $LOINC#103332-8
  * value[x] only Quantity
  * valueQuantity from DurationUnitsVS (required)

* component[frequency]
  * code = $LOINC#103334-4
  * value[x] only CodeableConcept
  * valueCodeableConcept from SymptomFrequencyVS (required)

* component[pattern]
  * code = $LOINC#103335-1
  * value[x] only CodeableConcept
  * valueCodeableConcept from SymptomProgressionVS (required)

Invariant: rep-1
Description: "Severity must be between 0 and 10"
Expression: "$this >= 0 and $this <= 10"
Severity: #error



// ===== Conteúdo de: SymptomProfiles.fsh =====

Profile: SymptomQuestionnaire
Parent: Questionnaire
Id: symptom-questionnaire
Title: "Symptom Assessment Questionnaire"
Description: "Questionnaire template for symptom assessments"

* status MS
* title MS
* item MS

* item ^slicing.discriminator.type = #pattern
* item ^slicing.discriminator.path = "linkId"
* item ^slicing.rules = #open

* item contains
    symptomType 1..1 MS and
    location 0..1 MS and
    onset 0..1 MS and
    description 0..1 MS

* item[symptomType].linkId = "symptom-type"
* item[symptomType].text = "Type of Symptom"
* item[symptomType].type = #choice
* item[symptomType].required = true

* item[location].linkId = "location"
* item[location].text = "Location"
* item[location].type = #string

* item[onset].linkId = "onset"
* item[onset].text = "When did it start?"
* item[onset].type = #dateTime

* item[description].linkId = "description"
* item[description].text = "Description"
* item[description].type = #text



// ===== Conteúdo de: ReproductiveProfiles.fsh =====

Profile: FertilityObservation
Parent: Observation
Id: fertility-observation
Title: "Fertility Observation Profile"
Description: "Profile for fertility signs and symptoms"

* status MS
* category 1..1 MS
* category = http://terminology.hl7.org/CodeSystem/observation-category#reproductive
* code = $LOINC#8669-4 "Ovulation status"
* subject 1..1 MS
* effectiveDateTime 1..1 MS

* component ^slicing.discriminator.type = #pattern
* component ^slicing.discriminator.path = "code"
* component ^slicing.rules = #open

* component contains
    cervicalMucus 0..1 MS and
    ovulationTest 0..1 MS and
    fertilityStatus 0..1 MS

* component[cervicalMucus].valueCodeableConcept from https://2rdoc.pt/fhir/ValueSet/cervical-mucus-vs (required)
* component[ovulationTest].valueCodeableConcept from https://2rdoc.pt/fhir/ValueSet/ovulation-test-vs (required)
* component[fertilityStatus].valueCodeableConcept from https://2rdoc.pt/fhir/ValueSet/fertility-status-vs (required)



// ===== Conteúdo de: MindfulnessProfiles.fsh =====

Profile: MindfulnessObservation
Parent: Observation
Id: mindfulness-observation
Title: "Mindfulness Session Observation"
Description: "Profile for recording mindfulness practice sessions and outcomes"

* status MS
* code MS
* subject MS
* effectiveDateTime MS
* performer MS
* value[x] MS
* component MS

* status = #final
* code = $SCT#711415009 "Mindfulness"
* subject only Reference(Patient)
* effectiveDateTime 1..1
* performer only Reference(Practitioner or PractitionerRole)

* component ^slicing.discriminator.type = #pattern
* component ^slicing.discriminator.path = "code"
* component ^slicing.rules = #open

* component contains
    sessionDuration 0..1 and
    stressLevel 0..1 and
    moodState 0..1 and
    relaxationResponse 0..1 and
    mindfulnessType 0..1

* component[sessionDuration]
  * code = $SCT#118682006 "Duration"
  * value[x] only Quantity
  * valueQuantity
    * value 1..1
    * unit = "min"
    * system = "http://unitsofmeasure.org"
    * code = #min

* component[stressLevel]
  * code = $SCT#725854004 "Assessment of stress level"
  * value[x] only integer
  * valueInteger
    * ^extension[0].url = "http://hl7.org/fhir/StructureDefinition/elementdefinition-minValueInteger"
    * ^extension[0].valueInteger = 0
    * ^extension[1].url = "http://hl7.org/fhir/StructureDefinition/elementdefinition-maxValueInteger"
    * ^extension[1].valueInteger = 10

* component[moodState]
  * code = $SCT#373931001 "Mood finding"
  * value[x] only CodeableConcept
  * valueCodeableConcept from https://2rdoc.pt/fhir/ValueSet/mood (required)

* component[relaxationResponse]
  * code = $SCT#276241001 "Relaxation technique"
  * value[x] only string

* component[mindfulnessType]
  * code = $SCT#711415009 "Mindfulness"
  * value[x] only CodeableConcept
  * valueCodeableConcept from https://2rdoc.pt/fhir/ValueSet/mindfulness-type (required)



// ===== Conteúdo de: SleepProfile.fsh =====

Alias: $SCT = http://snomed.info/sct
Alias: $LOINC = http://loinc.org
Alias: $UCUM = http://unitsofmeasure.org
 
Profile: SleepObservation
Parent: Observation
Id: sleep-observation
Title: "Sleep Observation Profile"
Description: "Profile for recording sleep data from iOS Health App"
 
* status MS
* category 1..1 MS
* category = http://terminology.hl7.org/CodeSystem/observation-category#sleep
* code 1..1 MS
* code = $LOINC#93832-4 "Sleep pattern panel"
* subject 1..1 MS
* subject only Reference(Patient)
* effectiveDateTime 0..1 MS
* effectivePeriod 0..1 MS
* device 0..1 MS
 
* component ^slicing.discriminator.type = #pattern
* component ^slicing.discriminator.path = "code"
* component ^slicing.rules = #open
 
* component contains
    timeInBed 1..1 MS and
    totalSleepTime 1..1 MS and
    deepSleep 0..1 MS and
    remSleep 0..1 MS and
    lightSleep 0..1 MS and
    respiratoryRate 0..1 MS and
    heartRateVariability 0..1 MS and
    interruptions 0..1 MS
 
* component[timeInBed].code = $LOINC#93831-6 "Time in bed"
* component[timeInBed].valueQuantity only Quantity
* component[timeInBed].valueQuantity.system = $UCUM
* component[timeInBed].valueQuantity.code = #min
 
* component[totalSleepTime].code = $LOINC#93833-2 "Sleep duration"
* component[totalSleepTime].valueQuantity only Quantity
* component[totalSleepTime].valueQuantity.system = $UCUM
* component[totalSleepTime].valueQuantity.code = #min
 
* component[deepSleep].code = $LOINC#93834-0 "Deep sleep duration"
* component[deepSleep].valueQuantity only Quantity
* component[deepSleep].valueQuantity.system = $UCUM
* component[deepSleep].valueQuantity.code = #min
 
* component[remSleep].code = $LOINC#93835-7 "REM sleep duration"
* component[remSleep].valueQuantity only Quantity
* component[remSleep].valueQuantity.system = $UCUM
* component[remSleep].valueQuantity.code = #min
 
* component[lightSleep].code = $LOINC#93836-5 "Light sleep duration"
* component[lightSleep].valueQuantity only Quantity
* component[lightSleep].valueQuantity.system = $UCUM
* component[lightSleep].valueQuantity.code = #min
 
* component[respiratoryRate].code = $LOINC#9279-1 "Respiratory rate"
* component[respiratoryRate].valueQuantity only Quantity
* component[respiratoryRate].valueQuantity.system = $UCUM
* component[respiratoryRate].valueQuantity.code = #/min
 
* component[heartRateVariability].code = $LOINC#80404-7 "R-R interval.standard deviation (Heart rate variability)"
* component[heartRateVariability].valueQuantity only Quantity
* component[heartRateVariability].valueQuantity.system = $UCUM
* component[heartRateVariability].valueQuantity.code = #ms
 
* component[interruptions].code = $LOINC#93837-3 "Number of awakenings during sleep"
* component[interruptions].valueQuantity only Quantity
* component[interruptions].valueQuantity.system = $UCUM
* component[interruptions].valueQuantity.code = #{count}
* extension contains SleepQuality named quality 0..1



// ===== Conteúdo de: MobilityRiskAssessment.fsh =====

Profile: MobilityRiskAssessment
Parent: RiskAssessment
Id: mobility-risk-assessment
Title: "Mobility Risk Assessment Profile"
Description: "Profile for assessing mobility-related risks"

* status MS
* subject 1..1 MS
* occurrence[x] MS
* prediction MS
  * outcome MS
  * probability[x] MS
  * qualitativeRisk MS

* method MS
  * coding ^slicing.discriminator.type = #pattern
  * coding ^slicing.discriminator.path = "$this"
  * coding ^slicing.rules = #open
  * coding contains
      mobilityAssessment 1..1 MS

* method.coding[mobilityAssessment] = https://2rdoc.pt/fhir/CodeSystem/mobility-assessment-method#standardized "Standardized Mobility Assessment"

* prediction ^slicing.discriminator.type = #pattern
* prediction ^slicing.discriminator.path = "outcome"
* prediction ^slicing.rules = #open

* prediction contains
    fallRisk 0..1 MS and
    mobilityDecline 0..1 MS and
    assistanceNeeded 0..1 MS

* prediction[fallRisk].outcome from https://2rdoc.pt/fhir/ValueSet/fall-risk-outcomes
* prediction[fallRisk].probabilityDecimal 0..1 MS
* prediction[fallRisk].qualitativeRisk from https://2rdoc.pt/fhir/ValueSet/risk-level

* prediction[mobilityDecline].outcome from https://2rdoc.pt/fhir/ValueSet/mobility-decline-outcomes
* prediction[mobilityDecline].probabilityDecimal 0..1 MS
* prediction[mobilityDecline].qualitativeRisk from https://2rdoc.pt/fhir/ValueSet/risk-level

* prediction[assistanceNeeded].outcome from https://2rdoc.pt/fhir/ValueSet/assistance-level-outcomes
* prediction[assistanceNeeded].probabilityDecimal 0..1 MS
* prediction[assistanceNeeded].qualitativeRisk from https://2rdoc.pt/fhir/ValueSet/risk-level

* basis only Reference(MobilityProfile or Observation or QuestionnaireResponse)
* basis MS

* note MS



// ===== Conteúdo de: EnvironmentalProfiles.fsh =====

Alias: $SCT = http://snomed.info/sct
Alias: $LOINC = http://loinc.org
Alias: $UCUM = http://unitsofmeasure.org

Profile: EnvironmentalObservation
Parent: Observation
Id: environmental-observation
Title: "Environmental Observation Profile"
Description: "Base profile for environmental measurements from iOS Health App"

* ^version = "0.1.0"
* ^status = #draft
* ^publisher = "HL7 International"
* ^contact.name = "Environmental Health Working Group"

* status MS
* category 1..1 MS
* category = http://terminology.hl7.org/CodeSystem/observation-category#environment
* subject 1..1 MS
* effectiveDateTime 1..1 MS
* device 0..1 MS
* method 0..1 MS
* note 0..* MS

Profile: NoiseExposureObservation
Parent: EnvironmentalObservation
Id: noise-exposure-observation
Title: "Noise Exposure Observation Profile"
Description: "Profile for noise exposure measurements from iOS Health App"

* code = $LOINC#28573-7 "Noise exposure time"
* component ^slicing.discriminator.type = #pattern
* component ^slicing.discriminator.path = "code"
* component ^slicing.rules = #open
* component ^short = "Noise exposure components"
* component ^definition = "Components of noise exposure measurement"

* component contains
    level 1..1 MS and
    duration 1..1 MS and
    peakLevel 0..1 MS and
    backgroundNoise 0..1 MS

* component[level].code = $LOINC#89020-2 "Environmental noise average"
* component[level].valueQuantity.system = $UCUM
* component[level].valueQuantity.code = #dB
* component[level].valueQuantity ^short = "Noise level in decibels"

* component[duration].code = $LOINC#89021-0 "Environmental noise duration"
* component[duration].valueQuantity.system = $UCUM
* component[duration].valueQuantity.code = #min
* component[duration].valueQuantity ^short = "Duration of exposure"

* component[peakLevel].code = $LOINC#89024-4 "Peak sound level"
* component[peakLevel].valueQuantity.system = $UCUM
* component[peakLevel].valueQuantity.code = #dB
* component[peakLevel].valueQuantity ^short = "Peak noise level"

* component[backgroundNoise].code = $LOINC#89025-1 "Background noise level"
* component[backgroundNoise].valueQuantity.system = $UCUM
* component[backgroundNoise].valueQuantity.code = #dB
* component[backgroundNoise].valueQuantity ^short = "Background noise level"

Profile: UVExposureObservation
Parent: EnvironmentalObservation
Id: uv-exposure-observation
Title: "UV Exposure Observation Profile"
Description: "Profile for UV exposure measurements from iOS Health App"

* code = $LOINC#28574-5 "UV exposure"
* component ^slicing.discriminator.type = #pattern
* component ^slicing.discriminator.path = "code"
* component ^slicing.rules = #open
* component ^short = "UV exposure components"
* component ^definition = "Components of UV exposure measurement"

* component contains
    index 1..1 MS and
    duration 1..1 MS and
    timeOfDay 0..1 MS and
    intensity 0..1 MS

* component[index].code = $LOINC#89022-8 "UV index"
* component[index].valueQuantity.system = $UCUM
* component[index].valueQuantity.code = #{index}
* component[index].valueQuantity ^short = "UV index value"

* component[duration].code = $LOINC#89023-6 "UV exposure duration"
* component[duration].valueQuantity.system = $UCUM
* component[duration].valueQuantity.code = #min
* component[duration].valueQuantity ^short = "Duration of UV exposure"

* component[timeOfDay].code = $LOINC#89026-9 "Time of exposure"
* component[timeOfDay].valueDateTime 1..1
* component[timeOfDay].valueDateTime ^short = "Time of UV exposure"

* component[intensity].code = $LOINC#89027-7 "UV intensity"
* component[intensity].valueQuantity.system = $UCUM
* component[intensity].valueQuantity.code = #W/m2
* component[intensity].valueQuantity ^short = "UV radiation intensity"

Extension: EnvironmentalContext
Id: environmental-context
Title: "Environmental Context Extension"
Description: "Additional context about environmental measurements"

* value[x] only CodeableConcept
* valueCodeableConcept from https://2rdoc.pt/fhir/ValueSet/environmental-context (required)



// ===== Conteúdo de: SocialInteractionProfile.fsh =====

Profile: SocialInteractionProfile
Parent: Observation
Id: social-interaction
Title: "Social Interaction Profile"
Description: "Profile for recording social interaction data from iOS Health App"

* ^version = "0.1.0"
* ^status = #active
* ^date = "2024-01-03"
* ^publisher = "FMUP HEADS2"

* status MS
* category 1..1 MS
* category = http://terminology.hl7.org/CodeSystem/observation-category#social-history
* code 1..1 MS
* code = $LOINC#96766-1 "Social interaction pattern"
* subject 1..1 MS
* effectiveDateTime 1..1 MS
* value[x] only CodeableConcept
* valueCodeableConcept from SocialInteractionTypeVS (required)

* component ^slicing.discriminator.type = #pattern
* component ^slicing.discriminator.path = "code"
* component ^slicing.rules = #open

* component contains
    duration 0..1 MS and
    quality 0..1 MS and
    medium 0..1 MS and
    participants 0..1 MS

* component[duration]
  * code = $LOINC#89597-9 "Social interaction duration"
  * valueQuantity only Quantity
  * valueQuantity.system = $UCUM
  * valueQuantity.code = #min

* component[quality]
  * code = $LOINC#89598-7 "Social interaction quality"
  * valueCodeableConcept from SocialInteractionQualityVS (required)

* component[medium]
  * code = $LOINC#89599-5 "Social interaction medium"
  * valueCodeableConcept from SocialInteractionMediumVS (required)

* component[participants]
  * code = $LOINC#89600-1 "Social interaction participants"
  * valueInteger only integer

* extension contains
    SocialContext named context 0..1 MS and
    SocialSupport named support 0..1 MS and
    SocialActivity named activity 0..* MS



// ===== Conteúdo de: StressLevelProfile.fsh =====

Profile: StressLevelProfile
Parent: Observation
Id: stress-level
Title: "Stress Level Profile"
Description: "Profile for recording stress level measurements from iOS Health App"

* ^version = "0.1.0"
* ^status = #active
* ^date = "2024-01-03"
* ^publisher = "FMUP HEADS2"

* status MS
* category 1..1 MS
* category = http://terminology.hl7.org/CodeSystem/observation-category#vital-signs
* code 1..1 MS
* code = $LOINC#89592-0 "Stress level score"
* subject 1..1 MS
* effectiveDateTime 1..1 MS
* value[x] only Quantity
* valueQuantity MS

* component ^slicing.discriminator.type = #pattern
* component ^slicing.discriminator.path = "code"
* component ^slicing.rules = #open

* component contains
    physiologicalStress 0..1 MS and
    psychologicalStress 0..1 MS and
    chronicity 0..1 MS and 
    impact 0..1 MS

* component[physiologicalStress]
  * code = $LOINC#89593-8 "Physiological stress"
  * valueQuantity only Quantity
  * valueQuantity.system = $UCUM
  * valueQuantity.code = #{score}

* component[psychologicalStress]
  * code = $LOINC#89594-6 "Psychological stress"
  * valueQuantity only Quantity
  * valueQuantity.system = $UCUM
  * valueQuantity.code = #{score}

* component[chronicity]
  * code = $LOINC#89595-3 "Stress chronicity"
  * valueCodeableConcept from StressChronicityVS (required)

* component[impact]
  * code = $LOINC#89596-1 "Stress impact"
  * valueCodeableConcept from StressImpactVS (required)

* extension contains
    MeasurementContext named context 0..1 MS and
    StressTriggers named triggers 0..* MS and 
    StressCoping named coping 0..* MS



// ===== Conteúdo de: NutritionProfiles.fsh =====

Alias: $SCT = http://snomed.info/sct
Alias: $LOINC = http://loinc.org
Alias: $UCUM = http://unitsofmeasure.org

Profile: NutritionIntakeObservation
Parent: Observation
Id: nutrition-intake-observation
Title: "Nutrition Intake Observation Profile"
Description: "Profile for nutrition intake data from iOS Health App and user input"

* ^version = "0.1.0"
* ^status = #draft
* ^publisher = "Ricardo Lourenço dos Santos"

* status MS
* category 1..1 MS
* category = http://terminology.hl7.org/CodeSystem/observation-category#nutrition
* subject 1..1 MS
* effectiveDateTime 1..1 MS
* code 1..1 MS
* method 0..1 MS

Profile: WaterIntakeObservation
Parent: NutritionIntakeObservation 
Id: water-intake-observation
Title: "Water Intake Observation Profile"
Description: "Profile for water intake measurements"

* ^version = "0.1.0"
* ^status = #draft
* ^publisher = "Ricardo Lourenço dos Santos"

* code = $LOINC#77111-4 "Water intake"
* valueQuantity only Quantity
* valueQuantity.system = $UCUM
* valueQuantity.code = #mL
* valueQuantity.unit = "milliliter"

Profile: CalorieIntakeObservation
Parent: NutritionIntakeObservation
Id: calorie-intake-observation
Title: "Calorie Intake Observation Profile"
Description: "Profile for caloric intake measurements"

* ^version = "0.1.0"
* ^status = #draft
* ^publisher = "Ricardo Lourenço dos Santos"

* code = $LOINC#9051-4 "Caloric intake total"
* valueQuantity only Quantity
* valueQuantity.system = $UCUM
* valueQuantity.code = #kcal
* valueQuantity.unit = "kilocalorie"

Profile: MacronutrientsObservation
Parent: NutritionIntakeObservation
Id: macronutrients-observation
Title: "Macronutrients Observation Profile"
Description: "Profile for macronutrient intake measurements"

* ^version = "0.1.0"
* ^status = #draft
* ^publisher = "Ricardo Lourenço dos Santos"

* code = $LOINC#LP199119-9 "Macronutrients panel"
* component ^slicing.discriminator.type = #pattern
* component ^slicing.discriminator.path = "code"
* component ^slicing.rules = #open

* component contains
    carbohydrates 0..1 MS and
    proteins 0..1 MS and
    fats 0..1 MS

* component[carbohydrates].code = $LOINC#LP35925-4 "Carbohydrates"
* component[carbohydrates].valueQuantity.system = $UCUM
* component[carbohydrates].valueQuantity.code = #g
* component[carbohydrates].valueQuantity.unit = "gram"

* component[proteins].code = $LOINC#LP35921-3 "Proteins" 
* component[proteins].valueQuantity.system = $UCUM
* component[proteins].valueQuantity.code = #g
* component[proteins].valueQuantity.unit = "gram"

* component[fats].code = $LOINC#LP35922-1 "Fats"
* component[fats].valueQuantity.system = $UCUM
* component[fats].valueQuantity.code = #g
* component[fats].valueQuantity.unit = "gram"



// ===== Conteúdo de: MultiJurisdictionalConsent.fsh =====

// ====== Perfil Multi-Jurisdicional de Consent ======

Profile: MultiJurisdictionalConsent
Parent: Consent
Id: multi-jurisdictional-consent
Title: "Multi-Jurisdictional Healthcare Consent"
Description: "Consent profile supporting GDPR, HIPAA, and LGPD compliance"

* status MS
* scope MS
* category MS
* patient 1..1 MS
* dateTime 1..1 MS

// Múltiplas políticas para diferentes jurisdições
* policy 1..* MS
* policy ^slicing.discriminator.type = #value
* policy ^slicing.discriminator.path = "authority"
* policy ^slicing.rules = #open

* policy contains
    gdpr 0..1 MS and
    hipaa 0..1 MS and
    lgpd 0..1 MS

* policy[gdpr].authority = "https://eur-lex.europa.eu/eli/reg/2016/679/oj"
* policy[gdpr].uri 1..1 MS

* policy[hipaa].authority = "https://www.hhs.gov/hipaa/index.html"  
* policy[hipaa].uri 1..1 MS

* policy[lgpd].authority = "http://www.planalto.gov.br/ccivil_03/_ato2015-2018/2018/lei/L13709compilado.htm"
* policy[lgpd].uri 1..1 MS

// Extensões de compliance
* extension contains
    RegulatoryBasis named regulatoryBasis 0..* MS and
    JurisdictionApplicability named jurisdiction 0..* MS and
    DataLocalization named dataLocalization 0..* MS

// Provisions com segurança
* provision MS
* provision.type MS
* provision.period MS
* provision.actor MS
* provision.action MS
* provision.securityLabel MS
* provision.purpose MS
* provision.dataPeriod MS



// ===== Conteúdo de: MindfulnessMessaging.fsh =====

Alias: $MsgEvents = https://2rdoc.pt/fhir/CodeSystem/mindfulness-message-events
Alias: $MsgTypes = http://terminology.hl7.org/CodeSystem/message-type

Profile: MindfulnessMessageDefinition
Parent: MessageDefinition
Id: mindfulness-message-definition
Title: "Mindfulness Message Definition" 
Description: "Definition for mindfulness session messages"

* url 1..1 MS
* date 1..1 MS
* status 1..1 MS
* event[x] 1..1 MS
* category 0..1 MS
* focus 1..* MS
* focus.min 1..1

Instance: StartSessionMessage
InstanceOf: MindfulnessMessageDefinition
Title: "Start Session Message"
Description: "Message definition for starting a mindfulness session"

* url = "https://2rdoc.pt/ig/ios-lifestyle-medicine/MessageDefinition/start-session"
* date = "2024-03-19"
* status = #active
* eventCoding = $MsgEvents#session-start "Session Start"
* category = #notification
* focus.code = #Observation
* focus.min = 1
* focus.profile = "https://2rdoc.pt/ig/ios-lifestyle-medicine/StructureDefinition/mindfulness-session"

Instance: EndSessionMessage  
InstanceOf: MindfulnessMessageDefinition
Title: "End Session Message"
Description: "Message definition for ending a mindfulness session"

* url = "https://2rdoc.pt/ig/ios-lifestyle-medicine/MessageDefinition/end-session"
* date = "2024-03-19"
* status = #active
* eventCoding = $MsgEvents#session-end "Session End"
* category = #notification
* focus.code = #Observation
* focus.min = 1
* focus.profile = "https://2rdoc.pt/ig/ios-lifestyle-medicine/StructureDefinition/mindfulness-session"



// ===== Conteúdo de: PractitionerNamingSystem.fsh =====

// ====== CodeSystem para Identificadores de Practitioners ======

CodeSystem: PractitionerIdentifierCS
Id: practitioner-identifier-cs
Title: "Practitioner Identifier Code System"
Description: "Sistema de códigos para identificação de practitioners"
* ^status = #active
* ^experimental = false
* ^caseSensitive = true
* #npi "National Provider Identifier" "US National Provider Identifier"
* #crm "Conselho Regional de Medicina" "Brazilian Medical Council Registration"
* #ssin "Social Security Identification Number" "Belgian SSIN"
* #rpps "Répertoire Partagé des Professionnels de Santé" "French Healthcare Professional Registry"

ValueSet: PractitionerIdentifierVS
Id: practitioner-identifier-vs
Title: "Practitioner Identifier Value Set"
Description: "Value set para identificadores de practitioners"
* ^status = #active
* ^experimental = false
* include codes from system PractitionerIdentifierCS



// ===== Conteúdo de: MindfulnessReports.fsh =====

Instance: MindfulnessProgressReport
InstanceOf: Measure
Usage: #definition
Title: "Mindfulness Practice Progress Report"
Description: "Example instance of MindfulnessProgressReport"
* status = #active
* experimental = false
* date = "2024-03-19"
* publisher = "Example Organization"
* description = "Measures progress in mindfulness practice over time"

* scoring = #continuous-variable
* type = #process
* riskAdjustment = "none"
* rateAggregation = "Average values over time period"

* group[0]
  * code = #practice-frequency
  * description = "Frequency of mindfulness practice"
  * population[0]
    * code = #denominator
    * criteria.language = #text/fhirpath
    * criteria.expression = "Observation.where(code.coding.code='711415009')"
  * stratifier[0]
    * code = #weekly
    * criteria.language = #text/fhirpath
    * criteria.expression = "Observation.effective.as(DateTime).truncate(@T).truncate(@W)"

* group[1]
  * code = #stress-reduction
  * description = "Stress level changes over time"
  * population[0]
    * code = #denominator
    * criteria.language = #text/fhirpath
    * criteria.expression = "Observation.where(component.code.coding.code='725854004')"
  * stratifier[0]
    * code = #trend
    * criteria.language = #text/fhirpath
    * criteria.expression = "component.where(code.coding.code='725854004').value.value"

RuleSet: ReportingMetrics
* group[+]
  * code = #session-duration
  * description = "Duration of practice sessions"
  * population[0]
    * code = #denominator
    * criteria.language = #text/fhirpath
    * criteria.expression = "Observation.component.where(code.coding.code='118682006')"
  * stratifier[0]
    * code = #average
    * criteria.language = #text/fhirpath
    * criteria.expression = "component.where(code.coding.code='118682006').value.value"

* group[+]
  * code = #mood-changes
  * description = "Mood state changes"
  * population[0]
    * code = #denominator
    * criteria.language = #text/fhirpath
    * criteria.expression = "Observation.component.where(code.coding.code='373931001')"



// ===== Conteúdo de: MindfulnessCapabilities.fsh =====

Instance: MindfulnessCapabilityStatement
InstanceOf: CapabilityStatement
Usage: #definition
Title: "Mindfulness Module Capabilities"
Description: "Capabilities supported by the mindfulness module implementation"

* status = #draft
* date = "2024-03-19"
* kind = #requirements
* fhirVersion = #4.0.1
* format[0] = #json
* format[1] = #xml

* rest[0]
  * mode = #server
  * documentation = "RESTful server capabilities for mindfulness data"
  
  * resource[0]
    * type = #Observation
    * documentation = "Supports mindfulness session observations"
    * profile = "https://2rdoc.pt/ig/ios-lifestyle-medicine/StructureDefinition/mindfulness-observation"
    * interaction[0]
      * code = #read
    * interaction[1]
      * code = #create
    * interaction[2]
      * code = #update
    * interaction[3]
      * code = #search-type
    * searchParam[0]
      * name = "patient"
      * type = #reference
      * documentation = "Search by patient reference"
    * searchParam[1]
      * name = "date"
      * type = #date
      * documentation = "Search by session date"
    * searchParam[2]
      * name = "code"
      * type = #token
      * documentation = "Search by observation type"
      
  * resource[1]
    * type = #Questionnaire
    * documentation = "Supports mindfulness questionnaires"
    * profile = "https://2rdoc.pt/ig/ios-lifestyle-medicine/StructureDefinition/mindfulness-questionnaire"
    * interaction[0]
      * code = #read
    * interaction[1]
      * code = #search-type
    * searchParam[0]
      * name = "title"
      * type = #string
      * documentation = "Search by questionnaire title"
      
  * resource[2]
    * type = #QuestionnaireResponse
    * documentation = "Supports mindfulness questionnaire responses"
    * profile = "https://2rdoc.pt/ig/ios-lifestyle-medicine/StructureDefinition/mindfulness-questionnaire-response"
    * interaction[0]
      * code = #create
    * interaction[1]
      * code = #read
    * interaction[2]
      * code = #search-type
    * searchParam[0]
      * name = "patient"
      * type = #reference
      * documentation = "Search by patient reference"
    * searchParam[1]
      * name = "authored"
      * type = #date
      * documentation = "Search by response date"



// ===== Conteúdo de: MindfulnessQuestionnaires.fsh =====

Instance: DailyMindfulnessQuestionnaire
InstanceOf: Questionnaire
Usage: #definition
Title: "Daily Mindfulness Questionnaire"
Description: "Questionnaire for capturing daily mindfulness practice and associated effects"

* url = "https://2rdoc.pt/ig/ios-lifestyle-medicine/Questionnaire/daily-mindfulness"
* status = #active
* title = "Daily Mindfulness Practice"
* subjectType = #Patient
* version = "1.0.0"
* name = "DailyMindfulnessQuestionnaire"
* date = "2024-03-19"

* item[0]
  * linkId = "mindful_session"
  * text = "Mindfulness Session"
  * type = #group
  * repeats = false

  * item[0]
    * linkId = "session_duration"
    * text = "Session duration (minutes)"
    * type = #integer
    * required = true
    * extension[0].url = "http://hl7.org/fhir/StructureDefinition/minValue"
    * extension[0].valueInteger = 1

  * item[1]
    * linkId = "practice_type"
    * text = "Practice type"
    * type = #choice
    * required = true
    * answerOption[0].valueString = "Meditation"
    * answerOption[1].valueString = "Breathing exercise"
    * answerOption[2].valueString = "Body scan"
    * answerOption[3].valueString = "Mindful walking"

* item[1]
  * linkId = "mood_assessment"
  * text = "Mood Assessment"
  * type = #group

  * item[0]
    * linkId = "current_mood"
    * text = "How is your mood now?"
    * type = #choice
    * required = true
    * answerValueSet = "https://2rdoc.pt/fhir/ValueSet/mood-vs"

  * item[1]
    * linkId = "mood_intensity"
    * text = "Mood intensity (1-5)"
    * type = #integer
    * required = true

* item[2]
  * linkId = "stress_assessment"
  * text = "Stress Assessment"
  * type = #group

  * item[0]
    * linkId = "stress_level"
    * text = "Stress level (0-10)"
    * type = #integer
    * required = true

  * item[1]
    * linkId = "stress_symptoms"
    * text = "Stress symptoms"
    * type = #choice
    * repeats = true
    * answerOption[0].valueString = "Muscle tension"
    * answerOption[1].valueString = "Anxiety"
    * answerOption[2].valueString = "Headache"
    * answerOption[3].valueString = "Fatigue"

* item[3]
  * linkId = "relaxation"
  * text = "Relaxation"
  * type = #group

  * item[0]
    * linkId = "relaxation_duration"
    * text = "Relaxation time (minutes)"
    * type = #integer
    * required = true

  * item[1]
    * linkId = "relaxation_technique"
    * text = "Technique used"
    * type = #choice
    * required = true
    * answerOption[0].valueString = "Deep breathing"
    * answerOption[1].valueString = "Progressive relaxation"
    * answerOption[2].valueString = "Visualization"
    * answerOption[3].valueString = "Mindful awareness"



// ===== Conteúdo de: NutritionQuestionnaires.fsh =====

Instance: DailyNutritionQuestionnaire
InstanceOf: Questionnaire
Usage: #definition
Title: "Daily Nutrition Intake Questionnaire"
Description: "Questionnaire for daily nutrition intake tracking"

* url = "https://2rdoc.pt/ig/ios-lifestyle-medicine/Questionnaire/daily-nutrition"
* version = "0.1.0"
* name = "DailyNutritionQuestionnaire"
* title = "Daily Nutrition Intake"
* status = #active
* experimental = false
* date = "2024-12-14"
* publisher = "Ricardo Lourenço dos Santos"

* item[0]
  * linkId = "water_intake"
  * text = "How much water did you drink today?"
  * type = #quantity
  * required = true
  * repeats = false
  * initial.valueQuantity = 0 'mL'

* item[1]
  * linkId = "meal_record"
  * text = "Meal Records"
  * type = #group
  * repeats = true

  * item[0]
    * linkId = "meal_time"
    * text = "Meal Time"
    * type = #dateTime
    * required = true

  * item[1]
    * linkId = "meal_type"
    * text = "Meal Type"
    * type = #choice
    * required = true
    * answerOption[0].valueString = "Breakfast"
    * answerOption[1].valueString = "Lunch"
    * answerOption[2].valueString = "Dinner"
    * answerOption[3].valueString = "Snack"

  * item[2]
    * linkId = "calories"
    * text = "Estimated Calories"
    * type = #integer
    * required = true

  * item[3]
    * linkId = "macronutrients"
    * text = "Macronutrients"
    * type = #group

    * item[0]
      * linkId = "carbs"
      * text = "Carbohydrates (g)"
      * type = #decimal
      * required = true

    * item[1]
      * linkId = "protein"
      * text = "Proteins (g)"
      * type = #decimal
      * required = true

    * item[2]
      * linkId = "fat"
      * text = "Fats (g)"
      * type = #decimal
      * required = true

* item[2]
  * linkId = "caffeine"
  * text = "Caffeine Intake"
  * type = #group

  * item[0]
    * linkId = "caffeine_amount"
    * text = "Caffeine amount (mg)"
    * type = #integer
    * required = false

  * item[1]
    * linkId = "caffeine_source"
    * text = "Caffeine source"
    * type = #choice
    * repeats = true
    * answerOption[0].valueString = "Coffee"
    * answerOption[1].valueString = "Tea"
    * answerOption[2].valueString = "Soft Drink"
    * answerOption[3].valueString = "Energy Drink"



// ===== Conteúdo de: ReproductiveQuestionnaire.fsh =====

Instance: ReproductiveHealthQuestionnaire
InstanceOf: Questionnaire
Usage: #definition
Title: "Reproductive Health Tracking Questionnaire"
Description: "Daily questionnaire for reproductive health tracking"
 
* status = #active
* url = "https://2rdoc.pt/ig/ios-lifestyle-medicine/Questionnaire/reproductive-health"
* name = "ReproductiveHealthQuestionnaire"
* title = "Reproductive Health Monitoring"
* date = "2024-03-19"
 
* item[0]
  * linkId = "menstrual_cycle"
  * text = "Menstrual Cycle"
  * type = #group
 
  * item[0]
    * linkId = "cycle_start"
    * text = "Cycle started today?"
    * type = #boolean
 
  * item[1]
    * linkId = "flow_intensity"
    * text = "Flow intensity"
    * type = #choice
    * enableWhen
      * question = "cycle_start"
      * operator = #=
      * answerBoolean = true
    * answerOption[0].valueString = "Light"
    * answerOption[1].valueString = "Moderate"
    * answerOption[2].valueString = "Heavy"
 
* item[1]
  * linkId = "symptoms"
  * text = "Symptoms"
  * type = #group
  * repeats = true
 
  * item[0]
    * linkId = "symptom_type"
    * text = "Symptom type"
    * type = #choice
    * answerValueSet = "https://2rdoc.pt/fhir/ValueSet/reproductive-symptoms"
 
  * item[1]
    * linkId = "symptom_severity"
    * text = "Intensity (0-10)"
    * type = #integer
    * extension[0]
      * url = "http://hl7.org/fhir/StructureDefinition/minValue"
      * valueInteger = 0
    * extension[1]
      * url = "http://hl7.org/fhir/StructureDefinition/maxValue"
      * valueInteger = 10
 
* item[2]
  * linkId = "mood_changes"
  * text = "Mood Changes"
  * type = #group

  * item[0]
    * linkId = "mood_type"
    * text = "Current mood"
    * type = #choice
    * answerValueSet = "https://2rdoc.pt/fhir/ValueSet/mood-types"

  * item[1]
    * linkId = "mood_severity"
    * text = "Intensity (0-10)"
    * type = #integer
    * extension[0]
      * url = "http://hl7.org/fhir/StructureDefinition/minValue"
      * valueInteger = 0
    * extension[1]
      * url = "http://hl7.org/fhir/StructureDefinition/maxValue"
      * valueInteger = 10



// ===== Conteúdo de: aliases.fsh =====

Alias: SCT = http://snomed.info/sct
Alias: LOINC = http://loinc.org
Alias: UCUM = http://unitsofmeasure.org



// ===== Conteúdo de: MindfulnessTerminology.fsh =====

CodeSystem: MindfulnessOutcomeCS
Id: mindfulness-outcome-cs
Title: "Mindfulness Outcomes"
Description: "Outcomes and effects of mindfulness practice"

* ^experimental = false
* ^caseSensitive = true
* #increasedAwareness "Increased Awareness" "Greater awareness of thoughts and sensations"
* #improvedFocus "Improved Focus" "Enhanced ability to concentrate"
* #stressReduction "Stress Reduction" "Decreased levels of stress and tension"
* #emotionalBalance "Emotional Balance" "Better emotional regulation"
* #improvedSleep "Improved Sleep" "Enhanced sleep quality"

ValueSet: MindfulnessOutcomeVS
Id: mindfulness-outcome-vs
Title: "Mindfulness Outcomes Value Set"
Description: "Value set for mindfulness practice outcomes"

* ^experimental = false
* include codes from system MindfulnessOutcomeCS
* include $SCT#365949003 "Finding of level of stress"
* include $SCT#373931001 "Mood finding"

CodeSystem: MindfulnessQualifierCS
Id: mindfulness-qualifier-cs
Title: "Mindfulness Practice Qualifiers"
Description: "Qualifiers for mindfulness practice characteristics"

* ^experimental = false
* ^caseSensitive = true
* #guided "Guided Practice" "Practice with guidance or instruction"
* #selfDirected "Self-Directed" "Independent practice"
* #group "Group Practice" "Practice in group setting"
* #individual "Individual Practice" "Solo practice session"

ValueSet: MindfulnessQualifierVS
Id: mindfulness-qualifier-vs
Title: "Mindfulness Practice Qualifiers Value Set"
Description: "Value set for mindfulness practice qualifiers"

* ^experimental = false
* include codes from system MindfulnessQualifierCS
* include $SCT#410534003 "Guided meditation"
* include $SCT#225386006 "Exercise therapy"

* ^copyright = "This value set includes content from SNOMED CT, which is copyright © 2002+ International Health Terminology Standards Development Organisation (IHTSDO)"



// ===== Conteúdo de: MindfulnessConfig.fsh =====

Extension: MindfulnessSessionDuration
Id: mindfulness-session-duration
Title: "Mindfulness Session Duration"
Description: "Default duration for mindfulness sessions in minutes"
* value[x] only integer

Extension: MindfulnessReminderTime
Id: mindfulness-reminder-time
Title: "Mindfulness Reminder Time"
Description: "Default time for daily reminders"
* value[x] only time

Extension: MindfulnessPreferredGuide
Id: mindfulness-preferred-guide
Title: "Mindfulness Preferred Guide"
Description: "Preferred guide for mindfulness sessions"
* value[x] only string

Extension: MindfulnessNotificationEnabled
Id: mindfulness-notification-enabled
Title: "Mindfulness Notification Enabled"
Description: "Whether notifications are enabled for mindfulness sessions"
* value[x] only boolean

Profile: MindfulnessConfiguration
Parent: Basic
Id: mindfulness-configuration
Title: "Mindfulness Configuration"
Description: "Configuration settings for mindfulness sessions"

* code 1..1 MS
* code = https://2rdoc.pt/fhir/CodeSystem/mindfulness-config-type#settings "Mindfulness Settings"

* extension contains
    MindfulnessSessionDuration named sessionDuration 1..1 MS and
    MindfulnessReminderTime named reminderTime 1..1 MS and
    MindfulnessPreferredGuide named preferredGuide 0..1 MS and
    MindfulnessNotificationEnabled named notificationEnabled 1..1 MS

Instance: DefaultMindfulnessConfig
InstanceOf: MindfulnessConfiguration
Title: "Default Mindfulness Configuration"
Description: "Default configuration settings for mindfulness sessions"

* code = https://2rdoc.pt/fhir/CodeSystem/mindfulness-config-type#settings "Mindfulness Settings"
* extension[sessionDuration].valueInteger = 15
* extension[reminderTime].valueTime = "08:00:00"
* extension[preferredGuide].valueString = "Jane Smith"
* extension[notificationEnabled].valueBoolean = true



// ===== Conteúdo de: MindfulnessAuditConfig.fsh =====

Extension: MindfulnessAuditLevel
Id: mindfulness-audit-level
Title: "Mindfulness Audit Level"
Description: "Level of detail for audit records"
* value[x] only code
* valueCode from https://2rdoc.pt/fhir/ValueSet/audit-levels (required)

Extension: MindfulnessAuditRetention
Id: mindfulness-audit-retention
Title: "Mindfulness Audit Retention"
Description: "Period to retain audit records"
* value[x] only Duration

Extension: MindfulnessAuditFormat
Id: mindfulness-audit-format
Title: "Mindfulness Audit Format"
Description: "Format for audit records"
* value[x] only code
* valueCode from https://2rdoc.pt/fhir/ValueSet/audit-formats (required)

Profile: MindfulnessAuditConfig
Parent: Basic
Id: mindfulness-audit-config
Title: "Mindfulness Audit Configuration"
Description: "Configuration for mindfulness session auditing"

* code 1..1 MS
* code = https://2rdoc.pt/fhir/CodeSystem/mindfulness-config-type#audit "Audit Configuration"

* extension contains
    MindfulnessAuditLevel named auditLevel 1..1 MS and
    MindfulnessAuditRetention named auditRetention 1..1 MS and
    MindfulnessAuditFormat named auditFormat 1..1 MS

Instance: DefaultAuditConfig
InstanceOf: MindfulnessAuditConfig
Title: "Default Audit Configuration"
Description: "Default configuration for mindfulness session auditing"

* code = https://2rdoc.pt/fhir/CodeSystem/mindfulness-config-type#audit "Audit Configuration"
* extension[auditLevel].valueCode = #detailed
* extension[auditRetention].valueDuration = 90 'days'
* extension[auditFormat].valueCode = #fhir



// ===== Conteúdo de: MindfulnessSecurity.fsh =====

// ====== Mindfulness Security and Consent Resources ======

Instance: MindfulnessSecurityDefinition
InstanceOf: Consent
Usage: #example
* status = #active
* scope = $consentscope#patient-privacy "Privacy Consent"
* category[0] = $loinc#59284-0 "Patient Consent"
* patient = Reference(Patient/PatientMindfulness)
* dateTime = "2024-01-01"
* organization = Reference(Organization/Org2RDoc)
* policy[0].authority = "http://terminology.hl7.org/CodeSystem/consentpolicycodes"
* policy[0].uri = "http://terminology.hl7.org/CodeSystem/consentpolicycodes"
* provision.type = #permit
* provision.period.start = "2024-01-01"
* provision.period.end = "2025-12-31"
* provision.actor[0].role = $v3-RoleCode#TREAT "treatment"
* provision.actor[0].reference.identifier.system = "http://terminology.hl7.org/CodeSystem/practitioner-identifier"
* provision.actor[0].reference.identifier.value = "1234567890"
* provision.securityLabel[0] = $v3-Confidentiality#N "normal"
* provision.purpose[0] = $v3-ActReason#TREAT "treatment"
* provision.dataPeriod.start = "2024-01-01"
* provision.dataPeriod.end = "2025-12-31"

Instance: MindfulnessAccessPolicy
InstanceOf: Consent
Usage: #example
* status = #active
* scope = $consentscope#patient-privacy "Privacy Consent"
* category[0] = $loinc#59284-0 "Patient Consent"
* patient = Reference(Patient/PatientMindfulness)
* dateTime = "2024-01-01"
* organization = Reference(Organization/Org2RDoc)

// Políticas multi-jurisdicionais - começando do índice 0
* policy[0].authority = "http://terminology.hl7.org/CodeSystem/consentpolicycodes"
* policy[0].uri = "http://terminology.hl7.org/CodeSystem/consentpolicycodes"

// GDPR - Europa
* policy[1].authority = "https://eur-lex.europa.eu/eli/reg/2016/679/oj"
* policy[1].uri = "https://health.ec.europa.eu/ehealth-digital-health-and-care/european-health-data-space-regulation-ehds_en"

// HIPAA - Estados Unidos
* policy[2].authority = "https://www.hhs.gov/hipaa/index.html"
* policy[2].uri = "https://www.hhs.gov/hipaa/for-professionals/privacy/laws-regulations/index.html"

// LGPD - Brasil
* policy[3].authority = "http://www.planalto.gov.br/ccivil_03/_ato2015-2018/2018/lei/L13709compilado.htm"
* policy[3].uri = "https://www.gov.br/anpd/pt-br/"

* provision.type = #permit
* provision.period.start = "2024-01-01"
* provision.period.end = "2025-12-31"
* provision.actor[0].role = $v3-RoleCode#TREAT "treatment"
* provision.actor[0].reference.identifier.system = "http://terminology.hl7.org/CodeSystem/practitioner-identifier"
* provision.actor[0].reference.identifier.value = "1234567890"
* provision.action[0] = $consentaction#access "Access"
* provision.action[1] = $consentaction#use "Use"
* provision.purpose[0] = $v3-ActReason#TREAT "treatment"
* provision.purpose[1] = $v3-ActReason#HPAYMT "healthcare payment"
* provision.purpose[2] = $v3-ActReason#HOPERAT "healthcare operations"
* provision.dataPeriod.start = "2024-01-01"
* provision.dataPeriod.end = "2025-12-31"

// ====== Aliases para simplificar referências ======
Alias: $consentscope = http://terminology.hl7.org/CodeSystem/consentscope
Alias: $loinc = http://loinc.org
Alias: $v3-RoleCode = http://terminology.hl7.org/CodeSystem/v3-RoleCode
Alias: $v3-Confidentiality = http://terminology.hl7.org/CodeSystem/v3-Confidentiality
Alias: $v3-ActReason = http://terminology.hl7.org/CodeSystem/v3-ActReason
Alias: $consentaction = http://terminology.hl7.org/CodeSystem/consentaction



// ===== Conteúdo de: MindfulnessResources.fsh =====

CodeSystem: MindfulnessTypeCS
Id: mindfulness-type-cs
Title: "Mindfulness Practice Types"
Description: "Types of mindfulness practices and techniques"
* ^experimental = false
* ^caseSensitive = true
* #meditation "Meditation" "Focused meditation practice"
* #breathing "Breathing Exercise" "Conscious breathing techniques"
* #bodyScan "Body Scan" "Progressive body awareness practice"
* #walking "Mindful Walking" "Walking meditation practice"
* #movement "Mindful Movement" "Conscious movement practice"

CodeSystem: EnvironmentTypeCS
Id: environment-type-cs
Title: "Practice Environment Types"
Description: "Types of environments for mindfulness practice"
* ^experimental = false
* ^caseSensitive = true
* #indoor "Indoor" "Indoor environment"
* #outdoor "Outdoor" "Outdoor environment"
* #quiet "Quiet Space" "Quiet or silent environment"
* #group "Group Setting" "Group practice environment"

ValueSet: MindfulnessTypeVS
Id: mindfulness-type-vs
Title: "Mindfulness Practice Types Value Set"
Description: "Value set of mindfulness practice types"
* ^experimental = false
* include codes from system MindfulnessTypeCS

ValueSet: EnvironmentTypeVS
Id: environment-type-vs
Title: "Practice Environment Types Value Set"
Description: "Value set of practice environment types"
* ^experimental = false
* include codes from system EnvironmentTypeCS

Instance: MindfulnessSettingCS
InstanceOf: CodeSystem
Usage: #definition
* url = "https://2rdoc.pt/ig/ios-lifestyle-medicine/CodeSystem/mindfulness-setting"
* version = "1.0.0"
* name = "MindfulnessSettingCS"
* title = "Mindfulness Setting CodeSystem"
* status = #active
* experimental = false
* caseSensitive = true
* content = #complete
* count = 5
* concept[+].code = #home
* concept[=].display = "Home Practice"
* concept[+].code = #clinic
* concept[=].display = "Clinical Setting"
* concept[+].code = #group
* concept[=].display = "Group Setting"
* concept[+].code = #retreat
* concept[=].display = "Retreat Setting"
* concept[+].code = #workplace
* concept[=].display = "Workplace Setting"



// ===== Conteúdo de: MindfulnessNarrative.fsh =====

RuleSet: MindfulnessObservationNarrative
* text.status = #generated
* text.div = "<div xmlns=\"http://www.w3.org/1999/xhtml\">
    <p><b>Generated Narrative</b></p>
    <p><b>Session Type:</b> Mindfulness Practice Session</p>
    <p><b>Date:</b> {effectiveDateTime}</p>
    <p><b>Duration:</b> {component[sessionDuration].value} minutes</p>
    <p><b>Stress Level:</b> {component[stressLevel].value} / 10</p>
    <p><b>Mood:</b> {component[moodState].value}</p>
    <p><b>Technique:</b> {component[relaxationResponse].value}</p>
    <p><b>Location:</b> {extension[mindfulness-context].extension[location].value}</p>
  </div>"

RuleSet: MindfulnessQuestionnaireNarrative
* text.status = #generated
* text.div = "<div xmlns=\"http://www.w3.org/1999/xhtml\">
    <p><b>Generated Narrative</b></p>
    <p><b>Title:</b> {title}</p>
    <p><b>Status:</b> {status}</p>
    <h3>Sections</h3>
    <ul>
      <li>Mindfulness Session</li>
      <li>Mood Assessment</li>
      <li>Stress Assessment</li>
      <li>Relaxation</li>
    </ul>
  </div>"

RuleSet: MindfulnessResponseNarrative
* text.status = #generated
* text.div = "<div xmlns=\"http://www.w3.org/1999/xhtml\">
    <p><b>Generated Narrative</b></p>
    <p><b>Date:</b> {authored}</p>
    <p><b>Session Duration:</b> {item[session_duration].answer.value} minutes</p>
    <p><b>Practice Type:</b> {item[practice_type].answer.value}</p>
    <p><b>Mood:</b> {item[current_mood].answer.value}</p>
    <p><b>Stress Level:</b> {item[stress_level].answer.value} / 10</p>
    <p><b>Relaxation Technique:</b> {item[relaxation_technique].answer.value}</p>
  </div>"

RuleSet: MindfulnessConfigNarrative
* text.status = #generated
* text.div = "<div xmlns=\"http://www.w3.org/1999/xhtml\">
    <p><b>Generated Narrative</b></p>
    <p><b>Default Duration:</b> {extension[defaultDuration].value} minutes</p>
    <p><b>Reminders:</b> {extension[reminderSettings].value}</p>
    <p><b>Data Sync:</b> {extension[dataSync].value}</p>
  </div>"



// ===== Conteúdo de: StressInvariants.fsh =====

Invariant: stress-level-range
Description: "Stress level score must be between 0 and 10"
Expression: "valueQuantity.exists() implies (valueQuantity.value >= 0 and valueQuantity.value <= 10)"
Severity: #error

Invariant: stress-component-consistency
Description: "Physiological and psychological stress scores must be consistent with overall score"
Expression: "component.where(code.coding.code='89593-8').value.exists() and component.where(code.coding.code='89594-6').value.exists() implies (component.where(code.coding.code='89593-8').value + component.where(code.coding.code='89594-6').value) div 2 = valueQuantity"
Severity: #warning



// ===== Conteúdo de: SocialInteractionInvariants.fsh =====

Invariant: social-interaction-duration
Description: "Social interaction duration must be positive"
Expression: "component.where(code.coding.code='89597-9').value.exists() implies component.where(code.coding.code='89597-9').value > 0"
Severity: #error

Invariant: social-interaction-participants
Description: "Number of participants must be at least 2 for social interaction"
Expression: "component.where(code.coding.code='89600-1').value.exists() implies component.where(code.coding.code='89600-1').value >= 2"
Severity: #error



// ===== Conteúdo de: MindfulnessInvariants.fsh =====

Invariant: mindfulness-session-duration
Description: "Mindfulness session duration must be between 1 and 180 minutes"
Expression: "component.where(code.coding.system='http://snomed.info/sct' and code.coding.code='118682006').value.ofType(Quantity).value.exists() implies (component.where(code.coding.system='http://snomed.info/sct' and code.coding.code='118682006').value.ofType(Quantity).value >= 1 and component.where(code.coding.system='http://snomed.info/sct' and code.coding.code='118682006').value.ofType(Quantity).value <= 180)"
Severity: #error

Invariant: mindfulness-stress-level
Description: "Stress level must be between 0 and 10"
Expression: "component.where(code.coding.system='http://snomed.info/sct' and code.coding.code='725854004').value.ofType(Integer).exists() implies (component.where(code.coding.system='http://snomed.info/sct' and code.coding.code='725854004').value.ofType(Integer) >= 0 and component.where(code.coding.system='http://snomed.info/sct' and code.coding.code='725854004').value.ofType(Integer) <= 10)"
Severity: #error

Invariant: mindfulness-mood-required
Description: "Mood assessment must include a mood state and intensity"
Expression: "component.where(code.coding.system='http://snomed.info/sct' and code.coding.code='373931001').exists() implies component.where(code.coding.system='http://snomed.info/sct' and code.coding.code='373931001').value.exists()"
Severity: #warning

Invariant: mindfulness-context-complete
Description: "Mindfulness context should include location and environment"
Expression: "extension.where(url='https://2rdoc.pt/ig/ios-lifestyle-medicine/StructureDefinition/mindfulness-context').exists() implies (extension.where(url='https://2rdoc.pt/ig/ios-lifestyle-medicine/StructureDefinition/mindfulness-context').extension.where(url='location').exists() and extension.where(url='https://2rdoc.pt/ig/ios-lifestyle-medicine/StructureDefinition/mindfulness-context').extension.where(url='environment').exists())"
Severity: #warning

Invariant: sequential-measurements
Description: "Sequential measurements must have increasing effectiveDateTime"
Expression: "component.where(code.coding.system='http://snomed.info/sct' and code.coding.code='118682006').exists() implies (effectiveDateTime > previous().effectiveDateTime)"
Severity: #warning



// ===== Conteúdo de: MindfulnessOperations.fsh =====

Profile: MindfulnessOperation
Parent: OperationDefinition 
Id: mindfulness-operation
Title: "Mindfulness Operation"
Description: "Base definition for mindfulness operations"

* status 1..1
* kind 1..1
* name 1..1
* code 1..1
* resource 1..1
* system 1..1
* type 1..1
* instance 1..1
* parameter 0..*
* parameter.name 1..1

Instance: StartSessionOperation
InstanceOf: MindfulnessOperation
Title: "Start Session Operation"
Description: "Operation to start a new mindfulness session"

* status = #active
* kind = #operation
* name = "start-session"
* code = #start
* resource = #Observation
* system = false
* type = true
* instance = false
* parameter[+]
  * name = #duration
  * use = #in
  * min = 1
  * max = "1" 
  * type = #integer
  * documentation = "Duration in minutes"

Instance: EndSessionOperation
InstanceOf: MindfulnessOperation
Title: "End Session Operation"
Description: "Operation to end an ongoing mindfulness session"

* status = #active
* kind = #operation
* name = "end-session"
* code = #end
* resource = #Observation
* system = false
* type = true
* instance = true
* parameter[+]
  * name = #session
  * use = #in
  * min = 1
  * max = "1"
  * type = #string
  * documentation = "ID of the session to end"



// ===== Conteúdo de: VitalSignsExtensions.fsh =====

Extension: MeasurementContext
Id: measurement-context
Title: "Measurement Context Extension"
* ^experimental = falseDescription: "Additional context about the vital sign measurement"
* value[x] only CodeableConcept
* valueCodeableConcept from MeasurementContextVS (required)

ValueSet: MeasurementContextVitalSigns
Id: measurement-context-vital-signs
Description: "Value set for measurement context in vital signs observations"Title: "Measurement Context Value Set"
* $SCT#255214003 "At rest"
* $SCT#309604004 "During exercise"
* $SCT#309605003 "Post exercise"
* $SCT#248626006 "During sleep"



// ===== Conteúdo de: NutritionExtensions.fsh =====

Extension: NutritionDataSource
Id: nutrition-data-source
Title: "Nutrition Data Source Extension"
Description: "Indicates the source of nutrition data"

* ^version = "0.1.0"
* ^status = #draft
* ^experimental = false
* ^date = "2024-12-14"
* ^publisher = "Ricardo Lourenço dos Santos"
* ^context[0].type = #element
* ^context[0].expression = "Observation"

* value[x] only CodeableConcept
* valueCodeableConcept from NutritionDataSourceVS (required)

ValueSet: NutritionDataSourceVS
Id: nutrition-data-source-vs
Title: "Nutrition Data Source Value Set"
Description: "Value set for nutrition data sources"

* ^version = "0.1.0"
* ^status = #draft
* ^experimental = false
* ^date = "2024-12-14"
* ^publisher = "Ricardo Lourenço dos Santos"

* codes from system NutritionDataSourceCS

CodeSystem: NutritionDataSourceCS
Id: nutrition-data-source-cs
Title: "Nutrition Data Source Code System"
Description: "Code system for nutrition data sources"

* ^version = "0.1.0"
* ^status = #draft
* ^experimental = false
* ^date = "2024-12-14"
* ^publisher = "Ricardo Lourenço dos Santos"
* ^caseSensitive = true

* #manual "Manual Entry" "Data entered manually by user"
* #app "App Integration" "Data from integrated third-party apps"
* #device "Connected Device" "Data from connected nutrition tracking devices"
* #questionnaire "Questionnaire Response" "Data collected through questionnaires"



// ===== Conteúdo de: AdvancedVitalSignsExtensions.fsh =====

Alias: $UCUM = http://unitsofmeasure.org

Extension: PhysiologicalStressIndex
Id: physiological-stress-index
Title: "Physiological Stress Index Extension"
Description: "Index representing overall physiological stress based on multiple parameters"

* ^version = "0.1.0"
* ^status = #draft
* ^context[+].type = #element
* ^context[=].expression = "Observation"

* value[x] only Quantity
* valueQuantity.system = $UCUM
* valueQuantity.code = #{index}
* valueQuantity ^short = "Physiological stress index value"
* valueQuantity ^definition = "Normalized index value representing overall physiological stress"

Extension: HomeostasisIndex
Id: homeostasis-index
Title: "Homeostasis Index Extension"
Description: "Composite measure of physiological balance and adaptation"

* ^version = "0.1.0"
* ^status = #draft
* ^context[+].type = #element
* ^context[=].expression = "Observation"

* value[x] only Quantity
* valueQuantity.system = $UCUM
* valueQuantity.code = #{ratio}
* valueQuantity ^short = "Homeostasis index value"
* valueQuantity ^definition = "Normalized ratio representing physiological balance"

Extension: RecoveryEfficiency
Id: recovery-efficiency
Title: "Recovery Efficiency Extension"
Description: "Measure of how efficiently the body recovers from stress or exertion"

* ^version = "0.1.0"
* ^status = #draft
* ^context[+].type = #element
* ^context[=].expression = "Observation"

* value[x] only Quantity
* valueQuantity.system = $UCUM
* valueQuantity.code = #%
* valueQuantity ^short = "Recovery efficiency percentage"
* valueQuantity ^definition = "Percentage indicating recovery efficiency"

Extension: AllostaticLoad
Id: allostatic-load
Title: "Allostatic Load Extension"
Description: "Measure of cumulative physiological burden over time"

* ^version = "0.1.0"
* ^status = #draft
* ^context[+].type = #element
* ^context[=].expression = "Observation"

* value[x] only Quantity
* valueQuantity.system = $UCUM
* valueQuantity.code = #{score}
* valueQuantity ^short = "Allostatic load score"
* valueQuantity ^definition = "Score representing cumulative physiological burden"

Extension: CircadianPhase
Id: circadian-phase
Title: "Circadian Phase Extension"
Description: "Indicator of position in circadian rhythm cycle"

* ^version = "0.1.0"
* ^status = #draft
* ^context[+].type = #element
* ^context[=].expression = "Observation"

* value[x] only CodeableConcept
* valueCodeableConcept from CircadianPhaseVS (required)

ValueSet: CircadianPhaseVS
Id: circadian-phase-vs
Title: "Circadian Phase Value Set"
Description: "Value set for circadian rhythm phases"

* ^experimental = true
* codes from system CircadianPhaseCS

CodeSystem: CircadianPhaseCS
Id: circadian-phase-cs
Title: "Circadian Phase Code System"
Description: "Code system for circadian rhythm phases"

* ^experimental = true
* ^caseSensitive = true

* #early-morning "Early Morning Phase" "Period shortly after awakening"
* #mid-morning "Mid Morning Phase" "Mid-morning period"
* #afternoon "Afternoon Phase" "Afternoon period"
* #evening "Evening Phase" "Evening period"
* #night "Night Phase" "Nighttime period"
* #deep-night "Deep Night Phase" "Deep night period"

Extension: MeasurementQuality
Id: measurement-quality
Title: "Measurement Quality Extension"
Description: "Indicator of the quality and reliability of the measurement"

* ^version = "0.1.0"
* ^status = #draft
* ^context[+].type = #element
* ^context[=].expression = "Observation"

* value[x] only CodeableConcept
* valueCodeableConcept from MeasurementQualityVS (required)

ValueSet: MeasurementQualityVS
Id: measurement-quality-vs
Title: "Measurement Quality Value Set"
Description: "Value set for measurement quality indicators"

* ^experimental = true
* codes from system MeasurementQualityCS

CodeSystem: MeasurementQualityCS
Id: measurement-quality-cs
Title: "Measurement Quality Code System"
Description: "Code system for measurement quality indicators"

* ^experimental = true
* ^caseSensitive = true

* #excellent "Excellent Quality" "High quality measurement with minimal noise"
* #good "Good Quality" "Good quality measurement with acceptable noise"
* #fair "Fair Quality" "Fair quality measurement with some interference"
* #poor "Poor Quality" "Poor quality measurement with significant interference"
* #unreliable "Unreliable" "Unreliable measurement requiring verification"



// ===== Conteúdo de: StressExtensions.fsh =====

Extension: StressTriggers
Id: stress-triggers
Title: "Stress Triggers Extension"
* ^experimental = falseDescription: "Extension for recording identified stress triggers"
* value[x] only CodeableConcept
* valueCodeableConcept from StressTriggersVS (required)

Extension: StressCoping
Id: stress-coping
Title: "Stress Coping Extension"
* ^experimental = falseDescription: "Extension for recording stress coping mechanisms"
* value[x] only CodeableConcept
* valueCodeableConcept from StressCopingVS (required)

ValueSet: StressTriggersVS
Id: stress-triggers-vs
Title: "Stress Triggers Value Set"
* ^experimental = falseDescription: "Value set for common stress triggers"
* codes from system StressTriggersCS

ValueSet: StressCopingVS
Id: stress-coping-vs
Title: "Stress Coping Value Set"
* ^experimental = falseDescription: "Value set for stress coping mechanisms"
* codes from system StressCopingCS

CodeSystem: StressTriggersCS
Id: stress-triggers-cs
Title: "Stress Triggers Code System"
* ^experimental = falseDescription: "Code system for common stress triggers"
* #work "Work-related" "Stress from work or professional activities"
* #financial "Financial" "Financial-related stress"
* #relationships "Relationships" "Stress from personal relationships"
* #health "Health" "Health-related concerns"
* #environment "Environmental" "Environmental factors"
* #time "Time Management" "Time pressure and deadlines"
* #change "Life Changes" "Major life changes or transitions"

CodeSystem: StressCopingCS
Id: stress-coping-cs
Title: "Stress Coping Code System"
* ^experimental = falseDescription: "Code system for stress coping mechanisms"
* #exercise "Physical Exercise" "Using exercise to manage stress"
* #meditation "Meditation" "Meditation and mindfulness practices"
* #social "Social Support" "Seeking social support"
* #professional "Professional Help" "Seeking professional assistance"
* #relaxation "Relaxation" "Relaxation techniques"
* #creative "Creative Activities" "Engaging in creative activities"
* #nature "Nature" "Spending time in nature"



// ===== Conteúdo de: EnvironmentalExtensions.fsh =====

Extension: ExposureLocation
Id: exposure-location
Title: "Exposure Location Extension"
Description: "Extension for recording location of environmental exposure measurement"

* ^version = "0.1.0"
* ^status = #draft
* ^context[+].type = #element
* ^context[=].expression = "Observation"

* value[x] only CodeableConcept
* valueCodeableConcept from ExposureLocationVS (required)
* valueCodeableConcept ^short = "Location type of exposure"
* valueCodeableConcept ^definition = "Categorizes the type of location where environmental exposure occurred"

Extension: ExposureConditions
Id: exposure-conditions
Title: "Exposure Conditions Extension"
Description: "Additional conditions during environmental exposure measurement"

* ^version = "0.1.0"
* ^status = #draft
* ^context[+].type = #element
* ^context[=].expression = "Observation"

* value[x] only CodeableConcept
* valueCodeableConcept from ExposureConditionsVS (required)
* valueCodeableConcept ^short = "Conditions during exposure"

ValueSet: ExposureLocationVS
Id: exposure-location-vs
Title: "Exposure Location Value Set"
Description: "Value set for environmental exposure locations"

* ^version = "0.1.0"
* ^status = #draft
* ^experimental = true
* codes from system ExposureLocationCS

ValueSet: ExposureConditionsVS
Id: exposure-conditions-vs
Title: "Exposure Conditions Value Set"
Description: "Value set for environmental exposure conditions"

* ^version = "0.1.0"
* ^status = #draft
* ^experimental = true
* codes from system ExposureConditionsCS

CodeSystem: ExposureLocationCS
Id: exposure-location-cs
Title: "Exposure Location Code System"
Description: "Code system for environmental exposure locations"

* ^version = "0.1.0"
* ^status = #draft
* ^caseSensitive = true
* ^experimental = true

* #indoor "Indoor environment" "Environment within buildings or enclosed spaces"
* #outdoor "Outdoor environment" "Open-air environment"
* #workplace "Workplace" "Professional or occupational environment"
* #transit "In transit" "While in transportation or commuting"
* #recreational "Recreational area" "Leisure or sports facilities"
* #urban "Urban area" "City or densely populated area"
* #rural "Rural area" "Countryside or sparsely populated area"

CodeSystem: ExposureConditionsCS
Id: exposure-conditions-cs
Title: "Exposure Conditions Code System"
Description: "Code system for conditions during environmental exposure"

* ^version = "0.1.0"
* ^status = #draft
* ^caseSensitive = true
* ^experimental = true

* #normal "Normal conditions" "Standard environmental conditions"
* #extreme "Extreme conditions" "Unusual or severe environmental conditions"
* #controlled "Controlled environment" "Environment with controlled conditions"
* #variable "Variable conditions" "Changing environmental conditions"



// ===== Conteúdo de: BodyMetricsExtensions.fsh =====

Alias: $SCT = http://snomed.info/sct

Extension: MeasurementConditions
Id: measurement-conditions
Title: "Measurement Conditions Extension"
* ^experimental = falseDescription: "Records the conditions under which body measurements were taken"

* ^version = "0.1.0"
* ^status = #draft
* ^context[0].type = #element
* ^context[0].expression = "Observation"

* value[x] only CodeableConcept
* valueCodeableConcept from MeasurementConditionsVS (required)

Extension: MeasurementDevice
Id: measurement-device-type
Title: "Measurement Device Type Extension"
* ^experimental = falseDescription: "Specifies the type of device used for body measurements"

* ^version = "0.1.0"
* ^status = #draft
* ^context[0].type = #element
* ^context[0].expression = "Observation"

* value[x] only CodeableConcept
* valueCodeableConcept from MeasurementDeviceTypeVS (required)

ValueSet: MeasurementConditionsVS
Id: measurement-conditions-vs
Title: "Measurement Conditions Value Set"
* ^experimental = falseDescription: "Standard conditions under which measurements are taken"

* ^version = "0.1.0"
* ^status = #draft

* $SCT#307818003 "Pre-breakfast"
* $SCT#307819006 "Post-exercise"
* $SCT#307820000 "Wearing light clothing"
* $SCT#255203001 "First thing in morning"
* $SCT#255214005 "After void"
* $SCT#309604004 "During rest"

ValueSet: MeasurementDeviceTypeVS
Id: measurement-device-type-vs
Title: "Measurement Device Type Value Set"
* ^experimental = falseDescription: "Types of devices used for health and body measurements"

* ^version = "0.1.0"
* ^status = #draft

* $SCT#469576000 "Smart watch"
* $SCT#706767009 "Patient data recorder"
* $SCT#131009002 "Height measuring device"
* $SCT#706889009 "Blood pressure monitor"
* $SCT#444699000 "Tape measure"
* $SCT#44056008  "Digital scale"

Instance: WeightWithConditions
InstanceOf: WeightObservation
Usage: #example
Description: "Weight with conditions observation example"
Title: "Weight Measurement with Conditions Example"

* status = #final
* category = http://terminology.hl7.org/CodeSystem/observation-category#vital-signs
* code = $LOINC#29463-7 "Body weight"
* subject = Reference(Patient/example)
* effectiveDateTime = "2024-03-19T08:00:00Z"
* valueQuantity = 70.5 'kg'

* extension[measurement-conditions].url = "https://2rdoc.pt/ig/ios-lifestyle-medicine/StructureDefinition/measurement-conditions"
* extension[measurement-conditions].valueCodeableConcept = $SCT#307818003 "Pre-breakfast"

* extension[measurement-device-type].url = "https://2rdoc.pt/ig/ios-lifestyle-medicine/StructureDefinition/measurement-device-type"
* extension[measurement-device-type].valueCodeableConcept = $SCT#469576000 "Smart scale device"



// ===== Conteúdo de: SleepQuality.fsh =====

Extension: SleepQuality
Id: sleep-quality
Title: "Sleep Quality Extension"
* ^experimental = falseDescription: "Extension for recording subjective sleep quality"
* value[x] only CodeableConcept
* valueCodeableConcept from SleepQualityExtendedVS (required)
 
ValueSet: SleepQualityExtendedVS
Id: sleep-quality-extended-vs
Description: "Extended value set for sleep quality assessment"Title: "Sleep Quality Value Set"
* $SCT#248220008 "Very good quality sleep"
* $SCT#248221007 "Good quality sleep"
* $SCT#248222000 "Poor quality sleep"
* $SCT#248223005 "Very poor quality sleep"



// ===== Conteúdo de: MindfulnessExtensions.fsh =====

Extension: MindfulnessContext
Id: mindfulness-context
Title: "Mindfulness Session Context"
Description: "Additional context about the mindfulness practice session"

* ^url = "https://2rdoc.pt/ig/ios-lifestyle-medicine/StructureDefinition/mindfulness-context"
* ^version = "1.0.0"
* ^status = #draft
* ^date = "2024-03-19"
* ^publisher = "Example Organization"

* extension contains
    location 0..1 and
    environment 0..1 and
    guidance 0..1

* extension[location].value[x] only string
* extension[location].valueString 1..1
* extension[location] ^short = "Physical location of practice"
* extension[location] ^definition = "The physical location where the mindfulness practice took place"

* extension[environment].value[x] only CodeableConcept
* extension[environment].valueCodeableConcept from https://2rdoc.pt/fhir/ValueSet/environment-type (required)
* extension[environment] ^short = "Environmental conditions"
* extension[environment] ^definition = "The environmental conditions during the practice session"

* extension[guidance].value[x] only boolean
* extension[guidance].valueBoolean 1..1
* extension[guidance] ^short = "Whether guidance was used"
* extension[guidance] ^definition = "Indicates if the session was guided or self-directed"



// ===== Conteúdo de: SocialInteractionExtensions.fsh =====

Extension: SocialContext
Id: social-context
Title: "Social Context Extension"
* ^experimental = falseDescription: "Extension for recording the context of social interaction"
* value[x] only CodeableConcept
* valueCodeableConcept from SocialContextVS (required)

Extension: SocialSupport
Id: social-support
Title: "Social Support Extension"
* ^experimental = falseDescription: "Extension for recording perceived social support"
* value[x] only CodeableConcept
* valueCodeableConcept from SocialSupportVS (required)

Extension: SocialActivity
Id: social-activity
Title: "Social Activity Extension"
* ^experimental = falseDescription: "Extension for recording specific social activities"
* value[x] only CodeableConcept
* valueCodeableConcept from SocialActivityVS (required)

ValueSet: SocialContextVS
Id: social-context-vs
Title: "Social Context Value Set"
* ^experimental = falseDescription: "Value set for social interaction contexts"
* codes from system SocialContextCS

ValueSet: SocialSupportVS
Id: social-support-vs
Title: "Social Support Value Set"
* ^experimental = falseDescription: "Value set for levels of social support"
* codes from system SocialSupportCS

ValueSet: SocialActivityVS
Id: social-activity-vs
Title: "Social Activity Value Set"
* ^experimental = falseDescription: "Value set for types of social activities"
* codes from system SocialActivityCS

CodeSystem: SocialContextCS
Id: social-context-cs
Title: "Social Context Code System"
* ^experimental = falseDescription: "Code system for social interaction contexts"
* #home "Home" "Home environment"
* #work "Work" "Work environment"
* #education "Educational" "Educational setting"
* #community "Community" "Community setting"
* #recreational "Recreational" "Recreational setting"
* #healthcare "Healthcare" "Healthcare setting"

CodeSystem: SocialSupportCS
Id: social-support-cs
Title: "Social Support Code System"
* ^experimental = falseDescription: "Code system for levels of social support"
* #strong "Strong Support" "Strong social support network"
* #adequate "Adequate Support" "Sufficient social support"
* #limited "Limited Support" "Limited social support"
* #minimal "Minimal Support" "Minimal social support"
* #none "No Support" "Absence of social support"

CodeSystem: SocialActivityCS
Id: social-activity-cs
Title: "Social Activity Code System"
* ^experimental = falseDescription: "Code system for types of social activities"
* #meal "Shared Meal" "Sharing a meal together"
* #exercise "Group Exercise" "Group physical activity"
* #entertainment "Entertainment" "Shared entertainment activity"
* #learning "Learning" "Group learning activity"
* #volunteering "Volunteering" "Community service activity"
* #celebration "Celebration" "Social celebration or event"



// ===== Conteúdo de: SleepExtensions.fsh =====




// ===== Conteúdo de: ComplianceExtensions.fsh =====

// ====== Extensões de Compliance Multi-Jurisdicional ======

Extension: RegulatoryBasis
Id: regulatory-basis
Title: "Regulatory Basis for Consent"
Description: "Identifies the regulatory framework(s) that govern this consent"
* value[x] only CodeableConcept
* valueCodeableConcept from RegulatoryFrameworkVS (extensible)

Extension: JurisdictionApplicability  
Id: jurisdiction-applicability
Title: "Jurisdiction Applicability"
Description: "Specifies which jurisdictions this consent applies to"
* value[x] only CodeableConcept
* valueCodeableConcept from http://hl7.org/fhir/ValueSet/jurisdiction (extensible)

Extension: DataLocalization
Id: data-localization
Title: "Data Localization Requirements"
Description: "Specifies data localization requirements per jurisdiction"
* extension contains
    jurisdiction 1..1 MS and
    storageLocation 1..1 MS and
    residencyRequired 1..1 MS
* extension[jurisdiction].value[x] only CodeableConcept
* extension[storageLocation].value[x] only string
* extension[residencyRequired].value[x] only boolean

// ====== ValueSets de Compliance ======

ValueSet: RegulatoryFrameworkVS
Id: regulatory-framework-vs
Title: "Regulatory Framework Value Set"
Description: "Regulatory frameworks for healthcare data protection"
* ^experimental = false
* include codes from system RegulatoryFrameworkCS

CodeSystem: RegulatoryFrameworkCS
Id: regulatory-framework-cs
Title: "Regulatory Framework Code System"
Description: "Codes for healthcare regulatory frameworks"
* ^experimental = false
* ^caseSensitive = true
* #gdpr "GDPR - General Data Protection Regulation" "European Union data protection regulation"
* #hipaa "HIPAA - Health Insurance Portability and Accountability Act" "United States healthcare privacy law"
* #lgpd "LGPD - Lei Geral de Proteção de Dados" "Brazilian general data protection law"
* #pipeda "PIPEDA - Personal Information Protection and Electronic Documents Act" "Canadian privacy law"
* #ehds "EHDS - European Health Data Space" "European health data framework"



// ===== Conteúdo de: MobilityExtensions.fsh =====

Extension: MobilityAlertLevel
Id: mobility-alert-level
Title: "Mobility Alert Level Extension"
Description: "Extension for mobility measurements alert levels to indicate the severity or concern level of mobility changes detected by the device"
* ^status = #active
* ^context[0].type = #element
* ^context[0].expression = "Observation"
* . ^short = "Mobility alert level indicator"
* . ^definition = "Indicates the severity level of mobility changes or concerns based on device measurements"
* value[x] only CodeableConcept
* valueCodeableConcept from MobilityAlertLevelVS (required)
* valueCodeableConcept ^short = "Alert level code"
* valueCodeableConcept ^definition = "The specific alert level code indicating the severity of mobility changes"

ValueSet: MobilityAlertLevelVS
Id: mobility-alert-level-vs
Title: "Mobility Alert Level Value Set"
Description: "Value set for mobility measurement alert levels used to categorize the severity of mobility changes or concerns"
* ^status = #active
* ^experimental = false
* ^purpose = "To provide standardized alert levels for mobility measurements"
* codes from system MobilityAlertLevelCS

CodeSystem: MobilityAlertLevelCS
Id: mobility-alert-level-cs
Title: "Mobility Alert Level Code System"
Description: "Code system defining alert levels for mobility measurements, indicating the severity of changes in mobility patterns"
* ^status = #active
* ^experimental = false
* ^caseSensitive = true
* ^content = #complete
* #green "Normal - No concern" "Mobility measurements are within normal range and show no concerning patterns"
* #yellow "Caution - Monitor closely" "Mobility measurements show slight deviations that warrant closer monitoring"
* #red "Alert - Significant change" "Mobility measurements indicate significant changes that require immediate attention"
* ^property[0].code = #status
* ^property[0].type = #code
* ^property[0].description = "The status of the alert level"
* ^property[1].code = #severity
* ^property[1].type = #integer
* ^property[1].description = "Numeric value indicating severity (1=low, 3=high)"



// ===== Conteúdo de: ActivityExtensions.fsh =====




// ===== Conteúdo de: MobilityRiskValueSets.fsh =====

ValueSet: FallRiskOutcomesValueSet
Id: fall-risk-outcomes
Title: "Fall Risk Outcomes Value Set"
* ^experimental = falseDescription: "Value set for fall risk assessment outcomes"
* ^url = "https://2rdoc.pt/fhir/ValueSet/fall-risk-outcomes"
* ^status = #active
* include codes from system https://2rdoc.pt/fhir/CodeSystem/fall-risk-outcomes

ValueSet: RiskLevelValueSet
Id: risk-level
Title: "Risk Level Value Set"
* ^experimental = falseDescription: "Value set for general risk levels"
* ^url = "https://2rdoc.pt/fhir/ValueSet/risk-level"
* ^status = #active
* include codes from system https://2rdoc.pt/fhir/CodeSystem/risk-level

ValueSet: MobilityDeclineOutcomesValueSet
Id: mobility-decline-outcomes
Title: "Mobility Decline Outcomes Value Set"
* ^experimental = falseDescription: "Value set for mobility decline assessment outcomes"
* ^url = "https://2rdoc.pt/fhir/ValueSet/mobility-decline-outcomes"
* ^status = #active
* include codes from system https://2rdoc.pt/fhir/CodeSystem/mobility-decline-outcomes

ValueSet: AssistanceLevelOutcomesValueSet
Id: assistance-level-outcomes
Title: "Assistance Level Outcomes Value Set"
* ^experimental = falseDescription: "Value set for assistance level assessment outcomes"
* ^url = "https://2rdoc.pt/fhir/ValueSet/assistance-level-outcomes"
* ^status = #active
* include codes from system https://2rdoc.pt/fhir/CodeSystem/assistance-level-outcomes



// ===== Conteúdo de: SymptomValueSets.fsh =====

CodeSystem: SymptomSeverityCS
Id: symptom-severity-cs
Title: "Symptom Severity Code System"
* ^experimental = falseDescription: "Severity levels for symptoms"

* #1-3 "Light" "Symptom barely noticeable"
* #4-6 "Mild" "Symptom noticeable but not interfering with daily activities"
* #7-8 "Intense" "Symptom interfering with daily activities"
* #9-10 "Severe" "Symptom preventing daily activities"

ValueSet: BodyLocationsVS
Id: body-locations-vs
Title: "Body Locations Value Set"
* ^experimental = falseDescription: "Anatomical locations for symptom recording"
* $SCT#12738006 "Brain"
* $SCT#69536005 "Head"
* $SCT#45048000 "Neck"
* $SCT#51185008 "Chest"
* $SCT#62413002 "Abdomen"
* $SCT#32849002 "Back"
* $SCT#53120007 "Upper limb"
* $SCT#61685007 "Lower limb"

ValueSet: DurationUnitsVS
Id: duration-units-vs
Title: "Duration Units Value Set"
* ^experimental = falseDescription: "Time units for symptom duration"
* $UCUM#min "Minutes"
* $UCUM#h "Hours"
* $UCUM#d "Days"
* $UCUM#wk "Weeks"
* $UCUM#mo "Months"

CodeSystem: SymptomFrequencyCS
Id: symptom-frequency-cs
Title: "Symptom Frequency Code System"
* ^experimental = falseDescription: "Frequency patterns for symptoms"
* #rare "Rare" "Less than once per month"
* #occasional "Occasional" "Several times per month"
* #frequent "Frequent" "Several times per week"
* #daily "Daily" "Once or more per day"
* #constant "Constant" "Present most of the time"

ValueSet: SymptomFrequencyVS
Id: symptom-frequency-vs
Title: "Symptom Frequency Value Set"
* ^experimental = falseDescription: "Frequency patterns for symptoms"
* codes from system SymptomFrequencyCS

CodeSystem: SymptomImpactCS
Id: symptom-impact-cs
Title: "Symptom Impact Code System"
* ^experimental = falseDescription: "Impact levels of symptoms on daily activities"
* #none "No impact"
* #mild "Mild impact"
* #moderate "Moderate impact"
* #severe "Severe impact"
* #complete "Complete impact"

ValueSet: SymptomImpactVS
Id: symptom-impact-vs
Title: "Symptom Impact Value Set"
* ^experimental = falseDescription: "Impact levels for symptoms"
* codes from system SymptomImpactCS

ValueSet: SymptomProgressionVS
Id: symptom-progression-vs
Title: "Symptom Progression Value Set"
* ^experimental = falseDescription: "Progression patterns for symptoms"
* $SCT#385633008 "Improving"
* $SCT#58158008 "Stable"
* $SCT#230993007 "Worsening"
* $SCT#255314001 "Fluctuating"

ValueSet: TimeOfDayVS
Id: time-of-day-vs
Title: "Time of Day Value Set"
* ^experimental = falseDescription: "Times of day for symptom occurrence"
* $SCT#73775008 "Morning"
* $SCT#255214003 "After exercise"
* $SCT#2546009 "Evening"
* $SCT#73775008 "Morning"



// ===== Conteúdo de: StressValueSets.fsh =====

ValueSet: StressChronicityVS
Id: stress-chronicity-vs
Title: "Stress Chronicity Value Set"
* ^experimental = falseDescription: "Value set for classifying stress chronicity"
* ^url = "https://2rdoc.pt/fhir/ValueSet/stress-chronicity-vs"
* codes from system StressChronicityCS

ValueSet: StressImpactVS
Id: stress-impact-vs
Title: "Stress Impact Value Set"
* ^experimental = falseDescription: "Value set for describing stress impact levels"
* ^url = "https://2rdoc.pt/fhir/ValueSet/stress-impact-vs"
* codes from system StressImpactCS

CodeSystem: StressChronicityCS
Id: stress-chronicity-cs
Title: "Stress Chronicity Code System"
* ^experimental = falseDescription: "Code system for stress chronicity classification"
* ^url = "https://2rdoc.pt/fhir/CodeSystem/stress-chronicity-cs"
* #acute "Acute" "Short-term stress response"
* #subacute "Subacute" "Medium-term stress response"
* #chronic "Chronic" "Long-term stress response"
* #episodic "Episodic" "Recurring stress episodes"
* #persistent "Persistent" "Continuous stress state"

CodeSystem: StressImpactCS
Id: stress-impact-cs
Title: "Stress Impact Code System"
* ^experimental = falseDescription: "Code system for stress impact levels"
* ^url = "https://2rdoc.pt/fhir/CodeSystem/stress-impact-cs"
* #minimal "Minimal Impact" "Little to no interference with daily activities"
* #mild "Mild Impact" "Some interference with daily activities"
* #moderate "Moderate Impact" "Significant interference with daily activities"
* #severe "Severe Impact" "Major interference with daily activities"
* #extreme "Extreme Impact" "Unable to perform daily activities"



// ===== Conteúdo de: ReproductiveValueSets.fsh =====

ValueSet: ReproductiveGoalVS
Id: reproductive-goal-vs
Title: "Reproductive Health Goals Value Set"
Description: "Goals related to reproductive health tracking and planning"

* ^status = #active
* ^experimental = false
* ^date = "2024-03-19"

* $LOINC#8708-0 "Menstrual cycle length"
* $LOINC#55284-4 "Blood pressure"
* $LOINC#8310-5 "Body temperature"
* $LOINC#8302-2 "Body height"
* $LOINC#29463-7 "Body weight"
* $SCT#364311006 "Menstrual cycle monitoring"
* $SCT#289530006 "Reproductive health finding"

ValueSet: ReproductiveActivityVS
Id: reproductive-activity-vs
Title: "Reproductive Health Activities Value Set"
Description: "Activities related to reproductive health monitoring"

* ^status = #active
* ^experimental = false
* ^date = "2024-03-19"

* codes from system ReproductiveActivityCS

CodeSystem: ReproductiveActivityCS
Id: reproductive-activity-cs
Title: "Reproductive Health Activities Code System"
Description: "Code system for reproductive health monitoring activities"

* ^status = #active
* ^experimental = false
* ^caseSensitive = true

* #cycle-tracking "Cycle Tracking" "Track menstrual cycle dates and characteristics"
* #temp-monitoring "Temperature Monitoring" "Monitor basal body temperature"
* #symptom-tracking "Symptom Tracking" "Track reproductive health symptoms"
* #vitals-monitoring "Vitals Monitoring" "Monitor vital signs related to reproductive health"
* #fertility-signs "Fertility Signs" "Monitor fertility signs and indicators"
* #mood-tracking "Mood Tracking" "Track mood changes related to reproductive cycle"
* #medication-log "Medication Log" "Log reproductive health medications"
* #exercise-tracking "Exercise Tracking" "Track physical activity during cycle"



// ===== Conteúdo de: AuditFormatsValueSet.fsh =====

ValueSet: AuditFormatsValueSet
Id: audit-formats
Title: "Audit Formats Value Set"
Description: "Value set for audit format types"
* ^url = "https://2rdoc.pt/fhir/ValueSet/audit-formats"
* ^status = #active
* ^experimental = false
* ^date = "2024-12-27"
* include codes from system https://2rdoc.pt/fhir/CodeSystem/audit-formats

CodeSystem: AuditFormatsCodeSystem
Id: audit-formats
Title: "Audit Formats Code System"
Description: "Code system for audit format types"
* ^url = "https://2rdoc.pt/fhir/CodeSystem/audit-formats"
* ^status = #active
* ^experimental = false
* ^caseSensitive = true
* #text "Text Format"
* #structured "Structured Format"
* #mixed "Mixed Format"



// ===== Conteúdo de: MeasurementContextVS.fsh =====

ValueSet: MeasurementContextVS
Id: measurement-context-vs
Title: "Measurement Context Value Set"
Description: "Contexts in which measurements can be taken, including temporal and location-based contexts"
* ^status = #active
* ^experimental = false
* $SCT#272125009 "Assessment context value (qualifier value)"
* $SCT#307818003 "Before food"
* $SCT#307819006 "After food"
* $SCT#255214003 "After exercise"
* $SCT#264362003 "Time of day"



// ===== Conteúdo de: AuditLevelsValueSet.fsh =====

ValueSet: AuditLevelsValueSet
Id: audit-levels
Title: "Audit Levels Value Set"
Description: "Value set for audit level types"
* ^url = "https://2rdoc.pt/fhir/ValueSet/audit-levels"
* ^status = #active
* ^experimental = false
* ^date = "2024-12-27"
* include codes from system https://2rdoc.pt/fhir/CodeSystem/audit-levels

CodeSystem: AuditLevelsCodeSystem
Id: audit-levels
Title: "Audit Levels Code System"
Description: "Code system for audit level types"
* ^url = "https://2rdoc.pt/fhir/CodeSystem/audit-levels"
* ^status = #active
* ^experimental = false
* ^caseSensitive = true
* #low "Low Level"
* #medium "Medium Level"
* #high "High Level"



// ===== Conteúdo de: SocialInteractionValueSets.fsh =====

ValueSet: SocialInteractionTypeVS
Id: social-interaction-type-vs
Title: "Social Interaction Type Value Set"
* ^experimental = falseDescription: "Types of social interactions"
* codes from system SocialInteractionTypeCS

ValueSet: SocialInteractionQualityVS
Id: social-interaction-quality-vs
Title: "Social Interaction Quality Value Set"
* ^experimental = falseDescription: "Quality measures for social interactions"
* codes from system SocialInteractionQualityCS

ValueSet: SocialInteractionMediumVS
Id: social-interaction-medium-vs
Title: "Social Interaction Medium Value Set"
* ^experimental = falseDescription: "Mediums through which social interaction occurs"
* codes from system SocialInteractionMediumCS

CodeSystem: SocialInteractionTypeCS
Id: social-interaction-type-cs
Title: "Social Interaction Type Code System"
* ^experimental = falseDescription: "Types of social interactions"
* #family "Family Interaction" "Interaction with family members"
* #friends "Friend Interaction" "Interaction with friends"
* #professional "Professional Interaction" "Work-related interactions"
* #community "Community Interaction" "Community-based interactions"
* #group "Group Activity" "Organized group activities"
* #casual "Casual Interaction" "Casual social encounters"

CodeSystem: SocialInteractionQualityCS
Id: social-interaction-quality-cs
Title: "Social Interaction Quality Code System"
* ^experimental = falseDescription: "Quality measures for social interactions"
* #meaningful "Meaningful" "Deep, meaningful interaction"
* #supportive "Supportive" "Supportive interaction"
* #neutral "Neutral" "Neither positive nor negative"
* #superficial "Superficial" "Surface-level interaction"
* #stressful "Stressful" "Stressful or difficult interaction"

CodeSystem: SocialInteractionMediumCS
Id: social-interaction-medium-cs
Title: "Social Interaction Medium Code System"
* ^experimental = falseDescription: "Mediums through which social interaction occurs"
* #inPerson "In Person" "Face-to-face interaction"
* #video "Video Call" "Video-based interaction"
* #voice "Voice Call" "Voice-only interaction"
* #text "Text Based" "Text-based communication"
* #social "Social Media" "Social media interaction"
* #mixed "Mixed Medium" "Multiple communication methods"



// ===== Conteúdo de: MoodValueSet.fsh =====

ValueSet: MoodValueSet
Id: mood
Title: "Mood Value Set"
Description: "Value set for mood states"
* ^url = "https://2rdoc.pt/fhir/ValueSet/mood"
* ^status = #active
* ^experimental = false

CodeSystem: MoodCodeSystem
Id: mood
Title: "Mood Code System"
Description: "Code system for mood states"
* ^url = "https://2rdoc.pt/fhir/CodeSystem/mood"
* ^status = #active
* ^caseSensitive = true
* #elevated "Elevated" "Mood is higher than normal"
* #neutral "Neutral" "Neither elevated nor depressed mood"
* #depressed "Depressed" "Mood is lower than normal"
* #anxious "Anxious" "Feeling worried or nervous"
* #irritable "Irritable" "Easily annoyed or angered"
* #calm "Calm" "Feeling peaceful and relaxed"



// ===== Conteúdo de: EnvironmentalContextVS.fsh =====

ValueSet: EnvironmentalContextValueSet
Id: environmental-context
Title: "Environmental Context Value Set"
Description: "Valid contexts for environmental measurements"

* ^status = #active
* ^experimental = false
* ^url = "https://2rdoc.pt/fhir/ValueSet/environmental-context"
* include codes from system https://2rdoc.pt/fhir/CodeSystem/environmental-context



// ===== Conteúdo de: ActivityTypeVS.fsh =====

ValueSet: PhysicalActivityTypeVS
Id: physical-activity-type-vs
Title: "Physical Activity Types Value Set"
* ^experimental = falseDescription: "Types of physical activities from iOS Health App"

* ^status = #active

* $SNOMED#255604002 "Physical activity (observable entity)"
* $SNOMED#228557008 "Walking"
* $SNOMED#229058003 "Running"
* $SNOMED#266938001 "Swimming"
* $SNOMED#266940006 "Cycling"
* $SNOMED#32147004 "Regular exercise"



// ===== Conteúdo de: MindfulnessValueSets.fsh =====

ValueSet: EnvironmentTypeValueSet
Id: environment-type
Title: "Environment Type Value Set"
* ^experimental = falseDescription: "Value set for environmental context types"
* ^url = "https://2rdoc.pt/fhir/ValueSet/environment-type"
* ^status = #active
* include codes from system https://2rdoc.pt/fhir/CodeSystem/environment-type

ValueSet: MindfulnessTypeValueSet
Id: mindfulness-type
Title: "Mindfulness Type Value Set"
* ^experimental = falseDescription: "Value set for types of mindfulness practices"
* ^url = "https://2rdoc.pt/fhir/ValueSet/mindfulness-type"
* ^status = #active
* include codes from system https://2rdoc.pt/fhir/CodeSystem/mindfulness-type



// ===== Conteúdo de: BalanceStatusValueSet.fsh =====

ValueSet: BalanceStatusValueSet
Id: balance-status
Title: "Balance Status Value Set"
Description: "Value set for walking steadiness balance status"
* ^url = "https://2rdoc.pt/fhir/ValueSet/balance-status"
* ^status = #active
* include codes from system https://2rdoc.pt/fhir/CodeSystem/balance-status

CodeSystem: BalanceStatusCodeSystem
Id: balance-status
Title: "Balance Status Code System"
Description: "Code system for balance status types"
* ^url = "https://2rdoc.pt/fhir/CodeSystem/balance-status"
* ^status = #active
* ^experimental = false
* ^caseSensitive = true
* #veryStable "Very Stable"
* #stable "Stable"
* #slightlyUnstable "Slightly Unstable"
* #unstable "Unstable"
* #veryUnstable "Very Unstable"



// ===== Conteúdo de: SleepQualityVS.fsh =====

ValueSet: SleepQualityVS
Id: sleep-quality-vs
Title: "Sleep Quality Value Set"
Description: "Qualitative assessments of sleep quality including subjective measures"
* ^status = #active
* ^experimental = false
* $SCT#248254009 "Quality of sleep (observable entity)"
* $SCT#248255005 "Sleeping well"
* $SCT#248256006 "Difficulty sleeping"
* $SCT#301345002 "Poor sleep pattern"
* $SCT#301346001 "Good sleep pattern"




// ===== Conteúdo de: FertilityValueSets.fsh =====

ValueSet: CervicalMucusValueSet
Id: cervical-mucus-valueset
Title: "Cervical Mucus Value Set"
* ^experimental = falseDescription: "Value set for cervical mucus observations"
* ^url = "https://2rdoc.pt/fhir/ValueSet/cervical-mucus-vs"
* ^status = #active
* include codes from system https://2rdoc.pt/fhir/CodeSystem/cervical-mucus-cs

CodeSystem: CervicalMucusCodeSystem
Id: cervical-mucus-cs
Description: "Code system for cervical mucus classification"Title: "Cervical Mucus Code System"
* ^url = "https://2rdoc.pt/fhir/CodeSystem/cervical-mucus-cs"
* ^status = #active
* ^caseSensitive = true
* #dry "Dry"
* #sticky "Sticky"
* #creamy "Creamy"
* #watery "Watery"
* #eggWhite "Egg White"

ValueSet: OvulationTestValueSet
Id: ovulation-test-valueset
Title: "Ovulation Test Value Set"
* ^experimental = falseDescription: "Value set for ovulation test results"
* ^url = "https://2rdoc.pt/fhir/ValueSet/ovulation-test-vs"
* ^status = #active
* include codes from system https://2rdoc.pt/fhir/CodeSystem/ovulation-test-cs

CodeSystem: OvulationTestCodeSystem
Id: ovulation-test-cs
Description: "Code system for ovulation test results"Title: "Ovulation Test Code System"
* ^url = "https://2rdoc.pt/fhir/CodeSystem/ovulation-test-cs"
* ^status = #active
* ^caseSensitive = true
* #negative "Negative"
* #positive "Positive"
* #invalid "Invalid Test"

ValueSet: FertilityStatusValueSet
Id: fertility-status-valueset
Title: "Fertility Status Value Set"
* ^experimental = falseDescription: "Value set for fertility status"
* ^url = "https://2rdoc.pt/fhir/ValueSet/fertility-status-vs"
* ^status = #active
* include codes from system https://2rdoc.pt/fhir/CodeSystem/fertility-status-cs

CodeSystem: FertilityStatusCodeSystem
Id: fertility-status-cs
Description: "Code system for fertility status indicators"Title: "Fertility Status Code System"
* ^url = "https://2rdoc.pt/fhir/CodeSystem/fertility-status-cs"
* ^status = #active
* ^caseSensitive = true
* #fertile "Fertile"
* #notFertile "Not Fertile"
* #uncertain "Uncertain"



// ===== Conteúdo de: MindfulnessSearchParameters.fsh =====

Instance: MindfulnessType
InstanceOf: SearchParameter
Description: "Example instance of MindfulnessType"Usage: #definition
* status = #active
* code = #mindfulness-type
* name = "MindfulnessType"
* description = "Search for mindfulness observations by practice type"
* base = #Observation
* type = #token
* expression = "Observation.component.where(code.coding.exists(system = 'http://snomed.info/sct' and code = '711415009')).value.as(CodeableConcept)"
* xpath = "f:Observation/f:component[f:code/f:coding[f:system/@value='http://snomed.info/sct' and f:code/f:coding/f:code/@value='711415009']]/f:valueCodeableConcept"
* xpathUsage = #normal



// ===== Conteúdo de: MindfulnessAlerts.fsh =====

Extension: AlertTiming
Id: alert-timing
Title: "Alert Timing Extension"
Description: "Defines when alerts should be triggered"
* value[x] only Timing
* valueTiming.repeat 1..1 MS
* valueTiming.repeat.frequency MS
* valueTiming.repeat.period MS
* valueTiming.repeat.periodUnit MS

Extension: AlertMessage
Id: alert-message
Title: "Alert Message Extension"
Description: "Defines the alert message content"
* value[x] only string

Profile: MindfulnessAlert
Parent: Basic
Id: mindfulness-alert
Title: "Mindfulness Alert"
Description: "Alert configuration for mindfulness sessions"

* code 1..1 MS
* code = https://2rdoc.pt/fhir/CodeSystem/mindfulness-alert-type#reminder "Mindfulness Reminder"

* extension contains
    alert-timing named alertTiming 0..1 MS and
    alert-message named alertMessage 1..1 MS

Instance: DailyMindfulnessAlert
InstanceOf: MindfulnessAlert
Title: "Daily Mindfulness Alert" 
Description: "Example of a daily mindfulness alert configuration"

* code = https://2rdoc.pt/fhir/CodeSystem/mindfulness-alert-type#reminder "Mindfulness Reminder"
* extension[alertTiming].valueTiming.repeat
  * frequency = 1
  * period = 1
  * periodUnit = #d
* extension[alertMessage].valueString = "Time for your daily mindfulness practice"



// ===== Conteúdo de: MindfulnessTransforms.fsh =====

Instance: MindfulnessHealthKitTransform
InstanceOf: StructureMap
Usage: #definition
Title: "HealthKit to FHIR Mindfulness Transform"

* status = #draft
* name = "MindfulnessHealthKitTransform"
* structure[0]
  * url = "https://2rdoc.pt/ig/ios-lifestyle-medicine/StructureDefinition/healthkit-mindfulness"
  * mode = #source
  * documentation = "HealthKit mindfulness session structure"

* structure[1]
  * url = "http://hl7.org/fhir/StructureDefinition/Observation"
  * mode = #target
  * documentation = "FHIR Observation resource"

* group[0]
  * name = "MindfulnessSessionToObservation"
  * typeMode = #none
  * input[0]
    * name = "source"
    * type = "HealthKitMindfulness"
    * mode = #source
  * input[1]
    * name = "target"
    * type = "Observation"
    * mode = #target
  * rule[0]
    * name = "Session"
    * source[0]
      * context = "source"
      * element = "startDate"
    * target[0]
      * context = "target"
      * element = "effectiveDateTime"
  * rule[1]
    * name = "Duration"
    * source[0]
      * context = "source"
      * element = "duration"
    * target[0]
      * context = "target"
      * element = "component.where(code.coding.code='118682006').valueQuantity"

Instance: MindfulnessCSVTransform
InstanceOf: StructureMap
Usage: #definition
Title: "CSV to FHIR Mindfulness Transform"

* status = #draft
* name = "MindfulnessCSVTransform"
* structure[0]
  * url = "https://2rdoc.pt/ig/ios-lifestyle-medicine/StructureDefinition/csv-mindfulness"
  * mode = #source
  * documentation = "CSV mindfulness data structure"

* group[0]
  * name = "CSVToMindfulnessObservation"
  * typeMode = #none
  * input[0]
    * name = "source"
    * type = "CSVMindfulness"
    * mode = #source
  * input[1]
    * name = "target"
    * type = "Observation"
    * mode = #target
  * rule[0]
    * name = "MapDatetime"
    * source[0]
      * context = "source"
      * element = "date,time"
    * target[0]
      * context = "target"
      * element = "effectiveDateTime"
      * transform = #append

RuleSet: TransformValidationRules
* rule[+]
  * name = "ValidateStatus"
  * source[0]
    * context = "target"
    * element = "status"
  * assert[0]
    * description = "Status must be final"
    * expression = "%status = 'final'"

* rule[+]
  * name = "ValidateCode"
  * source[0]
    * context = "target"
    * element = "code"
  * assert[0]
    * description = "Must use SNOMED CT code"
    * expression = "%code.system = 'http://snomed.info/sct'"



// ===== Conteúdo de: MindfulnessAudit.fsh =====

Extension: AuditLevelExtension
Id: audit-level
Title: "Audit Level Extension"
Description: "Level of detail for audit records"
* value[x] only code
* valueCode from https://2rdoc.pt/fhir/ValueSet/audit-levels (required)

Extension: AuditRetentionExtension
Id: audit-retention
Title: "Audit Retention Extension" 
Description: "Period to retain audit records"
* value[x] only Duration

Extension: AuditFormatExtension
Id: audit-format
Title: "Audit Format Extension"
Description: "Format for audit records"
* value[x] only code
* valueCode from https://2rdoc.pt/fhir/ValueSet/audit-formats (required)

Profile: MindfulnessAudit
Parent: Basic
Id: mindfulness-audit
Title: "Mindfulness Audit"
Description: "Audit record for mindfulness sessions"

* code 1..1 MS
* code = https://2rdoc.pt/fhir/CodeSystem/mindfulness-audit-type#session "Session Audit"
* created 1..1 MS

* extension contains
    audit-level named auditLevel 1..1 MS and
    audit-retention named auditRetention 1..1 MS and
    audit-format named auditFormat 1..1 MS

Instance: MindfulnessAuditExample
InstanceOf: MindfulnessAudit
Title: "Example Mindfulness Audit"
Description: "Example of a mindfulness session audit record"

* code = https://2rdoc.pt/fhir/CodeSystem/mindfulness-audit-type#session "Session Audit"
* created = "2024-03-15"
* extension[auditLevel].valueCode = #detailed
* extension[auditRetention].valueDuration = 90 'days'
* extension[auditFormat].valueCode = #fhir



// ===== Conteúdo de: EnvironmentalExamples.fsh =====

Instance: NoiseExposureExample
InstanceOf: NoiseExposureObservation
Usage: #example
Description: "Noise exposure observation example"
Title: "Noise Exposure Measurement Example"

* meta.security = http://terminology.hl7.org/CodeSystem/v3-Confidentiality#N
* status = #final
* performer = Reference(Practitioner/PractitionerExample)
* category = http://terminology.hl7.org/CodeSystem/observation-category#environment
* code = $LOINC#28573-7 "Noise exposure time"
* subject = Reference(Patient/PatientExample)
* effectiveDateTime = "2024-03-19T15:30:00Z"
* device = Reference(Device/iphone-example)
* method = http://snomed.info/sct#37016008 "Automatic measurement"

* component[level]
  * code.coding[0] = $LOINC#89020-2 "Environmental noise average"
  * valueQuantity = 85 'dB'
  * interpretation = http://terminology.hl7.org/CodeSystem/v3-ObservationInterpretation#H "High"

* component[duration]
  * code.coding[0] = $LOINC#89021-0 "Environmental noise duration"
  * valueQuantity = 120 'min'

* component[peakLevel]
  * code.coding[0] = $LOINC#89024-4 "Peak sound level"
  * valueQuantity = 95 'dB'

* component[backgroundNoise]
  * code.coding[0] = $LOINC#89025-1 "Background noise level"
  * valueQuantity = 45 'dB'

* note.text = "Measurement taken during urban commute"

Instance: UVExposureExample
InstanceOf: UVExposureObservation
Usage: #example
Description: "UV exposure observation example"
Title: "UV Exposure Measurement Example"

* meta.security = http://terminology.hl7.org/CodeSystem/v3-Confidentiality#N
* status = #final
* category = http://terminology.hl7.org/CodeSystem/observation-category#environment
* code = $LOINC#28574-5 "UV exposure"
* subject = Reference(Patient/PatientExample)
* effectiveDateTime = "2024-03-19T12:00:00Z"
* device = Reference(Device/iphone-example)
* method = http://snomed.info/sct#37016008 "Automatic measurement"

* component[index]
  * code.coding[0] = $LOINC#89022-8 "UV index"
  * valueQuantity = 8 '{index}'
  * interpretation = http://terminology.hl7.org/CodeSystem/v3-ObservationInterpretation#H "High"

* component[duration]
  * code.coding[0] = $LOINC#89023-6 "UV exposure duration"
  * valueQuantity = 45 'min'

* component[timeOfDay]
  * code.coding[0] = $LOINC#89026-9 "Time of exposure"
  * valueDateTime = "2024-03-19T12:00:00Z"

* component[intensity]
  * code.coding[0] = $LOINC#89027-7 "UV intensity"
  * valueQuantity = 0.3 'W/m2'

* note.text = "Measurement taken during outdoor activity"

Instance: EnvironmentalDeviceExample
InstanceOf: Device
Usage: #example
Description: "Environmental monitoring device example"
Title: "Environmental Monitoring Device"

* identifier.system = "https://2rdoc.pt/ig/ios-lifestyle-medicine/devices"
* identifier.value = "iPhone-ENV-001"
* manufacturer = "Apple Inc."
* modelNumber = "iPhone 15 Pro"
* type = $SCT#706689003 "Environmental monitoring device"
* status = #active



// ===== Conteúdo de: NutritionExamples.fsh =====

Instance: NutritionQuestionnaireResponseExample
InstanceOf: QuestionnaireResponse
Usage: #example
Description: "Nutrition questionnaire response example"
Title: "Daily Nutrition Questionnaire Response Example"

* questionnaire = "https://2rdoc.pt/fhir/Questionnaire/daily-nutrition"
* status = #completed
* subject = Reference(Patient/PatientExample)
* authored = "2024-12-14T20:00:00Z"

* item[0]
  * linkId = "water_intake"
  * answer.valueQuantity = 2000 'mL'

* item[1]
  * linkId = "meal_record"

  * item[0]
    * linkId = "meal_time"
    * answer.valueDateTime = "2024-12-14T12:00:00Z"

  * item[1]
    * linkId = "meal_type"
    * answer.valueString = "Lunch"

  * item[2]
    * linkId = "calories"
    * answer.valueInteger = 650

  * item[3]
    * linkId = "macronutrients"
   
    * item[0]
      * linkId = "carbs"
      * answer.valueDecimal = 75
   
    * item[1]
      * linkId = "protein"
      * answer.valueDecimal = 30
   
    * item[2]
      * linkId = "fat"
      * answer.valueDecimal = 25

* item[2]
  * linkId = "caffeine"

  * item[0]
    * linkId = "caffeine_amount"
    * answer.valueInteger = 80

  * item[1]
    * linkId = "caffeine_source"
    * answer.valueString = "Coffee"



// ===== Conteúdo de: SleepExamples.fsh =====

Instance: SleepObservationExample1
InstanceOf: SleepObservation
Usage: #example
Description: "Sleep observation example"
Title: "Example of Sleep Record"
 
* status = #final
* category = http://terminology.hl7.org/CodeSystem/observation-category#sleep
* code = $LOINC#93832-4 "Sleep pattern panel"
* subject = Reference(PatientExample)
* effectivePeriod.start = "2024-03-19T22:00:00Z"
* effectivePeriod.end = "2024-03-20T06:30:00Z"
* device = Reference(DeviceSleepMonitor)
 
* component[timeInBed].code = $LOINC#93831-6 "Time in bed"
* component[timeInBed].valueQuantity = 510 'min' "minute"
* component[timeInBed].valueQuantity.system = $UCUM
* component[timeInBed].valueQuantity.unit = "minute"
 
* component[totalSleepTime].code = $LOINC#93833-2 "Sleep duration"
* component[totalSleepTime].valueQuantity = 472 'min' "minute"
* component[totalSleepTime].valueQuantity.system = $UCUM
* component[totalSleepTime].valueQuantity.unit = "minute"
 
* component[deepSleep].code = $LOINC#93834-0 "Deep sleep duration"
* component[deepSleep].valueQuantity = 95 'min' "minute"
* component[deepSleep].valueQuantity.system = $UCUM
* component[deepSleep].valueQuantity.unit = "minute"
 
* component[remSleep].code = $LOINC#93835-7 "REM sleep duration"
* component[remSleep].valueQuantity = 118 'min' "minute"
* component[remSleep].valueQuantity.system = $UCUM
* component[remSleep].valueQuantity.unit = "minute"
 
* component[lightSleep].code = $LOINC#93836-5 "Light sleep duration"
* component[lightSleep].valueQuantity = 259 'min' "minute"
* component[lightSleep].valueQuantity.system = $UCUM
* component[lightSleep].valueQuantity.unit = "minute"
 
* component[respiratoryRate].code = $LOINC#9279-1 "Respiratory rate"
* component[respiratoryRate].valueQuantity = 14 '/min' "per minute"
* component[respiratoryRate].valueQuantity.system = $UCUM
* component[respiratoryRate].valueQuantity.unit = "per minute"
 
* component[heartRateVariability].code = $LOINC#80404-7 "R-R interval.standard deviation (Heart rate variability)"
* component[heartRateVariability].valueQuantity = 45 'ms' "millisecond"
* component[heartRateVariability].valueQuantity.system = $UCUM
* component[heartRateVariability].valueQuantity.unit = "millisecond"
 
* component[interruptions].code = $LOINC#93837-3 "Number of awakenings during sleep"
* component[interruptions].valueQuantity = 3 '{count}' "count"
* component[interruptions].valueQuantity.system = $UCUM
* component[interruptions].valueQuantity.unit = "count"

Instance: DeviceSleepMonitor
InstanceOf: Device
Usage: #example
Description: "Sleep monitor device example"
Title: "Sleep Monitoring Device"
* deviceName.name = "Sleep Quality Monitor"
* deviceName.type = #user-friendly-name
* manufacturer = "HealthTech Devices"
* modelNumber = "SQM-2024"
* type = $SCT#706172001 "Sleep monitor"



// ===== Conteúdo de: StressExamples.fsh =====

Instance: StressLevelExample
InstanceOf: StressLevelProfile
Usage: #example
Description: "Stress level observation example"
Title: "Stress Level Measurement Example"

* status = #final
* category = http://terminology.hl7.org/CodeSystem/observation-category#vital-signs
* code = $LOINC#89592-0 "Stress level score"
* subject = Reference(Patient/PatientExample)
* effectiveDateTime = "2024-01-03T15:30:00Z"
* valueQuantity = 7 '{score}' "score"

* component[physiologicalStress].valueQuantity = 6 '{score}' "score"
* component[psychologicalStress].valueQuantity = 8 '{score}' "score"
* component[chronicity].valueCodeableConcept = StressChronicityCS#subacute
* component[impact].valueCodeableConcept = StressImpactCS#moderate

* extension[triggers].valueCodeableConcept = StressTriggersCS#work
* extension[coping].valueCodeableConcept = StressCopingCS#meditation



// ===== Conteúdo de: PatientExample.fsh =====

Instance: PatientExample
InstanceOf: Patient
Usage: #example
Description: "Patient resource example"
* identifier[0].system = "urn:oid:2.16.858.1.1.1"
* identifier[0].value = "12345"
* name.given = "John"
* name.family = "Doe"
* gender = #male
* birthDate = "1970-01-01"



// ===== Conteúdo de: MobilityExamples.fsh =====

Profile: WalkingSteadinessObservation
Parent: MobilityProfile
Id: walking-steadiness-observation
Description: "Profile for assessing walking steadiness and balance"Title: "Walking Steadiness Observation Profile"

* code = $LOINC#LA32-8 "Balance"
* component contains
    balanceScore 0..1 MS and
    balanceStatus 0..1 MS

* component[balanceScore]
  * code = $LOINC#LA32-8 "Balance score"
  * valueQuantity.system = $UCUM
  * valueQuantity.code = #%

* component[balanceStatus]
  * code = $LOINC#LA32-9 "Balance status"
  * valueCodeableConcept from https://2rdoc.pt/fhir/ValueSet/balance-status (required)

Profile: WalkingSpeedObservation
Parent: MobilityProfile
Id: walking-speed-observation
Description: "Profile for measuring walking speed as part of mobility assessment"Title: "Walking Speed Observation Profile"

* code = $LOINC#LA29042-4 "Walking speed"
* component contains
    speed 0..1 MS and
    distance 0..1 MS

* component[speed]
  * code = $LOINC#LA29042-4 "Walking speed measurement"
  * valueQuantity.system = $UCUM
  * valueQuantity.code = #m/s

* component[distance]
  * code = $LOINC#LA29043-2 "Walking distance"
  * valueQuantity.system = $UCUM
  * valueQuantity.code = #m

Instance: WalkingSteadinessExample
InstanceOf: WalkingSteadinessObservation
Usage: #example
Description: "Walking steadiness observation example"
Title: "Walking Steadiness Measurement Example"

* status = #final
* category = http://terminology.hl7.org/CodeSystem/observation-category#activity
* code = $LOINC#LA32-8 "Balance"
* subject = Reference(Patient/PatientExample)
* effectiveDateTime = "2024-03-19T15:30:00Z"
* valueQuantity = 85 '1' "score"
* device = Reference(Device/iphone-example)

* component[balanceScore].valueQuantity = 85 '%' "percent"
* component[balanceStatus].valueCodeableConcept = $LOINC#LA32-10 "OK"

Instance: WalkingSpeedExample
InstanceOf: WalkingSpeedObservation
Usage: #example
Description: "Walking speed observation example"
Title: "Walking Speed Measurement Example"

* status = #final
* category = http://terminology.hl7.org/CodeSystem/observation-category#activity
* code = $LOINC#LA29042-4 "Walking speed"
* subject = Reference(Patient/PatientExample)
* effectiveDateTime = "2024-03-19T15:30:00Z"
* valueQuantity = 1.2 'm/s' "meters per second"
* device = Reference(Device/iphone-example)

* component[speed].valueQuantity = 1.2 'm/s' "meters per second"
* component[distance].valueQuantity = 10 'm' "meters"



// ===== Conteúdo de: PhysicalActivityExamples.fsh =====

Instance: PhysicalActivityExample1
InstanceOf: PhysicalActivityObservation
Usage: #example
Description: "Physical activity observation example"
Title: "Example of Walking Activity"
* status = #final
* category = http://terminology.hl7.org/CodeSystem/observation-category#activity
* code = $SNOMED#228557008 "Walking"
* subject = Reference(PatientExample)
* effectiveDateTime = "2024-03-19T15:30:00Z"
* device = Reference(DeviceActivityTracker)
* component[steps].code = $LOINC#55423-8 "Number of steps in 24 hour Measured"
* component[steps].valueQuantity = 8546 '1' "count"
* component[steps].valueQuantity.system = $UCUM
* component[steps].valueQuantity.unit = "count"
* component[distance].code = $LOINC#55430-3 "Distance walked"
* component[distance].valueQuantity = 6.2 'km' "kilometer"
* component[distance].valueQuantity.system = $UCUM
* component[distance].valueQuantity.unit = "kilometer"
* component[duration].code = $LOINC#55411-3 "Exercise duration"
* component[duration].valueQuantity = 72 'min' "minute"
* component[duration].valueQuantity.system = $UCUM
* component[duration].valueQuantity.unit = "minute"
* component[energy].code = $LOINC#55424-6 "Energy expenditure"
* component[energy].valueQuantity = 320 'kcal' "kilocalorie"
* component[energy].valueQuantity.system = $UCUM
* component[energy].valueQuantity.unit = "kilocalorie"

Instance: DeviceActivityTracker
InstanceOf: Device
Usage: #example
Description: "Activity tracker device example"
Title: "Activity Tracking Device"
* deviceName.name = "Health Activity Tracker"
* deviceName.type = #user-friendly-name
* manufacturer = "HealthTech Devices"
* modelNumber = "HAT-2024"
* type = $SCT#258158006 "Breathing rate"



// ===== Conteúdo de: BodyMetricsExamples.fsh =====

Instance: WeightExample
InstanceOf: WeightObservation
Usage: #example
Description: "Weight observation example"
Title: "Weight Measurement Example"
* status = #final
* category = http://terminology.hl7.org/CodeSystem/observation-category#vital-signs
* code = $LOINC#29463-7 "Body weight"
* subject = Reference(PatientExample)
* performer = Reference(PractitionerExample)
* effectiveDateTime = "2024-03-19T08:00:00Z"
* valueQuantity = 70.5 'kg' "kilogram"
* valueQuantity.system = $UCUM
* valueQuantity.unit = "kilogram"
* device = Reference(SmartScale)

Instance: HeightExample
InstanceOf: HeightObservation
Usage: #example
Description: "Height observation example"
Title: "Height Measurement Example"
* status = #final
* category = http://terminology.hl7.org/CodeSystem/observation-category#vital-signs
* code = $LOINC#8302-2 "Body height"
* subject = Reference(PatientExample)
* performer = Reference(PractitionerExample)
* effectiveDateTime = "2024-03-19T08:00:00Z"
* valueQuantity = 175 'cm' "centimeter"
* valueQuantity.system = $UCUM
* valueQuantity.unit = "centimeter"

Instance: BMIExample
InstanceOf: BMIObservation
Usage: #example
Description: "Body Mass Index observation example"
Title: "BMI Calculation Example"
* status = #final
* category = http://terminology.hl7.org/CodeSystem/observation-category#vital-signs
* code = $LOINC#39156-5 "Body mass index (BMI)"
* subject = Reference(PatientExample)
* performer = Reference(PractitionerExample)
* effectiveDateTime = "2024-03-19T08:00:00Z"
* valueQuantity = 23.0 'kg/m2' "kilogram per square meter"
* valueQuantity.system = $UCUM
* valueQuantity.unit = "kilogram per square meter"
* derivedFrom[0] = Reference(Observation/WeightExample)
* derivedFrom[1] = Reference(Observation/HeightExample)

Instance: BodyCompositionExample
InstanceOf: BodyCompositionObservation
Usage: #example
Description: "Body composition observation example"
Title: "Body Composition Measurement Example" 
* status = #final
* category = http://terminology.hl7.org/CodeSystem/observation-category#vital-signs
* code = $LOINC#88365-2 "Body composition panel"
* subject = Reference(PatientExample)
* performer = Reference(PractitionerExample)
* effectiveDateTime = "2024-03-19T08:00:00Z"
* device = Reference(BioimpedanceAnalyzer)

* component[bodyFat].code = $LOINC#41982-0 "Percentage body fat"
* component[bodyFat].valueQuantity = 22.5 '%' "percent"
* component[bodyFat].valueQuantity.system = $UCUM
* component[bodyFat].valueQuantity.unit = "percent"

* component[leanMass].code = $LOINC#291-7 "Lean body mass"
* component[leanMass].valueQuantity = 54.6 'kg' "kilogram"
* component[leanMass].valueQuantity.system = $UCUM
* component[leanMass].valueQuantity.unit = "kilogram"

* component[bodyWater].code = $LOINC#73708-0 "Total body water"
* component[bodyWater].valueQuantity = 39.2 'L' "liter"
* component[bodyWater].valueQuantity.system = $UCUM
* component[bodyWater].valueQuantity.unit = "liter"

* component[muscleMass].code = $LOINC#73713-0 "Muscle mass"
* component[muscleMass].valueQuantity = 51.8 'kg' "kilogram"
* component[muscleMass].valueQuantity.system = $UCUM
* component[muscleMass].valueQuantity.unit = "kilogram"

* component[boneMass].code = $LOINC#73711-4 "Bone mass"
* component[boneMass].valueQuantity = 2.8 'kg' "kilogram"
* component[boneMass].valueQuantity.system = $UCUM
* component[boneMass].valueQuantity.unit = "kilogram"

Instance: SmartScale
InstanceOf: Device
Usage: #example
Description: "Smart scale device example"
Title: "Smart Scale Device"
* deviceName.name = "Smart Body Analyzer"
* deviceName.type = #user-friendly-name
* manufacturer = "HealthTech Devices"
* modelNumber = "SBA-2024"
* type = $SCT#469576000 "Digital scale device"

Instance: BioimpedanceAnalyzer  
InstanceOf: Device
Usage: #example
Description: "Bioimpedance analyzer device example"
Title: "Bioimpedance Analyzer Device"
* deviceName.name = "Professional Body Composition Analyzer"
* deviceName.type = #user-friendly-name
* manufacturer = "MedTech Solutions"
* modelNumber = "BCA-Pro"
* type = $SCT#706767009 "Patient data recorder"



// ===== Conteúdo de: SymptomExamples.fsh =====

Instance: ChronicSymptomExample
InstanceOf: Observation
Usage: #example
Description: "Chronic symptom observation example"
* status = #final
* category = http://terminology.hl7.org/CodeSystem/observation-category#survey
* code = $SCT#267036007 "Fatigue"
* subject = Reference(Patient/PatientExample)
* performer = Reference(Practitioner/PractitionerExample)
* effectiveDateTime = "2024-03-19T14:00:00Z"
// ... resto do exemplo ...

Instance: ExampleSymptomSeverity
InstanceOf: Observation
Usage: #example
Description: "Symptom severity observation example"
* status = #final
* category = http://terminology.hl7.org/CodeSystem/observation-category#survey
* code = $SCT#246604007 "Symptom severity"
* subject = Reference(Patient/PatientExample)
* performer = Reference(Practitioner/PractitionerExample)
* effectiveDateTime = "2024-03-19T10:30:00Z"
// ... resto do exemplo ...



// ===== Conteúdo de: SocialInteractionExamples.fsh =====

Instance: SocialInteractionExample
InstanceOf: SocialInteractionProfile
Usage: #example
Description: "Social interaction observation example"
Title: "Social Interaction Example"

* status = #final
* category = http://terminology.hl7.org/CodeSystem/observation-category#social-history
* code = $LOINC#96766-1 "Social interaction pattern"
* subject = Reference(Patient/PatientExample)
* effectiveDateTime = "2024-01-03T14:00:00Z"
* valueCodeableConcept = SocialInteractionTypeCS#family

* component[duration].valueQuantity = 120 'min' "minutes"
* component[quality].valueCodeableConcept = SocialInteractionQualityCS#meaningful
* component[medium].valueCodeableConcept = SocialInteractionMediumCS#inPerson
* component[participants].valueInteger = 4

* extension[context].valueCodeableConcept = SocialContextCS#home
* extension[support].valueCodeableConcept = SocialSupportCS#strong
* extension[activity].valueCodeableConcept = SocialActivityCS#meal



// ===== Conteúdo de: VitalSignsExamples.fsh =====

Instance: HeartRateExample
InstanceOf: HeartRateObservation
Usage: #example
Description: "Heart rate observation example"
Title: "Heart Rate Measurement Example"
* status = #final
* code = $LOINC#8867-4 "Heart rate"
* subject = Reference(PatientExample)
* effectiveDateTime = "2024-03-19T15:30:00Z"
* valueQuantity = 72 '/min' "per minute"
* valueQuantity.system = $UCUM
* valueQuantity.unit = "per minute"
* device = Reference(DeviceHeartRateMonitor)
* performer = Reference(PractitionerExample)
* component[heartRateVariability].code = $LOINC#80404-7 "R-R interval.standard deviation (Heart rate variability)"
* component[heartRateVariability].valueQuantity = 45 'ms' "millisecond"
* component[heartRateVariability].valueQuantity.system = $UCUM
* component[heartRateVariability].valueQuantity.unit = "millisecond"

Instance: BloodPressureExample
InstanceOf: BloodPressureObservation
Usage: #example
Description: "Blood pressure observation example"
Title: "Blood Pressure Measurement Example"
* status = #final
* code = $LOINC#85354-9 "Blood pressure panel with all children optional"
* subject = Reference(PatientExample)
* effectiveDateTime = "2024-03-19T15:30:00Z"
* device = Reference(DeviceBloodPressureMonitor)
* performer = Reference(PractitionerExample)
* component[systolic].code = $LOINC#8480-6 "Systolic blood pressure"
* component[systolic].valueQuantity = 120 'mm[Hg]' "millimeter of mercury"
* component[systolic].valueQuantity.system = $UCUM
* component[systolic].valueQuantity.unit = "millimeter of mercury"
* component[diastolic].code = $LOINC#8462-4 "Diastolic blood pressure"
* component[diastolic].valueQuantity = 80 'mm[Hg]' "millimeter of mercury"
* component[diastolic].valueQuantity.system = $UCUM
* component[diastolic].valueQuantity.unit = "millimeter of mercury"

Instance: DeviceHeartRateMonitor
InstanceOf: Device
Usage: #example
Description: "Heart rate monitor device example"
Title: "Heart Rate Monitor Device"
* deviceName.name = "Continuous Heart Rate Monitor"
* deviceName.type = #user-friendly-name
* manufacturer = "HealthTech Devices"
* modelNumber = "HRM-2024"
* type = $SCT#720737000 "Pulse rate monitoring device"

Instance: DeviceBloodPressureMonitor
InstanceOf: Device
Usage: #example
Description: "Blood pressure monitor device example"
Title: "Blood Pressure Monitor Device"
* deviceName.name = "Digital Blood Pressure Monitor"
* deviceName.type = #user-friendly-name
* manufacturer = "HealthTech Devices"
* modelNumber = "BPM-2024"
* type = $SCT#43770009 "Blood pressure monitor"



// ===== Conteúdo de: PractitionerExample.fsh =====

Instance: PractitionerExample
InstanceOf: Practitioner
Usage: #example
Description: "Practitioner resource example"
* identifier[0].system = "http://terminology.hl7.org/CodeSystem/practitioner-identifier"
* identifier[0].value = "9941339108"
* name.given = "Jane"
* name.family = "Smith"



// ===== Conteúdo de: MindfulnessCompleteExamples.fsh =====

Instance: CompleteMindfulnessSession
InstanceOf: MindfulnessObservation
Usage: #example
Description: "Complete mindfulness session observation example"
Title: "Complete Mindfulness Session Example"

* status = #final
* code = $SCT#711415009 "Mindfulness"
* subject = Reference(Patient/PatientExample)
* effectiveDateTime = "2024-03-19T08:00:00Z"
* performer = Reference(Practitioner/PractitionerExample)

* component[sessionDuration].code = $SCT#118682006 "Duration"
* component[sessionDuration].valueQuantity = 20 'min'

* component[stressLevel].code = $SCT#725854004 "Assessment of stress level"
* component[stressLevel].valueInteger = 3

* component[moodState].code = $SCT#373931001 "Mood finding"
* component[moodState].valueCodeableConcept = $SCT#130991005 "Neutral mood"

* component[relaxationResponse].code = $SCT#276241001 "Relaxation technique"
* component[relaxationResponse].valueString = "Deep breathing exercises with progressive relaxation"

* component[mindfulnessType].code = $SCT#711415009 "Mindfulness"
* component[mindfulnessType].valueCodeableConcept = $SCT#711415009 "Mindfulness"

* extension[mindfulness-context].extension[location].valueString = "Home meditation room"
* extension[mindfulness-context].extension[environment].valueCodeableConcept = #quiet "Quiet Space"
* extension[mindfulness-context].extension[guidance].valueBoolean = true

Instance: CompleteMindfulnessResponse
InstanceOf: QuestionnaireResponse
Usage: #example
Description: "Complete mindfulness questionnaire response example"
Title: "Complete Mindfulness Session Response"

* questionnaire = "https://2rdoc.pt/fhir/Questionnaire/daily-mindfulness"
* status = #completed
* subject = Reference(Patient/PatientExample)
* authored = "2024-03-19T08:30:00Z"

* item[0]
  * linkId = "mindful_session"
  * item[0]
    * linkId = "session_duration"
    * answer.valueInteger = 20
  * item[1]
    * linkId = "practice_type"
    * answer.valueString = "Meditation"

* item[1]
  * linkId = "mood_assessment"
  * item[0]
    * linkId = "current_mood"
    * answer.valueCoding = $SCT#130991005 "Neutral mood"
  * item[1]
    * linkId = "mood_intensity"
    * answer.valueInteger = 3

* item[2]
  * linkId = "stress_assessment"
  * item[0]
    * linkId = "stress_level"
    * answer.valueInteger = 3
  * item[1]
    * linkId = "stress_symptoms"
    * answer[0].valueString = "Slight tension"

* item[3]
  * linkId = "relaxation"
  * item[0]
    * linkId = "relaxation_duration"
    * answer.valueInteger = 15
  * item[1]
    * linkId = "relaxation_technique"
    * answer.valueString = "Deep breathing"



// ===== Conteúdo de: MindfulnessExamples.fsh =====

Instance: MindfulnessObservationExample
InstanceOf: MindfulnessObservation
Usage: #example
Description: "Mindfulness observation example"
Title: "Example of Mindfulness Session Observation"

* status = #final
* code = $SCT#711415009 "Mindfulness"
* subject = Reference(Patient/PatientExample)
* effectiveDateTime = "2024-03-19T09:30:00Z"
* performer = Reference(Practitioner/PractitionerExample)

* component[sessionDuration].code = $SCT#118682006 "Duration"
* component[sessionDuration].valueQuantity = 20 'min'

* component[stressLevel].code = $SCT#725854004 "Assessment of stress level"
* component[stressLevel].valueInteger = 4

* component[moodState].code = $SCT#373931001 "Mood finding"
* component[moodState].valueCodeableConcept = $SCT#130991005 "Neutral mood"

* component[relaxationResponse].code = $SCT#276241001 "Relaxation technique"
* component[relaxationResponse].valueString = "Deep breathing exercises helped reduce tension"

* component[mindfulnessType].code = $SCT#711415009 "Mindfulness"
* component[mindfulnessType].valueCodeableConcept = $SCT#711415009 "Mindfulness"

// New example for MindfulnessQuestionnaire
Instance: MindfulnessQuestionnaireExample
InstanceOf: Questionnaire
Usage: #example
Title: "Example of Mindfulness Questionnaire"

* url = "https://2rdoc.pt/ig/ios-lifestyle-medicine/Questionnaire/mindfulness-example"
* status = #active
* title = "Daily Mindfulness Assessment"
* version = "1.0"
* name = "MindfulnessQuestionnaireExample"
* date = "2024-03-19"
* description = "Example questionnaire for daily mindfulness practice assessment"

* item[0]
  * linkId = "session_details"
  * text = "Session Details"
  * type = #group
  
  * item[0]
    * linkId = "duration"
    * text = "Duration (minutes)"
    * type = #integer
    * required = true
    
  * item[1]
    * linkId = "technique"
    * text = "Technique Used"
    * type = #choice
    * required = true
    * answerOption[0].valueString = "Mindful Breathing"
    * answerOption[1].valueString = "Body Scan"
    * answerOption[2].valueString = "Walking Meditation"



// ===== Conteúdo de: ReproductiveExamples.fsh =====

Instance: ExampleReproductiveActivity
InstanceOf: CarePlan
Usage: #example
Description: "Reproductive health care plan example"
* status = #active
* intent = #plan
* subject = Reference(Patient/PatientExample)
* activity.detail.kind = #ServiceRequest
* activity.detail.code = ReproductiveActivityCS#cycle-tracking
* activity.detail.status = #scheduled



// ===== Conteúdo de: MissingResources.fsh =====

// ====== Recursos Faltantes para Resolver Links Quebrados ======

Instance: example
InstanceOf: Patient
Usage: #example
* identifier.system = "http://example.org/patients"
* identifier.value = "example-patient"
* name.family = "Example"
* name.given = "Patient"
* gender = #unknown
* birthDate = "1970-01-01"

Instance: osa-practitioner-kyle-anydoc
InstanceOf: Practitioner
Usage: #example
* identifier.system = "http://example.org/practitioners"
* identifier.value = "kyle-anydoc"
* name.family = "Anydoc"
* name.given = "Kyle"
* name.prefix = "Dr."

Instance: PatientMindfulness
InstanceOf: Patient
Usage: #example
* identifier.system = "http://example.org/patients"
* identifier.value = "mindfulness-patient"
* name.family = "Mindfulness"
* name.given = "Test"
* gender = #other
* birthDate = "1980-01-01"

Instance: Org2RDoc
InstanceOf: Organization
Usage: #example
* identifier.system = "http://example.org/organizations"
* identifier.value = "2rdoc"
* name = "2RDoc Healthcare Solutions"
* active = true



// ===== Conteúdo de: MindfulnessWorkflow.fsh =====

Profile: MindfulnessSchedule
Parent: Basic
Id: mindfulness-schedule
Title: "Mindfulness Schedule"
Description: "Schedule configuration for mindfulness sessions"

* code 1..1 MS
* code = https://2rdoc.pt/fhir/CodeSystem/mindfulness-schedule-type#recurring "Recurring Schedule"

Extension: MindfulnessScheduleTiming
Id: mindfulness-schedule-timing
Title: "Mindfulness Schedule Timing"
Description: "Timing configuration for mindfulness sessions"
* value[x] only Timing

Instance: WeeklyMindfulnessSchedule
InstanceOf: MindfulnessSchedule
Title: "Weekly Mindfulness Schedule"
Description: "Example of a weekly mindfulness schedule"

* code = https://2rdoc.pt/fhir/CodeSystem/mindfulness-schedule-type#recurring "Recurring Schedule"
* extension[mindfulness-schedule-timing].valueTiming.repeat.frequency = 1
* extension[mindfulness-schedule-timing].valueTiming.repeat.period = 1
* extension[mindfulness-schedule-timing].valueTiming.repeat.periodUnit = #wk
* extension[mindfulness-schedule-timing].valueTiming.repeat.dayOfWeek = #mon
* extension[mindfulness-schedule-timing].valueTiming.repeat.dayOfWeek[+] = #wed
* extension[mindfulness-schedule-timing].valueTiming.repeat.dayOfWeek[+] = #fri



// ===== Conteúdo de: MindfulnessRules.fsh =====

RuleSet: MindfulnessValidation
* ^extension[0].url = "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice"
* ^extension[0].valueBoolean = true

* status MS
* code MS
* subject MS
* effective[x] MS
* value[x] MS
* component MS

* status from http://hl7.org/fhir/ValueSet/observation-status
* code from http://snomed.info/sct?fhir_vs=isa/711415009
* subject only Reference(Patient)
* effective[x] only dateTime

* obeys mindfulness-session-duration
* obeys mindfulness-stress-level
* obeys mindfulness-mood-required
* obeys mindfulness-context-complete
* obeys sequential-measurements

RuleSet: MindfulnessQuestionnaireValidation
* status MS
* title MS
* item MS

* status = #active
* subjectType = #Patient
* item ^slicing.discriminator.type = #pattern
* item ^slicing.discriminator.path = "linkId"
* item ^slicing.rules = #open
* item contains 
    session 0..1 MS and
    mood 0..1 MS and
    stress 0..1 MS and
    relaxation 0..1 MS

* item[session]
  * linkId = "mindful_session"
  * text = "Mindfulness Session"
  * type = #group
  * required = true
  * repeats = false

* item[mood]
  * linkId = "mood_assessment"
  * text = "Mood Assessment"
  * type = #group
  * required = true
  * repeats = false

* item[stress]
  * linkId = "stress_assessment"
  * text = "Stress Assessment"
  * type = #group
  * required = true
  * repeats = false

* item[relaxation]
  * linkId = "relaxation"
  * text = "Relaxation"
  * type = #group
  * required = true
  * repeats = false

RuleSet: MindfulnessResponseValidation
* status MS
* subject MS
* authored MS
* item MS

* status = #completed
* subject only Reference(Patient)
* authored 1..1
* item ^slicing.discriminator.type = #pattern
* item ^slicing.discriminator.path = "linkId"
* item ^slicing.rules = #open



// ===== Conteúdo de: MindfulnessMappings.fsh =====

Mapping: MindfulnessToHealthKit
Id: mindfulness-to-healthkit
Title: "Mapping to Apple HealthKit"
Source: MindfulnessObservation
Target: "http://developer.apple.com/documentation/healthkit"

* -> "HKCategoryTypeIdentifierMindfulSession" "Root mapping"
* effectiveDateTime -> "startDate and endDate" "Session timing"
* component[sessionDuration].valueQuantity -> "duration" "Session duration"

Mapping: MindfulnessToLOINC
Id: mindfulness-to-loinc
Title: "Mapping to LOINC codes"
Source: MindfulnessObservation
Target: "http://loinc.org"

* -> "89555-7" "Mindfulness safety questionnaire"
* component[stressLevel] -> "89556-5" "Stress level score"
* component[sessionDuration] -> "89557-3" "Duration of mindfulness practice"
* component[moodState] -> "89558-1" "Mood pattern"

Mapping: MindfulnessToSNOMED
Id: mindfulness-to-snomed
Title: "Mapping to SNOMED CT"
Source: MindfulnessObservation
Target: "http://snomed.info/sct"

* -> "711415009" "Meditation"
* component[stressLevel] -> "725854004" "Assessment of stress level"
* component[moodState] -> "373931001" "Mood finding"
* component[relaxationResponse] -> "276241001" "Relaxation technique"

Extension: MindfulnessImportMap
Id: mindfulness-import-map
Title: "Mindfulness Import Mapping"
Description: "Mapping instructions for importing mindfulness data"

* ^url = "https://2rdoc.pt/ig/ios-lifestyle-medicine/StructureDefinition/mindfulness-import-map"
* ^version = "1.0.0"
* ^status = #draft

* extension contains
    source 1..1 MS and
    target 1..1 MS and
    mapping 1..1 MS

* extension[source].value[x] only string
* extension[target].value[x] only string
* extension[mapping].value[x] only string

Instance: HealthKitMappingConfig
InstanceOf: MindfulnessImportMap
Usage: #inline

* extension[source].valueString = "HKCategoryTypeIdentifierMindfulSession"
* extension[target].valueString = "Observation"
* extension[mapping].valueString = "duration->component[sessionDuration].valueQuantity"



// ===== Conteúdo de: SocialInteractionMappings.fsh =====

Mapping: SocialInteractionToHealthKit
Id: social-interaction-to-healthkit
Description: "Definition for social-interaction-to-healthkit resource"Title: "Mapping to Apple HealthKit"
Source: SocialInteractionProfile
Target: "http://developer.apple.com/documentation/healthkit"

* -> "HKCategoryTypeIdentifierSocialInteraction" "Root mapping"
* valueCodeableConcept -> "interactionType" "Type of interaction"
* component[duration] -> "duration" "Duration of interaction"
* component[participants] -> "participantCount" "Number of participants"

Mapping: SocialInteractionToLOINC
Id: social-interaction-to-loinc
Title: "Mapping to LOINC codes"
Source: SocialInteractionProfile
Target: "http://loinc.org"

* -> "96766-1" "Social Interaction Panel"
* component[duration] -> "89597-9" "Interaction duration"
* component[quality] -> "89598-7" "Interaction quality"



// ===== Conteúdo de: MindfulnessDiagnosticMappings.fsh =====

Instance: MindfulnessDiagnosticMap
InstanceOf: ConceptMap
Usage: #definition
Title: "Mindfulness Diagnostic Mappings"
Description: "Mapping of mindfulness outcomes to diagnostic codes"

* status = #draft
* experimental = false
* purpose = "Map mindfulness outcomes to standard diagnostic codes"
* sourceUri = "https://2rdoc.pt/fhir/ValueSet/mindfulness-outcome-vs"
* targetUri = "http://snomed.info/sct"

* group[0].source = "https://2rdoc.pt/fhir/CodeSystem/mindfulness-outcome-cs"
* group[0].target = "http://snomed.info/sct"
* group[0].element[0]
  * code = #stressReduction
  * target[0]
    * code = #73595000
    * display = "Stress"
    * equivalence = #narrower
    * comment = "Indicates reduction in stress levels"

* group[0].element[1]
  * code = #improvedSleep
  * target[0]
    * code = #248234008
    * display = "Sleep pattern"
    * equivalence = #narrower
    * comment = "Indicates improvement in sleep quality"

* group[0].element[2]
  * code = #emotionalBalance
  * target[0]
    * code = #285854004
    * display = "Emotional state"
    * equivalence = #equivalent
    * comment = "Maps to emotional state finding"

* group[0].element[3]
  * code = #increasedAwareness
  * target[0]
    * code = #736253002
    * display = "Mental state, behavior and/or psychosocial functioning"
    * equivalence = #relatedto
    * comment = "General improvement in mental state"

RuleSet: MindfulnessDiagnosticRules
* status MS
* code MS
* subject MS
* effective[x] MS
* value[x] MS
* method MS

* method from https://2rdoc.pt/fhir/ValueSet/mindfulness-diagnostic-method-vs (required)
* code from https://2rdoc.pt/fhir/ValueSet/mindfulness-diagnostic-code-vs (required)

* extension contains 
    diagnosticCertainty 0..1 MS and
    diagnosticTiming 0..1 MS



// ===== Conteúdo de: StressMappings.fsh =====

Mapping: StressToHealthKit
Id: stress-to-healthkit
Description: "Definition for stress-to-healthkit resource"Title: "Mapping to Apple HealthKit"
Source: StressLevelProfile
Target: "http://developer.apple.com/documentation/healthkit"

* -> "HKCategoryTypeIdentifierStressLevel" "Root mapping"
* valueQuantity -> "stressLevel" "Overall stress score"
* component[physiologicalStress] -> "physiologicalStress" "Physical stress indicators"
* component[psychologicalStress] -> "mentalStress" "Mental stress indicators"

Mapping: StressToLOINC
Id: stress-to-loinc
Title: "Mapping to LOINC codes"
Source: StressLevelProfile
Target: "http://loinc.org"

* -> "89592-0" "Stress Level Panel"
* component[physiologicalStress] -> "89593-8" "Physical stress score"
* component[psychologicalStress] -> "89594-6" "Mental stress score"



// ===== Conteúdo de: BodyMetricsProfiles.fsh =====

Alias: $SCT = http://snomed.info/sct
Alias: $LOINC = http://loinc.org
Alias: $UCUM = http://unitsofmeasure.org

Profile: BodyMetricsObservation
Parent: Observation
Id: body-metrics-observation
Title: "Body Metrics Observation Profile"
Description: "Profile for body measurements from iOS Health App"

* ^version = "0.1.0"
* ^status = #draft
* ^publisher = "Open Health Manager"

* status MS
* category 1..1 MS
* category = http://terminology.hl7.org/CodeSystem/observation-category#vital-signs
* subject 1..1 MS
* effectiveDateTime 1..1 MS
* device 0..1 MS

Profile: WeightObservation
Parent: BodyMetricsObservation
Id: weight-observation  
Title: "Weight Measurement Profile"
Description: "Profile for body weight measurements"

* ^version = "0.1.0"
* ^status = #draft

* code = $LOINC#29463-7 "Body weight"
* valueQuantity only Quantity
* valueQuantity.system = $UCUM
* valueQuantity.code = #kg

Profile: HeightObservation
Parent: BodyMetricsObservation
Id: height-observation
Title: "Height Measurement Profile" 
Description: "Profile for body height measurements"

* ^version = "0.1.0"
* ^status = #draft

* code = $LOINC#8302-2 "Body height"
* valueQuantity only Quantity
* valueQuantity.system = $UCUM
* valueQuantity.code = #cm

Profile: BMIObservation
Parent: BodyMetricsObservation
Id: bmi-observation
Title: "BMI Measurement Profile"
Description: "Profile for Body Mass Index calculations"

* ^version = "0.1.0"
* ^status = #draft

* code = $LOINC#39156-5 "Body mass index (BMI)"
* valueQuantity only Quantity
* valueQuantity.system = $UCUM
* valueQuantity.code = #kg/m2

Profile: BodyCompositionObservation
Parent: BodyMetricsObservation
Id: body-composition-observation
Title: "Body Composition Profile"
Description: "Profile for body composition measurements including fat, lean mass, and other metrics"

* ^version = "0.1.0"
* ^status = #draft

* code = $LOINC#88365-2 "Body composition panel"
* component ^slicing.discriminator.type = #pattern
* component ^slicing.discriminator.path = "code"
* component ^slicing.rules = #open

* component contains
    bodyFat 0..1 MS and
    leanMass 0..1 MS and
    bodyWater 0..1 MS and
    muscleMass 0..1 MS and
    boneMass 0..1 MS

* component[bodyFat].code = $LOINC#41982-0 "Percentage body fat"
* component[bodyFat].valueQuantity.system = $UCUM
* component[bodyFat].valueQuantity.code = #%

* component[leanMass].code = $LOINC#291-7 "Lean body mass"
* component[leanMass].valueQuantity.system = $UCUM
* component[leanMass].valueQuantity.code = #kg

* component[bodyWater].code = $LOINC#73708-0 "Total body water"
* component[bodyWater].valueQuantity.system = $UCUM  
* component[bodyWater].valueQuantity.code = #L

* component[muscleMass].code = $LOINC#73713-0 "Muscle mass"
* component[muscleMass].valueQuantity.system = $UCUM
* component[muscleMass].valueQuantity.code = #kg

* component[boneMass].code = $LOINC#73711-4 "Bone mass" 
* component[boneMass].valueQuantity.system = $UCUM
* component[boneMass].valueQuantity.code = #kg



// ===== Conteúdo de: AdvancedVitalSignsProfiles.fsh =====

Alias: $SCT = http://snomed.info/sct
Alias: $LOINC = http://loinc.org
Alias: $UCUM = http://unitsofmeasure.org

Profile: AdvancedVitalSigns
Parent: Observation
Id: advanced-vital-signs
Title: "Advanced Vital Signs Profile"
Description: "Profile for advanced vital signs data from iOS Health App"

* ^version = "0.1.0"
* ^status = #draft
* ^publisher = "HL7 International"
* ^contact.name = "Advanced Vital Signs Working Group"

* status MS
* category 1..1 MS
* category = http://terminology.hl7.org/CodeSystem/observation-category#vital-signs
* code 1..1 MS
* subject 1..1 MS
* effectiveDateTime 1..1 MS
* device 0..1 MS
* method 0..1 MS
* note 0..* MS

* component ^slicing.discriminator.type = #pattern
* component ^slicing.discriminator.path = "code"
* component ^slicing.rules = #open
* component ^short = "Advanced vital signs components"
* component ^definition = "Components of advanced vital sign measurements"

* component contains
    hrvSpectral 0..1 MS and
    hrvEntropy 0..1 MS and
    meanArterialPressure 0..1 MS and
    pulseWaveAnalysis 0..1 MS and
    respiratoryVariability 0..1 MS and
    oxygenationIndex 0..1 MS and
    stressIndex 0..1 MS and
    thermalGradient 0..1 MS and
    autonomicBalance 0..1 MS and
    recoveryRate 0..1 MS and
    allostaticLoad 0..1 MS

* component[hrvSpectral].code = $LOINC#87834-8 "Heart rate variability [Frequency band]"
* component[hrvSpectral].valueQuantity.system = $UCUM
* component[hrvSpectral].valueQuantity.code = #ms
* component[hrvSpectral] ^short = "Spectral analysis of heart rate variability"

* component[hrvEntropy].code = $LOINC#87835-5 "Heart rate variability entropy"
* component[hrvEntropy].valueQuantity.system = $UCUM
* component[hrvEntropy].valueQuantity.code = #{entropy}
* component[hrvEntropy] ^short = "Sample entropy of heart rate variability"

* component[meanArterialPressure].code = $LOINC#8478-0 "Mean blood pressure"
* component[meanArterialPressure].valueQuantity.system = $UCUM
* component[meanArterialPressure].valueQuantity.code = #mmHg
* component[meanArterialPressure] ^short = "Mean arterial blood pressure"

* component[pulseWaveAnalysis].code = $LOINC#87836-3 "Pulse wave analysis"
* component[pulseWaveAnalysis].valueQuantity.system = $UCUM
* component[pulseWaveAnalysis].valueQuantity.code = #{index}
* component[pulseWaveAnalysis] ^short = "Analysis of arterial pulse wave"

* component[respiratoryVariability].code = $LOINC#87837-1 "Respiratory rate variability"
* component[respiratoryVariability].valueQuantity.system = $UCUM
* component[respiratoryVariability].valueQuantity.code = #{coefficient}
* component[respiratoryVariability] ^short = "Variability in respiratory rate"

* component[oxygenationIndex].code = $LOINC#87838-9 "Oxygenation index"
* component[oxygenationIndex].valueQuantity.system = $UCUM
* component[oxygenationIndex].valueQuantity.code = #{ratio}
* component[oxygenationIndex] ^short = "Index of blood oxygenation"

* component[stressIndex].code = $LOINC#87839-7 "Physiological stress index"
* component[stressIndex].valueQuantity.system = $UCUM
* component[stressIndex].valueQuantity.code = #{index}
* component[stressIndex] ^short = "Index of physiological stress"

* component[thermalGradient].code = $LOINC#87840-5 "Temperature gradient"
* component[thermalGradient].valueQuantity.system = $UCUM
* component[thermalGradient].valueQuantity.code = #Cel
* component[thermalGradient] ^short = "Gradient of body temperature"

* component[autonomicBalance].code = $LOINC#87841-3 "Autonomic balance index"
* component[autonomicBalance].valueQuantity.system = $UCUM
* component[autonomicBalance].valueQuantity.code = #{ratio}
* component[autonomicBalance] ^short = "Balance of autonomic nervous system"

* component[recoveryRate].code = $LOINC#87842-1 "Recovery rate index"
* component[recoveryRate].valueQuantity.system = $UCUM
* component[recoveryRate].valueQuantity.code = #{rate}
* component[recoveryRate] ^short = "Rate of physiological recovery"

* component[allostaticLoad].code = $LOINC#87843-9 "Allostatic load index"
* component[allostaticLoad].valueQuantity.system = $UCUM
* component[allostaticLoad].valueQuantity.code = #{score}
* component[allostaticLoad] ^short = "Measure of cumulative physiological burden"

Extension: AdvancedVitalSignsContext
Id: advanced-vital-signs-context
Title: "Advanced Vital Signs Context Extension"
Description: "Additional context about advanced vital sign measurements"

* value[x] only CodeableConcept
* valueCodeableConcept from AdvancedVitalSignsContextVS (required)

ValueSet: AdvancedVitalSignsContextVS
Id: advanced-vital-signs-context-vs
Title: "Advanced Vital Signs Context Value Set"
Description: "Context codes for advanced vital sign measurements"

* ^experimental = true
* codes from system AdvancedVitalSignsContextCS

CodeSystem: AdvancedVitalSignsContextCS
Id: advanced-vital-signs-context-cs
Title: "Advanced Vital Signs Context Code System"
Description: "Codes for advanced vital signs measurement context"

* ^experimental = true
* ^caseSensitive = true

* #resting "Resting state" "Measurement taken during rest"
* #active "Active state" "Measurement taken during activity"
* #recovery "Recovery state" "Measurement taken during recovery"
* #sleep "Sleep state" "Measurement taken during sleep"
* #stress "Stress state" "Measurement taken during stress"



// ===== Conteúdo de: MobilityProfiles.fsh =====

Profile: MobilityProfile
Parent: Observation
Id: mobility-profile
Title: "Mobility Profile"
Description: "Profile for mobility data from iOS Health App"

* status MS
* category 1..1 MS
* category = http://terminology.hl7.org/CodeSystem/observation-category#activity
* code 1..1 MS
* subject 1..1 MS
* effectiveDateTime 1..1 MS
* device 0..1 MS

* component ^slicing.discriminator.type = #pattern
* component ^slicing.discriminator.path = "code"
* component ^slicing.rules = #open

* component contains
    steadiness 0..1 MS and
    balance 0..1 MS and
    gait 0..1 MS and 
    movement 0..1 MS

* component[steadiness].code = $LOINC#LA32-8
* component[balance].code = $LOINC#LA32-9
* component[gait].code = $LOINC#LA29042-4
* component[movement].code = $LOINC#LA29043-2



// ===== Conteúdo de: VitalSignsProfiles.fsh =====

Alias: $SCT = http://snomed.info/sct
Alias: $LOINC = http://loinc.org
Alias: $UCUM = http://unitsofmeasure.org
Alias: $vitalsigns = http://hl7.org/fhir/StructureDefinition/vitalsigns

Profile: LifestyleVitalSigns
Parent: $vitalsigns
Id: lifestyle-vital-signs
Title: "Lifestyle Medicine Vital Signs Profile"
Description: "Profile for vital signs data from iOS Health App"

* status MS
* category 1..* MS
* subject 1..1 MS
* effectiveDateTime 1..1 MS
* code 1..1 MS
* value[x] 0..1 MS
* device 0..1 MS

Profile: HeartRateObservation
Parent: LifestyleVitalSigns
Id: heart-rate-observation
Title: "Heart Rate Observation Profile"
Description: "Profile for heart rate measurements from iOS Health App"

* code = $LOINC#8867-4 "Heart rate"
* valueQuantity only Quantity
* valueQuantity.system = $UCUM
* valueQuantity.code = #/min
* component ^slicing.discriminator.type = #pattern
* component ^slicing.discriminator.path = "code"
* component ^slicing.rules = #open

* component contains
    restingHeartRate 0..1 MS and
    exerciseHeartRate 0..1 MS and
    recoveryHeartRate 0..1 MS and
    heartRateVariability 0..1 MS

* component[heartRateVariability].code = $LOINC#80404-7 "R-R interval.standard deviation (Heart rate variability)"
* component[heartRateVariability].valueQuantity.system = $UCUM
* component[heartRateVariability].valueQuantity.code = #ms

Profile: BloodPressureObservation
Parent: LifestyleVitalSigns
Id: blood-pressure-observation
Title: "Blood Pressure Observation Profile"
Description: "Profile for blood pressure measurements from iOS Health App"

* code = $LOINC#85354-9 "Blood pressure panel with all children optional"
* component 2..2 MS
* component ^slicing.discriminator.type = #pattern
* component ^slicing.discriminator.path = "code"
* component ^slicing.rules = #closed

* component contains
    systolic 1..1 MS and
    diastolic 1..1 MS

* component[systolic].code = $LOINC#8480-6 "Systolic blood pressure"
* component[systolic].valueQuantity only Quantity
* component[systolic].valueQuantity.system = $UCUM
* component[systolic].valueQuantity.code = #mm[Hg]

* component[diastolic].code = $LOINC#8462-4 "Diastolic blood pressure"
* component[diastolic].valueQuantity only Quantity
* component[diastolic].valueQuantity.system = $UCUM
* component[diastolic].valueQuantity.code = #mm[Hg]

Profile: OxygenSaturationObservation
Parent: LifestyleVitalSigns
Id: oxygen-saturation-observation
Title: "Oxygen Saturation Observation Profile"
Description: "Profile for SpO2 measurements from iOS Health App"

* code = $LOINC#2708-6 "Oxygen saturation in Arterial blood"
* valueQuantity.system = $UCUM
* valueQuantity.code = #%



// ===== Conteúdo de: PhysicalActivityProfile.fsh =====

Alias: $LOINC = http://loinc.org
Alias: $SNOMED = http://snomed.info/sct
Alias: $UCUM = http://unitsofmeasure.org
Alias: $ActivityCodes = https://2rdoc.pt/ig/ios-lifestyle-medicine/activity-codes

Profile: PhysicalActivityObservation
Parent: Observation
Id: physical-activity-observation
Title: "Physical Activity Observation Profile"
Description: "Profile for recording physical activity data from iOS Health App"

* status MS
* category 1..1 MS
* category = http://terminology.hl7.org/CodeSystem/observation-category#activity
* code 1..1 MS
* code from PhysicalActivityTypeVS (required)
* subject 1..1 MS
* subject only Reference(Patient)
* effectiveDateTime 1..1 MS
* device 0..1 MS
* value[x] only Quantity
* component ^slicing.discriminator.type = #pattern
* component ^slicing.discriminator.path = "code"
* component ^slicing.rules = #open

* component contains
    steps 0..1 MS and
    distance 0..1 MS and
    duration 0..1 MS and
    energy 0..1 MS

* component[steps].code = $LOINC#55423-8 "Number of steps in 24 hour Measured"
* component[steps].valueQuantity only Quantity
* component[steps].valueQuantity.system = $UCUM
* component[steps].valueQuantity.code = #1 "count"

* component[distance].code = $LOINC#55430-3 "Distance walked"
* component[distance].valueQuantity only Quantity
* component[distance].valueQuantity.system = $UCUM
* component[distance].valueQuantity.code = #km "kilometer"

* component[duration].code = $LOINC#55411-3 "Exercise duration"
* component[duration].valueQuantity only Quantity
* component[duration].valueQuantity.system = $UCUM
* component[duration].valueQuantity.code = #min "minute"

* component[energy].code = $LOINC#55424-6 "Energy expenditure"
* component[energy].valueQuantity only Quantity
* component[energy].valueQuantity.system = $UCUM
* component[energy].valueQuantity.code = #kcal "kilocalorie"



// ===== Conteúdo de: ReproductiveObservation.fsh =====

Profile: ReproductiveObservation
Parent: Observation
Id: reproductive-observation
Title: "Reproductive Health Base Profile"
Description: "Base profile for reproductive health observations"

* ^version = "1.0.0"
* ^status = #active
* ^date = "2024-03-19"

* status MS
* category 1..1 MS
* category = http://terminology.hl7.org/CodeSystem/observation-category#reproductive
* code 1..1 MS
* subject 1..1 MS
* subject only Reference(Patient)
* effectiveDateTime 1..1 MS
* value[x] MS

* component ^slicing.discriminator.type = #pattern
* component ^slicing.discriminator.path = "code"
* component ^slicing.rules = #open

* component contains
    severity 0..1 MS and
    duration 0..1 MS and
    frequency 0..1 MS and
    pattern 0..1 MS

* component[severity]
  * code = $LOINC#72514-3
  * value[x] only integer
  * valueInteger 1..1 
  * valueInteger obeys rep-1

* component[duration]
  * code = $LOINC#103332-8
  * value[x] only Quantity
  * valueQuantity from DurationUnitsVS (required)

* component[frequency]
  * code = $LOINC#103334-4
  * value[x] only CodeableConcept
  * valueCodeableConcept from SymptomFrequencyVS (required)

* component[pattern]
  * code = $LOINC#103335-1
  * value[x] only CodeableConcept
  * valueCodeableConcept from SymptomProgressionVS (required)

Invariant: rep-1
Description: "Severity must be between 0 and 10"
Expression: "$this >= 0 and $this <= 10"
Severity: #error



// ===== Conteúdo de: SymptomProfiles.fsh =====

Profile: SymptomQuestionnaire
Parent: Questionnaire
Id: symptom-questionnaire
Title: "Symptom Assessment Questionnaire"
Description: "Questionnaire template for symptom assessments"

* status MS
* title MS
* item MS

* item ^slicing.discriminator.type = #pattern
* item ^slicing.discriminator.path = "linkId"
* item ^slicing.rules = #open

* item contains
    symptomType 1..1 MS and
    location 0..1 MS and
    onset 0..1 MS and
    description 0..1 MS

* item[symptomType].linkId = "symptom-type"
* item[symptomType].text = "Type of Symptom"
* item[symptomType].type = #choice
* item[symptomType].required = true

* item[location].linkId = "location"
* item[location].text = "Location"
* item[location].type = #string

* item[onset].linkId = "onset"
* item[onset].text = "When did it start?"
* item[onset].type = #dateTime

* item[description].linkId = "description"
* item[description].text = "Description"
* item[description].type = #text



// ===== Conteúdo de: ReproductiveProfiles.fsh =====

Profile: FertilityObservation
Parent: Observation
Id: fertility-observation
Title: "Fertility Observation Profile"
Description: "Profile for fertility signs and symptoms"

* status MS
* category 1..1 MS
* category = http://terminology.hl7.org/CodeSystem/observation-category#reproductive
* code = $LOINC#8669-4 "Ovulation status"
* subject 1..1 MS
* effectiveDateTime 1..1 MS

* component ^slicing.discriminator.type = #pattern
* component ^slicing.discriminator.path = "code"
* component ^slicing.rules = #open

* component contains
    cervicalMucus 0..1 MS and
    ovulationTest 0..1 MS and
    fertilityStatus 0..1 MS

* component[cervicalMucus].valueCodeableConcept from https://2rdoc.pt/fhir/ValueSet/cervical-mucus-vs (required)
* component[ovulationTest].valueCodeableConcept from https://2rdoc.pt/fhir/ValueSet/ovulation-test-vs (required)
* component[fertilityStatus].valueCodeableConcept from https://2rdoc.pt/fhir/ValueSet/fertility-status-vs (required)



// ===== Conteúdo de: MindfulnessProfiles.fsh =====

Profile: MindfulnessObservation
Parent: Observation
Id: mindfulness-observation
Title: "Mindfulness Session Observation"
Description: "Profile for recording mindfulness practice sessions and outcomes"

* status MS
* code MS
* subject MS
* effectiveDateTime MS
* performer MS
* value[x] MS
* component MS

* status = #final
* code = $SCT#711415009 "Mindfulness"
* subject only Reference(Patient)
* effectiveDateTime 1..1
* performer only Reference(Practitioner or PractitionerRole)

* component ^slicing.discriminator.type = #pattern
* component ^slicing.discriminator.path = "code"
* component ^slicing.rules = #open

* component contains
    sessionDuration 0..1 and
    stressLevel 0..1 and
    moodState 0..1 and
    relaxationResponse 0..1 and
    mindfulnessType 0..1

* component[sessionDuration]
  * code = $SCT#118682006 "Duration"
  * value[x] only Quantity
  * valueQuantity
    * value 1..1
    * unit = "min"
    * system = "http://unitsofmeasure.org"
    * code = #min

* component[stressLevel]
  * code = $SCT#725854004 "Assessment of stress level"
  * value[x] only integer
  * valueInteger
    * ^extension[0].url = "http://hl7.org/fhir/StructureDefinition/elementdefinition-minValueInteger"
    * ^extension[0].valueInteger = 0
    * ^extension[1].url = "http://hl7.org/fhir/StructureDefinition/elementdefinition-maxValueInteger"
    * ^extension[1].valueInteger = 10

* component[moodState]
  * code = $SCT#373931001 "Mood finding"
  * value[x] only CodeableConcept
  * valueCodeableConcept from https://2rdoc.pt/fhir/ValueSet/mood (required)

* component[relaxationResponse]
  * code = $SCT#276241001 "Relaxation technique"
  * value[x] only string

* component[mindfulnessType]
  * code = $SCT#711415009 "Mindfulness"
  * value[x] only CodeableConcept
  * valueCodeableConcept from https://2rdoc.pt/fhir/ValueSet/mindfulness-type (required)



// ===== Conteúdo de: SleepProfile.fsh =====

Alias: $SCT = http://snomed.info/sct
Alias: $LOINC = http://loinc.org
Alias: $UCUM = http://unitsofmeasure.org
 
Profile: SleepObservation
Parent: Observation
Id: sleep-observation
Title: "Sleep Observation Profile"
Description: "Profile for recording sleep data from iOS Health App"
 
* status MS
* category 1..1 MS
* category = http://terminology.hl7.org/CodeSystem/observation-category#sleep
* code 1..1 MS
* code = $LOINC#93832-4 "Sleep pattern panel"
* subject 1..1 MS
* subject only Reference(Patient)
* effectiveDateTime 0..1 MS
* effectivePeriod 0..1 MS
* device 0..1 MS
 
* component ^slicing.discriminator.type = #pattern
* component ^slicing.discriminator.path = "code"
* component ^slicing.rules = #open
 
* component contains
    timeInBed 1..1 MS and
    totalSleepTime 1..1 MS and
    deepSleep 0..1 MS and
    remSleep 0..1 MS and
    lightSleep 0..1 MS and
    respiratoryRate 0..1 MS and
    heartRateVariability 0..1 MS and
    interruptions 0..1 MS
 
* component[timeInBed].code = $LOINC#93831-6 "Time in bed"
* component[timeInBed].valueQuantity only Quantity
* component[timeInBed].valueQuantity.system = $UCUM
* component[timeInBed].valueQuantity.code = #min
 
* component[totalSleepTime].code = $LOINC#93833-2 "Sleep duration"
* component[totalSleepTime].valueQuantity only Quantity
* component[totalSleepTime].valueQuantity.system = $UCUM
* component[totalSleepTime].valueQuantity.code = #min
 
* component[deepSleep].code = $LOINC#93834-0 "Deep sleep duration"
* component[deepSleep].valueQuantity only Quantity
* component[deepSleep].valueQuantity.system = $UCUM
* component[deepSleep].valueQuantity.code = #min
 
* component[remSleep].code = $LOINC#93835-7 "REM sleep duration"
* component[remSleep].valueQuantity only Quantity
* component[remSleep].valueQuantity.system = $UCUM
* component[remSleep].valueQuantity.code = #min
 
* component[lightSleep].code = $LOINC#93836-5 "Light sleep duration"
* component[lightSleep].valueQuantity only Quantity
* component[lightSleep].valueQuantity.system = $UCUM
* component[lightSleep].valueQuantity.code = #min
 
* component[respiratoryRate].code = $LOINC#9279-1 "Respiratory rate"
* component[respiratoryRate].valueQuantity only Quantity
* component[respiratoryRate].valueQuantity.system = $UCUM
* component[respiratoryRate].valueQuantity.code = #/min
 
* component[heartRateVariability].code = $LOINC#80404-7 "R-R interval.standard deviation (Heart rate variability)"
* component[heartRateVariability].valueQuantity only Quantity
* component[heartRateVariability].valueQuantity.system = $UCUM
* component[heartRateVariability].valueQuantity.code = #ms
 
* component[interruptions].code = $LOINC#93837-3 "Number of awakenings during sleep"
* component[interruptions].valueQuantity only Quantity
* component[interruptions].valueQuantity.system = $UCUM
* component[interruptions].valueQuantity.code = #{count}
* extension contains SleepQuality named quality 0..1



// ===== Conteúdo de: MobilityRiskAssessment.fsh =====

Profile: MobilityRiskAssessment
Parent: RiskAssessment
Id: mobility-risk-assessment
Title: "Mobility Risk Assessment Profile"
Description: "Profile for assessing mobility-related risks"

* status MS
* subject 1..1 MS
* occurrence[x] MS
* prediction MS
  * outcome MS
  * probability[x] MS
  * qualitativeRisk MS

* method MS
  * coding ^slicing.discriminator.type = #pattern
  * coding ^slicing.discriminator.path = "$this"
  * coding ^slicing.rules = #open
  * coding contains
      mobilityAssessment 1..1 MS

* method.coding[mobilityAssessment] = https://2rdoc.pt/fhir/CodeSystem/mobility-assessment-method#standardized "Standardized Mobility Assessment"

* prediction ^slicing.discriminator.type = #pattern
* prediction ^slicing.discriminator.path = "outcome"
* prediction ^slicing.rules = #open

* prediction contains
    fallRisk 0..1 MS and
    mobilityDecline 0..1 MS and
    assistanceNeeded 0..1 MS

* prediction[fallRisk].outcome from https://2rdoc.pt/fhir/ValueSet/fall-risk-outcomes
* prediction[fallRisk].probabilityDecimal 0..1 MS
* prediction[fallRisk].qualitativeRisk from https://2rdoc.pt/fhir/ValueSet/risk-level

* prediction[mobilityDecline].outcome from https://2rdoc.pt/fhir/ValueSet/mobility-decline-outcomes
* prediction[mobilityDecline].probabilityDecimal 0..1 MS
* prediction[mobilityDecline].qualitativeRisk from https://2rdoc.pt/fhir/ValueSet/risk-level

* prediction[assistanceNeeded].outcome from https://2rdoc.pt/fhir/ValueSet/assistance-level-outcomes
* prediction[assistanceNeeded].probabilityDecimal 0..1 MS
* prediction[assistanceNeeded].qualitativeRisk from https://2rdoc.pt/fhir/ValueSet/risk-level

* basis only Reference(MobilityProfile or Observation or QuestionnaireResponse)
* basis MS

* note MS



// ===== Conteúdo de: EnvironmentalProfiles.fsh =====

Alias: $SCT = http://snomed.info/sct
Alias: $LOINC = http://loinc.org
Alias: $UCUM = http://unitsofmeasure.org

Profile: EnvironmentalObservation
Parent: Observation
Id: environmental-observation
Title: "Environmental Observation Profile"
Description: "Base profile for environmental measurements from iOS Health App"

* ^version = "0.1.0"
* ^status = #draft
* ^publisher = "HL7 International"
* ^contact.name = "Environmental Health Working Group"

* status MS
* category 1..1 MS
* category = http://terminology.hl7.org/CodeSystem/observation-category#environment
* subject 1..1 MS
* effectiveDateTime 1..1 MS
* device 0..1 MS
* method 0..1 MS
* note 0..* MS

Profile: NoiseExposureObservation
Parent: EnvironmentalObservation
Id: noise-exposure-observation
Title: "Noise Exposure Observation Profile"
Description: "Profile for noise exposure measurements from iOS Health App"

* code = $LOINC#28573-7 "Noise exposure time"
* component ^slicing.discriminator.type = #pattern
* component ^slicing.discriminator.path = "code"
* component ^slicing.rules = #open
* component ^short = "Noise exposure components"
* component ^definition = "Components of noise exposure measurement"

* component contains
    level 1..1 MS and
    duration 1..1 MS and
    peakLevel 0..1 MS and
    backgroundNoise 0..1 MS

* component[level].code = $LOINC#89020-2 "Environmental noise average"
* component[level].valueQuantity.system = $UCUM
* component[level].valueQuantity.code = #dB
* component[level].valueQuantity ^short = "Noise level in decibels"

* component[duration].code = $LOINC#89021-0 "Environmental noise duration"
* component[duration].valueQuantity.system = $UCUM
* component[duration].valueQuantity.code = #min
* component[duration].valueQuantity ^short = "Duration of exposure"

* component[peakLevel].code = $LOINC#89024-4 "Peak sound level"
* component[peakLevel].valueQuantity.system = $UCUM
* component[peakLevel].valueQuantity.code = #dB
* component[peakLevel].valueQuantity ^short = "Peak noise level"

* component[backgroundNoise].code = $LOINC#89025-1 "Background noise level"
* component[backgroundNoise].valueQuantity.system = $UCUM
* component[backgroundNoise].valueQuantity.code = #dB
* component[backgroundNoise].valueQuantity ^short = "Background noise level"

Profile: UVExposureObservation
Parent: EnvironmentalObservation
Id: uv-exposure-observation
Title: "UV Exposure Observation Profile"
Description: "Profile for UV exposure measurements from iOS Health App"

* code = $LOINC#28574-5 "UV exposure"
* component ^slicing.discriminator.type = #pattern
* component ^slicing.discriminator.path = "code"
* component ^slicing.rules = #open
* component ^short = "UV exposure components"
* component ^definition = "Components of UV exposure measurement"

* component contains
    index 1..1 MS and
    duration 1..1 MS and
    timeOfDay 0..1 MS and
    intensity 0..1 MS

* component[index].code = $LOINC#89022-8 "UV index"
* component[index].valueQuantity.system = $UCUM
* component[index].valueQuantity.code = #{index}
* component[index].valueQuantity ^short = "UV index value"

* component[duration].code = $LOINC#89023-6 "UV exposure duration"
* component[duration].valueQuantity.system = $UCUM
* component[duration].valueQuantity.code = #min
* component[duration].valueQuantity ^short = "Duration of UV exposure"

* component[timeOfDay].code = $LOINC#89026-9 "Time of exposure"
* component[timeOfDay].valueDateTime 1..1
* component[timeOfDay].valueDateTime ^short = "Time of UV exposure"

* component[intensity].code = $LOINC#89027-7 "UV intensity"
* component[intensity].valueQuantity.system = $UCUM
* component[intensity].valueQuantity.code = #W/m2
* component[intensity].valueQuantity ^short = "UV radiation intensity"

Extension: EnvironmentalContext
Id: environmental-context
Title: "Environmental Context Extension"
Description: "Additional context about environmental measurements"

* value[x] only CodeableConcept
* valueCodeableConcept from https://2rdoc.pt/fhir/ValueSet/environmental-context (required)



// ===== Conteúdo de: SocialInteractionProfile.fsh =====

Profile: SocialInteractionProfile
Parent: Observation
Id: social-interaction
Title: "Social Interaction Profile"
Description: "Profile for recording social interaction data from iOS Health App"

* ^version = "0.1.0"
* ^status = #active
* ^date = "2024-01-03"
* ^publisher = "FMUP HEADS2"

* status MS
* category 1..1 MS
* category = http://terminology.hl7.org/CodeSystem/observation-category#social-history
* code 1..1 MS
* code = $LOINC#96766-1 "Social interaction pattern"
* subject 1..1 MS
* effectiveDateTime 1..1 MS
* value[x] only CodeableConcept
* valueCodeableConcept from SocialInteractionTypeVS (required)

* component ^slicing.discriminator.type = #pattern
* component ^slicing.discriminator.path = "code"
* component ^slicing.rules = #open

* component contains
    duration 0..1 MS and
    quality 0..1 MS and
    medium 0..1 MS and
    participants 0..1 MS

* component[duration]
  * code = $LOINC#89597-9 "Social interaction duration"
  * valueQuantity only Quantity
  * valueQuantity.system = $UCUM
  * valueQuantity.code = #min

* component[quality]
  * code = $LOINC#89598-7 "Social interaction quality"
  * valueCodeableConcept from SocialInteractionQualityVS (required)

* component[medium]
  * code = $LOINC#89599-5 "Social interaction medium"
  * valueCodeableConcept from SocialInteractionMediumVS (required)

* component[participants]
  * code = $LOINC#89600-1 "Social interaction participants"
  * valueInteger only integer

* extension contains
    SocialContext named context 0..1 MS and
    SocialSupport named support 0..1 MS and
    SocialActivity named activity 0..* MS



// ===== Conteúdo de: StressLevelProfile.fsh =====

Profile: StressLevelProfile
Parent: Observation
Id: stress-level
Title: "Stress Level Profile"
Description: "Profile for recording stress level measurements from iOS Health App"

* ^version = "0.1.0"
* ^status = #active
* ^date = "2024-01-03"
* ^publisher = "FMUP HEADS2"

* status MS
* category 1..1 MS
* category = http://terminology.hl7.org/CodeSystem/observation-category#vital-signs
* code 1..1 MS
* code = $LOINC#89592-0 "Stress level score"
* subject 1..1 MS
* effectiveDateTime 1..1 MS
* value[x] only Quantity
* valueQuantity MS

* component ^slicing.discriminator.type = #pattern
* component ^slicing.discriminator.path = "code"
* component ^slicing.rules = #open

* component contains
    physiologicalStress 0..1 MS and
    psychologicalStress 0..1 MS and
    chronicity 0..1 MS and 
    impact 0..1 MS

* component[physiologicalStress]
  * code = $LOINC#89593-8 "Physiological stress"
  * valueQuantity only Quantity
  * valueQuantity.system = $UCUM
  * valueQuantity.code = #{score}

* component[psychologicalStress]
  * code = $LOINC#89594-6 "Psychological stress"
  * valueQuantity only Quantity
  * valueQuantity.system = $UCUM
  * valueQuantity.code = #{score}

* component[chronicity]
  * code = $LOINC#89595-3 "Stress chronicity"
  * valueCodeableConcept from StressChronicityVS (required)

* component[impact]
  * code = $LOINC#89596-1 "Stress impact"
  * valueCodeableConcept from StressImpactVS (required)

* extension contains
    MeasurementContext named context 0..1 MS and
    StressTriggers named triggers 0..* MS and 
    StressCoping named coping 0..* MS



// ===== Conteúdo de: NutritionProfiles.fsh =====

Alias: $SCT = http://snomed.info/sct
Alias: $LOINC = http://loinc.org
Alias: $UCUM = http://unitsofmeasure.org

Profile: NutritionIntakeObservation
Parent: Observation
Id: nutrition-intake-observation
Title: "Nutrition Intake Observation Profile"
Description: "Profile for nutrition intake data from iOS Health App and user input"

* ^version = "0.1.0"
* ^status = #draft
* ^publisher = "Ricardo Lourenço dos Santos"

* status MS
* category 1..1 MS
* category = http://terminology.hl7.org/CodeSystem/observation-category#nutrition
* subject 1..1 MS
* effectiveDateTime 1..1 MS
* code 1..1 MS
* method 0..1 MS

Profile: WaterIntakeObservation
Parent: NutritionIntakeObservation 
Id: water-intake-observation
Title: "Water Intake Observation Profile"
Description: "Profile for water intake measurements"

* ^version = "0.1.0"
* ^status = #draft
* ^publisher = "Ricardo Lourenço dos Santos"

* code = $LOINC#77111-4 "Water intake"
* valueQuantity only Quantity
* valueQuantity.system = $UCUM
* valueQuantity.code = #mL
* valueQuantity.unit = "milliliter"

Profile: CalorieIntakeObservation
Parent: NutritionIntakeObservation
Id: calorie-intake-observation
Title: "Calorie Intake Observation Profile"
Description: "Profile for caloric intake measurements"

* ^version = "0.1.0"
* ^status = #draft
* ^publisher = "Ricardo Lourenço dos Santos"

* code = $LOINC#9051-4 "Caloric intake total"
* valueQuantity only Quantity
* valueQuantity.system = $UCUM
* valueQuantity.code = #kcal
* valueQuantity.unit = "kilocalorie"

Profile: MacronutrientsObservation
Parent: NutritionIntakeObservation
Id: macronutrients-observation
Title: "Macronutrients Observation Profile"
Description: "Profile for macronutrient intake measurements"

* ^version = "0.1.0"
* ^status = #draft
* ^publisher = "Ricardo Lourenço dos Santos"

* code = $LOINC#LP199119-9 "Macronutrients panel"
* component ^slicing.discriminator.type = #pattern
* component ^slicing.discriminator.path = "code"
* component ^slicing.rules = #open

* component contains
    carbohydrates 0..1 MS and
    proteins 0..1 MS and
    fats 0..1 MS

* component[carbohydrates].code = $LOINC#LP35925-4 "Carbohydrates"
* component[carbohydrates].valueQuantity.system = $UCUM
* component[carbohydrates].valueQuantity.code = #g
* component[carbohydrates].valueQuantity.unit = "gram"

* component[proteins].code = $LOINC#LP35921-3 "Proteins" 
* component[proteins].valueQuantity.system = $UCUM
* component[proteins].valueQuantity.code = #g
* component[proteins].valueQuantity.unit = "gram"

* component[fats].code = $LOINC#LP35922-1 "Fats"
* component[fats].valueQuantity.system = $UCUM
* component[fats].valueQuantity.code = #g
* component[fats].valueQuantity.unit = "gram"



// ===== Conteúdo de: MultiJurisdictionalConsent.fsh =====

// ====== Perfil Multi-Jurisdicional de Consent ======

Profile: MultiJurisdictionalConsent
Parent: Consent
Id: multi-jurisdictional-consent
Title: "Multi-Jurisdictional Healthcare Consent"
Description: "Consent profile supporting GDPR, HIPAA, and LGPD compliance"

* status MS
* scope MS
* category MS
* patient 1..1 MS
* dateTime 1..1 MS

// Múltiplas políticas para diferentes jurisdições
* policy 1..* MS
* policy ^slicing.discriminator.type = #value
* policy ^slicing.discriminator.path = "authority"
* policy ^slicing.rules = #open

* policy contains
    gdpr 0..1 MS and
    hipaa 0..1 MS and
    lgpd 0..1 MS

* policy[gdpr].authority = "https://eur-lex.europa.eu/eli/reg/2016/679/oj"
* policy[gdpr].uri 1..1 MS

* policy[hipaa].authority = "https://www.hhs.gov/hipaa/index.html"  
* policy[hipaa].uri 1..1 MS

* policy[lgpd].authority = "http://www.planalto.gov.br/ccivil_03/_ato2015-2018/2018/lei/L13709compilado.htm"
* policy[lgpd].uri 1..1 MS

// Extensões de compliance
* extension contains
    RegulatoryBasis named regulatoryBasis 0..* MS and
    JurisdictionApplicability named jurisdiction 0..* MS and
    DataLocalization named dataLocalization 0..* MS

// Provisions com segurança
* provision MS
* provision.type MS
* provision.period MS
* provision.actor MS
* provision.action MS
* provision.securityLabel MS
* provision.purpose MS
* provision.dataPeriod MS



// ===== Conteúdo de: MindfulnessMessaging.fsh =====

Alias: $MsgEvents = https://2rdoc.pt/fhir/CodeSystem/mindfulness-message-events
Alias: $MsgTypes = http://terminology.hl7.org/CodeSystem/message-type

Profile: MindfulnessMessageDefinition
Parent: MessageDefinition
Id: mindfulness-message-definition
Title: "Mindfulness Message Definition" 
Description: "Definition for mindfulness session messages"

* url 1..1 MS
* date 1..1 MS
* status 1..1 MS
* event[x] 1..1 MS
* category 0..1 MS
* focus 1..* MS
* focus.min 1..1

Instance: StartSessionMessage
InstanceOf: MindfulnessMessageDefinition
Title: "Start Session Message"
Description: "Message definition for starting a mindfulness session"

* url = "https://2rdoc.pt/ig/ios-lifestyle-medicine/MessageDefinition/start-session"
* date = "2024-03-19"
* status = #active
* eventCoding = $MsgEvents#session-start "Session Start"
* category = #notification
* focus.code = #Observation
* focus.min = 1
* focus.profile = "https://2rdoc.pt/ig/ios-lifestyle-medicine/StructureDefinition/mindfulness-session"

Instance: EndSessionMessage  
InstanceOf: MindfulnessMessageDefinition
Title: "End Session Message"
Description: "Message definition for ending a mindfulness session"

* url = "https://2rdoc.pt/ig/ios-lifestyle-medicine/MessageDefinition/end-session"
* date = "2024-03-19"
* status = #active
* eventCoding = $MsgEvents#session-end "Session End"
* category = #notification
* focus.code = #Observation
* focus.min = 1
* focus.profile = "https://2rdoc.pt/ig/ios-lifestyle-medicine/StructureDefinition/mindfulness-session"



// ===== Conteúdo de: PractitionerNamingSystem.fsh =====

// ====== CodeSystem para Identificadores de Practitioners ======

CodeSystem: PractitionerIdentifierCS
Id: practitioner-identifier-cs
Title: "Practitioner Identifier Code System"
Description: "Sistema de códigos para identificação de practitioners"
* ^status = #active
* ^experimental = false
* ^caseSensitive = true
* #npi "National Provider Identifier" "US National Provider Identifier"
* #crm "Conselho Regional de Medicina" "Brazilian Medical Council Registration"
* #ssin "Social Security Identification Number" "Belgian SSIN"
* #rpps "Répertoire Partagé des Professionnels de Santé" "French Healthcare Professional Registry"

ValueSet: PractitionerIdentifierVS
Id: practitioner-identifier-vs
Title: "Practitioner Identifier Value Set"
Description: "Value set para identificadores de practitioners"
* ^status = #active
* ^experimental = false
* include codes from system PractitionerIdentifierCS



// ===== Conteúdo de: MindfulnessReports.fsh =====

Instance: MindfulnessProgressReport
InstanceOf: Measure
Usage: #definition
Title: "Mindfulness Practice Progress Report"
Description: "Example instance of MindfulnessProgressReport"
* status = #active
* experimental = false
* date = "2024-03-19"
* publisher = "Example Organization"
* description = "Measures progress in mindfulness practice over time"

* scoring = #continuous-variable
* type = #process
* riskAdjustment = "none"
* rateAggregation = "Average values over time period"

* group[0]
  * code = #practice-frequency
  * description = "Frequency of mindfulness practice"
  * population[0]
    * code = #denominator
    * criteria.language = #text/fhirpath
    * criteria.expression = "Observation.where(code.coding.code='711415009')"
  * stratifier[0]
    * code = #weekly
    * criteria.language = #text/fhirpath
    * criteria.expression = "Observation.effective.as(DateTime).truncate(@T).truncate(@W)"

* group[1]
  * code = #stress-reduction
  * description = "Stress level changes over time"
  * population[0]
    * code = #denominator
    * criteria.language = #text/fhirpath
    * criteria.expression = "Observation.where(component.code.coding.code='725854004')"
  * stratifier[0]
    * code = #trend
    * criteria.language = #text/fhirpath
    * criteria.expression = "component.where(code.coding.code='725854004').value.value"

RuleSet: ReportingMetrics
* group[+]
  * code = #session-duration
  * description = "Duration of practice sessions"
  * population[0]
    * code = #denominator
    * criteria.language = #text/fhirpath
    * criteria.expression = "Observation.component.where(code.coding.code='118682006')"
  * stratifier[0]
    * code = #average
    * criteria.language = #text/fhirpath
    * criteria.expression = "component.where(code.coding.code='118682006').value.value"

* group[+]
  * code = #mood-changes
  * description = "Mood state changes"
  * population[0]
    * code = #denominator
    * criteria.language = #text/fhirpath
    * criteria.expression = "Observation.component.where(code.coding.code='373931001')"



// ===== Conteúdo de: MindfulnessCapabilities.fsh =====

Instance: MindfulnessCapabilityStatement
InstanceOf: CapabilityStatement
Usage: #definition
Title: "Mindfulness Module Capabilities"
Description: "Capabilities supported by the mindfulness module implementation"

* status = #draft
* date = "2024-03-19"
* kind = #requirements
* fhirVersion = #4.0.1
* format[0] = #json
* format[1] = #xml

* rest[0]
  * mode = #server
  * documentation = "RESTful server capabilities for mindfulness data"
  
  * resource[0]
    * type = #Observation
    * documentation = "Supports mindfulness session observations"
    * profile = "https://2rdoc.pt/ig/ios-lifestyle-medicine/StructureDefinition/mindfulness-observation"
    * interaction[0]
      * code = #read
    * interaction[1]
      * code = #create
    * interaction[2]
      * code = #update
    * interaction[3]
      * code = #search-type
    * searchParam[0]
      * name = "patient"
      * type = #reference
      * documentation = "Search by patient reference"
    * searchParam[1]
      * name = "date"
      * type = #date
      * documentation = "Search by session date"
    * searchParam[2]
      * name = "code"
      * type = #token
      * documentation = "Search by observation type"
      
  * resource[1]
    * type = #Questionnaire
    * documentation = "Supports mindfulness questionnaires"
    * profile = "https://2rdoc.pt/ig/ios-lifestyle-medicine/StructureDefinition/mindfulness-questionnaire"
    * interaction[0]
      * code = #read
    * interaction[1]
      * code = #search-type
    * searchParam[0]
      * name = "title"
      * type = #string
      * documentation = "Search by questionnaire title"
      
  * resource[2]
    * type = #QuestionnaireResponse
    * documentation = "Supports mindfulness questionnaire responses"
    * profile = "https://2rdoc.pt/ig/ios-lifestyle-medicine/StructureDefinition/mindfulness-questionnaire-response"
    * interaction[0]
      * code = #create
    * interaction[1]
      * code = #read
    * interaction[2]
      * code = #search-type
    * searchParam[0]
      * name = "patient"
      * type = #reference
      * documentation = "Search by patient reference"
    * searchParam[1]
      * name = "authored"
      * type = #date
      * documentation = "Search by response date"



// ===== Conteúdo de: MindfulnessQuestionnaires.fsh =====

Instance: DailyMindfulnessQuestionnaire
InstanceOf: Questionnaire
Usage: #definition
Title: "Daily Mindfulness Questionnaire"
Description: "Questionnaire for capturing daily mindfulness practice and associated effects"

* url = "https://2rdoc.pt/ig/ios-lifestyle-medicine/Questionnaire/daily-mindfulness"
* status = #active
* title = "Daily Mindfulness Practice"
* subjectType = #Patient
* version = "1.0.0"
* name = "DailyMindfulnessQuestionnaire"
* date = "2024-03-19"

* item[0]
  * linkId = "mindful_session"
  * text = "Mindfulness Session"
  * type = #group
  * repeats = false

  * item[0]
    * linkId = "session_duration"
    * text = "Session duration (minutes)"
    * type = #integer
    * required = true
    * extension[0].url = "http://hl7.org/fhir/StructureDefinition/minValue"
    * extension[0].valueInteger = 1

  * item[1]
    * linkId = "practice_type"
    * text = "Practice type"
    * type = #choice
    * required = true
    * answerOption[0].valueString = "Meditation"
    * answerOption[1].valueString = "Breathing exercise"
    * answerOption[2].valueString = "Body scan"
    * answerOption[3].valueString = "Mindful walking"

* item[1]
  * linkId = "mood_assessment"
  * text = "Mood Assessment"
  * type = #group

  * item[0]
    * linkId = "current_mood"
    * text = "How is your mood now?"
    * type = #choice
    * required = true
    * answerValueSet = "https://2rdoc.pt/fhir/ValueSet/mood-vs"

  * item[1]
    * linkId = "mood_intensity"
    * text = "Mood intensity (1-5)"
    * type = #integer
    * required = true

* item[2]
  * linkId = "stress_assessment"
  * text = "Stress Assessment"
  * type = #group

  * item[0]
    * linkId = "stress_level"
    * text = "Stress level (0-10)"
    * type = #integer
    * required = true

  * item[1]
    * linkId = "stress_symptoms"
    * text = "Stress symptoms"
    * type = #choice
    * repeats = true
    * answerOption[0].valueString = "Muscle tension"
    * answerOption[1].valueString = "Anxiety"
    * answerOption[2].valueString = "Headache"
    * answerOption[3].valueString = "Fatigue"

* item[3]
  * linkId = "relaxation"
  * text = "Relaxation"
  * type = #group

  * item[0]
    * linkId = "relaxation_duration"
    * text = "Relaxation time (minutes)"
    * type = #integer
    * required = true

  * item[1]
    * linkId = "relaxation_technique"
    * text = "Technique used"
    * type = #choice
    * required = true
    * answerOption[0].valueString = "Deep breathing"
    * answerOption[1].valueString = "Progressive relaxation"
    * answerOption[2].valueString = "Visualization"
    * answerOption[3].valueString = "Mindful awareness"



// ===== Conteúdo de: NutritionQuestionnaires.fsh =====

Instance: DailyNutritionQuestionnaire
InstanceOf: Questionnaire
Usage: #definition
Title: "Daily Nutrition Intake Questionnaire"
Description: "Questionnaire for daily nutrition intake tracking"

* url = "https://2rdoc.pt/ig/ios-lifestyle-medicine/Questionnaire/daily-nutrition"
* version = "0.1.0"
* name = "DailyNutritionQuestionnaire"
* title = "Daily Nutrition Intake"
* status = #active
* experimental = false
* date = "2024-12-14"
* publisher = "Ricardo Lourenço dos Santos"

* item[0]
  * linkId = "water_intake"
  * text = "How much water did you drink today?"
  * type = #quantity
  * required = true
  * repeats = false
  * initial.valueQuantity = 0 'mL'

* item[1]
  * linkId = "meal_record"
  * text = "Meal Records"
  * type = #group
  * repeats = true

  * item[0]
    * linkId = "meal_time"
    * text = "Meal Time"
    * type = #dateTime
    * required = true

  * item[1]
    * linkId = "meal_type"
    * text = "Meal Type"
    * type = #choice
    * required = true
    * answerOption[0].valueString = "Breakfast"
    * answerOption[1].valueString = "Lunch"
    * answerOption[2].valueString = "Dinner"
    * answerOption[3].valueString = "Snack"

  * item[2]
    * linkId = "calories"
    * text = "Estimated Calories"
    * type = #integer
    * required = true

  * item[3]
    * linkId = "macronutrients"
    * text = "Macronutrients"
    * type = #group

    * item[0]
      * linkId = "carbs"
      * text = "Carbohydrates (g)"
      * type = #decimal
      * required = true

    * item[1]
      * linkId = "protein"
      * text = "Proteins (g)"
      * type = #decimal
      * required = true

    * item[2]
      * linkId = "fat"
      * text = "Fats (g)"
      * type = #decimal
      * required = true

* item[2]
  * linkId = "caffeine"
  * text = "Caffeine Intake"
  * type = #group

  * item[0]
    * linkId = "caffeine_amount"
    * text = "Caffeine amount (mg)"
    * type = #integer
    * required = false

  * item[1]
    * linkId = "caffeine_source"
    * text = "Caffeine source"
    * type = #choice
    * repeats = true
    * answerOption[0].valueString = "Coffee"
    * answerOption[1].valueString = "Tea"
    * answerOption[2].valueString = "Soft Drink"
    * answerOption[3].valueString = "Energy Drink"



// ===== Conteúdo de: ReproductiveQuestionnaire.fsh =====

Instance: ReproductiveHealthQuestionnaire
InstanceOf: Questionnaire
Usage: #definition
Title: "Reproductive Health Tracking Questionnaire"
Description: "Daily questionnaire for reproductive health tracking"
 
* status = #active
* url = "https://2rdoc.pt/ig/ios-lifestyle-medicine/Questionnaire/reproductive-health"
* name = "ReproductiveHealthQuestionnaire"
* title = "Reproductive Health Monitoring"
* date = "2024-03-19"
 
* item[0]
  * linkId = "menstrual_cycle"
  * text = "Menstrual Cycle"
  * type = #group
 
  * item[0]
    * linkId = "cycle_start"
    * text = "Cycle started today?"
    * type = #boolean
 
  * item[1]
    * linkId = "flow_intensity"
    * text = "Flow intensity"
    * type = #choice
    * enableWhen
      * question = "cycle_start"
      * operator = #=
      * answerBoolean = true
    * answerOption[0].valueString = "Light"
    * answerOption[1].valueString = "Moderate"
    * answerOption[2].valueString = "Heavy"
 
* item[1]
  * linkId = "symptoms"
  * text = "Symptoms"
  * type = #group
  * repeats = true
 
  * item[0]
    * linkId = "symptom_type"
    * text = "Symptom type"
    * type = #choice
    * answerValueSet = "https://2rdoc.pt/fhir/ValueSet/reproductive-symptoms"
 
  * item[1]
    * linkId = "symptom_severity"
    * text = "Intensity (0-10)"
    * type = #integer
    * extension[0]
      * url = "http://hl7.org/fhir/StructureDefinition/minValue"
      * valueInteger = 0
    * extension[1]
      * url = "http://hl7.org/fhir/StructureDefinition/maxValue"
      * valueInteger = 10
 
* item[2]
  * linkId = "mood_changes"
  * text = "Mood Changes"
  * type = #group

  * item[0]
    * linkId = "mood_type"
    * text = "Current mood"
    * type = #choice
    * answerValueSet = "https://2rdoc.pt/fhir/ValueSet/mood-types"

  * item[1]
    * linkId = "mood_severity"
    * text = "Intensity (0-10)"
    * type = #integer
    * extension[0]
      * url = "http://hl7.org/fhir/StructureDefinition/minValue"
      * valueInteger = 0
    * extension[1]
      * url = "http://hl7.org/fhir/StructureDefinition/maxValue"
      * valueInteger = 10



// ===== Conteúdo de: aliases.fsh =====

Alias: SCT = http://snomed.info/sct
Alias: LOINC = http://loinc.org
Alias: UCUM = http://unitsofmeasure.org



// ===== Conteúdo de: MindfulnessTerminology.fsh =====

CodeSystem: MindfulnessOutcomeCS
Id: mindfulness-outcome-cs
Title: "Mindfulness Outcomes"
Description: "Outcomes and effects of mindfulness practice"

* ^experimental = false
* ^caseSensitive = true
* #increasedAwareness "Increased Awareness" "Greater awareness of thoughts and sensations"
* #improvedFocus "Improved Focus" "Enhanced ability to concentrate"
* #stressReduction "Stress Reduction" "Decreased levels of stress and tension"
* #emotionalBalance "Emotional Balance" "Better emotional regulation"
* #improvedSleep "Improved Sleep" "Enhanced sleep quality"

ValueSet: MindfulnessOutcomeVS
Id: mindfulness-outcome-vs
Title: "Mindfulness Outcomes Value Set"
Description: "Value set for mindfulness practice outcomes"

* ^experimental = false
* include codes from system MindfulnessOutcomeCS
* include $SCT#365949003 "Finding of level of stress"
* include $SCT#373931001 "Mood finding"

CodeSystem: MindfulnessQualifierCS
Id: mindfulness-qualifier-cs
Title: "Mindfulness Practice Qualifiers"
Description: "Qualifiers for mindfulness practice characteristics"

* ^experimental = false
* ^caseSensitive = true
* #guided "Guided Practice" "Practice with guidance or instruction"
* #selfDirected "Self-Directed" "Independent practice"
* #group "Group Practice" "Practice in group setting"
* #individual "Individual Practice" "Solo practice session"

ValueSet: MindfulnessQualifierVS
Id: mindfulness-qualifier-vs
Title: "Mindfulness Practice Qualifiers Value Set"
Description: "Value set for mindfulness practice qualifiers"

* ^experimental = false
* include codes from system MindfulnessQualifierCS
* include $SCT#410534003 "Guided meditation"
* include $SCT#225386006 "Exercise therapy"

* ^copyright = "This value set includes content from SNOMED CT, which is copyright © 2002+ International Health Terminology Standards Development Organisation (IHTSDO)"



// ===== Conteúdo de: MindfulnessConfig.fsh =====

Extension: MindfulnessSessionDuration
Id: mindfulness-session-duration
Title: "Mindfulness Session Duration"
Description: "Default duration for mindfulness sessions in minutes"
* value[x] only integer

Extension: MindfulnessReminderTime
Id: mindfulness-reminder-time
Title: "Mindfulness Reminder Time"
Description: "Default time for daily reminders"
* value[x] only time

Extension: MindfulnessPreferredGuide
Id: mindfulness-preferred-guide
Title: "Mindfulness Preferred Guide"
Description: "Preferred guide for mindfulness sessions"
* value[x] only string

Extension: MindfulnessNotificationEnabled
Id: mindfulness-notification-enabled
Title: "Mindfulness Notification Enabled"
Description: "Whether notifications are enabled for mindfulness sessions"
* value[x] only boolean

Profile: MindfulnessConfiguration
Parent: Basic
Id: mindfulness-configuration
Title: "Mindfulness Configuration"
Description: "Configuration settings for mindfulness sessions"

* code 1..1 MS
* code = https://2rdoc.pt/fhir/CodeSystem/mindfulness-config-type#settings "Mindfulness Settings"

* extension contains
    MindfulnessSessionDuration named sessionDuration 1..1 MS and
    MindfulnessReminderTime named reminderTime 1..1 MS and
    MindfulnessPreferredGuide named preferredGuide 0..1 MS and
    MindfulnessNotificationEnabled named notificationEnabled 1..1 MS

Instance: DefaultMindfulnessConfig
InstanceOf: MindfulnessConfiguration
Title: "Default Mindfulness Configuration"
Description: "Default configuration settings for mindfulness sessions"

* code = https://2rdoc.pt/fhir/CodeSystem/mindfulness-config-type#settings "Mindfulness Settings"
* extension[sessionDuration].valueInteger = 15
* extension[reminderTime].valueTime = "08:00:00"
* extension[preferredGuide].valueString = "Jane Smith"
* extension[notificationEnabled].valueBoolean = true



// ===== Conteúdo de: MindfulnessAuditConfig.fsh =====

Extension: MindfulnessAuditLevel
Id: mindfulness-audit-level
Title: "Mindfulness Audit Level"
Description: "Level of detail for audit records"
* value[x] only code
* valueCode from https://2rdoc.pt/fhir/ValueSet/audit-levels (required)

Extension: MindfulnessAuditRetention
Id: mindfulness-audit-retention
Title: "Mindfulness Audit Retention"
Description: "Period to retain audit records"
* value[x] only Duration

Extension: MindfulnessAuditFormat
Id: mindfulness-audit-format
Title: "Mindfulness Audit Format"
Description: "Format for audit records"
* value[x] only code
* valueCode from https://2rdoc.pt/fhir/ValueSet/audit-formats (required)

Profile: MindfulnessAuditConfig
Parent: Basic
Id: mindfulness-audit-config
Title: "Mindfulness Audit Configuration"
Description: "Configuration for mindfulness session auditing"

* code 1..1 MS
* code = https://2rdoc.pt/fhir/CodeSystem/mindfulness-config-type#audit "Audit Configuration"

* extension contains
    MindfulnessAuditLevel named auditLevel 1..1 MS and
    MindfulnessAuditRetention named auditRetention 1..1 MS and
    MindfulnessAuditFormat named auditFormat 1..1 MS

Instance: DefaultAuditConfig
InstanceOf: MindfulnessAuditConfig
Title: "Default Audit Configuration"
Description: "Default configuration for mindfulness session auditing"

* code = https://2rdoc.pt/fhir/CodeSystem/mindfulness-config-type#audit "Audit Configuration"
* extension[auditLevel].valueCode = #detailed
* extension[auditRetention].valueDuration = 90 'days'
* extension[auditFormat].valueCode = #fhir



// ===== Conteúdo de: MindfulnessSecurity.fsh =====

// ====== Mindfulness Security and Consent Resources ======

Instance: MindfulnessSecurityDefinition
InstanceOf: Consent
Usage: #example
* status = #active
* scope = $consentscope#patient-privacy "Privacy Consent"
* category[0] = $loinc#59284-0 "Patient Consent"
* patient = Reference(Patient/PatientMindfulness)
* dateTime = "2024-01-01"
* organization = Reference(Organization/Org2RDoc)
* policy[0].authority = "http://terminology.hl7.org/CodeSystem/consentpolicycodes"
* policy[0].uri = "http://terminology.hl7.org/CodeSystem/consentpolicycodes"
* provision.type = #permit
* provision.period.start = "2024-01-01"
* provision.period.end = "2025-12-31"
* provision.actor[0].role = $v3-RoleCode#TREAT "treatment"
* provision.actor[0].reference.identifier.system = "http://terminology.hl7.org/CodeSystem/practitioner-identifier"
* provision.actor[0].reference.identifier.value = "1234567890"
* provision.securityLabel[0] = $v3-Confidentiality#N "normal"
* provision.purpose[0] = $v3-ActReason#TREAT "treatment"
* provision.dataPeriod.start = "2024-01-01"
* provision.dataPeriod.end = "2025-12-31"

Instance: MindfulnessAccessPolicy
InstanceOf: Consent
Usage: #example
* status = #active
* scope = $consentscope#patient-privacy "Privacy Consent"
* category[0] = $loinc#59284-0 "Patient Consent"
* patient = Reference(Patient/PatientMindfulness)
* dateTime = "2024-01-01"
* organization = Reference(Organization/Org2RDoc)

// Políticas multi-jurisdicionais - começando do índice 0
* policy[0].authority = "http://terminology.hl7.org/CodeSystem/consentpolicycodes"
* policy[0].uri = "http://terminology.hl7.org/CodeSystem/consentpolicycodes"

// GDPR - Europa
* policy[1].authority = "https://eur-lex.europa.eu/eli/reg/2016/679/oj"
* policy[1].uri = "https://health.ec.europa.eu/ehealth-digital-health-and-care/european-health-data-space-regulation-ehds_en"

// HIPAA - Estados Unidos
* policy[2].authority = "https://www.hhs.gov/hipaa/index.html"
* policy[2].uri = "https://www.hhs.gov/hipaa/for-professionals/privacy/laws-regulations/index.html"

// LGPD - Brasil
* policy[3].authority = "http://www.planalto.gov.br/ccivil_03/_ato2015-2018/2018/lei/L13709compilado.htm"
* policy[3].uri = "https://www.gov.br/anpd/pt-br/"

* provision.type = #permit
* provision.period.start = "2024-01-01"
* provision.period.end = "2025-12-31"
* provision.actor[0].role = $v3-RoleCode#TREAT "treatment"
* provision.actor[0].reference.identifier.system = "http://terminology.hl7.org/CodeSystem/practitioner-identifier"
* provision.actor[0].reference.identifier.value = "1234567890"
* provision.action[0] = $consentaction#access "Access"
* provision.action[1] = $consentaction#use "Use"
* provision.purpose[0] = $v3-ActReason#TREAT "treatment"
* provision.purpose[1] = $v3-ActReason#HPAYMT "healthcare payment"
* provision.purpose[2] = $v3-ActReason#HOPERAT "healthcare operations"
* provision.dataPeriod.start = "2024-01-01"
* provision.dataPeriod.end = "2025-12-31"

// ====== Aliases para simplificar referências ======
Alias: $consentscope = http://terminology.hl7.org/CodeSystem/consentscope
Alias: $loinc = http://loinc.org
Alias: $v3-RoleCode = http://terminology.hl7.org/CodeSystem/v3-RoleCode
Alias: $v3-Confidentiality = http://terminology.hl7.org/CodeSystem/v3-Confidentiality
Alias: $v3-ActReason = http://terminology.hl7.org/CodeSystem/v3-ActReason
Alias: $consentaction = http://terminology.hl7.org/CodeSystem/consentaction



// ===== Conteúdo de: MindfulnessResources.fsh =====

CodeSystem: MindfulnessTypeCS
Id: mindfulness-type-cs
Title: "Mindfulness Practice Types"
Description: "Types of mindfulness practices and techniques"
* ^experimental = false
* ^caseSensitive = true
* #meditation "Meditation" "Focused meditation practice"
* #breathing "Breathing Exercise" "Conscious breathing techniques"
* #bodyScan "Body Scan" "Progressive body awareness practice"
* #walking "Mindful Walking" "Walking meditation practice"
* #movement "Mindful Movement" "Conscious movement practice"

CodeSystem: EnvironmentTypeCS
Id: environment-type-cs
Title: "Practice Environment Types"
Description: "Types of environments for mindfulness practice"
* ^experimental = false
* ^caseSensitive = true
* #indoor "Indoor" "Indoor environment"
* #outdoor "Outdoor" "Outdoor environment"
* #quiet "Quiet Space" "Quiet or silent environment"
* #group "Group Setting" "Group practice environment"

ValueSet: MindfulnessTypeVS
Id: mindfulness-type-vs
Title: "Mindfulness Practice Types Value Set"
Description: "Value set of mindfulness practice types"
* ^experimental = false
* include codes from system MindfulnessTypeCS

ValueSet: EnvironmentTypeVS
Id: environment-type-vs
Title: "Practice Environment Types Value Set"
Description: "Value set of practice environment types"
* ^experimental = false
* include codes from system EnvironmentTypeCS

Instance: MindfulnessSettingCS
InstanceOf: CodeSystem
Usage: #definition
* url = "https://2rdoc.pt/ig/ios-lifestyle-medicine/CodeSystem/mindfulness-setting"
* version = "1.0.0"
* name = "MindfulnessSettingCS"
* title = "Mindfulness Setting CodeSystem"
* status = #active
* experimental = false
* caseSensitive = true
* content = #complete
* count = 5
* concept[+].code = #home
* concept[=].display = "Home Practice"
* concept[+].code = #clinic
* concept[=].display = "Clinical Setting"
* concept[+].code = #group
* concept[=].display = "Group Setting"
* concept[+].code = #retreat
* concept[=].display = "Retreat Setting"
* concept[+].code = #workplace
* concept[=].display = "Workplace Setting"



// ===== Conteúdo de: MindfulnessNarrative.fsh =====

RuleSet: MindfulnessObservationNarrative
* text.status = #generated
* text.div = "<div xmlns=\"http://www.w3.org/1999/xhtml\">
    <p><b>Generated Narrative</b></p>
    <p><b>Session Type:</b> Mindfulness Practice Session</p>
    <p><b>Date:</b> {effectiveDateTime}</p>
    <p><b>Duration:</b> {component[sessionDuration].value} minutes</p>
    <p><b>Stress Level:</b> {component[stressLevel].value} / 10</p>
    <p><b>Mood:</b> {component[moodState].value}</p>
    <p><b>Technique:</b> {component[relaxationResponse].value}</p>
    <p><b>Location:</b> {extension[mindfulness-context].extension[location].value}</p>
  </div>"

RuleSet: MindfulnessQuestionnaireNarrative
* text.status = #generated
* text.div = "<div xmlns=\"http://www.w3.org/1999/xhtml\">
    <p><b>Generated Narrative</b></p>
    <p><b>Title:</b> {title}</p>
    <p><b>Status:</b> {status}</p>
    <h3>Sections</h3>
    <ul>
      <li>Mindfulness Session</li>
      <li>Mood Assessment</li>
      <li>Stress Assessment</li>
      <li>Relaxation</li>
    </ul>
  </div>"

RuleSet: MindfulnessResponseNarrative
* text.status = #generated
* text.div = "<div xmlns=\"http://www.w3.org/1999/xhtml\">
    <p><b>Generated Narrative</b></p>
    <p><b>Date:</b> {authored}</p>
    <p><b>Session Duration:</b> {item[session_duration].answer.value} minutes</p>
    <p><b>Practice Type:</b> {item[practice_type].answer.value}</p>
    <p><b>Mood:</b> {item[current_mood].answer.value}</p>
    <p><b>Stress Level:</b> {item[stress_level].answer.value} / 10</p>
    <p><b>Relaxation Technique:</b> {item[relaxation_technique].answer.value}</p>
  </div>"

RuleSet: MindfulnessConfigNarrative
* text.status = #generated
* text.div = "<div xmlns=\"http://www.w3.org/1999/xhtml\">
    <p><b>Generated Narrative</b></p>
    <p><b>Default Duration:</b> {extension[defaultDuration].value} minutes</p>
    <p><b>Reminders:</b> {extension[reminderSettings].value}</p>
    <p><b>Data Sync:</b> {extension[dataSync].value}</p>
  </div>"



// ===== Conteúdo de: StressInvariants.fsh =====

Invariant: stress-level-range
Description: "Stress level score must be between 0 and 10"
Expression: "valueQuantity.exists() implies (valueQuantity.value >= 0 and valueQuantity.value <= 10)"
Severity: #error

Invariant: stress-component-consistency
Description: "Physiological and psychological stress scores must be consistent with overall score"
Expression: "component.where(code.coding.code='89593-8').value.exists() and component.where(code.coding.code='89594-6').value.exists() implies (component.where(code.coding.code='89593-8').value + component.where(code.coding.code='89594-6').value) div 2 = valueQuantity"
Severity: #warning



// ===== Conteúdo de: SocialInteractionInvariants.fsh =====

Invariant: social-interaction-duration
Description: "Social interaction duration must be positive"
Expression: "component.where(code.coding.code='89597-9').value.exists() implies component.where(code.coding.code='89597-9').value > 0"
Severity: #error

Invariant: social-interaction-participants
Description: "Number of participants must be at least 2 for social interaction"
Expression: "component.where(code.coding.code='89600-1').value.exists() implies component.where(code.coding.code='89600-1').value >= 2"
Severity: #error



// ===== Conteúdo de: MindfulnessInvariants.fsh =====

Invariant: mindfulness-session-duration
Description: "Mindfulness session duration must be between 1 and 180 minutes"
Expression: "component.where(code.coding.system='http://snomed.info/sct' and code.coding.code='118682006').value.ofType(Quantity).value.exists() implies (component.where(code.coding.system='http://snomed.info/sct' and code.coding.code='118682006').value.ofType(Quantity).value >= 1 and component.where(code.coding.system='http://snomed.info/sct' and code.coding.code='118682006').value.ofType(Quantity).value <= 180)"
Severity: #error

Invariant: mindfulness-stress-level
Description: "Stress level must be between 0 and 10"
Expression: "component.where(code.coding.system='http://snomed.info/sct' and code.coding.code='725854004').value.ofType(Integer).exists() implies (component.where(code.coding.system='http://snomed.info/sct' and code.coding.code='725854004').value.ofType(Integer) >= 0 and component.where(code.coding.system='http://snomed.info/sct' and code.coding.code='725854004').value.ofType(Integer) <= 10)"
Severity: #error

Invariant: mindfulness-mood-required
Description: "Mood assessment must include a mood state and intensity"
Expression: "component.where(code.coding.system='http://snomed.info/sct' and code.coding.code='373931001').exists() implies component.where(code.coding.system='http://snomed.info/sct' and code.coding.code='373931001').value.exists()"
Severity: #warning

Invariant: mindfulness-context-complete
Description: "Mindfulness context should include location and environment"
Expression: "extension.where(url='https://2rdoc.pt/ig/ios-lifestyle-medicine/StructureDefinition/mindfulness-context').exists() implies (extension.where(url='https://2rdoc.pt/ig/ios-lifestyle-medicine/StructureDefinition/mindfulness-context').extension.where(url='location').exists() and extension.where(url='https://2rdoc.pt/ig/ios-lifestyle-medicine/StructureDefinition/mindfulness-context').extension.where(url='environment').exists())"
Severity: #warning

Invariant: sequential-measurements
Description: "Sequential measurements must have increasing effectiveDateTime"
Expression: "component.where(code.coding.system='http://snomed.info/sct' and code.coding.code='118682006').exists() implies (effectiveDateTime > previous().effectiveDateTime)"
Severity: #warning



// ===== Conteúdo de: MindfulnessOperations.fsh =====

Profile: MindfulnessOperation
Parent: OperationDefinition 
Id: mindfulness-operation
Title: "Mindfulness Operation"
Description: "Base definition for mindfulness operations"

* status 1..1
* kind 1..1
* name 1..1
* code 1..1
* resource 1..1
* system 1..1
* type 1..1
* instance 1..1
* parameter 0..*
* parameter.name 1..1

Instance: StartSessionOperation
InstanceOf: MindfulnessOperation
Title: "Start Session Operation"
Description: "Operation to start a new mindfulness session"

* status = #active
* kind = #operation
* name = "start-session"
* code = #start
* resource = #Observation
* system = false
* type = true
* instance = false
* parameter[+]
  * name = #duration
  * use = #in
  * min = 1
  * max = "1" 
  * type = #integer
  * documentation = "Duration in minutes"

Instance: EndSessionOperation
InstanceOf: MindfulnessOperation
Title: "End Session Operation"
Description: "Operation to end an ongoing mindfulness session"

* status = #active
* kind = #operation
* name = "end-session"
* code = #end
* resource = #Observation
* system = false
* type = true
* instance = true
* parameter[+]
  * name = #session
  * use = #in
  * min = 1
  * max = "1"
  * type = #string
  * documentation = "ID of the session to end"



// ===== Conteúdo de: VitalSignsExtensions.fsh =====

Extension: MeasurementContext
Id: measurement-context
Title: "Measurement Context Extension"
* ^experimental = false
Description: "Additional context about the vital sign measurement"
* value[x] only CodeableConcept
* valueCodeableConcept from MeasurementContextVS (required)

ValueSet: MeasurementContextVitalSigns
Id: measurement-context-vital-signs
Description: "Value set for measurement context in vital signs observations"Title: "Measurement Context Value Set"
* $SCT#255214003 "At rest"
* $SCT#309604004 "During exercise"
* $SCT#309605003 "Post exercise"
* $SCT#248626006 "During sleep"



// ===== Conteúdo de: NutritionExtensions.fsh =====

Extension: NutritionDataSource
Id: nutrition-data-source
Title: "Nutrition Data Source Extension"
Description: "Indicates the source of nutrition data"

* ^version = "0.1.0"
* ^status = #draft
* ^experimental = false
* ^date = "2024-12-14"
* ^publisher = "Ricardo Lourenço dos Santos"
* ^context[0].type = #element
* ^context[0].expression = "Observation"

* value[x] only CodeableConcept
* valueCodeableConcept from NutritionDataSourceVS (required)

ValueSet: NutritionDataSourceVS
Id: nutrition-data-source-vs
Title: "Nutrition Data Source Value Set"
Description: "Value set for nutrition data sources"

* ^version = "0.1.0"
* ^status = #draft
* ^experimental = false
* ^date = "2024-12-14"
* ^publisher = "Ricardo Lourenço dos Santos"

* codes from system NutritionDataSourceCS

CodeSystem: NutritionDataSourceCS
Id: nutrition-data-source-cs
Title: "Nutrition Data Source Code System"
Description: "Code system for nutrition data sources"

* ^version = "0.1.0"
* ^status = #draft
* ^experimental = false
* ^date = "2024-12-14"
* ^publisher = "Ricardo Lourenço dos Santos"
* ^caseSensitive = true

* #manual "Manual Entry" "Data entered manually by user"
* #app "App Integration" "Data from integrated third-party apps"
* #device "Connected Device" "Data from connected nutrition tracking devices"
* #questionnaire "Questionnaire Response" "Data collected through questionnaires"



// ===== Conteúdo de: AdvancedVitalSignsExtensions.fsh =====

Alias: $UCUM = http://unitsofmeasure.org

Extension: PhysiologicalStressIndex
Id: physiological-stress-index
Title: "Physiological Stress Index Extension"
Description: "Index representing overall physiological stress based on multiple parameters"

* ^version = "0.1.0"
* ^status = #draft
* ^context[+].type = #element
* ^context[=].expression = "Observation"

* value[x] only Quantity
* valueQuantity.system = $UCUM
* valueQuantity.code = #{index}
* valueQuantity ^short = "Physiological stress index value"
* valueQuantity ^definition = "Normalized index value representing overall physiological stress"

Extension: HomeostasisIndex
Id: homeostasis-index
Title: "Homeostasis Index Extension"
Description: "Composite measure of physiological balance and adaptation"

* ^version = "0.1.0"
* ^status = #draft
* ^context[+].type = #element
* ^context[=].expression = "Observation"

* value[x] only Quantity
* valueQuantity.system = $UCUM
* valueQuantity.code = #{ratio}
* valueQuantity ^short = "Homeostasis index value"
* valueQuantity ^definition = "Normalized ratio representing physiological balance"

Extension: RecoveryEfficiency
Id: recovery-efficiency
Title: "Recovery Efficiency Extension"
Description: "Measure of how efficiently the body recovers from stress or exertion"

* ^version = "0.1.0"
* ^status = #draft
* ^context[+].type = #element
* ^context[=].expression = "Observation"

* value[x] only Quantity
* valueQuantity.system = $UCUM
* valueQuantity.code = #%
* valueQuantity ^short = "Recovery efficiency percentage"
* valueQuantity ^definition = "Percentage indicating recovery efficiency"

Extension: AllostaticLoad
Id: allostatic-load
Title: "Allostatic Load Extension"
Description: "Measure of cumulative physiological burden over time"

* ^version = "0.1.0"
* ^status = #draft
* ^context[+].type = #element
* ^context[=].expression = "Observation"

* value[x] only Quantity
* valueQuantity.system = $UCUM
* valueQuantity.code = #{score}
* valueQuantity ^short = "Allostatic load score"
* valueQuantity ^definition = "Score representing cumulative physiological burden"

Extension: CircadianPhase
Id: circadian-phase
Title: "Circadian Phase Extension"
Description: "Indicator of position in circadian rhythm cycle"

* ^version = "0.1.0"
* ^status = #draft
* ^context[+].type = #element
* ^context[=].expression = "Observation"

* value[x] only CodeableConcept
* valueCodeableConcept from CircadianPhaseVS (required)

ValueSet: CircadianPhaseVS
Id: circadian-phase-vs
Title: "Circadian Phase Value Set"
Description: "Value set for circadian rhythm phases"

* ^experimental = true
* codes from system CircadianPhaseCS

CodeSystem: CircadianPhaseCS
Id: circadian-phase-cs
Title: "Circadian Phase Code System"
Description: "Code system for circadian rhythm phases"

* ^experimental = true
* ^caseSensitive = true

* #early-morning "Early Morning Phase" "Period shortly after awakening"
* #mid-morning "Mid Morning Phase" "Mid-morning period"
* #afternoon "Afternoon Phase" "Afternoon period"
* #evening "Evening Phase" "Evening period"
* #night "Night Phase" "Nighttime period"
* #deep-night "Deep Night Phase" "Deep night period"

Extension: MeasurementQuality
Id: measurement-quality
Title: "Measurement Quality Extension"
Description: "Indicator of the quality and reliability of the measurement"

* ^version = "0.1.0"
* ^status = #draft
* ^context[+].type = #element
* ^context[=].expression = "Observation"

* value[x] only CodeableConcept
* valueCodeableConcept from MeasurementQualityVS (required)

ValueSet: MeasurementQualityVS
Id: measurement-quality-vs
Title: "Measurement Quality Value Set"
Description: "Value set for measurement quality indicators"

* ^experimental = true
* codes from system MeasurementQualityCS

CodeSystem: MeasurementQualityCS
Id: measurement-quality-cs
Title: "Measurement Quality Code System"
Description: "Code system for measurement quality indicators"

* ^experimental = true
* ^caseSensitive = true

* #excellent "Excellent Quality" "High quality measurement with minimal noise"
* #good "Good Quality" "Good quality measurement with acceptable noise"
* #fair "Fair Quality" "Fair quality measurement with some interference"
* #poor "Poor Quality" "Poor quality measurement with significant interference"
* #unreliable "Unreliable" "Unreliable measurement requiring verification"



// ===== Conteúdo de: StressExtensions.fsh =====

Extension: StressTriggers
Id: stress-triggers
Title: "Stress Triggers Extension"
* ^experimental = false
Description: "Extension for recording identified stress triggers"
* value[x] only CodeableConcept
* valueCodeableConcept from StressTriggersVS (required)

Extension: StressCoping
Id: stress-coping
Title: "Stress Coping Extension"
* ^experimental = false
Description: "Extension for recording stress coping mechanisms"
* value[x] only CodeableConcept
* valueCodeableConcept from StressCopingVS (required)

ValueSet: StressTriggersVS
Id: stress-triggers-vs
Title: "Stress Triggers Value Set"
* ^experimental = false
Description: "Value set for common stress triggers"
* codes from system StressTriggersCS

ValueSet: StressCopingVS
Id: stress-coping-vs
Title: "Stress Coping Value Set"
* ^experimental = false
Description: "Value set for stress coping mechanisms"
* codes from system StressCopingCS

CodeSystem: StressTriggersCS
Id: stress-triggers-cs
Title: "Stress Triggers Code System"
* ^experimental = false
Description: "Code system for common stress triggers"
* #work "Work-related" "Stress from work or professional activities"
* #financial "Financial" "Financial-related stress"
* #relationships "Relationships" "Stress from personal relationships"
* #health "Health" "Health-related concerns"
* #environment "Environmental" "Environmental factors"
* #time "Time Management" "Time pressure and deadlines"
* #change "Life Changes" "Major life changes or transitions"

CodeSystem: StressCopingCS
Id: stress-coping-cs
Title: "Stress Coping Code System"
* ^experimental = false
Description: "Code system for stress coping mechanisms"
* #exercise "Physical Exercise" "Using exercise to manage stress"
* #meditation "Meditation" "Meditation and mindfulness practices"
* #social "Social Support" "Seeking social support"
* #professional "Professional Help" "Seeking professional assistance"
* #relaxation "Relaxation" "Relaxation techniques"
* #creative "Creative Activities" "Engaging in creative activities"
* #nature "Nature" "Spending time in nature"



// ===== Conteúdo de: EnvironmentalExtensions.fsh =====

Extension: ExposureLocation
Id: exposure-location
Title: "Exposure Location Extension"
Description: "Extension for recording location of environmental exposure measurement"

* ^version = "0.1.0"
* ^status = #draft
* ^context[+].type = #element
* ^context[=].expression = "Observation"

* value[x] only CodeableConcept
* valueCodeableConcept from ExposureLocationVS (required)
* valueCodeableConcept ^short = "Location type of exposure"
* valueCodeableConcept ^definition = "Categorizes the type of location where environmental exposure occurred"

Extension: ExposureConditions
Id: exposure-conditions
Title: "Exposure Conditions Extension"
Description: "Additional conditions during environmental exposure measurement"

* ^version = "0.1.0"
* ^status = #draft
* ^context[+].type = #element
* ^context[=].expression = "Observation"

* value[x] only CodeableConcept
* valueCodeableConcept from ExposureConditionsVS (required)
* valueCodeableConcept ^short = "Conditions during exposure"

ValueSet: ExposureLocationVS
Id: exposure-location-vs
Title: "Exposure Location Value Set"
Description: "Value set for environmental exposure locations"

* ^version = "0.1.0"
* ^status = #draft
* ^experimental = true
* codes from system ExposureLocationCS

ValueSet: ExposureConditionsVS
Id: exposure-conditions-vs
Title: "Exposure Conditions Value Set"
Description: "Value set for environmental exposure conditions"

* ^version = "0.1.0"
* ^status = #draft
* ^experimental = true
* codes from system ExposureConditionsCS

CodeSystem: ExposureLocationCS
Id: exposure-location-cs
Title: "Exposure Location Code System"
Description: "Code system for environmental exposure locations"

* ^version = "0.1.0"
* ^status = #draft
* ^caseSensitive = true
* ^experimental = true

* #indoor "Indoor environment" "Environment within buildings or enclosed spaces"
* #outdoor "Outdoor environment" "Open-air environment"
* #workplace "Workplace" "Professional or occupational environment"
* #transit "In transit" "While in transportation or commuting"
* #recreational "Recreational area" "Leisure or sports facilities"
* #urban "Urban area" "City or densely populated area"
* #rural "Rural area" "Countryside or sparsely populated area"

CodeSystem: ExposureConditionsCS
Id: exposure-conditions-cs
Title: "Exposure Conditions Code System"
Description: "Code system for conditions during environmental exposure"

* ^version = "0.1.0"
* ^status = #draft
* ^caseSensitive = true
* ^experimental = true

* #normal "Normal conditions" "Standard environmental conditions"
* #extreme "Extreme conditions" "Unusual or severe environmental conditions"
* #controlled "Controlled environment" "Environment with controlled conditions"
* #variable "Variable conditions" "Changing environmental conditions"



// ===== Conteúdo de: BodyMetricsExtensions.fsh =====

Alias: $SCT = http://snomed.info/sct

Extension: MeasurementConditions
Id: measurement-conditions
Title: "Measurement Conditions Extension"
* ^experimental = false
Description: "Records the conditions under which body measurements were taken"

* ^version = "0.1.0"
* ^status = #draft
* ^context[0].type = #element
* ^context[0].expression = "Observation"

* value[x] only CodeableConcept
* valueCodeableConcept from MeasurementConditionsVS (required)

Extension: MeasurementDevice
Id: measurement-device-type
Title: "Measurement Device Type Extension"
* ^experimental = false
Description: "Specifies the type of device used for body measurements"

* ^version = "0.1.0"
* ^status = #draft
* ^context[0].type = #element
* ^context[0].expression = "Observation"

* value[x] only CodeableConcept
* valueCodeableConcept from MeasurementDeviceTypeVS (required)

ValueSet: MeasurementConditionsVS
Id: measurement-conditions-vs
Title: "Measurement Conditions Value Set"
* ^experimental = false
Description: "Standard conditions under which measurements are taken"

* ^version = "0.1.0"
* ^status = #draft

* $SCT#307818003 "Pre-breakfast"
* $SCT#307819006 "Post-exercise"
* $SCT#307820000 "Wearing light clothing"
* $SCT#255203001 "First thing in morning"
* $SCT#255214005 "After void"
* $SCT#309604004 "During rest"

ValueSet: MeasurementDeviceTypeVS
Id: measurement-device-type-vs
Title: "Measurement Device Type Value Set"
* ^experimental = false
Description: "Types of devices used for health and body measurements"

* ^version = "0.1.0"
* ^status = #draft

* $SCT#469576000 "Smart watch"
* $SCT#706767009 "Patient data recorder"
* $SCT#131009002 "Height measuring device"
* $SCT#706889009 "Blood pressure monitor"
* $SCT#444699000 "Tape measure"
* $SCT#44056008  "Digital scale"

Instance: WeightWithConditions
InstanceOf: WeightObservation
Usage: #example
Description: "Weight with conditions observation example"
Title: "Weight Measurement with Conditions Example"

* status = #final
* category = http://terminology.hl7.org/CodeSystem/observation-category#vital-signs
* code = $LOINC#29463-7 "Body weight"
* subject = Reference(Patient/example)
* effectiveDateTime = "2024-03-19T08:00:00Z"
* valueQuantity = 70.5 'kg'

* extension[measurement-conditions].url = "https://2rdoc.pt/ig/ios-lifestyle-medicine/StructureDefinition/measurement-conditions"
* extension[measurement-conditions].valueCodeableConcept = $SCT#307818003 "Pre-breakfast"

* extension[measurement-device-type].url = "https://2rdoc.pt/ig/ios-lifestyle-medicine/StructureDefinition/measurement-device-type"
* extension[measurement-device-type].valueCodeableConcept = $SCT#469576000 "Smart scale device"



// ===== Conteúdo de: SleepQuality.fsh =====

Extension: SleepQuality
Id: sleep-quality
Title: "Sleep Quality Extension"
* ^experimental = false
Description: "Extension for recording subjective sleep quality"
* value[x] only CodeableConcept
* valueCodeableConcept from SleepQualityExtendedVS (required)
 
ValueSet: SleepQualityExtendedVS
Id: sleep-quality-extended-vs
Description: "Extended value set for sleep quality assessment"Title: "Sleep Quality Value Set"
* $SCT#248220008 "Very good quality sleep"
* $SCT#248221007 "Good quality sleep"
* $SCT#248222000 "Poor quality sleep"
* $SCT#248223005 "Very poor quality sleep"



// ===== Conteúdo de: MindfulnessExtensions.fsh =====

Extension: MindfulnessContext
Id: mindfulness-context
Title: "Mindfulness Session Context"
Description: "Additional context about the mindfulness practice session"

* ^url = "https://2rdoc.pt/ig/ios-lifestyle-medicine/StructureDefinition/mindfulness-context"
* ^version = "1.0.0"
* ^status = #draft
* ^date = "2024-03-19"
* ^publisher = "Example Organization"

* extension contains
    location 0..1 and
    environment 0..1 and
    guidance 0..1

* extension[location].value[x] only string
* extension[location].valueString 1..1
* extension[location] ^short = "Physical location of practice"
* extension[location] ^definition = "The physical location where the mindfulness practice took place"

* extension[environment].value[x] only CodeableConcept
* extension[environment].valueCodeableConcept from https://2rdoc.pt/fhir/ValueSet/environment-type (required)
* extension[environment] ^short = "Environmental conditions"
* extension[environment] ^definition = "The environmental conditions during the practice session"

* extension[guidance].value[x] only boolean
* extension[guidance].valueBoolean 1..1
* extension[guidance] ^short = "Whether guidance was used"
* extension[guidance] ^definition = "Indicates if the session was guided or self-directed"



// ===== Conteúdo de: SocialInteractionExtensions.fsh =====

Extension: SocialContext
Id: social-context
Title: "Social Context Extension"
* ^experimental = false
Description: "Extension for recording the context of social interaction"
* value[x] only CodeableConcept
* valueCodeableConcept from SocialContextVS (required)

Extension: SocialSupport
Id: social-support
Title: "Social Support Extension"
* ^experimental = false
Description: "Extension for recording perceived social support"
* value[x] only CodeableConcept
* valueCodeableConcept from SocialSupportVS (required)

Extension: SocialActivity
Id: social-activity
Title: "Social Activity Extension"
* ^experimental = false
Description: "Extension for recording specific social activities"
* value[x] only CodeableConcept
* valueCodeableConcept from SocialActivityVS (required)

ValueSet: SocialContextVS
Id: social-context-vs
Title: "Social Context Value Set"
* ^experimental = false
Description: "Value set for social interaction contexts"
* codes from system SocialContextCS

ValueSet: SocialSupportVS
Id: social-support-vs
Title: "Social Support Value Set"
* ^experimental = false
Description: "Value set for levels of social support"
* codes from system SocialSupportCS

ValueSet: SocialActivityVS
Id: social-activity-vs
Title: "Social Activity Value Set"
* ^experimental = false
Description: "Value set for types of social activities"
* codes from system SocialActivityCS

CodeSystem: SocialContextCS
Id: social-context-cs
Title: "Social Context Code System"
* ^experimental = false
Description: "Code system for social interaction contexts"
* #home "Home" "Home environment"
* #work "Work" "Work environment"
* #education "Educational" "Educational setting"
* #community "Community" "Community setting"
* #recreational "Recreational" "Recreational setting"
* #healthcare "Healthcare" "Healthcare setting"

CodeSystem: SocialSupportCS
Id: social-support-cs
Title: "Social Support Code System"
* ^experimental = false
Description: "Code system for levels of social support"
* #strong "Strong Support" "Strong social support network"
* #adequate "Adequate Support" "Sufficient social support"
* #limited "Limited Support" "Limited social support"
* #minimal "Minimal Support" "Minimal social support"
* #none "No Support" "Absence of social support"

CodeSystem: SocialActivityCS
Id: social-activity-cs
Title: "Social Activity Code System"
* ^experimental = false
Description: "Code system for types of social activities"
* #meal "Shared Meal" "Sharing a meal together"
* #exercise "Group Exercise" "Group physical activity"
* #entertainment "Entertainment" "Shared entertainment activity"
* #learning "Learning" "Group learning activity"
* #volunteering "Volunteering" "Community service activity"
* #celebration "Celebration" "Social celebration or event"



// ===== Conteúdo de: SleepExtensions.fsh =====




// ===== Conteúdo de: ComplianceExtensions.fsh =====

// ====== Extensões de Compliance Multi-Jurisdicional ======

Extension: RegulatoryBasis
Id: regulatory-basis
Title: "Regulatory Basis for Consent"
Description: "Identifies the regulatory framework(s) that govern this consent"
* value[x] only CodeableConcept
* valueCodeableConcept from RegulatoryFrameworkVS (extensible)

Extension: JurisdictionApplicability  
Id: jurisdiction-applicability
Title: "Jurisdiction Applicability"
Description: "Specifies which jurisdictions this consent applies to"
* value[x] only CodeableConcept
* valueCodeableConcept from http://hl7.org/fhir/ValueSet/jurisdiction (extensible)

Extension: DataLocalization
Id: data-localization
Title: "Data Localization Requirements"
Description: "Specifies data localization requirements per jurisdiction"
* extension contains
    jurisdiction 1..1 MS and
    storageLocation 1..1 MS and
    residencyRequired 1..1 MS
* extension[jurisdiction].value[x] only CodeableConcept
* extension[storageLocation].value[x] only string
* extension[residencyRequired].value[x] only boolean

// ====== ValueSets de Compliance ======

ValueSet: RegulatoryFrameworkVS
Id: regulatory-framework-vs
Title: "Regulatory Framework Value Set"
Description: "Regulatory frameworks for healthcare data protection"
* ^experimental = false
* include codes from system RegulatoryFrameworkCS

CodeSystem: RegulatoryFrameworkCS
Id: regulatory-framework-cs
Title: "Regulatory Framework Code System"
Description: "Codes for healthcare regulatory frameworks"
* ^experimental = false
* ^caseSensitive = true
* #gdpr "GDPR - General Data Protection Regulation" "European Union data protection regulation"
* #hipaa "HIPAA - Health Insurance Portability and Accountability Act" "United States healthcare privacy law"
* #lgpd "LGPD - Lei Geral de Proteção de Dados" "Brazilian general data protection law"
* #pipeda "PIPEDA - Personal Information Protection and Electronic Documents Act" "Canadian privacy law"
* #ehds "EHDS - European Health Data Space" "European health data framework"



// ===== Conteúdo de: MobilityExtensions.fsh =====

Extension: MobilityAlertLevel
Id: mobility-alert-level
Title: "Mobility Alert Level Extension"
Description: "Extension for mobility measurements alert levels to indicate the severity or concern level of mobility changes detected by the device"
* ^status = #active
* ^context[0].type = #element
* ^context[0].expression = "Observation"
* . ^short = "Mobility alert level indicator"
* . ^definition = "Indicates the severity level of mobility changes or concerns based on device measurements"
* value[x] only CodeableConcept
* valueCodeableConcept from MobilityAlertLevelVS (required)
* valueCodeableConcept ^short = "Alert level code"
* valueCodeableConcept ^definition = "The specific alert level code indicating the severity of mobility changes"

ValueSet: MobilityAlertLevelVS
Id: mobility-alert-level-vs
Title: "Mobility Alert Level Value Set"
Description: "Value set for mobility measurement alert levels used to categorize the severity of mobility changes or concerns"
* ^status = #active
* ^experimental = false
* ^purpose = "To provide standardized alert levels for mobility measurements"
* codes from system MobilityAlertLevelCS

CodeSystem: MobilityAlertLevelCS
Id: mobility-alert-level-cs
Title: "Mobility Alert Level Code System"
Description: "Code system defining alert levels for mobility measurements, indicating the severity of changes in mobility patterns"
* ^status = #active
* ^experimental = false
* ^caseSensitive = true
* ^content = #complete
* #green "Normal - No concern" "Mobility measurements are within normal range and show no concerning patterns"
* #yellow "Caution - Monitor closely" "Mobility measurements show slight deviations that warrant closer monitoring"
* #red "Alert - Significant change" "Mobility measurements indicate significant changes that require immediate attention"
* ^property[0].code = #status
* ^property[0].type = #code
* ^property[0].description = "The status of the alert level"
* ^property[1].code = #severity
* ^property[1].type = #integer
* ^property[1].description = "Numeric value indicating severity (1=low, 3=high)"



// ===== Conteúdo de: ActivityExtensions.fsh =====




// ===== Conteúdo de: MobilityRiskValueSets.fsh =====

ValueSet: FallRiskOutcomesValueSet
Id: fall-risk-outcomes
Title: "Fall Risk Outcomes Value Set"
* ^experimental = false
Description: "Value set for fall risk assessment outcomes"
* ^url = "https://2rdoc.pt/fhir/ValueSet/fall-risk-outcomes"
* ^status = #active
* include codes from system https://2rdoc.pt/fhir/CodeSystem/fall-risk-outcomes

ValueSet: RiskLevelValueSet
Id: risk-level
Title: "Risk Level Value Set"
* ^experimental = false
Description: "Value set for general risk levels"
* ^url = "https://2rdoc.pt/fhir/ValueSet/risk-level"
* ^status = #active
* include codes from system https://2rdoc.pt/fhir/CodeSystem/risk-level

ValueSet: MobilityDeclineOutcomesValueSet
Id: mobility-decline-outcomes
Title: "Mobility Decline Outcomes Value Set"
* ^experimental = false
Description: "Value set for mobility decline assessment outcomes"
* ^url = "https://2rdoc.pt/fhir/ValueSet/mobility-decline-outcomes"
* ^status = #active
* include codes from system https://2rdoc.pt/fhir/CodeSystem/mobility-decline-outcomes

ValueSet: AssistanceLevelOutcomesValueSet
Id: assistance-level-outcomes
Title: "Assistance Level Outcomes Value Set"
* ^experimental = false
Description: "Value set for assistance level assessment outcomes"
* ^url = "https://2rdoc.pt/fhir/ValueSet/assistance-level-outcomes"
* ^status = #active
* include codes from system https://2rdoc.pt/fhir/CodeSystem/assistance-level-outcomes



// ===== Conteúdo de: SymptomValueSets.fsh =====

CodeSystem: SymptomSeverityCS
Id: symptom-severity-cs
Title: "Symptom Severity Code System"
* ^experimental = false
Description: "Severity levels for symptoms"

* #1-3 "Light" "Symptom barely noticeable"
* #4-6 "Mild" "Symptom noticeable but not interfering with daily activities"
* #7-8 "Intense" "Symptom interfering with daily activities"
* #9-10 "Severe" "Symptom preventing daily activities"

ValueSet: BodyLocationsVS
Id: body-locations-vs
Title: "Body Locations Value Set"
* ^experimental = false
Description: "Anatomical locations for symptom recording"
* $SCT#12738006 "Brain"
* $SCT#69536005 "Head"
* $SCT#45048000 "Neck"
* $SCT#51185008 "Chest"
* $SCT#62413002 "Abdomen"
* $SCT#32849002 "Back"
* $SCT#53120007 "Upper limb"
* $SCT#61685007 "Lower limb"

ValueSet: DurationUnitsVS
Id: duration-units-vs
Title: "Duration Units Value Set"
* ^experimental = false
Description: "Time units for symptom duration"
* $UCUM#min "Minutes"
* $UCUM#h "Hours"
* $UCUM#d "Days"
* $UCUM#wk "Weeks"
* $UCUM#mo "Months"

CodeSystem: SymptomFrequencyCS
Id: symptom-frequency-cs
Title: "Symptom Frequency Code System"
* ^experimental = false
Description: "Frequency patterns for symptoms"
* #rare "Rare" "Less than once per month"
* #occasional "Occasional" "Several times per month"
* #frequent "Frequent" "Several times per week"
* #daily "Daily" "Once or more per day"
* #constant "Constant" "Present most of the time"

ValueSet: SymptomFrequencyVS
Id: symptom-frequency-vs
Title: "Symptom Frequency Value Set"
* ^experimental = false
Description: "Frequency patterns for symptoms"
* codes from system SymptomFrequencyCS

CodeSystem: SymptomImpactCS
Id: symptom-impact-cs
Title: "Symptom Impact Code System"
* ^experimental = false
Description: "Impact levels of symptoms on daily activities"
* #none "No impact"
* #mild "Mild impact"
* #moderate "Moderate impact"
* #severe "Severe impact"
* #complete "Complete impact"

ValueSet: SymptomImpactVS
Id: symptom-impact-vs
Title: "Symptom Impact Value Set"
* ^experimental = false
Description: "Impact levels for symptoms"
* codes from system SymptomImpactCS

ValueSet: SymptomProgressionVS
Id: symptom-progression-vs
Title: "Symptom Progression Value Set"
* ^experimental = false
Description: "Progression patterns for symptoms"
* $SCT#385633008 "Improving"
* $SCT#58158008 "Stable"
* $SCT#230993007 "Worsening"
* $SCT#255314001 "Fluctuating"

ValueSet: TimeOfDayVS
Id: time-of-day-vs
Title: "Time of Day Value Set"
* ^experimental = false
Description: "Times of day for symptom occurrence"
* $SCT#73775008 "Morning"
* $SCT#255214003 "After exercise"
* $SCT#2546009 "Evening"
* $SCT#73775008 "Morning"



// ===== Conteúdo de: StressValueSets.fsh =====

ValueSet: StressChronicityVS
Id: stress-chronicity-vs
Title: "Stress Chronicity Value Set"
* ^experimental = false
Description: "Value set for classifying stress chronicity"
* ^url = "https://2rdoc.pt/fhir/ValueSet/stress-chronicity-vs"
* codes from system StressChronicityCS

ValueSet: StressImpactVS
Id: stress-impact-vs
Title: "Stress Impact Value Set"
* ^experimental = false
Description: "Value set for describing stress impact levels"
* ^url = "https://2rdoc.pt/fhir/ValueSet/stress-impact-vs"
* codes from system StressImpactCS

CodeSystem: StressChronicityCS
Id: stress-chronicity-cs
Title: "Stress Chronicity Code System"
* ^experimental = false
Description: "Code system for stress chronicity classification"
* ^url = "https://2rdoc.pt/fhir/CodeSystem/stress-chronicity-cs"
* #acute "Acute" "Short-term stress response"
* #subacute "Subacute" "Medium-term stress response"
* #chronic "Chronic" "Long-term stress response"
* #episodic "Episodic" "Recurring stress episodes"
* #persistent "Persistent" "Continuous stress state"

CodeSystem: StressImpactCS
Id: stress-impact-cs
Title: "Stress Impact Code System"
* ^experimental = false
Description: "Code system for stress impact levels"
* ^url = "https://2rdoc.pt/fhir/CodeSystem/stress-impact-cs"
* #minimal "Minimal Impact" "Little to no interference with daily activities"
* #mild "Mild Impact" "Some interference with daily activities"
* #moderate "Moderate Impact" "Significant interference with daily activities"
* #severe "Severe Impact" "Major interference with daily activities"
* #extreme "Extreme Impact" "Unable to perform daily activities"



// ===== Conteúdo de: ReproductiveValueSets.fsh =====

ValueSet: ReproductiveGoalVS
Id: reproductive-goal-vs
Title: "Reproductive Health Goals Value Set"
Description: "Goals related to reproductive health tracking and planning"

* ^status = #active
* ^experimental = false
* ^date = "2024-03-19"

* $LOINC#8708-0 "Menstrual cycle length"
* $LOINC#55284-4 "Blood pressure"
* $LOINC#8310-5 "Body temperature"
* $LOINC#8302-2 "Body height"
* $LOINC#29463-7 "Body weight"
* $SCT#364311006 "Menstrual cycle monitoring"
* $SCT#289530006 "Reproductive health finding"

ValueSet: ReproductiveActivityVS
Id: reproductive-activity-vs
Title: "Reproductive Health Activities Value Set"
Description: "Activities related to reproductive health monitoring"

* ^status = #active
* ^experimental = false
* ^date = "2024-03-19"

* codes from system ReproductiveActivityCS

CodeSystem: ReproductiveActivityCS
Id: reproductive-activity-cs
Title: "Reproductive Health Activities Code System"
Description: "Code system for reproductive health monitoring activities"

* ^status = #active
* ^experimental = false
* ^caseSensitive = true

* #cycle-tracking "Cycle Tracking" "Track menstrual cycle dates and characteristics"
* #temp-monitoring "Temperature Monitoring" "Monitor basal body temperature"
* #symptom-tracking "Symptom Tracking" "Track reproductive health symptoms"
* #vitals-monitoring "Vitals Monitoring" "Monitor vital signs related to reproductive health"
* #fertility-signs "Fertility Signs" "Monitor fertility signs and indicators"
* #mood-tracking "Mood Tracking" "Track mood changes related to reproductive cycle"
* #medication-log "Medication Log" "Log reproductive health medications"
* #exercise-tracking "Exercise Tracking" "Track physical activity during cycle"



// ===== Conteúdo de: AuditFormatsValueSet.fsh =====

ValueSet: AuditFormatsValueSet
Id: audit-formats
Title: "Audit Formats Value Set"
Description: "Value set for audit format types"
* ^url = "https://2rdoc.pt/fhir/ValueSet/audit-formats"
* ^status = #active
* ^experimental = false
* ^date = "2024-12-27"
* include codes from system https://2rdoc.pt/fhir/CodeSystem/audit-formats

CodeSystem: AuditFormatsCodeSystem
Id: audit-formats
Title: "Audit Formats Code System"
Description: "Code system for audit format types"
* ^url = "https://2rdoc.pt/fhir/CodeSystem/audit-formats"
* ^status = #active
* ^experimental = false
* ^caseSensitive = true
* #text "Text Format"
* #structured "Structured Format"
* #mixed "Mixed Format"



// ===== Conteúdo de: MeasurementContextVS.fsh =====

ValueSet: MeasurementContextVS
Id: measurement-context-vs
Title: "Measurement Context Value Set"
Description: "Contexts in which measurements can be taken, including temporal and location-based contexts"
* ^status = #active
* ^experimental = false
* $SCT#272125009 "Assessment context value (qualifier value)"
* $SCT#307818003 "Before food"
* $SCT#307819006 "After food"
* $SCT#255214003 "After exercise"
* $SCT#264362003 "Time of day"



// ===== Conteúdo de: AuditLevelsValueSet.fsh =====

ValueSet: AuditLevelsValueSet
Id: audit-levels
Title: "Audit Levels Value Set"
Description: "Value set for audit level types"
* ^url = "https://2rdoc.pt/fhir/ValueSet/audit-levels"
* ^status = #active
* ^experimental = false
* ^date = "2024-12-27"
* include codes from system https://2rdoc.pt/fhir/CodeSystem/audit-levels

CodeSystem: AuditLevelsCodeSystem
Id: audit-levels
Title: "Audit Levels Code System"
Description: "Code system for audit level types"
* ^url = "https://2rdoc.pt/fhir/CodeSystem/audit-levels"
* ^status = #active
* ^experimental = false
* ^caseSensitive = true
* #low "Low Level"
* #medium "Medium Level"
* #high "High Level"



// ===== Conteúdo de: SocialInteractionValueSets.fsh =====

ValueSet: SocialInteractionTypeVS
Id: social-interaction-type-vs
Title: "Social Interaction Type Value Set"
* ^experimental = false
Description: "Types of social interactions"
* codes from system SocialInteractionTypeCS

ValueSet: SocialInteractionQualityVS
Id: social-interaction-quality-vs
Title: "Social Interaction Quality Value Set"
* ^experimental = false
Description: "Quality measures for social interactions"
* codes from system SocialInteractionQualityCS

ValueSet: SocialInteractionMediumVS
Id: social-interaction-medium-vs
Title: "Social Interaction Medium Value Set"
* ^experimental = false
Description: "Mediums through which social interaction occurs"
* codes from system SocialInteractionMediumCS

CodeSystem: SocialInteractionTypeCS
Id: social-interaction-type-cs
Title: "Social Interaction Type Code System"
* ^experimental = false
Description: "Types of social interactions"
* #family "Family Interaction" "Interaction with family members"
* #friends "Friend Interaction" "Interaction with friends"
* #professional "Professional Interaction" "Work-related interactions"
* #community "Community Interaction" "Community-based interactions"
* #group "Group Activity" "Organized group activities"
* #casual "Casual Interaction" "Casual social encounters"

CodeSystem: SocialInteractionQualityCS
Id: social-interaction-quality-cs
Title: "Social Interaction Quality Code System"
* ^experimental = false
Description: "Quality measures for social interactions"
* #meaningful "Meaningful" "Deep, meaningful interaction"
* #meaningful "Meaningful" "Deep and significant interaction"
* #supportive "Supportive" "Supportive interaction"
* #meaningful "Meaningful" "Deep and significant interaction"
* #neutral "Neutral" "Neither positive nor negative"
* #meaningful "Meaningful" "Deep and significant interaction"
* #superficial "Superficial" "Surface-level interaction"
* #meaningful "Meaningful" "Deep and significant interaction"
* #stressful "Stressful" "Stressful or difficult interaction"
* #meaningful "Meaningful" "Deep and significant interaction"

CodeSystem: SocialInteractionMediumCS
Id: social-interaction-medium-cs
Title: "Social Interaction Medium Code System"
* ^experimental = false
Description: "Mediums through which social interaction occurs"
* #inPerson "In Person" "Face-to-face interaction"
* #meaningful "Meaningful" "Deep and significant interaction"
* #video "Video Call" "Video-based interaction"
* #meaningful "Meaningful" "Deep and significant interaction"
* #voice "Voice Call" "Voice-only interaction"
* #meaningful "Meaningful" "Deep and significant interaction"
* #text "Text Based" "Text-based communication"
* #meaningful "Meaningful" "Deep and significant interaction"
* #social "Social Media" "Social media interaction"
* #meaningful "Meaningful" "Deep and significant interaction"
* #mixed "Mixed Medium" "Multiple communication methods"
* #meaningful "Meaningful" "Deep and significant interaction"



// ===== Conteúdo de: MoodValueSet.fsh =====

ValueSet: MoodValueSet
Id: mood
Title: "Mood Value Set"
Description: "Value set for mood states"
* ^url = "https://2rdoc.pt/fhir/ValueSet/mood"
* ^status = #active
* ^experimental = false

CodeSystem: MoodCodeSystem
Id: mood
Title: "Mood Code System"
Description: "Code system for mood states"
* ^url = "https://2rdoc.pt/fhir/CodeSystem/mood"
* ^status = #active
* ^caseSensitive = true
* #elevated "Elevated" "Mood is higher than normal"
* #neutral "Neutral" "Neither elevated nor depressed mood"
* #depressed "Depressed" "Mood is lower than normal"
* #anxious "Anxious" "Feeling worried or nervous"
* #irritable "Irritable" "Easily annoyed or angered"
* #calm "Calm" "Feeling peaceful and relaxed"



// ===== Conteúdo de: EnvironmentalContextVS.fsh =====

ValueSet: EnvironmentalContextValueSet
Id: environmental-context
Title: "Environmental Context Value Set"
Description: "Valid contexts for environmental measurements"

* ^status = #active
* ^experimental = false
* ^url = "https://2rdoc.pt/fhir/ValueSet/environmental-context"
* include codes from system https://2rdoc.pt/fhir/CodeSystem/environmental-context



// ===== Conteúdo de: ActivityTypeVS.fsh =====

ValueSet: PhysicalActivityTypeVS
Id: physical-activity-type-vs
Title: "Physical Activity Types Value Set"
* ^experimental = false
Description: "Types of physical activities from iOS Health App"

* ^status = #active

* $SNOMED#255604002 "Physical activity (observable entity)"
* $SNOMED#228557008 "Walking"
* $SNOMED#229058003 "Running"
* $SNOMED#266938001 "Swimming"
* $SNOMED#266940006 "Cycling"
* $SNOMED#32147004 "Regular exercise"



// ===== Conteúdo de: MindfulnessValueSets.fsh =====

ValueSet: EnvironmentTypeValueSet
Id: environment-type
Title: "Environment Type Value Set"
* ^experimental = false
Description: "Value set for environmental context types"
* ^url = "https://2rdoc.pt/fhir/ValueSet/environment-type"
* ^status = #active
* include codes from system https://2rdoc.pt/fhir/CodeSystem/environment-type

ValueSet: MindfulnessTypeValueSet
Id: mindfulness-type
Title: "Mindfulness Type Value Set"
* ^experimental = false
Description: "Value set for types of mindfulness practices"
* ^url = "https://2rdoc.pt/fhir/ValueSet/mindfulness-type"
* ^status = #active
* include codes from system https://2rdoc.pt/fhir/CodeSystem/mindfulness-type



// ===== Conteúdo de: BalanceStatusValueSet.fsh =====

ValueSet: BalanceStatusValueSet
Id: balance-status
Title: "Balance Status Value Set"
Description: "Value set for walking steadiness balance status"
* ^url = "https://2rdoc.pt/fhir/ValueSet/balance-status"
* ^status = #active
* include codes from system https://2rdoc.pt/fhir/CodeSystem/balance-status

CodeSystem: BalanceStatusCodeSystem
Id: balance-status
Title: "Balance Status Code System"
Description: "Code system for balance status types"
* ^url = "https://2rdoc.pt/fhir/CodeSystem/balance-status"
* ^status = #active
* ^experimental = false
* ^caseSensitive = true
* #veryStable "Very Stable"
* #stable "Stable"
* #slightlyUnstable "Slightly Unstable"
* #unstable "Unstable"
* #veryUnstable "Very Unstable"



// ===== Conteúdo de: SleepQualityVS.fsh =====

ValueSet: SleepQualityVS
Id: sleep-quality-vs
Title: "Sleep Quality Value Set"
Description: "Qualitative assessments of sleep quality including subjective measures"
* ^status = #active
* ^experimental = false
* $SCT#248254009 "Quality of sleep (observable entity)"
* $SCT#248255005 "Sleeping well"
* $SCT#248256006 "Difficulty sleeping"
* $SCT#301345002 "Poor sleep pattern"
* $SCT#301346001 "Good sleep pattern"




// ===== Conteúdo de: FertilityValueSets.fsh =====

ValueSet: CervicalMucusValueSet
Id: cervical-mucus-valueset
Title: "Cervical Mucus Value Set"
* ^experimental = false
Description: "Value set for cervical mucus observations"
* ^url = "https://2rdoc.pt/fhir/ValueSet/cervical-mucus-vs"
* ^status = #active
* include codes from system https://2rdoc.pt/fhir/CodeSystem/cervical-mucus-cs

CodeSystem: CervicalMucusCodeSystem
Id: cervical-mucus-cs
Description: "Code system for cervical mucus classification"Title: "Cervical Mucus Code System"
* ^url = "https://2rdoc.pt/fhir/CodeSystem/cervical-mucus-cs"
* ^status = #active
* ^caseSensitive = true
* #dry "Dry"
* #sticky "Sticky"
* #creamy "Creamy"
* #watery "Watery"
* #eggWhite "Egg White"

ValueSet: OvulationTestValueSet
Id: ovulation-test-valueset
Title: "Ovulation Test Value Set"
* ^experimental = false
Description: "Value set for ovulation test results"
* ^url = "https://2rdoc.pt/fhir/ValueSet/ovulation-test-vs"
* ^status = #active
* include codes from system https://2rdoc.pt/fhir/CodeSystem/ovulation-test-cs

CodeSystem: OvulationTestCodeSystem
Id: ovulation-test-cs
Description: "Code system for ovulation test results"Title: "Ovulation Test Code System"
* ^url = "https://2rdoc.pt/fhir/CodeSystem/ovulation-test-cs"
* ^status = #active
* ^caseSensitive = true
* #negative "Negative"
* #positive "Positive"
* #invalid "Invalid Test"

ValueSet: FertilityStatusValueSet
Id: fertility-status-valueset
Title: "Fertility Status Value Set"
* ^experimental = false
Description: "Value set for fertility status"
* ^url = "https://2rdoc.pt/fhir/ValueSet/fertility-status-vs"
* ^status = #active
* include codes from system https://2rdoc.pt/fhir/CodeSystem/fertility-status-cs

CodeSystem: FertilityStatusCodeSystem
Id: fertility-status-cs
Description: "Code system for fertility status indicators"Title: "Fertility Status Code System"
* ^url = "https://2rdoc.pt/fhir/CodeSystem/fertility-status-cs"
* ^status = #active
* ^caseSensitive = true
* #fertile "Fertile"
* #notFertile "Not Fertile"
* #uncertain "Uncertain"



// ===== Conteúdo de: MindfulnessSearchParameters.fsh =====

Instance: MindfulnessType
InstanceOf: SearchParameter
Description: "Example instance of MindfulnessType"Usage: #definition
* status = #active
* code = #mindfulness-type
* name = "MindfulnessType"
* description = "Search for mindfulness observations by practice type"
* base = #Observation
* type = #token
* expression = "Observation.component.where(code.coding.exists(system = 'http://snomed.info/sct' and code = '711415009')).value.as(CodeableConcept)"
* xpath = "f:Observation/f:component[f:code/f:coding[f:system/@value='http://snomed.info/sct' and f:code/f:coding/f:code/@value='711415009']]/f:valueCodeableConcept"
* xpathUsage = #normal



// ===== Conteúdo de: MindfulnessAlerts.fsh =====

Extension: AlertTiming
Id: alert-timing
Title: "Alert Timing Extension"
Description: "Defines when alerts should be triggered"
* value[x] only Timing
* valueTiming.repeat 1..1 MS
* valueTiming.repeat.frequency MS
* valueTiming.repeat.period MS
* valueTiming.repeat.periodUnit MS

Extension: AlertMessage
Id: alert-message
Title: "Alert Message Extension"
Description: "Defines the alert message content"
* value[x] only string

Profile: MindfulnessAlert
Parent: Basic
Id: mindfulness-alert
Title: "Mindfulness Alert"
Description: "Alert configuration for mindfulness sessions"

* code 1..1 MS
* code = https://2rdoc.pt/fhir/CodeSystem/mindfulness-alert-type#reminder "Mindfulness Reminder"

* extension contains
    alert-timing named alertTiming 0..1 MS and
    alert-message named alertMessage 1..1 MS

Instance: DailyMindfulnessAlert
InstanceOf: MindfulnessAlert
Title: "Daily Mindfulness Alert" 
Description: "Example of a daily mindfulness alert configuration"

* code = https://2rdoc.pt/fhir/CodeSystem/mindfulness-alert-type#reminder "Mindfulness Reminder"
* extension[alertTiming].valueTiming.repeat
  * frequency = 1
  * period = 1
  * periodUnit = #d
* extension[alertMessage].valueString = "Time for your daily mindfulness practice"



// ===== Conteúdo de: MindfulnessTransforms.fsh =====

Instance: MindfulnessHealthKitTransform
InstanceOf: StructureMap
Usage: #definition
Title: "HealthKit to FHIR Mindfulness Transform"

* status = #draft
* name = "MindfulnessHealthKitTransform"
* structure[0]
  * url = "https://2rdoc.pt/ig/ios-lifestyle-medicine/StructureDefinition/healthkit-mindfulness"
  * mode = #source
  * documentation = "HealthKit mindfulness session structure"

* structure[1]
  * url = "http://hl7.org/fhir/StructureDefinition/Observation"
  * mode = #target
  * documentation = "FHIR Observation resource"

* group[0]
  * name = "MindfulnessSessionToObservation"
  * typeMode = #none
  * input[0]
    * name = "source"
    * type = "HealthKitMindfulness"
    * mode = #source
  * input[1]
    * name = "target"
    * type = "Observation"
    * mode = #target
  * rule[0]
    * name = "Session"
    * source[0]
      * context = "source"
      * element = "startDate"
    * target[0]
      * context = "target"
      * element = "effectiveDateTime"
  * rule[1]
    * name = "Duration"
    * source[0]
      * context = "source"
      * element = "duration"
    * target[0]
      * context = "target"
      * element = "component.where(code.coding.code='118682006').valueQuantity"

Instance: MindfulnessCSVTransform
InstanceOf: StructureMap
Usage: #definition
Title: "CSV to FHIR Mindfulness Transform"

* status = #draft
* name = "MindfulnessCSVTransform"
* structure[0]
  * url = "https://2rdoc.pt/ig/ios-lifestyle-medicine/StructureDefinition/csv-mindfulness"
  * mode = #source
  * documentation = "CSV mindfulness data structure"

* group[0]
  * name = "CSVToMindfulnessObservation"
  * typeMode = #none
  * input[0]
    * name = "source"
    * type = "CSVMindfulness"
    * mode = #source
  * input[1]
    * name = "target"
    * type = "Observation"
    * mode = #target
  * rule[0]
    * name = "MapDatetime"
    * source[0]
      * context = "source"
      * element = "date,time"
    * target[0]
      * context = "target"
      * element = "effectiveDateTime"
      * transform = #append

RuleSet: TransformValidationRules
* rule[+]
  * name = "ValidateStatus"
  * source[0]
    * context = "target"
    * element = "status"
  * assert[0]
    * description = "Status must be final"
    * expression = "%status = 'final'"

* rule[+]
  * name = "ValidateCode"
  * source[0]
    * context = "target"
    * element = "code"
  * assert[0]
    * description = "Must use SNOMED CT code"
    * expression = "%code.system = 'http://snomed.info/sct'"



// ===== Conteúdo de: MindfulnessAudit.fsh =====

Extension: AuditLevelExtension
Id: audit-level
Title: "Audit Level Extension"
Description: "Level of detail for audit records"
* value[x] only code
* valueCode from https://2rdoc.pt/fhir/ValueSet/audit-levels (required)

Extension: AuditRetentionExtension
Id: audit-retention
Title: "Audit Retention Extension" 
Description: "Period to retain audit records"
* value[x] only Duration

Extension: AuditFormatExtension
Id: audit-format
Title: "Audit Format Extension"
Description: "Format for audit records"
* value[x] only code
* valueCode from https://2rdoc.pt/fhir/ValueSet/audit-formats (required)

Profile: MindfulnessAudit
Parent: Basic
Id: mindfulness-audit
Title: "Mindfulness Audit"
Description: "Audit record for mindfulness sessions"

* code 1..1 MS
* code = https://2rdoc.pt/fhir/CodeSystem/mindfulness-audit-type#session "Session Audit"
* created 1..1 MS

* extension contains
    audit-level named auditLevel 1..1 MS and
    audit-retention named auditRetention 1..1 MS and
    audit-format named auditFormat 1..1 MS

Instance: MindfulnessAuditExample
InstanceOf: MindfulnessAudit
Title: "Example Mindfulness Audit"
Description: "Example of a mindfulness session audit record"

* code = https://2rdoc.pt/fhir/CodeSystem/mindfulness-audit-type#session "Session Audit"
* created = "2024-03-15"
* extension[auditLevel].valueCode = #detailed
* extension[auditRetention].valueDuration = 90 'days'
* extension[auditFormat].valueCode = #fhir



// ===== Conteúdo de: EnvironmentalExamples.fsh =====

Instance: NoiseExposureExample
InstanceOf: NoiseExposureObservation
Usage: #example
Description: "Noise exposure observation example"
Title: "Noise Exposure Measurement Example"

* meta.security = http://terminology.hl7.org/CodeSystem/v3-Confidentiality#N
* status = #final
* performer = Reference(Practitioner/PractitionerExample)
* category = http://terminology.hl7.org/CodeSystem/observation-category#environment
* code = $LOINC#28573-7 "Noise exposure time"
* subject = Reference(Patient/PatientExample)
* effectiveDateTime = "2024-03-19T15:30:00Z"
* device = Reference(Device/iphone-example)
* method = http://snomed.info/sct#37016008 "Automatic measurement"

* component[level]
  * code.coding[0] = $LOINC#89020-2 "Environmental noise average"
  * valueQuantity = 85 'dB'
  * interpretation = http://terminology.hl7.org/CodeSystem/v3-ObservationInterpretation#H "High"

* component[duration]
  * code.coding[0] = $LOINC#89021-0 "Environmental noise duration"
  * valueQuantity = 120 'min'

* component[peakLevel]
  * code.coding[0] = $LOINC#89024-4 "Peak sound level"
  * valueQuantity = 95 'dB'

* component[backgroundNoise]
  * code.coding[0] = $LOINC#89025-1 "Background noise level"
  * valueQuantity = 45 'dB'

* note.text = "Measurement taken during urban commute"

Instance: UVExposureExample
InstanceOf: UVExposureObservation
Usage: #example
Description: "UV exposure observation example"
Title: "UV Exposure Measurement Example"

* meta.security = http://terminology.hl7.org/CodeSystem/v3-Confidentiality#N
* status = #final
* category = http://terminology.hl7.org/CodeSystem/observation-category#environment
* code = $LOINC#28574-5 "UV exposure"
* subject = Reference(Patient/PatientExample)
* effectiveDateTime = "2024-03-19T12:00:00Z"
* device = Reference(Device/iphone-example)
* method = http://snomed.info/sct#37016008 "Automatic measurement"

* component[index]
  * code.coding[0] = $LOINC#89022-8 "UV index"
  * valueQuantity = 8 '{index}'
  * interpretation = http://terminology.hl7.org/CodeSystem/v3-ObservationInterpretation#H "High"

* component[duration]
  * code.coding[0] = $LOINC#89023-6 "UV exposure duration"
  * valueQuantity = 45 'min'

* component[timeOfDay]
  * code.coding[0] = $LOINC#89026-9 "Time of exposure"
  * valueDateTime = "2024-03-19T12:00:00Z"

* component[intensity]
  * code.coding[0] = $LOINC#89027-7 "UV intensity"
  * valueQuantity = 0.3 'W/m2'

* note.text = "Measurement taken during outdoor activity"

Instance: EnvironmentalDeviceExample
InstanceOf: Device
Usage: #example
Description: "Environmental monitoring device example"
Title: "Environmental Monitoring Device"

* identifier.system = "https://2rdoc.pt/ig/ios-lifestyle-medicine/devices"
* identifier.value = "iPhone-ENV-001"
* manufacturer = "Apple Inc."
* modelNumber = "iPhone 15 Pro"
* type = $SCT#706689003 "Environmental monitoring device"
* status = #active



// ===== Conteúdo de: NutritionExamples.fsh =====

Instance: NutritionQuestionnaireResponseExample
InstanceOf: QuestionnaireResponse
Usage: #example
Description: "Nutrition questionnaire response example"
Title: "Daily Nutrition Questionnaire Response Example"

* questionnaire = "https://2rdoc.pt/fhir/Questionnaire/daily-nutrition"
* status = #completed
* subject = Reference(Patient/PatientExample)
* authored = "2024-12-14T20:00:00Z"

* item[0]
  * linkId = "water_intake"
  * answer.valueQuantity = 2000 'mL'

* item[1]
  * linkId = "meal_record"

  * item[0]
    * linkId = "meal_time"
    * answer.valueDateTime = "2024-12-14T12:00:00Z"

  * item[1]
    * linkId = "meal_type"
    * answer.valueString = "Lunch"

  * item[2]
    * linkId = "calories"
    * answer.valueInteger = 650

  * item[3]
    * linkId = "macronutrients"
   
    * item[0]
      * linkId = "carbs"
      * answer.valueDecimal = 75
   
    * item[1]
      * linkId = "protein"
      * answer.valueDecimal = 30
   
    * item[2]
      * linkId = "fat"
      * answer.valueDecimal = 25

* item[2]
  * linkId = "caffeine"

  * item[0]
    * linkId = "caffeine_amount"
    * answer.valueInteger = 80

  * item[1]
    * linkId = "caffeine_source"
    * answer.valueString = "Coffee"



// ===== Conteúdo de: SleepExamples.fsh =====

Instance: SleepObservationExample1
InstanceOf: SleepObservation
Usage: #example
Description: "Sleep observation example"
Title: "Example of Sleep Record"
 
* status = #final
* category = http://terminology.hl7.org/CodeSystem/observation-category#sleep
* code = $LOINC#93832-4 "Sleep pattern panel"
* subject = Reference(PatientExample)
* effectivePeriod.start = "2024-03-19T22:00:00Z"
* effectivePeriod.end = "2024-03-20T06:30:00Z"
* device = Reference(DeviceSleepMonitor)
 
* component[timeInBed].code = $LOINC#93831-6 "Time in bed"
* component[timeInBed].valueQuantity = 510 'min' "minute"
* component[timeInBed].valueQuantity.system = $UCUM
* component[timeInBed].valueQuantity.unit = "minute"
 
* component[totalSleepTime].code = $LOINC#93833-2 "Sleep duration"
* component[totalSleepTime].valueQuantity = 472 'min' "minute"
* component[totalSleepTime].valueQuantity.system = $UCUM
* component[totalSleepTime].valueQuantity.unit = "minute"
 
* component[deepSleep].code = $LOINC#93834-0 "Deep sleep duration"
* component[deepSleep].valueQuantity = 95 'min' "minute"
* component[deepSleep].valueQuantity.system = $UCUM
* component[deepSleep].valueQuantity.unit = "minute"
 
* component[remSleep].code = $LOINC#93835-7 "REM sleep duration"
* component[remSleep].valueQuantity = 118 'min' "minute"
* component[remSleep].valueQuantity.system = $UCUM
* component[remSleep].valueQuantity.unit = "minute"
 
* component[lightSleep].code = $LOINC#93836-5 "Light sleep duration"
* component[lightSleep].valueQuantity = 259 'min' "minute"
* component[lightSleep].valueQuantity.system = $UCUM
* component[lightSleep].valueQuantity.unit = "minute"
 
* component[respiratoryRate].code = $LOINC#9279-1 "Respiratory rate"
* component[respiratoryRate].valueQuantity = 14 '/min' "per minute"
* component[respiratoryRate].valueQuantity.system = $UCUM
* component[respiratoryRate].valueQuantity.unit = "per minute"
 
* component[heartRateVariability].code = $LOINC#80404-7 "R-R interval.standard deviation (Heart rate variability)"
* component[heartRateVariability].valueQuantity = 45 'ms' "millisecond"
* component[heartRateVariability].valueQuantity.system = $UCUM
* component[heartRateVariability].valueQuantity.unit = "millisecond"
 
* component[interruptions].code = $LOINC#93837-3 "Number of awakenings during sleep"
* component[interruptions].valueQuantity = 3 '{count}' "count"
* component[interruptions].valueQuantity.system = $UCUM
* component[interruptions].valueQuantity.unit = "count"

Instance: DeviceSleepMonitor
InstanceOf: Device
Usage: #example
Description: "Sleep monitor device example"
Title: "Sleep Monitoring Device"
* deviceName.name = "Sleep Quality Monitor"
* deviceName.type = #user-friendly-name
* manufacturer = "HealthTech Devices"
* modelNumber = "SQM-2024"
* type = $SCT#706172001 "Sleep monitor"



// ===== Conteúdo de: StressExamples.fsh =====

Instance: StressLevelExample
InstanceOf: StressLevelProfile
Usage: #example
Description: "Stress level observation example"
Title: "Stress Level Measurement Example"

* status = #final
* category = http://terminology.hl7.org/CodeSystem/observation-category#vital-signs
* code = $LOINC#89592-0 "Stress level score"
* subject = Reference(Patient/PatientExample)
* effectiveDateTime = "2024-01-03T15:30:00Z"
* valueQuantity = 7 '{score}' "score"

* component[physiologicalStress].valueQuantity = 6 '{score}' "score"
* component[psychologicalStress].valueQuantity = 8 '{score}' "score"
* component[chronicity].valueCodeableConcept = StressChronicityCS#subacute
* component[impact].valueCodeableConcept = StressImpactCS#moderate

* extension[triggers].valueCodeableConcept = StressTriggersCS#work
* extension[coping].valueCodeableConcept = StressCopingCS#meditation



// ===== Conteúdo de: PatientExample.fsh =====

Instance: PatientExample
InstanceOf: Patient
Usage: #example
Description: "Patient resource example"
* identifier[0].system = "urn:oid:2.16.858.1.1.1"
* identifier[0].value = "12345"
* name.given = "John"
* name.family = "Doe"
* gender = #male
* birthDate = "1970-01-01"



// ===== Conteúdo de: MobilityExamples.fsh =====

Profile: WalkingSteadinessObservation
Parent: MobilityProfile
Id: walking-steadiness-observation
Description: "Profile for assessing walking steadiness and balance"Title: "Walking Steadiness Observation Profile"

* code = $LOINC#LA32-8 "Balance"
* component contains
    balanceScore 0..1 MS and
    balanceStatus 0..1 MS

* component[balanceScore]
  * code = $LOINC#LA32-8 "Balance score"
  * valueQuantity.system = $UCUM
  * valueQuantity.code = #%

* component[balanceStatus]
  * code = $LOINC#LA32-9 "Balance status"
  * valueCodeableConcept from https://2rdoc.pt/fhir/ValueSet/balance-status (required)

Profile: WalkingSpeedObservation
Parent: MobilityProfile
Id: walking-speed-observation
Description: "Profile for measuring walking speed as part of mobility assessment"Title: "Walking Speed Observation Profile"

* code = $LOINC#LA29042-4 "Walking speed"
* component contains
    speed 0..1 MS and
    distance 0..1 MS

* component[speed]
  * code = $LOINC#LA29042-4 "Walking speed measurement"
  * valueQuantity.system = $UCUM
  * valueQuantity.code = #m/s

* component[distance]
  * code = $LOINC#LA29043-2 "Walking distance"
  * valueQuantity.system = $UCUM
  * valueQuantity.code = #m

Instance: WalkingSteadinessExample
InstanceOf: WalkingSteadinessObservation
Usage: #example
Description: "Walking steadiness observation example"
Title: "Walking Steadiness Measurement Example"

* status = #final
* category = http://terminology.hl7.org/CodeSystem/observation-category#activity
* code = $LOINC#LA32-8 "Balance"
* subject = Reference(Patient/PatientExample)
* effectiveDateTime = "2024-03-19T15:30:00Z"
* valueQuantity = 85 '1' "score"
* device = Reference(Device/iphone-example)

* component[balanceScore].valueQuantity = 85 '%' "percent"
* component[balanceStatus].valueCodeableConcept = $LOINC#LA32-10 "OK"

Instance: WalkingSpeedExample
InstanceOf: WalkingSpeedObservation
Usage: #example
Description: "Walking speed observation example"
Title: "Walking Speed Measurement Example"

* status = #final
* category = http://terminology.hl7.org/CodeSystem/observation-category#activity
* code = $LOINC#LA29042-4 "Walking speed"
* subject = Reference(Patient/PatientExample)
* effectiveDateTime = "2024-03-19T15:30:00Z"
* valueQuantity = 1.2 'm/s' "meters per second"
* device = Reference(Device/iphone-example)

* component[speed].valueQuantity = 1.2 'm/s' "meters per second"
* component[distance].valueQuantity = 10 'm' "meters"



// ===== Conteúdo de: PhysicalActivityExamples.fsh =====

Instance: PhysicalActivityExample1
InstanceOf: PhysicalActivityObservation
Usage: #example
Description: "Physical activity observation example"
Title: "Example of Walking Activity"
* status = #final
* category = http://terminology.hl7.org/CodeSystem/observation-category#activity
* code = $SNOMED#228557008 "Walking"
* subject = Reference(PatientExample)
* effectiveDateTime = "2024-03-19T15:30:00Z"
* device = Reference(DeviceActivityTracker)
* component[steps].code = $LOINC#55423-8 "Number of steps in 24 hour Measured"
* component[steps].valueQuantity = 8546 '1' "count"
* component[steps].valueQuantity.system = $UCUM
* component[steps].valueQuantity.unit = "count"
* component[distance].code = $LOINC#55430-3 "Distance walked"
* component[distance].valueQuantity = 6.2 'km' "kilometer"
* component[distance].valueQuantity.system = $UCUM
* component[distance].valueQuantity.unit = "kilometer"
* component[duration].code = $LOINC#55411-3 "Exercise duration"
* component[duration].valueQuantity = 72 'min' "minute"
* component[duration].valueQuantity.system = $UCUM
* component[duration].valueQuantity.unit = "minute"
* component[energy].code = $LOINC#55424-6 "Energy expenditure"
* component[energy].valueQuantity = 320 'kcal' "kilocalorie"
* component[energy].valueQuantity.system = $UCUM
* component[energy].valueQuantity.unit = "kilocalorie"

Instance: DeviceActivityTracker
InstanceOf: Device
Usage: #example
Description: "Activity tracker device example"
Title: "Activity Tracking Device"
* deviceName.name = "Health Activity Tracker"
* deviceName.type = #user-friendly-name
* manufacturer = "HealthTech Devices"
* modelNumber = "HAT-2024"
* type = $SCT#258158006 "Breathing rate"



// ===== Conteúdo de: BodyMetricsExamples.fsh =====

Instance: WeightExample
InstanceOf: WeightObservation
Usage: #example
Description: "Weight observation example"
Title: "Weight Measurement Example"
* status = #final
* category = http://terminology.hl7.org/CodeSystem/observation-category#vital-signs
* code = $LOINC#29463-7 "Body weight"
* subject = Reference(PatientExample)
* performer = Reference(PractitionerExample)
* effectiveDateTime = "2024-03-19T08:00:00Z"
* valueQuantity = 70.5 'kg' "kilogram"
* valueQuantity.system = $UCUM
* valueQuantity.unit = "kilogram"
* device = Reference(SmartScale)

Instance: HeightExample
InstanceOf: HeightObservation
Usage: #example
Description: "Height observation example"
Title: "Height Measurement Example"
* status = #final
* category = http://terminology.hl7.org/CodeSystem/observation-category#vital-signs
* code = $LOINC#8302-2 "Body height"
* subject = Reference(PatientExample)
* performer = Reference(PractitionerExample)
* effectiveDateTime = "2024-03-19T08:00:00Z"
* valueQuantity = 175 'cm' "centimeter"
* valueQuantity.system = $UCUM
* valueQuantity.unit = "centimeter"

Instance: BMIExample
InstanceOf: BMIObservation
Usage: #example
Description: "Body Mass Index observation example"
Title: "BMI Calculation Example"
* status = #final
* category = http://terminology.hl7.org/CodeSystem/observation-category#vital-signs
* code = $LOINC#39156-5 "Body mass index (BMI)"
* subject = Reference(PatientExample)
* performer = Reference(PractitionerExample)
* effectiveDateTime = "2024-03-19T08:00:00Z"
* valueQuantity = 23.0 'kg/m2' "kilogram per square meter"
* valueQuantity.system = $UCUM
* valueQuantity.unit = "kilogram per square meter"
* derivedFrom[0] = Reference(Observation/WeightExample)
* derivedFrom[1] = Reference(Observation/HeightExample)

Instance: BodyCompositionExample
InstanceOf: BodyCompositionObservation
Usage: #example
Description: "Body composition observation example"
Title: "Body Composition Measurement Example" 
* status = #final
* category = http://terminology.hl7.org/CodeSystem/observation-category#vital-signs
* code = $LOINC#88365-2 "Body composition panel"
* subject = Reference(PatientExample)
* performer = Reference(PractitionerExample)
* effectiveDateTime = "2024-03-19T08:00:00Z"
* device = Reference(BioimpedanceAnalyzer)

* component[bodyFat].code = $LOINC#41982-0 "Percentage body fat"
* component[bodyFat].valueQuantity = 22.5 '%' "percent"
* component[bodyFat].valueQuantity.system = $UCUM
* component[bodyFat].valueQuantity.unit = "percent"

* component[leanMass].code = $LOINC#291-7 "Lean body mass"
* component[leanMass].valueQuantity = 54.6 'kg' "kilogram"
* component[leanMass].valueQuantity.system = $UCUM
* component[leanMass].valueQuantity.unit = "kilogram"

* component[bodyWater].code = $LOINC#73708-0 "Total body water"
* component[bodyWater].valueQuantity = 39.2 'L' "liter"
* component[bodyWater].valueQuantity.system = $UCUM
* component[bodyWater].valueQuantity.unit = "liter"

* component[muscleMass].code = $LOINC#73713-0 "Muscle mass"
* component[muscleMass].valueQuantity = 51.8 'kg' "kilogram"
* component[muscleMass].valueQuantity.system = $UCUM
* component[muscleMass].valueQuantity.unit = "kilogram"

* component[boneMass].code = $LOINC#73711-4 "Bone mass"
* component[boneMass].valueQuantity = 2.8 'kg' "kilogram"
* component[boneMass].valueQuantity.system = $UCUM
* component[boneMass].valueQuantity.unit = "kilogram"

Instance: SmartScale
InstanceOf: Device
Usage: #example
Description: "Smart scale device example"
Title: "Smart Scale Device"
* deviceName.name = "Smart Body Analyzer"
* deviceName.type = #user-friendly-name
* manufacturer = "HealthTech Devices"
* modelNumber = "SBA-2024"
* type = $SCT#469576000 "Digital scale device"

Instance: BioimpedanceAnalyzer  
InstanceOf: Device
Usage: #example
Description: "Bioimpedance analyzer device example"
Title: "Bioimpedance Analyzer Device"
* deviceName.name = "Professional Body Composition Analyzer"
* deviceName.type = #user-friendly-name
* manufacturer = "MedTech Solutions"
* modelNumber = "BCA-Pro"
* type = $SCT#706767009 "Patient data recorder"



// ===== Conteúdo de: SymptomExamples.fsh =====

Instance: ChronicSymptomExample
InstanceOf: Observation
Usage: #example
Description: "Chronic symptom observation example"
* status = #final
* category = http://terminology.hl7.org/CodeSystem/observation-category#survey
* code = $SCT#267036007 "Fatigue"
* subject = Reference(Patient/PatientExample)
* performer = Reference(Practitioner/PractitionerExample)
* effectiveDateTime = "2024-03-19T14:00:00Z"
// ... resto do exemplo ...

Instance: ExampleSymptomSeverity
InstanceOf: Observation
Usage: #example
Description: "Symptom severity observation example"
* status = #final
* category = http://terminology.hl7.org/CodeSystem/observation-category#survey
* code = $SCT#246604007 "Symptom severity"
* subject = Reference(Patient/PatientExample)
* performer = Reference(Practitioner/PractitionerExample)
* effectiveDateTime = "2024-03-19T10:30:00Z"
// ... resto do exemplo ...



// ===== Conteúdo de: SocialInteractionExamples.fsh =====

Instance: SocialInteractionExample
InstanceOf: SocialInteractionProfile
Usage: #example
Description: "Social interaction observation example"
Title: "Social Interaction Example"

* status = #final
* category = http://terminology.hl7.org/CodeSystem/observation-category#social-history
* code = $LOINC#96766-1 "Social interaction pattern"
* subject = Reference(Patient/PatientExample)
* effectiveDateTime = "2024-01-03T14:00:00Z"
* valueCodeableConcept = SocialInteractionTypeCS#family

* component[duration].valueQuantity = 120 'min' "minutes"
* component[quality].valueCodeableConcept = SocialInteractionQualityCS#meaningful
* component[medium].valueCodeableConcept = SocialInteractionMediumCS#inPerson
* component[participants].valueInteger = 4

* extension[context].valueCodeableConcept = SocialContextCS#home
* extension[support].valueCodeableConcept = SocialSupportCS#strong
* extension[activity].valueCodeableConcept = SocialActivityCS#meal



// ===== Conteúdo de: VitalSignsExamples.fsh =====

Instance: HeartRateExample
InstanceOf: HeartRateObservation
Usage: #example
Description: "Heart rate observation example"
Title: "Heart Rate Measurement Example"
* status = #final
* code = $LOINC#8867-4 "Heart rate"
* subject = Reference(PatientExample)
* effectiveDateTime = "2024-03-19T15:30:00Z"
* valueQuantity = 72 '/min' "per minute"
* valueQuantity.system = $UCUM
* valueQuantity.unit = "per minute"
* device = Reference(DeviceHeartRateMonitor)
* performer = Reference(PractitionerExample)
* component[heartRateVariability].code = $LOINC#80404-7 "R-R interval.standard deviation (Heart rate variability)"
* component[heartRateVariability].valueQuantity = 45 'ms' "millisecond"
* component[heartRateVariability].valueQuantity.system = $UCUM
* component[heartRateVariability].valueQuantity.unit = "millisecond"

Instance: BloodPressureExample
InstanceOf: BloodPressureObservation
Usage: #example
Description: "Blood pressure observation example"
Title: "Blood Pressure Measurement Example"
* status = #final
* code = $LOINC#85354-9 "Blood pressure panel with all children optional"
* subject = Reference(PatientExample)
* effectiveDateTime = "2024-03-19T15:30:00Z"
* device = Reference(DeviceBloodPressureMonitor)
* performer = Reference(PractitionerExample)
* component[systolic].code = $LOINC#8480-6 "Systolic blood pressure"
* component[systolic].valueQuantity = 120 'mm[Hg]' "millimeter of mercury"
* component[systolic].valueQuantity.system = $UCUM
* component[systolic].valueQuantity.unit = "millimeter of mercury"
* component[diastolic].code = $LOINC#8462-4 "Diastolic blood pressure"
* component[diastolic].valueQuantity = 80 'mm[Hg]' "millimeter of mercury"
* component[diastolic].valueQuantity.system = $UCUM
* component[diastolic].valueQuantity.unit = "millimeter of mercury"

Instance: DeviceHeartRateMonitor
InstanceOf: Device
Usage: #example
Description: "Heart rate monitor device example"
Title: "Heart Rate Monitor Device"
* deviceName.name = "Continuous Heart Rate Monitor"
* deviceName.type = #user-friendly-name
* manufacturer = "HealthTech Devices"
* modelNumber = "HRM-2024"
* type = $SCT#720737000 "Pulse rate monitoring device"

Instance: DeviceBloodPressureMonitor
InstanceOf: Device
Usage: #example
Description: "Blood pressure monitor device example"
Title: "Blood Pressure Monitor Device"
* deviceName.name = "Digital Blood Pressure Monitor"
* deviceName.type = #user-friendly-name
* manufacturer = "HealthTech Devices"
* modelNumber = "BPM-2024"
* type = $SCT#43770009 "Blood pressure monitor"



// ===== Conteúdo de: PractitionerExample.fsh =====

Instance: PractitionerExample
InstanceOf: Practitioner
Usage: #example
Description: "Practitioner resource example"
* identifier[0].system = "http://terminology.hl7.org/CodeSystem/practitioner-identifier"
* identifier[0].value = "9941339108"
* name.given = "Jane"
* name.family = "Smith"



// ===== Conteúdo de: MindfulnessCompleteExamples.fsh =====

Instance: CompleteMindfulnessSession
InstanceOf: MindfulnessObservation
Usage: #example
Description: "Complete mindfulness session observation example"
Title: "Complete Mindfulness Session Example"

* status = #final
* code = $SCT#711415009 "Mindfulness"
* subject = Reference(Patient/PatientExample)
* effectiveDateTime = "2024-03-19T08:00:00Z"
* performer = Reference(Practitioner/PractitionerExample)

* component[sessionDuration].code = $SCT#118682006 "Duration"
* component[sessionDuration].valueQuantity = 20 'min'

* component[stressLevel].code = $SCT#725854004 "Assessment of stress level"
* component[stressLevel].valueInteger = 3

* component[moodState].code = $SCT#373931001 "Mood finding"
* component[moodState].valueCodeableConcept = $SCT#130991005 "Neutral mood"

* component[relaxationResponse].code = $SCT#276241001 "Relaxation technique"
* component[relaxationResponse].valueString = "Deep breathing exercises with progressive relaxation"

* component[mindfulnessType].code = $SCT#711415009 "Mindfulness"
* component[mindfulnessType].valueCodeableConcept = $SCT#711415009 "Mindfulness"

* extension[mindfulness-context].extension[location].valueString = "Home meditation room"
* extension[mindfulness-context].extension[environment].valueCodeableConcept = #quiet "Quiet Space"
* extension[mindfulness-context].extension[guidance].valueBoolean = true

Instance: CompleteMindfulnessResponse
InstanceOf: QuestionnaireResponse
Usage: #example
Description: "Complete mindfulness questionnaire response example"
Title: "Complete Mindfulness Session Response"

* questionnaire = "https://2rdoc.pt/fhir/Questionnaire/daily-mindfulness"
* status = #completed
* subject = Reference(Patient/PatientExample)
* authored = "2024-03-19T08:30:00Z"

* item[0]
  * linkId = "mindful_session"
  * item[0]
    * linkId = "session_duration"
    * answer.valueInteger = 20
  * item[1]
    * linkId = "practice_type"
    * answer.valueString = "Meditation"

* item[1]
  * linkId = "mood_assessment"
  * item[0]
    * linkId = "current_mood"
    * answer.valueCoding = $SCT#130991005 "Neutral mood"
  * item[1]
    * linkId = "mood_intensity"
    * answer.valueInteger = 3

* item[2]
  * linkId = "stress_assessment"
  * item[0]
    * linkId = "stress_level"
    * answer.valueInteger = 3
  * item[1]
    * linkId = "stress_symptoms"
    * answer[0].valueString = "Slight tension"

* item[3]
  * linkId = "relaxation"
  * item[0]
    * linkId = "relaxation_duration"
    * answer.valueInteger = 15
  * item[1]
    * linkId = "relaxation_technique"
    * answer.valueString = "Deep breathing"



// ===== Conteúdo de: MindfulnessExamples.fsh =====

Instance: MindfulnessObservationExample
InstanceOf: MindfulnessObservation
Usage: #example
Description: "Mindfulness observation example"
Title: "Example of Mindfulness Session Observation"

* status = #final
* code = $SCT#711415009 "Mindfulness"
* subject = Reference(Patient/PatientExample)
* effectiveDateTime = "2024-03-19T09:30:00Z"
* performer = Reference(Practitioner/PractitionerExample)

* component[sessionDuration].code = $SCT#118682006 "Duration"
* component[sessionDuration].valueQuantity = 20 'min'

* component[stressLevel].code = $SCT#725854004 "Assessment of stress level"
* component[stressLevel].valueInteger = 4

* component[moodState].code = $SCT#373931001 "Mood finding"
* component[moodState].valueCodeableConcept = $SCT#130991005 "Neutral mood"

* component[relaxationResponse].code = $SCT#276241001 "Relaxation technique"
* component[relaxationResponse].valueString = "Deep breathing exercises helped reduce tension"

* component[mindfulnessType].code = $SCT#711415009 "Mindfulness"
* component[mindfulnessType].valueCodeableConcept = $SCT#711415009 "Mindfulness"

// New example for MindfulnessQuestionnaire
Instance: MindfulnessQuestionnaireExample
InstanceOf: Questionnaire
Usage: #example
Title: "Example of Mindfulness Questionnaire"

* url = "https://2rdoc.pt/ig/ios-lifestyle-medicine/Questionnaire/mindfulness-example"
* status = #active
* title = "Daily Mindfulness Assessment"
* version = "1.0"
* name = "MindfulnessQuestionnaireExample"
* date = "2024-03-19"
* description = "Example questionnaire for daily mindfulness practice assessment"

* item[0]
  * linkId = "session_details"
  * text = "Session Details"
  * type = #group
  
  * item[0]
    * linkId = "duration"
    * text = "Duration (minutes)"
    * type = #integer
    * required = true
    
  * item[1]
    * linkId = "technique"
    * text = "Technique Used"
    * type = #choice
    * required = true
    * answerOption[0].valueString = "Mindful Breathing"
    * answerOption[1].valueString = "Body Scan"
    * answerOption[2].valueString = "Walking Meditation"



// ===== Conteúdo de: ReproductiveExamples.fsh =====

Instance: ExampleReproductiveActivity
InstanceOf: CarePlan
Usage: #example
Description: "Reproductive health care plan example"
* status = #active
* intent = #plan
* subject = Reference(Patient/PatientExample)
* activity.detail.kind = #ServiceRequest
* activity.detail.code = ReproductiveActivityCS#cycle-tracking
* activity.detail.status = #scheduled



// ===== Conteúdo de: MissingResources.fsh =====

// ====== Recursos Faltantes para Resolver Links Quebrados ======

Instance: example
InstanceOf: Patient
Usage: #example
* identifier.system = "http://example.org/patients"
* identifier.value = "example-patient"
* name.family = "Example"
* name.given = "Patient"
* gender = #unknown
* birthDate = "1970-01-01"

Instance: osa-practitioner-kyle-anydoc
InstanceOf: Practitioner
Usage: #example
* identifier.system = "http://example.org/practitioners"
* identifier.value = "kyle-anydoc"
* name.family = "Anydoc"
* name.given = "Kyle"
* name.prefix = "Dr."

Instance: PatientMindfulness
InstanceOf: Patient
Usage: #example
* identifier.system = "http://example.org/patients"
* identifier.value = "mindfulness-patient"
* name.family = "Mindfulness"
* name.given = "Test"
* gender = #other
* birthDate = "1980-01-01"

Instance: Org2RDoc
InstanceOf: Organization
Usage: #example
* identifier.system = "http://example.org/organizations"
* identifier.value = "2rdoc"
* name = "2RDoc Healthcare Solutions"
* active = true



// ===== Conteúdo de: MindfulnessWorkflow.fsh =====

Profile: MindfulnessSchedule
Parent: Basic
Id: mindfulness-schedule
Title: "Mindfulness Schedule"
Description: "Schedule configuration for mindfulness sessions"

* code 1..1 MS
* code = https://2rdoc.pt/fhir/CodeSystem/mindfulness-schedule-type#recurring "Recurring Schedule"

Extension: MindfulnessScheduleTiming
Id: mindfulness-schedule-timing
Title: "Mindfulness Schedule Timing"
Description: "Timing configuration for mindfulness sessions"
* value[x] only Timing

Instance: WeeklyMindfulnessSchedule
InstanceOf: MindfulnessSchedule
Title: "Weekly Mindfulness Schedule"
Description: "Example of a weekly mindfulness schedule"

* code = https://2rdoc.pt/fhir/CodeSystem/mindfulness-schedule-type#recurring "Recurring Schedule"
* extension[mindfulness-schedule-timing].valueTiming.repeat.frequency = 1
* extension[mindfulness-schedule-timing].valueTiming.repeat.period = 1
* extension[mindfulness-schedule-timing].valueTiming.repeat.periodUnit = #wk
* extension[mindfulness-schedule-timing].valueTiming.repeat.dayOfWeek = #mon
* extension[mindfulness-schedule-timing].valueTiming.repeat.dayOfWeek[+] = #wed
* extension[mindfulness-schedule-timing].valueTiming.repeat.dayOfWeek[+] = #fri



// ===== Conteúdo de: MindfulnessRules.fsh =====

RuleSet: MindfulnessValidation
* ^extension[0].url = "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice"
* ^extension[0].valueBoolean = true

* status MS
* code MS
* subject MS
* effective[x] MS
* value[x] MS
* component MS

* status from http://hl7.org/fhir/ValueSet/observation-status
* code from http://snomed.info/sct?fhir_vs=isa/711415009
* subject only Reference(Patient)
* effective[x] only dateTime

* obeys mindfulness-session-duration
* obeys mindfulness-stress-level
* obeys mindfulness-mood-required
* obeys mindfulness-context-complete
* obeys sequential-measurements

RuleSet: MindfulnessQuestionnaireValidation
* status MS
* title MS
* item MS

* status = #active
* subjectType = #Patient
* item ^slicing.discriminator.type = #pattern
* item ^slicing.discriminator.path = "linkId"
* item ^slicing.rules = #open
* item contains 
    session 0..1 MS and
    mood 0..1 MS and
    stress 0..1 MS and
    relaxation 0..1 MS

* item[session]
  * linkId = "mindful_session"
  * text = "Mindfulness Session"
  * type = #group
  * required = true
  * repeats = false

* item[mood]
  * linkId = "mood_assessment"
  * text = "Mood Assessment"
  * type = #group
  * required = true
  * repeats = false

* item[stress]
  * linkId = "stress_assessment"
  * text = "Stress Assessment"
  * type = #group
  * required = true
  * repeats = false

* item[relaxation]
  * linkId = "relaxation"
  * text = "Relaxation"
  * type = #group
  * required = true
  * repeats = false

RuleSet: MindfulnessResponseValidation
* status MS
* subject MS
* authored MS
* item MS

* status = #completed
* subject only Reference(Patient)
* authored 1..1
* item ^slicing.discriminator.type = #pattern
* item ^slicing.discriminator.path = "linkId"
* item ^slicing.rules = #open



// ===== Conteúdo de: MindfulnessMappings.fsh =====

Mapping: MindfulnessToHealthKit
Id: mindfulness-to-healthkit
Title: "Mapping to Apple HealthKit"
Source: MindfulnessObservation
Target: "http://developer.apple.com/documentation/healthkit"

* -> "HKCategoryTypeIdentifierMindfulSession" "Root mapping"
* effectiveDateTime -> "startDate and endDate" "Session timing"
* component[sessionDuration].valueQuantity -> "duration" "Session duration"

Mapping: MindfulnessToLOINC
Id: mindfulness-to-loinc
Title: "Mapping to LOINC codes"
Source: MindfulnessObservation
Target: "http://loinc.org"

* -> "89555-7" "Mindfulness safety questionnaire"
* component[stressLevel] -> "89556-5" "Stress level score"
* component[sessionDuration] -> "89557-3" "Duration of mindfulness practice"
* component[moodState] -> "89558-1" "Mood pattern"

Mapping: MindfulnessToSNOMED
Id: mindfulness-to-snomed
Title: "Mapping to SNOMED CT"
Source: MindfulnessObservation
Target: "http://snomed.info/sct"

* -> "711415009" "Meditation"
* component[stressLevel] -> "725854004" "Assessment of stress level"
* component[moodState] -> "373931001" "Mood finding"
* component[relaxationResponse] -> "276241001" "Relaxation technique"

Extension: MindfulnessImportMap
Id: mindfulness-import-map
Title: "Mindfulness Import Mapping"
Description: "Mapping instructions for importing mindfulness data"

* ^url = "https://2rdoc.pt/ig/ios-lifestyle-medicine/StructureDefinition/mindfulness-import-map"
* ^version = "1.0.0"
* ^status = #draft

* extension contains
    source 1..1 MS and
    target 1..1 MS and
    mapping 1..1 MS

* extension[source].value[x] only string
* extension[target].value[x] only string
* extension[mapping].value[x] only string

Instance: HealthKitMappingConfig
InstanceOf: MindfulnessImportMap
Usage: #inline

* extension[source].valueString = "HKCategoryTypeIdentifierMindfulSession"
* extension[target].valueString = "Observation"
* extension[mapping].valueString = "duration->component[sessionDuration].valueQuantity"



// ===== Conteúdo de: SocialInteractionMappings.fsh =====

Mapping: SocialInteractionToHealthKit
Id: social-interaction-to-healthkit
Description: "Definition for social-interaction-to-healthkit resource"Title: "Mapping to Apple HealthKit"
Source: SocialInteractionProfile
Target: "http://developer.apple.com/documentation/healthkit"

* -> "HKCategoryTypeIdentifierSocialInteraction" "Root mapping"
* valueCodeableConcept -> "interactionType" "Type of interaction"
* component[duration] -> "duration" "Duration of interaction"
* component[participants] -> "participantCount" "Number of participants"

Mapping: SocialInteractionToLOINC
Id: social-interaction-to-loinc
Title: "Mapping to LOINC codes"
Source: SocialInteractionProfile
Target: "http://loinc.org"

* -> "96766-1" "Social Interaction Panel"
* component[duration] -> "89597-9" "Interaction duration"
* component[quality] -> "89598-7" "Interaction quality"



// ===== Conteúdo de: MindfulnessDiagnosticMappings.fsh =====

Instance: MindfulnessDiagnosticMap
InstanceOf: ConceptMap
Usage: #definition
Title: "Mindfulness Diagnostic Mappings"
Description: "Mapping of mindfulness outcomes to diagnostic codes"

* status = #draft
* experimental = false
* purpose = "Map mindfulness outcomes to standard diagnostic codes"
* sourceUri = "https://2rdoc.pt/fhir/ValueSet/mindfulness-outcome-vs"
* targetUri = "http://snomed.info/sct"

* group[0].source = "https://2rdoc.pt/fhir/CodeSystem/mindfulness-outcome-cs"
* group[0].target = "http://snomed.info/sct"
* group[0].element[0]
  * code = #stressReduction
  * target[0]
    * code = #73595000
    * display = "Stress"
    * equivalence = #narrower
    * comment = "Indicates reduction in stress levels"

* group[0].element[1]
  * code = #improvedSleep
  * target[0]
    * code = #248234008
    * display = "Sleep pattern"
    * equivalence = #narrower
    * comment = "Indicates improvement in sleep quality"

* group[0].element[2]
  * code = #emotionalBalance
  * target[0]
    * code = #285854004
    * display = "Emotional state"
    * equivalence = #equivalent
    * comment = "Maps to emotional state finding"

* group[0].element[3]
  * code = #increasedAwareness
  * target[0]
    * code = #736253002
    * display = "Mental state, behavior and/or psychosocial functioning"
    * equivalence = #relatedto
    * comment = "General improvement in mental state"

RuleSet: MindfulnessDiagnosticRules
* status MS
* code MS
* subject MS
* effective[x] MS
* value[x] MS
* method MS

* method from https://2rdoc.pt/fhir/ValueSet/mindfulness-diagnostic-method-vs (required)
* code from https://2rdoc.pt/fhir/ValueSet/mindfulness-diagnostic-code-vs (required)

* extension contains 
    diagnosticCertainty 0..1 MS and
    diagnosticTiming 0..1 MS



// ===== Conteúdo de: StressMappings.fsh =====

Mapping: StressToHealthKit
Id: stress-to-healthkit
Description: "Definition for stress-to-healthkit resource"Title: "Mapping to Apple HealthKit"
Source: StressLevelProfile
Target: "http://developer.apple.com/documentation/healthkit"

* -> "HKCategoryTypeIdentifierStressLevel" "Root mapping"
* valueQuantity -> "stressLevel" "Overall stress score"
* component[physiologicalStress] -> "physiologicalStress" "Physical stress indicators"
* component[psychologicalStress] -> "mentalStress" "Mental stress indicators"

Mapping: StressToLOINC
Id: stress-to-loinc
Title: "Mapping to LOINC codes"
Source: StressLevelProfile
Target: "http://loinc.org"

* -> "89592-0" "Stress Level Panel"
* component[physiologicalStress] -> "89593-8" "Physical stress score"
* component[psychologicalStress] -> "89594-6" "Mental stress score"



// ===== Conteúdo de: BodyMetricsProfiles.fsh =====

Alias: $SCT = http://snomed.info/sct
Alias: $LOINC = http://loinc.org
Alias: $UCUM = http://unitsofmeasure.org

Profile: BodyMetricsObservation
Parent: Observation
Id: body-metrics-observation
Title: "Body Metrics Observation Profile"
Description: "Profile for body measurements from iOS Health App"

* ^version = "0.1.0"
* ^status = #draft
* ^publisher = "Open Health Manager"

* status MS
* category 1..1 MS
* category = http://terminology.hl7.org/CodeSystem/observation-category#vital-signs
* subject 1..1 MS
* effectiveDateTime 1..1 MS
* device 0..1 MS

Profile: WeightObservation
Parent: BodyMetricsObservation
Id: weight-observation  
Title: "Weight Measurement Profile"
Description: "Profile for body weight measurements"

* ^version = "0.1.0"
* ^status = #draft

* code = $LOINC#29463-7 "Body weight"
* valueQuantity only Quantity
* valueQuantity.system = $UCUM
* valueQuantity.code = #kg

Profile: HeightObservation
Parent: BodyMetricsObservation
Id: height-observation
Title: "Height Measurement Profile" 
Description: "Profile for body height measurements"

* ^version = "0.1.0"
* ^status = #draft

* code = $LOINC#8302-2 "Body height"
* valueQuantity only Quantity
* valueQuantity.system = $UCUM
* valueQuantity.code = #cm

Profile: BMIObservation
Parent: BodyMetricsObservation
Id: bmi-observation
Title: "BMI Measurement Profile"
Description: "Profile for Body Mass Index calculations"

* ^version = "0.1.0"
* ^status = #draft

* code = $LOINC#39156-5 "Body mass index (BMI)"
* valueQuantity only Quantity
* valueQuantity.system = $UCUM
* valueQuantity.code = #kg/m2

Profile: BodyCompositionObservation
Parent: BodyMetricsObservation
Id: body-composition-observation
Title: "Body Composition Profile"
Description: "Profile for body composition measurements including fat, lean mass, and other metrics"

* ^version = "0.1.0"
* ^status = #draft

* code = $LOINC#88365-2 "Body composition panel"
* component ^slicing.discriminator.type = #pattern
* component ^slicing.discriminator.path = "code"
* component ^slicing.rules = #open

* component contains
    bodyFat 0..1 MS and
    leanMass 0..1 MS and
    bodyWater 0..1 MS and
    muscleMass 0..1 MS and
    boneMass 0..1 MS

* component[bodyFat].code = $LOINC#41982-0 "Percentage body fat"
* component[bodyFat].valueQuantity.system = $UCUM
* component[bodyFat].valueQuantity.code = #%

* component[leanMass].code = $LOINC#291-7 "Lean body mass"
* component[leanMass].valueQuantity.system = $UCUM
* component[leanMass].valueQuantity.code = #kg

* component[bodyWater].code = $LOINC#73708-0 "Total body water"
* component[bodyWater].valueQuantity.system = $UCUM  
* component[bodyWater].valueQuantity.code = #L

* component[muscleMass].code = $LOINC#73713-0 "Muscle mass"
* component[muscleMass].valueQuantity.system = $UCUM
* component[muscleMass].valueQuantity.code = #kg

* component[boneMass].code = $LOINC#73711-4 "Bone mass" 
* component[boneMass].valueQuantity.system = $UCUM
* component[boneMass].valueQuantity.code = #kg



// ===== Conteúdo de: AdvancedVitalSignsProfiles.fsh =====

Alias: $SCT = http://snomed.info/sct
Alias: $LOINC = http://loinc.org
Alias: $UCUM = http://unitsofmeasure.org

Profile: AdvancedVitalSigns
Parent: Observation
Id: advanced-vital-signs
Title: "Advanced Vital Signs Profile"
Description: "Profile for advanced vital signs data from iOS Health App"

* ^version = "0.1.0"
* ^status = #draft
* ^publisher = "HL7 International"
* ^contact.name = "Advanced Vital Signs Working Group"

* status MS
* category 1..1 MS
* category = http://terminology.hl7.org/CodeSystem/observation-category#vital-signs
* code 1..1 MS
* subject 1..1 MS
* effectiveDateTime 1..1 MS
* device 0..1 MS
* method 0..1 MS
* note 0..* MS

* component ^slicing.discriminator.type = #pattern
* component ^slicing.discriminator.path = "code"
* component ^slicing.rules = #open
* component ^short = "Advanced vital signs components"
* component ^definition = "Components of advanced vital sign measurements"

* component contains
    hrvSpectral 0..1 MS and
    hrvEntropy 0..1 MS and
    meanArterialPressure 0..1 MS and
    pulseWaveAnalysis 0..1 MS and
    respiratoryVariability 0..1 MS and
    oxygenationIndex 0..1 MS and
    stressIndex 0..1 MS and
    thermalGradient 0..1 MS and
    autonomicBalance 0..1 MS and
    recoveryRate 0..1 MS and
    allostaticLoad 0..1 MS

* component[hrvSpectral].code = $LOINC#87834-8 "Heart rate variability [Frequency band]"
* component[hrvSpectral].valueQuantity.system = $UCUM
* component[hrvSpectral].valueQuantity.code = #ms
* component[hrvSpectral] ^short = "Spectral analysis of heart rate variability"

* component[hrvEntropy].code = $LOINC#87835-5 "Heart rate variability entropy"
* component[hrvEntropy].valueQuantity.system = $UCUM
* component[hrvEntropy].valueQuantity.code = #{entropy}
* component[hrvEntropy] ^short = "Sample entropy of heart rate variability"

* component[meanArterialPressure].code = $LOINC#8478-0 "Mean blood pressure"
* component[meanArterialPressure].valueQuantity.system = $UCUM
* component[meanArterialPressure].valueQuantity.code = #mmHg
* component[meanArterialPressure] ^short = "Mean arterial blood pressure"

* component[pulseWaveAnalysis].code = $LOINC#87836-3 "Pulse wave analysis"
* component[pulseWaveAnalysis].valueQuantity.system = $UCUM
* component[pulseWaveAnalysis].valueQuantity.code = #{index}
* component[pulseWaveAnalysis] ^short = "Analysis of arterial pulse wave"

* component[respiratoryVariability].code = $LOINC#87837-1 "Respiratory rate variability"
* component[respiratoryVariability].valueQuantity.system = $UCUM
* component[respiratoryVariability].valueQuantity.code = #{coefficient}
* component[respiratoryVariability] ^short = "Variability in respiratory rate"

* component[oxygenationIndex].code = $LOINC#87838-9 "Oxygenation index"
* component[oxygenationIndex].valueQuantity.system = $UCUM
* component[oxygenationIndex].valueQuantity.code = #{ratio}
* component[oxygenationIndex] ^short = "Index of blood oxygenation"

* component[stressIndex].code = $LOINC#87839-7 "Physiological stress index"
* component[stressIndex].valueQuantity.system = $UCUM
* component[stressIndex].valueQuantity.code = #{index}
* component[stressIndex] ^short = "Index of physiological stress"

* component[thermalGradient].code = $LOINC#87840-5 "Temperature gradient"
* component[thermalGradient].valueQuantity.system = $UCUM
* component[thermalGradient].valueQuantity.code = #Cel
* component[thermalGradient] ^short = "Gradient of body temperature"

* component[autonomicBalance].code = $LOINC#87841-3 "Autonomic balance index"
* component[autonomicBalance].valueQuantity.system = $UCUM
* component[autonomicBalance].valueQuantity.code = #{ratio}
* component[autonomicBalance] ^short = "Balance of autonomic nervous system"

* component[recoveryRate].code = $LOINC#87842-1 "Recovery rate index"
* component[recoveryRate].valueQuantity.system = $UCUM
* component[recoveryRate].valueQuantity.code = #{rate}
* component[recoveryRate] ^short = "Rate of physiological recovery"

* component[allostaticLoad].code = $LOINC#87843-9 "Allostatic load index"
* component[allostaticLoad].valueQuantity.system = $UCUM
* component[allostaticLoad].valueQuantity.code = #{score}
* component[allostaticLoad] ^short = "Measure of cumulative physiological burden"

Extension: AdvancedVitalSignsContext
Id: advanced-vital-signs-context
Title: "Advanced Vital Signs Context Extension"
Description: "Additional context about advanced vital sign measurements"

* value[x] only CodeableConcept
* valueCodeableConcept from AdvancedVitalSignsContextVS (required)

ValueSet: AdvancedVitalSignsContextVS
Id: advanced-vital-signs-context-vs
Title: "Advanced Vital Signs Context Value Set"
Description: "Context codes for advanced vital sign measurements"

* ^experimental = true
* codes from system AdvancedVitalSignsContextCS

CodeSystem: AdvancedVitalSignsContextCS
Id: advanced-vital-signs-context-cs
Title: "Advanced Vital Signs Context Code System"
Description: "Codes for advanced vital signs measurement context"

* ^experimental = true
* ^caseSensitive = true

* #resting "Resting state" "Measurement taken during rest"
* #active "Active state" "Measurement taken during activity"
* #recovery "Recovery state" "Measurement taken during recovery"
* #sleep "Sleep state" "Measurement taken during sleep"
* #stress "Stress state" "Measurement taken during stress"



// ===== Conteúdo de: MobilityProfiles.fsh =====

Profile: MobilityProfile
Parent: Observation
Id: mobility-profile
Title: "Mobility Profile"
Description: "Profile for mobility data from iOS Health App"

* status MS
* category 1..1 MS
* category = http://terminology.hl7.org/CodeSystem/observation-category#activity
* code 1..1 MS
* subject 1..1 MS
* effectiveDateTime 1..1 MS
* device 0..1 MS

* component ^slicing.discriminator.type = #pattern
* component ^slicing.discriminator.path = "code"
* component ^slicing.rules = #open

* component contains
    steadiness 0..1 MS and
    balance 0..1 MS and
    gait 0..1 MS and 
    movement 0..1 MS

* component[steadiness].code = $LOINC#LA32-8
* component[balance].code = $LOINC#LA32-9
* component[gait].code = $LOINC#LA29042-4
* component[movement].code = $LOINC#LA29043-2



// ===== Conteúdo de: VitalSignsProfiles.fsh =====

Alias: $SCT = http://snomed.info/sct
Alias: $LOINC = http://loinc.org
Alias: $UCUM = http://unitsofmeasure.org
Alias: $vitalsigns = http://hl7.org/fhir/StructureDefinition/vitalsigns

Profile: LifestyleVitalSigns
Parent: $vitalsigns
Id: lifestyle-vital-signs
Title: "Lifestyle Medicine Vital Signs Profile"
Description: "Profile for vital signs data from iOS Health App"

* status MS
* category 1..* MS
* subject 1..1 MS
* effectiveDateTime 1..1 MS
* code 1..1 MS
* value[x] 0..1 MS
* device 0..1 MS

Profile: HeartRateObservation
Parent: LifestyleVitalSigns
Id: heart-rate-observation
Title: "Heart Rate Observation Profile"
Description: "Profile for heart rate measurements from iOS Health App"

* code = $LOINC#8867-4 "Heart rate"
* valueQuantity only Quantity
* valueQuantity.system = $UCUM
* valueQuantity.code = #/min
* component ^slicing.discriminator.type = #pattern
* component ^slicing.discriminator.path = "code"
* component ^slicing.rules = #open

* component contains
    restingHeartRate 0..1 MS and
    exerciseHeartRate 0..1 MS and
    recoveryHeartRate 0..1 MS and
    heartRateVariability 0..1 MS

* component[heartRateVariability].code = $LOINC#80404-7 "R-R interval.standard deviation (Heart rate variability)"
* component[heartRateVariability].valueQuantity.system = $UCUM
* component[heartRateVariability].valueQuantity.code = #ms

Profile: BloodPressureObservation
Parent: LifestyleVitalSigns
Id: blood-pressure-observation
Title: "Blood Pressure Observation Profile"
Description: "Profile for blood pressure measurements from iOS Health App"

* code = $LOINC#85354-9 "Blood pressure panel with all children optional"
* component 2..2 MS
* component ^slicing.discriminator.type = #pattern
* component ^slicing.discriminator.path = "code"
* component ^slicing.rules = #closed

* component contains
    systolic 1..1 MS and
    diastolic 1..1 MS

* component[systolic].code = $LOINC#8480-6 "Systolic blood pressure"
* component[systolic].valueQuantity only Quantity
* component[systolic].valueQuantity.system = $UCUM
* component[systolic].valueQuantity.code = #mm[Hg]

* component[diastolic].code = $LOINC#8462-4 "Diastolic blood pressure"
* component[diastolic].valueQuantity only Quantity
* component[diastolic].valueQuantity.system = $UCUM
* component[diastolic].valueQuantity.code = #mm[Hg]

Profile: OxygenSaturationObservation
Parent: LifestyleVitalSigns
Id: oxygen-saturation-observation
Title: "Oxygen Saturation Observation Profile"
Description: "Profile for SpO2 measurements from iOS Health App"

* code = $LOINC#2708-6 "Oxygen saturation in Arterial blood"
* valueQuantity.system = $UCUM
* valueQuantity.code = #%



// ===== Conteúdo de: PhysicalActivityProfile.fsh =====

Alias: $LOINC = http://loinc.org
Alias: $SNOMED = http://snomed.info/sct
Alias: $UCUM = http://unitsofmeasure.org
Alias: $ActivityCodes = https://2rdoc.pt/ig/ios-lifestyle-medicine/activity-codes

Profile: PhysicalActivityObservation
Parent: Observation
Id: physical-activity-observation
Title: "Physical Activity Observation Profile"
Description: "Profile for recording physical activity data from iOS Health App"

* status MS
* category 1..1 MS
* category = http://terminology.hl7.org/CodeSystem/observation-category#activity
* code 1..1 MS
* code from PhysicalActivityTypeVS (required)
* subject 1..1 MS
* subject only Reference(Patient)
* effectiveDateTime 1..1 MS
* device 0..1 MS
* value[x] only Quantity
* component ^slicing.discriminator.type = #pattern
* component ^slicing.discriminator.path = "code"
* component ^slicing.rules = #open

* component contains
    steps 0..1 MS and
    distance 0..1 MS and
    duration 0..1 MS and
    energy 0..1 MS

* component[steps].code = $LOINC#55423-8 "Number of steps in 24 hour Measured"
* component[steps].valueQuantity only Quantity
* component[steps].valueQuantity.system = $UCUM
* component[steps].valueQuantity.code = #1 "count"

* component[distance].code = $LOINC#55430-3 "Distance walked"
* component[distance].valueQuantity only Quantity
* component[distance].valueQuantity.system = $UCUM
* component[distance].valueQuantity.code = #km "kilometer"

* component[duration].code = $LOINC#55411-3 "Exercise duration"
* component[duration].valueQuantity only Quantity
* component[duration].valueQuantity.system = $UCUM
* component[duration].valueQuantity.code = #min "minute"

* component[energy].code = $LOINC#55424-6 "Energy expenditure"
* component[energy].valueQuantity only Quantity
* component[energy].valueQuantity.system = $UCUM
* component[energy].valueQuantity.code = #kcal "kilocalorie"



// ===== Conteúdo de: ReproductiveObservation.fsh =====

Profile: ReproductiveObservation
Parent: Observation
Id: reproductive-observation
Title: "Reproductive Health Base Profile"
Description: "Base profile for reproductive health observations"

* ^version = "1.0.0"
* ^status = #active
* ^date = "2024-03-19"

* status MS
* category 1..1 MS
* category = http://terminology.hl7.org/CodeSystem/observation-category#reproductive
* code 1..1 MS
* subject 1..1 MS
* subject only Reference(Patient)
* effectiveDateTime 1..1 MS
* value[x] MS

* component ^slicing.discriminator.type = #pattern
* component ^slicing.discriminator.path = "code"
* component ^slicing.rules = #open

* component contains
    severity 0..1 MS and
    duration 0..1 MS and
    frequency 0..1 MS and
    pattern 0..1 MS

* component[severity]
  * code = $LOINC#72514-3
  * value[x] only integer
  * valueInteger 1..1 
  * valueInteger obeys rep-1

* component[duration]
  * code = $LOINC#103332-8
  * value[x] only Quantity
  * valueQuantity from DurationUnitsVS (required)

* component[frequency]
  * code = $LOINC#103334-4
  * value[x] only CodeableConcept
  * valueCodeableConcept from SymptomFrequencyVS (required)

* component[pattern]
  * code = $LOINC#103335-1
  * value[x] only CodeableConcept
  * valueCodeableConcept from SymptomProgressionVS (required)

Invariant: rep-1
Description: "Severity must be between 0 and 10"
Expression: "$this >= 0 and $this <= 10"
Severity: #error



// ===== Conteúdo de: SymptomProfiles.fsh =====

Profile: SymptomQuestionnaire
Parent: Questionnaire
Id: symptom-questionnaire
Title: "Symptom Assessment Questionnaire"
Description: "Questionnaire template for symptom assessments"

* status MS
* title MS
* item MS

* item ^slicing.discriminator.type = #pattern
* item ^slicing.discriminator.path = "linkId"
* item ^slicing.rules = #open

* item contains
    symptomType 1..1 MS and
    location 0..1 MS and
    onset 0..1 MS and
    description 0..1 MS

* item[symptomType].linkId = "symptom-type"
* item[symptomType].text = "Type of Symptom"
* item[symptomType].type = #choice
* item[symptomType].required = true

* item[location].linkId = "location"
* item[location].text = "Location"
* item[location].type = #string

* item[onset].linkId = "onset"
* item[onset].text = "When did it start?"
* item[onset].type = #dateTime

* item[description].linkId = "description"
* item[description].text = "Description"
* item[description].type = #text



// ===== Conteúdo de: ReproductiveProfiles.fsh =====

Profile: FertilityObservation
Parent: Observation
Id: fertility-observation
Title: "Fertility Observation Profile"
Description: "Profile for fertility signs and symptoms"

* status MS
* category 1..1 MS
* category = http://terminology.hl7.org/CodeSystem/observation-category#reproductive
* code = $LOINC#8669-4 "Ovulation status"
* subject 1..1 MS
* effectiveDateTime 1..1 MS

* component ^slicing.discriminator.type = #pattern
* component ^slicing.discriminator.path = "code"
* component ^slicing.rules = #open

* component contains
    cervicalMucus 0..1 MS and
    ovulationTest 0..1 MS and
    fertilityStatus 0..1 MS

* component[cervicalMucus].valueCodeableConcept from https://2rdoc.pt/fhir/ValueSet/cervical-mucus-vs (required)
* component[ovulationTest].valueCodeableConcept from https://2rdoc.pt/fhir/ValueSet/ovulation-test-vs (required)
* component[fertilityStatus].valueCodeableConcept from https://2rdoc.pt/fhir/ValueSet/fertility-status-vs (required)



// ===== Conteúdo de: MindfulnessProfiles.fsh =====

Profile: MindfulnessObservation
Parent: Observation
Id: mindfulness-observation
Title: "Mindfulness Session Observation"
Description: "Profile for recording mindfulness practice sessions and outcomes"

* status MS
* code MS
* subject MS
* effectiveDateTime MS
* performer MS
* value[x] MS
* component MS

* status = #final
* code = $SCT#711415009 "Mindfulness"
* subject only Reference(Patient)
* effectiveDateTime 1..1
* performer only Reference(Practitioner or PractitionerRole)

* component ^slicing.discriminator.type = #pattern
* component ^slicing.discriminator.path = "code"
* component ^slicing.rules = #open

* component contains
    sessionDuration 0..1 and
    stressLevel 0..1 and
    moodState 0..1 and
    relaxationResponse 0..1 and
    mindfulnessType 0..1

* component[sessionDuration]
  * code = $SCT#118682006 "Duration"
  * value[x] only Quantity
  * valueQuantity
    * value 1..1
    * unit = "min"
    * system = "http://unitsofmeasure.org"
    * code = #min

* component[stressLevel]
  * code = $SCT#725854004 "Assessment of stress level"
  * value[x] only integer
  * valueInteger
    * ^extension[0].url = "http://hl7.org/fhir/StructureDefinition/elementdefinition-minValueInteger"
    * ^extension[0].valueInteger = 0
    * ^extension[1].url = "http://hl7.org/fhir/StructureDefinition/elementdefinition-maxValueInteger"
    * ^extension[1].valueInteger = 10

* component[moodState]
  * code = $SCT#373931001 "Mood finding"
  * value[x] only CodeableConcept
  * valueCodeableConcept from https://2rdoc.pt/fhir/ValueSet/mood (required)

* component[relaxationResponse]
  * code = $SCT#276241001 "Relaxation technique"
  * value[x] only string

* component[mindfulnessType]
  * code = $SCT#711415009 "Mindfulness"
  * value[x] only CodeableConcept
  * valueCodeableConcept from https://2rdoc.pt/fhir/ValueSet/mindfulness-type (required)



// ===== Conteúdo de: SleepProfile.fsh =====

Alias: $SCT = http://snomed.info/sct
Alias: $LOINC = http://loinc.org
Alias: $UCUM = http://unitsofmeasure.org
 
Profile: SleepObservation
Parent: Observation
Id: sleep-observation
Title: "Sleep Observation Profile"
Description: "Profile for recording sleep data from iOS Health App"
 
* status MS
* category 1..1 MS
* category = http://terminology.hl7.org/CodeSystem/observation-category#sleep
* code 1..1 MS
* code = $LOINC#93832-4 "Sleep pattern panel"
* subject 1..1 MS
* subject only Reference(Patient)
* effectiveDateTime 0..1 MS
* effectivePeriod 0..1 MS
* device 0..1 MS
 
* component ^slicing.discriminator.type = #pattern
* component ^slicing.discriminator.path = "code"
* component ^slicing.rules = #open
 
* component contains
    timeInBed 1..1 MS and
    totalSleepTime 1..1 MS and
    deepSleep 0..1 MS and
    remSleep 0..1 MS and
    lightSleep 0..1 MS and
    respiratoryRate 0..1 MS and
    heartRateVariability 0..1 MS and
    interruptions 0..1 MS
 
* component[timeInBed].code = $LOINC#93831-6 "Time in bed"
* component[timeInBed].valueQuantity only Quantity
* component[timeInBed].valueQuantity.system = $UCUM
* component[timeInBed].valueQuantity.code = #min
 
* component[totalSleepTime].code = $LOINC#93833-2 "Sleep duration"
* component[totalSleepTime].valueQuantity only Quantity
* component[totalSleepTime].valueQuantity.system = $UCUM
* component[totalSleepTime].valueQuantity.code = #min
 
* component[deepSleep].code = $LOINC#93834-0 "Deep sleep duration"
* component[deepSleep].valueQuantity only Quantity
* component[deepSleep].valueQuantity.system = $UCUM
* component[deepSleep].valueQuantity.code = #min
 
* component[remSleep].code = $LOINC#93835-7 "REM sleep duration"
* component[remSleep].valueQuantity only Quantity
* component[remSleep].valueQuantity.system = $UCUM
* component[remSleep].valueQuantity.code = #min
 
* component[lightSleep].code = $LOINC#93836-5 "Light sleep duration"
* component[lightSleep].valueQuantity only Quantity
* component[lightSleep].valueQuantity.system = $UCUM
* component[lightSleep].valueQuantity.code = #min
 
* component[respiratoryRate].code = $LOINC#9279-1 "Respiratory rate"
* component[respiratoryRate].valueQuantity only Quantity
* component[respiratoryRate].valueQuantity.system = $UCUM
* component[respiratoryRate].valueQuantity.code = #/min
 
* component[heartRateVariability].code = $LOINC#80404-7 "R-R interval.standard deviation (Heart rate variability)"
* component[heartRateVariability].valueQuantity only Quantity
* component[heartRateVariability].valueQuantity.system = $UCUM
* component[heartRateVariability].valueQuantity.code = #ms
 
* component[interruptions].code = $LOINC#93837-3 "Number of awakenings during sleep"
* component[interruptions].valueQuantity only Quantity
* component[interruptions].valueQuantity.system = $UCUM
* component[interruptions].valueQuantity.code = #{count}
* extension contains SleepQuality named quality 0..1



// ===== Conteúdo de: MobilityRiskAssessment.fsh =====

Profile: MobilityRiskAssessment
Parent: RiskAssessment
Id: mobility-risk-assessment
Title: "Mobility Risk Assessment Profile"
Description: "Profile for assessing mobility-related risks"

* status MS
* subject 1..1 MS
* occurrence[x] MS
* prediction MS
  * outcome MS
  * probability[x] MS
  * qualitativeRisk MS

* method MS
  * coding ^slicing.discriminator.type = #pattern
  * coding ^slicing.discriminator.path = "$this"
  * coding ^slicing.rules = #open
  * coding contains
      mobilityAssessment 1..1 MS

* method.coding[mobilityAssessment] = https://2rdoc.pt/fhir/CodeSystem/mobility-assessment-method#standardized "Standardized Mobility Assessment"

* prediction ^slicing.discriminator.type = #pattern
* prediction ^slicing.discriminator.path = "outcome"
* prediction ^slicing.rules = #open

* prediction contains
    fallRisk 0..1 MS and
    mobilityDecline 0..1 MS and
    assistanceNeeded 0..1 MS

* prediction[fallRisk].outcome from https://2rdoc.pt/fhir/ValueSet/fall-risk-outcomes
* prediction[fallRisk].probabilityDecimal 0..1 MS
* prediction[fallRisk].qualitativeRisk from https://2rdoc.pt/fhir/ValueSet/risk-level

* prediction[mobilityDecline].outcome from https://2rdoc.pt/fhir/ValueSet/mobility-decline-outcomes
* prediction[mobilityDecline].probabilityDecimal 0..1 MS
* prediction[mobilityDecline].qualitativeRisk from https://2rdoc.pt/fhir/ValueSet/risk-level

* prediction[assistanceNeeded].outcome from https://2rdoc.pt/fhir/ValueSet/assistance-level-outcomes
* prediction[assistanceNeeded].probabilityDecimal 0..1 MS
* prediction[assistanceNeeded].qualitativeRisk from https://2rdoc.pt/fhir/ValueSet/risk-level

* basis only Reference(MobilityProfile or Observation or QuestionnaireResponse)
* basis MS

* note MS



// ===== Conteúdo de: EnvironmentalProfiles.fsh =====

Alias: $SCT = http://snomed.info/sct
Alias: $LOINC = http://loinc.org
Alias: $UCUM = http://unitsofmeasure.org

Profile: EnvironmentalObservation
Parent: Observation
Id: environmental-observation
Title: "Environmental Observation Profile"
Description: "Base profile for environmental measurements from iOS Health App"

* ^version = "0.1.0"
* ^status = #draft
* ^publisher = "HL7 International"
* ^contact.name = "Environmental Health Working Group"

* status MS
* category 1..1 MS
* category = http://terminology.hl7.org/CodeSystem/observation-category#environment
* subject 1..1 MS
* effectiveDateTime 1..1 MS
* device 0..1 MS
* method 0..1 MS
* note 0..* MS

Profile: NoiseExposureObservation
Parent: EnvironmentalObservation
Id: noise-exposure-observation
Title: "Noise Exposure Observation Profile"
Description: "Profile for noise exposure measurements from iOS Health App"

* code = $LOINC#28573-7 "Noise exposure time"
* component ^slicing.discriminator.type = #pattern
* component ^slicing.discriminator.path = "code"
* component ^slicing.rules = #open
* component ^short = "Noise exposure components"
* component ^definition = "Components of noise exposure measurement"

* component contains
    level 1..1 MS and
    duration 1..1 MS and
    peakLevel 0..1 MS and
    backgroundNoise 0..1 MS

* component[level].code = $LOINC#89020-2 "Environmental noise average"
* component[level].valueQuantity.system = $UCUM
* component[level].valueQuantity.code = #dB
* component[level].valueQuantity ^short = "Noise level in decibels"

* component[duration].code = $LOINC#89021-0 "Environmental noise duration"
* component[duration].valueQuantity.system = $UCUM
* component[duration].valueQuantity.code = #min
* component[duration].valueQuantity ^short = "Duration of exposure"

* component[peakLevel].code = $LOINC#89024-4 "Peak sound level"
* component[peakLevel].valueQuantity.system = $UCUM
* component[peakLevel].valueQuantity.code = #dB
* component[peakLevel].valueQuantity ^short = "Peak noise level"

* component[backgroundNoise].code = $LOINC#89025-1 "Background noise level"
* component[backgroundNoise].valueQuantity.system = $UCUM
* component[backgroundNoise].valueQuantity.code = #dB
* component[backgroundNoise].valueQuantity ^short = "Background noise level"

Profile: UVExposureObservation
Parent: EnvironmentalObservation
Id: uv-exposure-observation
Title: "UV Exposure Observation Profile"
Description: "Profile for UV exposure measurements from iOS Health App"

* code = $LOINC#28574-5 "UV exposure"
* component ^slicing.discriminator.type = #pattern
* component ^slicing.discriminator.path = "code"
* component ^slicing.rules = #open
* component ^short = "UV exposure components"
* component ^definition = "Components of UV exposure measurement"

* component contains
    index 1..1 MS and
    duration 1..1 MS and
    timeOfDay 0..1 MS and
    intensity 0..1 MS

* component[index].code = $LOINC#89022-8 "UV index"
* component[index].valueQuantity.system = $UCUM
* component[index].valueQuantity.code = #{index}
* component[index].valueQuantity ^short = "UV index value"

* component[duration].code = $LOINC#89023-6 "UV exposure duration"
* component[duration].valueQuantity.system = $UCUM
* component[duration].valueQuantity.code = #min
* component[duration].valueQuantity ^short = "Duration of UV exposure"

* component[timeOfDay].code = $LOINC#89026-9 "Time of exposure"
* component[timeOfDay].valueDateTime 1..1
* component[timeOfDay].valueDateTime ^short = "Time of UV exposure"

* component[intensity].code = $LOINC#89027-7 "UV intensity"
* component[intensity].valueQuantity.system = $UCUM
* component[intensity].valueQuantity.code = #W/m2
* component[intensity].valueQuantity ^short = "UV radiation intensity"

Extension: EnvironmentalContext
Id: environmental-context
Title: "Environmental Context Extension"
Description: "Additional context about environmental measurements"

* value[x] only CodeableConcept
* valueCodeableConcept from https://2rdoc.pt/fhir/ValueSet/environmental-context (required)



// ===== Conteúdo de: SocialInteractionProfile.fsh =====

Profile: SocialInteractionProfile
Parent: Observation
Id: social-interaction
Title: "Social Interaction Profile"
Description: "Profile for recording social interaction data from iOS Health App"

* ^version = "0.1.0"
* ^status = #active
* ^date = "2024-01-03"
* ^publisher = "FMUP HEADS2"

* status MS
* category 1..1 MS
* category = http://terminology.hl7.org/CodeSystem/observation-category#social-history
* code 1..1 MS
* code = $LOINC#96766-1 "Social interaction pattern"
* subject 1..1 MS
* effectiveDateTime 1..1 MS
* value[x] only CodeableConcept
* valueCodeableConcept from SocialInteractionTypeVS (required)

* component ^slicing.discriminator.type = #pattern
* component ^slicing.discriminator.path = "code"
* component ^slicing.rules = #open

* component contains
    duration 0..1 MS and
    quality 0..1 MS and
    medium 0..1 MS and
    participants 0..1 MS

* component[duration]
  * code = $LOINC#89597-9 "Social interaction duration"
  * valueQuantity only Quantity
  * valueQuantity.system = $UCUM
  * valueQuantity.code = #min

* component[quality]
  * code = $LOINC#89598-7 "Social interaction quality"
  * valueCodeableConcept from SocialInteractionQualityVS (required)

* component[medium]
  * code = $LOINC#89599-5 "Social interaction medium"
  * valueCodeableConcept from SocialInteractionMediumVS (required)

* component[participants]
  * code = $LOINC#89600-1 "Social interaction participants"
  * valueInteger only integer

* extension contains
    SocialContext named context 0..1 MS and
    SocialSupport named support 0..1 MS and
    SocialActivity named activity 0..* MS



// ===== Conteúdo de: StressLevelProfile.fsh =====

Profile: StressLevelProfile
Parent: Observation
Id: stress-level
Title: "Stress Level Profile"
Description: "Profile for recording stress level measurements from iOS Health App"

* ^version = "0.1.0"
* ^status = #active
* ^date = "2024-01-03"
* ^publisher = "FMUP HEADS2"

* status MS
* category 1..1 MS
* category = http://terminology.hl7.org/CodeSystem/observation-category#vital-signs
* code 1..1 MS
* code = $LOINC#89592-0 "Stress level score"
* subject 1..1 MS
* effectiveDateTime 1..1 MS
* value[x] only Quantity
* valueQuantity MS

* component ^slicing.discriminator.type = #pattern
* component ^slicing.discriminator.path = "code"
* component ^slicing.rules = #open

* component contains
    physiologicalStress 0..1 MS and
    psychologicalStress 0..1 MS and
    chronicity 0..1 MS and 
    impact 0..1 MS

* component[physiologicalStress]
  * code = $LOINC#89593-8 "Physiological stress"
  * valueQuantity only Quantity
  * valueQuantity.system = $UCUM
  * valueQuantity.code = #{score}

* component[psychologicalStress]
  * code = $LOINC#89594-6 "Psychological stress"
  * valueQuantity only Quantity
  * valueQuantity.system = $UCUM
  * valueQuantity.code = #{score}

* component[chronicity]
  * code = $LOINC#89595-3 "Stress chronicity"
  * valueCodeableConcept from StressChronicityVS (required)

* component[impact]
  * code = $LOINC#89596-1 "Stress impact"
  * valueCodeableConcept from StressImpactVS (required)

* extension contains
    MeasurementContext named context 0..1 MS and
    StressTriggers named triggers 0..* MS and 
    StressCoping named coping 0..* MS



// ===== Conteúdo de: NutritionProfiles.fsh =====

Alias: $SCT = http://snomed.info/sct
Alias: $LOINC = http://loinc.org
Alias: $UCUM = http://unitsofmeasure.org

Profile: NutritionIntakeObservation
Parent: Observation
Id: nutrition-intake-observation
Title: "Nutrition Intake Observation Profile"
Description: "Profile for nutrition intake data from iOS Health App and user input"

* ^version = "0.1.0"
* ^status = #draft
* ^publisher = "Ricardo Lourenço dos Santos"

* status MS
* category 1..1 MS
* category = http://terminology.hl7.org/CodeSystem/observation-category#nutrition
* subject 1..1 MS
* effectiveDateTime 1..1 MS
* code 1..1 MS
* method 0..1 MS

Profile: WaterIntakeObservation
Parent: NutritionIntakeObservation 
Id: water-intake-observation
Title: "Water Intake Observation Profile"
Description: "Profile for water intake measurements"

* ^version = "0.1.0"
* ^status = #draft
* ^publisher = "Ricardo Lourenço dos Santos"

* code = $LOINC#77111-4 "Water intake"
* valueQuantity only Quantity
* valueQuantity.system = $UCUM
* valueQuantity.code = #mL
* valueQuantity.unit = "milliliter"

Profile: CalorieIntakeObservation
Parent: NutritionIntakeObservation
Id: calorie-intake-observation
Title: "Calorie Intake Observation Profile"
Description: "Profile for caloric intake measurements"

* ^version = "0.1.0"
* ^status = #draft
* ^publisher = "Ricardo Lourenço dos Santos"

* code = $LOINC#9051-4 "Caloric intake total"
* valueQuantity only Quantity
* valueQuantity.system = $UCUM
* valueQuantity.code = #kcal
* valueQuantity.unit = "kilocalorie"

Profile: MacronutrientsObservation
Parent: NutritionIntakeObservation
Id: macronutrients-observation
Title: "Macronutrients Observation Profile"
Description: "Profile for macronutrient intake measurements"

* ^version = "0.1.0"
* ^status = #draft
* ^publisher = "Ricardo Lourenço dos Santos"

* code = $LOINC#LP199119-9 "Macronutrients panel"
* component ^slicing.discriminator.type = #pattern
* component ^slicing.discriminator.path = "code"
* component ^slicing.rules = #open

* component contains
    carbohydrates 0..1 MS and
    proteins 0..1 MS and
    fats 0..1 MS

* component[carbohydrates].code = $LOINC#LP35925-4 "Carbohydrates"
* component[carbohydrates].valueQuantity.system = $UCUM
* component[carbohydrates].valueQuantity.code = #g
* component[carbohydrates].valueQuantity.unit = "gram"

* component[proteins].code = $LOINC#LP35921-3 "Proteins" 
* component[proteins].valueQuantity.system = $UCUM
* component[proteins].valueQuantity.code = #g
* component[proteins].valueQuantity.unit = "gram"

* component[fats].code = $LOINC#LP35922-1 "Fats"
* component[fats].valueQuantity.system = $UCUM
* component[fats].valueQuantity.code = #g
* component[fats].valueQuantity.unit = "gram"



// ===== Conteúdo de: MultiJurisdictionalConsent.fsh =====

// ====== Perfil Multi-Jurisdicional de Consent ======

Profile: MultiJurisdictionalConsent
Parent: Consent
Id: multi-jurisdictional-consent
Title: "Multi-Jurisdictional Healthcare Consent"
Description: "Consent profile supporting GDPR, HIPAA, and LGPD compliance"

* status MS
* scope MS
* category MS
* patient 1..1 MS
* dateTime 1..1 MS

// Múltiplas políticas para diferentes jurisdições
* policy 1..* MS
* policy ^slicing.discriminator.type = #value
* policy ^slicing.discriminator.path = "authority"
* policy ^slicing.rules = #open

* policy contains
    gdpr 0..1 MS and
    hipaa 0..1 MS and
    lgpd 0..1 MS

* policy[gdpr].authority = "https://eur-lex.europa.eu/eli/reg/2016/679/oj"
* policy[gdpr].uri 1..1 MS

* policy[hipaa].authority = "https://www.hhs.gov/hipaa/index.html"  
* policy[hipaa].uri 1..1 MS

* policy[lgpd].authority = "http://www.planalto.gov.br/ccivil_03/_ato2015-2018/2018/lei/L13709compilado.htm"
* policy[lgpd].uri 1..1 MS

// Extensões de compliance
* extension contains
    RegulatoryBasis named regulatoryBasis 0..* MS and
    JurisdictionApplicability named jurisdiction 0..* MS and
    DataLocalization named dataLocalization 0..* MS

// Provisions com segurança
* provision MS
* provision.type MS
* provision.period MS
* provision.actor MS
* provision.action MS
* provision.securityLabel MS
* provision.purpose MS
* provision.dataPeriod MS



// ===== Conteúdo de: MindfulnessMessaging.fsh =====

Alias: $MsgEvents = https://2rdoc.pt/fhir/CodeSystem/mindfulness-message-events
Alias: $MsgTypes = http://terminology.hl7.org/CodeSystem/message-type

Profile: MindfulnessMessageDefinition
Parent: MessageDefinition
Id: mindfulness-message-definition
Title: "Mindfulness Message Definition" 
Description: "Definition for mindfulness session messages"

* url 1..1 MS
* date 1..1 MS
* status 1..1 MS
* event[x] 1..1 MS
* category 0..1 MS
* focus 1..* MS
* focus.min 1..1

Instance: StartSessionMessage
InstanceOf: MindfulnessMessageDefinition
Title: "Start Session Message"
Description: "Message definition for starting a mindfulness session"

* url = "https://2rdoc.pt/ig/ios-lifestyle-medicine/MessageDefinition/start-session"
* date = "2024-03-19"
* status = #active
* eventCoding = $MsgEvents#session-start "Session Start"
* category = #notification
* focus.code = #Observation
* focus.min = 1
* focus.profile = "https://2rdoc.pt/ig/ios-lifestyle-medicine/StructureDefinition/mindfulness-session"

Instance: EndSessionMessage  
InstanceOf: MindfulnessMessageDefinition
Title: "End Session Message"
Description: "Message definition for ending a mindfulness session"

* url = "https://2rdoc.pt/ig/ios-lifestyle-medicine/MessageDefinition/end-session"
* date = "2024-03-19"
* status = #active
* eventCoding = $MsgEvents#session-end "Session End"
* category = #notification
* focus.code = #Observation
* focus.min = 1
* focus.profile = "https://2rdoc.pt/ig/ios-lifestyle-medicine/StructureDefinition/mindfulness-session"



// ===== Conteúdo de: PractitionerNamingSystem.fsh =====

// ====== CodeSystem para Identificadores de Practitioners ======

CodeSystem: PractitionerIdentifierCS
Id: practitioner-identifier-cs
Title: "Practitioner Identifier Code System"
Description: "Sistema de códigos para identificação de practitioners"
* ^status = #active
* ^experimental = false
* ^caseSensitive = true
* #npi "National Provider Identifier" "US National Provider Identifier"
* #crm "Conselho Regional de Medicina" "Brazilian Medical Council Registration"
* #ssin "Social Security Identification Number" "Belgian SSIN"
* #rpps "Répertoire Partagé des Professionnels de Santé" "French Healthcare Professional Registry"

ValueSet: PractitionerIdentifierVS
Id: practitioner-identifier-vs
Title: "Practitioner Identifier Value Set"
Description: "Value set para identificadores de practitioners"
* ^status = #active
* ^experimental = false
* include codes from system PractitionerIdentifierCS



// ===== Conteúdo de: MindfulnessReports.fsh =====

Instance: MindfulnessProgressReport
InstanceOf: Measure
Usage: #definition
Title: "Mindfulness Practice Progress Report"
Description: "Example instance of MindfulnessProgressReport"
* status = #active
* experimental = false
* date = "2024-03-19"
* publisher = "Example Organization"
* description = "Measures progress in mindfulness practice over time"

* scoring = #continuous-variable
* type = #process
* riskAdjustment = "none"
* rateAggregation = "Average values over time period"

* group[0]
  * code = #practice-frequency
  * description = "Frequency of mindfulness practice"
  * population[0]
    * code = #denominator
    * criteria.language = #text/fhirpath
    * criteria.expression = "Observation.where(code.coding.code='711415009')"
  * stratifier[0]
    * code = #weekly
    * criteria.language = #text/fhirpath
    * criteria.expression = "Observation.effective.as(DateTime).truncate(@T).truncate(@W)"

* group[1]
  * code = #stress-reduction
  * description = "Stress level changes over time"
  * population[0]
    * code = #denominator
    * criteria.language = #text/fhirpath
    * criteria.expression = "Observation.where(component.code.coding.code='725854004')"
  * stratifier[0]
    * code = #trend
    * criteria.language = #text/fhirpath
    * criteria.expression = "component.where(code.coding.code='725854004').value.value"

RuleSet: ReportingMetrics
* group[+]
  * code = #session-duration
  * description = "Duration of practice sessions"
  * population[0]
    * code = #denominator
    * criteria.language = #text/fhirpath
    * criteria.expression = "Observation.component.where(code.coding.code='118682006')"
  * stratifier[0]
    * code = #average
    * criteria.language = #text/fhirpath
    * criteria.expression = "component.where(code.coding.code='118682006').value.value"

* group[+]
  * code = #mood-changes
  * description = "Mood state changes"
  * population[0]
    * code = #denominator
    * criteria.language = #text/fhirpath
    * criteria.expression = "Observation.component.where(code.coding.code='373931001')"



// ===== Conteúdo de: MindfulnessCapabilities.fsh =====

Instance: MindfulnessCapabilityStatement
InstanceOf: CapabilityStatement
Usage: #definition
Title: "Mindfulness Module Capabilities"
Description: "Capabilities supported by the mindfulness module implementation"

* status = #draft
* date = "2024-03-19"
* kind = #requirements
* fhirVersion = #4.0.1
* format[0] = #json
* format[1] = #xml

* rest[0]
  * mode = #server
  * documentation = "RESTful server capabilities for mindfulness data"
  
  * resource[0]
    * type = #Observation
    * documentation = "Supports mindfulness session observations"
    * profile = "https://2rdoc.pt/ig/ios-lifestyle-medicine/StructureDefinition/mindfulness-observation"
    * interaction[0]
      * code = #read
    * interaction[1]
      * code = #create
    * interaction[2]
      * code = #update
    * interaction[3]
      * code = #search-type
    * searchParam[0]
      * name = "patient"
      * type = #reference
      * documentation = "Search by patient reference"
    * searchParam[1]
      * name = "date"
      * type = #date
      * documentation = "Search by session date"
    * searchParam[2]
      * name = "code"
      * type = #token
      * documentation = "Search by observation type"
      
  * resource[1]
    * type = #Questionnaire
    * documentation = "Supports mindfulness questionnaires"
    * profile = "https://2rdoc.pt/ig/ios-lifestyle-medicine/StructureDefinition/mindfulness-questionnaire"
    * interaction[0]
      * code = #read
    * interaction[1]
      * code = #search-type
    * searchParam[0]
      * name = "title"
      * type = #string
      * documentation = "Search by questionnaire title"
      
  * resource[2]
    * type = #QuestionnaireResponse
    * documentation = "Supports mindfulness questionnaire responses"
    * profile = "https://2rdoc.pt/ig/ios-lifestyle-medicine/StructureDefinition/mindfulness-questionnaire-response"
    * interaction[0]
      * code = #create
    * interaction[1]
      * code = #read
    * interaction[2]
      * code = #search-type
    * searchParam[0]
      * name = "patient"
      * type = #reference
      * documentation = "Search by patient reference"
    * searchParam[1]
      * name = "authored"
      * type = #date
      * documentation = "Search by response date"



// ===== Conteúdo de: MindfulnessQuestionnaires.fsh =====

Instance: DailyMindfulnessQuestionnaire
InstanceOf: Questionnaire
Usage: #definition
Title: "Daily Mindfulness Questionnaire"
Description: "Questionnaire for capturing daily mindfulness practice and associated effects"

* url = "https://2rdoc.pt/ig/ios-lifestyle-medicine/Questionnaire/daily-mindfulness"
* status = #active
* title = "Daily Mindfulness Practice"
* subjectType = #Patient
* version = "1.0.0"
* name = "DailyMindfulnessQuestionnaire"
* date = "2024-03-19"

* item[0]
  * linkId = "mindful_session"
  * text = "Mindfulness Session"
  * type = #group
  * repeats = false

  * item[0]
    * linkId = "session_duration"
    * text = "Session duration (minutes)"
    * type = #integer
    * required = true
    * extension[0].url = "http://hl7.org/fhir/StructureDefinition/minValue"
    * extension[0].valueInteger = 1

  * item[1]
    * linkId = "practice_type"
    * text = "Practice type"
    * type = #choice
    * required = true
    * answerOption[0].valueString = "Meditation"
    * answerOption[1].valueString = "Breathing exercise"
    * answerOption[2].valueString = "Body scan"
    * answerOption[3].valueString = "Mindful walking"

* item[1]
  * linkId = "mood_assessment"
  * text = "Mood Assessment"
  * type = #group

  * item[0]
    * linkId = "current_mood"
    * text = "How is your mood now?"
    * type = #choice
    * required = true
    * answerValueSet = "https://2rdoc.pt/fhir/ValueSet/mood-vs"

  * item[1]
    * linkId = "mood_intensity"
    * text = "Mood intensity (1-5)"
    * type = #integer
    * required = true

* item[2]
  * linkId = "stress_assessment"
  * text = "Stress Assessment"
  * type = #group

  * item[0]
    * linkId = "stress_level"
    * text = "Stress level (0-10)"
    * type = #integer
    * required = true

  * item[1]
    * linkId = "stress_symptoms"
    * text = "Stress symptoms"
    * type = #choice
    * repeats = true
    * answerOption[0].valueString = "Muscle tension"
    * answerOption[1].valueString = "Anxiety"
    * answerOption[2].valueString = "Headache"
    * answerOption[3].valueString = "Fatigue"

* item[3]
  * linkId = "relaxation"
  * text = "Relaxation"
  * type = #group

  * item[0]
    * linkId = "relaxation_duration"
    * text = "Relaxation time (minutes)"
    * type = #integer
    * required = true

  * item[1]
    * linkId = "relaxation_technique"
    * text = "Technique used"
    * type = #choice
    * required = true
    * answerOption[0].valueString = "Deep breathing"
    * answerOption[1].valueString = "Progressive relaxation"
    * answerOption[2].valueString = "Visualization"
    * answerOption[3].valueString = "Mindful awareness"



// ===== Conteúdo de: NutritionQuestionnaires.fsh =====

Instance: DailyNutritionQuestionnaire
InstanceOf: Questionnaire
Usage: #definition
Title: "Daily Nutrition Intake Questionnaire"
Description: "Questionnaire for daily nutrition intake tracking"

* url = "https://2rdoc.pt/ig/ios-lifestyle-medicine/Questionnaire/daily-nutrition"
* version = "0.1.0"
* name = "DailyNutritionQuestionnaire"
* title = "Daily Nutrition Intake"
* status = #active
* experimental = false
* date = "2024-12-14"
* publisher = "Ricardo Lourenço dos Santos"

* item[0]
  * linkId = "water_intake"
  * text = "How much water did you drink today?"
  * type = #quantity
  * required = true
  * repeats = false
  * initial.valueQuantity = 0 'mL'

* item[1]
  * linkId = "meal_record"
  * text = "Meal Records"
  * type = #group
  * repeats = true

  * item[0]
    * linkId = "meal_time"
    * text = "Meal Time"
    * type = #dateTime
    * required = true

  * item[1]
    * linkId = "meal_type"
    * text = "Meal Type"
    * type = #choice
    * required = true
    * answerOption[0].valueString = "Breakfast"
    * answerOption[1].valueString = "Lunch"
    * answerOption[2].valueString = "Dinner"
    * answerOption[3].valueString = "Snack"

  * item[2]
    * linkId = "calories"
    * text = "Estimated Calories"
    * type = #integer
    * required = true

  * item[3]
    * linkId = "macronutrients"
    * text = "Macronutrients"
    * type = #group

    * item[0]
      * linkId = "carbs"
      * text = "Carbohydrates (g)"
      * type = #decimal
      * required = true

    * item[1]
      * linkId = "protein"
      * text = "Proteins (g)"
      * type = #decimal
      * required = true

    * item[2]
      * linkId = "fat"
      * text = "Fats (g)"
      * type = #decimal
      * required = true

* item[2]
  * linkId = "caffeine"
  * text = "Caffeine Intake"
  * type = #group

  * item[0]
    * linkId = "caffeine_amount"
    * text = "Caffeine amount (mg)"
    * type = #integer
    * required = false

  * item[1]
    * linkId = "caffeine_source"
    * text = "Caffeine source"
    * type = #choice
    * repeats = true
    * answerOption[0].valueString = "Coffee"
    * answerOption[1].valueString = "Tea"
    * answerOption[2].valueString = "Soft Drink"
    * answerOption[3].valueString = "Energy Drink"



// ===== Conteúdo de: ReproductiveQuestionnaire.fsh =====

Instance: ReproductiveHealthQuestionnaire
InstanceOf: Questionnaire
Usage: #definition
Title: "Reproductive Health Tracking Questionnaire"
Description: "Daily questionnaire for reproductive health tracking"
 
* status = #active
* url = "https://2rdoc.pt/ig/ios-lifestyle-medicine/Questionnaire/reproductive-health"
* name = "ReproductiveHealthQuestionnaire"
* title = "Reproductive Health Monitoring"
* date = "2024-03-19"
 
* item[0]
  * linkId = "menstrual_cycle"
  * text = "Menstrual Cycle"
  * type = #group
 
  * item[0]
    * linkId = "cycle_start"
    * text = "Cycle started today?"
    * type = #boolean
 
  * item[1]
    * linkId = "flow_intensity"
    * text = "Flow intensity"
    * type = #choice
    * enableWhen
      * question = "cycle_start"
      * operator = #=
      * answerBoolean = true
    * answerOption[0].valueString = "Light"
    * answerOption[1].valueString = "Moderate"
    * answerOption[2].valueString = "Heavy"
 
* item[1]
  * linkId = "symptoms"
  * text = "Symptoms"
  * type = #group
  * repeats = true
 
  * item[0]
    * linkId = "symptom_type"
    * text = "Symptom type"
    * type = #choice
    * answerValueSet = "https://2rdoc.pt/fhir/ValueSet/reproductive-symptoms"
 
  * item[1]
    * linkId = "symptom_severity"
    * text = "Intensity (0-10)"
    * type = #integer
    * extension[0]
      * url = "http://hl7.org/fhir/StructureDefinition/minValue"
      * valueInteger = 0
    * extension[1]
      * url = "http://hl7.org/fhir/StructureDefinition/maxValue"
      * valueInteger = 10
 
* item[2]
  * linkId = "mood_changes"
  * text = "Mood Changes"
  * type = #group

  * item[0]
    * linkId = "mood_type"
    * text = "Current mood"
    * type = #choice
    * answerValueSet = "https://2rdoc.pt/fhir/ValueSet/mood-types"

  * item[1]
    * linkId = "mood_severity"
    * text = "Intensity (0-10)"
    * type = #integer
    * extension[0]
      * url = "http://hl7.org/fhir/StructureDefinition/minValue"
      * valueInteger = 0
    * extension[1]
      * url = "http://hl7.org/fhir/StructureDefinition/maxValue"
      * valueInteger = 10



// ===== Conteúdo de: aliases.fsh =====

Alias: SCT = http://snomed.info/sct
Alias: LOINC = http://loinc.org
Alias: UCUM = http://unitsofmeasure.org



// ===== Conteúdo de: MindfulnessTerminology.fsh =====

CodeSystem: MindfulnessOutcomeCS
Id: mindfulness-outcome-cs
Title: "Mindfulness Outcomes"
Description: "Outcomes and effects of mindfulness practice"

* ^experimental = false
* ^caseSensitive = true
* #increasedAwareness "Increased Awareness" "Greater awareness of thoughts and sensations"
* #improvedFocus "Improved Focus" "Enhanced ability to concentrate"
* #stressReduction "Stress Reduction" "Decreased levels of stress and tension"
* #emotionalBalance "Emotional Balance" "Better emotional regulation"
* #improvedSleep "Improved Sleep" "Enhanced sleep quality"

ValueSet: MindfulnessOutcomeVS
Id: mindfulness-outcome-vs
Title: "Mindfulness Outcomes Value Set"
Description: "Value set for mindfulness practice outcomes"

* ^experimental = false
* include codes from system MindfulnessOutcomeCS
* include $SCT#365949003 "Finding of level of stress"
* include $SCT#373931001 "Mood finding"

CodeSystem: MindfulnessQualifierCS
Id: mindfulness-qualifier-cs
Title: "Mindfulness Practice Qualifiers"
Description: "Qualifiers for mindfulness practice characteristics"

* ^experimental = false
* ^caseSensitive = true
* #guided "Guided Practice" "Practice with guidance or instruction"
* #selfDirected "Self-Directed" "Independent practice"
* #group "Group Practice" "Practice in group setting"
* #individual "Individual Practice" "Solo practice session"

ValueSet: MindfulnessQualifierVS
Id: mindfulness-qualifier-vs
Title: "Mindfulness Practice Qualifiers Value Set"
Description: "Value set for mindfulness practice qualifiers"

* ^experimental = false
* include codes from system MindfulnessQualifierCS
* include $SCT#410534003 "Guided meditation"
* include $SCT#225386006 "Exercise therapy"

* ^copyright = "This value set includes content from SNOMED CT, which is copyright © 2002+ International Health Terminology Standards Development Organisation (IHTSDO)"



// ===== Conteúdo de: MindfulnessConfig.fsh =====

Extension: MindfulnessSessionDuration
Id: mindfulness-session-duration
Title: "Mindfulness Session Duration"
Description: "Default duration for mindfulness sessions in minutes"
* value[x] only integer

Extension: MindfulnessReminderTime
Id: mindfulness-reminder-time
Title: "Mindfulness Reminder Time"
Description: "Default time for daily reminders"
* value[x] only time

Extension: MindfulnessPreferredGuide
Id: mindfulness-preferred-guide
Title: "Mindfulness Preferred Guide"
Description: "Preferred guide for mindfulness sessions"
* value[x] only string

Extension: MindfulnessNotificationEnabled
Id: mindfulness-notification-enabled
Title: "Mindfulness Notification Enabled"
Description: "Whether notifications are enabled for mindfulness sessions"
* value[x] only boolean

Profile: MindfulnessConfiguration
Parent: Basic
Id: mindfulness-configuration
Title: "Mindfulness Configuration"
Description: "Configuration settings for mindfulness sessions"

* code 1..1 MS
* code = https://2rdoc.pt/fhir/CodeSystem/mindfulness-config-type#settings "Mindfulness Settings"

* extension contains
    MindfulnessSessionDuration named sessionDuration 1..1 MS and
    MindfulnessReminderTime named reminderTime 1..1 MS and
    MindfulnessPreferredGuide named preferredGuide 0..1 MS and
    MindfulnessNotificationEnabled named notificationEnabled 1..1 MS

Instance: DefaultMindfulnessConfig
InstanceOf: MindfulnessConfiguration
Title: "Default Mindfulness Configuration"
Description: "Default configuration settings for mindfulness sessions"

* code = https://2rdoc.pt/fhir/CodeSystem/mindfulness-config-type#settings "Mindfulness Settings"
* extension[sessionDuration].valueInteger = 15
* extension[reminderTime].valueTime = "08:00:00"
* extension[preferredGuide].valueString = "Jane Smith"
* extension[notificationEnabled].valueBoolean = true



// ===== Conteúdo de: MindfulnessAuditConfig.fsh =====

Extension: MindfulnessAuditLevel
Id: mindfulness-audit-level
Title: "Mindfulness Audit Level"
Description: "Level of detail for audit records"
* value[x] only code
* valueCode from https://2rdoc.pt/fhir/ValueSet/audit-levels (required)

Extension: MindfulnessAuditRetention
Id: mindfulness-audit-retention
Title: "Mindfulness Audit Retention"
Description: "Period to retain audit records"
* value[x] only Duration

Extension: MindfulnessAuditFormat
Id: mindfulness-audit-format
Title: "Mindfulness Audit Format"
Description: "Format for audit records"
* value[x] only code
* valueCode from https://2rdoc.pt/fhir/ValueSet/audit-formats (required)

Profile: MindfulnessAuditConfig
Parent: Basic
Id: mindfulness-audit-config
Title: "Mindfulness Audit Configuration"
Description: "Configuration for mindfulness session auditing"

* code 1..1 MS
* code = https://2rdoc.pt/fhir/CodeSystem/mindfulness-config-type#audit "Audit Configuration"

* extension contains
    MindfulnessAuditLevel named auditLevel 1..1 MS and
    MindfulnessAuditRetention named auditRetention 1..1 MS and
    MindfulnessAuditFormat named auditFormat 1..1 MS

Instance: DefaultAuditConfig
InstanceOf: MindfulnessAuditConfig
Title: "Default Audit Configuration"
Description: "Default configuration for mindfulness session auditing"

* code = https://2rdoc.pt/fhir/CodeSystem/mindfulness-config-type#audit "Audit Configuration"
* extension[auditLevel].valueCode = #detailed
* extension[auditRetention].valueDuration = 90 'days'
* extension[auditFormat].valueCode = #fhir



// ===== Conteúdo de: MindfulnessSecurity.fsh =====

// ====== Mindfulness Security and Consent Resources ======

Instance: MindfulnessSecurityDefinition
InstanceOf: Consent
Usage: #example
* status = #active
* scope = $consentscope#patient-privacy "Privacy Consent"
* category[0] = $loinc#59284-0 "Patient Consent"
* patient = Reference(Patient/PatientMindfulness)
* dateTime = "2024-01-01"
* organization = Reference(Organization/Org2RDoc)
* policy[0].authority = "http://terminology.hl7.org/CodeSystem/consentpolicycodes"
* policy[0].uri = "http://terminology.hl7.org/CodeSystem/consentpolicycodes"
* provision.type = #permit
* provision.period.start = "2024-01-01"
* provision.period.end = "2025-12-31"
* provision.actor[0].role = $v3-RoleCode#TREAT "treatment"
* provision.actor[0].reference.identifier.system = "http://terminology.hl7.org/CodeSystem/practitioner-identifier"
* provision.actor[0].reference.identifier.value = "1234567890"
* provision.securityLabel[0] = $v3-Confidentiality#N "normal"
* provision.purpose[0] = $v3-ActReason#TREAT "treatment"
* provision.dataPeriod.start = "2024-01-01"
* provision.dataPeriod.end = "2025-12-31"

Instance: MindfulnessAccessPolicy
InstanceOf: Consent
Usage: #example
* status = #active
* scope = $consentscope#patient-privacy "Privacy Consent"
* category[0] = $loinc#59284-0 "Patient Consent"
* patient = Reference(Patient/PatientMindfulness)
* dateTime = "2024-01-01"
* organization = Reference(Organization/Org2RDoc)

// Políticas multi-jurisdicionais - começando do índice 0
* policy[0].authority = "http://terminology.hl7.org/CodeSystem/consentpolicycodes"
* policy[0].uri = "http://terminology.hl7.org/CodeSystem/consentpolicycodes"

// GDPR - Europa
* policy[1].authority = "https://eur-lex.europa.eu/eli/reg/2016/679/oj"
* policy[1].uri = "https://health.ec.europa.eu/ehealth-digital-health-and-care/european-health-data-space-regulation-ehds_en"

// HIPAA - Estados Unidos
* policy[2].authority = "https://www.hhs.gov/hipaa/index.html"
* policy[2].uri = "https://www.hhs.gov/hipaa/for-professionals/privacy/laws-regulations/index.html"

// LGPD - Brasil
* policy[3].authority = "http://www.planalto.gov.br/ccivil_03/_ato2015-2018/2018/lei/L13709compilado.htm"
* policy[3].uri = "https://www.gov.br/anpd/pt-br/"

* provision.type = #permit
* provision.period.start = "2024-01-01"
* provision.period.end = "2025-12-31"
* provision.actor[0].role = $v3-RoleCode#TREAT "treatment"
* provision.actor[0].reference.identifier.system = "http://terminology.hl7.org/CodeSystem/practitioner-identifier"
* provision.actor[0].reference.identifier.value = "1234567890"
* provision.action[0] = $consentaction#access "Access"
* provision.action[1] = $consentaction#use "Use"
* provision.purpose[0] = $v3-ActReason#TREAT "treatment"
* provision.purpose[1] = $v3-ActReason#HPAYMT "healthcare payment"
* provision.purpose[2] = $v3-ActReason#HOPERAT "healthcare operations"
* provision.dataPeriod.start = "2024-01-01"
* provision.dataPeriod.end = "2025-12-31"

// ====== Aliases para simplificar referências ======
Alias: $consentscope = http://terminology.hl7.org/CodeSystem/consentscope
Alias: $loinc = http://loinc.org
Alias: $v3-RoleCode = http://terminology.hl7.org/CodeSystem/v3-RoleCode
Alias: $v3-Confidentiality = http://terminology.hl7.org/CodeSystem/v3-Confidentiality
Alias: $v3-ActReason = http://terminology.hl7.org/CodeSystem/v3-ActReason
Alias: $consentaction = http://terminology.hl7.org/CodeSystem/consentaction



// ===== Conteúdo de: MindfulnessResources.fsh =====

CodeSystem: MindfulnessTypeCS
Id: mindfulness-type-cs
Title: "Mindfulness Practice Types"
Description: "Types of mindfulness practices and techniques"
* ^experimental = false
* ^caseSensitive = true
* #meditation "Meditation" "Focused meditation practice"
* #breathing "Breathing Exercise" "Conscious breathing techniques"
* #bodyScan "Body Scan" "Progressive body awareness practice"
* #walking "Mindful Walking" "Walking meditation practice"
* #movement "Mindful Movement" "Conscious movement practice"

CodeSystem: EnvironmentTypeCS
Id: environment-type-cs
Title: "Practice Environment Types"
Description: "Types of environments for mindfulness practice"
* ^experimental = false
* ^caseSensitive = true
* #indoor "Indoor" "Indoor environment"
* #outdoor "Outdoor" "Outdoor environment"
* #quiet "Quiet Space" "Quiet or silent environment"
* #group "Group Setting" "Group practice environment"

ValueSet: MindfulnessTypeVS
Id: mindfulness-type-vs
Title: "Mindfulness Practice Types Value Set"
Description: "Value set of mindfulness practice types"
* ^experimental = false
* include codes from system MindfulnessTypeCS

ValueSet: EnvironmentTypeVS
Id: environment-type-vs
Title: "Practice Environment Types Value Set"
Description: "Value set of practice environment types"
* ^experimental = false
* include codes from system EnvironmentTypeCS

Instance: MindfulnessSettingCS
InstanceOf: CodeSystem
Usage: #definition
* url = "https://2rdoc.pt/ig/ios-lifestyle-medicine/CodeSystem/mindfulness-setting"
* version = "1.0.0"
* name = "MindfulnessSettingCS"
* title = "Mindfulness Setting CodeSystem"
* status = #active
* experimental = false
* caseSensitive = true
* content = #complete
* count = 5
* concept[+].code = #home
* concept[=].display = "Home Practice"
* concept[+].code = #clinic
* concept[=].display = "Clinical Setting"
* concept[+].code = #group
* concept[=].display = "Group Setting"
* concept[+].code = #retreat
* concept[=].display = "Retreat Setting"
* concept[+].code = #workplace
* concept[=].display = "Workplace Setting"



// ===== Conteúdo de: MindfulnessNarrative.fsh =====

RuleSet: MindfulnessObservationNarrative
* text.status = #generated
* text.div = "<div xmlns=\"http://www.w3.org/1999/xhtml\">
    <p><b>Generated Narrative</b></p>
    <p><b>Session Type:</b> Mindfulness Practice Session</p>
    <p><b>Date:</b> {effectiveDateTime}</p>
    <p><b>Duration:</b> {component[sessionDuration].value} minutes</p>
    <p><b>Stress Level:</b> {component[stressLevel].value} / 10</p>
    <p><b>Mood:</b> {component[moodState].value}</p>
    <p><b>Technique:</b> {component[relaxationResponse].value}</p>
    <p><b>Location:</b> {extension[mindfulness-context].extension[location].value}</p>
  </div>"

RuleSet: MindfulnessQuestionnaireNarrative
* text.status = #generated
* text.div = "<div xmlns=\"http://www.w3.org/1999/xhtml\">
    <p><b>Generated Narrative</b></p>
    <p><b>Title:</b> {title}</p>
    <p><b>Status:</b> {status}</p>
    <h3>Sections</h3>
    <ul>
      <li>Mindfulness Session</li>
      <li>Mood Assessment</li>
      <li>Stress Assessment</li>
      <li>Relaxation</li>
    </ul>
  </div>"

RuleSet: MindfulnessResponseNarrative
* text.status = #generated
* text.div = "<div xmlns=\"http://www.w3.org/1999/xhtml\">
    <p><b>Generated Narrative</b></p>
    <p><b>Date:</b> {authored}</p>
    <p><b>Session Duration:</b> {item[session_duration].answer.value} minutes</p>
    <p><b>Practice Type:</b> {item[practice_type].answer.value}</p>
    <p><b>Mood:</b> {item[current_mood].answer.value}</p>
    <p><b>Stress Level:</b> {item[stress_level].answer.value} / 10</p>
    <p><b>Relaxation Technique:</b> {item[relaxation_technique].answer.value}</p>
  </div>"

RuleSet: MindfulnessConfigNarrative
* text.status = #generated
* text.div = "<div xmlns=\"http://www.w3.org/1999/xhtml\">
    <p><b>Generated Narrative</b></p>
    <p><b>Default Duration:</b> {extension[defaultDuration].value} minutes</p>
    <p><b>Reminders:</b> {extension[reminderSettings].value}</p>
    <p><b>Data Sync:</b> {extension[dataSync].value}</p>
  </div>"



// ===== Conteúdo de: StressInvariants.fsh =====

Invariant: stress-level-range
Description: "Stress level score must be between 0 and 10"
Expression: "valueQuantity.exists() implies (valueQuantity.value >= 0 and valueQuantity.value <= 10)"
Severity: #error

Invariant: stress-component-consistency
Description: "Physiological and psychological stress scores must be consistent with overall score"
Expression: "component.where(code.coding.code='89593-8').value.exists() and component.where(code.coding.code='89594-6').value.exists() implies (component.where(code.coding.code='89593-8').value + component.where(code.coding.code='89594-6').value) div 2 = valueQuantity"
Severity: #warning



// ===== Conteúdo de: SocialInteractionInvariants.fsh =====

Invariant: social-interaction-duration
Description: "Social interaction duration must be positive"
Expression: "component.where(code.coding.code='89597-9').value.exists() implies component.where(code.coding.code='89597-9').value > 0"
Severity: #error

Invariant: social-interaction-participants
Description: "Number of participants must be at least 2 for social interaction"
Expression: "component.where(code.coding.code='89600-1').value.exists() implies component.where(code.coding.code='89600-1').value >= 2"
Severity: #error



// ===== Conteúdo de: MindfulnessInvariants.fsh =====

Invariant: mindfulness-session-duration
Description: "Mindfulness session duration must be between 1 and 180 minutes"
Expression: "component.where(code.coding.system='http://snomed.info/sct' and code.coding.code='118682006').value.ofType(Quantity).value.exists() implies (component.where(code.coding.system='http://snomed.info/sct' and code.coding.code='118682006').value.ofType(Quantity).value >= 1 and component.where(code.coding.system='http://snomed.info/sct' and code.coding.code='118682006').value.ofType(Quantity).value <= 180)"
Severity: #error

Invariant: mindfulness-stress-level
Description: "Stress level must be between 0 and 10"
Expression: "component.where(code.coding.system='http://snomed.info/sct' and code.coding.code='725854004').value.ofType(Integer).exists() implies (component.where(code.coding.system='http://snomed.info/sct' and code.coding.code='725854004').value.ofType(Integer) >= 0 and component.where(code.coding.system='http://snomed.info/sct' and code.coding.code='725854004').value.ofType(Integer) <= 10)"
Severity: #error

Invariant: mindfulness-mood-required
Description: "Mood assessment must include a mood state and intensity"
Expression: "component.where(code.coding.system='http://snomed.info/sct' and code.coding.code='373931001').exists() implies component.where(code.coding.system='http://snomed.info/sct' and code.coding.code='373931001').value.exists()"
Severity: #warning

Invariant: mindfulness-context-complete
Description: "Mindfulness context should include location and environment"
Expression: "extension.where(url='https://2rdoc.pt/ig/ios-lifestyle-medicine/StructureDefinition/mindfulness-context').exists() implies (extension.where(url='https://2rdoc.pt/ig/ios-lifestyle-medicine/StructureDefinition/mindfulness-context').extension.where(url='location').exists() and extension.where(url='https://2rdoc.pt/ig/ios-lifestyle-medicine/StructureDefinition/mindfulness-context').extension.where(url='environment').exists())"
Severity: #warning

Invariant: sequential-measurements
Description: "Sequential measurements must have increasing effectiveDateTime"
Expression: "component.where(code.coding.system='http://snomed.info/sct' and code.coding.code='118682006').exists() implies (effectiveDateTime > previous().effectiveDateTime)"
Severity: #warning



// ===== Conteúdo de: MindfulnessOperations.fsh =====

Profile: MindfulnessOperation
Parent: OperationDefinition 
Id: mindfulness-operation
Title: "Mindfulness Operation"
Description: "Base definition for mindfulness operations"

* status 1..1
* kind 1..1
* name 1..1
* code 1..1
* resource 1..1
* system 1..1
* type 1..1
* instance 1..1
* parameter 0..*
* parameter.name 1..1

Instance: StartSessionOperation
InstanceOf: MindfulnessOperation
Title: "Start Session Operation"
Description: "Operation to start a new mindfulness session"

* status = #active
* kind = #operation
* name = "start-session"
* code = #start
* resource = #Observation
* system = false
* type = true
* instance = false
* parameter[+]
  * name = #duration
  * use = #in
  * min = 1
  * max = "1" 
  * type = #integer
  * documentation = "Duration in minutes"

Instance: EndSessionOperation
InstanceOf: MindfulnessOperation
Title: "End Session Operation"
Description: "Operation to end an ongoing mindfulness session"

* status = #active
* kind = #operation
* name = "end-session"
* code = #end
* resource = #Observation
* system = false
* type = true
* instance = true
* parameter[+]
  * name = #session
  * use = #in
  * min = 1
  * max = "1"
  * type = #string
  * documentation = "ID of the session to end"



// ===== Conteúdo de: VitalSignsExtensions.fsh =====

Extension: MeasurementContext
Id: measurement-context
Title: "Measurement Context Extension"
* ^experimental = false
Description: "Additional context about the vital sign measurement"
* value[x] only CodeableConcept
* valueCodeableConcept from MeasurementContextVS (required)

ValueSet: MeasurementContextVitalSigns
Id: measurement-context-vital-signs
Description: "Value set for measurement context in vital signs observations"Title: "Measurement Context Value Set"
* $SCT#255214003 "At rest"
* $SCT#309604004 "During exercise"
* $SCT#309605003 "Post exercise"
* $SCT#248626006 "During sleep"



// ===== Conteúdo de: NutritionExtensions.fsh =====

Extension: NutritionDataSource
Id: nutrition-data-source
Title: "Nutrition Data Source Extension"
Description: "Indicates the source of nutrition data"

* ^version = "0.1.0"
* ^status = #draft
* ^experimental = false
* ^date = "2024-12-14"
* ^publisher = "Ricardo Lourenço dos Santos"
* ^context[0].type = #element
* ^context[0].expression = "Observation"

* value[x] only CodeableConcept
* valueCodeableConcept from NutritionDataSourceVS (required)

ValueSet: NutritionDataSourceVS
Id: nutrition-data-source-vs
Title: "Nutrition Data Source Value Set"
Description: "Value set for nutrition data sources"

* ^version = "0.1.0"
* ^status = #draft
* ^experimental = false
* ^date = "2024-12-14"
* ^publisher = "Ricardo Lourenço dos Santos"

* codes from system NutritionDataSourceCS

CodeSystem: NutritionDataSourceCS
Id: nutrition-data-source-cs
Title: "Nutrition Data Source Code System"
Description: "Code system for nutrition data sources"

* ^version = "0.1.0"
* ^status = #draft
* ^experimental = false
* ^date = "2024-12-14"
* ^publisher = "Ricardo Lourenço dos Santos"
* ^caseSensitive = true

* #manual "Manual Entry" "Data entered manually by user"
* #app "App Integration" "Data from integrated third-party apps"
* #device "Connected Device" "Data from connected nutrition tracking devices"
* #questionnaire "Questionnaire Response" "Data collected through questionnaires"



// ===== Conteúdo de: AdvancedVitalSignsExtensions.fsh =====

Alias: $UCUM = http://unitsofmeasure.org

Extension: PhysiologicalStressIndex
Id: physiological-stress-index
Title: "Physiological Stress Index Extension"
Description: "Index representing overall physiological stress based on multiple parameters"

* ^version = "0.1.0"
* ^status = #draft
* ^context[+].type = #element
* ^context[=].expression = "Observation"

* value[x] only Quantity
* valueQuantity.system = $UCUM
* valueQuantity.code = #{index}
* valueQuantity ^short = "Physiological stress index value"
* valueQuantity ^definition = "Normalized index value representing overall physiological stress"

Extension: HomeostasisIndex
Id: homeostasis-index
Title: "Homeostasis Index Extension"
Description: "Composite measure of physiological balance and adaptation"

* ^version = "0.1.0"
* ^status = #draft
* ^context[+].type = #element
* ^context[=].expression = "Observation"

* value[x] only Quantity
* valueQuantity.system = $UCUM
* valueQuantity.code = #{ratio}
* valueQuantity ^short = "Homeostasis index value"
* valueQuantity ^definition = "Normalized ratio representing physiological balance"

Extension: RecoveryEfficiency
Id: recovery-efficiency
Title: "Recovery Efficiency Extension"
Description: "Measure of how efficiently the body recovers from stress or exertion"

* ^version = "0.1.0"
* ^status = #draft
* ^context[+].type = #element
* ^context[=].expression = "Observation"

* value[x] only Quantity
* valueQuantity.system = $UCUM
* valueQuantity.code = #%
* valueQuantity ^short = "Recovery efficiency percentage"
* valueQuantity ^definition = "Percentage indicating recovery efficiency"

Extension: AllostaticLoad
Id: allostatic-load
Title: "Allostatic Load Extension"
Description: "Measure of cumulative physiological burden over time"

* ^version = "0.1.0"
* ^status = #draft
* ^context[+].type = #element
* ^context[=].expression = "Observation"

* value[x] only Quantity
* valueQuantity.system = $UCUM
* valueQuantity.code = #{score}
* valueQuantity ^short = "Allostatic load score"
* valueQuantity ^definition = "Score representing cumulative physiological burden"

Extension: CircadianPhase
Id: circadian-phase
Title: "Circadian Phase Extension"
Description: "Indicator of position in circadian rhythm cycle"

* ^version = "0.1.0"
* ^status = #draft
* ^context[+].type = #element
* ^context[=].expression = "Observation"

* value[x] only CodeableConcept
* valueCodeableConcept from CircadianPhaseVS (required)

ValueSet: CircadianPhaseVS
Id: circadian-phase-vs
Title: "Circadian Phase Value Set"
Description: "Value set for circadian rhythm phases"

* ^experimental = true
* codes from system CircadianPhaseCS

CodeSystem: CircadianPhaseCS
Id: circadian-phase-cs
Title: "Circadian Phase Code System"
Description: "Code system for circadian rhythm phases"

* ^experimental = true
* ^caseSensitive = true

* #early-morning "Early Morning Phase" "Period shortly after awakening"
* #mid-morning "Mid Morning Phase" "Mid-morning period"
* #afternoon "Afternoon Phase" "Afternoon period"
* #evening "Evening Phase" "Evening period"
* #night "Night Phase" "Nighttime period"
* #deep-night "Deep Night Phase" "Deep night period"

Extension: MeasurementQuality
Id: measurement-quality
Title: "Measurement Quality Extension"
Description: "Indicator of the quality and reliability of the measurement"

* ^version = "0.1.0"
* ^status = #draft
* ^context[+].type = #element
* ^context[=].expression = "Observation"

* value[x] only CodeableConcept
* valueCodeableConcept from MeasurementQualityVS (required)

ValueSet: MeasurementQualityVS
Id: measurement-quality-vs
Title: "Measurement Quality Value Set"
Description: "Value set for measurement quality indicators"

* ^experimental = true
* codes from system MeasurementQualityCS

CodeSystem: MeasurementQualityCS
Id: measurement-quality-cs
Title: "Measurement Quality Code System"
Description: "Code system for measurement quality indicators"

* ^experimental = true
* ^caseSensitive = true

* #excellent "Excellent Quality" "High quality measurement with minimal noise"
* #good "Good Quality" "Good quality measurement with acceptable noise"
* #fair "Fair Quality" "Fair quality measurement with some interference"
* #poor "Poor Quality" "Poor quality measurement with significant interference"
* #unreliable "Unreliable" "Unreliable measurement requiring verification"



// ===== Conteúdo de: StressExtensions.fsh =====

Extension: StressTriggers
Id: stress-triggers
Title: "Stress Triggers Extension"
* ^experimental = false
Description: "Extension for recording identified stress triggers"
* value[x] only CodeableConcept
* valueCodeableConcept from StressTriggersVS (required)

Extension: StressCoping
Id: stress-coping
Title: "Stress Coping Extension"
* ^experimental = false
Description: "Extension for recording stress coping mechanisms"
* value[x] only CodeableConcept
* valueCodeableConcept from StressCopingVS (required)

ValueSet: StressTriggersVS
Id: stress-triggers-vs
Title: "Stress Triggers Value Set"
* ^experimental = false
Description: "Value set for common stress triggers"
* codes from system StressTriggersCS

ValueSet: StressCopingVS
Id: stress-coping-vs
Title: "Stress Coping Value Set"
* ^experimental = false
Description: "Value set for stress coping mechanisms"
* codes from system StressCopingCS

CodeSystem: StressTriggersCS
Id: stress-triggers-cs
Title: "Stress Triggers Code System"
* ^experimental = false
Description: "Code system for common stress triggers"
* #work "Work-related" "Stress from work or professional activities"
* #financial "Financial" "Financial-related stress"
* #relationships "Relationships" "Stress from personal relationships"
* #health "Health" "Health-related concerns"
* #environment "Environmental" "Environmental factors"
* #time "Time Management" "Time pressure and deadlines"
* #change "Life Changes" "Major life changes or transitions"

CodeSystem: StressCopingCS
Id: stress-coping-cs
Title: "Stress Coping Code System"
* ^experimental = false
Description: "Code system for stress coping mechanisms"
* #exercise "Physical Exercise" "Using exercise to manage stress"
* #meditation "Meditation" "Meditation and mindfulness practices"
* #social "Social Support" "Seeking social support"
* #professional "Professional Help" "Seeking professional assistance"
* #relaxation "Relaxation" "Relaxation techniques"
* #creative "Creative Activities" "Engaging in creative activities"
* #nature "Nature" "Spending time in nature"



// ===== Conteúdo de: EnvironmentalExtensions.fsh =====

Extension: ExposureLocation
Id: exposure-location
Title: "Exposure Location Extension"
Description: "Extension for recording location of environmental exposure measurement"

* ^version = "0.1.0"
* ^status = #draft
* ^context[+].type = #element
* ^context[=].expression = "Observation"

* value[x] only CodeableConcept
* valueCodeableConcept from ExposureLocationVS (required)
* valueCodeableConcept ^short = "Location type of exposure"
* valueCodeableConcept ^definition = "Categorizes the type of location where environmental exposure occurred"

Extension: ExposureConditions
Id: exposure-conditions
Title: "Exposure Conditions Extension"
Description: "Additional conditions during environmental exposure measurement"

* ^version = "0.1.0"
* ^status = #draft
* ^context[+].type = #element
* ^context[=].expression = "Observation"

* value[x] only CodeableConcept
* valueCodeableConcept from ExposureConditionsVS (required)
* valueCodeableConcept ^short = "Conditions during exposure"

ValueSet: ExposureLocationVS
Id: exposure-location-vs
Title: "Exposure Location Value Set"
Description: "Value set for environmental exposure locations"

* ^version = "0.1.0"
* ^status = #draft
* ^experimental = true
* codes from system ExposureLocationCS

ValueSet: ExposureConditionsVS
Id: exposure-conditions-vs
Title: "Exposure Conditions Value Set"
Description: "Value set for environmental exposure conditions"

* ^version = "0.1.0"
* ^status = #draft
* ^experimental = true
* codes from system ExposureConditionsCS

CodeSystem: ExposureLocationCS
Id: exposure-location-cs
Title: "Exposure Location Code System"
Description: "Code system for environmental exposure locations"

* ^version = "0.1.0"
* ^status = #draft
* ^caseSensitive = true
* ^experimental = true

* #indoor "Indoor environment" "Environment within buildings or enclosed spaces"
* #outdoor "Outdoor environment" "Open-air environment"
* #workplace "Workplace" "Professional or occupational environment"
* #transit "In transit" "While in transportation or commuting"
* #recreational "Recreational area" "Leisure or sports facilities"
* #urban "Urban area" "City or densely populated area"
* #rural "Rural area" "Countryside or sparsely populated area"

CodeSystem: ExposureConditionsCS
Id: exposure-conditions-cs
Title: "Exposure Conditions Code System"
Description: "Code system for conditions during environmental exposure"

* ^version = "0.1.0"
* ^status = #draft
* ^caseSensitive = true
* ^experimental = true

* #normal "Normal conditions" "Standard environmental conditions"
* #extreme "Extreme conditions" "Unusual or severe environmental conditions"
* #controlled "Controlled environment" "Environment with controlled conditions"
* #variable "Variable conditions" "Changing environmental conditions"



// ===== Conteúdo de: BodyMetricsExtensions.fsh =====

Alias: $SCT = http://snomed.info/sct

Extension: MeasurementConditions
Id: measurement-conditions
Title: "Measurement Conditions Extension"
* ^experimental = false
Description: "Records the conditions under which body measurements were taken"

* ^version = "0.1.0"
* ^status = #draft
* ^context[0].type = #element
* ^context[0].expression = "Observation"

* value[x] only CodeableConcept
* valueCodeableConcept from MeasurementConditionsVS (required)

Extension: MeasurementDevice
Id: measurement-device-type
Title: "Measurement Device Type Extension"
* ^experimental = false
Description: "Specifies the type of device used for body measurements"

* ^version = "0.1.0"
* ^status = #draft
* ^context[0].type = #element
* ^context[0].expression = "Observation"

* value[x] only CodeableConcept
* valueCodeableConcept from MeasurementDeviceTypeVS (required)

ValueSet: MeasurementConditionsVS
Id: measurement-conditions-vs
Title: "Measurement Conditions Value Set"
* ^experimental = false
Description: "Standard conditions under which measurements are taken"

* ^version = "0.1.0"
* ^status = #draft

* $SCT#307818003 "Pre-breakfast"
* $SCT#307819006 "Post-exercise"
* $SCT#307820000 "Wearing light clothing"
* $SCT#255203001 "First thing in morning"
* $SCT#255214005 "After void"
* $SCT#309604004 "During rest"

ValueSet: MeasurementDeviceTypeVS
Id: measurement-device-type-vs
Title: "Measurement Device Type Value Set"
* ^experimental = false
Description: "Types of devices used for health and body measurements"

* ^version = "0.1.0"
* ^status = #draft

* $SCT#469576000 "Smart watch"
* $SCT#706767009 "Patient data recorder"
* $SCT#131009002 "Height measuring device"
* $SCT#706889009 "Blood pressure monitor"
* $SCT#444699000 "Tape measure"
* $SCT#44056008  "Digital scale"

Instance: WeightWithConditions
InstanceOf: WeightObservation
Usage: #example
Description: "Weight with conditions observation example"
Title: "Weight Measurement with Conditions Example"

* status = #final
* category = http://terminology.hl7.org/CodeSystem/observation-category#vital-signs
* code = $LOINC#29463-7 "Body weight"
* subject = Reference(Patient/example)
* effectiveDateTime = "2024-03-19T08:00:00Z"
* valueQuantity = 70.5 'kg'

* extension[measurement-conditions].url = "https://2rdoc.pt/ig/ios-lifestyle-medicine/StructureDefinition/measurement-conditions"
* extension[measurement-conditions].valueCodeableConcept = $SCT#307818003 "Pre-breakfast"

* extension[measurement-device-type].url = "https://2rdoc.pt/ig/ios-lifestyle-medicine/StructureDefinition/measurement-device-type"
* extension[measurement-device-type].valueCodeableConcept = $SCT#469576000 "Smart scale device"



// ===== Conteúdo de: SleepQuality.fsh =====

Extension: SleepQuality
Id: sleep-quality
Title: "Sleep Quality Extension"
* ^experimental = false
Description: "Extension for recording subjective sleep quality"
* value[x] only CodeableConcept
* valueCodeableConcept from SleepQualityExtendedVS (required)
 
ValueSet: SleepQualityExtendedVS
Id: sleep-quality-extended-vs
Description: "Extended value set for sleep quality assessment"Title: "Sleep Quality Value Set"
* $SCT#248220008 "Very good quality sleep"
* $SCT#248221007 "Good quality sleep"
* $SCT#248222000 "Poor quality sleep"
* $SCT#248223005 "Very poor quality sleep"



// ===== Conteúdo de: MindfulnessExtensions.fsh =====

Extension: MindfulnessContext
Id: mindfulness-context
Title: "Mindfulness Session Context"
Description: "Additional context about the mindfulness practice session"

* ^url = "https://2rdoc.pt/ig/ios-lifestyle-medicine/StructureDefinition/mindfulness-context"
* ^version = "1.0.0"
* ^status = #draft
* ^date = "2024-03-19"
* ^publisher = "Example Organization"

* extension contains
    location 0..1 and
    environment 0..1 and
    guidance 0..1

* extension[location].value[x] only string
* extension[location].valueString 1..1
* extension[location] ^short = "Physical location of practice"
* extension[location] ^definition = "The physical location where the mindfulness practice took place"

* extension[environment].value[x] only CodeableConcept
* extension[environment].valueCodeableConcept from https://2rdoc.pt/fhir/ValueSet/environment-type (required)
* extension[environment] ^short = "Environmental conditions"
* extension[environment] ^definition = "The environmental conditions during the practice session"

* extension[guidance].value[x] only boolean
* extension[guidance].valueBoolean 1..1
* extension[guidance] ^short = "Whether guidance was used"
* extension[guidance] ^definition = "Indicates if the session was guided or self-directed"



// ===== Conteúdo de: SocialInteractionExtensions.fsh =====

Extension: SocialContext
Id: social-context
Title: "Social Context Extension"
* ^experimental = false
Description: "Extension for recording the context of social interaction"
* value[x] only CodeableConcept
* valueCodeableConcept from SocialContextVS (required)

Extension: SocialSupport
Id: social-support
Title: "Social Support Extension"
* ^experimental = false
Description: "Extension for recording perceived social support"
* value[x] only CodeableConcept
* valueCodeableConcept from SocialSupportVS (required)

Extension: SocialActivity
Id: social-activity
Title: "Social Activity Extension"
* ^experimental = false
Description: "Extension for recording specific social activities"
* value[x] only CodeableConcept
* valueCodeableConcept from SocialActivityVS (required)

ValueSet: SocialContextVS
Id: social-context-vs
Title: "Social Context Value Set"
* ^experimental = false
Description: "Value set for social interaction contexts"
* codes from system SocialContextCS

ValueSet: SocialSupportVS
Id: social-support-vs
Title: "Social Support Value Set"
* ^experimental = false
Description: "Value set for levels of social support"
* codes from system SocialSupportCS

ValueSet: SocialActivityVS
Id: social-activity-vs
Title: "Social Activity Value Set"
* ^experimental = false
Description: "Value set for types of social activities"
* codes from system SocialActivityCS

CodeSystem: SocialContextCS
Id: social-context-cs
Title: "Social Context Code System"
* ^experimental = false
Description: "Code system for social interaction contexts"
* #home "Home" "Home environment"
* #work "Work" "Work environment"
* #education "Educational" "Educational setting"
* #community "Community" "Community setting"
* #recreational "Recreational" "Recreational setting"
* #healthcare "Healthcare" "Healthcare setting"

CodeSystem: SocialSupportCS
Id: social-support-cs
Title: "Social Support Code System"
* ^experimental = false
Description: "Code system for levels of social support"
* #strong "Strong Support" "Strong social support network"
* #adequate "Adequate Support" "Sufficient social support"
* #limited "Limited Support" "Limited social support"
* #minimal "Minimal Support" "Minimal social support"
* #none "No Support" "Absence of social support"

CodeSystem: SocialActivityCS
Id: social-activity-cs
Title: "Social Activity Code System"
* ^experimental = false
Description: "Code system for types of social activities"
* #meal "Shared Meal" "Sharing a meal together"
* #exercise "Group Exercise" "Group physical activity"
* #entertainment "Entertainment" "Shared entertainment activity"
* #learning "Learning" "Group learning activity"
* #volunteering "Volunteering" "Community service activity"
* #celebration "Celebration" "Social celebration or event"



// ===== Conteúdo de: SleepExtensions.fsh =====




// ===== Conteúdo de: ComplianceExtensions.fsh =====

// ====== Extensões de Compliance Multi-Jurisdicional ======

Extension: RegulatoryBasis
Id: regulatory-basis
Title: "Regulatory Basis for Consent"
Description: "Identifies the regulatory framework(s) that govern this consent"
* value[x] only CodeableConcept
* valueCodeableConcept from RegulatoryFrameworkVS (extensible)

Extension: JurisdictionApplicability  
Id: jurisdiction-applicability
Title: "Jurisdiction Applicability"
Description: "Specifies which jurisdictions this consent applies to"
* value[x] only CodeableConcept
* valueCodeableConcept from http://hl7.org/fhir/ValueSet/jurisdiction (extensible)

Extension: DataLocalization
Id: data-localization
Title: "Data Localization Requirements"
Description: "Specifies data localization requirements per jurisdiction"
* extension contains
    jurisdiction 1..1 MS and
    storageLocation 1..1 MS and
    residencyRequired 1..1 MS
* extension[jurisdiction].value[x] only CodeableConcept
* extension[storageLocation].value[x] only string
* extension[residencyRequired].value[x] only boolean

// ====== ValueSets de Compliance ======

ValueSet: RegulatoryFrameworkVS
Id: regulatory-framework-vs
Title: "Regulatory Framework Value Set"
Description: "Regulatory frameworks for healthcare data protection"
* ^experimental = false
* include codes from system RegulatoryFrameworkCS

CodeSystem: RegulatoryFrameworkCS
Id: regulatory-framework-cs
Title: "Regulatory Framework Code System"
Description: "Codes for healthcare regulatory frameworks"
* ^experimental = false
* ^caseSensitive = true
* #gdpr "GDPR - General Data Protection Regulation" "European Union data protection regulation"
* #hipaa "HIPAA - Health Insurance Portability and Accountability Act" "United States healthcare privacy law"
* #lgpd "LGPD - Lei Geral de Proteção de Dados" "Brazilian general data protection law"
* #pipeda "PIPEDA - Personal Information Protection and Electronic Documents Act" "Canadian privacy law"
* #ehds "EHDS - European Health Data Space" "European health data framework"



// ===== Conteúdo de: MobilityExtensions.fsh =====

Extension: MobilityAlertLevel
Id: mobility-alert-level
Title: "Mobility Alert Level Extension"
Description: "Extension for mobility measurements alert levels to indicate the severity or concern level of mobility changes detected by the device"
* ^status = #active
* ^context[0].type = #element
* ^context[0].expression = "Observation"
* . ^short = "Mobility alert level indicator"
* . ^definition = "Indicates the severity level of mobility changes or concerns based on device measurements"
* value[x] only CodeableConcept
* valueCodeableConcept from MobilityAlertLevelVS (required)
* valueCodeableConcept ^short = "Alert level code"
* valueCodeableConcept ^definition = "The specific alert level code indicating the severity of mobility changes"

ValueSet: MobilityAlertLevelVS
Id: mobility-alert-level-vs
Title: "Mobility Alert Level Value Set"
Description: "Value set for mobility measurement alert levels used to categorize the severity of mobility changes or concerns"
* ^status = #active
* ^experimental = false
* ^purpose = "To provide standardized alert levels for mobility measurements"
* codes from system MobilityAlertLevelCS

CodeSystem: MobilityAlertLevelCS
Id: mobility-alert-level-cs
Title: "Mobility Alert Level Code System"
Description: "Code system defining alert levels for mobility measurements, indicating the severity of changes in mobility patterns"
* ^status = #active
* ^experimental = false
* ^caseSensitive = true
* ^content = #complete
* #green "Normal - No concern" "Mobility measurements are within normal range and show no concerning patterns"
* #yellow "Caution - Monitor closely" "Mobility measurements show slight deviations that warrant closer monitoring"
* #red "Alert - Significant change" "Mobility measurements indicate significant changes that require immediate attention"
* ^property[0].code = #status
* ^property[0].type = #code
* ^property[0].description = "The status of the alert level"
* ^property[1].code = #severity
* ^property[1].type = #integer
* ^property[1].description = "Numeric value indicating severity (1=low, 3=high)"



// ===== Conteúdo de: ActivityExtensions.fsh =====




// ===== Conteúdo de: MobilityRiskValueSets.fsh =====

ValueSet: FallRiskOutcomesValueSet
Id: fall-risk-outcomes
Title: "Fall Risk Outcomes Value Set"
* ^experimental = false
Description: "Value set for fall risk assessment outcomes"
* ^url = "https://2rdoc.pt/fhir/ValueSet/fall-risk-outcomes"
* ^status = #active
* include codes from system https://2rdoc.pt/fhir/CodeSystem/fall-risk-outcomes

ValueSet: RiskLevelValueSet
Id: risk-level
Title: "Risk Level Value Set"
* ^experimental = false
Description: "Value set for general risk levels"
* ^url = "https://2rdoc.pt/fhir/ValueSet/risk-level"
* ^status = #active
* include codes from system https://2rdoc.pt/fhir/CodeSystem/risk-level

ValueSet: MobilityDeclineOutcomesValueSet
Id: mobility-decline-outcomes
Title: "Mobility Decline Outcomes Value Set"
* ^experimental = false
Description: "Value set for mobility decline assessment outcomes"
* ^url = "https://2rdoc.pt/fhir/ValueSet/mobility-decline-outcomes"
* ^status = #active
* include codes from system https://2rdoc.pt/fhir/CodeSystem/mobility-decline-outcomes

ValueSet: AssistanceLevelOutcomesValueSet
Id: assistance-level-outcomes
Title: "Assistance Level Outcomes Value Set"
* ^experimental = false
Description: "Value set for assistance level assessment outcomes"
* ^url = "https://2rdoc.pt/fhir/ValueSet/assistance-level-outcomes"
* ^status = #active
* include codes from system https://2rdoc.pt/fhir/CodeSystem/assistance-level-outcomes



// ===== Conteúdo de: SymptomValueSets.fsh =====

CodeSystem: SymptomSeverityCS
Id: symptom-severity-cs
Title: "Symptom Severity Code System"
* ^experimental = false
Description: "Severity levels for symptoms"

* #1-3 "Light" "Symptom barely noticeable"
* #4-6 "Mild" "Symptom noticeable but not interfering with daily activities"
* #7-8 "Intense" "Symptom interfering with daily activities"
* #9-10 "Severe" "Symptom preventing daily activities"

ValueSet: BodyLocationsVS
Id: body-locations-vs
Title: "Body Locations Value Set"
* ^experimental = false
Description: "Anatomical locations for symptom recording"
* $SCT#12738006 "Brain"
* $SCT#69536005 "Head"
* $SCT#45048000 "Neck"
* $SCT#51185008 "Chest"
* $SCT#62413002 "Abdomen"
* $SCT#32849002 "Back"
* $SCT#53120007 "Upper limb"
* $SCT#61685007 "Lower limb"

ValueSet: DurationUnitsVS
Id: duration-units-vs
Title: "Duration Units Value Set"
* ^experimental = false
Description: "Time units for symptom duration"
* $UCUM#min "Minutes"
* $UCUM#h "Hours"
* $UCUM#d "Days"
* $UCUM#wk "Weeks"
* $UCUM#mo "Months"

CodeSystem: SymptomFrequencyCS
Id: symptom-frequency-cs
Title: "Symptom Frequency Code System"
* ^experimental = false
Description: "Frequency patterns for symptoms"
* #rare "Rare" "Less than once per month"
* #occasional "Occasional" "Several times per month"
* #frequent "Frequent" "Several times per week"
* #daily "Daily" "Once or more per day"
* #constant "Constant" "Present most of the time"

ValueSet: SymptomFrequencyVS
Id: symptom-frequency-vs
Title: "Symptom Frequency Value Set"
* ^experimental = false
Description: "Frequency patterns for symptoms"
* codes from system SymptomFrequencyCS

CodeSystem: SymptomImpactCS
Id: symptom-impact-cs
Title: "Symptom Impact Code System"
* ^experimental = false
Description: "Impact levels of symptoms on daily activities"
* #none "No impact"
* #mild "Mild impact"
* #moderate "Moderate impact"
* #severe "Severe impact"
* #complete "Complete impact"

ValueSet: SymptomImpactVS
Id: symptom-impact-vs
Title: "Symptom Impact Value Set"
* ^experimental = false
Description: "Impact levels for symptoms"
* codes from system SymptomImpactCS

ValueSet: SymptomProgressionVS
Id: symptom-progression-vs
Title: "Symptom Progression Value Set"
* ^experimental = false
Description: "Progression patterns for symptoms"
* $SCT#385633008 "Improving"
* $SCT#58158008 "Stable"
* $SCT#230993007 "Worsening"
* $SCT#255314001 "Fluctuating"

ValueSet: TimeOfDayVS
Id: time-of-day-vs
Title: "Time of Day Value Set"
* ^experimental = false
Description: "Times of day for symptom occurrence"
* $SCT#73775008 "Morning"
* $SCT#255214003 "After exercise"
* $SCT#2546009 "Evening"
* $SCT#73775008 "Morning"



// ===== Conteúdo de: StressValueSets.fsh =====

ValueSet: StressChronicityVS
Id: stress-chronicity-vs
Title: "Stress Chronicity Value Set"
* ^experimental = false
Description: "Value set for classifying stress chronicity"
* ^url = "https://2rdoc.pt/fhir/ValueSet/stress-chronicity-vs"
* codes from system StressChronicityCS

ValueSet: StressImpactVS
Id: stress-impact-vs
Title: "Stress Impact Value Set"
* ^experimental = false
Description: "Value set for describing stress impact levels"
* ^url = "https://2rdoc.pt/fhir/ValueSet/stress-impact-vs"
* codes from system StressImpactCS

CodeSystem: StressChronicityCS
Id: stress-chronicity-cs
Title: "Stress Chronicity Code System"
* ^experimental = false
Description: "Code system for stress chronicity classification"
* ^url = "https://2rdoc.pt/fhir/CodeSystem/stress-chronicity-cs"
* #acute "Acute" "Short-term stress response"
* #subacute "Subacute" "Medium-term stress response"
* #chronic "Chronic" "Long-term stress response"
* #episodic "Episodic" "Recurring stress episodes"
* #persistent "Persistent" "Continuous stress state"

CodeSystem: StressImpactCS
Id: stress-impact-cs
Title: "Stress Impact Code System"
* ^experimental = false
Description: "Code system for stress impact levels"
* ^url = "https://2rdoc.pt/fhir/CodeSystem/stress-impact-cs"
* #minimal "Minimal Impact" "Little to no interference with daily activities"
* #mild "Mild Impact" "Some interference with daily activities"
* #moderate "Moderate Impact" "Significant interference with daily activities"
* #severe "Severe Impact" "Major interference with daily activities"
* #extreme "Extreme Impact" "Unable to perform daily activities"



// ===== Conteúdo de: ReproductiveValueSets.fsh =====

ValueSet: ReproductiveGoalVS
Id: reproductive-goal-vs
Title: "Reproductive Health Goals Value Set"
Description: "Goals related to reproductive health tracking and planning"

* ^status = #active
* ^experimental = false
* ^date = "2024-03-19"

* $LOINC#8708-0 "Menstrual cycle length"
* $LOINC#55284-4 "Blood pressure"
* $LOINC#8310-5 "Body temperature"
* $LOINC#8302-2 "Body height"
* $LOINC#29463-7 "Body weight"
* $SCT#364311006 "Menstrual cycle monitoring"
* $SCT#289530006 "Reproductive health finding"

ValueSet: ReproductiveActivityVS
Id: reproductive-activity-vs
Title: "Reproductive Health Activities Value Set"
Description: "Activities related to reproductive health monitoring"

* ^status = #active
* ^experimental = false
* ^date = "2024-03-19"

* codes from system ReproductiveActivityCS

CodeSystem: ReproductiveActivityCS
Id: reproductive-activity-cs
Title: "Reproductive Health Activities Code System"
Description: "Code system for reproductive health monitoring activities"

* ^status = #active
* ^experimental = false
* ^caseSensitive = true

* #cycle-tracking "Cycle Tracking" "Track menstrual cycle dates and characteristics"
* #temp-monitoring "Temperature Monitoring" "Monitor basal body temperature"
* #symptom-tracking "Symptom Tracking" "Track reproductive health symptoms"
* #vitals-monitoring "Vitals Monitoring" "Monitor vital signs related to reproductive health"
* #fertility-signs "Fertility Signs" "Monitor fertility signs and indicators"
* #mood-tracking "Mood Tracking" "Track mood changes related to reproductive cycle"
* #medication-log "Medication Log" "Log reproductive health medications"
* #exercise-tracking "Exercise Tracking" "Track physical activity during cycle"



// ===== Conteúdo de: AuditFormatsValueSet.fsh =====

ValueSet: AuditFormatsValueSet
Id: audit-formats
Title: "Audit Formats Value Set"
Description: "Value set for audit format types"
* ^url = "https://2rdoc.pt/fhir/ValueSet/audit-formats"
* ^status = #active
* ^experimental = false
* ^date = "2024-12-27"
* include codes from system https://2rdoc.pt/fhir/CodeSystem/audit-formats

CodeSystem: AuditFormatsCodeSystem
Id: audit-formats
Title: "Audit Formats Code System"
Description: "Code system for audit format types"
* ^url = "https://2rdoc.pt/fhir/CodeSystem/audit-formats"
* ^status = #active
* ^experimental = false
* ^caseSensitive = true
* #text "Text Format"
* #structured "Structured Format"
* #mixed "Mixed Format"



// ===== Conteúdo de: MeasurementContextVS.fsh =====

ValueSet: MeasurementContextVS
Id: measurement-context-vs
Title: "Measurement Context Value Set"
Description: "Contexts in which measurements can be taken, including temporal and location-based contexts"
* ^status = #active
* ^experimental = false
* $SCT#272125009 "Assessment context value (qualifier value)"
* $SCT#307818003 "Before food"
* $SCT#307819006 "After food"
* $SCT#255214003 "After exercise"
* $SCT#264362003 "Time of day"



// ===== Conteúdo de: AuditLevelsValueSet.fsh =====

ValueSet: AuditLevelsValueSet
Id: audit-levels
Title: "Audit Levels Value Set"
Description: "Value set for audit level types"
* ^url = "https://2rdoc.pt/fhir/ValueSet/audit-levels"
* ^status = #active
* ^experimental = false
* ^date = "2024-12-27"
* include codes from system https://2rdoc.pt/fhir/CodeSystem/audit-levels

CodeSystem: AuditLevelsCodeSystem
Id: audit-levels
Title: "Audit Levels Code System"
Description: "Code system for audit level types"
* ^url = "https://2rdoc.pt/fhir/CodeSystem/audit-levels"
* ^status = #active
* ^experimental = false
* ^caseSensitive = true
* #low "Low Level"
* #medium "Medium Level"
* #high "High Level"



// ===== Conteúdo de: SocialInteractionValueSets.fsh =====

ValueSet: SocialInteractionTypeVS
Id: social-interaction-type-vs
Title: "Social Interaction Type Value Set"
* ^experimental = false
Description: "Types of social interactions"
* codes from system SocialInteractionTypeCS

ValueSet: SocialInteractionQualityVS
Id: social-interaction-quality-vs
Title: "Social Interaction Quality Value Set"
* ^experimental = false
Description: "Quality measures for social interactions"
* codes from system SocialInteractionQualityCS

ValueSet: SocialInteractionMediumVS
Id: social-interaction-medium-vs
Title: "Social Interaction Medium Value Set"
* ^experimental = false
Description: "Mediums through which social interaction occurs"
* codes from system SocialInteractionMediumCS

CodeSystem: SocialInteractionTypeCS
Id: social-interaction-type-cs
Title: "Social Interaction Type Code System"
* ^experimental = false
Description: "Types of social interactions"
* #family "Family Interaction" "Interaction with family members"
* #friends "Friend Interaction" "Interaction with friends"
* #professional "Professional Interaction" "Work-related interactions"
* #community "Community Interaction" "Community-based interactions"
* #group "Group Activity" "Organized group activities"
* #casual "Casual Interaction" "Casual social encounters"

CodeSystem: SocialInteractionQualityCS
Id: social-interaction-quality-cs
Title: "Social Interaction Quality Code System"
* ^experimental = false
Description: "Quality measures for social interactions"
* #meaningful "Meaningful" "Deep, meaningful interaction"
* #meaningful "Meaningful" "Deep and significant interaction"
* #supportive "Supportive" "Supportive interaction"
* #meaningful "Meaningful" "Deep and significant interaction"
* #neutral "Neutral" "Neither positive nor negative"
* #meaningful "Meaningful" "Deep and significant interaction"
* #superficial "Superficial" "Surface-level interaction"
* #meaningful "Meaningful" "Deep and significant interaction"
* #stressful "Stressful" "Stressful or difficult interaction"
* #meaningful "Meaningful" "Deep and significant interaction"

CodeSystem: SocialInteractionMediumCS
Id: social-interaction-medium-cs
Title: "Social Interaction Medium Code System"
* ^experimental = false
Description: "Mediums through which social interaction occurs"
* #inPerson "In Person" "Face-to-face interaction"
* #meaningful "Meaningful" "Deep and significant interaction"
* #video "Video Call" "Video-based interaction"
* #meaningful "Meaningful" "Deep and significant interaction"
* #voice "Voice Call" "Voice-only interaction"
* #meaningful "Meaningful" "Deep and significant interaction"
* #text "Text Based" "Text-based communication"
* #meaningful "Meaningful" "Deep and significant interaction"
* #social "Social Media" "Social media interaction"
* #meaningful "Meaningful" "Deep and significant interaction"
* #mixed "Mixed Medium" "Multiple communication methods"
* #meaningful "Meaningful" "Deep and significant interaction"



// ===== Conteúdo de: MoodValueSet.fsh =====

ValueSet: MoodValueSet
Id: mood
Title: "Mood Value Set"
Description: "Value set for mood states"
* ^url = "https://2rdoc.pt/fhir/ValueSet/mood"
* ^status = #active
* ^experimental = false

CodeSystem: MoodCodeSystem
Id: mood
Title: "Mood Code System"
Description: "Code system for mood states"
* ^url = "https://2rdoc.pt/fhir/CodeSystem/mood"
* ^status = #active
* ^caseSensitive = true
* #elevated "Elevated" "Mood is higher than normal"
* #neutral "Neutral" "Neither elevated nor depressed mood"
* #depressed "Depressed" "Mood is lower than normal"
* #anxious "Anxious" "Feeling worried or nervous"
* #irritable "Irritable" "Easily annoyed or angered"
* #calm "Calm" "Feeling peaceful and relaxed"



// ===== Conteúdo de: EnvironmentalContextVS.fsh =====

ValueSet: EnvironmentalContextValueSet
Id: environmental-context
Title: "Environmental Context Value Set"
Description: "Valid contexts for environmental measurements"

* ^status = #active
* ^experimental = false
* ^url = "https://2rdoc.pt/fhir/ValueSet/environmental-context"
* include codes from system https://2rdoc.pt/fhir/CodeSystem/environmental-context



// ===== Conteúdo de: ActivityTypeVS.fsh =====

ValueSet: PhysicalActivityTypeVS
Id: physical-activity-type-vs
Title: "Physical Activity Types Value Set"
* ^experimental = false
Description: "Types of physical activities from iOS Health App"

* ^status = #active

* $SNOMED#255604002 "Physical activity (observable entity)"
* $SNOMED#228557008 "Walking"
* $SNOMED#229058003 "Running"
* $SNOMED#266938001 "Swimming"
* $SNOMED#266940006 "Cycling"
* $SNOMED#32147004 "Regular exercise"



// ===== Conteúdo de: MindfulnessValueSets.fsh =====

ValueSet: EnvironmentTypeValueSet
Id: environment-type
Title: "Environment Type Value Set"
* ^experimental = false
Description: "Value set for environmental context types"
* ^url = "https://2rdoc.pt/fhir/ValueSet/environment-type"
* ^status = #active
* include codes from system https://2rdoc.pt/fhir/CodeSystem/environment-type

ValueSet: MindfulnessTypeValueSet
Id: mindfulness-type
Title: "Mindfulness Type Value Set"
* ^experimental = false
Description: "Value set for types of mindfulness practices"
* ^url = "https://2rdoc.pt/fhir/ValueSet/mindfulness-type"
* ^status = #active
* include codes from system https://2rdoc.pt/fhir/CodeSystem/mindfulness-type



// ===== Conteúdo de: BalanceStatusValueSet.fsh =====

ValueSet: BalanceStatusValueSet
Id: balance-status
Title: "Balance Status Value Set"
Description: "Value set for walking steadiness balance status"
* ^url = "https://2rdoc.pt/fhir/ValueSet/balance-status"
* ^status = #active
* include codes from system https://2rdoc.pt/fhir/CodeSystem/balance-status

CodeSystem: BalanceStatusCodeSystem
Id: balance-status
Title: "Balance Status Code System"
Description: "Code system for balance status types"
* ^url = "https://2rdoc.pt/fhir/CodeSystem/balance-status"
* ^status = #active
* ^experimental = false
* ^caseSensitive = true
* #veryStable "Very Stable"
* #stable "Stable"
* #slightlyUnstable "Slightly Unstable"
* #unstable "Unstable"
* #veryUnstable "Very Unstable"



// ===== Conteúdo de: SleepQualityVS.fsh =====

ValueSet: SleepQualityVS
Id: sleep-quality-vs
Title: "Sleep Quality Value Set"
Description: "Qualitative assessments of sleep quality including subjective measures"
* ^status = #active
* ^experimental = false
* $SCT#248254009 "Quality of sleep (observable entity)"
* $SCT#248255005 "Sleeping well"
* $SCT#248256006 "Difficulty sleeping"
* $SCT#301345002 "Poor sleep pattern"
* $SCT#301346001 "Good sleep pattern"




// ===== Conteúdo de: FertilityValueSets.fsh =====

ValueSet: CervicalMucusValueSet
Id: cervical-mucus-valueset
Title: "Cervical Mucus Value Set"
* ^experimental = false
Description: "Value set for cervical mucus observations"
* ^url = "https://2rdoc.pt/fhir/ValueSet/cervical-mucus-vs"
* ^status = #active
* include codes from system https://2rdoc.pt/fhir/CodeSystem/cervical-mucus-cs

CodeSystem: CervicalMucusCodeSystem
Id: cervical-mucus-cs
Description: "Code system for cervical mucus classification"Title: "Cervical Mucus Code System"
* ^url = "https://2rdoc.pt/fhir/CodeSystem/cervical-mucus-cs"
* ^status = #active
* ^caseSensitive = true
* #dry "Dry"
* #sticky "Sticky"
* #creamy "Creamy"
* #watery "Watery"
* #eggWhite "Egg White"

ValueSet: OvulationTestValueSet
Id: ovulation-test-valueset
Title: "Ovulation Test Value Set"
* ^experimental = false
Description: "Value set for ovulation test results"
* ^url = "https://2rdoc.pt/fhir/ValueSet/ovulation-test-vs"
* ^status = #active
* include codes from system https://2rdoc.pt/fhir/CodeSystem/ovulation-test-cs

CodeSystem: OvulationTestCodeSystem
Id: ovulation-test-cs
Description: "Code system for ovulation test results"Title: "Ovulation Test Code System"
* ^url = "https://2rdoc.pt/fhir/CodeSystem/ovulation-test-cs"
* ^status = #active
* ^caseSensitive = true
* #negative "Negative"
* #positive "Positive"
* #invalid "Invalid Test"

ValueSet: FertilityStatusValueSet
Id: fertility-status-valueset
Title: "Fertility Status Value Set"
* ^experimental = false
Description: "Value set for fertility status"
* ^url = "https://2rdoc.pt/fhir/ValueSet/fertility-status-vs"
* ^status = #active
* include codes from system https://2rdoc.pt/fhir/CodeSystem/fertility-status-cs

CodeSystem: FertilityStatusCodeSystem
Id: fertility-status-cs
Description: "Code system for fertility status indicators"Title: "Fertility Status Code System"
* ^url = "https://2rdoc.pt/fhir/CodeSystem/fertility-status-cs"
* ^status = #active
* ^caseSensitive = true
* #fertile "Fertile"
* #notFertile "Not Fertile"
* #uncertain "Uncertain"



// ===== Conteúdo de: MindfulnessSearchParameters.fsh =====

Instance: MindfulnessType
InstanceOf: SearchParameter
Description: "Example instance of MindfulnessType"Usage: #definition
* status = #active
* code = #mindfulness-type
* name = "MindfulnessType"
* description = "Search for mindfulness observations by practice type"
* base = #Observation
* type = #token
* expression = "Observation.component.where(code.coding.exists(system = 'http://snomed.info/sct' and code = '711415009')).value.as(CodeableConcept)"
* xpath = "f:Observation/f:component[f:code/f:coding[f:system/@value='http://snomed.info/sct' and f:code/f:coding/f:code/@value='711415009']]/f:valueCodeableConcept"
* xpathUsage = #normal



// ===== Conteúdo de: MindfulnessAlerts.fsh =====

Extension: AlertTiming
Id: alert-timing
Title: "Alert Timing Extension"
Description: "Defines when alerts should be triggered"
* value[x] only Timing
* valueTiming.repeat 1..1 MS
* valueTiming.repeat.frequency MS
* valueTiming.repeat.period MS
* valueTiming.repeat.periodUnit MS

Extension: AlertMessage
Id: alert-message
Title: "Alert Message Extension"
Description: "Defines the alert message content"
* value[x] only string

Profile: MindfulnessAlert
Parent: Basic
Id: mindfulness-alert
Title: "Mindfulness Alert"
Description: "Alert configuration for mindfulness sessions"

* code 1..1 MS
* code = https://2rdoc.pt/fhir/CodeSystem/mindfulness-alert-type#reminder "Mindfulness Reminder"

* extension contains
    alert-timing named alertTiming 0..1 MS and
    alert-message named alertMessage 1..1 MS

Instance: DailyMindfulnessAlert
InstanceOf: MindfulnessAlert
Title: "Daily Mindfulness Alert" 
Description: "Example of a daily mindfulness alert configuration"

* code = https://2rdoc.pt/fhir/CodeSystem/mindfulness-alert-type#reminder "Mindfulness Reminder"
* extension[alertTiming].valueTiming.repeat
  * frequency = 1
  * period = 1
  * periodUnit = #d
* extension[alertMessage].valueString = "Time for your daily mindfulness practice"



// ===== Conteúdo de: MindfulnessTransforms.fsh =====

Instance: MindfulnessHealthKitTransform
InstanceOf: StructureMap
Usage: #definition
Title: "HealthKit to FHIR Mindfulness Transform"

* status = #draft
* name = "MindfulnessHealthKitTransform"
* structure[0]
  * url = "https://2rdoc.pt/ig/ios-lifestyle-medicine/StructureDefinition/healthkit-mindfulness"
  * mode = #source
  * documentation = "HealthKit mindfulness session structure"

* structure[1]
  * url = "http://hl7.org/fhir/StructureDefinition/Observation"
  * mode = #target
  * documentation = "FHIR Observation resource"

* group[0]
  * name = "MindfulnessSessionToObservation"
  * typeMode = #none
  * input[0]
    * name = "source"
    * type = "HealthKitMindfulness"
    * mode = #source
  * input[1]
    * name = "target"
    * type = "Observation"
    * mode = #target
  * rule[0]
    * name = "Session"
    * source[0]
      * context = "source"
      * element = "startDate"
    * target[0]
      * context = "target"
      * element = "effectiveDateTime"
  * rule[1]
    * name = "Duration"
    * source[0]
      * context = "source"
      * element = "duration"
    * target[0]
      * context = "target"
      * element = "component.where(code.coding.code='118682006').valueQuantity"

Instance: MindfulnessCSVTransform
InstanceOf: StructureMap
Usage: #definition
Title: "CSV to FHIR Mindfulness Transform"

* status = #draft
* name = "MindfulnessCSVTransform"
* structure[0]
  * url = "https://2rdoc.pt/ig/ios-lifestyle-medicine/StructureDefinition/csv-mindfulness"
  * mode = #source
  * documentation = "CSV mindfulness data structure"

* group[0]
  * name = "CSVToMindfulnessObservation"
  * typeMode = #none
  * input[0]
    * name = "source"
    * type = "CSVMindfulness"
    * mode = #source
  * input[1]
    * name = "target"
    * type = "Observation"
    * mode = #target
  * rule[0]
    * name = "MapDatetime"
    * source[0]
      * context = "source"
      * element = "date,time"
    * target[0]
      * context = "target"
      * element = "effectiveDateTime"
      * transform = #append

RuleSet: TransformValidationRules
* rule[+]
  * name = "ValidateStatus"
  * source[0]
    * context = "target"
    * element = "status"
  * assert[0]
    * description = "Status must be final"
    * expression = "%status = 'final'"

* rule[+]
  * name = "ValidateCode"
  * source[0]
    * context = "target"
    * element = "code"
  * assert[0]
    * description = "Must use SNOMED CT code"
    * expression = "%code.system = 'http://snomed.info/sct'"



// ===== Conteúdo de: MindfulnessAudit.fsh =====

Extension: AuditLevelExtension
Id: audit-level
Title: "Audit Level Extension"
Description: "Level of detail for audit records"
* value[x] only code
* valueCode from https://2rdoc.pt/fhir/ValueSet/audit-levels (required)

Extension: AuditRetentionExtension
Id: audit-retention
Title: "Audit Retention Extension" 
Description: "Period to retain audit records"
* value[x] only Duration

Extension: AuditFormatExtension
Id: audit-format
Title: "Audit Format Extension"
Description: "Format for audit records"
* value[x] only code
* valueCode from https://2rdoc.pt/fhir/ValueSet/audit-formats (required)

Profile: MindfulnessAudit
Parent: Basic
Id: mindfulness-audit
Title: "Mindfulness Audit"
Description: "Audit record for mindfulness sessions"

* code 1..1 MS
* code = https://2rdoc.pt/fhir/CodeSystem/mindfulness-audit-type#session "Session Audit"
* created 1..1 MS

* extension contains
    audit-level named auditLevel 1..1 MS and
    audit-retention named auditRetention 1..1 MS and
    audit-format named auditFormat 1..1 MS

Instance: MindfulnessAuditExample
InstanceOf: MindfulnessAudit
Title: "Example Mindfulness Audit"
Description: "Example of a mindfulness session audit record"

* code = https://2rdoc.pt/fhir/CodeSystem/mindfulness-audit-type#session "Session Audit"
* created = "2024-03-15"
* extension[auditLevel].valueCode = #detailed
* extension[auditRetention].valueDuration = 90 'days'
* extension[auditFormat].valueCode = #fhir



// ===== Conteúdo de: EnvironmentalExamples.fsh =====

Instance: NoiseExposureExample
InstanceOf: NoiseExposureObservation
Usage: #example
Description: "Noise exposure observation example"
Title: "Noise Exposure Measurement Example"

* meta.security = http://terminology.hl7.org/CodeSystem/v3-Confidentiality#N
* status = #final
* performer = Reference(Practitioner/PractitionerExample)
* category = http://terminology.hl7.org/CodeSystem/observation-category#environment
* code = $LOINC#28573-7 "Noise exposure time"
* subject = Reference(Patient/PatientExample)
* effectiveDateTime = "2024-03-19T15:30:00Z"
* device = Reference(Device/iphone-example)
* method = http://snomed.info/sct#37016008 "Automatic measurement"

* component[level]
  * code.coding[0] = $LOINC#89020-2 "Environmental noise average"
  * valueQuantity = 85 'dB'
  * interpretation = http://terminology.hl7.org/CodeSystem/v3-ObservationInterpretation#H "High"

* component[duration]
  * code.coding[0] = $LOINC#89021-0 "Environmental noise duration"
  * valueQuantity = 120 'min'

* component[peakLevel]
  * code.coding[0] = $LOINC#89024-4 "Peak sound level"
  * valueQuantity = 95 'dB'

* component[backgroundNoise]
  * code.coding[0] = $LOINC#89025-1 "Background noise level"
  * valueQuantity = 45 'dB'

* note.text = "Measurement taken during urban commute"

Instance: UVExposureExample
InstanceOf: UVExposureObservation
Usage: #example
Description: "UV exposure observation example"
Title: "UV Exposure Measurement Example"

* meta.security = http://terminology.hl7.org/CodeSystem/v3-Confidentiality#N
* status = #final
* category = http://terminology.hl7.org/CodeSystem/observation-category#environment
* code = $LOINC#28574-5 "UV exposure"
* subject = Reference(Patient/PatientExample)
* effectiveDateTime = "2024-03-19T12:00:00Z"
* device = Reference(Device/iphone-example)
* method = http://snomed.info/sct#37016008 "Automatic measurement"

* component[index]
  * code.coding[0] = $LOINC#89022-8 "UV index"
  * valueQuantity = 8 '{index}'
  * interpretation = http://terminology.hl7.org/CodeSystem/v3-ObservationInterpretation#H "High"

* component[duration]
  * code.coding[0] = $LOINC#89023-6 "UV exposure duration"
  * valueQuantity = 45 'min'

* component[timeOfDay]
  * code.coding[0] = $LOINC#89026-9 "Time of exposure"
  * valueDateTime = "2024-03-19T12:00:00Z"

* component[intensity]
  * code.coding[0] = $LOINC#89027-7 "UV intensity"
  * valueQuantity = 0.3 'W/m2'

* note.text = "Measurement taken during outdoor activity"

Instance: EnvironmentalDeviceExample
InstanceOf: Device
Usage: #example
Description: "Environmental monitoring device example"
Title: "Environmental Monitoring Device"

* identifier.system = "https://2rdoc.pt/ig/ios-lifestyle-medicine/devices"
* identifier.value = "iPhone-ENV-001"
* manufacturer = "Apple Inc."
* modelNumber = "iPhone 15 Pro"
* type = $SCT#706689003 "Environmental monitoring device"
* status = #active



// ===== Conteúdo de: NutritionExamples.fsh =====

Instance: NutritionQuestionnaireResponseExample
InstanceOf: QuestionnaireResponse
Usage: #example
Description: "Nutrition questionnaire response example"
Title: "Daily Nutrition Questionnaire Response Example"

* questionnaire = "https://2rdoc.pt/fhir/Questionnaire/daily-nutrition"
* status = #completed
* subject = Reference(Patient/PatientExample)
* authored = "2024-12-14T20:00:00Z"

* item[0]
  * linkId = "water_intake"
  * answer.valueQuantity = 2000 'mL'

* item[1]
  * linkId = "meal_record"

  * item[0]
    * linkId = "meal_time"
    * answer.valueDateTime = "2024-12-14T12:00:00Z"

  * item[1]
    * linkId = "meal_type"
    * answer.valueString = "Lunch"

  * item[2]
    * linkId = "calories"
    * answer.valueInteger = 650

  * item[3]
    * linkId = "macronutrients"
   
    * item[0]
      * linkId = "carbs"
      * answer.valueDecimal = 75
   
    * item[1]
      * linkId = "protein"
      * answer.valueDecimal = 30
   
    * item[2]
      * linkId = "fat"
      * answer.valueDecimal = 25

* item[2]
  * linkId = "caffeine"

  * item[0]
    * linkId = "caffeine_amount"
    * answer.valueInteger = 80

  * item[1]
    * linkId = "caffeine_source"
    * answer.valueString = "Coffee"



// ===== Conteúdo de: SleepExamples.fsh =====

Instance: SleepObservationExample1
InstanceOf: SleepObservation
Usage: #example
Description: "Sleep observation example"
Title: "Example of Sleep Record"
 
* status = #final
* category = http://terminology.hl7.org/CodeSystem/observation-category#sleep
* code = $LOINC#93832-4 "Sleep pattern panel"
* subject = Reference(PatientExample)
* effectivePeriod.start = "2024-03-19T22:00:00Z"
* effectivePeriod.end = "2024-03-20T06:30:00Z"
* device = Reference(DeviceSleepMonitor)
 
* component[timeInBed].code = $LOINC#93831-6 "Time in bed"
* component[timeInBed].valueQuantity = 510 'min' "minute"
* component[timeInBed].valueQuantity.system = $UCUM
* component[timeInBed].valueQuantity.unit = "minute"
 
* component[totalSleepTime].code = $LOINC#93833-2 "Sleep duration"
* component[totalSleepTime].valueQuantity = 472 'min' "minute"
* component[totalSleepTime].valueQuantity.system = $UCUM
* component[totalSleepTime].valueQuantity.unit = "minute"
 
* component[deepSleep].code = $LOINC#93834-0 "Deep sleep duration"
* component[deepSleep].valueQuantity = 95 'min' "minute"
* component[deepSleep].valueQuantity.system = $UCUM
* component[deepSleep].valueQuantity.unit = "minute"
 
* component[remSleep].code = $LOINC#93835-7 "REM sleep duration"
* component[remSleep].valueQuantity = 118 'min' "minute"
* component[remSleep].valueQuantity.system = $UCUM
* component[remSleep].valueQuantity.unit = "minute"
 
* component[lightSleep].code = $LOINC#93836-5 "Light sleep duration"
* component[lightSleep].valueQuantity = 259 'min' "minute"
* component[lightSleep].valueQuantity.system = $UCUM
* component[lightSleep].valueQuantity.unit = "minute"
 
* component[respiratoryRate].code = $LOINC#9279-1 "Respiratory rate"
* component[respiratoryRate].valueQuantity = 14 '/min' "per minute"
* component[respiratoryRate].valueQuantity.system = $UCUM
* component[respiratoryRate].valueQuantity.unit = "per minute"
 
* component[heartRateVariability].code = $LOINC#80404-7 "R-R interval.standard deviation (Heart rate variability)"
* component[heartRateVariability].valueQuantity = 45 'ms' "millisecond"
* component[heartRateVariability].valueQuantity.system = $UCUM
* component[heartRateVariability].valueQuantity.unit = "millisecond"
 
* component[interruptions].code = $LOINC#93837-3 "Number of awakenings during sleep"
* component[interruptions].valueQuantity = 3 '{count}' "count"
* component[interruptions].valueQuantity.system = $UCUM
* component[interruptions].valueQuantity.unit = "count"

Instance: DeviceSleepMonitor
InstanceOf: Device
Usage: #example
Description: "Sleep monitor device example"
Title: "Sleep Monitoring Device"
* deviceName.name = "Sleep Quality Monitor"
* deviceName.type = #user-friendly-name
* manufacturer = "HealthTech Devices"
* modelNumber = "SQM-2024"
* type = $SCT#706172001 "Sleep monitor"



// ===== Conteúdo de: StressExamples.fsh =====

Instance: StressLevelExample
InstanceOf: StressLevelProfile
Usage: #example
Description: "Stress level observation example"
Title: "Stress Level Measurement Example"

* status = #final
* category = http://terminology.hl7.org/CodeSystem/observation-category#vital-signs
* code = $LOINC#89592-0 "Stress level score"
* subject = Reference(Patient/PatientExample)
* effectiveDateTime = "2024-01-03T15:30:00Z"
* valueQuantity = 7 '{score}' "score"

* component[physiologicalStress].valueQuantity = 6 '{score}' "score"
* component[psychologicalStress].valueQuantity = 8 '{score}' "score"
* component[chronicity].valueCodeableConcept = StressChronicityCS#subacute
* component[impact].valueCodeableConcept = StressImpactCS#moderate

* extension[triggers].valueCodeableConcept = StressTriggersCS#work
* extension[coping].valueCodeableConcept = StressCopingCS#meditation



// ===== Conteúdo de: PatientExample.fsh =====

Instance: PatientExample
InstanceOf: Patient
Usage: #example
Description: "Patient resource example"
* identifier[0].system = "urn:oid:2.16.858.1.1.1"
* identifier[0].value = "12345"
* name.given = "John"
* name.family = "Doe"
* gender = #male
* birthDate = "1970-01-01"



// ===== Conteúdo de: MobilityExamples.fsh =====

Profile: WalkingSteadinessObservation
Parent: MobilityProfile
Id: walking-steadiness-observation
Description: "Profile for assessing walking steadiness and balance"Title: "Walking Steadiness Observation Profile"

* code = $LOINC#LA32-8 "Balance"
* component contains
    balanceScore 0..1 MS and
    balanceStatus 0..1 MS

* component[balanceScore]
  * code = $LOINC#LA32-8 "Balance score"
  * valueQuantity.system = $UCUM
  * valueQuantity.code = #%

* component[balanceStatus]
  * code = $LOINC#LA32-9 "Balance status"
  * valueCodeableConcept from https://2rdoc.pt/fhir/ValueSet/balance-status (required)

Profile: WalkingSpeedObservation
Parent: MobilityProfile
Id: walking-speed-observation
Description: "Profile for measuring walking speed as part of mobility assessment"Title: "Walking Speed Observation Profile"

* code = $LOINC#LA29042-4 "Walking speed"
* component contains
    speed 0..1 MS and
    distance 0..1 MS

* component[speed]
  * code = $LOINC#LA29042-4 "Walking speed measurement"
  * valueQuantity.system = $UCUM
  * valueQuantity.code = #m/s

* component[distance]
  * code = $LOINC#LA29043-2 "Walking distance"
  * valueQuantity.system = $UCUM
  * valueQuantity.code = #m

Instance: WalkingSteadinessExample
InstanceOf: WalkingSteadinessObservation
Usage: #example
Description: "Walking steadiness observation example"
Title: "Walking Steadiness Measurement Example"

* status = #final
* category = http://terminology.hl7.org/CodeSystem/observation-category#activity
* code = $LOINC#LA32-8 "Balance"
* subject = Reference(Patient/PatientExample)
* effectiveDateTime = "2024-03-19T15:30:00Z"
* valueQuantity = 85 '1' "score"
* device = Reference(Device/iphone-example)

* component[balanceScore].valueQuantity = 85 '%' "percent"
* component[balanceStatus].valueCodeableConcept = $LOINC#LA32-10 "OK"

Instance: WalkingSpeedExample
InstanceOf: WalkingSpeedObservation
Usage: #example
Description: "Walking speed observation example"
Title: "Walking Speed Measurement Example"

* status = #final
* category = http://terminology.hl7.org/CodeSystem/observation-category#activity
* code = $LOINC#LA29042-4 "Walking speed"
* subject = Reference(Patient/PatientExample)
* effectiveDateTime = "2024-03-19T15:30:00Z"
* valueQuantity = 1.2 'm/s' "meters per second"
* device = Reference(Device/iphone-example)

* component[speed].valueQuantity = 1.2 'm/s' "meters per second"
* component[distance].valueQuantity = 10 'm' "meters"



// ===== Conteúdo de: PhysicalActivityExamples.fsh =====

Instance: PhysicalActivityExample1
InstanceOf: PhysicalActivityObservation
Usage: #example
Description: "Physical activity observation example"
Title: "Example of Walking Activity"
* status = #final
* category = http://terminology.hl7.org/CodeSystem/observation-category#activity
* code = $SNOMED#228557008 "Walking"
* subject = Reference(PatientExample)
* effectiveDateTime = "2024-03-19T15:30:00Z"
* device = Reference(DeviceActivityTracker)
* component[steps].code = $LOINC#55423-8 "Number of steps in 24 hour Measured"
* component[steps].valueQuantity = 8546 '1' "count"
* component[steps].valueQuantity.system = $UCUM
* component[steps].valueQuantity.unit = "count"
* component[distance].code = $LOINC#55430-3 "Distance walked"
* component[distance].valueQuantity = 6.2 'km' "kilometer"
* component[distance].valueQuantity.system = $UCUM
* component[distance].valueQuantity.unit = "kilometer"
* component[duration].code = $LOINC#55411-3 "Exercise duration"
* component[duration].valueQuantity = 72 'min' "minute"
* component[duration].valueQuantity.system = $UCUM
* component[duration].valueQuantity.unit = "minute"
* component[energy].code = $LOINC#55424-6 "Energy expenditure"
* component[energy].valueQuantity = 320 'kcal' "kilocalorie"
* component[energy].valueQuantity.system = $UCUM
* component[energy].valueQuantity.unit = "kilocalorie"

Instance: DeviceActivityTracker
InstanceOf: Device
Usage: #example
Description: "Activity tracker device example"
Title: "Activity Tracking Device"
* deviceName.name = "Health Activity Tracker"
* deviceName.type = #user-friendly-name
* manufacturer = "HealthTech Devices"
* modelNumber = "HAT-2024"
* type = $SCT#258158006 "Breathing rate"



// ===== Conteúdo de: BodyMetricsExamples.fsh =====

Instance: WeightExample
InstanceOf: WeightObservation
Usage: #example
Description: "Weight observation example"
Title: "Weight Measurement Example"
* status = #final
* category = http://terminology.hl7.org/CodeSystem/observation-category#vital-signs
* code = $LOINC#29463-7 "Body weight"
* subject = Reference(PatientExample)
* performer = Reference(PractitionerExample)
* effectiveDateTime = "2024-03-19T08:00:00Z"
* valueQuantity = 70.5 'kg' "kilogram"
* valueQuantity.system = $UCUM
* valueQuantity.unit = "kilogram"
* device = Reference(SmartScale)

Instance: HeightExample
InstanceOf: HeightObservation
Usage: #example
Description: "Height observation example"
Title: "Height Measurement Example"
* status = #final
* category = http://terminology.hl7.org/CodeSystem/observation-category#vital-signs
* code = $LOINC#8302-2 "Body height"
* subject = Reference(PatientExample)
* performer = Reference(PractitionerExample)
* effectiveDateTime = "2024-03-19T08:00:00Z"
* valueQuantity = 175 'cm' "centimeter"
* valueQuantity.system = $UCUM
* valueQuantity.unit = "centimeter"

Instance: BMIExample
InstanceOf: BMIObservation
Usage: #example
Description: "Body Mass Index observation example"
Title: "BMI Calculation Example"
* status = #final
* category = http://terminology.hl7.org/CodeSystem/observation-category#vital-signs
* code = $LOINC#39156-5 "Body mass index (BMI)"
* subject = Reference(PatientExample)
* performer = Reference(PractitionerExample)
* effectiveDateTime = "2024-03-19T08:00:00Z"
* valueQuantity = 23.0 'kg/m2' "kilogram per square meter"
* valueQuantity.system = $UCUM
* valueQuantity.unit = "kilogram per square meter"
* derivedFrom[0] = Reference(Observation/WeightExample)
* derivedFrom[1] = Reference(Observation/HeightExample)

Instance: BodyCompositionExample
InstanceOf: BodyCompositionObservation
Usage: #example
Description: "Body composition observation example"
Title: "Body Composition Measurement Example" 
* status = #final
* category = http://terminology.hl7.org/CodeSystem/observation-category#vital-signs
* code = $LOINC#88365-2 "Body composition panel"
* subject = Reference(PatientExample)
* performer = Reference(PractitionerExample)
* effectiveDateTime = "2024-03-19T08:00:00Z"
* device = Reference(BioimpedanceAnalyzer)

* component[bodyFat].code = $LOINC#41982-0 "Percentage body fat"
* component[bodyFat].valueQuantity = 22.5 '%' "percent"
* component[bodyFat].valueQuantity.system = $UCUM
* component[bodyFat].valueQuantity.unit = "percent"

* component[leanMass].code = $LOINC#291-7 "Lean body mass"
* component[leanMass].valueQuantity = 54.6 'kg' "kilogram"
* component[leanMass].valueQuantity.system = $UCUM
* component[leanMass].valueQuantity.unit = "kilogram"

* component[bodyWater].code = $LOINC#73708-0 "Total body water"
* component[bodyWater].valueQuantity = 39.2 'L' "liter"
* component[bodyWater].valueQuantity.system = $UCUM
* component[bodyWater].valueQuantity.unit = "liter"

* component[muscleMass].code = $LOINC#73713-0 "Muscle mass"
* component[muscleMass].valueQuantity = 51.8 'kg' "kilogram"
* component[muscleMass].valueQuantity.system = $UCUM
* component[muscleMass].valueQuantity.unit = "kilogram"

* component[boneMass].code = $LOINC#73711-4 "Bone mass"
* component[boneMass].valueQuantity = 2.8 'kg' "kilogram"
* component[boneMass].valueQuantity.system = $UCUM
* component[boneMass].valueQuantity.unit = "kilogram"

Instance: SmartScale
InstanceOf: Device
Usage: #example
Description: "Smart scale device example"
Title: "Smart Scale Device"
* deviceName.name = "Smart Body Analyzer"
* deviceName.type = #user-friendly-name
* manufacturer = "HealthTech Devices"
* modelNumber = "SBA-2024"
* type = $SCT#469576000 "Digital scale device"

Instance: BioimpedanceAnalyzer  
InstanceOf: Device
Usage: #example
Description: "Bioimpedance analyzer device example"
Title: "Bioimpedance Analyzer Device"
* deviceName.name = "Professional Body Composition Analyzer"
* deviceName.type = #user-friendly-name
* manufacturer = "MedTech Solutions"
* modelNumber = "BCA-Pro"
* type = $SCT#706767009 "Patient data recorder"



// ===== Conteúdo de: SymptomExamples.fsh =====

Instance: ChronicSymptomExample
InstanceOf: Observation
Usage: #example
Description: "Chronic symptom observation example"
* status = #final
* category = http://terminology.hl7.org/CodeSystem/observation-category#survey
* code = $SCT#267036007 "Fatigue"
* subject = Reference(Patient/PatientExample)
* performer = Reference(Practitioner/PractitionerExample)
* effectiveDateTime = "2024-03-19T14:00:00Z"
// ... resto do exemplo ...

Instance: ExampleSymptomSeverity
InstanceOf: Observation
Usage: #example
Description: "Symptom severity observation example"
* status = #final
* category = http://terminology.hl7.org/CodeSystem/observation-category#survey
* code = $SCT#246604007 "Symptom severity"
* subject = Reference(Patient/PatientExample)
* performer = Reference(Practitioner/PractitionerExample)
* effectiveDateTime = "2024-03-19T10:30:00Z"
// ... resto do exemplo ...



// ===== Conteúdo de: SocialInteractionExamples.fsh =====

Instance: SocialInteractionExample
InstanceOf: SocialInteractionProfile
Usage: #example
Description: "Social interaction observation example"
Title: "Social Interaction Example"

* status = #final
* category = http://terminology.hl7.org/CodeSystem/observation-category#social-history
* code = $LOINC#96766-1 "Social interaction pattern"
* subject = Reference(Patient/PatientExample)
* effectiveDateTime = "2024-01-03T14:00:00Z"
* valueCodeableConcept = SocialInteractionTypeCS#family

* component[duration].valueQuantity = 120 'min' "minutes"
* component[quality].valueCodeableConcept = SocialInteractionQualityCS#meaningful
* component[medium].valueCodeableConcept = SocialInteractionMediumCS#inPerson
* component[participants].valueInteger = 4

* extension[context].valueCodeableConcept = SocialContextCS#home
* extension[support].valueCodeableConcept = SocialSupportCS#strong
* extension[activity].valueCodeableConcept = SocialActivityCS#meal



// ===== Conteúdo de: VitalSignsExamples.fsh =====

Instance: HeartRateExample
InstanceOf: HeartRateObservation
Usage: #example
Description: "Heart rate observation example"
Title: "Heart Rate Measurement Example"
* status = #final
* code = $LOINC#8867-4 "Heart rate"
* subject = Reference(PatientExample)
* effectiveDateTime = "2024-03-19T15:30:00Z"
* valueQuantity = 72 '/min' "per minute"
* valueQuantity.system = $UCUM
* valueQuantity.unit = "per minute"
* device = Reference(DeviceHeartRateMonitor)
* performer = Reference(PractitionerExample)
* component[heartRateVariability].code = $LOINC#80404-7 "R-R interval.standard deviation (Heart rate variability)"
* component[heartRateVariability].valueQuantity = 45 'ms' "millisecond"
* component[heartRateVariability].valueQuantity.system = $UCUM
* component[heartRateVariability].valueQuantity.unit = "millisecond"

Instance: BloodPressureExample
InstanceOf: BloodPressureObservation
Usage: #example
Description: "Blood pressure observation example"
Title: "Blood Pressure Measurement Example"
* status = #final
* code = $LOINC#85354-9 "Blood pressure panel with all children optional"
* subject = Reference(PatientExample)
* effectiveDateTime = "2024-03-19T15:30:00Z"
* device = Reference(DeviceBloodPressureMonitor)
* performer = Reference(PractitionerExample)
* component[systolic].code = $LOINC#8480-6 "Systolic blood pressure"
* component[systolic].valueQuantity = 120 'mm[Hg]' "millimeter of mercury"
* component[systolic].valueQuantity.system = $UCUM
* component[systolic].valueQuantity.unit = "millimeter of mercury"
* component[diastolic].code = $LOINC#8462-4 "Diastolic blood pressure"
* component[diastolic].valueQuantity = 80 'mm[Hg]' "millimeter of mercury"
* component[diastolic].valueQuantity.system = $UCUM
* component[diastolic].valueQuantity.unit = "millimeter of mercury"

Instance: DeviceHeartRateMonitor
InstanceOf: Device
Usage: #example
Description: "Heart rate monitor device example"
Title: "Heart Rate Monitor Device"
* deviceName.name = "Continuous Heart Rate Monitor"
* deviceName.type = #user-friendly-name
* manufacturer = "HealthTech Devices"
* modelNumber = "HRM-2024"
* type = $SCT#720737000 "Pulse rate monitoring device"

Instance: DeviceBloodPressureMonitor
InstanceOf: Device
Usage: #example
Description: "Blood pressure monitor device example"
Title: "Blood Pressure Monitor Device"
* deviceName.name = "Digital Blood Pressure Monitor"
* deviceName.type = #user-friendly-name
* manufacturer = "HealthTech Devices"
* modelNumber = "BPM-2024"
* type = $SCT#43770009 "Blood pressure monitor"



// ===== Conteúdo de: PractitionerExample.fsh =====

Instance: PractitionerExample
InstanceOf: Practitioner
Usage: #example
Description: "Practitioner resource example"
* identifier[0].system = "http://terminology.hl7.org/CodeSystem/practitioner-identifier"
* identifier[0].value = "9941339108"
* name.given = "Jane"
* name.family = "Smith"



// ===== Conteúdo de: MindfulnessCompleteExamples.fsh =====

Instance: CompleteMindfulnessSession
InstanceOf: MindfulnessObservation
Usage: #example
Description: "Complete mindfulness session observation example"
Title: "Complete Mindfulness Session Example"

* status = #final
* code = $SCT#711415009 "Mindfulness"
* subject = Reference(Patient/PatientExample)
* effectiveDateTime = "2024-03-19T08:00:00Z"
* performer = Reference(Practitioner/PractitionerExample)

* component[sessionDuration].code = $SCT#118682006 "Duration"
* component[sessionDuration].valueQuantity = 20 'min'

* component[stressLevel].code = $SCT#725854004 "Assessment of stress level"
* component[stressLevel].valueInteger = 3

* component[moodState].code = $SCT#373931001 "Mood finding"
* component[moodState].valueCodeableConcept = $SCT#130991005 "Neutral mood"

* component[relaxationResponse].code = $SCT#276241001 "Relaxation technique"
* component[relaxationResponse].valueString = "Deep breathing exercises with progressive relaxation"

* component[mindfulnessType].code = $SCT#711415009 "Mindfulness"
* component[mindfulnessType].valueCodeableConcept = $SCT#711415009 "Mindfulness"

* extension[mindfulness-context].extension[location].valueString = "Home meditation room"
* extension[mindfulness-context].extension[environment].valueCodeableConcept = #quiet "Quiet Space"
* extension[mindfulness-context].extension[guidance].valueBoolean = true

Instance: CompleteMindfulnessResponse
InstanceOf: QuestionnaireResponse
Usage: #example
Description: "Complete mindfulness questionnaire response example"
Title: "Complete Mindfulness Session Response"

* questionnaire = "https://2rdoc.pt/fhir/Questionnaire/daily-mindfulness"
* status = #completed
* subject = Reference(Patient/PatientExample)
* authored = "2024-03-19T08:30:00Z"

* item[0]
  * linkId = "mindful_session"
  * item[0]
    * linkId = "session_duration"
    * answer.valueInteger = 20
  * item[1]
    * linkId = "practice_type"
    * answer.valueString = "Meditation"

* item[1]
  * linkId = "mood_assessment"
  * item[0]
    * linkId = "current_mood"
    * answer.valueCoding = $SCT#130991005 "Neutral mood"
  * item[1]
    * linkId = "mood_intensity"
    * answer.valueInteger = 3

* item[2]
  * linkId = "stress_assessment"
  * item[0]
    * linkId = "stress_level"
    * answer.valueInteger = 3
  * item[1]
    * linkId = "stress_symptoms"
    * answer[0].valueString = "Slight tension"

* item[3]
  * linkId = "relaxation"
  * item[0]
    * linkId = "relaxation_duration"
    * answer.valueInteger = 15
  * item[1]
    * linkId = "relaxation_technique"
    * answer.valueString = "Deep breathing"



// ===== Conteúdo de: MindfulnessExamples.fsh =====

Instance: MindfulnessObservationExample
InstanceOf: MindfulnessObservation
Usage: #example
Description: "Mindfulness observation example"
Title: "Example of Mindfulness Session Observation"

* status = #final
* code = $SCT#711415009 "Mindfulness"
* subject = Reference(Patient/PatientExample)
* effectiveDateTime = "2024-03-19T09:30:00Z"
* performer = Reference(Practitioner/PractitionerExample)

* component[sessionDuration].code = $SCT#118682006 "Duration"
* component[sessionDuration].valueQuantity = 20 'min'

* component[stressLevel].code = $SCT#725854004 "Assessment of stress level"
* component[stressLevel].valueInteger = 4

* component[moodState].code = $SCT#373931001 "Mood finding"
* component[moodState].valueCodeableConcept = $SCT#130991005 "Neutral mood"

* component[relaxationResponse].code = $SCT#276241001 "Relaxation technique"
* component[relaxationResponse].valueString = "Deep breathing exercises helped reduce tension"

* component[mindfulnessType].code = $SCT#711415009 "Mindfulness"
* component[mindfulnessType].valueCodeableConcept = $SCT#711415009 "Mindfulness"

// New example for MindfulnessQuestionnaire
Instance: MindfulnessQuestionnaireExample
InstanceOf: Questionnaire
Usage: #example
Title: "Example of Mindfulness Questionnaire"

* url = "https://2rdoc.pt/ig/ios-lifestyle-medicine/Questionnaire/mindfulness-example"
* status = #active
* title = "Daily Mindfulness Assessment"
* version = "1.0"
* name = "MindfulnessQuestionnaireExample"
* date = "2024-03-19"
* description = "Example questionnaire for daily mindfulness practice assessment"

* item[0]
  * linkId = "session_details"
  * text = "Session Details"
  * type = #group
  
  * item[0]
    * linkId = "duration"
    * text = "Duration (minutes)"
    * type = #integer
    * required = true
    
  * item[1]
    * linkId = "technique"
    * text = "Technique Used"
    * type = #choice
    * required = true
    * answerOption[0].valueString = "Mindful Breathing"
    * answerOption[1].valueString = "Body Scan"
    * answerOption[2].valueString = "Walking Meditation"



// ===== Conteúdo de: ReproductiveExamples.fsh =====

Instance: ExampleReproductiveActivity
InstanceOf: CarePlan
Usage: #example
Description: "Reproductive health care plan example"
* status = #active
* intent = #plan
* subject = Reference(Patient/PatientExample)
* activity.detail.kind = #ServiceRequest
* activity.detail.code = ReproductiveActivityCS#cycle-tracking
* activity.detail.status = #scheduled



// ===== Conteúdo de: MissingResources.fsh =====

// ====== Recursos Faltantes para Resolver Links Quebrados ======

Instance: example
InstanceOf: Patient
Usage: #example
* identifier.system = "http://example.org/patients"
* identifier.value = "example-patient"
* name.family = "Example"
* name.given = "Patient"
* gender = #unknown
* birthDate = "1970-01-01"

Instance: osa-practitioner-kyle-anydoc
InstanceOf: Practitioner
Usage: #example
* identifier.system = "http://example.org/practitioners"
* identifier.value = "kyle-anydoc"
* name.family = "Anydoc"
* name.given = "Kyle"
* name.prefix = "Dr."

Instance: PatientMindfulness
InstanceOf: Patient
Usage: #example
* identifier.system = "http://example.org/patients"
* identifier.value = "mindfulness-patient"
* name.family = "Mindfulness"
* name.given = "Test"
* gender = #other
* birthDate = "1980-01-01"

Instance: Org2RDoc
InstanceOf: Organization
Usage: #example
* identifier.system = "http://example.org/organizations"
* identifier.value = "2rdoc"
* name = "2RDoc Healthcare Solutions"
* active = true



// ===== Conteúdo de: MindfulnessWorkflow.fsh =====

Profile: MindfulnessSchedule
Parent: Basic
Id: mindfulness-schedule
Title: "Mindfulness Schedule"
Description: "Schedule configuration for mindfulness sessions"

* code 1..1 MS
* code = https://2rdoc.pt/fhir/CodeSystem/mindfulness-schedule-type#recurring "Recurring Schedule"

Extension: MindfulnessScheduleTiming
Id: mindfulness-schedule-timing
Title: "Mindfulness Schedule Timing"
Description: "Timing configuration for mindfulness sessions"
* value[x] only Timing

Instance: WeeklyMindfulnessSchedule
InstanceOf: MindfulnessSchedule
Title: "Weekly Mindfulness Schedule"
Description: "Example of a weekly mindfulness schedule"

* code = https://2rdoc.pt/fhir/CodeSystem/mindfulness-schedule-type#recurring "Recurring Schedule"
* extension[mindfulness-schedule-timing].valueTiming.repeat.frequency = 1
* extension[mindfulness-schedule-timing].valueTiming.repeat.period = 1
* extension[mindfulness-schedule-timing].valueTiming.repeat.periodUnit = #wk
* extension[mindfulness-schedule-timing].valueTiming.repeat.dayOfWeek = #mon
* extension[mindfulness-schedule-timing].valueTiming.repeat.dayOfWeek[+] = #wed
* extension[mindfulness-schedule-timing].valueTiming.repeat.dayOfWeek[+] = #fri



// ===== Conteúdo de: MindfulnessRules.fsh =====

RuleSet: MindfulnessValidation
* ^extension[0].url = "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice"
* ^extension[0].valueBoolean = true

* status MS
* code MS
* subject MS
* effective[x] MS
* value[x] MS
* component MS

* status from http://hl7.org/fhir/ValueSet/observation-status
* code from http://snomed.info/sct?fhir_vs=isa/711415009
* subject only Reference(Patient)
* effective[x] only dateTime

* obeys mindfulness-session-duration
* obeys mindfulness-stress-level
* obeys mindfulness-mood-required
* obeys mindfulness-context-complete
* obeys sequential-measurements

RuleSet: MindfulnessQuestionnaireValidation
* status MS
* title MS
* item MS

* status = #active
* subjectType = #Patient
* item ^slicing.discriminator.type = #pattern
* item ^slicing.discriminator.path = "linkId"
* item ^slicing.rules = #open
* item contains 
    session 0..1 MS and
    mood 0..1 MS and
    stress 0..1 MS and
    relaxation 0..1 MS

* item[session]
  * linkId = "mindful_session"
  * text = "Mindfulness Session"
  * type = #group
  * required = true
  * repeats = false

* item[mood]
  * linkId = "mood_assessment"
  * text = "Mood Assessment"
  * type = #group
  * required = true
  * repeats = false

* item[stress]
  * linkId = "stress_assessment"
  * text = "Stress Assessment"
  * type = #group
  * required = true
  * repeats = false

* item[relaxation]
  * linkId = "relaxation"
  * text = "Relaxation"
  * type = #group
  * required = true
  * repeats = false

RuleSet: MindfulnessResponseValidation
* status MS
* subject MS
* authored MS
* item MS

* status = #completed
* subject only Reference(Patient)
* authored 1..1
* item ^slicing.discriminator.type = #pattern
* item ^slicing.discriminator.path = "linkId"
* item ^slicing.rules = #open



// ===== Conteúdo de: MindfulnessMappings.fsh =====

Mapping: MindfulnessToHealthKit
Id: mindfulness-to-healthkit
Title: "Mapping to Apple HealthKit"
Source: MindfulnessObservation
Target: "http://developer.apple.com/documentation/healthkit"

* -> "HKCategoryTypeIdentifierMindfulSession" "Root mapping"
* effectiveDateTime -> "startDate and endDate" "Session timing"
* component[sessionDuration].valueQuantity -> "duration" "Session duration"

Mapping: MindfulnessToLOINC
Id: mindfulness-to-loinc
Title: "Mapping to LOINC codes"
Source: MindfulnessObservation
Target: "http://loinc.org"

* -> "89555-7" "Mindfulness safety questionnaire"
* component[stressLevel] -> "89556-5" "Stress level score"
* component[sessionDuration] -> "89557-3" "Duration of mindfulness practice"
* component[moodState] -> "89558-1" "Mood pattern"

Mapping: MindfulnessToSNOMED
Id: mindfulness-to-snomed
Title: "Mapping to SNOMED CT"
Source: MindfulnessObservation
Target: "http://snomed.info/sct"

* -> "711415009" "Meditation"
* component[stressLevel] -> "725854004" "Assessment of stress level"
* component[moodState] -> "373931001" "Mood finding"
* component[relaxationResponse] -> "276241001" "Relaxation technique"

Extension: MindfulnessImportMap
Id: mindfulness-import-map
Title: "Mindfulness Import Mapping"
Description: "Mapping instructions for importing mindfulness data"

* ^url = "https://2rdoc.pt/ig/ios-lifestyle-medicine/StructureDefinition/mindfulness-import-map"
* ^version = "1.0.0"
* ^status = #draft

* extension contains
    source 1..1 MS and
    target 1..1 MS and
    mapping 1..1 MS

* extension[source].value[x] only string
* extension[target].value[x] only string
* extension[mapping].value[x] only string

Instance: HealthKitMappingConfig
InstanceOf: MindfulnessImportMap
Usage: #inline

* extension[source].valueString = "HKCategoryTypeIdentifierMindfulSession"
* extension[target].valueString = "Observation"
* extension[mapping].valueString = "duration->component[sessionDuration].valueQuantity"



// ===== Conteúdo de: SocialInteractionMappings.fsh =====

Mapping: SocialInteractionToHealthKit
Id: social-interaction-to-healthkit
Description: "Definition for social-interaction-to-healthkit resource"Title: "Mapping to Apple HealthKit"
Source: SocialInteractionProfile
Target: "http://developer.apple.com/documentation/healthkit"

* -> "HKCategoryTypeIdentifierSocialInteraction" "Root mapping"
* valueCodeableConcept -> "interactionType" "Type of interaction"
* component[duration] -> "duration" "Duration of interaction"
* component[participants] -> "participantCount" "Number of participants"

Mapping: SocialInteractionToLOINC
Id: social-interaction-to-loinc
Title: "Mapping to LOINC codes"
Source: SocialInteractionProfile
Target: "http://loinc.org"

* -> "96766-1" "Social Interaction Panel"
* component[duration] -> "89597-9" "Interaction duration"
* component[quality] -> "89598-7" "Interaction quality"



// ===== Conteúdo de: MindfulnessDiagnosticMappings.fsh =====

Instance: MindfulnessDiagnosticMap
InstanceOf: ConceptMap
Usage: #definition
Title: "Mindfulness Diagnostic Mappings"
Description: "Mapping of mindfulness outcomes to diagnostic codes"

* status = #draft
* experimental = false
* purpose = "Map mindfulness outcomes to standard diagnostic codes"
* sourceUri = "https://2rdoc.pt/fhir/ValueSet/mindfulness-outcome-vs"
* targetUri = "http://snomed.info/sct"

* group[0].source = "https://2rdoc.pt/fhir/CodeSystem/mindfulness-outcome-cs"
* group[0].target = "http://snomed.info/sct"
* group[0].element[0]
  * code = #stressReduction
  * target[0]
    * code = #73595000
    * display = "Stress"
    * equivalence = #narrower
    * comment = "Indicates reduction in stress levels"

* group[0].element[1]
  * code = #improvedSleep
  * target[0]
    * code = #248234008
    * display = "Sleep pattern"
    * equivalence = #narrower
    * comment = "Indicates improvement in sleep quality"

* group[0].element[2]
  * code = #emotionalBalance
  * target[0]
    * code = #285854004
    * display = "Emotional state"
    * equivalence = #equivalent
    * comment = "Maps to emotional state finding"

* group[0].element[3]
  * code = #increasedAwareness
  * target[0]
    * code = #736253002
    * display = "Mental state, behavior and/or psychosocial functioning"
    * equivalence = #relatedto
    * comment = "General improvement in mental state"

RuleSet: MindfulnessDiagnosticRules
* status MS
* code MS
* subject MS
* effective[x] MS
* value[x] MS
* method MS

* method from https://2rdoc.pt/fhir/ValueSet/mindfulness-diagnostic-method-vs (required)
* code from https://2rdoc.pt/fhir/ValueSet/mindfulness-diagnostic-code-vs (required)

* extension contains 
    diagnosticCertainty 0..1 MS and
    diagnosticTiming 0..1 MS



// ===== Conteúdo de: StressMappings.fsh =====

Mapping: StressToHealthKit
Id: stress-to-healthkit
Description: "Definition for stress-to-healthkit resource"Title: "Mapping to Apple HealthKit"
Source: StressLevelProfile
Target: "http://developer.apple.com/documentation/healthkit"

* -> "HKCategoryTypeIdentifierStressLevel" "Root mapping"
* valueQuantity -> "stressLevel" "Overall stress score"
* component[physiologicalStress] -> "physiologicalStress" "Physical stress indicators"
* component[psychologicalStress] -> "mentalStress" "Mental stress indicators"

Mapping: StressToLOINC
Id: stress-to-loinc
Title: "Mapping to LOINC codes"
Source: StressLevelProfile
Target: "http://loinc.org"

* -> "89592-0" "Stress Level Panel"
* component[physiologicalStress] -> "89593-8" "Physical stress score"
* component[psychologicalStress] -> "89594-6" "Mental stress score"



// ===== Conteúdo de: BodyMetricsProfiles.fsh =====

Alias: $SCT = http://snomed.info/sct
Alias: $LOINC = http://loinc.org
Alias: $UCUM = http://unitsofmeasure.org

Profile: BodyMetricsObservation
Parent: Observation
Id: body-metrics-observation
Title: "Body Metrics Observation Profile"
Description: "Profile for body measurements from iOS Health App"

* ^version = "0.1.0"
* ^status = #draft
* ^publisher = "Open Health Manager"

* status MS
* category 1..1 MS
* category = http://terminology.hl7.org/CodeSystem/observation-category#vital-signs
* subject 1..1 MS
* effectiveDateTime 1..1 MS
* device 0..1 MS

Profile: WeightObservation
Parent: BodyMetricsObservation
Id: weight-observation  
Title: "Weight Measurement Profile"
Description: "Profile for body weight measurements"

* ^version = "0.1.0"
* ^status = #draft

* code = $LOINC#29463-7 "Body weight"
* valueQuantity only Quantity
* valueQuantity.system = $UCUM
* valueQuantity.code = #kg

Profile: HeightObservation
Parent: BodyMetricsObservation
Id: height-observation
Title: "Height Measurement Profile" 
Description: "Profile for body height measurements"

* ^version = "0.1.0"
* ^status = #draft

* code = $LOINC#8302-2 "Body height"
* valueQuantity only Quantity
* valueQuantity.system = $UCUM
* valueQuantity.code = #cm

Profile: BMIObservation
Parent: BodyMetricsObservation
Id: bmi-observation
Title: "BMI Measurement Profile"
Description: "Profile for Body Mass Index calculations"

* ^version = "0.1.0"
* ^status = #draft

* code = $LOINC#39156-5 "Body mass index (BMI)"
* valueQuantity only Quantity
* valueQuantity.system = $UCUM
* valueQuantity.code = #kg/m2

Profile: BodyCompositionObservation
Parent: BodyMetricsObservation
Id: body-composition-observation
Title: "Body Composition Profile"
Description: "Profile for body composition measurements including fat, lean mass, and other metrics"

* ^version = "0.1.0"
* ^status = #draft

* code = $LOINC#88365-2 "Body composition panel"
* component ^slicing.discriminator.type = #pattern
* component ^slicing.discriminator.path = "code"
* component ^slicing.rules = #open

* component contains
    bodyFat 0..1 MS and
    leanMass 0..1 MS and
    bodyWater 0..1 MS and
    muscleMass 0..1 MS and
    boneMass 0..1 MS

* component[bodyFat].code = $LOINC#41982-0 "Percentage body fat"
* component[bodyFat].valueQuantity.system = $UCUM
* component[bodyFat].valueQuantity.code = #%

* component[leanMass].code = $LOINC#291-7 "Lean body mass"
* component[leanMass].valueQuantity.system = $UCUM
* component[leanMass].valueQuantity.code = #kg

* component[bodyWater].code = $LOINC#73708-0 "Total body water"
* component[bodyWater].valueQuantity.system = $UCUM  
* component[bodyWater].valueQuantity.code = #L

* component[muscleMass].code = $LOINC#73713-0 "Muscle mass"
* component[muscleMass].valueQuantity.system = $UCUM
* component[muscleMass].valueQuantity.code = #kg

* component[boneMass].code = $LOINC#73711-4 "Bone mass" 
* component[boneMass].valueQuantity.system = $UCUM
* component[boneMass].valueQuantity.code = #kg



// ===== Conteúdo de: AdvancedVitalSignsProfiles.fsh =====

Alias: $SCT = http://snomed.info/sct
Alias: $LOINC = http://loinc.org
Alias: $UCUM = http://unitsofmeasure.org

Profile: AdvancedVitalSigns
Parent: Observation
Id: advanced-vital-signs
Title: "Advanced Vital Signs Profile"
Description: "Profile for advanced vital signs data from iOS Health App"

* ^version = "0.1.0"
* ^status = #draft
* ^publisher = "HL7 International"
* ^contact.name = "Advanced Vital Signs Working Group"

* status MS
* category 1..1 MS
* category = http://terminology.hl7.org/CodeSystem/observation-category#vital-signs
* code 1..1 MS
* subject 1..1 MS
* effectiveDateTime 1..1 MS
* device 0..1 MS
* method 0..1 MS
* note 0..* MS

* component ^slicing.discriminator.type = #pattern
* component ^slicing.discriminator.path = "code"
* component ^slicing.rules = #open
* component ^short = "Advanced vital signs components"
* component ^definition = "Components of advanced vital sign measurements"

* component contains
    hrvSpectral 0..1 MS and
    hrvEntropy 0..1 MS and
    meanArterialPressure 0..1 MS and
    pulseWaveAnalysis 0..1 MS and
    respiratoryVariability 0..1 MS and
    oxygenationIndex 0..1 MS and
    stressIndex 0..1 MS and
    thermalGradient 0..1 MS and
    autonomicBalance 0..1 MS and
    recoveryRate 0..1 MS and
    allostaticLoad 0..1 MS

* component[hrvSpectral].code = $LOINC#87834-8 "Heart rate variability [Frequency band]"
* component[hrvSpectral].valueQuantity.system = $UCUM
* component[hrvSpectral].valueQuantity.code = #ms
* component[hrvSpectral] ^short = "Spectral analysis of heart rate variability"

* component[hrvEntropy].code = $LOINC#87835-5 "Heart rate variability entropy"
* component[hrvEntropy].valueQuantity.system = $UCUM
* component[hrvEntropy].valueQuantity.code = #{entropy}
* component[hrvEntropy] ^short = "Sample entropy of heart rate variability"

* component[meanArterialPressure].code = $LOINC#8478-0 "Mean blood pressure"
* component[meanArterialPressure].valueQuantity.system = $UCUM
* component[meanArterialPressure].valueQuantity.code = #mmHg
* component[meanArterialPressure] ^short = "Mean arterial blood pressure"

* component[pulseWaveAnalysis].code = $LOINC#87836-3 "Pulse wave analysis"
* component[pulseWaveAnalysis].valueQuantity.system = $UCUM
* component[pulseWaveAnalysis].valueQuantity.code = #{index}
* component[pulseWaveAnalysis] ^short = "Analysis of arterial pulse wave"

* component[respiratoryVariability].code = $LOINC#87837-1 "Respiratory rate variability"
* component[respiratoryVariability].valueQuantity.system = $UCUM
* component[respiratoryVariability].valueQuantity.code = #{coefficient}
* component[respiratoryVariability] ^short = "Variability in respiratory rate"

* component[oxygenationIndex].code = $LOINC#87838-9 "Oxygenation index"
* component[oxygenationIndex].valueQuantity.system = $UCUM
* component[oxygenationIndex].valueQuantity.code = #{ratio}
* component[oxygenationIndex] ^short = "Index of blood oxygenation"

* component[stressIndex].code = $LOINC#87839-7 "Physiological stress index"
* component[stressIndex].valueQuantity.system = $UCUM
* component[stressIndex].valueQuantity.code = #{index}
* component[stressIndex] ^short = "Index of physiological stress"

* component[thermalGradient].code = $LOINC#87840-5 "Temperature gradient"
* component[thermalGradient].valueQuantity.system = $UCUM
* component[thermalGradient].valueQuantity.code = #Cel
* component[thermalGradient] ^short = "Gradient of body temperature"

* component[autonomicBalance].code = $LOINC#87841-3 "Autonomic balance index"
* component[autonomicBalance].valueQuantity.system = $UCUM
* component[autonomicBalance].valueQuantity.code = #{ratio}
* component[autonomicBalance] ^short = "Balance of autonomic nervous system"

* component[recoveryRate].code = $LOINC#87842-1 "Recovery rate index"
* component[recoveryRate].valueQuantity.system = $UCUM
* component[recoveryRate].valueQuantity.code = #{rate}
* component[recoveryRate] ^short = "Rate of physiological recovery"

* component[allostaticLoad].code = $LOINC#87843-9 "Allostatic load index"
* component[allostaticLoad].valueQuantity.system = $UCUM
* component[allostaticLoad].valueQuantity.code = #{score}
* component[allostaticLoad] ^short = "Measure of cumulative physiological burden"

Extension: AdvancedVitalSignsContext
Id: advanced-vital-signs-context
Title: "Advanced Vital Signs Context Extension"
Description: "Additional context about advanced vital sign measurements"

* value[x] only CodeableConcept
* valueCodeableConcept from AdvancedVitalSignsContextVS (required)

ValueSet: AdvancedVitalSignsContextVS
Id: advanced-vital-signs-context-vs
Title: "Advanced Vital Signs Context Value Set"
Description: "Context codes for advanced vital sign measurements"

* ^experimental = true
* codes from system AdvancedVitalSignsContextCS

CodeSystem: AdvancedVitalSignsContextCS
Id: advanced-vital-signs-context-cs
Title: "Advanced Vital Signs Context Code System"
Description: "Codes for advanced vital signs measurement context"

* ^experimental = true
* ^caseSensitive = true

* #resting "Resting state" "Measurement taken during rest"
* #active "Active state" "Measurement taken during activity"
* #recovery "Recovery state" "Measurement taken during recovery"
* #sleep "Sleep state" "Measurement taken during sleep"
* #stress "Stress state" "Measurement taken during stress"



// ===== Conteúdo de: MobilityProfiles.fsh =====

Profile: MobilityProfile
Parent: Observation
Id: mobility-profile
Title: "Mobility Profile"
Description: "Profile for mobility data from iOS Health App"

* status MS
* category 1..1 MS
* category = http://terminology.hl7.org/CodeSystem/observation-category#activity
* code 1..1 MS
* subject 1..1 MS
* effectiveDateTime 1..1 MS
* device 0..1 MS

* component ^slicing.discriminator.type = #pattern
* component ^slicing.discriminator.path = "code"
* component ^slicing.rules = #open

* component contains
    steadiness 0..1 MS and
    balance 0..1 MS and
    gait 0..1 MS and 
    movement 0..1 MS

* component[steadiness].code = $LOINC#LA32-8
* component[balance].code = $LOINC#LA32-9
* component[gait].code = $LOINC#LA29042-4
* component[movement].code = $LOINC#LA29043-2



// ===== Conteúdo de: VitalSignsProfiles.fsh =====

Alias: $SCT = http://snomed.info/sct
Alias: $LOINC = http://loinc.org
Alias: $UCUM = http://unitsofmeasure.org
Alias: $vitalsigns = http://hl7.org/fhir/StructureDefinition/vitalsigns

Profile: LifestyleVitalSigns
Parent: $vitalsigns
Id: lifestyle-vital-signs
Title: "Lifestyle Medicine Vital Signs Profile"
Description: "Profile for vital signs data from iOS Health App"

* status MS
* category 1..* MS
* subject 1..1 MS
* effectiveDateTime 1..1 MS
* code 1..1 MS
* value[x] 0..1 MS
* device 0..1 MS

Profile: HeartRateObservation
Parent: LifestyleVitalSigns
Id: heart-rate-observation
Title: "Heart Rate Observation Profile"
Description: "Profile for heart rate measurements from iOS Health App"

* code = $LOINC#8867-4 "Heart rate"
* valueQuantity only Quantity
* valueQuantity.system = $UCUM
* valueQuantity.code = #/min
* component ^slicing.discriminator.type = #pattern
* component ^slicing.discriminator.path = "code"
* component ^slicing.rules = #open

* component contains
    restingHeartRate 0..1 MS and
    exerciseHeartRate 0..1 MS and
    recoveryHeartRate 0..1 MS and
    heartRateVariability 0..1 MS

* component[heartRateVariability].code = $LOINC#80404-7 "R-R interval.standard deviation (Heart rate variability)"
* component[heartRateVariability].valueQuantity.system = $UCUM
* component[heartRateVariability].valueQuantity.code = #ms

Profile: BloodPressureObservation
Parent: LifestyleVitalSigns
Id: blood-pressure-observation
Title: "Blood Pressure Observation Profile"
Description: "Profile for blood pressure measurements from iOS Health App"

* code = $LOINC#85354-9 "Blood pressure panel with all children optional"
* component 2..2 MS
* component ^slicing.discriminator.type = #pattern
* component ^slicing.discriminator.path = "code"
* component ^slicing.rules = #closed

* component contains
    systolic 1..1 MS and
    diastolic 1..1 MS

* component[systolic].code = $LOINC#8480-6 "Systolic blood pressure"
* component[systolic].valueQuantity only Quantity
* component[systolic].valueQuantity.system = $UCUM
* component[systolic].valueQuantity.code = #mm[Hg]

* component[diastolic].code = $LOINC#8462-4 "Diastolic blood pressure"
* component[diastolic].valueQuantity only Quantity
* component[diastolic].valueQuantity.system = $UCUM
* component[diastolic].valueQuantity.code = #mm[Hg]

Profile: OxygenSaturationObservation
Parent: LifestyleVitalSigns
Id: oxygen-saturation-observation
Title: "Oxygen Saturation Observation Profile"
Description: "Profile for SpO2 measurements from iOS Health App"

* code = $LOINC#2708-6 "Oxygen saturation in Arterial blood"
* valueQuantity.system = $UCUM
* valueQuantity.code = #%



// ===== Conteúdo de: PhysicalActivityProfile.fsh =====

Alias: $LOINC = http://loinc.org
Alias: $SNOMED = http://snomed.info/sct
Alias: $UCUM = http://unitsofmeasure.org
Alias: $ActivityCodes = https://2rdoc.pt/ig/ios-lifestyle-medicine/activity-codes

Profile: PhysicalActivityObservation
Parent: Observation
Id: physical-activity-observation
Title: "Physical Activity Observation Profile"
Description: "Profile for recording physical activity data from iOS Health App"

* status MS
* category 1..1 MS
* category = http://terminology.hl7.org/CodeSystem/observation-category#activity
* code 1..1 MS
* code from PhysicalActivityTypeVS (required)
* subject 1..1 MS
* subject only Reference(Patient)
* effectiveDateTime 1..1 MS
* device 0..1 MS
* value[x] only Quantity
* component ^slicing.discriminator.type = #pattern
* component ^slicing.discriminator.path = "code"
* component ^slicing.rules = #open

* component contains
    steps 0..1 MS and
    distance 0..1 MS and
    duration 0..1 MS and
    energy 0..1 MS

* component[steps].code = $LOINC#55423-8 "Number of steps in 24 hour Measured"
* component[steps].valueQuantity only Quantity
* component[steps].valueQuantity.system = $UCUM
* component[steps].valueQuantity.code = #1 "count"

* component[distance].code = $LOINC#55430-3 "Distance walked"
* component[distance].valueQuantity only Quantity
* component[distance].valueQuantity.system = $UCUM
* component[distance].valueQuantity.code = #km "kilometer"

* component[duration].code = $LOINC#55411-3 "Exercise duration"
* component[duration].valueQuantity only Quantity
* component[duration].valueQuantity.system = $UCUM
* component[duration].valueQuantity.code = #min "minute"

* component[energy].code = $LOINC#55424-6 "Energy expenditure"
* component[energy].valueQuantity only Quantity
* component[energy].valueQuantity.system = $UCUM
* component[energy].valueQuantity.code = #kcal "kilocalorie"



// ===== Conteúdo de: ReproductiveObservation.fsh =====

Profile: ReproductiveObservation
Parent: Observation
Id: reproductive-observation
Title: "Reproductive Health Base Profile"
Description: "Base profile for reproductive health observations"

* ^version = "1.0.0"
* ^status = #active
* ^date = "2024-03-19"

* status MS
* category 1..1 MS
* category = http://terminology.hl7.org/CodeSystem/observation-category#reproductive
* code 1..1 MS
* subject 1..1 MS
* subject only Reference(Patient)
* effectiveDateTime 1..1 MS
* value[x] MS

* component ^slicing.discriminator.type = #pattern
* component ^slicing.discriminator.path = "code"
* component ^slicing.rules = #open

* component contains
    severity 0..1 MS and
    duration 0..1 MS and
    frequency 0..1 MS and
    pattern 0..1 MS

* component[severity]
  * code = $LOINC#72514-3
  * value[x] only integer
  * valueInteger 1..1 
  * valueInteger obeys rep-1

* component[duration]
  * code = $LOINC#103332-8
  * value[x] only Quantity
  * valueQuantity from DurationUnitsVS (required)

* component[frequency]
  * code = $LOINC#103334-4
  * value[x] only CodeableConcept
  * valueCodeableConcept from SymptomFrequencyVS (required)

* component[pattern]
  * code = $LOINC#103335-1
  * value[x] only CodeableConcept
  * valueCodeableConcept from SymptomProgressionVS (required)

Invariant: rep-1
Description: "Severity must be between 0 and 10"
Expression: "$this >= 0 and $this <= 10"
Severity: #error



// ===== Conteúdo de: SymptomProfiles.fsh =====

Profile: SymptomQuestionnaire
Parent: Questionnaire
Id: symptom-questionnaire
Title: "Symptom Assessment Questionnaire"
Description: "Questionnaire template for symptom assessments"

* status MS
* title MS
* item MS

* item ^slicing.discriminator.type = #pattern
* item ^slicing.discriminator.path = "linkId"
* item ^slicing.rules = #open

* item contains
    symptomType 1..1 MS and
    location 0..1 MS and
    onset 0..1 MS and
    description 0..1 MS

* item[symptomType].linkId = "symptom-type"
* item[symptomType].text = "Type of Symptom"
* item[symptomType].type = #choice
* item[symptomType].required = true

* item[location].linkId = "location"
* item[location].text = "Location"
* item[location].type = #string

* item[onset].linkId = "onset"
* item[onset].text = "When did it start?"
* item[onset].type = #dateTime

* item[description].linkId = "description"
* item[description].text = "Description"
* item[description].type = #text



// ===== Conteúdo de: ReproductiveProfiles.fsh =====

Profile: FertilityObservation
Parent: Observation
Id: fertility-observation
Title: "Fertility Observation Profile"
Description: "Profile for fertility signs and symptoms"

* status MS
* category 1..1 MS
* category = http://terminology.hl7.org/CodeSystem/observation-category#reproductive
* code = $LOINC#8669-4 "Ovulation status"
* subject 1..1 MS
* effectiveDateTime 1..1 MS

* component ^slicing.discriminator.type = #pattern
* component ^slicing.discriminator.path = "code"
* component ^slicing.rules = #open

* component contains
    cervicalMucus 0..1 MS and
    ovulationTest 0..1 MS and
    fertilityStatus 0..1 MS

* component[cervicalMucus].valueCodeableConcept from https://2rdoc.pt/fhir/ValueSet/cervical-mucus-vs (required)
* component[ovulationTest].valueCodeableConcept from https://2rdoc.pt/fhir/ValueSet/ovulation-test-vs (required)
* component[fertilityStatus].valueCodeableConcept from https://2rdoc.pt/fhir/ValueSet/fertility-status-vs (required)



// ===== Conteúdo de: MindfulnessProfiles.fsh =====

Profile: MindfulnessObservation
Parent: Observation
Id: mindfulness-observation
Title: "Mindfulness Session Observation"
Description: "Profile for recording mindfulness practice sessions and outcomes"

* status MS
* code MS
* subject MS
* effectiveDateTime MS
* performer MS
* value[x] MS
* component MS

* status = #final
* code = $SCT#711415009 "Mindfulness"
* subject only Reference(Patient)
* effectiveDateTime 1..1
* performer only Reference(Practitioner or PractitionerRole)

* component ^slicing.discriminator.type = #pattern
* component ^slicing.discriminator.path = "code"
* component ^slicing.rules = #open

* component contains
    sessionDuration 0..1 and
    stressLevel 0..1 and
    moodState 0..1 and
    relaxationResponse 0..1 and
    mindfulnessType 0..1

* component[sessionDuration]
  * code = $SCT#118682006 "Duration"
  * value[x] only Quantity
  * valueQuantity
    * value 1..1
    * unit = "min"
    * system = "http://unitsofmeasure.org"
    * code = #min

* component[stressLevel]
  * code = $SCT#725854004 "Assessment of stress level"
  * value[x] only integer
  * valueInteger
    * ^extension[0].url = "http://hl7.org/fhir/StructureDefinition/elementdefinition-minValueInteger"
    * ^extension[0].valueInteger = 0
    * ^extension[1].url = "http://hl7.org/fhir/StructureDefinition/elementdefinition-maxValueInteger"
    * ^extension[1].valueInteger = 10

* component[moodState]
  * code = $SCT#373931001 "Mood finding"
  * value[x] only CodeableConcept
  * valueCodeableConcept from https://2rdoc.pt/fhir/ValueSet/mood (required)

* component[relaxationResponse]
  * code = $SCT#276241001 "Relaxation technique"
  * value[x] only string

* component[mindfulnessType]
  * code = $SCT#711415009 "Mindfulness"
  * value[x] only CodeableConcept
  * valueCodeableConcept from https://2rdoc.pt/fhir/ValueSet/mindfulness-type (required)



// ===== Conteúdo de: SleepProfile.fsh =====

Alias: $SCT = http://snomed.info/sct
Alias: $LOINC = http://loinc.org
Alias: $UCUM = http://unitsofmeasure.org
 
Profile: SleepObservation
Parent: Observation
Id: sleep-observation
Title: "Sleep Observation Profile"
Description: "Profile for recording sleep data from iOS Health App"
 
* status MS
* category 1..1 MS
* category = http://terminology.hl7.org/CodeSystem/observation-category#sleep
* code 1..1 MS
* code = $LOINC#93832-4 "Sleep pattern panel"
* subject 1..1 MS
* subject only Reference(Patient)
* effectiveDateTime 0..1 MS
* effectivePeriod 0..1 MS
* device 0..1 MS
 
* component ^slicing.discriminator.type = #pattern
* component ^slicing.discriminator.path = "code"
* component ^slicing.rules = #open
 
* component contains
    timeInBed 1..1 MS and
    totalSleepTime 1..1 MS and
    deepSleep 0..1 MS and
    remSleep 0..1 MS and
    lightSleep 0..1 MS and
    respiratoryRate 0..1 MS and
    heartRateVariability 0..1 MS and
    interruptions 0..1 MS
 
* component[timeInBed].code = $LOINC#93831-6 "Time in bed"
* component[timeInBed].valueQuantity only Quantity
* component[timeInBed].valueQuantity.system = $UCUM
* component[timeInBed].valueQuantity.code = #min
 
* component[totalSleepTime].code = $LOINC#93833-2 "Sleep duration"
* component[totalSleepTime].valueQuantity only Quantity
* component[totalSleepTime].valueQuantity.system = $UCUM
* component[totalSleepTime].valueQuantity.code = #min
 
* component[deepSleep].code = $LOINC#93834-0 "Deep sleep duration"
* component[deepSleep].valueQuantity only Quantity
* component[deepSleep].valueQuantity.system = $UCUM
* component[deepSleep].valueQuantity.code = #min
 
* component[remSleep].code = $LOINC#93835-7 "REM sleep duration"
* component[remSleep].valueQuantity only Quantity
* component[remSleep].valueQuantity.system = $UCUM
* component[remSleep].valueQuantity.code = #min
 
* component[lightSleep].code = $LOINC#93836-5 "Light sleep duration"
* component[lightSleep].valueQuantity only Quantity
* component[lightSleep].valueQuantity.system = $UCUM
* component[lightSleep].valueQuantity.code = #min
 
* component[respiratoryRate].code = $LOINC#9279-1 "Respiratory rate"
* component[respiratoryRate].valueQuantity only Quantity
* component[respiratoryRate].valueQuantity.system = $UCUM
* component[respiratoryRate].valueQuantity.code = #/min
 
* component[heartRateVariability].code = $LOINC#80404-7 "R-R interval.standard deviation (Heart rate variability)"
* component[heartRateVariability].valueQuantity only Quantity
* component[heartRateVariability].valueQuantity.system = $UCUM
* component[heartRateVariability].valueQuantity.code = #ms
 
* component[interruptions].code = $LOINC#93837-3 "Number of awakenings during sleep"
* component[interruptions].valueQuantity only Quantity
* component[interruptions].valueQuantity.system = $UCUM
* component[interruptions].valueQuantity.code = #{count}
* extension contains SleepQuality named quality 0..1



// ===== Conteúdo de: MobilityRiskAssessment.fsh =====

Profile: MobilityRiskAssessment
Parent: RiskAssessment
Id: mobility-risk-assessment
Title: "Mobility Risk Assessment Profile"
Description: "Profile for assessing mobility-related risks"

* status MS
* subject 1..1 MS
* occurrence[x] MS
* prediction MS
  * outcome MS
  * probability[x] MS
  * qualitativeRisk MS

* method MS
  * coding ^slicing.discriminator.type = #pattern
  * coding ^slicing.discriminator.path = "$this"
  * coding ^slicing.rules = #open
  * coding contains
      mobilityAssessment 1..1 MS

* method.coding[mobilityAssessment] = https://2rdoc.pt/fhir/CodeSystem/mobility-assessment-method#standardized "Standardized Mobility Assessment"

* prediction ^slicing.discriminator.type = #pattern
* prediction ^slicing.discriminator.path = "outcome"
* prediction ^slicing.rules = #open

* prediction contains
    fallRisk 0..1 MS and
    mobilityDecline 0..1 MS and
    assistanceNeeded 0..1 MS

* prediction[fallRisk].outcome from https://2rdoc.pt/fhir/ValueSet/fall-risk-outcomes
* prediction[fallRisk].probabilityDecimal 0..1 MS
* prediction[fallRisk].qualitativeRisk from https://2rdoc.pt/fhir/ValueSet/risk-level

* prediction[mobilityDecline].outcome from https://2rdoc.pt/fhir/ValueSet/mobility-decline-outcomes
* prediction[mobilityDecline].probabilityDecimal 0..1 MS
* prediction[mobilityDecline].qualitativeRisk from https://2rdoc.pt/fhir/ValueSet/risk-level

* prediction[assistanceNeeded].outcome from https://2rdoc.pt/fhir/ValueSet/assistance-level-outcomes
* prediction[assistanceNeeded].probabilityDecimal 0..1 MS
* prediction[assistanceNeeded].qualitativeRisk from https://2rdoc.pt/fhir/ValueSet/risk-level

* basis only Reference(MobilityProfile or Observation or QuestionnaireResponse)
* basis MS

* note MS



// ===== Conteúdo de: EnvironmentalProfiles.fsh =====

Alias: $SCT = http://snomed.info/sct
Alias: $LOINC = http://loinc.org
Alias: $UCUM = http://unitsofmeasure.org

Profile: EnvironmentalObservation
Parent: Observation
Id: environmental-observation
Title: "Environmental Observation Profile"
Description: "Base profile for environmental measurements from iOS Health App"

* ^version = "0.1.0"
* ^status = #draft
* ^publisher = "HL7 International"
* ^contact.name = "Environmental Health Working Group"

* status MS
* category 1..1 MS
* category = http://terminology.hl7.org/CodeSystem/observation-category#environment
* subject 1..1 MS
* effectiveDateTime 1..1 MS
* device 0..1 MS
* method 0..1 MS
* note 0..* MS

Profile: NoiseExposureObservation
Parent: EnvironmentalObservation
Id: noise-exposure-observation
Title: "Noise Exposure Observation Profile"
Description: "Profile for noise exposure measurements from iOS Health App"

* code = $LOINC#28573-7 "Noise exposure time"
* component ^slicing.discriminator.type = #pattern
* component ^slicing.discriminator.path = "code"
* component ^slicing.rules = #open
* component ^short = "Noise exposure components"
* component ^definition = "Components of noise exposure measurement"

* component contains
    level 1..1 MS and
    duration 1..1 MS and
    peakLevel 0..1 MS and
    backgroundNoise 0..1 MS

* component[level].code = $LOINC#89020-2 "Environmental noise average"
* component[level].valueQuantity.system = $UCUM
* component[level].valueQuantity.code = #dB
* component[level].valueQuantity ^short = "Noise level in decibels"

* component[duration].code = $LOINC#89021-0 "Environmental noise duration"
* component[duration].valueQuantity.system = $UCUM
* component[duration].valueQuantity.code = #min
* component[duration].valueQuantity ^short = "Duration of exposure"

* component[peakLevel].code = $LOINC#89024-4 "Peak sound level"
* component[peakLevel].valueQuantity.system = $UCUM
* component[peakLevel].valueQuantity.code = #dB
* component[peakLevel].valueQuantity ^short = "Peak noise level"

* component[backgroundNoise].code = $LOINC#89025-1 "Background noise level"
* component[backgroundNoise].valueQuantity.system = $UCUM
* component[backgroundNoise].valueQuantity.code = #dB
* component[backgroundNoise].valueQuantity ^short = "Background noise level"

Profile: UVExposureObservation
Parent: EnvironmentalObservation
Id: uv-exposure-observation
Title: "UV Exposure Observation Profile"
Description: "Profile for UV exposure measurements from iOS Health App"

* code = $LOINC#28574-5 "UV exposure"
* component ^slicing.discriminator.type = #pattern
* component ^slicing.discriminator.path = "code"
* component ^slicing.rules = #open
* component ^short = "UV exposure components"
* component ^definition = "Components of UV exposure measurement"

* component contains
    index 1..1 MS and
    duration 1..1 MS and
    timeOfDay 0..1 MS and
    intensity 0..1 MS

* component[index].code = $LOINC#89022-8 "UV index"
* component[index].valueQuantity.system = $UCUM
* component[index].valueQuantity.code = #{index}
* component[index].valueQuantity ^short = "UV index value"

* component[duration].code = $LOINC#89023-6 "UV exposure duration"
* component[duration].valueQuantity.system = $UCUM
* component[duration].valueQuantity.code = #min
* component[duration].valueQuantity ^short = "Duration of UV exposure"

* component[timeOfDay].code = $LOINC#89026-9 "Time of exposure"
* component[timeOfDay].valueDateTime 1..1
* component[timeOfDay].valueDateTime ^short = "Time of UV exposure"

* component[intensity].code = $LOINC#89027-7 "UV intensity"
* component[intensity].valueQuantity.system = $UCUM
* component[intensity].valueQuantity.code = #W/m2
* component[intensity].valueQuantity ^short = "UV radiation intensity"

Extension: EnvironmentalContext
Id: environmental-context
Title: "Environmental Context Extension"
Description: "Additional context about environmental measurements"

* value[x] only CodeableConcept
* valueCodeableConcept from https://2rdoc.pt/fhir/ValueSet/environmental-context (required)



// ===== Conteúdo de: SocialInteractionProfile.fsh =====

Profile: SocialInteractionProfile
Parent: Observation
Id: social-interaction
Title: "Social Interaction Profile"
Description: "Profile for recording social interaction data from iOS Health App"

* ^version = "0.1.0"
* ^status = #active
* ^date = "2024-01-03"
* ^publisher = "FMUP HEADS2"

* status MS
* category 1..1 MS
* category = http://terminology.hl7.org/CodeSystem/observation-category#social-history
* code 1..1 MS
* code = $LOINC#96766-1 "Social interaction pattern"
* subject 1..1 MS
* effectiveDateTime 1..1 MS
* value[x] only CodeableConcept
* valueCodeableConcept from SocialInteractionTypeVS (required)

* component ^slicing.discriminator.type = #pattern
* component ^slicing.discriminator.path = "code"
* component ^slicing.rules = #open

* component contains
    duration 0..1 MS and
    quality 0..1 MS and
    medium 0..1 MS and
    participants 0..1 MS

* component[duration]
  * code = $LOINC#89597-9 "Social interaction duration"
  * valueQuantity only Quantity
  * valueQuantity.system = $UCUM
  * valueQuantity.code = #min

* component[quality]
  * code = $LOINC#89598-7 "Social interaction quality"
  * valueCodeableConcept from SocialInteractionQualityVS (required)

* component[medium]
  * code = $LOINC#89599-5 "Social interaction medium"
  * valueCodeableConcept from SocialInteractionMediumVS (required)

* component[participants]
  * code = $LOINC#89600-1 "Social interaction participants"
  * valueInteger only integer

* extension contains
    SocialContext named context 0..1 MS and
    SocialSupport named support 0..1 MS and
    SocialActivity named activity 0..* MS



// ===== Conteúdo de: StressLevelProfile.fsh =====

Profile: StressLevelProfile
Parent: Observation
Id: stress-level
Title: "Stress Level Profile"
Description: "Profile for recording stress level measurements from iOS Health App"

* ^version = "0.1.0"
* ^status = #active
* ^date = "2024-01-03"
* ^publisher = "FMUP HEADS2"

* status MS
* category 1..1 MS
* category = http://terminology.hl7.org/CodeSystem/observation-category#vital-signs
* code 1..1 MS
* code = $LOINC#89592-0 "Stress level score"
* subject 1..1 MS
* effectiveDateTime 1..1 MS
* value[x] only Quantity
* valueQuantity MS

* component ^slicing.discriminator.type = #pattern
* component ^slicing.discriminator.path = "code"
* component ^slicing.rules = #open

* component contains
    physiologicalStress 0..1 MS and
    psychologicalStress 0..1 MS and
    chronicity 0..1 MS and 
    impact 0..1 MS

* component[physiologicalStress]
  * code = $LOINC#89593-8 "Physiological stress"
  * valueQuantity only Quantity
  * valueQuantity.system = $UCUM
  * valueQuantity.code = #{score}

* component[psychologicalStress]
  * code = $LOINC#89594-6 "Psychological stress"
  * valueQuantity only Quantity
  * valueQuantity.system = $UCUM
  * valueQuantity.code = #{score}

* component[chronicity]
  * code = $LOINC#89595-3 "Stress chronicity"
  * valueCodeableConcept from StressChronicityVS (required)

* component[impact]
  * code = $LOINC#89596-1 "Stress impact"
  * valueCodeableConcept from StressImpactVS (required)

* extension contains
    MeasurementContext named context 0..1 MS and
    StressTriggers named triggers 0..* MS and 
    StressCoping named coping 0..* MS



// ===== Conteúdo de: NutritionProfiles.fsh =====

Alias: $SCT = http://snomed.info/sct
Alias: $LOINC = http://loinc.org
Alias: $UCUM = http://unitsofmeasure.org

Profile: NutritionIntakeObservation
Parent: Observation
Id: nutrition-intake-observation
Title: "Nutrition Intake Observation Profile"
Description: "Profile for nutrition intake data from iOS Health App and user input"

* ^version = "0.1.0"
* ^status = #draft
* ^publisher = "Ricardo Lourenço dos Santos"

* status MS
* category 1..1 MS
* category = http://terminology.hl7.org/CodeSystem/observation-category#nutrition
* subject 1..1 MS
* effectiveDateTime 1..1 MS
* code 1..1 MS
* method 0..1 MS

Profile: WaterIntakeObservation
Parent: NutritionIntakeObservation 
Id: water-intake-observation
Title: "Water Intake Observation Profile"
Description: "Profile for water intake measurements"

* ^version = "0.1.0"
* ^status = #draft
* ^publisher = "Ricardo Lourenço dos Santos"

* code = $LOINC#77111-4 "Water intake"
* valueQuantity only Quantity
* valueQuantity.system = $UCUM
* valueQuantity.code = #mL
* valueQuantity.unit = "milliliter"

Profile: CalorieIntakeObservation
Parent: NutritionIntakeObservation
Id: calorie-intake-observation
Title: "Calorie Intake Observation Profile"
Description: "Profile for caloric intake measurements"

* ^version = "0.1.0"
* ^status = #draft
* ^publisher = "Ricardo Lourenço dos Santos"

* code = $LOINC#9051-4 "Caloric intake total"
* valueQuantity only Quantity
* valueQuantity.system = $UCUM
* valueQuantity.code = #kcal
* valueQuantity.unit = "kilocalorie"

Profile: MacronutrientsObservation
Parent: NutritionIntakeObservation
Id: macronutrients-observation
Title: "Macronutrients Observation Profile"
Description: "Profile for macronutrient intake measurements"

* ^version = "0.1.0"
* ^status = #draft
* ^publisher = "Ricardo Lourenço dos Santos"

* code = $LOINC#LP199119-9 "Macronutrients panel"
* component ^slicing.discriminator.type = #pattern
* component ^slicing.discriminator.path = "code"
* component ^slicing.rules = #open

* component contains
    carbohydrates 0..1 MS and
    proteins 0..1 MS and
    fats 0..1 MS

* component[carbohydrates].code = $LOINC#LP35925-4 "Carbohydrates"
* component[carbohydrates].valueQuantity.system = $UCUM
* component[carbohydrates].valueQuantity.code = #g
* component[carbohydrates].valueQuantity.unit = "gram"

* component[proteins].code = $LOINC#LP35921-3 "Proteins" 
* component[proteins].valueQuantity.system = $UCUM
* component[proteins].valueQuantity.code = #g
* component[proteins].valueQuantity.unit = "gram"

* component[fats].code = $LOINC#LP35922-1 "Fats"
* component[fats].valueQuantity.system = $UCUM
* component[fats].valueQuantity.code = #g
* component[fats].valueQuantity.unit = "gram"



// ===== Conteúdo de: MultiJurisdictionalConsent.fsh =====

// ====== Perfil Multi-Jurisdicional de Consent ======

Profile: MultiJurisdictionalConsent
Parent: Consent
Id: multi-jurisdictional-consent
Title: "Multi-Jurisdictional Healthcare Consent"
Description: "Consent profile supporting GDPR, HIPAA, and LGPD compliance"

* status MS
* scope MS
* category MS
* patient 1..1 MS
* dateTime 1..1 MS

// Múltiplas políticas para diferentes jurisdições
* policy 1..* MS
* policy ^slicing.discriminator.type = #value
* policy ^slicing.discriminator.path = "authority"
* policy ^slicing.rules = #open

* policy contains
    gdpr 0..1 MS and
    hipaa 0..1 MS and
    lgpd 0..1 MS

* policy[gdpr].authority = "https://eur-lex.europa.eu/eli/reg/2016/679/oj"
* policy[gdpr].uri 1..1 MS

* policy[hipaa].authority = "https://www.hhs.gov/hipaa/index.html"  
* policy[hipaa].uri 1..1 MS

* policy[lgpd].authority = "http://www.planalto.gov.br/ccivil_03/_ato2015-2018/2018/lei/L13709compilado.htm"
* policy[lgpd].uri 1..1 MS

// Extensões de compliance
* extension contains
    RegulatoryBasis named regulatoryBasis 0..* MS and
    JurisdictionApplicability named jurisdiction 0..* MS and
    DataLocalization named dataLocalization 0..* MS

// Provisions com segurança
* provision MS
* provision.type MS
* provision.period MS
* provision.actor MS
* provision.action MS
* provision.securityLabel MS
* provision.purpose MS
* provision.dataPeriod MS



// ===== Conteúdo de: MindfulnessMessaging.fsh =====

Alias: $MsgEvents = https://2rdoc.pt/fhir/CodeSystem/mindfulness-message-events
Alias: $MsgTypes = http://terminology.hl7.org/CodeSystem/message-type

Profile: MindfulnessMessageDefinition
Parent: MessageDefinition
Id: mindfulness-message-definition
Title: "Mindfulness Message Definition" 
Description: "Definition for mindfulness session messages"

* url 1..1 MS
* date 1..1 MS
* status 1..1 MS
* event[x] 1..1 MS
* category 0..1 MS
* focus 1..* MS
* focus.min 1..1

Instance: StartSessionMessage
InstanceOf: MindfulnessMessageDefinition
Title: "Start Session Message"
Description: "Message definition for starting a mindfulness session"

* url = "https://2rdoc.pt/ig/ios-lifestyle-medicine/MessageDefinition/start-session"
* date = "2024-03-19"
* status = #active
* eventCoding = $MsgEvents#session-start "Session Start"
* category = #notification
* focus.code = #Observation
* focus.min = 1
* focus.profile = "https://2rdoc.pt/ig/ios-lifestyle-medicine/StructureDefinition/mindfulness-session"

Instance: EndSessionMessage  
InstanceOf: MindfulnessMessageDefinition
Title: "End Session Message"
Description: "Message definition for ending a mindfulness session"

* url = "https://2rdoc.pt/ig/ios-lifestyle-medicine/MessageDefinition/end-session"
* date = "2024-03-19"
* status = #active
* eventCoding = $MsgEvents#session-end "Session End"
* category = #notification
* focus.code = #Observation
* focus.min = 1
* focus.profile = "https://2rdoc.pt/ig/ios-lifestyle-medicine/StructureDefinition/mindfulness-session"



// ===== Conteúdo de: PractitionerNamingSystem.fsh =====

// ====== CodeSystem para Identificadores de Practitioners ======

CodeSystem: PractitionerIdentifierCS
Id: practitioner-identifier-cs
Title: "Practitioner Identifier Code System"
Description: "Sistema de códigos para identificação de practitioners"
* ^status = #active
* ^experimental = false
* ^caseSensitive = true
* #npi "National Provider Identifier" "US National Provider Identifier"
* #crm "Conselho Regional de Medicina" "Brazilian Medical Council Registration"
* #ssin "Social Security Identification Number" "Belgian SSIN"
* #rpps "Répertoire Partagé des Professionnels de Santé" "French Healthcare Professional Registry"

ValueSet: PractitionerIdentifierVS
Id: practitioner-identifier-vs
Title: "Practitioner Identifier Value Set"
Description: "Value set para identificadores de practitioners"
* ^status = #active
* ^experimental = false
* include codes from system PractitionerIdentifierCS



// ===== Conteúdo de: MindfulnessReports.fsh =====

Instance: MindfulnessProgressReport
InstanceOf: Measure
Usage: #definition
Title: "Mindfulness Practice Progress Report"
Description: "Example instance of MindfulnessProgressReport"
* status = #active
* experimental = false
* date = "2024-03-19"
* publisher = "Example Organization"
* description = "Measures progress in mindfulness practice over time"

* scoring = #continuous-variable
* type = #process
* riskAdjustment = "none"
* rateAggregation = "Average values over time period"

* group[0]
  * code = #practice-frequency
  * description = "Frequency of mindfulness practice"
  * population[0]
    * code = #denominator
    * criteria.language = #text/fhirpath
    * criteria.expression = "Observation.where(code.coding.code='711415009')"
  * stratifier[0]
    * code = #weekly
    * criteria.language = #text/fhirpath
    * criteria.expression = "Observation.effective.as(DateTime).truncate(@T).truncate(@W)"

* group[1]
  * code = #stress-reduction
  * description = "Stress level changes over time"
  * population[0]
    * code = #denominator
    * criteria.language = #text/fhirpath
    * criteria.expression = "Observation.where(component.code.coding.code='725854004')"
  * stratifier[0]
    * code = #trend
    * criteria.language = #text/fhirpath
    * criteria.expression = "component.where(code.coding.code='725854004').value.value"

RuleSet: ReportingMetrics
* group[+]
  * code = #session-duration
  * description = "Duration of practice sessions"
  * population[0]
    * code = #denominator
    * criteria.language = #text/fhirpath
    * criteria.expression = "Observation.component.where(code.coding.code='118682006')"
  * stratifier[0]
    * code = #average
    * criteria.language = #text/fhirpath
    * criteria.expression = "component.where(code.coding.code='118682006').value.value"

* group[+]
  * code = #mood-changes
  * description = "Mood state changes"
  * population[0]
    * code = #denominator
    * criteria.language = #text/fhirpath
    * criteria.expression = "Observation.component.where(code.coding.code='373931001')"



// ===== Conteúdo de: MindfulnessCapabilities.fsh =====

Instance: MindfulnessCapabilityStatement
InstanceOf: CapabilityStatement
Usage: #definition
Title: "Mindfulness Module Capabilities"
Description: "Capabilities supported by the mindfulness module implementation"

* status = #draft
* date = "2024-03-19"
* kind = #requirements
* fhirVersion = #4.0.1
* format[0] = #json
* format[1] = #xml

* rest[0]
  * mode = #server
  * documentation = "RESTful server capabilities for mindfulness data"
  
  * resource[0]
    * type = #Observation
    * documentation = "Supports mindfulness session observations"
    * profile = "https://2rdoc.pt/ig/ios-lifestyle-medicine/StructureDefinition/mindfulness-observation"
    * interaction[0]
      * code = #read
    * interaction[1]
      * code = #create
    * interaction[2]
      * code = #update
    * interaction[3]
      * code = #search-type
    * searchParam[0]
      * name = "patient"
      * type = #reference
      * documentation = "Search by patient reference"
    * searchParam[1]
      * name = "date"
      * type = #date
      * documentation = "Search by session date"
    * searchParam[2]
      * name = "code"
      * type = #token
      * documentation = "Search by observation type"
      
  * resource[1]
    * type = #Questionnaire
    * documentation = "Supports mindfulness questionnaires"
    * profile = "https://2rdoc.pt/ig/ios-lifestyle-medicine/StructureDefinition/mindfulness-questionnaire"
    * interaction[0]
      * code = #read
    * interaction[1]
      * code = #search-type
    * searchParam[0]
      * name = "title"
      * type = #string
      * documentation = "Search by questionnaire title"
      
  * resource[2]
    * type = #QuestionnaireResponse
    * documentation = "Supports mindfulness questionnaire responses"
    * profile = "https://2rdoc.pt/ig/ios-lifestyle-medicine/StructureDefinition/mindfulness-questionnaire-response"
    * interaction[0]
      * code = #create
    * interaction[1]
      * code = #read
    * interaction[2]
      * code = #search-type
    * searchParam[0]
      * name = "patient"
      * type = #reference
      * documentation = "Search by patient reference"
    * searchParam[1]
      * name = "authored"
      * type = #date
      * documentation = "Search by response date"



// ===== Conteúdo de: MindfulnessQuestionnaires.fsh =====

Instance: DailyMindfulnessQuestionnaire
InstanceOf: Questionnaire
Usage: #definition
Title: "Daily Mindfulness Questionnaire"
Description: "Questionnaire for capturing daily mindfulness practice and associated effects"

* url = "https://2rdoc.pt/ig/ios-lifestyle-medicine/Questionnaire/daily-mindfulness"
* status = #active
* title = "Daily Mindfulness Practice"
* subjectType = #Patient
* version = "1.0.0"
* name = "DailyMindfulnessQuestionnaire"
* date = "2024-03-19"

* item[0]
  * linkId = "mindful_session"
  * text = "Mindfulness Session"
  * type = #group
  * repeats = false

  * item[0]
    * linkId = "session_duration"
    * text = "Session duration (minutes)"
    * type = #integer
    * required = true
    * extension[0].url = "http://hl7.org/fhir/StructureDefinition/minValue"
    * extension[0].valueInteger = 1

  * item[1]
    * linkId = "practice_type"
    * text = "Practice type"
    * type = #choice
    * required = true
    * answerOption[0].valueString = "Meditation"
    * answerOption[1].valueString = "Breathing exercise"
    * answerOption[2].valueString = "Body scan"
    * answerOption[3].valueString = "Mindful walking"

* item[1]
  * linkId = "mood_assessment"
  * text = "Mood Assessment"
  * type = #group

  * item[0]
    * linkId = "current_mood"
    * text = "How is your mood now?"
    * type = #choice
    * required = true
    * answerValueSet = "https://2rdoc.pt/fhir/ValueSet/mood-vs"

  * item[1]
    * linkId = "mood_intensity"
    * text = "Mood intensity (1-5)"
    * type = #integer
    * required = true

* item[2]
  * linkId = "stress_assessment"
  * text = "Stress Assessment"
  * type = #group

  * item[0]
    * linkId = "stress_level"
    * text = "Stress level (0-10)"
    * type = #integer
    * required = true

  * item[1]
    * linkId = "stress_symptoms"
    * text = "Stress symptoms"
    * type = #choice
    * repeats = true
    * answerOption[0].valueString = "Muscle tension"
    * answerOption[1].valueString = "Anxiety"
    * answerOption[2].valueString = "Headache"
    * answerOption[3].valueString = "Fatigue"

* item[3]
  * linkId = "relaxation"
  * text = "Relaxation"
  * type = #group

  * item[0]
    * linkId = "relaxation_duration"
    * text = "Relaxation time (minutes)"
    * type = #integer
    * required = true

  * item[1]
    * linkId = "relaxation_technique"
    * text = "Technique used"
    * type = #choice
    * required = true
    * answerOption[0].valueString = "Deep breathing"
    * answerOption[1].valueString = "Progressive relaxation"
    * answerOption[2].valueString = "Visualization"
    * answerOption[3].valueString = "Mindful awareness"



// ===== Conteúdo de: NutritionQuestionnaires.fsh =====

Instance: DailyNutritionQuestionnaire
InstanceOf: Questionnaire
Usage: #definition
Title: "Daily Nutrition Intake Questionnaire"
Description: "Questionnaire for daily nutrition intake tracking"

* url = "https://2rdoc.pt/ig/ios-lifestyle-medicine/Questionnaire/daily-nutrition"
* version = "0.1.0"
* name = "DailyNutritionQuestionnaire"
* title = "Daily Nutrition Intake"
* status = #active
* experimental = false
* date = "2024-12-14"
* publisher = "Ricardo Lourenço dos Santos"

* item[0]
  * linkId = "water_intake"
  * text = "How much water did you drink today?"
  * type = #quantity
  * required = true
  * repeats = false
  * initial.valueQuantity = 0 'mL'

* item[1]
  * linkId = "meal_record"
  * text = "Meal Records"
  * type = #group
  * repeats = true

  * item[0]
    * linkId = "meal_time"
    * text = "Meal Time"
    * type = #dateTime
    * required = true

  * item[1]
    * linkId = "meal_type"
    * text = "Meal Type"
    * type = #choice
    * required = true
    * answerOption[0].valueString = "Breakfast"
    * answerOption[1].valueString = "Lunch"
    * answerOption[2].valueString = "Dinner"
    * answerOption[3].valueString = "Snack"

  * item[2]
    * linkId = "calories"
    * text = "Estimated Calories"
    * type = #integer
    * required = true

  * item[3]
    * linkId = "macronutrients"
    * text = "Macronutrients"
    * type = #group

    * item[0]
      * linkId = "carbs"
      * text = "Carbohydrates (g)"
      * type = #decimal
      * required = true

    * item[1]
      * linkId = "protein"
      * text = "Proteins (g)"
      * type = #decimal
      * required = true

    * item[2]
      * linkId = "fat"
      * text = "Fats (g)"
      * type = #decimal
      * required = true

* item[2]
  * linkId = "caffeine"
  * text = "Caffeine Intake"
  * type = #group

  * item[0]
    * linkId = "caffeine_amount"
    * text = "Caffeine amount (mg)"
    * type = #integer
    * required = false

  * item[1]
    * linkId = "caffeine_source"
    * text = "Caffeine source"
    * type = #choice
    * repeats = true
    * answerOption[0].valueString = "Coffee"
    * answerOption[1].valueString = "Tea"
    * answerOption[2].valueString = "Soft Drink"
    * answerOption[3].valueString = "Energy Drink"



// ===== Conteúdo de: ReproductiveQuestionnaire.fsh =====

Instance: ReproductiveHealthQuestionnaire
InstanceOf: Questionnaire
Usage: #definition
Title: "Reproductive Health Tracking Questionnaire"
Description: "Daily questionnaire for reproductive health tracking"
 
* status = #active
* url = "https://2rdoc.pt/ig/ios-lifestyle-medicine/Questionnaire/reproductive-health"
* name = "ReproductiveHealthQuestionnaire"
* title = "Reproductive Health Monitoring"
* date = "2024-03-19"
 
* item[0]
  * linkId = "menstrual_cycle"
  * text = "Menstrual Cycle"
  * type = #group
 
  * item[0]
    * linkId = "cycle_start"
    * text = "Cycle started today?"
    * type = #boolean
 
  * item[1]
    * linkId = "flow_intensity"
    * text = "Flow intensity"
    * type = #choice
    * enableWhen
      * question = "cycle_start"
      * operator = #=
      * answerBoolean = true
    * answerOption[0].valueString = "Light"
    * answerOption[1].valueString = "Moderate"
    * answerOption[2].valueString = "Heavy"
 
* item[1]
  * linkId = "symptoms"
  * text = "Symptoms"
  * type = #group
  * repeats = true
 
  * item[0]
    * linkId = "symptom_type"
    * text = "Symptom type"
    * type = #choice
    * answerValueSet = "https://2rdoc.pt/fhir/ValueSet/reproductive-symptoms"
 
  * item[1]
    * linkId = "symptom_severity"
    * text = "Intensity (0-10)"
    * type = #integer
    * extension[0]
      * url = "http://hl7.org/fhir/StructureDefinition/minValue"
      * valueInteger = 0
    * extension[1]
      * url = "http://hl7.org/fhir/StructureDefinition/maxValue"
      * valueInteger = 10
 
* item[2]
  * linkId = "mood_changes"
  * text = "Mood Changes"
  * type = #group

  * item[0]
    * linkId = "mood_type"
    * text = "Current mood"
    * type = #choice
    * answerValueSet = "https://2rdoc.pt/fhir/ValueSet/mood-types"

  * item[1]
    * linkId = "mood_severity"
    * text = "Intensity (0-10)"
    * type = #integer
    * extension[0]
      * url = "http://hl7.org/fhir/StructureDefinition/minValue"
      * valueInteger = 0
    * extension[1]
      * url = "http://hl7.org/fhir/StructureDefinition/maxValue"
      * valueInteger = 10



// ===== Conteúdo de: aliases.fsh =====

Alias: SCT = http://snomed.info/sct
Alias: LOINC = http://loinc.org
Alias: UCUM = http://unitsofmeasure.org



// ===== Conteúdo de: MindfulnessTerminology.fsh =====

CodeSystem: MindfulnessOutcomeCS
Id: mindfulness-outcome-cs
Title: "Mindfulness Outcomes"
Description: "Outcomes and effects of mindfulness practice"

* ^experimental = false
* ^caseSensitive = true
* #increasedAwareness "Increased Awareness" "Greater awareness of thoughts and sensations"
* #improvedFocus "Improved Focus" "Enhanced ability to concentrate"
* #stressReduction "Stress Reduction" "Decreased levels of stress and tension"
* #emotionalBalance "Emotional Balance" "Better emotional regulation"
* #improvedSleep "Improved Sleep" "Enhanced sleep quality"

ValueSet: MindfulnessOutcomeVS
Id: mindfulness-outcome-vs
Title: "Mindfulness Outcomes Value Set"
Description: "Value set for mindfulness practice outcomes"

* ^experimental = false
* include codes from system MindfulnessOutcomeCS
* include $SCT#365949003 "Finding of level of stress"
* include $SCT#373931001 "Mood finding"

CodeSystem: MindfulnessQualifierCS
Id: mindfulness-qualifier-cs
Title: "Mindfulness Practice Qualifiers"
Description: "Qualifiers for mindfulness practice characteristics"

* ^experimental = false
* ^caseSensitive = true
* #guided "Guided Practice" "Practice with guidance or instruction"
* #selfDirected "Self-Directed" "Independent practice"
* #group "Group Practice" "Practice in group setting"
* #individual "Individual Practice" "Solo practice session"

ValueSet: MindfulnessQualifierVS
Id: mindfulness-qualifier-vs
Title: "Mindfulness Practice Qualifiers Value Set"
Description: "Value set for mindfulness practice qualifiers"

* ^experimental = false
* include codes from system MindfulnessQualifierCS
* include $SCT#410534003 "Guided meditation"
* include $SCT#225386006 "Exercise therapy"

* ^copyright = "This value set includes content from SNOMED CT, which is copyright © 2002+ International Health Terminology Standards Development Organisation (IHTSDO)"



// ===== Conteúdo de: MindfulnessConfig.fsh =====

Extension: MindfulnessSessionDuration
Id: mindfulness-session-duration
Title: "Mindfulness Session Duration"
Description: "Default duration for mindfulness sessions in minutes"
* value[x] only integer

Extension: MindfulnessReminderTime
Id: mindfulness-reminder-time
Title: "Mindfulness Reminder Time"
Description: "Default time for daily reminders"
* value[x] only time

Extension: MindfulnessPreferredGuide
Id: mindfulness-preferred-guide
Title: "Mindfulness Preferred Guide"
Description: "Preferred guide for mindfulness sessions"
* value[x] only string

Extension: MindfulnessNotificationEnabled
Id: mindfulness-notification-enabled
Title: "Mindfulness Notification Enabled"
Description: "Whether notifications are enabled for mindfulness sessions"
* value[x] only boolean

Profile: MindfulnessConfiguration
Parent: Basic
Id: mindfulness-configuration
Title: "Mindfulness Configuration"
Description: "Configuration settings for mindfulness sessions"

* code 1..1 MS
* code = https://2rdoc.pt/fhir/CodeSystem/mindfulness-config-type#settings "Mindfulness Settings"

* extension contains
    MindfulnessSessionDuration named sessionDuration 1..1 MS and
    MindfulnessReminderTime named reminderTime 1..1 MS and
    MindfulnessPreferredGuide named preferredGuide 0..1 MS and
    MindfulnessNotificationEnabled named notificationEnabled 1..1 MS

Instance: DefaultMindfulnessConfig
InstanceOf: MindfulnessConfiguration
Title: "Default Mindfulness Configuration"
Description: "Default configuration settings for mindfulness sessions"

* code = https://2rdoc.pt/fhir/CodeSystem/mindfulness-config-type#settings "Mindfulness Settings"
* extension[sessionDuration].valueInteger = 15
* extension[reminderTime].valueTime = "08:00:00"
* extension[preferredGuide].valueString = "Jane Smith"
* extension[notificationEnabled].valueBoolean = true



// ===== Conteúdo de: MindfulnessAuditConfig.fsh =====

Extension: MindfulnessAuditLevel
Id: mindfulness-audit-level
Title: "Mindfulness Audit Level"
Description: "Level of detail for audit records"
* value[x] only code
* valueCode from https://2rdoc.pt/fhir/ValueSet/audit-levels (required)

Extension: MindfulnessAuditRetention
Id: mindfulness-audit-retention
Title: "Mindfulness Audit Retention"
Description: "Period to retain audit records"
* value[x] only Duration

Extension: MindfulnessAuditFormat
Id: mindfulness-audit-format
Title: "Mindfulness Audit Format"
Description: "Format for audit records"
* value[x] only code
* valueCode from https://2rdoc.pt/fhir/ValueSet/audit-formats (required)

Profile: MindfulnessAuditConfig
Parent: Basic
Id: mindfulness-audit-config
Title: "Mindfulness Audit Configuration"
Description: "Configuration for mindfulness session auditing"

* code 1..1 MS
* code = https://2rdoc.pt/fhir/CodeSystem/mindfulness-config-type#audit "Audit Configuration"

* extension contains
    MindfulnessAuditLevel named auditLevel 1..1 MS and
    MindfulnessAuditRetention named auditRetention 1..1 MS and
    MindfulnessAuditFormat named auditFormat 1..1 MS

Instance: DefaultAuditConfig
InstanceOf: MindfulnessAuditConfig
Title: "Default Audit Configuration"
Description: "Default configuration for mindfulness session auditing"

* code = https://2rdoc.pt/fhir/CodeSystem/mindfulness-config-type#audit "Audit Configuration"
* extension[auditLevel].valueCode = #detailed
* extension[auditRetention].valueDuration = 90 'days'
* extension[auditFormat].valueCode = #fhir



// ===== Conteúdo de: MindfulnessSecurity.fsh =====

// ====== Mindfulness Security and Consent Resources ======

Instance: MindfulnessSecurityDefinition
InstanceOf: Consent
Usage: #example
* status = #active
* scope = $consentscope#patient-privacy "Privacy Consent"
* category[0] = $loinc#59284-0 "Patient Consent"
* patient = Reference(Patient/PatientMindfulness)
* dateTime = "2024-01-01"
* organization = Reference(Organization/Org2RDoc)
* policy[0].authority = "http://terminology.hl7.org/CodeSystem/consentpolicycodes"
* policy[0].uri = "http://terminology.hl7.org/CodeSystem/consentpolicycodes"
* provision.type = #permit
* provision.period.start = "2024-01-01"
* provision.period.end = "2025-12-31"
* provision.actor[0].role = $v3-RoleCode#TREAT "treatment"
* provision.actor[0].reference.identifier.system = "http://terminology.hl7.org/CodeSystem/practitioner-identifier"
* provision.actor[0].reference.identifier.value = "1234567890"
* provision.securityLabel[0] = $v3-Confidentiality#N "normal"
* provision.purpose[0] = $v3-ActReason#TREAT "treatment"
* provision.dataPeriod.start = "2024-01-01"
* provision.dataPeriod.end = "2025-12-31"

Instance: MindfulnessAccessPolicy
InstanceOf: Consent
Usage: #example
* status = #active
* scope = $consentscope#patient-privacy "Privacy Consent"
* category[0] = $loinc#59284-0 "Patient Consent"
* patient = Reference(Patient/PatientMindfulness)
* dateTime = "2024-01-01"
* organization = Reference(Organization/Org2RDoc)

// Políticas multi-jurisdicionais - começando do índice 0
* policy[0].authority = "http://terminology.hl7.org/CodeSystem/consentpolicycodes"
* policy[0].uri = "http://terminology.hl7.org/CodeSystem/consentpolicycodes"

// GDPR - Europa
* policy[1].authority = "https://eur-lex.europa.eu/eli/reg/2016/679/oj"
* policy[1].uri = "https://health.ec.europa.eu/ehealth-digital-health-and-care/european-health-data-space-regulation-ehds_en"

// HIPAA - Estados Unidos
* policy[2].authority = "https://www.hhs.gov/hipaa/index.html"
* policy[2].uri = "https://www.hhs.gov/hipaa/for-professionals/privacy/laws-regulations/index.html"

// LGPD - Brasil
* policy[3].authority = "http://www.planalto.gov.br/ccivil_03/_ato2015-2018/2018/lei/L13709compilado.htm"
* policy[3].uri = "https://www.gov.br/anpd/pt-br/"

* provision.type = #permit
* provision.period.start = "2024-01-01"
* provision.period.end = "2025-12-31"
* provision.actor[0].role = $v3-RoleCode#TREAT "treatment"
* provision.actor[0].reference.identifier.system = "http://terminology.hl7.org/CodeSystem/practitioner-identifier"
* provision.actor[0].reference.identifier.value = "1234567890"
* provision.action[0] = $consentaction#access "Access"
* provision.action[1] = $consentaction#use "Use"
* provision.purpose[0] = $v3-ActReason#TREAT "treatment"
* provision.purpose[1] = $v3-ActReason#HPAYMT "healthcare payment"
* provision.purpose[2] = $v3-ActReason#HOPERAT "healthcare operations"
* provision.dataPeriod.start = "2024-01-01"
* provision.dataPeriod.end = "2025-12-31"

// ====== Aliases para simplificar referências ======
Alias: $consentscope = http://terminology.hl7.org/CodeSystem/consentscope
Alias: $loinc = http://loinc.org
Alias: $v3-RoleCode = http://terminology.hl7.org/CodeSystem/v3-RoleCode
Alias: $v3-Confidentiality = http://terminology.hl7.org/CodeSystem/v3-Confidentiality
Alias: $v3-ActReason = http://terminology.hl7.org/CodeSystem/v3-ActReason
Alias: $consentaction = http://terminology.hl7.org/CodeSystem/consentaction



// ===== Conteúdo de: MindfulnessResources.fsh =====

CodeSystem: MindfulnessTypeCS
Id: mindfulness-type-cs
Title: "Mindfulness Practice Types"
Description: "Types of mindfulness practices and techniques"
* ^experimental = false
* ^caseSensitive = true
* #meditation "Meditation" "Focused meditation practice"
* #breathing "Breathing Exercise" "Conscious breathing techniques"
* #bodyScan "Body Scan" "Progressive body awareness practice"
* #walking "Mindful Walking" "Walking meditation practice"
* #movement "Mindful Movement" "Conscious movement practice"

CodeSystem: EnvironmentTypeCS
Id: environment-type-cs
Title: "Practice Environment Types"
Description: "Types of environments for mindfulness practice"
* ^experimental = false
* ^caseSensitive = true
* #indoor "Indoor" "Indoor environment"
* #outdoor "Outdoor" "Outdoor environment"
* #quiet "Quiet Space" "Quiet or silent environment"
* #group "Group Setting" "Group practice environment"

ValueSet: MindfulnessTypeVS
Id: mindfulness-type-vs
Title: "Mindfulness Practice Types Value Set"
Description: "Value set of mindfulness practice types"
* ^experimental = false
* include codes from system MindfulnessTypeCS

ValueSet: EnvironmentTypeVS
Id: environment-type-vs
Title: "Practice Environment Types Value Set"
Description: "Value set of practice environment types"
* ^experimental = false
* include codes from system EnvironmentTypeCS

Instance: MindfulnessSettingCS
InstanceOf: CodeSystem
Usage: #definition
* url = "https://2rdoc.pt/ig/ios-lifestyle-medicine/CodeSystem/mindfulness-setting"
* version = "1.0.0"
* name = "MindfulnessSettingCS"
* title = "Mindfulness Setting CodeSystem"
* status = #active
* experimental = false
* caseSensitive = true
* content = #complete
* count = 5
* concept[+].code = #home
* concept[=].display = "Home Practice"
* concept[+].code = #clinic
* concept[=].display = "Clinical Setting"
* concept[+].code = #group
* concept[=].display = "Group Setting"
* concept[+].code = #retreat
* concept[=].display = "Retreat Setting"
* concept[+].code = #workplace
* concept[=].display = "Workplace Setting"



// ===== Conteúdo de: MindfulnessNarrative.fsh =====

RuleSet: MindfulnessObservationNarrative
* text.status = #generated
* text.div = "<div xmlns=\"http://www.w3.org/1999/xhtml\">
    <p><b>Generated Narrative</b></p>
    <p><b>Session Type:</b> Mindfulness Practice Session</p>
    <p><b>Date:</b> {effectiveDateTime}</p>
    <p><b>Duration:</b> {component[sessionDuration].value} minutes</p>
    <p><b>Stress Level:</b> {component[stressLevel].value} / 10</p>
    <p><b>Mood:</b> {component[moodState].value}</p>
    <p><b>Technique:</b> {component[relaxationResponse].value}</p>
    <p><b>Location:</b> {extension[mindfulness-context].extension[location].value}</p>
  </div>"

RuleSet: MindfulnessQuestionnaireNarrative
* text.status = #generated
* text.div = "<div xmlns=\"http://www.w3.org/1999/xhtml\">
    <p><b>Generated Narrative</b></p>
    <p><b>Title:</b> {title}</p>
    <p><b>Status:</b> {status}</p>
    <h3>Sections</h3>
    <ul>
      <li>Mindfulness Session</li>
      <li>Mood Assessment</li>
      <li>Stress Assessment</li>
      <li>Relaxation</li>
    </ul>
  </div>"

RuleSet: MindfulnessResponseNarrative
* text.status = #generated
* text.div = "<div xmlns=\"http://www.w3.org/1999/xhtml\">
    <p><b>Generated Narrative</b></p>
    <p><b>Date:</b> {authored}</p>
    <p><b>Session Duration:</b> {item[session_duration].answer.value} minutes</p>
    <p><b>Practice Type:</b> {item[practice_type].answer.value}</p>
    <p><b>Mood:</b> {item[current_mood].answer.value}</p>
    <p><b>Stress Level:</b> {item[stress_level].answer.value} / 10</p>
    <p><b>Relaxation Technique:</b> {item[relaxation_technique].answer.value}</p>
  </div>"

RuleSet: MindfulnessConfigNarrative
* text.status = #generated
* text.div = "<div xmlns=\"http://www.w3.org/1999/xhtml\">
    <p><b>Generated Narrative</b></p>
    <p><b>Default Duration:</b> {extension[defaultDuration].value} minutes</p>
    <p><b>Reminders:</b> {extension[reminderSettings].value}</p>
    <p><b>Data Sync:</b> {extension[dataSync].value}</p>
  </div>"



// ===== Conteúdo de: StressInvariants.fsh =====

Invariant: stress-level-range
Description: "Stress level score must be between 0 and 10"
Expression: "valueQuantity.exists() implies (valueQuantity.value >= 0 and valueQuantity.value <= 10)"
Severity: #error

Invariant: stress-component-consistency
Description: "Physiological and psychological stress scores must be consistent with overall score"
Expression: "component.where(code.coding.code='89593-8').value.exists() and component.where(code.coding.code='89594-6').value.exists() implies (component.where(code.coding.code='89593-8').value + component.where(code.coding.code='89594-6').value) div 2 = valueQuantity"
Severity: #warning



// ===== Conteúdo de: SocialInteractionInvariants.fsh =====

Invariant: social-interaction-duration
Description: "Social interaction duration must be positive"
Expression: "component.where(code.coding.code='89597-9').value.exists() implies component.where(code.coding.code='89597-9').value > 0"
Severity: #error

Invariant: social-interaction-participants
Description: "Number of participants must be at least 2 for social interaction"
Expression: "component.where(code.coding.code='89600-1').value.exists() implies component.where(code.coding.code='89600-1').value >= 2"
Severity: #error



// ===== Conteúdo de: MindfulnessInvariants.fsh =====

Invariant: mindfulness-session-duration
Description: "Mindfulness session duration must be between 1 and 180 minutes"
Expression: "component.where(code.coding.system='http://snomed.info/sct' and code.coding.code='118682006').value.ofType(Quantity).value.exists() implies (component.where(code.coding.system='http://snomed.info/sct' and code.coding.code='118682006').value.ofType(Quantity).value >= 1 and component.where(code.coding.system='http://snomed.info/sct' and code.coding.code='118682006').value.ofType(Quantity).value <= 180)"
Severity: #error

Invariant: mindfulness-stress-level
Description: "Stress level must be between 0 and 10"
Expression: "component.where(code.coding.system='http://snomed.info/sct' and code.coding.code='725854004').value.ofType(Integer).exists() implies (component.where(code.coding.system='http://snomed.info/sct' and code.coding.code='725854004').value.ofType(Integer) >= 0 and component.where(code.coding.system='http://snomed.info/sct' and code.coding.code='725854004').value.ofType(Integer) <= 10)"
Severity: #error

Invariant: mindfulness-mood-required
Description: "Mood assessment must include a mood state and intensity"
Expression: "component.where(code.coding.system='http://snomed.info/sct' and code.coding.code='373931001').exists() implies component.where(code.coding.system='http://snomed.info/sct' and code.coding.code='373931001').value.exists()"
Severity: #warning

Invariant: mindfulness-context-complete
Description: "Mindfulness context should include location and environment"
Expression: "extension.where(url='https://2rdoc.pt/ig/ios-lifestyle-medicine/StructureDefinition/mindfulness-context').exists() implies (extension.where(url='https://2rdoc.pt/ig/ios-lifestyle-medicine/StructureDefinition/mindfulness-context').extension.where(url='location').exists() and extension.where(url='https://2rdoc.pt/ig/ios-lifestyle-medicine/StructureDefinition/mindfulness-context').extension.where(url='environment').exists())"
Severity: #warning

Invariant: sequential-measurements
Description: "Sequential measurements must have increasing effectiveDateTime"
Expression: "component.where(code.coding.system='http://snomed.info/sct' and code.coding.code='118682006').exists() implies (effectiveDateTime > previous().effectiveDateTime)"
Severity: #warning



// ===== Conteúdo de: MindfulnessOperations.fsh =====

Profile: MindfulnessOperation
Parent: OperationDefinition 
Id: mindfulness-operation
Title: "Mindfulness Operation"
Description: "Base definition for mindfulness operations"

* status 1..1
* kind 1..1
* name 1..1
* code 1..1
* resource 1..1
* system 1..1
* type 1..1
* instance 1..1
* parameter 0..*
* parameter.name 1..1

Instance: StartSessionOperation
InstanceOf: MindfulnessOperation
Title: "Start Session Operation"
Description: "Operation to start a new mindfulness session"

* status = #active
* kind = #operation
* name = "start-session"
* code = #start
* resource = #Observation
* system = false
* type = true
* instance = false
* parameter[+]
  * name = #duration
  * use = #in
  * min = 1
  * max = "1" 
  * type = #integer
  * documentation = "Duration in minutes"

Instance: EndSessionOperation
InstanceOf: MindfulnessOperation
Title: "End Session Operation"
Description: "Operation to end an ongoing mindfulness session"

* status = #active
* kind = #operation
* name = "end-session"
* code = #end
* resource = #Observation
* system = false
* type = true
* instance = true
* parameter[+]
  * name = #session
  * use = #in
  * min = 1
  * max = "1"
  * type = #string
  * documentation = "ID of the session to end"



// ===== Conteúdo de: VitalSignsExtensions.fsh =====

Extension: MeasurementContext
Id: measurement-context
Title: "Measurement Context Extension"
* ^experimental = falseDescription: "Additional context about the vital sign measurement"
* value[x] only CodeableConcept
* valueCodeableConcept from MeasurementContextVS (required)

ValueSet: MeasurementContextVitalSigns
Id: measurement-context-vital-signs
Description: "Value set for measurement context in vital signs observations"Title: "Measurement Context Value Set"
* $SCT#255214003 "At rest"
* $SCT#309604004 "During exercise"
* $SCT#309605003 "Post exercise"
* $SCT#248626006 "During sleep"



// ===== Conteúdo de: NutritionExtensions.fsh =====

Extension: NutritionDataSource
Id: nutrition-data-source
Title: "Nutrition Data Source Extension"
Description: "Indicates the source of nutrition data"

* ^version = "0.1.0"
* ^status = #draft
* ^experimental = false
* ^date = "2024-12-14"
* ^publisher = "Ricardo Lourenço dos Santos"
* ^context[0].type = #element
* ^context[0].expression = "Observation"

* value[x] only CodeableConcept
* valueCodeableConcept from NutritionDataSourceVS (required)

ValueSet: NutritionDataSourceVS
Id: nutrition-data-source-vs
Title: "Nutrition Data Source Value Set"
Description: "Value set for nutrition data sources"

* ^version = "0.1.0"
* ^status = #draft
* ^experimental = false
* ^date = "2024-12-14"
* ^publisher = "Ricardo Lourenço dos Santos"

* codes from system NutritionDataSourceCS

CodeSystem: NutritionDataSourceCS
Id: nutrition-data-source-cs
Title: "Nutrition Data Source Code System"
Description: "Code system for nutrition data sources"

* ^version = "0.1.0"
* ^status = #draft
* ^experimental = false
* ^date = "2024-12-14"
* ^publisher = "Ricardo Lourenço dos Santos"
* ^caseSensitive = true

* #manual "Manual Entry" "Data entered manually by user"
* #app "App Integration" "Data from integrated third-party apps"
* #device "Connected Device" "Data from connected nutrition tracking devices"
* #questionnaire "Questionnaire Response" "Data collected through questionnaires"



// ===== Conteúdo de: AdvancedVitalSignsExtensions.fsh =====

Alias: $UCUM = http://unitsofmeasure.org

Extension: PhysiologicalStressIndex
Id: physiological-stress-index
Title: "Physiological Stress Index Extension"
Description: "Index representing overall physiological stress based on multiple parameters"

* ^version = "0.1.0"
* ^status = #draft
* ^context[+].type = #element
* ^context[=].expression = "Observation"

* value[x] only Quantity
* valueQuantity.system = $UCUM
* valueQuantity.code = #{index}
* valueQuantity ^short = "Physiological stress index value"
* valueQuantity ^definition = "Normalized index value representing overall physiological stress"

Extension: HomeostasisIndex
Id: homeostasis-index
Title: "Homeostasis Index Extension"
Description: "Composite measure of physiological balance and adaptation"

* ^version = "0.1.0"
* ^status = #draft
* ^context[+].type = #element
* ^context[=].expression = "Observation"

* value[x] only Quantity
* valueQuantity.system = $UCUM
* valueQuantity.code = #{ratio}
* valueQuantity ^short = "Homeostasis index value"
* valueQuantity ^definition = "Normalized ratio representing physiological balance"

Extension: RecoveryEfficiency
Id: recovery-efficiency
Title: "Recovery Efficiency Extension"
Description: "Measure of how efficiently the body recovers from stress or exertion"

* ^version = "0.1.0"
* ^status = #draft
* ^context[+].type = #element
* ^context[=].expression = "Observation"

* value[x] only Quantity
* valueQuantity.system = $UCUM
* valueQuantity.code = #%
* valueQuantity ^short = "Recovery efficiency percentage"
* valueQuantity ^definition = "Percentage indicating recovery efficiency"

Extension: AllostaticLoad
Id: allostatic-load
Title: "Allostatic Load Extension"
Description: "Measure of cumulative physiological burden over time"

* ^version = "0.1.0"
* ^status = #draft
* ^context[+].type = #element
* ^context[=].expression = "Observation"

* value[x] only Quantity
* valueQuantity.system = $UCUM
* valueQuantity.code = #{score}
* valueQuantity ^short = "Allostatic load score"
* valueQuantity ^definition = "Score representing cumulative physiological burden"

Extension: CircadianPhase
Id: circadian-phase
Title: "Circadian Phase Extension"
Description: "Indicator of position in circadian rhythm cycle"

* ^version = "0.1.0"
* ^status = #draft
* ^context[+].type = #element
* ^context[=].expression = "Observation"

* value[x] only CodeableConcept
* valueCodeableConcept from CircadianPhaseVS (required)

ValueSet: CircadianPhaseVS
Id: circadian-phase-vs
Title: "Circadian Phase Value Set"
Description: "Value set for circadian rhythm phases"

* ^experimental = true
* codes from system CircadianPhaseCS

CodeSystem: CircadianPhaseCS
Id: circadian-phase-cs
Title: "Circadian Phase Code System"
Description: "Code system for circadian rhythm phases"

* ^experimental = true
* ^caseSensitive = true

* #early-morning "Early Morning Phase" "Period shortly after awakening"
* #mid-morning "Mid Morning Phase" "Mid-morning period"
* #afternoon "Afternoon Phase" "Afternoon period"
* #evening "Evening Phase" "Evening period"
* #night "Night Phase" "Nighttime period"
* #deep-night "Deep Night Phase" "Deep night period"

Extension: MeasurementQuality
Id: measurement-quality
Title: "Measurement Quality Extension"
Description: "Indicator of the quality and reliability of the measurement"

* ^version = "0.1.0"
* ^status = #draft
* ^context[+].type = #element
* ^context[=].expression = "Observation"

* value[x] only CodeableConcept
* valueCodeableConcept from MeasurementQualityVS (required)

ValueSet: MeasurementQualityVS
Id: measurement-quality-vs
Title: "Measurement Quality Value Set"
Description: "Value set for measurement quality indicators"

* ^experimental = true
* codes from system MeasurementQualityCS

CodeSystem: MeasurementQualityCS
Id: measurement-quality-cs
Title: "Measurement Quality Code System"
Description: "Code system for measurement quality indicators"

* ^experimental = true
* ^caseSensitive = true

* #excellent "Excellent Quality" "High quality measurement with minimal noise"
* #good "Good Quality" "Good quality measurement with acceptable noise"
* #fair "Fair Quality" "Fair quality measurement with some interference"
* #poor "Poor Quality" "Poor quality measurement with significant interference"
* #unreliable "Unreliable" "Unreliable measurement requiring verification"



// ===== Conteúdo de: StressExtensions.fsh =====

Extension: StressTriggers
Id: stress-triggers
Title: "Stress Triggers Extension"
* ^experimental = falseDescription: "Extension for recording identified stress triggers"
* value[x] only CodeableConcept
* valueCodeableConcept from StressTriggersVS (required)

Extension: StressCoping
Id: stress-coping
Title: "Stress Coping Extension"
* ^experimental = falseDescription: "Extension for recording stress coping mechanisms"
* value[x] only CodeableConcept
* valueCodeableConcept from StressCopingVS (required)

ValueSet: StressTriggersVS
Id: stress-triggers-vs
Title: "Stress Triggers Value Set"
* ^experimental = falseDescription: "Value set for common stress triggers"
* codes from system StressTriggersCS

ValueSet: StressCopingVS
Id: stress-coping-vs
Title: "Stress Coping Value Set"
* ^experimental = falseDescription: "Value set for stress coping mechanisms"
* codes from system StressCopingCS

CodeSystem: StressTriggersCS
Id: stress-triggers-cs
Title: "Stress Triggers Code System"
* ^experimental = falseDescription: "Code system for common stress triggers"
* #work "Work-related" "Stress from work or professional activities"
* #financial "Financial" "Financial-related stress"
* #relationships "Relationships" "Stress from personal relationships"
* #health "Health" "Health-related concerns"
* #environment "Environmental" "Environmental factors"
* #time "Time Management" "Time pressure and deadlines"
* #change "Life Changes" "Major life changes or transitions"

CodeSystem: StressCopingCS
Id: stress-coping-cs
Title: "Stress Coping Code System"
* ^experimental = falseDescription: "Code system for stress coping mechanisms"
* #exercise "Physical Exercise" "Using exercise to manage stress"
* #meditation "Meditation" "Meditation and mindfulness practices"
* #social "Social Support" "Seeking social support"
* #professional "Professional Help" "Seeking professional assistance"
* #relaxation "Relaxation" "Relaxation techniques"
* #creative "Creative Activities" "Engaging in creative activities"
* #nature "Nature" "Spending time in nature"



// ===== Conteúdo de: EnvironmentalExtensions.fsh =====

Extension: ExposureLocation
Id: exposure-location
Title: "Exposure Location Extension"
Description: "Extension for recording location of environmental exposure measurement"

* ^version = "0.1.0"
* ^status = #draft
* ^context[+].type = #element
* ^context[=].expression = "Observation"

* value[x] only CodeableConcept
* valueCodeableConcept from ExposureLocationVS (required)
* valueCodeableConcept ^short = "Location type of exposure"
* valueCodeableConcept ^definition = "Categorizes the type of location where environmental exposure occurred"

Extension: ExposureConditions
Id: exposure-conditions
Title: "Exposure Conditions Extension"
Description: "Additional conditions during environmental exposure measurement"

* ^version = "0.1.0"
* ^status = #draft
* ^context[+].type = #element
* ^context[=].expression = "Observation"

* value[x] only CodeableConcept
* valueCodeableConcept from ExposureConditionsVS (required)
* valueCodeableConcept ^short = "Conditions during exposure"

ValueSet: ExposureLocationVS
Id: exposure-location-vs
Title: "Exposure Location Value Set"
Description: "Value set for environmental exposure locations"

* ^version = "0.1.0"
* ^status = #draft
* ^experimental = true
* codes from system ExposureLocationCS

ValueSet: ExposureConditionsVS
Id: exposure-conditions-vs
Title: "Exposure Conditions Value Set"
Description: "Value set for environmental exposure conditions"

* ^version = "0.1.0"
* ^status = #draft
* ^experimental = true
* codes from system ExposureConditionsCS

CodeSystem: ExposureLocationCS
Id: exposure-location-cs
Title: "Exposure Location Code System"
Description: "Code system for environmental exposure locations"

* ^version = "0.1.0"
* ^status = #draft
* ^caseSensitive = true
* ^experimental = true

* #indoor "Indoor environment" "Environment within buildings or enclosed spaces"
* #outdoor "Outdoor environment" "Open-air environment"
* #workplace "Workplace" "Professional or occupational environment"
* #transit "In transit" "While in transportation or commuting"
* #recreational "Recreational area" "Leisure or sports facilities"
* #urban "Urban area" "City or densely populated area"
* #rural "Rural area" "Countryside or sparsely populated area"

CodeSystem: ExposureConditionsCS
Id: exposure-conditions-cs
Title: "Exposure Conditions Code System"
Description: "Code system for conditions during environmental exposure"

* ^version = "0.1.0"
* ^status = #draft
* ^caseSensitive = true
* ^experimental = true

* #normal "Normal conditions" "Standard environmental conditions"
* #extreme "Extreme conditions" "Unusual or severe environmental conditions"
* #controlled "Controlled environment" "Environment with controlled conditions"
* #variable "Variable conditions" "Changing environmental conditions"



// ===== Conteúdo de: BodyMetricsExtensions.fsh =====

Alias: $SCT = http://snomed.info/sct

Extension: MeasurementConditions
Id: measurement-conditions
Title: "Measurement Conditions Extension"
* ^experimental = falseDescription: "Records the conditions under which body measurements were taken"

* ^version = "0.1.0"
* ^status = #draft
* ^context[0].type = #element
* ^context[0].expression = "Observation"

* value[x] only CodeableConcept
* valueCodeableConcept from MeasurementConditionsVS (required)

Extension: MeasurementDevice
Id: measurement-device-type
Title: "Measurement Device Type Extension"
* ^experimental = falseDescription: "Specifies the type of device used for body measurements"

* ^version = "0.1.0"
* ^status = #draft
* ^context[0].type = #element
* ^context[0].expression = "Observation"

* value[x] only CodeableConcept
* valueCodeableConcept from MeasurementDeviceTypeVS (required)

ValueSet: MeasurementConditionsVS
Id: measurement-conditions-vs
Title: "Measurement Conditions Value Set"
* ^experimental = falseDescription: "Standard conditions under which measurements are taken"

* ^version = "0.1.0"
* ^status = #draft

* $SCT#307818003 "Pre-breakfast"
* $SCT#307819006 "Post-exercise"
* $SCT#307820000 "Wearing light clothing"
* $SCT#255203001 "First thing in morning"
* $SCT#255214005 "After void"
* $SCT#309604004 "During rest"

ValueSet: MeasurementDeviceTypeVS
Id: measurement-device-type-vs
Title: "Measurement Device Type Value Set"
* ^experimental = falseDescription: "Types of devices used for health and body measurements"

* ^version = "0.1.0"
* ^status = #draft

* $SCT#469576000 "Smart watch"
* $SCT#706767009 "Patient data recorder"
* $SCT#131009002 "Height measuring device"
* $SCT#706889009 "Blood pressure monitor"
* $SCT#444699000 "Tape measure"
* $SCT#44056008  "Digital scale"

Instance: WeightWithConditions
InstanceOf: WeightObservation
Usage: #example
Description: "Weight with conditions observation example"
Title: "Weight Measurement with Conditions Example"

* status = #final
* category = http://terminology.hl7.org/CodeSystem/observation-category#vital-signs
* code = $LOINC#29463-7 "Body weight"
* subject = Reference(Patient/example)
* effectiveDateTime = "2024-03-19T08:00:00Z"
* valueQuantity = 70.5 'kg'

* extension[measurement-conditions].url = "https://2rdoc.pt/ig/ios-lifestyle-medicine/StructureDefinition/measurement-conditions"
* extension[measurement-conditions].valueCodeableConcept = $SCT#307818003 "Pre-breakfast"

* extension[measurement-device-type].url = "https://2rdoc.pt/ig/ios-lifestyle-medicine/StructureDefinition/measurement-device-type"
* extension[measurement-device-type].valueCodeableConcept = $SCT#469576000 "Smart scale device"



// ===== Conteúdo de: SleepQuality.fsh =====

Extension: SleepQuality
Id: sleep-quality
Title: "Sleep Quality Extension"
* ^experimental = falseDescription: "Extension for recording subjective sleep quality"
* value[x] only CodeableConcept
* valueCodeableConcept from SleepQualityExtendedVS (required)
 
ValueSet: SleepQualityExtendedVS
Id: sleep-quality-extended-vs
Description: "Extended value set for sleep quality assessment"Title: "Sleep Quality Value Set"
* $SCT#248220008 "Very good quality sleep"
* $SCT#248221007 "Good quality sleep"
* $SCT#248222000 "Poor quality sleep"
* $SCT#248223005 "Very poor quality sleep"



// ===== Conteúdo de: MindfulnessExtensions.fsh =====

Extension: MindfulnessContext
Id: mindfulness-context
Title: "Mindfulness Session Context"
Description: "Additional context about the mindfulness practice session"

* ^url = "https://2rdoc.pt/ig/ios-lifestyle-medicine/StructureDefinition/mindfulness-context"
* ^version = "1.0.0"
* ^status = #draft
* ^date = "2024-03-19"
* ^publisher = "Example Organization"

* extension contains
    location 0..1 and
    environment 0..1 and
    guidance 0..1

* extension[location].value[x] only string
* extension[location].valueString 1..1
* extension[location] ^short = "Physical location of practice"
* extension[location] ^definition = "The physical location where the mindfulness practice took place"

* extension[environment].value[x] only CodeableConcept
* extension[environment].valueCodeableConcept from https://2rdoc.pt/fhir/ValueSet/environment-type (required)
* extension[environment] ^short = "Environmental conditions"
* extension[environment] ^definition = "The environmental conditions during the practice session"

* extension[guidance].value[x] only boolean
* extension[guidance].valueBoolean 1..1
* extension[guidance] ^short = "Whether guidance was used"
* extension[guidance] ^definition = "Indicates if the session was guided or self-directed"



// ===== Conteúdo de: SocialInteractionExtensions.fsh =====

Extension: SocialContext
Id: social-context
Title: "Social Context Extension"
* ^experimental = falseDescription: "Extension for recording the context of social interaction"
* value[x] only CodeableConcept
* valueCodeableConcept from SocialContextVS (required)

Extension: SocialSupport
Id: social-support
Title: "Social Support Extension"
* ^experimental = falseDescription: "Extension for recording perceived social support"
* value[x] only CodeableConcept
* valueCodeableConcept from SocialSupportVS (required)

Extension: SocialActivity
Id: social-activity
Title: "Social Activity Extension"
* ^experimental = falseDescription: "Extension for recording specific social activities"
* value[x] only CodeableConcept
* valueCodeableConcept from SocialActivityVS (required)

ValueSet: SocialContextVS
Id: social-context-vs
Title: "Social Context Value Set"
* ^experimental = falseDescription: "Value set for social interaction contexts"
* codes from system SocialContextCS

ValueSet: SocialSupportVS
Id: social-support-vs
Title: "Social Support Value Set"
* ^experimental = falseDescription: "Value set for levels of social support"
* codes from system SocialSupportCS

ValueSet: SocialActivityVS
Id: social-activity-vs
Title: "Social Activity Value Set"
* ^experimental = falseDescription: "Value set for types of social activities"
* codes from system SocialActivityCS

CodeSystem: SocialContextCS
Id: social-context-cs
Title: "Social Context Code System"
* ^experimental = falseDescription: "Code system for social interaction contexts"
* #home "Home" "Home environment"
* #work "Work" "Work environment"
* #education "Educational" "Educational setting"
* #community "Community" "Community setting"
* #recreational "Recreational" "Recreational setting"
* #healthcare "Healthcare" "Healthcare setting"

CodeSystem: SocialSupportCS
Id: social-support-cs
Title: "Social Support Code System"
* ^experimental = falseDescription: "Code system for levels of social support"
* #strong "Strong Support" "Strong social support network"
* #adequate "Adequate Support" "Sufficient social support"
* #limited "Limited Support" "Limited social support"
* #minimal "Minimal Support" "Minimal social support"
* #none "No Support" "Absence of social support"

CodeSystem: SocialActivityCS
Id: social-activity-cs
Title: "Social Activity Code System"
* ^experimental = falseDescription: "Code system for types of social activities"
* #meal "Shared Meal" "Sharing a meal together"
* #exercise "Group Exercise" "Group physical activity"
* #entertainment "Entertainment" "Shared entertainment activity"
* #learning "Learning" "Group learning activity"
* #volunteering "Volunteering" "Community service activity"
* #celebration "Celebration" "Social celebration or event"



// ===== Conteúdo de: SleepExtensions.fsh =====




// ===== Conteúdo de: ComplianceExtensions.fsh =====

// ====== Extensões de Compliance Multi-Jurisdicional ======

Extension: RegulatoryBasis
Id: regulatory-basis
Title: "Regulatory Basis for Consent"
Description: "Identifies the regulatory framework(s) that govern this consent"
* value[x] only CodeableConcept
* valueCodeableConcept from RegulatoryFrameworkVS (extensible)

Extension: JurisdictionApplicability  
Id: jurisdiction-applicability
Title: "Jurisdiction Applicability"
Description: "Specifies which jurisdictions this consent applies to"
* value[x] only CodeableConcept
* valueCodeableConcept from http://hl7.org/fhir/ValueSet/jurisdiction (extensible)

Extension: DataLocalization
Id: data-localization
Title: "Data Localization Requirements"
Description: "Specifies data localization requirements per jurisdiction"
* extension contains
    jurisdiction 1..1 MS and
    storageLocation 1..1 MS and
    residencyRequired 1..1 MS
* extension[jurisdiction].value[x] only CodeableConcept
* extension[storageLocation].value[x] only string
* extension[residencyRequired].value[x] only boolean

// ====== ValueSets de Compliance ======

ValueSet: RegulatoryFrameworkVS
Id: regulatory-framework-vs
Title: "Regulatory Framework Value Set"
Description: "Regulatory frameworks for healthcare data protection"
* ^experimental = false
* include codes from system RegulatoryFrameworkCS

CodeSystem: RegulatoryFrameworkCS
Id: regulatory-framework-cs
Title: "Regulatory Framework Code System"
Description: "Codes for healthcare regulatory frameworks"
* ^experimental = false
* ^caseSensitive = true
* #gdpr "GDPR - General Data Protection Regulation" "European Union data protection regulation"
* #hipaa "HIPAA - Health Insurance Portability and Accountability Act" "United States healthcare privacy law"
* #lgpd "LGPD - Lei Geral de Proteção de Dados" "Brazilian general data protection law"
* #pipeda "PIPEDA - Personal Information Protection and Electronic Documents Act" "Canadian privacy law"
* #ehds "EHDS - European Health Data Space" "European health data framework"



// ===== Conteúdo de: MobilityExtensions.fsh =====

Extension: MobilityAlertLevel
Id: mobility-alert-level
Title: "Mobility Alert Level Extension"
Description: "Extension for mobility measurements alert levels to indicate the severity or concern level of mobility changes detected by the device"
* ^status = #active
* ^context[0].type = #element
* ^context[0].expression = "Observation"
* . ^short = "Mobility alert level indicator"
* . ^definition = "Indicates the severity level of mobility changes or concerns based on device measurements"
* value[x] only CodeableConcept
* valueCodeableConcept from MobilityAlertLevelVS (required)
* valueCodeableConcept ^short = "Alert level code"
* valueCodeableConcept ^definition = "The specific alert level code indicating the severity of mobility changes"

ValueSet: MobilityAlertLevelVS
Id: mobility-alert-level-vs
Title: "Mobility Alert Level Value Set"
Description: "Value set for mobility measurement alert levels used to categorize the severity of mobility changes or concerns"
* ^status = #active
* ^experimental = false
* ^purpose = "To provide standardized alert levels for mobility measurements"
* codes from system MobilityAlertLevelCS

CodeSystem: MobilityAlertLevelCS
Id: mobility-alert-level-cs
Title: "Mobility Alert Level Code System"
Description: "Code system defining alert levels for mobility measurements, indicating the severity of changes in mobility patterns"
* ^status = #active
* ^experimental = false
* ^caseSensitive = true
* ^content = #complete
* #green "Normal - No concern" "Mobility measurements are within normal range and show no concerning patterns"
* #yellow "Caution - Monitor closely" "Mobility measurements show slight deviations that warrant closer monitoring"
* #red "Alert - Significant change" "Mobility measurements indicate significant changes that require immediate attention"
* ^property[0].code = #status
* ^property[0].type = #code
* ^property[0].description = "The status of the alert level"
* ^property[1].code = #severity
* ^property[1].type = #integer
* ^property[1].description = "Numeric value indicating severity (1=low, 3=high)"



// ===== Conteúdo de: ActivityExtensions.fsh =====




// ===== Conteúdo de: MobilityRiskValueSets.fsh =====

ValueSet: FallRiskOutcomesValueSet
Id: fall-risk-outcomes
Title: "Fall Risk Outcomes Value Set"
* ^experimental = falseDescription: "Value set for fall risk assessment outcomes"
* ^url = "https://2rdoc.pt/fhir/ValueSet/fall-risk-outcomes"
* ^status = #active
* include codes from system https://2rdoc.pt/fhir/CodeSystem/fall-risk-outcomes

ValueSet: RiskLevelValueSet
Id: risk-level
Title: "Risk Level Value Set"
* ^experimental = falseDescription: "Value set for general risk levels"
* ^url = "https://2rdoc.pt/fhir/ValueSet/risk-level"
* ^status = #active
* include codes from system https://2rdoc.pt/fhir/CodeSystem/risk-level

ValueSet: MobilityDeclineOutcomesValueSet
Id: mobility-decline-outcomes
Title: "Mobility Decline Outcomes Value Set"
* ^experimental = falseDescription: "Value set for mobility decline assessment outcomes"
* ^url = "https://2rdoc.pt/fhir/ValueSet/mobility-decline-outcomes"
* ^status = #active
* include codes from system https://2rdoc.pt/fhir/CodeSystem/mobility-decline-outcomes

ValueSet: AssistanceLevelOutcomesValueSet
Id: assistance-level-outcomes
Title: "Assistance Level Outcomes Value Set"
* ^experimental = falseDescription: "Value set for assistance level assessment outcomes"
* ^url = "https://2rdoc.pt/fhir/ValueSet/assistance-level-outcomes"
* ^status = #active
* include codes from system https://2rdoc.pt/fhir/CodeSystem/assistance-level-outcomes



// ===== Conteúdo de: SymptomValueSets.fsh =====

CodeSystem: SymptomSeverityCS
Id: symptom-severity-cs
Title: "Symptom Severity Code System"
* ^experimental = falseDescription: "Severity levels for symptoms"

* #1-3 "Light" "Symptom barely noticeable"
* #4-6 "Mild" "Symptom noticeable but not interfering with daily activities"
* #7-8 "Intense" "Symptom interfering with daily activities"
* #9-10 "Severe" "Symptom preventing daily activities"

ValueSet: BodyLocationsVS
Id: body-locations-vs
Title: "Body Locations Value Set"
* ^experimental = falseDescription: "Anatomical locations for symptom recording"
* $SCT#12738006 "Brain"
* $SCT#69536005 "Head"
* $SCT#45048000 "Neck"
* $SCT#51185008 "Chest"
* $SCT#62413002 "Abdomen"
* $SCT#32849002 "Back"
* $SCT#53120007 "Upper limb"
* $SCT#61685007 "Lower limb"

ValueSet: DurationUnitsVS
Id: duration-units-vs
Title: "Duration Units Value Set"
* ^experimental = falseDescription: "Time units for symptom duration"
* $UCUM#min "Minutes"
* $UCUM#h "Hours"
* $UCUM#d "Days"
* $UCUM#wk "Weeks"
* $UCUM#mo "Months"

CodeSystem: SymptomFrequencyCS
Id: symptom-frequency-cs
Title: "Symptom Frequency Code System"
* ^experimental = falseDescription: "Frequency patterns for symptoms"
* #rare "Rare" "Less than once per month"
* #occasional "Occasional" "Several times per month"
* #frequent "Frequent" "Several times per week"
* #daily "Daily" "Once or more per day"
* #constant "Constant" "Present most of the time"

ValueSet: SymptomFrequencyVS
Id: symptom-frequency-vs
Title: "Symptom Frequency Value Set"
* ^experimental = falseDescription: "Frequency patterns for symptoms"
* codes from system SymptomFrequencyCS

CodeSystem: SymptomImpactCS
Id: symptom-impact-cs
Title: "Symptom Impact Code System"
* ^experimental = falseDescription: "Impact levels of symptoms on daily activities"
* #none "No impact"
* #mild "Mild impact"
* #moderate "Moderate impact"
* #severe "Severe impact"
* #complete "Complete impact"

ValueSet: SymptomImpactVS
Id: symptom-impact-vs
Title: "Symptom Impact Value Set"
* ^experimental = falseDescription: "Impact levels for symptoms"
* codes from system SymptomImpactCS

ValueSet: SymptomProgressionVS
Id: symptom-progression-vs
Title: "Symptom Progression Value Set"
* ^experimental = falseDescription: "Progression patterns for symptoms"
* $SCT#385633008 "Improving"
* $SCT#58158008 "Stable"
* $SCT#230993007 "Worsening"
* $SCT#255314001 "Fluctuating"

ValueSet: TimeOfDayVS
Id: time-of-day-vs
Title: "Time of Day Value Set"
* ^experimental = falseDescription: "Times of day for symptom occurrence"
* $SCT#73775008 "Morning"
* $SCT#255214003 "After exercise"
* $SCT#2546009 "Evening"
* $SCT#73775008 "Morning"



// ===== Conteúdo de: StressValueSets.fsh =====

ValueSet: StressChronicityVS
Id: stress-chronicity-vs
Title: "Stress Chronicity Value Set"
* ^experimental = falseDescription: "Value set for classifying stress chronicity"
* ^url = "https://2rdoc.pt/fhir/ValueSet/stress-chronicity-vs"
* codes from system StressChronicityCS

ValueSet: StressImpactVS
Id: stress-impact-vs
Title: "Stress Impact Value Set"
* ^experimental = falseDescription: "Value set for describing stress impact levels"
* ^url = "https://2rdoc.pt/fhir/ValueSet/stress-impact-vs"
* codes from system StressImpactCS

CodeSystem: StressChronicityCS
Id: stress-chronicity-cs
Title: "Stress Chronicity Code System"
* ^experimental = falseDescription: "Code system for stress chronicity classification"
* ^url = "https://2rdoc.pt/fhir/CodeSystem/stress-chronicity-cs"
* #acute "Acute" "Short-term stress response"
* #subacute "Subacute" "Medium-term stress response"
* #chronic "Chronic" "Long-term stress response"
* #episodic "Episodic" "Recurring stress episodes"
* #persistent "Persistent" "Continuous stress state"

CodeSystem: StressImpactCS
Id: stress-impact-cs
Title: "Stress Impact Code System"
* ^experimental = falseDescription: "Code system for stress impact levels"
* ^url = "https://2rdoc.pt/fhir/CodeSystem/stress-impact-cs"
* #minimal "Minimal Impact" "Little to no interference with daily activities"
* #mild "Mild Impact" "Some interference with daily activities"
* #moderate "Moderate Impact" "Significant interference with daily activities"
* #severe "Severe Impact" "Major interference with daily activities"
* #extreme "Extreme Impact" "Unable to perform daily activities"



// ===== Conteúdo de: ReproductiveValueSets.fsh =====

ValueSet: ReproductiveGoalVS
Id: reproductive-goal-vs
Title: "Reproductive Health Goals Value Set"
Description: "Goals related to reproductive health tracking and planning"

* ^status = #active
* ^experimental = false
* ^date = "2024-03-19"

* $LOINC#8708-0 "Menstrual cycle length"
* $LOINC#55284-4 "Blood pressure"
* $LOINC#8310-5 "Body temperature"
* $LOINC#8302-2 "Body height"
* $LOINC#29463-7 "Body weight"
* $SCT#364311006 "Menstrual cycle monitoring"
* $SCT#289530006 "Reproductive health finding"

ValueSet: ReproductiveActivityVS
Id: reproductive-activity-vs
Title: "Reproductive Health Activities Value Set"
Description: "Activities related to reproductive health monitoring"

* ^status = #active
* ^experimental = false
* ^date = "2024-03-19"

* codes from system ReproductiveActivityCS

CodeSystem: ReproductiveActivityCS
Id: reproductive-activity-cs
Title: "Reproductive Health Activities Code System"
Description: "Code system for reproductive health monitoring activities"

* ^status = #active
* ^experimental = false
* ^caseSensitive = true

* #cycle-tracking "Cycle Tracking" "Track menstrual cycle dates and characteristics"
* #temp-monitoring "Temperature Monitoring" "Monitor basal body temperature"
* #symptom-tracking "Symptom Tracking" "Track reproductive health symptoms"
* #vitals-monitoring "Vitals Monitoring" "Monitor vital signs related to reproductive health"
* #fertility-signs "Fertility Signs" "Monitor fertility signs and indicators"
* #mood-tracking "Mood Tracking" "Track mood changes related to reproductive cycle"
* #medication-log "Medication Log" "Log reproductive health medications"
* #exercise-tracking "Exercise Tracking" "Track physical activity during cycle"



// ===== Conteúdo de: AuditFormatsValueSet.fsh =====

ValueSet: AuditFormatsValueSet
Id: audit-formats
Title: "Audit Formats Value Set"
Description: "Value set for audit format types"
* ^url = "https://2rdoc.pt/fhir/ValueSet/audit-formats"
* ^status = #active
* ^experimental = false
* ^date = "2024-12-27"
* include codes from system https://2rdoc.pt/fhir/CodeSystem/audit-formats

CodeSystem: AuditFormatsCodeSystem
Id: audit-formats
Title: "Audit Formats Code System"
Description: "Code system for audit format types"
* ^url = "https://2rdoc.pt/fhir/CodeSystem/audit-formats"
* ^status = #active
* ^experimental = false
* ^caseSensitive = true
* #text "Text Format"
* #structured "Structured Format"
* #mixed "Mixed Format"



// ===== Conteúdo de: MeasurementContextVS.fsh =====

ValueSet: MeasurementContextVS
Id: measurement-context-vs
Title: "Measurement Context Value Set"
Description: "Contexts in which measurements can be taken, including temporal and location-based contexts"
* ^status = #active
* ^experimental = false
* $SCT#272125009 "Assessment context value (qualifier value)"
* $SCT#307818003 "Before food"
* $SCT#307819006 "After food"
* $SCT#255214003 "After exercise"
* $SCT#264362003 "Time of day"



// ===== Conteúdo de: AuditLevelsValueSet.fsh =====

ValueSet: AuditLevelsValueSet
Id: audit-levels
Title: "Audit Levels Value Set"
Description: "Value set for audit level types"
* ^url = "https://2rdoc.pt/fhir/ValueSet/audit-levels"
* ^status = #active
* ^experimental = false
* ^date = "2024-12-27"
* include codes from system https://2rdoc.pt/fhir/CodeSystem/audit-levels

CodeSystem: AuditLevelsCodeSystem
Id: audit-levels
Title: "Audit Levels Code System"
Description: "Code system for audit level types"
* ^url = "https://2rdoc.pt/fhir/CodeSystem/audit-levels"
* ^status = #active
* ^experimental = false
* ^caseSensitive = true
* #low "Low Level"
* #medium "Medium Level"
* #high "High Level"



// ===== Conteúdo de: SocialInteractionValueSets.fsh =====

ValueSet: SocialInteractionTypeVS
Id: social-interaction-type-vs
Title: "Social Interaction Type Value Set"
* ^experimental = falseDescription: "Types of social interactions"
* codes from system SocialInteractionTypeCS

ValueSet: SocialInteractionQualityVS
Id: social-interaction-quality-vs
Title: "Social Interaction Quality Value Set"
* ^experimental = falseDescription: "Quality measures for social interactions"
* codes from system SocialInteractionQualityCS

ValueSet: SocialInteractionMediumVS
Id: social-interaction-medium-vs
Title: "Social Interaction Medium Value Set"
* ^experimental = falseDescription: "Mediums through which social interaction occurs"
* codes from system SocialInteractionMediumCS

CodeSystem: SocialInteractionTypeCS
Id: social-interaction-type-cs
Title: "Social Interaction Type Code System"
* ^experimental = falseDescription: "Types of social interactions"
* #family "Family Interaction" "Interaction with family members"
* #friends "Friend Interaction" "Interaction with friends"
* #professional "Professional Interaction" "Work-related interactions"
* #community "Community Interaction" "Community-based interactions"
* #group "Group Activity" "Organized group activities"
* #casual "Casual Interaction" "Casual social encounters"

CodeSystem: SocialInteractionQualityCS
Id: social-interaction-quality-cs
Title: "Social Interaction Quality Code System"
* ^experimental = falseDescription: "Quality measures for social interactions"
* #meaningful "Meaningful" "Deep, meaningful interaction"
* #meaningful "Meaningful" "Deep and significant interaction"
* #supportive "Supportive" "Supportive interaction"
* #meaningful "Meaningful" "Deep and significant interaction"
* #neutral "Neutral" "Neither positive nor negative"
* #meaningful "Meaningful" "Deep and significant interaction"
* #superficial "Superficial" "Surface-level interaction"
* #meaningful "Meaningful" "Deep and significant interaction"
* #stressful "Stressful" "Stressful or difficult interaction"
* #meaningful "Meaningful" "Deep and significant interaction"

CodeSystem: SocialInteractionMediumCS
Id: social-interaction-medium-cs
Title: "Social Interaction Medium Code System"
* ^experimental = falseDescription: "Mediums through which social interaction occurs"
* #inPerson "In Person" "Face-to-face interaction"
* #meaningful "Meaningful" "Deep and significant interaction"
* #video "Video Call" "Video-based interaction"
* #meaningful "Meaningful" "Deep and significant interaction"
* #voice "Voice Call" "Voice-only interaction"
* #meaningful "Meaningful" "Deep and significant interaction"
* #text "Text Based" "Text-based communication"
* #meaningful "Meaningful" "Deep and significant interaction"
* #social "Social Media" "Social media interaction"
* #meaningful "Meaningful" "Deep and significant interaction"
* #mixed "Mixed Medium" "Multiple communication methods"
* #meaningful "Meaningful" "Deep and significant interaction"



// ===== Conteúdo de: MoodValueSet.fsh =====

ValueSet: MoodValueSet
Id: mood
Title: "Mood Value Set"
Description: "Value set for mood states"
* ^url = "https://2rdoc.pt/fhir/ValueSet/mood"
* ^status = #active
* ^experimental = false

CodeSystem: MoodCodeSystem
Id: mood
Title: "Mood Code System"
Description: "Code system for mood states"
* ^url = "https://2rdoc.pt/fhir/CodeSystem/mood"
* ^status = #active
* ^caseSensitive = true
* #elevated "Elevated" "Mood is higher than normal"
* #neutral "Neutral" "Neither elevated nor depressed mood"
* #depressed "Depressed" "Mood is lower than normal"
* #anxious "Anxious" "Feeling worried or nervous"
* #irritable "Irritable" "Easily annoyed or angered"
* #calm "Calm" "Feeling peaceful and relaxed"



// ===== Conteúdo de: EnvironmentalContextVS.fsh =====

ValueSet: EnvironmentalContextValueSet
Id: environmental-context
Title: "Environmental Context Value Set"
Description: "Valid contexts for environmental measurements"

* ^status = #active
* ^experimental = false
* ^url = "https://2rdoc.pt/fhir/ValueSet/environmental-context"
* include codes from system https://2rdoc.pt/fhir/CodeSystem/environmental-context



// ===== Conteúdo de: ActivityTypeVS.fsh =====

ValueSet: PhysicalActivityTypeVS
Id: physical-activity-type-vs
Title: "Physical Activity Types Value Set"
* ^experimental = falseDescription: "Types of physical activities from iOS Health App"

* ^status = #active

* $SNOMED#255604002 "Physical activity (observable entity)"
* $SNOMED#228557008 "Walking"
* $SNOMED#229058003 "Running"
* $SNOMED#266938001 "Swimming"
* $SNOMED#266940006 "Cycling"
* $SNOMED#32147004 "Regular exercise"



// ===== Conteúdo de: MindfulnessValueSets.fsh =====

ValueSet: EnvironmentTypeValueSet
Id: environment-type
Title: "Environment Type Value Set"
* ^experimental = falseDescription: "Value set for environmental context types"
* ^url = "https://2rdoc.pt/fhir/ValueSet/environment-type"
* ^status = #active
* include codes from system https://2rdoc.pt/fhir/CodeSystem/environment-type

ValueSet: MindfulnessTypeValueSet
Id: mindfulness-type
Title: "Mindfulness Type Value Set"
* ^experimental = falseDescription: "Value set for types of mindfulness practices"
* ^url = "https://2rdoc.pt/fhir/ValueSet/mindfulness-type"
* ^status = #active
* include codes from system https://2rdoc.pt/fhir/CodeSystem/mindfulness-type



// ===== Conteúdo de: BalanceStatusValueSet.fsh =====

ValueSet: BalanceStatusValueSet
Id: balance-status
Title: "Balance Status Value Set"
Description: "Value set for walking steadiness balance status"
* ^url = "https://2rdoc.pt/fhir/ValueSet/balance-status"
* ^status = #active
* include codes from system https://2rdoc.pt/fhir/CodeSystem/balance-status

CodeSystem: BalanceStatusCodeSystem
Id: balance-status
Title: "Balance Status Code System"
Description: "Code system for balance status types"
* ^url = "https://2rdoc.pt/fhir/CodeSystem/balance-status"
* ^status = #active
* ^experimental = false
* ^caseSensitive = true
* #veryStable "Very Stable"
* #stable "Stable"
* #slightlyUnstable "Slightly Unstable"
* #unstable "Unstable"
* #veryUnstable "Very Unstable"



// ===== Conteúdo de: SleepQualityVS.fsh =====

ValueSet: SleepQualityVS
Id: sleep-quality-vs
Title: "Sleep Quality Value Set"
Description: "Qualitative assessments of sleep quality including subjective measures"
* ^status = #active
* ^experimental = false
* $SCT#248254009 "Quality of sleep (observable entity)"
* $SCT#248255005 "Sleeping well"
* $SCT#248256006 "Difficulty sleeping"
* $SCT#301345002 "Poor sleep pattern"
* $SCT#301346001 "Good sleep pattern"




// ===== Conteúdo de: FertilityValueSets.fsh =====

ValueSet: CervicalMucusValueSet
Id: cervical-mucus-valueset
Title: "Cervical Mucus Value Set"
* ^experimental = falseDescription: "Value set for cervical mucus observations"
* ^url = "https://2rdoc.pt/fhir/ValueSet/cervical-mucus-vs"
* ^status = #active
* include codes from system https://2rdoc.pt/fhir/CodeSystem/cervical-mucus-cs

CodeSystem: CervicalMucusCodeSystem
Id: cervical-mucus-cs
Description: "Code system for cervical mucus classification"Title: "Cervical Mucus Code System"
* ^url = "https://2rdoc.pt/fhir/CodeSystem/cervical-mucus-cs"
* ^status = #active
* ^caseSensitive = true
* #dry "Dry"
* #sticky "Sticky"
* #creamy "Creamy"
* #watery "Watery"
* #eggWhite "Egg White"

ValueSet: OvulationTestValueSet
Id: ovulation-test-valueset
Title: "Ovulation Test Value Set"
* ^experimental = falseDescription: "Value set for ovulation test results"
* ^url = "https://2rdoc.pt/fhir/ValueSet/ovulation-test-vs"
* ^status = #active
* include codes from system https://2rdoc.pt/fhir/CodeSystem/ovulation-test-cs

CodeSystem: OvulationTestCodeSystem
Id: ovulation-test-cs
Description: "Code system for ovulation test results"Title: "Ovulation Test Code System"
* ^url = "https://2rdoc.pt/fhir/CodeSystem/ovulation-test-cs"
* ^status = #active
* ^caseSensitive = true
* #negative "Negative"
* #positive "Positive"
* #invalid "Invalid Test"

ValueSet: FertilityStatusValueSet
Id: fertility-status-valueset
Title: "Fertility Status Value Set"
* ^experimental = falseDescription: "Value set for fertility status"
* ^url = "https://2rdoc.pt/fhir/ValueSet/fertility-status-vs"
* ^status = #active
* include codes from system https://2rdoc.pt/fhir/CodeSystem/fertility-status-cs

CodeSystem: FertilityStatusCodeSystem
Id: fertility-status-cs
Description: "Code system for fertility status indicators"Title: "Fertility Status Code System"
* ^url = "https://2rdoc.pt/fhir/CodeSystem/fertility-status-cs"
* ^status = #active
* ^caseSensitive = true
* #fertile "Fertile"
* #notFertile "Not Fertile"
* #uncertain "Uncertain"



// ===== Conteúdo de: MindfulnessSearchParameters.fsh =====

Instance: MindfulnessType
InstanceOf: SearchParameter
Description: "Example instance of MindfulnessType"Usage: #definition
* status = #active
* code = #mindfulness-type
* name = "MindfulnessType"
* description = "Search for mindfulness observations by practice type"
* base = #Observation
* type = #token
* expression = "Observation.component.where(code.coding.exists(system = 'http://snomed.info/sct' and code = '711415009')).value.as(CodeableConcept)"
* xpath = "f:Observation/f:component[f:code/f:coding[f:system/@value='http://snomed.info/sct' and f:code/f:coding/f:code/@value='711415009']]/f:valueCodeableConcept"
* xpathUsage = #normal



// ===== Conteúdo de: MindfulnessAlerts.fsh =====

Extension: AlertTiming
Id: alert-timing
Title: "Alert Timing Extension"
Description: "Defines when alerts should be triggered"
* value[x] only Timing
* valueTiming.repeat 1..1 MS
* valueTiming.repeat.frequency MS
* valueTiming.repeat.period MS
* valueTiming.repeat.periodUnit MS

Extension: AlertMessage
Id: alert-message
Title: "Alert Message Extension"
Description: "Defines the alert message content"
* value[x] only string

Profile: MindfulnessAlert
Parent: Basic
Id: mindfulness-alert
Title: "Mindfulness Alert"
Description: "Alert configuration for mindfulness sessions"

* code 1..1 MS
* code = https://2rdoc.pt/fhir/CodeSystem/mindfulness-alert-type#reminder "Mindfulness Reminder"

* extension contains
    alert-timing named alertTiming 0..1 MS and
    alert-message named alertMessage 1..1 MS

Instance: DailyMindfulnessAlert
InstanceOf: MindfulnessAlert
Title: "Daily Mindfulness Alert" 
Description: "Example of a daily mindfulness alert configuration"

* code = https://2rdoc.pt/fhir/CodeSystem/mindfulness-alert-type#reminder "Mindfulness Reminder"
* extension[alertTiming].valueTiming.repeat
  * frequency = 1
  * period = 1
  * periodUnit = #d
* extension[alertMessage].valueString = "Time for your daily mindfulness practice"



// ===== Conteúdo de: MindfulnessTransforms.fsh =====

Instance: MindfulnessHealthKitTransform
InstanceOf: StructureMap
Usage: #definition
Title: "HealthKit to FHIR Mindfulness Transform"

* status = #draft
* name = "MindfulnessHealthKitTransform"
* structure[0]
  * url = "https://2rdoc.pt/ig/ios-lifestyle-medicine/StructureDefinition/healthkit-mindfulness"
  * mode = #source
  * documentation = "HealthKit mindfulness session structure"

* structure[1]
  * url = "http://hl7.org/fhir/StructureDefinition/Observation"
  * mode = #target
  * documentation = "FHIR Observation resource"

* group[0]
  * name = "MindfulnessSessionToObservation"
  * typeMode = #none
  * input[0]
    * name = "source"
    * type = "HealthKitMindfulness"
    * mode = #source
  * input[1]
    * name = "target"
    * type = "Observation"
    * mode = #target
  * rule[0]
    * name = "Session"
    * source[0]
      * context = "source"
      * element = "startDate"
    * target[0]
      * context = "target"
      * element = "effectiveDateTime"
  * rule[1]
    * name = "Duration"
    * source[0]
      * context = "source"
      * element = "duration"
    * target[0]
      * context = "target"
      * element = "component.where(code.coding.code='118682006').valueQuantity"

Instance: MindfulnessCSVTransform
InstanceOf: StructureMap
Usage: #definition
Title: "CSV to FHIR Mindfulness Transform"

* status = #draft
* name = "MindfulnessCSVTransform"
* structure[0]
  * url = "https://2rdoc.pt/ig/ios-lifestyle-medicine/StructureDefinition/csv-mindfulness"
  * mode = #source
  * documentation = "CSV mindfulness data structure"

* group[0]
  * name = "CSVToMindfulnessObservation"
  * typeMode = #none
  * input[0]
    * name = "source"
    * type = "CSVMindfulness"
    * mode = #source
  * input[1]
    * name = "target"
    * type = "Observation"
    * mode = #target
  * rule[0]
    * name = "MapDatetime"
    * source[0]
      * context = "source"
      * element = "date,time"
    * target[0]
      * context = "target"
      * element = "effectiveDateTime"
      * transform = #append

RuleSet: TransformValidationRules
* rule[+]
  * name = "ValidateStatus"
  * source[0]
    * context = "target"
    * element = "status"
  * assert[0]
    * description = "Status must be final"
    * expression = "%status = 'final'"

* rule[+]
  * name = "ValidateCode"
  * source[0]
    * context = "target"
    * element = "code"
  * assert[0]
    * description = "Must use SNOMED CT code"
    * expression = "%code.system = 'http://snomed.info/sct'"



// ===== Conteúdo de: MindfulnessAudit.fsh =====

Extension: AuditLevelExtension
Id: audit-level
Title: "Audit Level Extension"
Description: "Level of detail for audit records"
* value[x] only code
* valueCode from https://2rdoc.pt/fhir/ValueSet/audit-levels (required)

Extension: AuditRetentionExtension
Id: audit-retention
Title: "Audit Retention Extension" 
Description: "Period to retain audit records"
* value[x] only Duration

Extension: AuditFormatExtension
Id: audit-format
Title: "Audit Format Extension"
Description: "Format for audit records"
* value[x] only code
* valueCode from https://2rdoc.pt/fhir/ValueSet/audit-formats (required)

Profile: MindfulnessAudit
Parent: Basic
Id: mindfulness-audit
Title: "Mindfulness Audit"
Description: "Audit record for mindfulness sessions"

* code 1..1 MS
* code = https://2rdoc.pt/fhir/CodeSystem/mindfulness-audit-type#session "Session Audit"
* created 1..1 MS

* extension contains
    audit-level named auditLevel 1..1 MS and
    audit-retention named auditRetention 1..1 MS and
    audit-format named auditFormat 1..1 MS

Instance: MindfulnessAuditExample
InstanceOf: MindfulnessAudit
Title: "Example Mindfulness Audit"
Description: "Example of a mindfulness session audit record"

* code = https://2rdoc.pt/fhir/CodeSystem/mindfulness-audit-type#session "Session Audit"
* created = "2024-03-15"
* extension[auditLevel].valueCode = #detailed
* extension[auditRetention].valueDuration = 90 'days'
* extension[auditFormat].valueCode = #fhir



// ===== Conteúdo de: EnvironmentalExamples.fsh =====

Instance: NoiseExposureExample
InstanceOf: NoiseExposureObservation
Usage: #example
Description: "Noise exposure observation example"
Title: "Noise Exposure Measurement Example"

* meta.security = http://terminology.hl7.org/CodeSystem/v3-Confidentiality#N
* status = #final
* performer = Reference(Practitioner/PractitionerExample)
* category = http://terminology.hl7.org/CodeSystem/observation-category#environment
* code = $LOINC#28573-7 "Noise exposure time"
* subject = Reference(Patient/PatientExample)
* effectiveDateTime = "2024-03-19T15:30:00Z"
* device = Reference(Device/iphone-example)
* method = http://snomed.info/sct#37016008 "Automatic measurement"

* component[level]
  * code.coding[0] = $LOINC#89020-2 "Environmental noise average"
  * valueQuantity = 85 'dB'
  * interpretation = http://terminology.hl7.org/CodeSystem/v3-ObservationInterpretation#H "High"

* component[duration]
  * code.coding[0] = $LOINC#89021-0 "Environmental noise duration"
  * valueQuantity = 120 'min'

* component[peakLevel]
  * code.coding[0] = $LOINC#89024-4 "Peak sound level"
  * valueQuantity = 95 'dB'

* component[backgroundNoise]
  * code.coding[0] = $LOINC#89025-1 "Background noise level"
  * valueQuantity = 45 'dB'

* note.text = "Measurement taken during urban commute"

Instance: UVExposureExample
InstanceOf: UVExposureObservation
Usage: #example
Description: "UV exposure observation example"
Title: "UV Exposure Measurement Example"

* meta.security = http://terminology.hl7.org/CodeSystem/v3-Confidentiality#N
* status = #final
* category = http://terminology.hl7.org/CodeSystem/observation-category#environment
* code = $LOINC#28574-5 "UV exposure"
* subject = Reference(Patient/PatientExample)
* effectiveDateTime = "2024-03-19T12:00:00Z"
* device = Reference(Device/iphone-example)
* method = http://snomed.info/sct#37016008 "Automatic measurement"

* component[index]
  * code.coding[0] = $LOINC#89022-8 "UV index"
  * valueQuantity = 8 '{index}'
  * interpretation = http://terminology.hl7.org/CodeSystem/v3-ObservationInterpretation#H "High"

* component[duration]
  * code.coding[0] = $LOINC#89023-6 "UV exposure duration"
  * valueQuantity = 45 'min'

* component[timeOfDay]
  * code.coding[0] = $LOINC#89026-9 "Time of exposure"
  * valueDateTime = "2024-03-19T12:00:00Z"

* component[intensity]
  * code.coding[0] = $LOINC#89027-7 "UV intensity"
  * valueQuantity = 0.3 'W/m2'

* note.text = "Measurement taken during outdoor activity"

Instance: EnvironmentalDeviceExample
InstanceOf: Device
Usage: #example
Description: "Environmental monitoring device example"
Title: "Environmental Monitoring Device"

* identifier.system = "https://2rdoc.pt/ig/ios-lifestyle-medicine/devices"
* identifier.value = "iPhone-ENV-001"
* manufacturer = "Apple Inc."
* modelNumber = "iPhone 15 Pro"
* type = $SCT#706689003 "Environmental monitoring device"
* status = #active



// ===== Conteúdo de: NutritionExamples.fsh =====

Instance: NutritionQuestionnaireResponseExample
InstanceOf: QuestionnaireResponse
Usage: #example
Description: "Nutrition questionnaire response example"
Title: "Daily Nutrition Questionnaire Response Example"

* questionnaire = "https://2rdoc.pt/fhir/Questionnaire/daily-nutrition"
* status = #completed
* subject = Reference(Patient/PatientExample)
* authored = "2024-12-14T20:00:00Z"

* item[0]
  * linkId = "water_intake"
  * answer.valueQuantity = 2000 'mL'

* item[1]
  * linkId = "meal_record"

  * item[0]
    * linkId = "meal_time"
    * answer.valueDateTime = "2024-12-14T12:00:00Z"

  * item[1]
    * linkId = "meal_type"
    * answer.valueString = "Lunch"

  * item[2]
    * linkId = "calories"
    * answer.valueInteger = 650

  * item[3]
    * linkId = "macronutrients"
   
    * item[0]
      * linkId = "carbs"
      * answer.valueDecimal = 75
   
    * item[1]
      * linkId = "protein"
      * answer.valueDecimal = 30
   
    * item[2]
      * linkId = "fat"
      * answer.valueDecimal = 25

* item[2]
  * linkId = "caffeine"

  * item[0]
    * linkId = "caffeine_amount"
    * answer.valueInteger = 80

  * item[1]
    * linkId = "caffeine_source"
    * answer.valueString = "Coffee"



// ===== Conteúdo de: SleepExamples.fsh =====

Instance: SleepObservationExample1
InstanceOf: SleepObservation
Usage: #example
Description: "Sleep observation example"
Title: "Example of Sleep Record"
 
* status = #final
* category = http://terminology.hl7.org/CodeSystem/observation-category#sleep
* code = $LOINC#93832-4 "Sleep pattern panel"
* subject = Reference(PatientExample)
* effectivePeriod.start = "2024-03-19T22:00:00Z"
* effectivePeriod.end = "2024-03-20T06:30:00Z"
* device = Reference(DeviceSleepMonitor)
 
* component[timeInBed].code = $LOINC#93831-6 "Time in bed"
* component[timeInBed].valueQuantity = 510 'min' "minute"
* component[timeInBed].valueQuantity.system = $UCUM
* component[timeInBed].valueQuantity.unit = "minute"
 
* component[totalSleepTime].code = $LOINC#93833-2 "Sleep duration"
* component[totalSleepTime].valueQuantity = 472 'min' "minute"
* component[totalSleepTime].valueQuantity.system = $UCUM
* component[totalSleepTime].valueQuantity.unit = "minute"
 
* component[deepSleep].code = $LOINC#93834-0 "Deep sleep duration"
* component[deepSleep].valueQuantity = 95 'min' "minute"
* component[deepSleep].valueQuantity.system = $UCUM
* component[deepSleep].valueQuantity.unit = "minute"
 
* component[remSleep].code = $LOINC#93835-7 "REM sleep duration"
* component[remSleep].valueQuantity = 118 'min' "minute"
* component[remSleep].valueQuantity.system = $UCUM
* component[remSleep].valueQuantity.unit = "minute"
 
* component[lightSleep].code = $LOINC#93836-5 "Light sleep duration"
* component[lightSleep].valueQuantity = 259 'min' "minute"
* component[lightSleep].valueQuantity.system = $UCUM
* component[lightSleep].valueQuantity.unit = "minute"
 
* component[respiratoryRate].code = $LOINC#9279-1 "Respiratory rate"
* component[respiratoryRate].valueQuantity = 14 '/min' "per minute"
* component[respiratoryRate].valueQuantity.system = $UCUM
* component[respiratoryRate].valueQuantity.unit = "per minute"
 
* component[heartRateVariability].code = $LOINC#80404-7 "R-R interval.standard deviation (Heart rate variability)"
* component[heartRateVariability].valueQuantity = 45 'ms' "millisecond"
* component[heartRateVariability].valueQuantity.system = $UCUM
* component[heartRateVariability].valueQuantity.unit = "millisecond"
 
* component[interruptions].code = $LOINC#93837-3 "Number of awakenings during sleep"
* component[interruptions].valueQuantity = 3 '{count}' "count"
* component[interruptions].valueQuantity.system = $UCUM
* component[interruptions].valueQuantity.unit = "count"

Instance: DeviceSleepMonitor
InstanceOf: Device
Usage: #example
Description: "Sleep monitor device example"
Title: "Sleep Monitoring Device"
* deviceName.name = "Sleep Quality Monitor"
* deviceName.type = #user-friendly-name
* manufacturer = "HealthTech Devices"
* modelNumber = "SQM-2024"
* type = $SCT#706172001 "Sleep monitor"



// ===== Conteúdo de: StressExamples.fsh =====

Instance: StressLevelExample
InstanceOf: StressLevelProfile
Usage: #example
Description: "Stress level observation example"
Title: "Stress Level Measurement Example"

* status = #final
* category = http://terminology.hl7.org/CodeSystem/observation-category#vital-signs
* code = $LOINC#89592-0 "Stress level score"
* subject = Reference(Patient/PatientExample)
* effectiveDateTime = "2024-01-03T15:30:00Z"
* valueQuantity = 7 '{score}' "score"

* component[physiologicalStress].valueQuantity = 6 '{score}' "score"
* component[psychologicalStress].valueQuantity = 8 '{score}' "score"
* component[chronicity].valueCodeableConcept = StressChronicityCS#subacute
* component[impact].valueCodeableConcept = StressImpactCS#moderate

* extension[triggers].valueCodeableConcept = StressTriggersCS#work
* extension[coping].valueCodeableConcept = StressCopingCS#meditation



// ===== Conteúdo de: PatientExample.fsh =====

Instance: PatientExample
InstanceOf: Patient
Usage: #example
Description: "Patient resource example"
* identifier[0].system = "urn:oid:2.16.858.1.1.1"
* identifier[0].value = "12345"
* name.given = "John"
* name.family = "Doe"
* gender = #male
* birthDate = "1970-01-01"



// ===== Conteúdo de: MobilityExamples.fsh =====

Profile: WalkingSteadinessObservation
Parent: MobilityProfile
Id: walking-steadiness-observation
Description: "Profile for assessing walking steadiness and balance"Title: "Walking Steadiness Observation Profile"

* code = $LOINC#LA32-8 "Balance"
* component contains
    balanceScore 0..1 MS and
    balanceStatus 0..1 MS

* component[balanceScore]
  * code = $LOINC#LA32-8 "Balance score"
  * valueQuantity.system = $UCUM
  * valueQuantity.code = #%

* component[balanceStatus]
  * code = $LOINC#LA32-9 "Balance status"
  * valueCodeableConcept from https://2rdoc.pt/fhir/ValueSet/balance-status (required)

Profile: WalkingSpeedObservation
Parent: MobilityProfile
Id: walking-speed-observation
Description: "Profile for measuring walking speed as part of mobility assessment"Title: "Walking Speed Observation Profile"

* code = $LOINC#LA29042-4 "Walking speed"
* component contains
    speed 0..1 MS and
    distance 0..1 MS

* component[speed]
  * code = $LOINC#LA29042-4 "Walking speed measurement"
  * valueQuantity.system = $UCUM
  * valueQuantity.code = #m/s

* component[distance]
  * code = $LOINC#LA29043-2 "Walking distance"
  * valueQuantity.system = $UCUM
  * valueQuantity.code = #m

Instance: WalkingSteadinessExample
InstanceOf: WalkingSteadinessObservation
Usage: #example
Description: "Walking steadiness observation example"
Title: "Walking Steadiness Measurement Example"

* status = #final
* category = http://terminology.hl7.org/CodeSystem/observation-category#activity
* code = $LOINC#LA32-8 "Balance"
* subject = Reference(Patient/PatientExample)
* effectiveDateTime = "2024-03-19T15:30:00Z"
* valueQuantity = 85 '1' "score"
* device = Reference(Device/iphone-example)

* component[balanceScore].valueQuantity = 85 '%' "percent"
* component[balanceStatus].valueCodeableConcept = $LOINC#LA32-10 "OK"

Instance: WalkingSpeedExample
InstanceOf: WalkingSpeedObservation
Usage: #example
Description: "Walking speed observation example"
Title: "Walking Speed Measurement Example"

* status = #final
* category = http://terminology.hl7.org/CodeSystem/observation-category#activity
* code = $LOINC#LA29042-4 "Walking speed"
* subject = Reference(Patient/PatientExample)
* effectiveDateTime = "2024-03-19T15:30:00Z"
* valueQuantity = 1.2 'm/s' "meters per second"
* device = Reference(Device/iphone-example)

* component[speed].valueQuantity = 1.2 'm/s' "meters per second"
* component[distance].valueQuantity = 10 'm' "meters"



// ===== Conteúdo de: PhysicalActivityExamples.fsh =====

Instance: PhysicalActivityExample1
InstanceOf: PhysicalActivityObservation
Usage: #example
Description: "Physical activity observation example"
Title: "Example of Walking Activity"
* status = #final
* category = http://terminology.hl7.org/CodeSystem/observation-category#activity
* code = $SNOMED#228557008 "Walking"
* subject = Reference(PatientExample)
* effectiveDateTime = "2024-03-19T15:30:00Z"
* device = Reference(DeviceActivityTracker)
* component[steps].code = $LOINC#55423-8 "Number of steps in 24 hour Measured"
* component[steps].valueQuantity = 8546 '1' "count"
* component[steps].valueQuantity.system = $UCUM
* component[steps].valueQuantity.unit = "count"
* component[distance].code = $LOINC#55430-3 "Distance walked"
* component[distance].valueQuantity = 6.2 'km' "kilometer"
* component[distance].valueQuantity.system = $UCUM
* component[distance].valueQuantity.unit = "kilometer"
* component[duration].code = $LOINC#55411-3 "Exercise duration"
* component[duration].valueQuantity = 72 'min' "minute"
* component[duration].valueQuantity.system = $UCUM
* component[duration].valueQuantity.unit = "minute"
* component[energy].code = $LOINC#55424-6 "Energy expenditure"
* component[energy].valueQuantity = 320 'kcal' "kilocalorie"
* component[energy].valueQuantity.system = $UCUM
* component[energy].valueQuantity.unit = "kilocalorie"

Instance: DeviceActivityTracker
InstanceOf: Device
Usage: #example
Description: "Activity tracker device example"
Title: "Activity Tracking Device"
* deviceName.name = "Health Activity Tracker"
* deviceName.type = #user-friendly-name
* manufacturer = "HealthTech Devices"
* modelNumber = "HAT-2024"
* type = $SCT#258158006 "Breathing rate"



// ===== Conteúdo de: BodyMetricsExamples.fsh =====

Instance: WeightExample
InstanceOf: WeightObservation
Usage: #example
Description: "Weight observation example"
Title: "Weight Measurement Example"
* status = #final
* category = http://terminology.hl7.org/CodeSystem/observation-category#vital-signs
* code = $LOINC#29463-7 "Body weight"
* subject = Reference(PatientExample)
* performer = Reference(PractitionerExample)
* effectiveDateTime = "2024-03-19T08:00:00Z"
* valueQuantity = 70.5 'kg' "kilogram"
* valueQuantity.system = $UCUM
* valueQuantity.unit = "kilogram"
* device = Reference(SmartScale)

Instance: HeightExample
InstanceOf: HeightObservation
Usage: #example
Description: "Height observation example"
Title: "Height Measurement Example"
* status = #final
* category = http://terminology.hl7.org/CodeSystem/observation-category#vital-signs
* code = $LOINC#8302-2 "Body height"
* subject = Reference(PatientExample)
* performer = Reference(PractitionerExample)
* effectiveDateTime = "2024-03-19T08:00:00Z"
* valueQuantity = 175 'cm' "centimeter"
* valueQuantity.system = $UCUM
* valueQuantity.unit = "centimeter"

Instance: BMIExample
InstanceOf: BMIObservation
Usage: #example
Description: "Body Mass Index observation example"
Title: "BMI Calculation Example"
* status = #final
* category = http://terminology.hl7.org/CodeSystem/observation-category#vital-signs
* code = $LOINC#39156-5 "Body mass index (BMI)"
* subject = Reference(PatientExample)
* performer = Reference(PractitionerExample)
* effectiveDateTime = "2024-03-19T08:00:00Z"
* valueQuantity = 23.0 'kg/m2' "kilogram per square meter"
* valueQuantity.system = $UCUM
* valueQuantity.unit = "kilogram per square meter"
* derivedFrom[0] = Reference(Observation/WeightExample)
* derivedFrom[1] = Reference(Observation/HeightExample)

Instance: BodyCompositionExample
InstanceOf: BodyCompositionObservation
Usage: #example
Description: "Body composition observation example"
Title: "Body Composition Measurement Example" 
* status = #final
* category = http://terminology.hl7.org/CodeSystem/observation-category#vital-signs
* code = $LOINC#88365-2 "Body composition panel"
* subject = Reference(PatientExample)
* performer = Reference(PractitionerExample)
* effectiveDateTime = "2024-03-19T08:00:00Z"
* device = Reference(BioimpedanceAnalyzer)

* component[bodyFat].code = $LOINC#41982-0 "Percentage body fat"
* component[bodyFat].valueQuantity = 22.5 '%' "percent"
* component[bodyFat].valueQuantity.system = $UCUM
* component[bodyFat].valueQuantity.unit = "percent"

* component[leanMass].code = $LOINC#291-7 "Lean body mass"
* component[leanMass].valueQuantity = 54.6 'kg' "kilogram"
* component[leanMass].valueQuantity.system = $UCUM
* component[leanMass].valueQuantity.unit = "kilogram"

* component[bodyWater].code = $LOINC#73708-0 "Total body water"
* component[bodyWater].valueQuantity = 39.2 'L' "liter"
* component[bodyWater].valueQuantity.system = $UCUM
* component[bodyWater].valueQuantity.unit = "liter"

* component[muscleMass].code = $LOINC#73713-0 "Muscle mass"
* component[muscleMass].valueQuantity = 51.8 'kg' "kilogram"
* component[muscleMass].valueQuantity.system = $UCUM
* component[muscleMass].valueQuantity.unit = "kilogram"

* component[boneMass].code = $LOINC#73711-4 "Bone mass"
* component[boneMass].valueQuantity = 2.8 'kg' "kilogram"
* component[boneMass].valueQuantity.system = $UCUM
* component[boneMass].valueQuantity.unit = "kilogram"

Instance: SmartScale
InstanceOf: Device
Usage: #example
Description: "Smart scale device example"
Title: "Smart Scale Device"
* deviceName.name = "Smart Body Analyzer"
* deviceName.type = #user-friendly-name
* manufacturer = "HealthTech Devices"
* modelNumber = "SBA-2024"
* type = $SCT#469576000 "Digital scale device"

Instance: BioimpedanceAnalyzer  
InstanceOf: Device
Usage: #example
Description: "Bioimpedance analyzer device example"
Title: "Bioimpedance Analyzer Device"
* deviceName.name = "Professional Body Composition Analyzer"
* deviceName.type = #user-friendly-name
* manufacturer = "MedTech Solutions"
* modelNumber = "BCA-Pro"
* type = $SCT#706767009 "Patient data recorder"



// ===== Conteúdo de: SymptomExamples.fsh =====

Instance: ChronicSymptomExample
InstanceOf: Observation
Usage: #example
Description: "Chronic symptom observation example"
* status = #final
* category = http://terminology.hl7.org/CodeSystem/observation-category#survey
* code = $SCT#267036007 "Fatigue"
* subject = Reference(Patient/PatientExample)
* performer = Reference(Practitioner/PractitionerExample)
* effectiveDateTime = "2024-03-19T14:00:00Z"
// ... resto do exemplo ...

Instance: ExampleSymptomSeverity
InstanceOf: Observation
Usage: #example
Description: "Symptom severity observation example"
* status = #final
* category = http://terminology.hl7.org/CodeSystem/observation-category#survey
* code = $SCT#246604007 "Symptom severity"
* subject = Reference(Patient/PatientExample)
* performer = Reference(Practitioner/PractitionerExample)
* effectiveDateTime = "2024-03-19T10:30:00Z"
// ... resto do exemplo ...



// ===== Conteúdo de: SocialInteractionExamples.fsh =====

Instance: SocialInteractionExample
InstanceOf: SocialInteractionProfile
Usage: #example
Description: "Social interaction observation example"
Title: "Social Interaction Example"

* status = #final
* category = http://terminology.hl7.org/CodeSystem/observation-category#social-history
* code = $LOINC#96766-1 "Social interaction pattern"
* subject = Reference(Patient/PatientExample)
* effectiveDateTime = "2024-01-03T14:00:00Z"
* valueCodeableConcept = SocialInteractionTypeCS#family

* component[duration].valueQuantity = 120 'min' "minutes"
* component[quality].valueCodeableConcept = SocialInteractionQualityCS#meaningful
* component[medium].valueCodeableConcept = SocialInteractionMediumCS#inPerson
* component[participants].valueInteger = 4

* extension[context].valueCodeableConcept = SocialContextCS#home
* extension[support].valueCodeableConcept = SocialSupportCS#strong
* extension[activity].valueCodeableConcept = SocialActivityCS#meal



// ===== Conteúdo de: VitalSignsExamples.fsh =====

Instance: HeartRateExample
InstanceOf: HeartRateObservation
Usage: #example
Description: "Heart rate observation example"
Title: "Heart Rate Measurement Example"
* status = #final
* code = $LOINC#8867-4 "Heart rate"
* subject = Reference(PatientExample)
* effectiveDateTime = "2024-03-19T15:30:00Z"
* valueQuantity = 72 '/min' "per minute"
* valueQuantity.system = $UCUM
* valueQuantity.unit = "per minute"
* device = Reference(DeviceHeartRateMonitor)
* performer = Reference(PractitionerExample)
* component[heartRateVariability].code = $LOINC#80404-7 "R-R interval.standard deviation (Heart rate variability)"
* component[heartRateVariability].valueQuantity = 45 'ms' "millisecond"
* component[heartRateVariability].valueQuantity.system = $UCUM
* component[heartRateVariability].valueQuantity.unit = "millisecond"

Instance: BloodPressureExample
InstanceOf: BloodPressureObservation
Usage: #example
Description: "Blood pressure observation example"
Title: "Blood Pressure Measurement Example"
* status = #final
* code = $LOINC#85354-9 "Blood pressure panel with all children optional"
* subject = Reference(PatientExample)
* effectiveDateTime = "2024-03-19T15:30:00Z"
* device = Reference(DeviceBloodPressureMonitor)
* performer = Reference(PractitionerExample)
* component[systolic].code = $LOINC#8480-6 "Systolic blood pressure"
* component[systolic].valueQuantity = 120 'mm[Hg]' "millimeter of mercury"
* component[systolic].valueQuantity.system = $UCUM
* component[systolic].valueQuantity.unit = "millimeter of mercury"
* component[diastolic].code = $LOINC#8462-4 "Diastolic blood pressure"
* component[diastolic].valueQuantity = 80 'mm[Hg]' "millimeter of mercury"
* component[diastolic].valueQuantity.system = $UCUM
* component[diastolic].valueQuantity.unit = "millimeter of mercury"

Instance: DeviceHeartRateMonitor
InstanceOf: Device
Usage: #example
Description: "Heart rate monitor device example"
Title: "Heart Rate Monitor Device"
* deviceName.name = "Continuous Heart Rate Monitor"
* deviceName.type = #user-friendly-name
* manufacturer = "HealthTech Devices"
* modelNumber = "HRM-2024"
* type = $SCT#720737000 "Pulse rate monitoring device"

Instance: DeviceBloodPressureMonitor
InstanceOf: Device
Usage: #example
Description: "Blood pressure monitor device example"
Title: "Blood Pressure Monitor Device"
* deviceName.name = "Digital Blood Pressure Monitor"
* deviceName.type = #user-friendly-name
* manufacturer = "HealthTech Devices"
* modelNumber = "BPM-2024"
* type = $SCT#43770009 "Blood pressure monitor"



// ===== Conteúdo de: PractitionerExample.fsh =====

Instance: PractitionerExample
InstanceOf: Practitioner
Usage: #example
Description: "Practitioner resource example"
* identifier[0].system = "http://terminology.hl7.org/CodeSystem/practitioner-identifier"
* identifier[0].value = "9941339108"
* name.given = "Jane"
* name.family = "Smith"



// ===== Conteúdo de: MindfulnessCompleteExamples.fsh =====

Instance: CompleteMindfulnessSession
InstanceOf: MindfulnessObservation
Usage: #example
Description: "Complete mindfulness session observation example"
Title: "Complete Mindfulness Session Example"

* status = #final
* code = $SCT#711415009 "Mindfulness"
* subject = Reference(Patient/PatientExample)
* effectiveDateTime = "2024-03-19T08:00:00Z"
* performer = Reference(Practitioner/PractitionerExample)

* component[sessionDuration].code = $SCT#118682006 "Duration"
* component[sessionDuration].valueQuantity = 20 'min'

* component[stressLevel].code = $SCT#725854004 "Assessment of stress level"
* component[stressLevel].valueInteger = 3

* component[moodState].code = $SCT#373931001 "Mood finding"
* component[moodState].valueCodeableConcept = $SCT#130991005 "Neutral mood"

* component[relaxationResponse].code = $SCT#276241001 "Relaxation technique"
* component[relaxationResponse].valueString = "Deep breathing exercises with progressive relaxation"

* component[mindfulnessType].code = $SCT#711415009 "Mindfulness"
* component[mindfulnessType].valueCodeableConcept = $SCT#711415009 "Mindfulness"

* extension[mindfulness-context].extension[location].valueString = "Home meditation room"
* extension[mindfulness-context].extension[environment].valueCodeableConcept = #quiet "Quiet Space"
* extension[mindfulness-context].extension[guidance].valueBoolean = true

Instance: CompleteMindfulnessResponse
InstanceOf: QuestionnaireResponse
Usage: #example
Description: "Complete mindfulness questionnaire response example"
Title: "Complete Mindfulness Session Response"

* questionnaire = "https://2rdoc.pt/fhir/Questionnaire/daily-mindfulness"
* status = #completed
* subject = Reference(Patient/PatientExample)
* authored = "2024-03-19T08:30:00Z"

* item[0]
  * linkId = "mindful_session"
  * item[0]
    * linkId = "session_duration"
    * answer.valueInteger = 20
  * item[1]
    * linkId = "practice_type"
    * answer.valueString = "Meditation"

* item[1]
  * linkId = "mood_assessment"
  * item[0]
    * linkId = "current_mood"
    * answer.valueCoding = $SCT#130991005 "Neutral mood"
  * item[1]
    * linkId = "mood_intensity"
    * answer.valueInteger = 3

* item[2]
  * linkId = "stress_assessment"
  * item[0]
    * linkId = "stress_level"
    * answer.valueInteger = 3
  * item[1]
    * linkId = "stress_symptoms"
    * answer[0].valueString = "Slight tension"

* item[3]
  * linkId = "relaxation"
  * item[0]
    * linkId = "relaxation_duration"
    * answer.valueInteger = 15
  * item[1]
    * linkId = "relaxation_technique"
    * answer.valueString = "Deep breathing"



// ===== Conteúdo de: MindfulnessExamples.fsh =====

Instance: MindfulnessObservationExample
InstanceOf: MindfulnessObservation
Usage: #example
Description: "Mindfulness observation example"
Title: "Example of Mindfulness Session Observation"

* status = #final
* code = $SCT#711415009 "Mindfulness"
* subject = Reference(Patient/PatientExample)
* effectiveDateTime = "2024-03-19T09:30:00Z"
* performer = Reference(Practitioner/PractitionerExample)

* component[sessionDuration].code = $SCT#118682006 "Duration"
* component[sessionDuration].valueQuantity = 20 'min'

* component[stressLevel].code = $SCT#725854004 "Assessment of stress level"
* component[stressLevel].valueInteger = 4

* component[moodState].code = $SCT#373931001 "Mood finding"
* component[moodState].valueCodeableConcept = $SCT#130991005 "Neutral mood"

* component[relaxationResponse].code = $SCT#276241001 "Relaxation technique"
* component[relaxationResponse].valueString = "Deep breathing exercises helped reduce tension"

* component[mindfulnessType].code = $SCT#711415009 "Mindfulness"
* component[mindfulnessType].valueCodeableConcept = $SCT#711415009 "Mindfulness"

// New example for MindfulnessQuestionnaire
Instance: MindfulnessQuestionnaireExample
InstanceOf: Questionnaire
Usage: #example
Title: "Example of Mindfulness Questionnaire"

* url = "https://2rdoc.pt/ig/ios-lifestyle-medicine/Questionnaire/mindfulness-example"
* status = #active
* title = "Daily Mindfulness Assessment"
* version = "1.0"
* name = "MindfulnessQuestionnaireExample"
* date = "2024-03-19"
* description = "Example questionnaire for daily mindfulness practice assessment"

* item[0]
  * linkId = "session_details"
  * text = "Session Details"
  * type = #group
  
  * item[0]
    * linkId = "duration"
    * text = "Duration (minutes)"
    * type = #integer
    * required = true
    
  * item[1]
    * linkId = "technique"
    * text = "Technique Used"
    * type = #choice
    * required = true
    * answerOption[0].valueString = "Mindful Breathing"
    * answerOption[1].valueString = "Body Scan"
    * answerOption[2].valueString = "Walking Meditation"



// ===== Conteúdo de: ReproductiveExamples.fsh =====

Instance: ExampleReproductiveActivity
InstanceOf: CarePlan
Usage: #example
Description: "Reproductive health care plan example"
* status = #active
* intent = #plan
* subject = Reference(Patient/PatientExample)
* activity.detail.kind = #ServiceRequest
* activity.detail.code = ReproductiveActivityCS#cycle-tracking
* activity.detail.status = #scheduled



// ===== Conteúdo de: MissingResources.fsh =====

// ====== Recursos Faltantes para Resolver Links Quebrados ======

Instance: example
InstanceOf: Patient
Usage: #example
* identifier.system = "http://example.org/patients"
* identifier.value = "example-patient"
* name.family = "Example"
* name.given = "Patient"
* gender = #unknown
* birthDate = "1970-01-01"

Instance: osa-practitioner-kyle-anydoc
InstanceOf: Practitioner
Usage: #example
* identifier.system = "http://example.org/practitioners"
* identifier.value = "kyle-anydoc"
* name.family = "Anydoc"
* name.given = "Kyle"
* name.prefix = "Dr."

Instance: PatientMindfulness
InstanceOf: Patient
Usage: #example
* identifier.system = "http://example.org/patients"
* identifier.value = "mindfulness-patient"
* name.family = "Mindfulness"
* name.given = "Test"
* gender = #other
* birthDate = "1980-01-01"

Instance: Org2RDoc
InstanceOf: Organization
Usage: #example
* identifier.system = "http://example.org/organizations"
* identifier.value = "2rdoc"
* name = "2RDoc Healthcare Solutions"
* active = true



// ===== Conteúdo de: MindfulnessWorkflow.fsh =====

Profile: MindfulnessSchedule
Parent: Basic
Id: mindfulness-schedule
Title: "Mindfulness Schedule"
Description: "Schedule configuration for mindfulness sessions"

* code 1..1 MS
* code = https://2rdoc.pt/fhir/CodeSystem/mindfulness-schedule-type#recurring "Recurring Schedule"

Extension: MindfulnessScheduleTiming
Id: mindfulness-schedule-timing
Title: "Mindfulness Schedule Timing"
Description: "Timing configuration for mindfulness sessions"
* value[x] only Timing

Instance: WeeklyMindfulnessSchedule
InstanceOf: MindfulnessSchedule
Title: "Weekly Mindfulness Schedule"
Description: "Example of a weekly mindfulness schedule"

* code = https://2rdoc.pt/fhir/CodeSystem/mindfulness-schedule-type#recurring "Recurring Schedule"
* extension[mindfulness-schedule-timing].valueTiming.repeat.frequency = 1
* extension[mindfulness-schedule-timing].valueTiming.repeat.period = 1
* extension[mindfulness-schedule-timing].valueTiming.repeat.periodUnit = #wk
* extension[mindfulness-schedule-timing].valueTiming.repeat.dayOfWeek = #mon
* extension[mindfulness-schedule-timing].valueTiming.repeat.dayOfWeek[+] = #wed
* extension[mindfulness-schedule-timing].valueTiming.repeat.dayOfWeek[+] = #fri



// ===== Conteúdo de: MindfulnessRules.fsh =====

RuleSet: MindfulnessValidation
* ^extension[0].url = "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice"
* ^extension[0].valueBoolean = true

* status MS
* code MS
* subject MS
* effective[x] MS
* value[x] MS
* component MS

* status from http://hl7.org/fhir/ValueSet/observation-status
* code from http://snomed.info/sct?fhir_vs=isa/711415009
* subject only Reference(Patient)
* effective[x] only dateTime

* obeys mindfulness-session-duration
* obeys mindfulness-stress-level
* obeys mindfulness-mood-required
* obeys mindfulness-context-complete
* obeys sequential-measurements

RuleSet: MindfulnessQuestionnaireValidation
* status MS
* title MS
* item MS

* status = #active
* subjectType = #Patient
* item ^slicing.discriminator.type = #pattern
* item ^slicing.discriminator.path = "linkId"
* item ^slicing.rules = #open
* item contains 
    session 0..1 MS and
    mood 0..1 MS and
    stress 0..1 MS and
    relaxation 0..1 MS

* item[session]
  * linkId = "mindful_session"
  * text = "Mindfulness Session"
  * type = #group
  * required = true
  * repeats = false

* item[mood]
  * linkId = "mood_assessment"
  * text = "Mood Assessment"
  * type = #group
  * required = true
  * repeats = false

* item[stress]
  * linkId = "stress_assessment"
  * text = "Stress Assessment"
  * type = #group
  * required = true
  * repeats = false

* item[relaxation]
  * linkId = "relaxation"
  * text = "Relaxation"
  * type = #group
  * required = true
  * repeats = false

RuleSet: MindfulnessResponseValidation
* status MS
* subject MS
* authored MS
* item MS

* status = #completed
* subject only Reference(Patient)
* authored 1..1
* item ^slicing.discriminator.type = #pattern
* item ^slicing.discriminator.path = "linkId"
* item ^slicing.rules = #open



// ===== Conteúdo de: MindfulnessMappings.fsh =====

Mapping: MindfulnessToHealthKit
Id: mindfulness-to-healthkit
Title: "Mapping to Apple HealthKit"
Source: MindfulnessObservation
Target: "http://developer.apple.com/documentation/healthkit"

* -> "HKCategoryTypeIdentifierMindfulSession" "Root mapping"
* effectiveDateTime -> "startDate and endDate" "Session timing"
* component[sessionDuration].valueQuantity -> "duration" "Session duration"

Mapping: MindfulnessToLOINC
Id: mindfulness-to-loinc
Title: "Mapping to LOINC codes"
Source: MindfulnessObservation
Target: "http://loinc.org"

* -> "89555-7" "Mindfulness safety questionnaire"
* component[stressLevel] -> "89556-5" "Stress level score"
* component[sessionDuration] -> "89557-3" "Duration of mindfulness practice"
* component[moodState] -> "89558-1" "Mood pattern"

Mapping: MindfulnessToSNOMED
Id: mindfulness-to-snomed
Title: "Mapping to SNOMED CT"
Source: MindfulnessObservation
Target: "http://snomed.info/sct"

* -> "711415009" "Meditation"
* component[stressLevel] -> "725854004" "Assessment of stress level"
* component[moodState] -> "373931001" "Mood finding"
* component[relaxationResponse] -> "276241001" "Relaxation technique"

Extension: MindfulnessImportMap
Id: mindfulness-import-map
Title: "Mindfulness Import Mapping"
Description: "Mapping instructions for importing mindfulness data"

* ^url = "https://2rdoc.pt/ig/ios-lifestyle-medicine/StructureDefinition/mindfulness-import-map"
* ^version = "1.0.0"
* ^status = #draft

* extension contains
    source 1..1 MS and
    target 1..1 MS and
    mapping 1..1 MS

* extension[source].value[x] only string
* extension[target].value[x] only string
* extension[mapping].value[x] only string

Instance: HealthKitMappingConfig
InstanceOf: MindfulnessImportMap
Usage: #inline

* extension[source].valueString = "HKCategoryTypeIdentifierMindfulSession"
* extension[target].valueString = "Observation"
* extension[mapping].valueString = "duration->component[sessionDuration].valueQuantity"



// ===== Conteúdo de: SocialInteractionMappings.fsh =====

Mapping: SocialInteractionToHealthKit
Id: social-interaction-to-healthkit
Description: "Definition for social-interaction-to-healthkit resource"Title: "Mapping to Apple HealthKit"
Source: SocialInteractionProfile
Target: "http://developer.apple.com/documentation/healthkit"

* -> "HKCategoryTypeIdentifierSocialInteraction" "Root mapping"
* valueCodeableConcept -> "interactionType" "Type of interaction"
* component[duration] -> "duration" "Duration of interaction"
* component[participants] -> "participantCount" "Number of participants"

Mapping: SocialInteractionToLOINC
Id: social-interaction-to-loinc
Title: "Mapping to LOINC codes"
Source: SocialInteractionProfile
Target: "http://loinc.org"

* -> "96766-1" "Social Interaction Panel"
* component[duration] -> "89597-9" "Interaction duration"
* component[quality] -> "89598-7" "Interaction quality"



// ===== Conteúdo de: MindfulnessDiagnosticMappings.fsh =====

Instance: MindfulnessDiagnosticMap
InstanceOf: ConceptMap
Usage: #definition
Title: "Mindfulness Diagnostic Mappings"
Description: "Mapping of mindfulness outcomes to diagnostic codes"

* status = #draft
* experimental = false
* purpose = "Map mindfulness outcomes to standard diagnostic codes"
* sourceUri = "https://2rdoc.pt/fhir/ValueSet/mindfulness-outcome-vs"
* targetUri = "http://snomed.info/sct"

* group[0].source = "https://2rdoc.pt/fhir/CodeSystem/mindfulness-outcome-cs"
* group[0].target = "http://snomed.info/sct"
* group[0].element[0]
  * code = #stressReduction
  * target[0]
    * code = #73595000
    * display = "Stress"
    * equivalence = #narrower
    * comment = "Indicates reduction in stress levels"

* group[0].element[1]
  * code = #improvedSleep
  * target[0]
    * code = #248234008
    * display = "Sleep pattern"
    * equivalence = #narrower
    * comment = "Indicates improvement in sleep quality"

* group[0].element[2]
  * code = #emotionalBalance
  * target[0]
    * code = #285854004
    * display = "Emotional state"
    * equivalence = #equivalent
    * comment = "Maps to emotional state finding"

* group[0].element[3]
  * code = #increasedAwareness
  * target[0]
    * code = #736253002
    * display = "Mental state, behavior and/or psychosocial functioning"
    * equivalence = #relatedto
    * comment = "General improvement in mental state"

RuleSet: MindfulnessDiagnosticRules
* status MS
* code MS
* subject MS
* effective[x] MS
* value[x] MS
* method MS

* method from https://2rdoc.pt/fhir/ValueSet/mindfulness-diagnostic-method-vs (required)
* code from https://2rdoc.pt/fhir/ValueSet/mindfulness-diagnostic-code-vs (required)

* extension contains 
    diagnosticCertainty 0..1 MS and
    diagnosticTiming 0..1 MS



// ===== Conteúdo de: StressMappings.fsh =====

Mapping: StressToHealthKit
Id: stress-to-healthkit
Description: "Definition for stress-to-healthkit resource"Title: "Mapping to Apple HealthKit"
Source: StressLevelProfile
Target: "http://developer.apple.com/documentation/healthkit"

* -> "HKCategoryTypeIdentifierStressLevel" "Root mapping"
* valueQuantity -> "stressLevel" "Overall stress score"
* component[physiologicalStress] -> "physiologicalStress" "Physical stress indicators"
* component[psychologicalStress] -> "mentalStress" "Mental stress indicators"

Mapping: StressToLOINC
Id: stress-to-loinc
Title: "Mapping to LOINC codes"
Source: StressLevelProfile
Target: "http://loinc.org"

* -> "89592-0" "Stress Level Panel"
* component[physiologicalStress] -> "89593-8" "Physical stress score"
* component[psychologicalStress] -> "89594-6" "Mental stress score"



// ===== Conteúdo de: BodyMetricsProfiles.fsh =====

Alias: $SCT = http://snomed.info/sct
Alias: $LOINC = http://loinc.org
Alias: $UCUM = http://unitsofmeasure.org

Profile: BodyMetricsObservation
Parent: Observation
Id: body-metrics-observation
Title: "Body Metrics Observation Profile"
Description: "Profile for body measurements from iOS Health App"

* ^version = "0.1.0"
* ^status = #draft
* ^publisher = "Open Health Manager"

* status MS
* category 1..1 MS
* category = http://terminology.hl7.org/CodeSystem/observation-category#vital-signs
* subject 1..1 MS
* effectiveDateTime 1..1 MS
* device 0..1 MS

Profile: WeightObservation
Parent: BodyMetricsObservation
Id: weight-observation  
Title: "Weight Measurement Profile"
Description: "Profile for body weight measurements"

* ^version = "0.1.0"
* ^status = #draft

* code = $LOINC#29463-7 "Body weight"
* valueQuantity only Quantity
* valueQuantity.system = $UCUM
* valueQuantity.code = #kg

Profile: HeightObservation
Parent: BodyMetricsObservation
Id: height-observation
Title: "Height Measurement Profile" 
Description: "Profile for body height measurements"

* ^version = "0.1.0"
* ^status = #draft

* code = $LOINC#8302-2 "Body height"
* valueQuantity only Quantity
* valueQuantity.system = $UCUM
* valueQuantity.code = #cm

Profile: BMIObservation
Parent: BodyMetricsObservation
Id: bmi-observation
Title: "BMI Measurement Profile"
Description: "Profile for Body Mass Index calculations"

* ^version = "0.1.0"
* ^status = #draft

* code = $LOINC#39156-5 "Body mass index (BMI)"
* valueQuantity only Quantity
* valueQuantity.system = $UCUM
* valueQuantity.code = #kg/m2

Profile: BodyCompositionObservation
Parent: BodyMetricsObservation
Id: body-composition-observation
Title: "Body Composition Profile"
Description: "Profile for body composition measurements including fat, lean mass, and other metrics"

* ^version = "0.1.0"
* ^status = #draft

* code = $LOINC#88365-2 "Body composition panel"
* component ^slicing.discriminator.type = #pattern
* component ^slicing.discriminator.path = "code"
* component ^slicing.rules = #open

* component contains
    bodyFat 0..1 MS and
    leanMass 0..1 MS and
    bodyWater 0..1 MS and
    muscleMass 0..1 MS and
    boneMass 0..1 MS

* component[bodyFat].code = $LOINC#41982-0 "Percentage body fat"
* component[bodyFat].valueQuantity.system = $UCUM
* component[bodyFat].valueQuantity.code = #%

* component[leanMass].code = $LOINC#291-7 "Lean body mass"
* component[leanMass].valueQuantity.system = $UCUM
* component[leanMass].valueQuantity.code = #kg

* component[bodyWater].code = $LOINC#73708-0 "Total body water"
* component[bodyWater].valueQuantity.system = $UCUM  
* component[bodyWater].valueQuantity.code = #L

* component[muscleMass].code = $LOINC#73713-0 "Muscle mass"
* component[muscleMass].valueQuantity.system = $UCUM
* component[muscleMass].valueQuantity.code = #kg

* component[boneMass].code = $LOINC#73711-4 "Bone mass" 
* component[boneMass].valueQuantity.system = $UCUM
* component[boneMass].valueQuantity.code = #kg



// ===== Conteúdo de: AdvancedVitalSignsProfiles.fsh =====

Alias: $SCT = http://snomed.info/sct
Alias: $LOINC = http://loinc.org
Alias: $UCUM = http://unitsofmeasure.org

Profile: AdvancedVitalSigns
Parent: Observation
Id: advanced-vital-signs
Title: "Advanced Vital Signs Profile"
Description: "Profile for advanced vital signs data from iOS Health App"

* ^version = "0.1.0"
* ^status = #draft
* ^publisher = "HL7 International"
* ^contact.name = "Advanced Vital Signs Working Group"

* status MS
* category 1..1 MS
* category = http://terminology.hl7.org/CodeSystem/observation-category#vital-signs
* code 1..1 MS
* subject 1..1 MS
* effectiveDateTime 1..1 MS
* device 0..1 MS
* method 0..1 MS
* note 0..* MS

* component ^slicing.discriminator.type = #pattern
* component ^slicing.discriminator.path = "code"
* component ^slicing.rules = #open
* component ^short = "Advanced vital signs components"
* component ^definition = "Components of advanced vital sign measurements"

* component contains
    hrvSpectral 0..1 MS and
    hrvEntropy 0..1 MS and
    meanArterialPressure 0..1 MS and
    pulseWaveAnalysis 0..1 MS and
    respiratoryVariability 0..1 MS and
    oxygenationIndex 0..1 MS and
    stressIndex 0..1 MS and
    thermalGradient 0..1 MS and
    autonomicBalance 0..1 MS and
    recoveryRate 0..1 MS and
    allostaticLoad 0..1 MS

* component[hrvSpectral].code = $LOINC#87834-8 "Heart rate variability [Frequency band]"
* component[hrvSpectral].valueQuantity.system = $UCUM
* component[hrvSpectral].valueQuantity.code = #ms
* component[hrvSpectral] ^short = "Spectral analysis of heart rate variability"

* component[hrvEntropy].code = $LOINC#87835-5 "Heart rate variability entropy"
* component[hrvEntropy].valueQuantity.system = $UCUM
* component[hrvEntropy].valueQuantity.code = #{entropy}
* component[hrvEntropy] ^short = "Sample entropy of heart rate variability"

* component[meanArterialPressure].code = $LOINC#8478-0 "Mean blood pressure"
* component[meanArterialPressure].valueQuantity.system = $UCUM
* component[meanArterialPressure].valueQuantity.code = #mmHg
* component[meanArterialPressure] ^short = "Mean arterial blood pressure"

* component[pulseWaveAnalysis].code = $LOINC#87836-3 "Pulse wave analysis"
* component[pulseWaveAnalysis].valueQuantity.system = $UCUM
* component[pulseWaveAnalysis].valueQuantity.code = #{index}
* component[pulseWaveAnalysis] ^short = "Analysis of arterial pulse wave"

* component[respiratoryVariability].code = $LOINC#87837-1 "Respiratory rate variability"
* component[respiratoryVariability].valueQuantity.system = $UCUM
* component[respiratoryVariability].valueQuantity.code = #{coefficient}
* component[respiratoryVariability] ^short = "Variability in respiratory rate"

* component[oxygenationIndex].code = $LOINC#87838-9 "Oxygenation index"
* component[oxygenationIndex].valueQuantity.system = $UCUM
* component[oxygenationIndex].valueQuantity.code = #{ratio}
* component[oxygenationIndex] ^short = "Index of blood oxygenation"

* component[stressIndex].code = $LOINC#87839-7 "Physiological stress index"
* component[stressIndex].valueQuantity.system = $UCUM
* component[stressIndex].valueQuantity.code = #{index}
* component[stressIndex] ^short = "Index of physiological stress"

* component[thermalGradient].code = $LOINC#87840-5 "Temperature gradient"
* component[thermalGradient].valueQuantity.system = $UCUM
* component[thermalGradient].valueQuantity.code = #Cel
* component[thermalGradient] ^short = "Gradient of body temperature"

* component[autonomicBalance].code = $LOINC#87841-3 "Autonomic balance index"
* component[autonomicBalance].valueQuantity.system = $UCUM
* component[autonomicBalance].valueQuantity.code = #{ratio}
* component[autonomicBalance] ^short = "Balance of autonomic nervous system"

* component[recoveryRate].code = $LOINC#87842-1 "Recovery rate index"
* component[recoveryRate].valueQuantity.system = $UCUM
* component[recoveryRate].valueQuantity.code = #{rate}
* component[recoveryRate] ^short = "Rate of physiological recovery"

* component[allostaticLoad].code = $LOINC#87843-9 "Allostatic load index"
* component[allostaticLoad].valueQuantity.system = $UCUM
* component[allostaticLoad].valueQuantity.code = #{score}
* component[allostaticLoad] ^short = "Measure of cumulative physiological burden"

Extension: AdvancedVitalSignsContext
Id: advanced-vital-signs-context
Title: "Advanced Vital Signs Context Extension"
Description: "Additional context about advanced vital sign measurements"

* value[x] only CodeableConcept
* valueCodeableConcept from AdvancedVitalSignsContextVS (required)

ValueSet: AdvancedVitalSignsContextVS
Id: advanced-vital-signs-context-vs
Title: "Advanced Vital Signs Context Value Set"
Description: "Context codes for advanced vital sign measurements"

* ^experimental = true
* codes from system AdvancedVitalSignsContextCS

CodeSystem: AdvancedVitalSignsContextCS
Id: advanced-vital-signs-context-cs
Title: "Advanced Vital Signs Context Code System"
Description: "Codes for advanced vital signs measurement context"

* ^experimental = true
* ^caseSensitive = true

* #resting "Resting state" "Measurement taken during rest"
* #active "Active state" "Measurement taken during activity"
* #recovery "Recovery state" "Measurement taken during recovery"
* #sleep "Sleep state" "Measurement taken during sleep"
* #stress "Stress state" "Measurement taken during stress"



// ===== Conteúdo de: MobilityProfiles.fsh =====

Profile: MobilityProfile
Parent: Observation
Id: mobility-profile
Title: "Mobility Profile"
Description: "Profile for mobility data from iOS Health App"

* status MS
* category 1..1 MS
* category = http://terminology.hl7.org/CodeSystem/observation-category#activity
* code 1..1 MS
* subject 1..1 MS
* effectiveDateTime 1..1 MS
* device 0..1 MS

* component ^slicing.discriminator.type = #pattern
* component ^slicing.discriminator.path = "code"
* component ^slicing.rules = #open

* component contains
    steadiness 0..1 MS and
    balance 0..1 MS and
    gait 0..1 MS and 
    movement 0..1 MS

* component[steadiness].code = $LOINC#LA32-8
* component[balance].code = $LOINC#LA32-9
* component[gait].code = $LOINC#LA29042-4
* component[movement].code = $LOINC#LA29043-2



// ===== Conteúdo de: VitalSignsProfiles.fsh =====

Alias: $SCT = http://snomed.info/sct
Alias: $LOINC = http://loinc.org
Alias: $UCUM = http://unitsofmeasure.org
Alias: $vitalsigns = http://hl7.org/fhir/StructureDefinition/vitalsigns

Profile: LifestyleVitalSigns
Parent: $vitalsigns
Id: lifestyle-vital-signs
Title: "Lifestyle Medicine Vital Signs Profile"
Description: "Profile for vital signs data from iOS Health App"

* status MS
* category 1..* MS
* subject 1..1 MS
* effectiveDateTime 1..1 MS
* code 1..1 MS
* value[x] 0..1 MS
* device 0..1 MS

Profile: HeartRateObservation
Parent: LifestyleVitalSigns
Id: heart-rate-observation
Title: "Heart Rate Observation Profile"
Description: "Profile for heart rate measurements from iOS Health App"

* code = $LOINC#8867-4 "Heart rate"
* valueQuantity only Quantity
* valueQuantity.system = $UCUM
* valueQuantity.code = #/min
* component ^slicing.discriminator.type = #pattern
* component ^slicing.discriminator.path = "code"
* component ^slicing.rules = #open

* component contains
    restingHeartRate 0..1 MS and
    exerciseHeartRate 0..1 MS and
    recoveryHeartRate 0..1 MS and
    heartRateVariability 0..1 MS

* component[heartRateVariability].code = $LOINC#80404-7 "R-R interval.standard deviation (Heart rate variability)"
* component[heartRateVariability].valueQuantity.system = $UCUM
* component[heartRateVariability].valueQuantity.code = #ms

Profile: BloodPressureObservation
Parent: LifestyleVitalSigns
Id: blood-pressure-observation
Title: "Blood Pressure Observation Profile"
Description: "Profile for blood pressure measurements from iOS Health App"

* code = $LOINC#85354-9 "Blood pressure panel with all children optional"
* component 2..2 MS
* component ^slicing.discriminator.type = #pattern
* component ^slicing.discriminator.path = "code"
* component ^slicing.rules = #closed

* component contains
    systolic 1..1 MS and
    diastolic 1..1 MS

* component[systolic].code = $LOINC#8480-6 "Systolic blood pressure"
* component[systolic].valueQuantity only Quantity
* component[systolic].valueQuantity.system = $UCUM
* component[systolic].valueQuantity.code = #mm[Hg]

* component[diastolic].code = $LOINC#8462-4 "Diastolic blood pressure"
* component[diastolic].valueQuantity only Quantity
* component[diastolic].valueQuantity.system = $UCUM
* component[diastolic].valueQuantity.code = #mm[Hg]

Profile: OxygenSaturationObservation
Parent: LifestyleVitalSigns
Id: oxygen-saturation-observation
Title: "Oxygen Saturation Observation Profile"
Description: "Profile for SpO2 measurements from iOS Health App"

* code = $LOINC#2708-6 "Oxygen saturation in Arterial blood"
* valueQuantity.system = $UCUM
* valueQuantity.code = #%



// ===== Conteúdo de: PhysicalActivityProfile.fsh =====

Alias: $LOINC = http://loinc.org
Alias: $SNOMED = http://snomed.info/sct
Alias: $UCUM = http://unitsofmeasure.org
Alias: $ActivityCodes = https://2rdoc.pt/ig/ios-lifestyle-medicine/activity-codes

Profile: PhysicalActivityObservation
Parent: Observation
Id: physical-activity-observation
Title: "Physical Activity Observation Profile"
Description: "Profile for recording physical activity data from iOS Health App"

* status MS
* category 1..1 MS
* category = http://terminology.hl7.org/CodeSystem/observation-category#activity
* code 1..1 MS
* code from PhysicalActivityTypeVS (required)
* subject 1..1 MS
* subject only Reference(Patient)
* effectiveDateTime 1..1 MS
* device 0..1 MS
* value[x] only Quantity
* component ^slicing.discriminator.type = #pattern
* component ^slicing.discriminator.path = "code"
* component ^slicing.rules = #open

* component contains
    steps 0..1 MS and
    distance 0..1 MS and
    duration 0..1 MS and
    energy 0..1 MS

* component[steps].code = $LOINC#55423-8 "Number of steps in 24 hour Measured"
* component[steps].valueQuantity only Quantity
* component[steps].valueQuantity.system = $UCUM
* component[steps].valueQuantity.code = #1 "count"

* component[distance].code = $LOINC#55430-3 "Distance walked"
* component[distance].valueQuantity only Quantity
* component[distance].valueQuantity.system = $UCUM
* component[distance].valueQuantity.code = #km "kilometer"

* component[duration].code = $LOINC#55411-3 "Exercise duration"
* component[duration].valueQuantity only Quantity
* component[duration].valueQuantity.system = $UCUM
* component[duration].valueQuantity.code = #min "minute"

* component[energy].code = $LOINC#55424-6 "Energy expenditure"
* component[energy].valueQuantity only Quantity
* component[energy].valueQuantity.system = $UCUM
* component[energy].valueQuantity.code = #kcal "kilocalorie"



// ===== Conteúdo de: ReproductiveObservation.fsh =====

Profile: ReproductiveObservation
Parent: Observation
Id: reproductive-observation
Title: "Reproductive Health Base Profile"
Description: "Base profile for reproductive health observations"

* ^version = "1.0.0"
* ^status = #active
* ^date = "2024-03-19"

* status MS
* category 1..1 MS
* category = http://terminology.hl7.org/CodeSystem/observation-category#reproductive
* code 1..1 MS
* subject 1..1 MS
* subject only Reference(Patient)
* effectiveDateTime 1..1 MS
* value[x] MS

* component ^slicing.discriminator.type = #pattern
* component ^slicing.discriminator.path = "code"
* component ^slicing.rules = #open

* component contains
    severity 0..1 MS and
    duration 0..1 MS and
    frequency 0..1 MS and
    pattern 0..1 MS

* component[severity]
  * code = $LOINC#72514-3
  * value[x] only integer
  * valueInteger 1..1 
  * valueInteger obeys rep-1

* component[duration]
  * code = $LOINC#103332-8
  * value[x] only Quantity
  * valueQuantity from DurationUnitsVS (required)

* component[frequency]
  * code = $LOINC#103334-4
  * value[x] only CodeableConcept
  * valueCodeableConcept from SymptomFrequencyVS (required)

* component[pattern]
  * code = $LOINC#103335-1
  * value[x] only CodeableConcept
  * valueCodeableConcept from SymptomProgressionVS (required)

Invariant: rep-1
Description: "Severity must be between 0 and 10"
Expression: "$this >= 0 and $this <= 10"
Severity: #error



// ===== Conteúdo de: SymptomProfiles.fsh =====

Profile: SymptomQuestionnaire
Parent: Questionnaire
Id: symptom-questionnaire
Title: "Symptom Assessment Questionnaire"
Description: "Questionnaire template for symptom assessments"

* status MS
* title MS
* item MS

* item ^slicing.discriminator.type = #pattern
* item ^slicing.discriminator.path = "linkId"
* item ^slicing.rules = #open

* item contains
    symptomType 1..1 MS and
    location 0..1 MS and
    onset 0..1 MS and
    description 0..1 MS

* item[symptomType].linkId = "symptom-type"
* item[symptomType].text = "Type of Symptom"
* item[symptomType].type = #choice
* item[symptomType].required = true

* item[location].linkId = "location"
* item[location].text = "Location"
* item[location].type = #string

* item[onset].linkId = "onset"
* item[onset].text = "When did it start?"
* item[onset].type = #dateTime

* item[description].linkId = "description"
* item[description].text = "Description"
* item[description].type = #text



// ===== Conteúdo de: ReproductiveProfiles.fsh =====

Profile: FertilityObservation
Parent: Observation
Id: fertility-observation
Title: "Fertility Observation Profile"
Description: "Profile for fertility signs and symptoms"

* status MS
* category 1..1 MS
* category = http://terminology.hl7.org/CodeSystem/observation-category#reproductive
* code = $LOINC#8669-4 "Ovulation status"
* subject 1..1 MS
* effectiveDateTime 1..1 MS

* component ^slicing.discriminator.type = #pattern
* component ^slicing.discriminator.path = "code"
* component ^slicing.rules = #open

* component contains
    cervicalMucus 0..1 MS and
    ovulationTest 0..1 MS and
    fertilityStatus 0..1 MS

* component[cervicalMucus].valueCodeableConcept from https://2rdoc.pt/fhir/ValueSet/cervical-mucus-vs (required)
* component[ovulationTest].valueCodeableConcept from https://2rdoc.pt/fhir/ValueSet/ovulation-test-vs (required)
* component[fertilityStatus].valueCodeableConcept from https://2rdoc.pt/fhir/ValueSet/fertility-status-vs (required)



// ===== Conteúdo de: MindfulnessProfiles.fsh =====

Profile: MindfulnessObservation
Parent: Observation
Id: mindfulness-observation
Title: "Mindfulness Session Observation"
Description: "Profile for recording mindfulness practice sessions and outcomes"

* status MS
* code MS
* subject MS
* effectiveDateTime MS
* performer MS
* value[x] MS
* component MS

* status = #final
* code = $SCT#711415009 "Mindfulness"
* subject only Reference(Patient)
* effectiveDateTime 1..1
* performer only Reference(Practitioner or PractitionerRole)

* component ^slicing.discriminator.type = #pattern
* component ^slicing.discriminator.path = "code"
* component ^slicing.rules = #open

* component contains
    sessionDuration 0..1 and
    stressLevel 0..1 and
    moodState 0..1 and
    relaxationResponse 0..1 and
    mindfulnessType 0..1

* component[sessionDuration]
  * code = $SCT#118682006 "Duration"
  * value[x] only Quantity
  * valueQuantity
    * value 1..1
    * unit = "min"
    * system = "http://unitsofmeasure.org"
    * code = #min

* component[stressLevel]
  * code = $SCT#725854004 "Assessment of stress level"
  * value[x] only integer
  * valueInteger
    * ^extension[0].url = "http://hl7.org/fhir/StructureDefinition/elementdefinition-minValueInteger"
    * ^extension[0].valueInteger = 0
    * ^extension[1].url = "http://hl7.org/fhir/StructureDefinition/elementdefinition-maxValueInteger"
    * ^extension[1].valueInteger = 10

* component[moodState]
  * code = $SCT#373931001 "Mood finding"
  * value[x] only CodeableConcept
  * valueCodeableConcept from https://2rdoc.pt/fhir/ValueSet/mood (required)

* component[relaxationResponse]
  * code = $SCT#276241001 "Relaxation technique"
  * value[x] only string

* component[mindfulnessType]
  * code = $SCT#711415009 "Mindfulness"
  * value[x] only CodeableConcept
  * valueCodeableConcept from https://2rdoc.pt/fhir/ValueSet/mindfulness-type (required)



// ===== Conteúdo de: SleepProfile.fsh =====

Alias: $SCT = http://snomed.info/sct
Alias: $LOINC = http://loinc.org
Alias: $UCUM = http://unitsofmeasure.org
 
Profile: SleepObservation
Parent: Observation
Id: sleep-observation
Title: "Sleep Observation Profile"
Description: "Profile for recording sleep data from iOS Health App"
 
* status MS
* category 1..1 MS
* category = http://terminology.hl7.org/CodeSystem/observation-category#sleep
* code 1..1 MS
* code = $LOINC#93832-4 "Sleep pattern panel"
* subject 1..1 MS
* subject only Reference(Patient)
* effectiveDateTime 0..1 MS
* effectivePeriod 0..1 MS
* device 0..1 MS
 
* component ^slicing.discriminator.type = #pattern
* component ^slicing.discriminator.path = "code"
* component ^slicing.rules = #open
 
* component contains
    timeInBed 1..1 MS and
    totalSleepTime 1..1 MS and
    deepSleep 0..1 MS and
    remSleep 0..1 MS and
    lightSleep 0..1 MS and
    respiratoryRate 0..1 MS and
    heartRateVariability 0..1 MS and
    interruptions 0..1 MS
 
* component[timeInBed].code = $LOINC#93831-6 "Time in bed"
* component[timeInBed].valueQuantity only Quantity
* component[timeInBed].valueQuantity.system = $UCUM
* component[timeInBed].valueQuantity.code = #min
 
* component[totalSleepTime].code = $LOINC#93833-2 "Sleep duration"
* component[totalSleepTime].valueQuantity only Quantity
* component[totalSleepTime].valueQuantity.system = $UCUM
* component[totalSleepTime].valueQuantity.code = #min
 
* component[deepSleep].code = $LOINC#93834-0 "Deep sleep duration"
* component[deepSleep].valueQuantity only Quantity
* component[deepSleep].valueQuantity.system = $UCUM
* component[deepSleep].valueQuantity.code = #min
 
* component[remSleep].code = $LOINC#93835-7 "REM sleep duration"
* component[remSleep].valueQuantity only Quantity
* component[remSleep].valueQuantity.system = $UCUM
* component[remSleep].valueQuantity.code = #min
 
* component[lightSleep].code = $LOINC#93836-5 "Light sleep duration"
* component[lightSleep].valueQuantity only Quantity
* component[lightSleep].valueQuantity.system = $UCUM
* component[lightSleep].valueQuantity.code = #min
 
* component[respiratoryRate].code = $LOINC#9279-1 "Respiratory rate"
* component[respiratoryRate].valueQuantity only Quantity
* component[respiratoryRate].valueQuantity.system = $UCUM
* component[respiratoryRate].valueQuantity.code = #/min
 
* component[heartRateVariability].code = $LOINC#80404-7 "R-R interval.standard deviation (Heart rate variability)"
* component[heartRateVariability].valueQuantity only Quantity
* component[heartRateVariability].valueQuantity.system = $UCUM
* component[heartRateVariability].valueQuantity.code = #ms
 
* component[interruptions].code = $LOINC#93837-3 "Number of awakenings during sleep"
* component[interruptions].valueQuantity only Quantity
* component[interruptions].valueQuantity.system = $UCUM
* component[interruptions].valueQuantity.code = #{count}
* extension contains SleepQuality named quality 0..1



// ===== Conteúdo de: MobilityRiskAssessment.fsh =====

Profile: MobilityRiskAssessment
Parent: RiskAssessment
Id: mobility-risk-assessment
Title: "Mobility Risk Assessment Profile"
Description: "Profile for assessing mobility-related risks"

* status MS
* subject 1..1 MS
* occurrence[x] MS
* prediction MS
  * outcome MS
  * probability[x] MS
  * qualitativeRisk MS

* method MS
  * coding ^slicing.discriminator.type = #pattern
  * coding ^slicing.discriminator.path = "$this"
  * coding ^slicing.rules = #open
  * coding contains
      mobilityAssessment 1..1 MS

* method.coding[mobilityAssessment] = https://2rdoc.pt/fhir/CodeSystem/mobility-assessment-method#standardized "Standardized Mobility Assessment"

* prediction ^slicing.discriminator.type = #pattern
* prediction ^slicing.discriminator.path = "outcome"
* prediction ^slicing.rules = #open

* prediction contains
    fallRisk 0..1 MS and
    mobilityDecline 0..1 MS and
    assistanceNeeded 0..1 MS

* prediction[fallRisk].outcome from https://2rdoc.pt/fhir/ValueSet/fall-risk-outcomes
* prediction[fallRisk].probabilityDecimal 0..1 MS
* prediction[fallRisk].qualitativeRisk from https://2rdoc.pt/fhir/ValueSet/risk-level

* prediction[mobilityDecline].outcome from https://2rdoc.pt/fhir/ValueSet/mobility-decline-outcomes
* prediction[mobilityDecline].probabilityDecimal 0..1 MS
* prediction[mobilityDecline].qualitativeRisk from https://2rdoc.pt/fhir/ValueSet/risk-level

* prediction[assistanceNeeded].outcome from https://2rdoc.pt/fhir/ValueSet/assistance-level-outcomes
* prediction[assistanceNeeded].probabilityDecimal 0..1 MS
* prediction[assistanceNeeded].qualitativeRisk from https://2rdoc.pt/fhir/ValueSet/risk-level

* basis only Reference(MobilityProfile or Observation or QuestionnaireResponse)
* basis MS

* note MS



// ===== Conteúdo de: EnvironmentalProfiles.fsh =====

Alias: $SCT = http://snomed.info/sct
Alias: $LOINC = http://loinc.org
Alias: $UCUM = http://unitsofmeasure.org

Profile: EnvironmentalObservation
Parent: Observation
Id: environmental-observation
Title: "Environmental Observation Profile"
Description: "Base profile for environmental measurements from iOS Health App"

* ^version = "0.1.0"
* ^status = #draft
* ^publisher = "HL7 International"
* ^contact.name = "Environmental Health Working Group"

* status MS
* category 1..1 MS
* category = http://terminology.hl7.org/CodeSystem/observation-category#environment
* subject 1..1 MS
* effectiveDateTime 1..1 MS
* device 0..1 MS
* method 0..1 MS
* note 0..* MS

Profile: NoiseExposureObservation
Parent: EnvironmentalObservation
Id: noise-exposure-observation
Title: "Noise Exposure Observation Profile"
Description: "Profile for noise exposure measurements from iOS Health App"

* code = $LOINC#28573-7 "Noise exposure time"
* component ^slicing.discriminator.type = #pattern
* component ^slicing.discriminator.path = "code"
* component ^slicing.rules = #open
* component ^short = "Noise exposure components"
* component ^definition = "Components of noise exposure measurement"

* component contains
    level 1..1 MS and
    duration 1..1 MS and
    peakLevel 0..1 MS and
    backgroundNoise 0..1 MS

* component[level].code = $LOINC#89020-2 "Environmental noise average"
* component[level].valueQuantity.system = $UCUM
* component[level].valueQuantity.code = #dB
* component[level].valueQuantity ^short = "Noise level in decibels"

* component[duration].code = $LOINC#89021-0 "Environmental noise duration"
* component[duration].valueQuantity.system = $UCUM
* component[duration].valueQuantity.code = #min
* component[duration].valueQuantity ^short = "Duration of exposure"

* component[peakLevel].code = $LOINC#89024-4 "Peak sound level"
* component[peakLevel].valueQuantity.system = $UCUM
* component[peakLevel].valueQuantity.code = #dB
* component[peakLevel].valueQuantity ^short = "Peak noise level"

* component[backgroundNoise].code = $LOINC#89025-1 "Background noise level"
* component[backgroundNoise].valueQuantity.system = $UCUM
* component[backgroundNoise].valueQuantity.code = #dB
* component[backgroundNoise].valueQuantity ^short = "Background noise level"

Profile: UVExposureObservation
Parent: EnvironmentalObservation
Id: uv-exposure-observation
Title: "UV Exposure Observation Profile"
Description: "Profile for UV exposure measurements from iOS Health App"

* code = $LOINC#28574-5 "UV exposure"
* component ^slicing.discriminator.type = #pattern
* component ^slicing.discriminator.path = "code"
* component ^slicing.rules = #open
* component ^short = "UV exposure components"
* component ^definition = "Components of UV exposure measurement"

* component contains
    index 1..1 MS and
    duration 1..1 MS and
    timeOfDay 0..1 MS and
    intensity 0..1 MS

* component[index].code = $LOINC#89022-8 "UV index"
* component[index].valueQuantity.system = $UCUM
* component[index].valueQuantity.code = #{index}
* component[index].valueQuantity ^short = "UV index value"

* component[duration].code = $LOINC#89023-6 "UV exposure duration"
* component[duration].valueQuantity.system = $UCUM
* component[duration].valueQuantity.code = #min
* component[duration].valueQuantity ^short = "Duration of UV exposure"

* component[timeOfDay].code = $LOINC#89026-9 "Time of exposure"
* component[timeOfDay].valueDateTime 1..1
* component[timeOfDay].valueDateTime ^short = "Time of UV exposure"

* component[intensity].code = $LOINC#89027-7 "UV intensity"
* component[intensity].valueQuantity.system = $UCUM
* component[intensity].valueQuantity.code = #W/m2
* component[intensity].valueQuantity ^short = "UV radiation intensity"

Extension: EnvironmentalContext
Id: environmental-context
Title: "Environmental Context Extension"
Description: "Additional context about environmental measurements"

* value[x] only CodeableConcept
* valueCodeableConcept from https://2rdoc.pt/fhir/ValueSet/environmental-context (required)



// ===== Conteúdo de: SocialInteractionProfile.fsh =====

Profile: SocialInteractionProfile
Parent: Observation
Id: social-interaction
Title: "Social Interaction Profile"
Description: "Profile for recording social interaction data from iOS Health App"

* ^version = "0.1.0"
* ^status = #active
* ^date = "2024-01-03"
* ^publisher = "FMUP HEADS2"

* status MS
* category 1..1 MS
* category = http://terminology.hl7.org/CodeSystem/observation-category#social-history
* code 1..1 MS
* code = $LOINC#96766-1 "Social interaction pattern"
* subject 1..1 MS
* effectiveDateTime 1..1 MS
* value[x] only CodeableConcept
* valueCodeableConcept from SocialInteractionTypeVS (required)

* component ^slicing.discriminator.type = #pattern
* component ^slicing.discriminator.path = "code"
* component ^slicing.rules = #open

* component contains
    duration 0..1 MS and
    quality 0..1 MS and
    medium 0..1 MS and
    participants 0..1 MS

* component[duration]
  * code = $LOINC#89597-9 "Social interaction duration"
  * valueQuantity only Quantity
  * valueQuantity.system = $UCUM
  * valueQuantity.code = #min

* component[quality]
  * code = $LOINC#89598-7 "Social interaction quality"
  * valueCodeableConcept from SocialInteractionQualityVS (required)

* component[medium]
  * code = $LOINC#89599-5 "Social interaction medium"
  * valueCodeableConcept from SocialInteractionMediumVS (required)

* component[participants]
  * code = $LOINC#89600-1 "Social interaction participants"
  * valueInteger only integer

* extension contains
    SocialContext named context 0..1 MS and
    SocialSupport named support 0..1 MS and
    SocialActivity named activity 0..* MS



// ===== Conteúdo de: StressLevelProfile.fsh =====

Profile: StressLevelProfile
Parent: Observation
Id: stress-level
Title: "Stress Level Profile"
Description: "Profile for recording stress level measurements from iOS Health App"

* ^version = "0.1.0"
* ^status = #active
* ^date = "2024-01-03"
* ^publisher = "FMUP HEADS2"

* status MS
* category 1..1 MS
* category = http://terminology.hl7.org/CodeSystem/observation-category#vital-signs
* code 1..1 MS
* code = $LOINC#89592-0 "Stress level score"
* subject 1..1 MS
* effectiveDateTime 1..1 MS
* value[x] only Quantity
* valueQuantity MS

* component ^slicing.discriminator.type = #pattern
* component ^slicing.discriminator.path = "code"
* component ^slicing.rules = #open

* component contains
    physiologicalStress 0..1 MS and
    psychologicalStress 0..1 MS and
    chronicity 0..1 MS and 
    impact 0..1 MS

* component[physiologicalStress]
  * code = $LOINC#89593-8 "Physiological stress"
  * valueQuantity only Quantity
  * valueQuantity.system = $UCUM
  * valueQuantity.code = #{score}

* component[psychologicalStress]
  * code = $LOINC#89594-6 "Psychological stress"
  * valueQuantity only Quantity
  * valueQuantity.system = $UCUM
  * valueQuantity.code = #{score}

* component[chronicity]
  * code = $LOINC#89595-3 "Stress chronicity"
  * valueCodeableConcept from StressChronicityVS (required)

* component[impact]
  * code = $LOINC#89596-1 "Stress impact"
  * valueCodeableConcept from StressImpactVS (required)

* extension contains
    MeasurementContext named context 0..1 MS and
    StressTriggers named triggers 0..* MS and 
    StressCoping named coping 0..* MS



// ===== Conteúdo de: NutritionProfiles.fsh =====

Alias: $SCT = http://snomed.info/sct
Alias: $LOINC = http://loinc.org
Alias: $UCUM = http://unitsofmeasure.org

Profile: NutritionIntakeObservation
Parent: Observation
Id: nutrition-intake-observation
Title: "Nutrition Intake Observation Profile"
Description: "Profile for nutrition intake data from iOS Health App and user input"

* ^version = "0.1.0"
* ^status = #draft
* ^publisher = "Ricardo Lourenço dos Santos"

* status MS
* category 1..1 MS
* category = http://terminology.hl7.org/CodeSystem/observation-category#nutrition
* subject 1..1 MS
* effectiveDateTime 1..1 MS
* code 1..1 MS
* method 0..1 MS

Profile: WaterIntakeObservation
Parent: NutritionIntakeObservation 
Id: water-intake-observation
Title: "Water Intake Observation Profile"
Description: "Profile for water intake measurements"

* ^version = "0.1.0"
* ^status = #draft
* ^publisher = "Ricardo Lourenço dos Santos"

* code = $LOINC#77111-4 "Water intake"
* valueQuantity only Quantity
* valueQuantity.system = $UCUM
* valueQuantity.code = #mL
* valueQuantity.unit = "milliliter"

Profile: CalorieIntakeObservation
Parent: NutritionIntakeObservation
Id: calorie-intake-observation
Title: "Calorie Intake Observation Profile"
Description: "Profile for caloric intake measurements"

* ^version = "0.1.0"
* ^status = #draft
* ^publisher = "Ricardo Lourenço dos Santos"

* code = $LOINC#9051-4 "Caloric intake total"
* valueQuantity only Quantity
* valueQuantity.system = $UCUM
* valueQuantity.code = #kcal
* valueQuantity.unit = "kilocalorie"

Profile: MacronutrientsObservation
Parent: NutritionIntakeObservation
Id: macronutrients-observation
Title: "Macronutrients Observation Profile"
Description: "Profile for macronutrient intake measurements"

* ^version = "0.1.0"
* ^status = #draft
* ^publisher = "Ricardo Lourenço dos Santos"

* code = $LOINC#LP199119-9 "Macronutrients panel"
* component ^slicing.discriminator.type = #pattern
* component ^slicing.discriminator.path = "code"
* component ^slicing.rules = #open

* component contains
    carbohydrates 0..1 MS and
    proteins 0..1 MS and
    fats 0..1 MS

* component[carbohydrates].code = $LOINC#LP35925-4 "Carbohydrates"
* component[carbohydrates].valueQuantity.system = $UCUM
* component[carbohydrates].valueQuantity.code = #g
* component[carbohydrates].valueQuantity.unit = "gram"

* component[proteins].code = $LOINC#LP35921-3 "Proteins" 
* component[proteins].valueQuantity.system = $UCUM
* component[proteins].valueQuantity.code = #g
* component[proteins].valueQuantity.unit = "gram"

* component[fats].code = $LOINC#LP35922-1 "Fats"
* component[fats].valueQuantity.system = $UCUM
* component[fats].valueQuantity.code = #g
* component[fats].valueQuantity.unit = "gram"



// ===== Conteúdo de: MultiJurisdictionalConsent.fsh =====

// ====== Perfil Multi-Jurisdicional de Consent ======

Profile: MultiJurisdictionalConsent
Parent: Consent
Id: multi-jurisdictional-consent
Title: "Multi-Jurisdictional Healthcare Consent"
Description: "Consent profile supporting GDPR, HIPAA, and LGPD compliance"

* status MS
* scope MS
* category MS
* patient 1..1 MS
* dateTime 1..1 MS

// Múltiplas políticas para diferentes jurisdições
* policy 1..* MS
* policy ^slicing.discriminator.type = #value
* policy ^slicing.discriminator.path = "authority"
* policy ^slicing.rules = #open

* policy contains
    gdpr 0..1 MS and
    hipaa 0..1 MS and
    lgpd 0..1 MS

* policy[gdpr].authority = "https://eur-lex.europa.eu/eli/reg/2016/679/oj"
* policy[gdpr].uri 1..1 MS

* policy[hipaa].authority = "https://www.hhs.gov/hipaa/index.html"  
* policy[hipaa].uri 1..1 MS

* policy[lgpd].authority = "http://www.planalto.gov.br/ccivil_03/_ato2015-2018/2018/lei/L13709compilado.htm"
* policy[lgpd].uri 1..1 MS

// Extensões de compliance
* extension contains
    RegulatoryBasis named regulatoryBasis 0..* MS and
    JurisdictionApplicability named jurisdiction 0..* MS and
    DataLocalization named dataLocalization 0..* MS

// Provisions com segurança
* provision MS
* provision.type MS
* provision.period MS
* provision.actor MS
* provision.action MS
* provision.securityLabel MS
* provision.purpose MS
* provision.dataPeriod MS



// ===== Conteúdo de: MindfulnessMessaging.fsh =====

Alias: $MsgEvents = https://2rdoc.pt/fhir/CodeSystem/mindfulness-message-events
Alias: $MsgTypes = http://terminology.hl7.org/CodeSystem/message-type

Profile: MindfulnessMessageDefinition
Parent: MessageDefinition
Id: mindfulness-message-definition
Title: "Mindfulness Message Definition" 
Description: "Definition for mindfulness session messages"

* url 1..1 MS
* date 1..1 MS
* status 1..1 MS
* event[x] 1..1 MS
* category 0..1 MS
* focus 1..* MS
* focus.min 1..1

Instance: StartSessionMessage
InstanceOf: MindfulnessMessageDefinition
Title: "Start Session Message"
Description: "Message definition for starting a mindfulness session"

* url = "https://2rdoc.pt/ig/ios-lifestyle-medicine/MessageDefinition/start-session"
* date = "2024-03-19"
* status = #active
* eventCoding = $MsgEvents#session-start "Session Start"
* category = #notification
* focus.code = #Observation
* focus.min = 1
* focus.profile = "https://2rdoc.pt/ig/ios-lifestyle-medicine/StructureDefinition/mindfulness-session"

Instance: EndSessionMessage  
InstanceOf: MindfulnessMessageDefinition
Title: "End Session Message"
Description: "Message definition for ending a mindfulness session"

* url = "https://2rdoc.pt/ig/ios-lifestyle-medicine/MessageDefinition/end-session"
* date = "2024-03-19"
* status = #active
* eventCoding = $MsgEvents#session-end "Session End"
* category = #notification
* focus.code = #Observation
* focus.min = 1
* focus.profile = "https://2rdoc.pt/ig/ios-lifestyle-medicine/StructureDefinition/mindfulness-session"



// ===== Conteúdo de: PractitionerNamingSystem.fsh =====

// ====== CodeSystem para Identificadores de Practitioners ======

CodeSystem: PractitionerIdentifierCS
Id: practitioner-identifier-cs
Title: "Practitioner Identifier Code System"
Description: "Sistema de códigos para identificação de practitioners"
* ^status = #active
* ^experimental = false
* ^caseSensitive = true
* #npi "National Provider Identifier" "US National Provider Identifier"
* #crm "Conselho Regional de Medicina" "Brazilian Medical Council Registration"
* #ssin "Social Security Identification Number" "Belgian SSIN"
* #rpps "Répertoire Partagé des Professionnels de Santé" "French Healthcare Professional Registry"

ValueSet: PractitionerIdentifierVS
Id: practitioner-identifier-vs
Title: "Practitioner Identifier Value Set"
Description: "Value set para identificadores de practitioners"
* ^status = #active
* ^experimental = false
* include codes from system PractitionerIdentifierCS



// ===== Conteúdo de: MindfulnessReports.fsh =====

Instance: MindfulnessProgressReport
InstanceOf: Measure
Usage: #definition
Title: "Mindfulness Practice Progress Report"
Description: "Example instance of MindfulnessProgressReport"
* status = #active
* experimental = false
* date = "2024-03-19"
* publisher = "Example Organization"
* description = "Measures progress in mindfulness practice over time"

* scoring = #continuous-variable
* type = #process
* riskAdjustment = "none"
* rateAggregation = "Average values over time period"

* group[0]
  * code = #practice-frequency
  * description = "Frequency of mindfulness practice"
  * population[0]
    * code = #denominator
    * criteria.language = #text/fhirpath
    * criteria.expression = "Observation.where(code.coding.code='711415009')"
  * stratifier[0]
    * code = #weekly
    * criteria.language = #text/fhirpath
    * criteria.expression = "Observation.effective.as(DateTime).truncate(@T).truncate(@W)"

* group[1]
  * code = #stress-reduction
  * description = "Stress level changes over time"
  * population[0]
    * code = #denominator
    * criteria.language = #text/fhirpath
    * criteria.expression = "Observation.where(component.code.coding.code='725854004')"
  * stratifier[0]
    * code = #trend
    * criteria.language = #text/fhirpath
    * criteria.expression = "component.where(code.coding.code='725854004').value.value"

RuleSet: ReportingMetrics
* group[+]
  * code = #session-duration
  * description = "Duration of practice sessions"
  * population[0]
    * code = #denominator
    * criteria.language = #text/fhirpath
    * criteria.expression = "Observation.component.where(code.coding.code='118682006')"
  * stratifier[0]
    * code = #average
    * criteria.language = #text/fhirpath
    * criteria.expression = "component.where(code.coding.code='118682006').value.value"

* group[+]
  * code = #mood-changes
  * description = "Mood state changes"
  * population[0]
    * code = #denominator
    * criteria.language = #text/fhirpath
    * criteria.expression = "Observation.component.where(code.coding.code='373931001')"



// ===== Conteúdo de: BodyMetricsExtensions.fsh =====

Alias: $SCT = http://snomed.info/sct

Extension: MeasurementConditions
Id: measurement-conditions
Title: "Measurement Conditions Extension"
Description: "Records the conditions under which body measurements were taken"

* ^version = "0.1.0"
* ^status = #draft
* ^context[0].type = #element
* ^context[0].expression = "Observation"

* value[x] only CodeableConcept
* valueCodeableConcept from MeasurementConditionsVS (required)

Extension: MeasurementDevice
Id: measurement-device-type
Title: "Measurement Device Type Extension"
Description: "Specifies the type of device used for body measurements"

* ^version = "0.1.0"
* ^status = #draft
* ^context[0].type = #element
* ^context[0].expression = "Observation"

* value[x] only CodeableConcept
* valueCodeableConcept from MeasurementDeviceTypeVS (required)

ValueSet: MeasurementConditionsVS
Id: measurement-conditions-vs
Title: "Measurement Conditions Value Set"
Description: "Standard conditions under which measurements are taken"

* ^version = "0.1.0"
* ^status = #draft

* $SCT#307818003 "Pre-breakfast"
* $SCT#307819006 "Post-exercise"
* $SCT#307820000 "Wearing light clothing"
* $SCT#255203001 "First thing in morning"
* $SCT#255214005 "After void"
* $SCT#309604004 "During rest"

ValueSet: MeasurementDeviceTypeVS
Id: measurement-device-type-vs
Title: "Measurement Device Type Value Set"
Description: "Types of devices used for health and body measurements"

* ^version = "0.1.0"
* ^status = #draft

* $SCT#469576000 "Smart watch"
* $SCT#706767009 | display = "Patient data recorder"
* $SCT#131009002 "Height measuring device"
* $SCT#706889009 "Blood pressure monitor"
* $SCT#444699000 "Tape measure"
* $SCT#44056008  "Digital scale"

Instance: WeightWithConditions
InstanceOf: WeightObservation
Usage: #example
Description: "Weight with conditions observation example"
Title: "Weight Measurement with Conditions Example"

* status = #final
* category = http://terminology.hl7.org/CodeSystem/observation-category#vital-signs
* code = $LOINC#29463-7 "Body weight"
* subject = Reference(Patient/example)
* effectiveDateTime = "2024-03-19T08:00:00Z"
* valueQuantity = 70.5 'kg'

* extension[measurement-conditions].url = "https://2rdoc.pt/ig/ios-lifestyle-medicine/StructureDefinition/measurement-conditions"
* extension[measurement-conditions].valueCodeableConcept = $SCT#307818003 "Pre-breakfast"

* extension[measurement-device-type].url = "https://2rdoc.pt/ig/ios-lifestyle-medicine/StructureDefinition/measurement-device-type"
* extension[measurement-device-type].valueCodeableConcept = $SCT#469576000 "Smart scale device"



// ===== Conteúdo de: PhysicalActivityExamples.fsh =====

Instance: PhysicalActivityExample1
InstanceOf: PhysicalActivityObservation
Usage: #example
Description: "Physical activity observation example"
Title: "Example of Walking Activity"
* status = #final
* category = http://terminology.hl7.org/CodeSystem/observation-category#activity
* code = $SNOMED#228557008 "Walking"
* subject = Reference(PatientExample)
* effectiveDateTime = "2024-03-19T15:30:00Z"
* device = Reference(DeviceActivityTracker)
* component[steps].code = $LOINC#55423-8 "Number of steps in 24 hour Measured"
* component[steps].valueQuantity = 8546 '1' "count"
* component[steps].valueQuantity.system = $UCUM
* component[steps].valueQuantity.unit = "count"
* component[distance].code = $LOINC#55430-3 "Distance walked"
* component[distance].valueQuantity = 6.2 'km' "kilometer"
* component[distance].valueQuantity.system = $UCUM
* component[distance].valueQuantity.unit = "kilometer"
* component[duration].code = $LOINC#55411-3 "Exercise duration"
* component[duration].valueQuantity = 72 'min' "minute"
* component[duration].valueQuantity.system = $UCUM
* component[duration].valueQuantity.unit = "minute"
* component[energy].code = $LOINC#55424-6 "Energy expenditure"
* component[energy].valueQuantity = 320 'kcal' "kilocalorie"
* component[energy].valueQuantity.system = $UCUM
* component[energy].valueQuantity.unit = "kilocalorie"

Instance: DeviceActivityTracker
InstanceOf: Device
Usage: #example
Description: "Activity tracker device example"
Title: "Activity Tracking Device"
* deviceName.name = "Health Activity Tracker"
* deviceName.type = #user-friendly-name
* manufacturer = "HealthTech Devices"
* modelNumber = "HAT-2024"
* type = $SCT#258158006 | display = "Breathing rate"



// ===== Conteúdo de: BodyMetricsExamples.fsh =====

Instance: WeightExample
InstanceOf: WeightObservation
Usage: #example
Description: "Weight observation example"
Title: "Weight Measurement Example"
* status = #final
* category = http://terminology.hl7.org/CodeSystem/observation-category#vital-signs
* code = $LOINC#29463-7 "Body weight"
* subject = Reference(PatientExample)
* performer = Reference(PractitionerExample)
* effectiveDateTime = "2024-03-19T08:00:00Z"
* valueQuantity = 70.5 'kg' "kilogram"
* valueQuantity.system = $UCUM
* valueQuantity.unit = "kilogram"
* device = Reference(SmartScale)

Instance: HeightExample
InstanceOf: HeightObservation
Usage: #example
Description: "Height observation example"
Title: "Height Measurement Example"
* status = #final
* category = http://terminology.hl7.org/CodeSystem/observation-category#vital-signs
* code = $LOINC#8302-2 "Body height"
* subject = Reference(PatientExample)
* performer = Reference(PractitionerExample)
* effectiveDateTime = "2024-03-19T08:00:00Z"
* valueQuantity = 175 'cm' "centimeter"
* valueQuantity.system = $UCUM
* valueQuantity.unit = "centimeter"

Instance: BMIExample
InstanceOf: BMIObservation
Usage: #example
Description: "Body Mass Index observation example"
Title: "BMI Calculation Example"
* status = #final
* category = http://terminology.hl7.org/CodeSystem/observation-category#vital-signs
* code = $LOINC#39156-5 "Body mass index (BMI)"
* subject = Reference(PatientExample)
* performer = Reference(PractitionerExample)
* effectiveDateTime = "2024-03-19T08:00:00Z"
* valueQuantity = 23.0 'kg/m2' "kilogram per square meter"
* valueQuantity.system = $UCUM
* valueQuantity.unit = "kilogram per square meter"
* derivedFrom[0] = Reference(Observation/WeightExample)
* derivedFrom[1] = Reference(Observation/HeightExample)

Instance: BodyCompositionExample
InstanceOf: BodyCompositionObservation
Usage: #example
Description: "Body composition observation example"
Title: "Body Composition Measurement Example" 
* status = #final
* category = http://terminology.hl7.org/CodeSystem/observation-category#vital-signs
* code = $LOINC#88365-2 "Body composition panel"
* subject = Reference(PatientExample)
* performer = Reference(PractitionerExample)
* effectiveDateTime = "2024-03-19T08:00:00Z"
* device = Reference(BioimpedanceAnalyzer)

* component[bodyFat].code = $LOINC#41982-0 "Percentage body fat"
* component[bodyFat].valueQuantity = 22.5 '%' "percent"
* component[bodyFat].valueQuantity.system = $UCUM
* component[bodyFat].valueQuantity.unit = "percent"

* component[leanMass].code = $LOINC#291-7 "Lean body mass"
* component[leanMass].valueQuantity = 54.6 'kg' "kilogram"
* component[leanMass].valueQuantity.system = $UCUM
* component[leanMass].valueQuantity.unit = "kilogram"

* component[bodyWater].code = $LOINC#73708-0 "Total body water"
* component[bodyWater].valueQuantity = 39.2 'L' "liter"
* component[bodyWater].valueQuantity.system = $UCUM
* component[bodyWater].valueQuantity.unit = "liter"

* component[muscleMass].code = $LOINC#73713-0 "Muscle mass"
* component[muscleMass].valueQuantity = 51.8 'kg' "kilogram"
* component[muscleMass].valueQuantity.system = $UCUM
* component[muscleMass].valueQuantity.unit = "kilogram"

* component[boneMass].code = $LOINC#73711-4 "Bone mass"
* component[boneMass].valueQuantity = 2.8 'kg' "kilogram"
* component[boneMass].valueQuantity.system = $UCUM
* component[boneMass].valueQuantity.unit = "kilogram"

Instance: SmartScale
InstanceOf: Device
Usage: #example
Description: "Smart scale device example"
Title: "Smart Scale Device"
* deviceName.name = "Smart Body Analyzer"
* deviceName.type = #user-friendly-name
* manufacturer = "HealthTech Devices"
* modelNumber = "SBA-2024"
* type = $SCT#469576000 "Digital scale device"

Instance: BioimpedanceAnalyzer  
InstanceOf: Device
Usage: #example
Description: "Bioimpedance analyzer device example"
Title: "Bioimpedance Analyzer Device"
* deviceName.name = "Professional Body Composition Analyzer"
* deviceName.type = #user-friendly-name
* manufacturer = "MedTech Solutions"
* modelNumber = "BCA-Pro"
* type = $SCT#706767009 | display = "Patient data recorder"



// ===== Conteúdo de: BodyMetricsExtensions.fsh =====

Alias: $SCT = http://snomed.info/sct

Extension: MeasurementConditions
Id: measurement-conditions
Title: "Measurement Conditions Extension"
Description: "Records the conditions under which body measurements were taken"

* ^version = "0.1.0"
* ^status = #draft
* ^context[0].type = #element
* ^context[0].expression = "Observation"

* value[x] only CodeableConcept
* valueCodeableConcept from MeasurementConditionsVS (required)

Extension: MeasurementDevice
Id: measurement-device-type
Title: "Measurement Device Type Extension"
Description: "Specifies the type of device used for body measurements"

* ^version = "0.1.0"
* ^status = #draft
* ^context[0].type = #element
* ^context[0].expression = "Observation"

* value[x] only CodeableConcept
* valueCodeableConcept from MeasurementDeviceTypeVS (required)

ValueSet: MeasurementConditionsVS
Id: measurement-conditions-vs
Title: "Measurement Conditions Value Set"
Description: "Standard conditions under which measurements are taken"

* ^version = "0.1.0"
* ^status = #draft

* $SCT#307818003 "Pre-breakfast"
* $SCT#307819006 "Post-exercise"
* $SCT#307820000 "Wearing light clothing"
* $SCT#255203001 "First thing in morning"
* $SCT#255214005 "After void"
* $SCT#309604004 "During rest"

ValueSet: MeasurementDeviceTypeVS
Id: measurement-device-type-vs
Title: "Measurement Device Type Value Set"
Description: "Types of devices used for health and body measurements"

* ^version = "0.1.0"
* ^status = #draft

* $SCT#469576000 "Smart watch"
* $SCT#706767009  'or'  display = "Patient data recorder"
* $SCT#131009002 "Height measuring device"
* $SCT#706889009 "Blood pressure monitor"
* $SCT#444699000 "Tape measure"
* $SCT#44056008  "Digital scale"

Instance: WeightWithConditions
InstanceOf: WeightObservation
Usage: #example
Description: "Weight with conditions observation example"
Title: "Weight Measurement with Conditions Example"

* status = #final
* category = http://terminology.hl7.org/CodeSystem/observation-category#vital-signs
* code = $LOINC#29463-7 "Body weight"
* subject = Reference(Patient/example)
* effectiveDateTime = "2024-03-19T08:00:00Z"
* valueQuantity = 70.5 'kg'

* extension[measurement-conditions].url = "https://2rdoc.pt/ig/ios-lifestyle-medicine/StructureDefinition/measurement-conditions"
* extension[measurement-conditions].valueCodeableConcept = $SCT#307818003 "Pre-breakfast"

* extension[measurement-device-type].url = "https://2rdoc.pt/ig/ios-lifestyle-medicine/StructureDefinition/measurement-device-type"
* extension[measurement-device-type].valueCodeableConcept = $SCT#469576000 "Smart scale device"



// ===== Conteúdo de: MindfulnessDiagnosticMappings.fsh =====

Instance: MindfulnessDiagnosticMap
InstanceOf: ConceptMap
Usage: #definition
Title: "Mindfulness Diagnostic Mappings"
Description: "Mapping of mindfulness outcomes to diagnostic codes"

* status = #draft
* experimental = false
* purpose = "Map mindfulness outcomes to standard diagnostic codes"
* sourceUri = "https://2rdoc.pt/fhir/ValueSet/mindfulness-outcome-vs"
* targetUri = "http://snomed.info/sct"

* group[0].source = "https://2rdoc.pt/fhir/CodeSystem/mindfulness-outcome-cs"
* group[0].target = "http://snomed.info/sct"
* group[0].element[0]
  * code = #stressReduction
  * target[0]
    * code = #73595000
    * display = "Stress"
    * equivalence = #narrower
    * comment = "Indicates reduction in stress levels"

* group[0].element[1]
  * code = #improvedSleep
  * target[0]
    * code = #248234008
    * display = "Sleep pattern"
    * equivalence = #narrower
    * comment = "Indicates improvement in sleep quality"

* group[0].element[2]
  * code = #emotionalBalance
  * target[0]
    * code = #285854004
    * display = "Emotional state"
    * equivalence = #equivalent
    * comment = "Maps to emotional state finding"

* group[0].element[3]
  * code = #increasedAwareness
  * target[0]
    * code = #736253002
    * display = "Mental state, behavior and/or psychosocial functioning"
    * equivalence = #relatedto
    * comment = "General improvement in mental state"

RuleSet: MindfulnessDiagnosticRules
* status MS
* code MS
* subject MS
* effective[x] MS
* value[x] MS
* method MS

* method from https://2rdoc.pt/fhir/ValueSet/mindfulness-diagnostic-method-vs (required)
* code from https://2rdoc.pt/fhir/ValueSet/mindfulness-diagnostic-code-vs (required)

* extension contains 
    diagnosticCertainty 0..1 MS and
    diagnosticTiming 0..1 MS



// ===== Conteúdo de: PhysicalActivityExamples.fsh =====

Instance: PhysicalActivityExample1
InstanceOf: PhysicalActivityObservation
Usage: #example
Description: "Physical activity observation example"
Title: "Example of Walking Activity"
* status = #final
* category = http://terminology.hl7.org/CodeSystem/observation-category#activity
* code = $SNOMED#228557008 "Walking"
* subject = Reference(PatientExample)
* effectiveDateTime = "2024-03-19T15:30:00Z"
* device = Reference(DeviceActivityTracker)
* component[steps].code = $LOINC#55423-8 "Number of steps in 24 hour Measured"
* component[steps].valueQuantity = 8546 '1' "count"
* component[steps].valueQuantity.system = $UCUM
* component[steps].valueQuantity.unit = "count"
* component[distance].code = $LOINC#55430-3 "Distance walked"
* component[distance].valueQuantity = 6.2 'km' "kilometer"
* component[distance].valueQuantity.system = $UCUM
* component[distance].valueQuantity.unit = "kilometer"
* component[duration].code = $LOINC#55411-3 "Exercise duration"
* component[duration].valueQuantity = 72 'min' "minute"
* component[duration].valueQuantity.system = $UCUM
* component[duration].valueQuantity.unit = "minute"
* component[energy].code = $LOINC#55424-6 "Energy expenditure"
* component[energy].valueQuantity = 320 'kcal' "kilocalorie"
* component[energy].valueQuantity.system = $UCUM
* component[energy].valueQuantity.unit = "kilocalorie"

Instance: DeviceActivityTracker
InstanceOf: Device
Usage: #example
Description: "Activity tracker device example"
Title: "Activity Tracking Device"
* deviceName.name = "Health Activity Tracker"
* deviceName.type = #user-friendly-name
* manufacturer = "HealthTech Devices"
* modelNumber = "HAT-2024"
* type = $SCT#258158006  'or'  display = "Breathing rate"



// ===== Conteúdo de: BodyMetricsExamples.fsh =====

Instance: WeightExample
InstanceOf: WeightObservation
Usage: #example
Description: "Weight observation example"
Title: "Weight Measurement Example"
* status = #final
* category = http://terminology.hl7.org/CodeSystem/observation-category#vital-signs
* code = $LOINC#29463-7 "Body weight"
* subject = Reference(PatientExample)
* performer = Reference(PractitionerExample)
* effectiveDateTime = "2024-03-19T08:00:00Z"
* valueQuantity = 70.5 'kg' "kilogram"
* valueQuantity.system = $UCUM
* valueQuantity.unit = "kilogram"
* device = Reference(SmartScale)

Instance: HeightExample
InstanceOf: HeightObservation
Usage: #example
Description: "Height observation example"
Title: "Height Measurement Example"
* status = #final
* category = http://terminology.hl7.org/CodeSystem/observation-category#vital-signs
* code = $LOINC#8302-2 "Body height"
* subject = Reference(PatientExample)
* performer = Reference(PractitionerExample)
* effectiveDateTime = "2024-03-19T08:00:00Z"
* valueQuantity = 175 'cm' "centimeter"
* valueQuantity.system = $UCUM
* valueQuantity.unit = "centimeter"

Instance: BMIExample
InstanceOf: BMIObservation
Usage: #example
Description: "Body Mass Index observation example"
Title: "BMI Calculation Example"
* status = #final
* category = http://terminology.hl7.org/CodeSystem/observation-category#vital-signs
* code = $LOINC#39156-5 "Body mass index (BMI)"
* subject = Reference(PatientExample)
* performer = Reference(PractitionerExample)
* effectiveDateTime = "2024-03-19T08:00:00Z"
* valueQuantity = 23.0 'kg/m2' "kilogram per square meter"
* valueQuantity.system = $UCUM
* valueQuantity.unit = "kilogram per square meter"
* derivedFrom[0] = Reference(Observation/WeightExample)
* derivedFrom[1] = Reference(Observation/HeightExample)

Instance: BodyCompositionExample
InstanceOf: BodyCompositionObservation
Usage: #example
Description: "Body composition observation example"
Title: "Body Composition Measurement Example" 
* status = #final
* category = http://terminology.hl7.org/CodeSystem/observation-category#vital-signs
* code = $LOINC#88365-2 "Body composition panel"
* subject = Reference(PatientExample)
* performer = Reference(PractitionerExample)
* effectiveDateTime = "2024-03-19T08:00:00Z"
* device = Reference(BioimpedanceAnalyzer)

* component[bodyFat].code = $LOINC#41982-0 "Percentage body fat"
* component[bodyFat].valueQuantity = 22.5 '%' "percent"
* component[bodyFat].valueQuantity.system = $UCUM
* component[bodyFat].valueQuantity.unit = "percent"

* component[leanMass].code = $LOINC#291-7 "Lean body mass"
* component[leanMass].valueQuantity = 54.6 'kg' "kilogram"
* component[leanMass].valueQuantity.system = $UCUM
* component[leanMass].valueQuantity.unit = "kilogram"

* component[bodyWater].code = $LOINC#73708-0 "Total body water"
* component[bodyWater].valueQuantity = 39.2 'L' "liter"
* component[bodyWater].valueQuantity.system = $UCUM
* component[bodyWater].valueQuantity.unit = "liter"

* component[muscleMass].code = $LOINC#73713-0 "Muscle mass"
* component[muscleMass].valueQuantity = 51.8 'kg' "kilogram"
* component[muscleMass].valueQuantity.system = $UCUM
* component[muscleMass].valueQuantity.unit = "kilogram"

* component[boneMass].code = $LOINC#73711-4 "Bone mass"
* component[boneMass].valueQuantity = 2.8 'kg' "kilogram"
* component[boneMass].valueQuantity.system = $UCUM
* component[boneMass].valueQuantity.unit = "kilogram"

Instance: SmartScale
InstanceOf: Device
Usage: #example
Description: "Smart scale device example"
Title: "Smart Scale Device"
* deviceName.name = "Smart Body Analyzer"
* deviceName.type = #user-friendly-name
* manufacturer = "HealthTech Devices"
* modelNumber = "SBA-2024"
* type = $SCT#469576000 "Digital scale device"

Instance: BioimpedanceAnalyzer  
InstanceOf: Device
Usage: #example
Description: "Bioimpedance analyzer device example"
Title: "Bioimpedance Analyzer Device"
* deviceName.name = "Professional Body Composition Analyzer"
* deviceName.type = #user-friendly-name
* manufacturer = "MedTech Solutions"
* modelNumber = "BCA-Pro"
* type = $SCT#706767009  'or'  display = "Patient data recorder"



// ===== Conteúdo de: MindfulnessResources.fsh =====

CodeSystem: MindfulnessTypeCS
Id: mindfulness-type-cs
Title: "Mindfulness Practice Types"
Description: "Types of mindfulness practices and techniques"
* ^experimental = false
* ^caseSensitive = true
* #meditation "Meditation" "Focused meditation practice"
* #breathing "Breathing Exercise" "Conscious breathing techniques"
* #bodyScan "Body Scan" "Progressive body awareness practice"
* #walking "Mindful Walking" "Walking meditation practice"
* #movement "Mindful Movement" "Conscious movement practice"

CodeSystem: EnvironmentTypeCS
Id: environment-type-cs
Title: "Practice Environment Types"
Description: "Types of environments for mindfulness practice"
* ^experimental = false
* ^caseSensitive = true
* #indoor "Indoor" "Indoor environment"
* #outdoor "Outdoor" "Outdoor environment"
* #quiet "Quiet Space" "Quiet or silent environment"
* #group "Group Setting" "Group practice environment"

ValueSet: MindfulnessTypeVS
Id: mindfulness-type-vs
Title: "Mindfulness Practice Types Value Set"
Description: "Value set of mindfulness practice types"
* ^experimental = false
* include codes from system MindfulnessTypeCS

ValueSet: EnvironmentTypeVS
Id: environment-type-vs
Title: "Practice Environment Types Value Set"
Description: "Value set of practice environment types"
* ^experimental = false
* include codes from system EnvironmentTypeCS

Instance: MindfulnessSettingCS
InstanceOf: CodeSystem
Usage: #definition
* url = "https://2rdoc.pt/fhir/CodeSystem/mindfulness-setting"
* version = "1.0.0"
* name = "MindfulnessSettingCS"
* title = "Mindfulness Setting CodeSystem"
* status = #active
* experimental = false
* caseSensitive = true
* content = #complete
* count = 5
* concept[+].code = #home
* concept[=].display = "Home Practice"
* concept[+].code = #clinic
* concept[=].display = "Clinical Setting"
* concept[+].code = #group
* concept[=].display = "Group Setting"
* concept[+].code = #retreat
* concept[=].display = "Retreat Setting"
* concept[+].code = #workplace
* concept[=].display = "Workplace Setting"



// ===== Conteúdo de: MindfulnessQuestionnaires.fsh =====

Instance: DailyMindfulnessQuestionnaire
InstanceOf: Questionnaire
Usage: #definition
Title: "Daily Mindfulness Questionnaire"
Description: "Questionnaire for capturing daily mindfulness practice and associated effects"

* url = "https://2rdoc.pt/ig/ios-lifestyle-medicine/Questionnaire/daily-mindfulness"
* status = #active
* title = "Daily Mindfulness Practice"
* subjectType = #Patient
* version = "1.0.0"
* name = "DailyMindfulnessQuestionnaire"
* date = "2024-03-19"

* item[0]
  * linkId = "mindful_session"
  * text = "Mindfulness Session"
  * type = #group
  * repeats = false

  * item[0]
    * linkId = "session_duration"
    * text = "Session duration (minutes)"
    * type = #integer
    * required = true
    * extension[0].url = "http://hl7.org/fhir/StructureDefinition/minValue"
    * extension[0].valueInteger = 1

  * item[1]
    * linkId = "practice_type"
    * text = "Practice type"
    * type = #choice
    * required = true
    * answerOption[0].valueString = "Meditation"
    * answerOption[1].valueString = "Breathing exercise"
    * answerOption[2].valueString = "Body scan"
    * answerOption[3].valueString = "Mindful walking"

* item[1]
  * linkId = "mood_assessment"
  * text = "Mood Assessment"
  * type = #group

  * item[0]
    * linkId = "current_mood"
    * text = "How is your mood now?"
    * type = #choice
    * required = true
    * answerValueSet = "https://2rdoc.pt/fhir/ValueSet/mood-vs"

  * item[1]
    * linkId = "mood_intensity"
    * text = "Mood intensity (1-5)"
    * type = #integer
    * required = true

* item[2]
  * linkId = "stress_assessment"
  * text = "Stress Assessment"
  * type = #group

  * item[0]
    * linkId = "stress_level"
    * text = "Stress level (0-10)"
    * type = #integer
    * required = true

  * item[1]
    * linkId = "stress_symptoms"
    * text = "Stress symptoms"
    * type = #choice
    * repeats = true
    * answerOption[0].valueString = "Muscle tension"
    * answerOption[1].valueString = "Anxiety"
    * answerOption[2].valueString = "Headache"
    * answerOption[3].valueString = "Fatigue"

* item[3]
  * linkId = "relaxation"
  * text = "Relaxation"
  * type = #group

  * item[0]
    * linkId = "relaxation_duration"
    * text = "Relaxation time (minutes)"
    * type = #integer
    * required = true

  * item[1]
    * linkId = "relaxation_technique"
    * text = "Technique used"
    * type = #choice
    * required = true
    * answerOption[0].valueString = "Deep breathing"
    * answerOption[1].valueString = "Progressive relaxation"
    * answerOption[2].valueString = "Visualization"
    * answerOption[3].valueString = "Mindful awareness"



// ===== Conteúdo de: VitalSignsExtensions.fsh =====

Extension: MeasurementContext
Id: measurement-context
Title: "Measurement Context Extension"
* ^experimental = falseDescription: "Additional context about the vital sign measurement"
* value[x] only CodeableConcept
* valueCodeableConcept from MeasurementContextVS (required)

ValueSet: MeasurementContextVitalSigns
Id: measurement-context-vital-signs
Description: "Value set for measurement context in vital signs observations"Title: "Measurement Context Value Set"
* $SCT#255214003 "At rest"
* $SCT#309604004 "During exercise"
* $SCT#309605003 "Post exercise"
* $SCT#248626006 "During sleep"



// ===== Conteúdo de: BodyMetricsProfiles.fsh =====

Alias: $SCT = http://snomed.info/sct
Alias: $LOINC = http://loinc.org
Alias: $UCUM = http://unitsofmeasure.org

Profile: BodyMetricsObservation
Parent: Observation
Id: body-metrics-observation
Title: "Body Metrics Observation Profile"
Description: "Profile for body measurements from iOS Health App"

* ^version = "0.1.0"
* ^status = #draft
* ^publisher = "Open Health Manager"

* status MS
* category 1..1 MS
* category = http://terminology.hl7.org/CodeSystem/observation-category#vital-signs
* subject 1..1 MS
* effectiveDateTime 1..1 MS
* device 0..1 MS

Profile: WeightObservation
Parent: BodyMetricsObservation
Id: weight-observation  
Title: "Weight Measurement Profile"
Description: "Profile for body weight measurements"

* ^version = "0.1.0"
* ^status = #draft

* code = $LOINC#29463-7 "Body weight"
* valueQuantity only Quantity
* valueQuantity.system = $UCUM
* valueQuantity.code = #kg

Profile: HeightObservation
Parent: BodyMetricsObservation
Id: height-observation
Title: "Height Measurement Profile" 
Description: "Profile for body height measurements"

* ^version = "0.1.0"
* ^status = #draft

* code = $LOINC#8302-2 "Body height"
* valueQuantity only Quantity
* valueQuantity.system = $UCUM
* valueQuantity.code = #cm

Profile: BMIObservation
Parent: BodyMetricsObservation
Id: bmi-observation
Title: "BMI Measurement Profile"
Description: "Profile for Body Mass Index calculations"

* ^version = "0.1.0"
* ^status = #draft

* code = $LOINC#39156-5 "Body mass index (BMI)"
* valueQuantity only Quantity
* valueQuantity.system = $UCUM
* valueQuantity.code = #kg/m2

Profile: BodyCompositionObservation
Parent: BodyMetricsObservation
Id: body-composition-observation
Title: "Body Composition Profile"
Description: "Profile for body composition measurements including fat, lean mass, and other metrics"

* ^version = "0.1.0"
* ^status = #draft

* code = $LOINC#88365-2 "Body composition panel"
* component ^slicing.discriminator.type = #pattern
* component ^slicing.discriminator.path = "code"
* component ^slicing.rules = #open

* component contains
    bodyFat 0..1 MS and
    leanMass 0..1 MS and
    bodyWater 0..1 MS and
    muscleMass 0..1 MS and
    boneMass 0..1 MS

* component[bodyFat].code = $LOINC#41982-0 "Percentage body fat"
* component[bodyFat].valueQuantity.system = $UCUM
* component[bodyFat].valueQuantity.code = #%

* component[leanMass].code = $LOINC#291-7 "Lean body mass"
* component[leanMass].valueQuantity.system = $UCUM
* component[leanMass].valueQuantity.code = #kg

* component[bodyWater].code = $LOINC#73708-0 "Total body water"
* component[bodyWater].valueQuantity.system = $UCUM  
* component[bodyWater].valueQuantity.code = #L

* component[muscleMass].code = $LOINC#73713-0 "Muscle mass"
* component[muscleMass].valueQuantity.system = $UCUM
* component[muscleMass].valueQuantity.code = #kg

* component[boneMass].code = $LOINC#73711-4 "Bone mass" 
* component[boneMass].valueQuantity.system = $UCUM
* component[boneMass].valueQuantity.code = #kg



// ===== Conteúdo de: AdvancedVitalSignsProfiles.fsh =====

Alias: $SCT = http://snomed.info/sct
Alias: $LOINC = http://loinc.org
Alias: $UCUM = http://unitsofmeasure.org

Profile: AdvancedVitalSigns
Parent: Observation
Id: advanced-vital-signs
Title: "Advanced Vital Signs Profile"
Description: "Profile for advanced vital signs data from iOS Health App"

* ^version = "0.1.0"
* ^status = #draft
* ^publisher = "HL7 International"
* ^contact.name = "Advanced Vital Signs Working Group"

* status MS
* category 1..1 MS
* category = http://terminology.hl7.org/CodeSystem/observation-category#vital-signs
* code 1..1 MS
* subject 1..1 MS
* effectiveDateTime 1..1 MS
* device 0..1 MS
* method 0..1 MS
* note 0..* MS

* component ^slicing.discriminator.type = #pattern
* component ^slicing.discriminator.path = "code"
* component ^slicing.rules = #open
* component ^short = "Advanced vital signs components"
* component ^definition = "Components of advanced vital sign measurements"

* component contains
    hrvSpectral 0..1 MS and
    hrvEntropy 0..1 MS and
    meanArterialPressure 0..1 MS and
    pulseWaveAnalysis 0..1 MS and
    respiratoryVariability 0..1 MS and
    oxygenationIndex 0..1 MS and
    stressIndex 0..1 MS and
    thermalGradient 0..1 MS and
    autonomicBalance 0..1 MS and
    recoveryRate 0..1 MS and
    allostaticLoad 0..1 MS

* component[hrvSpectral].code = $LOINC#87834-8 "Heart rate variability [Frequency band]"
* component[hrvSpectral].valueQuantity.system = $UCUM
* component[hrvSpectral].valueQuantity.code = #ms
* component[hrvSpectral] ^short = "Spectral analysis of heart rate variability"

* component[hrvEntropy].code = $LOINC#87835-5 "Heart rate variability entropy"
* component[hrvEntropy].valueQuantity.system = $UCUM
* component[hrvEntropy].valueQuantity.code = #{entropy}
* component[hrvEntropy] ^short = "Sample entropy of heart rate variability"

* component[meanArterialPressure].code = $LOINC#8478-0 "Mean blood pressure"
* component[meanArterialPressure].valueQuantity.system = $UCUM
* component[meanArterialPressure].valueQuantity.code = #mmHg
* component[meanArterialPressure] ^short = "Mean arterial blood pressure"

* component[pulseWaveAnalysis].code = $LOINC#87836-3 "Pulse wave analysis"
* component[pulseWaveAnalysis].valueQuantity.system = $UCUM
* component[pulseWaveAnalysis].valueQuantity.code = #{index}
* component[pulseWaveAnalysis] ^short = "Analysis of arterial pulse wave"

* component[respiratoryVariability].code = $LOINC#87837-1 "Respiratory rate variability"
* component[respiratoryVariability].valueQuantity.system = $UCUM
* component[respiratoryVariability].valueQuantity.code = #{coefficient}
* component[respiratoryVariability] ^short = "Variability in respiratory rate"

* component[oxygenationIndex].code = $LOINC#87838-9 "Oxygenation index"
* component[oxygenationIndex].valueQuantity.system = $UCUM
* component[oxygenationIndex].valueQuantity.code = #{ratio}
* component[oxygenationIndex] ^short = "Index of blood oxygenation"

* component[stressIndex].code = $LOINC#87839-7 "Physiological stress index"
* component[stressIndex].valueQuantity.system = $UCUM
* component[stressIndex].valueQuantity.code = #{index}
* component[stressIndex] ^short = "Index of physiological stress"

* component[thermalGradient].code = $LOINC#87840-5 "Temperature gradient"
* component[thermalGradient].valueQuantity.system = $UCUM
* component[thermalGradient].valueQuantity.code = #Cel
* component[thermalGradient] ^short = "Gradient of body temperature"

* component[autonomicBalance].code = $LOINC#87841-3 "Autonomic balance index"
* component[autonomicBalance].valueQuantity.system = $UCUM
* component[autonomicBalance].valueQuantity.code = #{ratio}
* component[autonomicBalance] ^short = "Balance of autonomic nervous system"

* component[recoveryRate].code = $LOINC#87842-1 "Recovery rate index"
* component[recoveryRate].valueQuantity.system = $UCUM
* component[recoveryRate].valueQuantity.code = #{rate}
* component[recoveryRate] ^short = "Rate of physiological recovery"

* component[allostaticLoad].code = $LOINC#87843-9 "Allostatic load index"
* component[allostaticLoad].valueQuantity.system = $UCUM
* component[allostaticLoad].valueQuantity.code = #{score}
* component[allostaticLoad] ^short = "Measure of cumulative physiological burden"

Extension: AdvancedVitalSignsContext
Id: advanced-vital-signs-context
Title: "Advanced Vital Signs Context Extension"
Description: "Additional context about advanced vital sign measurements"

* value[x] only CodeableConcept
* valueCodeableConcept from AdvancedVitalSignsContextVS (required)

ValueSet: AdvancedVitalSignsContextVS
Id: advanced-vital-signs-context-vs
Title: "Advanced Vital Signs Context Value Set"
Description: "Context codes for advanced vital sign measurements"

* ^experimental = true
* codes from system AdvancedVitalSignsContextCS

CodeSystem: AdvancedVitalSignsContextCS
Id: advanced-vital-signs-context-cs
Title: "Advanced Vital Signs Context Code System"
Description: "Codes for advanced vital signs measurement context"

* ^experimental = true
* ^caseSensitive = true

* #resting "Resting state" "Measurement taken during rest"
* #active "Active state" "Measurement taken during activity"
* #recovery "Recovery state" "Measurement taken during recovery"
* #sleep "Sleep state" "Measurement taken during sleep"
* #stress "Stress state" "Measurement taken during stress"



// ===== Conteúdo de: MobilityRiskValueSets.fsh =====

ValueSet: FallRiskOutcomesValueSet
Id: fall-risk-outcomes
Title: "Fall Risk Outcomes Value Set"
* ^experimental = falseDescription: "Value set for fall risk assessment outcomes"
* ^url = "https://2rdoc.pt/fhir/ValueSet/fall-risk-outcomes"
* ^status = #active
* include codes from system https://2rdoc.pt/fhir/CodeSystem/fall-risk-outcomes

ValueSet: RiskLevelValueSet
Id: risk-level
Title: "Risk Level Value Set"
* ^experimental = falseDescription: "Value set for general risk levels"
* ^url = "https://2rdoc.pt/fhir/ValueSet/risk-level"
* ^status = #active
* include codes from system https://2rdoc.pt/fhir/CodeSystem/risk-level

ValueSet: MobilityDeclineOutcomesValueSet
Id: mobility-decline-outcomes
Title: "Mobility Decline Outcomes Value Set"
* ^experimental = falseDescription: "Value set for mobility decline assessment outcomes"
* ^url = "https://2rdoc.pt/fhir/ValueSet/mobility-decline-outcomes"
* ^status = #active
* include codes from system https://2rdoc.pt/fhir/CodeSystem/mobility-decline-outcomes

ValueSet: AssistanceLevelOutcomesValueSet
Id: assistance-level-outcomes
Title: "Assistance Level Outcomes Value Set"
* ^experimental = falseDescription: "Value set for assistance level assessment outcomes"
* ^url = "https://2rdoc.pt/fhir/ValueSet/assistance-level-outcomes"
* ^status = #active
* include codes from system https://2rdoc.pt/fhir/CodeSystem/assistance-level-outcomes



// ===== Conteúdo de: MobilityProfiles.fsh =====

Profile: MobilityProfile
Parent: Observation
Id: mobility-profile
Title: "Mobility Profile"
Description: "Profile for mobility data from iOS Health App"

* status MS
* category 1..1 MS
* category = http://terminology.hl7.org/CodeSystem/observation-category#activity
* code 1..1 MS
* subject 1..1 MS
* effectiveDateTime 1..1 MS
* device 0..1 MS

* component ^slicing.discriminator.type = #pattern
* component ^slicing.discriminator.path = "code"
* component ^slicing.rules = #open

* component contains
    steadiness 0..1 MS and
    balance 0..1 MS and
    gait 0..1 MS and 
    movement 0..1 MS

* component[steadiness].code = $LOINC#LA32-8
* component[balance].code = $LOINC#LA32-9
* component[gait].code = $LOINC#LA29042-4
* component[movement].code = $LOINC#LA29043-2



// ===== Conteúdo de: SymptomValueSets.fsh =====

CodeSystem: SymptomSeverityCS
Id: symptom-severity-cs
Title: "Symptom Severity Code System"
* ^experimental = falseDescription: "Severity levels for symptoms"

* #1-3 "Light" "Symptom barely noticeable"
* #4-6 "Mild" "Symptom noticeable but not interfering with daily activities"
* #7-8 "Intense" "Symptom interfering with daily activities"
* #9-10 "Severe" "Symptom preventing daily activities"

ValueSet: BodyLocationsVS
Id: body-locations-vs
Title: "Body Locations Value Set"
* ^experimental = falseDescription: "Anatomical locations for symptom recording"
* $SCT#12738006 "Brain"
* $SCT#69536005 "Head"
* $SCT#45048000 "Neck"
* $SCT#51185008 "Chest"
* $SCT#62413002 "Abdomen"
* $SCT#32849002 "Back"
* $SCT#53120007 "Upper limb"
* $SCT#61685007 "Lower limb"

ValueSet: DurationUnitsVS
Id: duration-units-vs
Title: "Duration Units Value Set"
* ^experimental = falseDescription: "Time units for symptom duration"
* $UCUM#min "Minutes"
* $UCUM#h "Hours"
* $UCUM#d "Days"
* $UCUM#wk "Weeks"
* $UCUM#mo "Months"

CodeSystem: SymptomFrequencyCS
Id: symptom-frequency-cs
Title: "Symptom Frequency Code System"
* ^experimental = falseDescription: "Frequency patterns for symptoms"
* #rare "Rare" "Less than once per month"
* #occasional "Occasional" "Several times per month"
* #frequent "Frequent" "Several times per week"
* #daily "Daily" "Once or more per day"
* #constant "Constant" "Present most of the time"

ValueSet: SymptomFrequencyVS
Id: symptom-frequency-vs
Title: "Symptom Frequency Value Set"
* ^experimental = falseDescription: "Frequency patterns for symptoms"
* codes from system SymptomFrequencyCS

CodeSystem: SymptomImpactCS
Id: symptom-impact-cs
Title: "Symptom Impact Code System"
* ^experimental = falseDescription: "Impact levels of symptoms on daily activities"
* #none "No impact"
* #mild "Mild impact"
* #moderate "Moderate impact"
* #severe "Severe impact"
* #complete "Complete impact"

ValueSet: SymptomImpactVS
Id: symptom-impact-vs
Title: "Symptom Impact Value Set"
* ^experimental = falseDescription: "Impact levels for symptoms"
* codes from system SymptomImpactCS

ValueSet: SymptomProgressionVS
Id: symptom-progression-vs
Title: "Symptom Progression Value Set"
* ^experimental = falseDescription: "Progression patterns for symptoms"
* $SCT#385633008 "Improving"
* $SCT#58158008 "Stable"
* $SCT#230993007 "Worsening"
* $SCT#255314001 "Fluctuating"

ValueSet: TimeOfDayVS
Id: time-of-day-vs
Title: "Time of Day Value Set"
* ^experimental = falseDescription: "Times of day for symptom occurrence"
* $SCT#73775008 "Morning"
* $SCT#255214003 "After exercise"
* $SCT#2546009 "Evening"
* $SCT#73775008 "Morning"



// ===== Conteúdo de: EnvironmentalExamples.fsh =====

Instance: NoiseExposureExample
InstanceOf: NoiseExposureObservation
Usage: #example
Description: "Noise exposure observation example"
Title: "Noise Exposure Measurement Example"

* meta.security = http://terminology.hl7.org/CodeSystem/v3-Confidentiality#N
* status = #final
* performer = Reference(Practitioner/PractitionerExample)
* category = http://terminology.hl7.org/CodeSystem/observation-category#environment
* code = $LOINC#28573-7 "Noise exposure time"
* subject = Reference(Patient/PatientExample)
* effectiveDateTime = "2024-03-19T15:30:00Z"
* device = Reference(Device/iphone-example)
* method = http://snomed.info/sct#37016008 "Automatic measurement"

* component[level]
  * code.coding[0] = $LOINC#89020-2 "Environmental noise average"
  * valueQuantity = 85 'dB'
  * interpretation = http://terminology.hl7.org/CodeSystem/v3-ObservationInterpretation#H "High"

* component[duration]
  * code.coding[0] = $LOINC#89021-0 "Environmental noise duration"
  * valueQuantity = 120 'min'

* component[peakLevel]
  * code.coding[0] = $LOINC#89024-4 "Peak sound level"
  * valueQuantity = 95 'dB'

* component[backgroundNoise]
  * code.coding[0] = $LOINC#89025-1 "Background noise level"
  * valueQuantity = 45 'dB'

* note.text = "Measurement taken during urban commute"

Instance: UVExposureExample
InstanceOf: UVExposureObservation
Usage: #example
Description: "UV exposure observation example"
Title: "UV Exposure Measurement Example"

* meta.security = http://terminology.hl7.org/CodeSystem/v3-Confidentiality#N
* status = #final
* category = http://terminology.hl7.org/CodeSystem/observation-category#environment
* code = $LOINC#28574-5 "UV exposure"
* subject = Reference(Patient/PatientExample)
* effectiveDateTime = "2024-03-19T12:00:00Z"
* device = Reference(Device/iphone-example)
* method = http://snomed.info/sct#37016008 "Automatic measurement"

* component[index]
  * code.coding[0] = $LOINC#89022-8 "UV index"
  * valueQuantity = 8 '{index}'
  * interpretation = http://terminology.hl7.org/CodeSystem/v3-ObservationInterpretation#H "High"

* component[duration]
  * code.coding[0] = $LOINC#89023-6 "UV exposure duration"
  * valueQuantity = 45 'min'

* component[timeOfDay]
  * code.coding[0] = $LOINC#89026-9 "Time of exposure"
  * valueDateTime = "2024-03-19T12:00:00Z"

* component[intensity]
  * code.coding[0] = $LOINC#89027-7 "UV intensity"
  * valueQuantity = 0.3 'W/m2'

* note.text = "Measurement taken during outdoor activity"

Instance: EnvironmentalDeviceExample
InstanceOf: Device
Usage: #example
Description: "Environmental monitoring device example"
Title: "Environmental Monitoring Device"

* identifier.system = "https://2rdoc.pt/ig/ios-lifestyle-medicine/devices"
* identifier.value = "iPhone-ENV-001"
* manufacturer = "Apple Inc."
* modelNumber = "iPhone 15 Pro"
* type = $SCT#706689003 "Environmental monitoring device"
* status = #active



// ===== Conteúdo de: NutritionExtensions.fsh =====

Extension: NutritionDataSource
Id: nutrition-data-source
Title: "Nutrition Data Source Extension"
Description: "Indicates the source of nutrition data"

* ^version = "0.1.0"
* ^status = #draft
* ^experimental = false
* ^date = "2024-12-14"
* ^publisher = "Ricardo Lourenço dos Santos"
* ^context[0].type = #element
* ^context[0].expression = "Observation"

* value[x] only CodeableConcept
* valueCodeableConcept from NutritionDataSourceVS (required)

ValueSet: NutritionDataSourceVS
Id: nutrition-data-source-vs
Title: "Nutrition Data Source Value Set"
Description: "Value set for nutrition data sources"

* ^version = "0.1.0"
* ^status = #draft
* ^experimental = false
* ^date = "2024-12-14"
* ^publisher = "Ricardo Lourenço dos Santos"

* codes from system NutritionDataSourceCS

CodeSystem: NutritionDataSourceCS
Id: nutrition-data-source-cs
Title: "Nutrition Data Source Code System"
Description: "Code system for nutrition data sources"

* ^version = "0.1.0"
* ^status = #draft
* ^experimental = false
* ^date = "2024-12-14"
* ^publisher = "Ricardo Lourenço dos Santos"
* ^caseSensitive = true

* #manual "Manual Entry" "Data entered manually by user"
* #app "App Integration" "Data from integrated third-party apps"
* #device "Connected Device" "Data from connected nutrition tracking devices"
* #questionnaire "Questionnaire Response" "Data collected through questionnaires"



// ===== Conteúdo de: StressValueSets.fsh =====

ValueSet: StressChronicityVS
Id: stress-chronicity-vs
Title: "Stress Chronicity Value Set"
* ^experimental = falseDescription: "Value set for classifying stress chronicity"
* ^url = "https://2rdoc.pt/fhir/ValueSet/stress-chronicity-vs"
* codes from system StressChronicityCS

ValueSet: StressImpactVS
Id: stress-impact-vs
Title: "Stress Impact Value Set"
* ^experimental = falseDescription: "Value set for describing stress impact levels"
* ^url = "https://2rdoc.pt/fhir/ValueSet/stress-impact-vs"
* codes from system StressImpactCS

CodeSystem: StressChronicityCS
Id: stress-chronicity-cs
Title: "Stress Chronicity Code System"
* ^experimental = falseDescription: "Code system for stress chronicity classification"
* ^url = "https://2rdoc.pt/fhir/CodeSystem/stress-chronicity-cs"
* #acute "Acute" "Short-term stress response"
* #subacute "Subacute" "Medium-term stress response"
* #chronic "Chronic" "Long-term stress response"
* #episodic "Episodic" "Recurring stress episodes"
* #persistent "Persistent" "Continuous stress state"

CodeSystem: StressImpactCS
Id: stress-impact-cs
Title: "Stress Impact Code System"
* ^experimental = falseDescription: "Code system for stress impact levels"
* ^url = "https://2rdoc.pt/fhir/CodeSystem/stress-impact-cs"
* #minimal "Minimal Impact" "Little to no interference with daily activities"
* #mild "Mild Impact" "Some interference with daily activities"
* #moderate "Moderate Impact" "Significant interference with daily activities"
* #severe "Severe Impact" "Major interference with daily activities"
* #extreme "Extreme Impact" "Unable to perform daily activities"



// ===== Conteúdo de: MindfulnessNarrative.fsh =====

RuleSet: MindfulnessObservationNarrative
* text.status = #generated
* text.div = "<div xmlns=\"http://www.w3.org/1999/xhtml\">
    <p><b>Generated Narrative</b></p>
    <p><b>Session Type:</b> Mindfulness Practice Session</p>
    <p><b>Date:</b> {effectiveDateTime}</p>
    <p><b>Duration:</b> {component[sessionDuration].value} minutes</p>
    <p><b>Stress Level:</b> {component[stressLevel].value} / 10</p>
    <p><b>Mood:</b> {component[moodState].value}</p>
    <p><b>Technique:</b> {component[relaxationResponse].value}</p>
    <p><b>Location:</b> {extension[mindfulness-context].extension[location].value}</p>
  </div>"

RuleSet: MindfulnessQuestionnaireNarrative
* text.status = #generated
* text.div = "<div xmlns=\"http://www.w3.org/1999/xhtml\">
    <p><b>Generated Narrative</b></p>
    <p><b>Title:</b> {title}</p>
    <p><b>Status:</b> {status}</p>
    <h3>Sections</h3>
    <ul>
      <li>Mindfulness Session</li>
      <li>Mood Assessment</li>
      <li>Stress Assessment</li>
      <li>Relaxation</li>
    </ul>
  </div>"

RuleSet: MindfulnessResponseNarrative
* text.status = #generated
* text.div = "<div xmlns=\"http://www.w3.org/1999/xhtml\">
    <p><b>Generated Narrative</b></p>
    <p><b>Date:</b> {authored}</p>
    <p><b>Session Duration:</b> {item[session_duration].answer.value} minutes</p>
    <p><b>Practice Type:</b> {item[practice_type].answer.value}</p>
    <p><b>Mood:</b> {item[current_mood].answer.value}</p>
    <p><b>Stress Level:</b> {item[stress_level].answer.value} / 10</p>
    <p><b>Relaxation Technique:</b> {item[relaxation_technique].answer.value}</p>
  </div>"

RuleSet: MindfulnessConfigNarrative
* text.status = #generated
* text.div = "<div xmlns=\"http://www.w3.org/1999/xhtml\">
    <p><b>Generated Narrative</b></p>
    <p><b>Default Duration:</b> {extension[defaultDuration].value} minutes</p>
    <p><b>Reminders:</b> {extension[reminderSettings].value}</p>
    <p><b>Data Sync:</b> {extension[dataSync].value}</p>
  </div>"



// ===== Conteúdo de: VitalSignsProfiles.fsh =====

Alias: $SCT = http://snomed.info/sct
Alias: $LOINC = http://loinc.org
Alias: $UCUM = http://unitsofmeasure.org
Alias: $vitalsigns = http://hl7.org/fhir/StructureDefinition/vitalsigns

Profile: LifestyleVitalSigns
Parent: $vitalsigns
Id: lifestyle-vital-signs
Title: "Lifestyle Medicine Vital Signs Profile"
Description: "Profile for vital signs data from iOS Health App"

* status MS
* category 1..* MS
* subject 1..1 MS
* effectiveDateTime 1..1 MS
* code 1..1 MS
* value[x] 0..1 MS
* device 0..1 MS

Profile: HeartRateObservation
Parent: LifestyleVitalSigns
Id: heart-rate-observation
Title: "Heart Rate Observation Profile"
Description: "Profile for heart rate measurements from iOS Health App"

* code = $LOINC#8867-4 "Heart rate"
* valueQuantity only Quantity
* valueQuantity.system = $UCUM
* valueQuantity.code = #/min
* component ^slicing.discriminator.type = #pattern
* component ^slicing.discriminator.path = "code"
* component ^slicing.rules = #open

* component contains
    restingHeartRate 0..1 MS and
    exerciseHeartRate 0..1 MS and
    recoveryHeartRate 0..1 MS and
    heartRateVariability 0..1 MS

* component[heartRateVariability].code = $LOINC#80404-7 "R-R interval.standard deviation (Heart rate variability)"
* component[heartRateVariability].valueQuantity.system = $UCUM
* component[heartRateVariability].valueQuantity.code = #ms

Profile: BloodPressureObservation
Parent: LifestyleVitalSigns
Id: blood-pressure-observation
Title: "Blood Pressure Observation Profile"
Description: "Profile for blood pressure measurements from iOS Health App"

* code = $LOINC#85354-9 "Blood pressure panel with all children optional"
* component 2..2 MS
* component ^slicing.discriminator.type = #pattern
* component ^slicing.discriminator.path = "code"
* component ^slicing.rules = #closed

* component contains
    systolic 1..1 MS and
    diastolic 1..1 MS

* component[systolic].code = $LOINC#8480-6 "Systolic blood pressure"
* component[systolic].valueQuantity only Quantity
* component[systolic].valueQuantity.system = $UCUM
* component[systolic].valueQuantity.code = #mm[Hg]

* component[diastolic].code = $LOINC#8462-4 "Diastolic blood pressure"
* component[diastolic].valueQuantity only Quantity
* component[diastolic].valueQuantity.system = $UCUM
* component[diastolic].valueQuantity.code = #mm[Hg]

Profile: OxygenSaturationObservation
Parent: LifestyleVitalSigns
Id: oxygen-saturation-observation
Title: "Oxygen Saturation Observation Profile"
Description: "Profile for SpO2 measurements from iOS Health App"

* code = $LOINC#2708-6 "Oxygen saturation in Arterial blood"
* valueQuantity.system = $UCUM
* valueQuantity.code = #%



// ===== Conteúdo de: AdvancedVitalSignsExtensions.fsh =====

Alias: $UCUM = http://unitsofmeasure.org

Extension: PhysiologicalStressIndex
Id: physiological-stress-index
Title: "Physiological Stress Index Extension"
Description: "Index representing overall physiological stress based on multiple parameters"

* ^version = "0.1.0"
* ^status = #draft
* ^context[+].type = #element
* ^context[=].expression = "Observation"

* value[x] only Quantity
* valueQuantity.system = $UCUM
* valueQuantity.code = #{index}
* valueQuantity ^short = "Physiological stress index value"
* valueQuantity ^definition = "Normalized index value representing overall physiological stress"

Extension: HomeostasisIndex
Id: homeostasis-index
Title: "Homeostasis Index Extension"
Description: "Composite measure of physiological balance and adaptation"

* ^version = "0.1.0"
* ^status = #draft
* ^context[+].type = #element
* ^context[=].expression = "Observation"

* value[x] only Quantity
* valueQuantity.system = $UCUM
* valueQuantity.code = #{ratio}
* valueQuantity ^short = "Homeostasis index value"
* valueQuantity ^definition = "Normalized ratio representing physiological balance"

Extension: RecoveryEfficiency
Id: recovery-efficiency
Title: "Recovery Efficiency Extension"
Description: "Measure of how efficiently the body recovers from stress or exertion"

* ^version = "0.1.0"
* ^status = #draft
* ^context[+].type = #element
* ^context[=].expression = "Observation"

* value[x] only Quantity
* valueQuantity.system = $UCUM
* valueQuantity.code = #%
* valueQuantity ^short = "Recovery efficiency percentage"
* valueQuantity ^definition = "Percentage indicating recovery efficiency"

Extension: AllostaticLoad
Id: allostatic-load
Title: "Allostatic Load Extension"
Description: "Measure of cumulative physiological burden over time"

* ^version = "0.1.0"
* ^status = #draft
* ^context[+].type = #element
* ^context[=].expression = "Observation"

* value[x] only Quantity
* valueQuantity.system = $UCUM
* valueQuantity.code = #{score}
* valueQuantity ^short = "Allostatic load score"
* valueQuantity ^definition = "Score representing cumulative physiological burden"

Extension: CircadianPhase
Id: circadian-phase
Title: "Circadian Phase Extension"
Description: "Indicator of position in circadian rhythm cycle"

* ^version = "0.1.0"
* ^status = #draft
* ^context[+].type = #element
* ^context[=].expression = "Observation"

* value[x] only CodeableConcept
* valueCodeableConcept from CircadianPhaseVS (required)

ValueSet: CircadianPhaseVS
Id: circadian-phase-vs
Title: "Circadian Phase Value Set"
Description: "Value set for circadian rhythm phases"

* ^experimental = true
* codes from system CircadianPhaseCS

CodeSystem: CircadianPhaseCS
Id: circadian-phase-cs
Title: "Circadian Phase Code System"
Description: "Code system for circadian rhythm phases"

* ^experimental = true
* ^caseSensitive = true

* #early-morning "Early Morning Phase" "Period shortly after awakening"
* #mid-morning "Mid Morning Phase" "Mid-morning period"
* #afternoon "Afternoon Phase" "Afternoon period"
* #evening "Evening Phase" "Evening period"
* #night "Night Phase" "Nighttime period"
* #deep-night "Deep Night Phase" "Deep night period"

Extension: MeasurementQuality
Id: measurement-quality
Title: "Measurement Quality Extension"
Description: "Indicator of the quality and reliability of the measurement"

* ^version = "0.1.0"
* ^status = #draft
* ^context[+].type = #element
* ^context[=].expression = "Observation"

* value[x] only CodeableConcept
* valueCodeableConcept from MeasurementQualityVS (required)

ValueSet: MeasurementQualityVS
Id: measurement-quality-vs
Title: "Measurement Quality Value Set"
Description: "Value set for measurement quality indicators"

* ^experimental = true
* codes from system MeasurementQualityCS

CodeSystem: MeasurementQualityCS
Id: measurement-quality-cs
Title: "Measurement Quality Code System"
Description: "Code system for measurement quality indicators"

* ^experimental = true
* ^caseSensitive = true

* #excellent "Excellent Quality" "High quality measurement with minimal noise"
* #good "Good Quality" "Good quality measurement with acceptable noise"
* #fair "Fair Quality" "Fair quality measurement with some interference"
* #poor "Poor Quality" "Poor quality measurement with significant interference"
* #unreliable "Unreliable" "Unreliable measurement requiring verification"



// ===== Conteúdo de: NutritionExamples.fsh =====

Instance: NutritionQuestionnaireResponseExample
InstanceOf: QuestionnaireResponse
Usage: #example
Description: "Nutrition questionnaire response example"
Title: "Daily Nutrition Questionnaire Response Example"

* questionnaire = "https://2rdoc.pt/fhir/Questionnaire/daily-nutrition"
* status = #completed
* subject = Reference(Patient/PatientExample)
* authored = "2024-12-14T20:00:00Z"

* item[0]
  * linkId = "water_intake"
  * answer.valueQuantity = 2000 'mL'

* item[1]
  * linkId = "meal_record"

  * item[0]
    * linkId = "meal_time"
    * answer.valueDateTime = "2024-12-14T12:00:00Z"

  * item[1]
    * linkId = "meal_type"
    * answer.valueString = "Lunch"

  * item[2]
    * linkId = "calories"
    * answer.valueInteger = 650

  * item[3]
    * linkId = "macronutrients"
   
    * item[0]
      * linkId = "carbs"
      * answer.valueDecimal = 75
   
    * item[1]
      * linkId = "protein"
      * answer.valueDecimal = 30
   
    * item[2]
      * linkId = "fat"
      * answer.valueDecimal = 25

* item[2]
  * linkId = "caffeine"

  * item[0]
    * linkId = "caffeine_amount"
    * answer.valueInteger = 80

  * item[1]
    * linkId = "caffeine_source"
    * answer.valueString = "Coffee"



// ===== Conteúdo de: SleepExamples.fsh =====

Instance: SleepObservationExample1
InstanceOf: SleepObservation
Usage: #example
Description: "Sleep observation example"
Title: "Example of Sleep Record"
 
* status = #final
* category = http://terminology.hl7.org/CodeSystem/observation-category#sleep
* code = $LOINC#93832-4 "Sleep pattern panel"
* subject = Reference(PatientExample)
* effectivePeriod.start = "2024-03-19T22:00:00Z"
* effectivePeriod.end = "2024-03-20T06:30:00Z"
* device = Reference(DeviceSleepMonitor)
 
* component[timeInBed].code = $LOINC#93831-6 "Time in bed"
* component[timeInBed].valueQuantity = 510 'min' "minute"
* component[timeInBed].valueQuantity.system = $UCUM
* component[timeInBed].valueQuantity.unit = "minute"
 
* component[totalSleepTime].code = $LOINC#93833-2 "Sleep duration"
* component[totalSleepTime].valueQuantity = 472 'min' "minute"
* component[totalSleepTime].valueQuantity.system = $UCUM
* component[totalSleepTime].valueQuantity.unit = "minute"
 
* component[deepSleep].code = $LOINC#93834-0 "Deep sleep duration"
* component[deepSleep].valueQuantity = 95 'min' "minute"
* component[deepSleep].valueQuantity.system = $UCUM
* component[deepSleep].valueQuantity.unit = "minute"
 
* component[remSleep].code = $LOINC#93835-7 "REM sleep duration"
* component[remSleep].valueQuantity = 118 'min' "minute"
* component[remSleep].valueQuantity.system = $UCUM
* component[remSleep].valueQuantity.unit = "minute"
 
* component[lightSleep].code = $LOINC#93836-5 "Light sleep duration"
* component[lightSleep].valueQuantity = 259 'min' "minute"
* component[lightSleep].valueQuantity.system = $UCUM
* component[lightSleep].valueQuantity.unit = "minute"
 
* component[respiratoryRate].code = $LOINC#9279-1 "Respiratory rate"
* component[respiratoryRate].valueQuantity = 14 '/min' "per minute"
* component[respiratoryRate].valueQuantity.system = $UCUM
* component[respiratoryRate].valueQuantity.unit = "per minute"
 
* component[heartRateVariability].code = $LOINC#80404-7 "R-R interval.standard deviation (Heart rate variability)"
* component[heartRateVariability].valueQuantity = 45 'ms' "millisecond"
* component[heartRateVariability].valueQuantity.system = $UCUM
* component[heartRateVariability].valueQuantity.unit = "millisecond"
 
* component[interruptions].code = $LOINC#93837-3 "Number of awakenings during sleep"
* component[interruptions].valueQuantity = 3 '{count}' "count"
* component[interruptions].valueQuantity.system = $UCUM
* component[interruptions].valueQuantity.unit = "count"

Instance: DeviceSleepMonitor
InstanceOf: Device
Usage: #example
Description: "Sleep monitor device example"
Title: "Sleep Monitoring Device"
* deviceName.name = "Sleep Quality Monitor"
* deviceName.type = #user-friendly-name
* manufacturer = "HealthTech Devices"
* modelNumber = "SQM-2024"
* type = $SCT#706172001 "Sleep monitor"



// ===== Conteúdo de: MindfulnessMappings.fsh =====

Mapping: MindfulnessToHealthKit
Id: mindfulness-to-healthkit
Title: "Mapping to Apple HealthKit"
Source: MindfulnessObservation
Target: "http://developer.apple.com/documentation/healthkit"

* -> "HKCategoryTypeIdentifierMindfulSession" "Root mapping"
* effectiveDateTime -> "startDate and endDate" "Session timing"
* component[sessionDuration].valueQuantity -> "duration" "Session duration"

Mapping: MindfulnessToLOINC
Id: mindfulness-to-loinc
Title: "Mapping to LOINC codes"
Source: MindfulnessObservation
Target: "http://loinc.org"

* -> "89555-7" "Mindfulness safety questionnaire"
* component[stressLevel] -> "89556-5" "Stress level score"
* component[sessionDuration] -> "89557-3" "Duration of mindfulness practice"
* component[moodState] -> "89558-1" "Mood pattern"

Mapping: MindfulnessToSNOMED
Id: mindfulness-to-snomed
Title: "Mapping to SNOMED CT"
Source: MindfulnessObservation
Target: "http://snomed.info/sct"

* -> "711415009" "Meditation"
* component[stressLevel] -> "725854004" "Assessment of stress level"
* component[moodState] -> "373931001" "Mood finding"
* component[relaxationResponse] -> "276241001" "Relaxation technique"

Extension: MindfulnessImportMap
Id: mindfulness-import-map
Title: "Mindfulness Import Mapping"
Description: "Mapping instructions for importing mindfulness data"

* ^url = "https://2rdoc.pt/ig/ios-lifestyle-medicine/StructureDefinition/mindfulness-import-map"
* ^version = "1.0.0"
* ^status = #draft

* extension contains
    source 1..1 MS and
    target 1..1 MS and
    mapping 1..1 MS

* extension[source].value[x] only string
* extension[target].value[x] only string
* extension[mapping].value[x] only string

Instance: HealthKitMappingConfig
InstanceOf: MindfulnessImportMap
Usage: #inline

* extension[source].valueString = "HKCategoryTypeIdentifierMindfulSession"
* extension[target].valueString = "Observation"
* extension[mapping].valueString = "duration->component[sessionDuration].valueQuantity"



// ===== Conteúdo de: aliases.fsh =====

Alias: SCT = http://snomed.info/sct
Alias: LOINC = http://loinc.org
Alias: UCUM = http://unitsofmeasure.org



// ===== Conteúdo de: StressExtensions.fsh =====

Extension: StressTriggers
Id: stress-triggers
Title: "Stress Triggers Extension"
* ^experimental = falseDescription: "Extension for recording identified stress triggers"
* value[x] only CodeableConcept
* valueCodeableConcept from StressTriggersVS (required)

Extension: StressCoping
Id: stress-coping
Title: "Stress Coping Extension"
* ^experimental = falseDescription: "Extension for recording stress coping mechanisms"
* value[x] only CodeableConcept
* valueCodeableConcept from StressCopingVS (required)

ValueSet: StressTriggersVS
Id: stress-triggers-vs
Title: "Stress Triggers Value Set"
* ^experimental = falseDescription: "Value set for common stress triggers"
* codes from system StressTriggersCS

ValueSet: StressCopingVS
Id: stress-coping-vs
Title: "Stress Coping Value Set"
* ^experimental = falseDescription: "Value set for stress coping mechanisms"
* codes from system StressCopingCS

CodeSystem: StressTriggersCS
Id: stress-triggers-cs
Title: "Stress Triggers Code System"
* ^experimental = falseDescription: "Code system for common stress triggers"
* #work "Work-related" "Stress from work or professional activities"
* #financial "Financial" "Financial-related stress"
* #relationships "Relationships" "Stress from personal relationships"
* #health "Health" "Health-related concerns"
* #environment "Environmental" "Environmental factors"
* #time "Time Management" "Time pressure and deadlines"
* #change "Life Changes" "Major life changes or transitions"

CodeSystem: StressCopingCS
Id: stress-coping-cs
Title: "Stress Coping Code System"
* ^experimental = falseDescription: "Code system for stress coping mechanisms"
* #exercise "Physical Exercise" "Using exercise to manage stress"
* #meditation "Meditation" "Meditation and mindfulness practices"
* #social "Social Support" "Seeking social support"
* #professional "Professional Help" "Seeking professional assistance"
* #relaxation "Relaxation" "Relaxation techniques"
* #creative "Creative Activities" "Engaging in creative activities"
* #nature "Nature" "Spending time in nature"



// ===== Conteúdo de: PhysicalActivityProfile.fsh =====

Alias: $LOINC = http://loinc.org
Alias: $SNOMED = http://snomed.info/sct
Alias: $UCUM = http://unitsofmeasure.org
Alias: $ActivityCodes = https://2rdoc.pt/ig/ios-lifestyle-medicine/activity-codes

Profile: PhysicalActivityObservation
Parent: Observation
Id: physical-activity-observation
Title: "Physical Activity Observation Profile"
Description: "Profile for recording physical activity data from iOS Health App"

* status MS
* category 1..1 MS
* category = http://terminology.hl7.org/CodeSystem/observation-category#activity
* code 1..1 MS
* code from PhysicalActivityTypeVS (required)
* subject 1..1 MS
* subject only Reference(Patient)
* effectiveDateTime 1..1 MS
* device 0..1 MS
* value[x] only Quantity
* component ^slicing.discriminator.type = #pattern
* component ^slicing.discriminator.path = "code"
* component ^slicing.rules = #open

* component contains
    steps 0..1 MS and
    distance 0..1 MS and
    duration 0..1 MS and
    energy 0..1 MS

* component[steps].code = $LOINC#55423-8 "Number of steps in 24 hour Measured"
* component[steps].valueQuantity only Quantity
* component[steps].valueQuantity.system = $UCUM
* component[steps].valueQuantity.code = #1 "count"

* component[distance].code = $LOINC#55430-3 "Distance walked"
* component[distance].valueQuantity only Quantity
* component[distance].valueQuantity.system = $UCUM
* component[distance].valueQuantity.code = #km "kilometer"

* component[duration].code = $LOINC#55411-3 "Exercise duration"
* component[duration].valueQuantity only Quantity
* component[duration].valueQuantity.system = $UCUM
* component[duration].valueQuantity.code = #min "minute"

* component[energy].code = $LOINC#55424-6 "Energy expenditure"
* component[energy].valueQuantity only Quantity
* component[energy].valueQuantity.system = $UCUM
* component[energy].valueQuantity.code = #kcal "kilocalorie"



// ===== Conteúdo de: ReproductiveObservation.fsh =====

Profile: ReproductiveObservation
Parent: Observation
Id: reproductive-observation
Title: "Reproductive Health Base Profile"
Description: "Base profile for reproductive health observations"

* ^version = "1.0.0"
* ^status = #active
* ^date = "2024-03-19"

* status MS
* category 1..1 MS
* category = http://terminology.hl7.org/CodeSystem/observation-category#reproductive
* code 1..1 MS
* subject 1..1 MS
* subject only Reference(Patient)
* effectiveDateTime 1..1 MS
* value[x] MS

* component ^slicing.discriminator.type = #pattern
* component ^slicing.discriminator.path = "code"
* component ^slicing.rules = #open

* component contains
    severity 0..1 MS and
    duration 0..1 MS and
    frequency 0..1 MS and
    pattern 0..1 MS

* component[severity]
  * code = $LOINC#72514-3
  * value[x] only integer
  * valueInteger 1..1 
  * valueInteger obeys rep-1

* component[duration]
  * code = $LOINC#103332-8
  * value[x] only Quantity
  * valueQuantity from DurationUnitsVS (required)

* component[frequency]
  * code = $LOINC#103334-4
  * value[x] only CodeableConcept
  * valueCodeableConcept from SymptomFrequencyVS (required)

* component[pattern]
  * code = $LOINC#103335-1
  * value[x] only CodeableConcept
  * valueCodeableConcept from SymptomProgressionVS (required)

Invariant: rep-1
Description: "Severity must be between 0 and 10"
Expression: "$this >= 0 and $this <= 10"
Severity: #error



// ===== Conteúdo de: SymptomProfiles.fsh =====

Profile: SymptomQuestionnaire
Parent: Questionnaire
Id: symptom-questionnaire
Title: "Symptom Assessment Questionnaire"
Description: "Questionnaire template for symptom assessments"

* status MS
* title MS
* item MS

* item ^slicing.discriminator.type = #pattern
* item ^slicing.discriminator.path = "linkId"
* item ^slicing.rules = #open

* item contains
    symptomType 1..1 MS and
    location 0..1 MS and
    onset 0..1 MS and
    description 0..1 MS

* item[symptomType].linkId = "symptom-type"
* item[symptomType].text = "Type of Symptom"
* item[symptomType].type = #choice
* item[symptomType].required = true

* item[location].linkId = "location"
* item[location].text = "Location"
* item[location].type = #string

* item[onset].linkId = "onset"
* item[onset].text = "When did it start?"
* item[onset].type = #dateTime

* item[description].linkId = "description"
* item[description].text = "Description"
* item[description].type = #text



// ===== Conteúdo de: StressExamples.fsh =====

Instance: StressLevelExample
InstanceOf: StressLevelProfile
Usage: #example
Description: "Stress level observation example"
Title: "Stress Level Measurement Example"

* status = #final
* category = http://terminology.hl7.org/CodeSystem/observation-category#vital-signs
* code = $LOINC#89592-0 "Stress level score"
* subject = Reference(Patient/PatientExample)
* effectiveDateTime = "2024-01-03T15:30:00Z"
* valueQuantity = 7 '{score}' "score"

* component[physiologicalStress].valueQuantity = 6 '{score}' "score"
* component[psychologicalStress].valueQuantity = 8 '{score}' "score"
* component[chronicity].valueCodeableConcept = StressChronicityCS#subacute
* component[impact].valueCodeableConcept = StressImpactCS#moderate

* extension[triggers].valueCodeableConcept = StressTriggersCS#work
* extension[coping].valueCodeableConcept = StressCopingCS#meditation



// ===== Conteúdo de: ReproductiveProfiles.fsh =====

Profile: FertilityObservation
Parent: Observation
Id: fertility-observation
Title: "Fertility Observation Profile"
Description: "Profile for fertility signs and symptoms"

* status MS
* category 1..1 MS
* category = http://terminology.hl7.org/CodeSystem/observation-category#reproductive
* code = $LOINC#8669-4 "Ovulation status"
* subject 1..1 MS
* effectiveDateTime 1..1 MS

* component ^slicing.discriminator.type = #pattern
* component ^slicing.discriminator.path = "code"
* component ^slicing.rules = #open

* component contains
    cervicalMucus 0..1 MS and
    ovulationTest 0..1 MS and
    fertilityStatus 0..1 MS

* component[cervicalMucus].valueCodeableConcept from https://2rdoc.pt/fhir/ValueSet/cervical-mucus-vs (required)
* component[ovulationTest].valueCodeableConcept from https://2rdoc.pt/fhir/ValueSet/ovulation-test-vs (required)
* component[fertilityStatus].valueCodeableConcept from https://2rdoc.pt/fhir/ValueSet/fertility-status-vs (required)



// ===== Conteúdo de: EnvironmentalExtensions.fsh =====

Extension: ExposureLocation
Id: exposure-location
Title: "Exposure Location Extension"
Description: "Extension for recording location of environmental exposure measurement"

* ^version = "0.1.0"
* ^status = #draft
* ^context[+].type = #element
* ^context[=].expression = "Observation"

* value[x] only CodeableConcept
* valueCodeableConcept from ExposureLocationVS (required)
* valueCodeableConcept ^short = "Location type of exposure"
* valueCodeableConcept ^definition = "Categorizes the type of location where environmental exposure occurred"

Extension: ExposureConditions
Id: exposure-conditions
Title: "Exposure Conditions Extension"
Description: "Additional conditions during environmental exposure measurement"

* ^version = "0.1.0"
* ^status = #draft
* ^context[+].type = #element
* ^context[=].expression = "Observation"

* value[x] only CodeableConcept
* valueCodeableConcept from ExposureConditionsVS (required)
* valueCodeableConcept ^short = "Conditions during exposure"

ValueSet: ExposureLocationVS
Id: exposure-location-vs
Title: "Exposure Location Value Set"
Description: "Value set for environmental exposure locations"

* ^version = "0.1.0"
* ^status = #draft
* ^experimental = true
* codes from system ExposureLocationCS

ValueSet: ExposureConditionsVS
Id: exposure-conditions-vs
Title: "Exposure Conditions Value Set"
Description: "Value set for environmental exposure conditions"

* ^version = "0.1.0"
* ^status = #draft
* ^experimental = true
* codes from system ExposureConditionsCS

CodeSystem: ExposureLocationCS
Id: exposure-location-cs
Title: "Exposure Location Code System"
Description: "Code system for environmental exposure locations"

* ^version = "0.1.0"
* ^status = #draft
* ^caseSensitive = true
* ^experimental = true

* #indoor "Indoor environment" "Environment within buildings or enclosed spaces"
* #outdoor "Outdoor environment" "Open-air environment"
* #workplace "Workplace" "Professional or occupational environment"
* #transit "In transit" "While in transportation or commuting"
* #recreational "Recreational area" "Leisure or sports facilities"
* #urban "Urban area" "City or densely populated area"
* #rural "Rural area" "Countryside or sparsely populated area"

CodeSystem: ExposureConditionsCS
Id: exposure-conditions-cs
Title: "Exposure Conditions Code System"
Description: "Code system for conditions during environmental exposure"

* ^version = "0.1.0"
* ^status = #draft
* ^caseSensitive = true
* ^experimental = true

* #normal "Normal conditions" "Standard environmental conditions"
* #extreme "Extreme conditions" "Unusual or severe environmental conditions"
* #controlled "Controlled environment" "Environment with controlled conditions"
* #variable "Variable conditions" "Changing environmental conditions"



// ===== Conteúdo de: PatientExample.fsh =====

Instance: PatientExample
InstanceOf: Patient
Usage: #example
Description: "Patient resource example"
* identifier[0].system = "urn:oid:2.16.858.1.1.1"
* identifier[0].value = "12345"
* name.given = "John"
* name.family = "Doe"
* gender = #male
* birthDate = "1970-01-01"



// ===== Conteúdo de: MindfulnessWorkflow.fsh =====

Profile: MindfulnessSchedule
Parent: Basic
Id: mindfulness-schedule
Title: "Mindfulness Schedule"
Description: "Schedule configuration for mindfulness sessions"

* code 1..1 MS
* code = https://2rdoc.pt/fhir/CodeSystem/mindfulness-schedule-type#recurring "Recurring Schedule"

Extension: MindfulnessScheduleTiming
Id: mindfulness-schedule-timing
Title: "Mindfulness Schedule Timing"
Description: "Timing configuration for mindfulness sessions"
* value[x] only Timing

Instance: WeeklyMindfulnessSchedule
InstanceOf: MindfulnessSchedule
Title: "Weekly Mindfulness Schedule"
Description: "Example of a weekly mindfulness schedule"

* code = https://2rdoc.pt/fhir/CodeSystem/mindfulness-schedule-type#recurring "Recurring Schedule"
* extension[mindfulness-schedule-timing].valueTiming.repeat.frequency = 1
* extension[mindfulness-schedule-timing].valueTiming.repeat.period = 1
* extension[mindfulness-schedule-timing].valueTiming.repeat.periodUnit = #wk
* extension[mindfulness-schedule-timing].valueTiming.repeat.dayOfWeek = #mon
* extension[mindfulness-schedule-timing].valueTiming.repeat.dayOfWeek[+] = #wed
* extension[mindfulness-schedule-timing].valueTiming.repeat.dayOfWeek[+] = #fri



// ===== Conteúdo de: MindfulnessProfiles.fsh =====

Profile: MindfulnessObservation
Parent: Observation
Id: mindfulness-observation
Title: "Mindfulness Session Observation"
Description: "Profile for recording mindfulness practice sessions and outcomes"

* status MS
* code MS
* subject MS
* effectiveDateTime MS
* performer MS
* value[x] MS
* component MS

* status = #final
* code = $SCT#711415009 "Mindfulness"
* subject only Reference(Patient)
* effectiveDateTime 1..1
* performer only Reference(Practitioner or PractitionerRole)

* component ^slicing.discriminator.type = #pattern
* component ^slicing.discriminator.path = "code"
* component ^slicing.rules = #open

* component contains
    sessionDuration 0..1 and
    stressLevel 0..1 and
    moodState 0..1 and
    relaxationResponse 0..1 and
    mindfulnessType 0..1

* component[sessionDuration]
  * code = $SCT#118682006 "Duration"
  * value[x] only Quantity
  * valueQuantity
    * value 1..1
    * unit = "min"
    * system = "http://unitsofmeasure.org"
    * code = #min

* component[stressLevel]
  * code = $SCT#725854004 "Assessment of stress level"
  * value[x] only integer
  * valueInteger
    * ^extension[0].url = "http://hl7.org/fhir/StructureDefinition/elementdefinition-minValueInteger"
    * ^extension[0].valueInteger = 0
    * ^extension[1].url = "http://hl7.org/fhir/StructureDefinition/elementdefinition-maxValueInteger"
    * ^extension[1].valueInteger = 10

* component[moodState]
  * code = $SCT#373931001 "Mood finding"
  * value[x] only CodeableConcept
  * valueCodeableConcept from https://2rdoc.pt/fhir/ValueSet/mood (required)

* component[relaxationResponse]
  * code = $SCT#276241001 "Relaxation technique"
  * value[x] only string

* component[mindfulnessType]
  * code = $SCT#711415009 "Mindfulness"
  * value[x] only CodeableConcept
  * valueCodeableConcept from https://2rdoc.pt/fhir/ValueSet/mindfulness-type (required)



// ===== Conteúdo de: SocialInteractionMappings.fsh =====

Mapping: SocialInteractionToHealthKit
Id: social-interaction-to-healthkit
Description: "Definition for social-interaction-to-healthkit resource"Title: "Mapping to Apple HealthKit"
Source: SocialInteractionProfile
Target: "http://developer.apple.com/documentation/healthkit"

* -> "HKCategoryTypeIdentifierSocialInteraction" "Root mapping"
* valueCodeableConcept -> "interactionType" "Type of interaction"
* component[duration] -> "duration" "Duration of interaction"
* component[participants] -> "participantCount" "Number of participants"

Mapping: SocialInteractionToLOINC
Id: social-interaction-to-loinc
Title: "Mapping to LOINC codes"
Source: SocialInteractionProfile
Target: "http://loinc.org"

* -> "96766-1" "Social Interaction Panel"
* component[duration] -> "89597-9" "Interaction duration"
* component[quality] -> "89598-7" "Interaction quality"



// ===== Conteúdo de: MindfulnessSearchParameters.fsh =====

Instance: MindfulnessType
InstanceOf: SearchParameter
Description: "Example instance of MindfulnessType"Usage: #definition
* status = #active
* code = #mindfulness-type
* name = "MindfulnessType"
* description = "Search for mindfulness observations by practice type"
* base = #Observation
* type = #token
* expression = "Observation.component.where(code.coding.exists(system = 'http://snomed.info/sct' and code = '711415009')).value.as(CodeableConcept)"
* xpath = "f:Observation/f:component[f:code/f:coding[f:system/@value='http://snomed.info/sct' and f:code/f:coding/f:code/@value='711415009']]/f:valueCodeableConcept"
* xpathUsage = #normal



// ===== Conteúdo de: MindfulnessSecurity.fsh =====

// ====== Mindfulness Security and Consent Resources ======

Instance: MindfulnessSecurityDefinition
InstanceOf: Consent
Usage: #example
* status = #active
* scope = $consentscope#patient-privacy "Privacy Consent"
* category[0] = $loinc#59284-0 "Patient Consent"
* patient = Reference(Patient/PatientMindfulness)
* dateTime = "2024-01-01"
* organization = Reference(Organization/Org2RDoc)
* policy[0].authority = "http://terminology.hl7.org/CodeSystem/consentpolicycodes"
* policy[0].uri = "http://terminology.hl7.org/CodeSystem/consentpolicycodes"
* provision.type = #permit
* provision.period.start = "2024-01-01"
* provision.period.end = "2025-12-31"
* provision.actor[0].role = $v3-RoleCode#TREAT "treatment"
* provision.actor[0].reference.identifier.system = "http://terminology.hl7.org/CodeSystem/practitioner-identifier"
* provision.actor[0].reference.identifier.value = "1234567890"
* provision.securityLabel[0] = $v3-Confidentiality#N "normal"
* provision.purpose[0] = $v3-ActReason#TREAT "treatment"
* provision.dataPeriod.start = "2024-01-01"
* provision.dataPeriod.end = "2025-12-31"

Instance: MindfulnessAccessPolicy
InstanceOf: Consent
Usage: #example
* status = #active
* scope = $consentscope#patient-privacy "Privacy Consent"
* category[0] = $loinc#59284-0 "Patient Consent"
* patient = Reference(Patient/PatientMindfulness)
* dateTime = "2024-01-01"
* organization = Reference(Organization/Org2RDoc)

// Políticas multi-jurisdicionais - começando do índice 0
* policy[0].authority = "http://terminology.hl7.org/CodeSystem/consentpolicycodes"
* policy[0].uri = "http://terminology.hl7.org/CodeSystem/consentpolicycodes"

// GDPR - Europa
* policy[1].authority = "https://eur-lex.europa.eu/eli/reg/2016/679/oj"
* policy[1].uri = "https://health.ec.europa.eu/ehealth-digital-health-and-care/european-health-data-space-regulation-ehds_en"

// HIPAA - Estados Unidos
* policy[2].authority = "https://www.hhs.gov/hipaa/index.html"
* policy[2].uri = "https://www.hhs.gov/hipaa/for-professionals/privacy/laws-regulations/index.html"

// LGPD - Brasil
* policy[3].authority = "http://www.planalto.gov.br/ccivil_03/_ato2015-2018/2018/lei/L13709compilado.htm"
* policy[3].uri = "https://www.gov.br/anpd/pt-br/"

* provision.type = #permit
* provision.period.start = "2024-01-01"
* provision.period.end = "2025-12-31"
* provision.actor[0].role = $v3-RoleCode#TREAT "treatment"
* provision.actor[0].reference.identifier.system = "http://terminology.hl7.org/CodeSystem/practitioner-identifier"
* provision.actor[0].reference.identifier.value = "1234567890"
* provision.action[0] = $consentaction#access "Access"
* provision.action[1] = $consentaction#use "Use"
* provision.purpose[0] = $v3-ActReason#TREAT "treatment"
* provision.purpose[1] = $v3-ActReason#HPAYMT "healthcare payment"
* provision.purpose[2] = $v3-ActReason#HOPERAT "healthcare operations"
* provision.dataPeriod.start = "2024-01-01"
* provision.dataPeriod.end = "2025-12-31"

// ====== Aliases para simplificar referências ======
Alias: $consentscope = http://terminology.hl7.org/CodeSystem/consentscope
Alias: $loinc = http://loinc.org
Alias: $v3-RoleCode = http://terminology.hl7.org/CodeSystem/v3-RoleCode
Alias: $v3-Confidentiality = http://terminology.hl7.org/CodeSystem/v3-Confidentiality
Alias: $v3-ActReason = http://terminology.hl7.org/CodeSystem/v3-ActReason
Alias: $consentaction = http://terminology.hl7.org/CodeSystem/consentaction



// ===== Conteúdo de: BodyMetricsExtensions.fsh =====

Alias: $SCT = http://snomed.info/sct

Extension: MeasurementConditions
Id: measurement-conditions
Title: "Measurement Conditions Extension"
* ^experimental = falseDescription: "Records the conditions under which body measurements were taken"

* ^version = "0.1.0"
* ^status = #draft
* ^context[0].type = #element
* ^context[0].expression = "Observation"

* value[x] only CodeableConcept
* valueCodeableConcept from MeasurementConditionsVS (required)

Extension: MeasurementDevice
Id: measurement-device-type
Title: "Measurement Device Type Extension"
* ^experimental = falseDescription: "Specifies the type of device used for body measurements"

* ^version = "0.1.0"
* ^status = #draft
* ^context[0].type = #element
* ^context[0].expression = "Observation"

* value[x] only CodeableConcept
* valueCodeableConcept from MeasurementDeviceTypeVS (required)

ValueSet: MeasurementConditionsVS
Id: measurement-conditions-vs
Title: "Measurement Conditions Value Set"
* ^experimental = falseDescription: "Standard conditions under which measurements are taken"

* ^version = "0.1.0"
* ^status = #draft

* $SCT#307818003 "Pre-breakfast"
* $SCT#307819006 "Post-exercise"
* $SCT#307820000 "Wearing light clothing"
* $SCT#255203001 "First thing in morning"
* $SCT#255214005 "After void"
* $SCT#309604004 "During rest"

ValueSet: MeasurementDeviceTypeVS
Id: measurement-device-type-vs
Title: "Measurement Device Type Value Set"
* ^experimental = falseDescription: "Types of devices used for health and body measurements"

* ^version = "0.1.0"
* ^status = #draft

* $SCT#469576000 "Smart watch"
* $SCT#706767009 "Patient data recorder"
* $SCT#131009002 "Height measuring device"
* $SCT#706889009 "Blood pressure monitor"
* $SCT#444699000 "Tape measure"
* $SCT#44056008  "Digital scale"

Instance: WeightWithConditions
InstanceOf: WeightObservation
Usage: #example
Description: "Weight with conditions observation example"
Title: "Weight Measurement with Conditions Example"
* ^experimental = false
* status = #final
* category = http://terminology.hl7.org/CodeSystem/observation-category#vital-signs
* code = $LOINC#29463-7 "Body weight"
* subject = Reference(Patient/example)
* effectiveDateTime = "2024-03-19T08:00:00Z"
* valueQuantity = 70.5 'kg'

* extension[measurement-conditions].url = "https://2rdoc.pt/ig/ios-lifestyle-medicine/StructureDefinition/measurement-conditions"
* extension[measurement-conditions].valueCodeableConcept = $SCT#307818003 "Pre-breakfast"

* extension[measurement-device-type].url = "https://2rdoc.pt/ig/ios-lifestyle-medicine/StructureDefinition/measurement-device-type"
* extension[measurement-device-type].valueCodeableConcept = $SCT#469576000 "Smart scale device"



// ===== Conteúdo de: PractitionerNamingSystem.fsh =====

// ====== CodeSystem para Identificadores de Practitioners ======

CodeSystem: PractitionerIdentifierCS
Id: practitioner-identifier-cs
Title: "Practitioner Identifier Code System"
Description: "Sistema de códigos para identificação de practitioners"
* ^status = #active
* ^experimental = false
* ^caseSensitive = true
* #npi "National Provider Identifier" "US National Provider Identifier"
* #crm "Conselho Regional de Medicina" "Brazilian Medical Council Registration"
* #ssin "Social Security Identification Number" "Belgian SSIN"
* #rpps "Répertoire Partagé des Professionnels de Santé" "French Healthcare Professional Registry"

ValueSet: PractitionerIdentifierVS
Id: practitioner-identifier-vs
Title: "Practitioner Identifier Value Set"
Description: "Value set para identificadores de practitioners"
* ^status = #active
* ^experimental = false
* include codes from system PractitionerIdentifierCS



// ===== Conteúdo de: StressInvariants.fsh =====

Invariant: stress-level-range
Description: "Stress level score must be between 0 and 10"
Expression: "valueQuantity.exists() implies (valueQuantity.value >= 0 and valueQuantity.value <= 10)"
Severity: #error

Invariant: stress-component-consistency
Description: "Physiological and psychological stress scores must be consistent with overall score"
Expression: "component.where(code.coding.code='89593-8').value.exists() and component.where(code.coding.code='89594-6').value.exists() implies (component.where(code.coding.code='89593-8').value + component.where(code.coding.code='89594-6').value) div 2 = valueQuantity"
Severity: #warning



// ===== Conteúdo de: MindfulnessDiagnosticMappings.fsh =====

Instance: MindfulnessDiagnosticMap
InstanceOf: ConceptMap
Usage: #definition
Title: "Mindfulness Diagnostic Mappings"
Description: "Mapping of mindfulness outcomes to diagnostic codes"

* status = #draft
* experimental = false
* purpose = "Map mindfulness outcomes to standard diagnostic codes"
* sourceUri = "https://2rdoc.pt/fhir/ValueSet/mindfulness-outcome-vs"
* targetUri = "http://snomed.info/sct"

* group[0].source = "https://2rdoc.pt/fhir/CodeSystem/mindfulness-outcome-cs"
* group[0].target = "http://snomed.info/sct"
* group[0].element[0]
  * code = #stressReduction
  * target[0]
    * code = #73595000
    * display = "Stress"
    * equivalence = #narrower
    * comment = "Indicates reduction in stress levels"

* group[0].element[1]
  * code = #improvedSleep
  * target[0]
    * code = #248234008
    * display = "Sleep pattern"
    * equivalence = #narrower
    * comment = "Indicates improvement in sleep quality"

* group[0].element[2]
  * code = #emotionalBalance
  * target[0]
    * code = #285854004
    * display = "Emotional state"
    * equivalence = #equivalent
    * comment = "Maps to emotional state finding"

* group[0].element[3]
  * code = #increasedAwareness
  * target[0]
    * code = #736253002
    * display = "Mental state, behavior and/or psychosocial functioning"
    * equivalence = #relatedto
    * comment = "General improvement in mental state"

RuleSet: MindfulnessDiagnosticRules
* status MS
* code MS
* subject MS
* effective[x] MS
* value[x] MS
* method MS

* method from https://2rdoc.pt/fhir/ValueSet/mindfulness-diagnostic-method-vs (required)
* code from https://2rdoc.pt/fhir/ValueSet/mindfulness-diagnostic-code-vs (required)

* extension contains 
    diagnosticCertainty 0..1 MS and
    diagnosticTiming 0..1 MS



// ===== Conteúdo de: MindfulnessReports.fsh =====

Instance: MindfulnessProgressReport
InstanceOf: Measure
Usage: #definition
Title: "Mindfulness Practice Progress Report"
Description: "Example instance of MindfulnessProgressReport"
* status = #active
* experimental = false
* date = "2024-03-19"
* publisher = "Example Organization"
* description = "Measures progress in mindfulness practice over time"

* scoring = #continuous-variable
* type = #process
* riskAdjustment = "none"
* rateAggregation = "Average values over time period"

* group[0]
  * code = #practice-frequency
  * description = "Frequency of mindfulness practice"
  * population[0]
    * code = #denominator
    * criteria.language = #text/fhirpath
    * criteria.expression = "Observation.where(code.coding.code='711415009')"
  * stratifier[0]
    * code = #weekly
    * criteria.language = #text/fhirpath
    * criteria.expression = "Observation.effective.as(DateTime).truncate(@T).truncate(@W)"

* group[1]
  * code = #stress-reduction
  * description = "Stress level changes over time"
  * population[0]
    * code = #denominator
    * criteria.language = #text/fhirpath
    * criteria.expression = "Observation.where(component.code.coding.code='725854004')"
  * stratifier[0]
    * code = #trend
    * criteria.language = #text/fhirpath
    * criteria.expression = "component.where(code.coding.code='725854004').value.value"

RuleSet: ReportingMetrics
* group[+]
  * code = #session-duration
  * description = "Duration of practice sessions"
  * population[0]
    * code = #denominator
    * criteria.language = #text/fhirpath
    * criteria.expression = "Observation.component.where(code.coding.code='118682006')"
  * stratifier[0]
    * code = #average
    * criteria.language = #text/fhirpath
    * criteria.expression = "component.where(code.coding.code='118682006').value.value"

* group[+]
  * code = #mood-changes
  * description = "Mood state changes"
  * population[0]
    * code = #denominator
    * criteria.language = #text/fhirpath
    * criteria.expression = "Observation.component.where(code.coding.code='373931001')"



// ===== Conteúdo de: SleepQuality.fsh =====

Extension: SleepQuality
Id: sleep-quality
Title: "Sleep Quality Extension"
* ^experimental = falseDescription: "Extension for recording subjective sleep quality"
* value[x] only CodeableConcept
* valueCodeableConcept from SleepQualityExtendedVS (required)
 
ValueSet: SleepQualityExtendedVS
Id: sleep-quality-extended-vs
Description: "Extended value set for sleep quality assessment"Title: "Sleep Quality Value Set"
* $SCT#248220008 "Very good quality sleep"
* $SCT#248221007 "Good quality sleep"
* $SCT#248222000 "Poor quality sleep"
* $SCT#248223005 "Very poor quality sleep"



// ===== Conteúdo de: ReproductiveValueSets.fsh =====

ValueSet: ReproductiveGoalVS
Id: reproductive-goal-vs
Title: "Reproductive Health Goals Value Set"
Description: "Goals related to reproductive health tracking and planning"

* ^status = #active
* ^experimental = false
* ^date = "2024-03-19"

* $LOINC#8708-0 "Menstrual cycle length"
* $LOINC#55284-4 "Blood pressure"
* $LOINC#8310-5 "Body temperature"
* $LOINC#8302-2 "Body height"
* $LOINC#29463-7 "Body weight"
* $SCT#364311006 "Menstrual cycle monitoring"
* $SCT#289530006 "Reproductive health finding"

ValueSet: ReproductiveActivityVS
Id: reproductive-activity-vs
Title: "Reproductive Health Activities Value Set"
Description: "Activities related to reproductive health monitoring"

* ^status = #active
* ^experimental = false
* ^date = "2024-03-19"

* codes from system ReproductiveActivityCS

CodeSystem: ReproductiveActivityCS
Id: reproductive-activity-cs
Title: "Reproductive Health Activities Code System"
Description: "Code system for reproductive health monitoring activities"

* ^status = #active
* ^experimental = false
* ^caseSensitive = true

* #cycle-tracking "Cycle Tracking" "Track menstrual cycle dates and characteristics"
* #temp-monitoring "Temperature Monitoring" "Monitor basal body temperature"
* #symptom-tracking "Symptom Tracking" "Track reproductive health symptoms"
* #vitals-monitoring "Vitals Monitoring" "Monitor vital signs related to reproductive health"
* #fertility-signs "Fertility Signs" "Monitor fertility signs and indicators"
* #mood-tracking "Mood Tracking" "Track mood changes related to reproductive cycle"
* #medication-log "Medication Log" "Log reproductive health medications"
* #exercise-tracking "Exercise Tracking" "Track physical activity during cycle"



// ===== Conteúdo de: AuditFormatsValueSet.fsh =====

ValueSet: AuditFormatsValueSet
Id: audit-formats
Title: "Audit Formats Value Set"
Description: "Value set for audit format types"
* ^url = "https://2rdoc.pt/fhir/ValueSet/audit-formats"
* ^status = #active
* ^experimental = false
* ^date = "2024-12-27"
* include codes from system https://2rdoc.pt/fhir/CodeSystem/audit-formats

CodeSystem: AuditFormatsCodeSystem
Id: audit-formats
Title: "Audit Formats Code System"
Description: "Code system for audit format types"
* ^url = "https://2rdoc.pt/fhir/CodeSystem/audit-formats"
* ^status = #active
* ^experimental = false
* ^caseSensitive = true
* #text "Text Format"
* #structured "Structured Format"
* #mixed "Mixed Format"



// ===== Conteúdo de: SleepProfile.fsh =====

Alias: $SCT = http://snomed.info/sct
Alias: $LOINC = http://loinc.org
Alias: $UCUM = http://unitsofmeasure.org
 
Profile: SleepObservation
Parent: Observation
Id: sleep-observation
Title: "Sleep Observation Profile"
Description: "Profile for recording sleep data from iOS Health App"
 
* status MS
* category 1..1 MS
* category = http://terminology.hl7.org/CodeSystem/observation-category#sleep
* code 1..1 MS
* code = $LOINC#93832-4 "Sleep pattern panel"
* subject 1..1 MS
* subject only Reference(Patient)
* effectiveDateTime 0..1 MS
* effectivePeriod 0..1 MS
* device 0..1 MS
 
* component ^slicing.discriminator.type = #pattern
* component ^slicing.discriminator.path = "code"
* component ^slicing.rules = #open
 
* component contains
    timeInBed 1..1 MS and
    totalSleepTime 1..1 MS and
    deepSleep 0..1 MS and
    remSleep 0..1 MS and
    lightSleep 0..1 MS and
    respiratoryRate 0..1 MS and
    heartRateVariability 0..1 MS and
    interruptions 0..1 MS
 
* component[timeInBed].code = $LOINC#93831-6 "Time in bed"
* component[timeInBed].valueQuantity only Quantity
* component[timeInBed].valueQuantity.system = $UCUM
* component[timeInBed].valueQuantity.code = #min
 
* component[totalSleepTime].code = $LOINC#93833-2 "Sleep duration"
* component[totalSleepTime].valueQuantity only Quantity
* component[totalSleepTime].valueQuantity.system = $UCUM
* component[totalSleepTime].valueQuantity.code = #min
 
* component[deepSleep].code = $LOINC#93834-0 "Deep sleep duration"
* component[deepSleep].valueQuantity only Quantity
* component[deepSleep].valueQuantity.system = $UCUM
* component[deepSleep].valueQuantity.code = #min
 
* component[remSleep].code = $LOINC#93835-7 "REM sleep duration"
* component[remSleep].valueQuantity only Quantity
* component[remSleep].valueQuantity.system = $UCUM
* component[remSleep].valueQuantity.code = #min
 
* component[lightSleep].code = $LOINC#93836-5 "Light sleep duration"
* component[lightSleep].valueQuantity only Quantity
* component[lightSleep].valueQuantity.system = $UCUM
* component[lightSleep].valueQuantity.code = #min
 
* component[respiratoryRate].code = $LOINC#9279-1 "Respiratory rate"
* component[respiratoryRate].valueQuantity only Quantity
* component[respiratoryRate].valueQuantity.system = $UCUM
* component[respiratoryRate].valueQuantity.code = #/min
 
* component[heartRateVariability].code = $LOINC#80404-7 "R-R interval.standard deviation (Heart rate variability)"
* component[heartRateVariability].valueQuantity only Quantity
* component[heartRateVariability].valueQuantity.system = $UCUM
* component[heartRateVariability].valueQuantity.code = #ms
 
* component[interruptions].code = $LOINC#93837-3 "Number of awakenings during sleep"
* component[interruptions].valueQuantity only Quantity
* component[interruptions].valueQuantity.system = $UCUM
* component[interruptions].valueQuantity.code = #{count}
* extension contains SleepQuality named quality 0..1



// ===== Conteúdo de: MindfulnessMessaging.fsh =====

Alias: $MsgEvents = https://2rdoc.pt/fhir/CodeSystem/mindfulness-message-events
Alias: $MsgTypes = http://terminology.hl7.org/CodeSystem/message-type

Profile: MindfulnessMessageDefinition
Parent: MessageDefinition
Id: mindfulness-message-definition
Title: "Mindfulness Message Definition" 
Description: "Definition for mindfulness session messages"

* url 1..1 MS
* date 1..1 MS
* status 1..1 MS
* event[x] 1..1 MS
* category 0..1 MS
* focus 1..* MS
* focus.min 1..1

Instance: StartSessionMessage
InstanceOf: MindfulnessMessageDefinition
Title: "Start Session Message"
Description: "Message definition for starting a mindfulness session"

* url = "https://2rdoc.pt/ig/ios-lifestyle-medicine/MessageDefinition/start-session"
* date = "2024-03-19"
* status = #active
* eventCoding = $MsgEvents#session-start "Session Start"
* category = #notification
* focus.code = #Observation
* focus.min = 1
* focus.profile = "https://2rdoc.pt/ig/ios-lifestyle-medicine/StructureDefinition/mindfulness-session"

Instance: EndSessionMessage  
InstanceOf: MindfulnessMessageDefinition
Title: "End Session Message"
Description: "Message definition for ending a mindfulness session"

* url = "https://2rdoc.pt/ig/ios-lifestyle-medicine/MessageDefinition/end-session"
* date = "2024-03-19"
* status = #active
* eventCoding = $MsgEvents#session-end "Session End"
* category = #notification
* focus.code = #Observation
* focus.min = 1
* focus.profile = "https://2rdoc.pt/ig/ios-lifestyle-medicine/StructureDefinition/mindfulness-session"



// ===== Conteúdo de: MeasurementContextVS.fsh =====

ValueSet: MeasurementContextVS
Id: measurement-context-vs
Title: "Measurement Context Value Set"
Description: "Contexts in which measurements can be taken, including temporal and location-based contexts"
* ^status = #active
* ^experimental = false
* $SCT#272125009 "Assessment context value (qualifier value)"
* $SCT#307818003 "Before food"
* $SCT#307819006 "After food"
* $SCT#255214003 "After exercise"
* $SCT#264362003 "Time of day"



// ===== Conteúdo de: MobilityRiskAssessment.fsh =====

Profile: MobilityRiskAssessment
Parent: RiskAssessment
Id: mobility-risk-assessment
Title: "Mobility Risk Assessment Profile"
Description: "Profile for assessing mobility-related risks"

* status MS
* subject 1..1 MS
* occurrence[x] MS
* prediction MS
  * outcome MS
  * probability[x] MS
  * qualitativeRisk MS

* method MS
  * coding ^slicing.discriminator.type = #pattern
  * coding ^slicing.discriminator.path = "$this"
  * coding ^slicing.rules = #open
  * coding contains
      mobilityAssessment 1..1 MS

* method.coding[mobilityAssessment] = https://2rdoc.pt/fhir/CodeSystem/mobility-assessment-method#standardized "Standardized Mobility Assessment"

* prediction ^slicing.discriminator.type = #pattern
* prediction ^slicing.discriminator.path = "outcome"
* prediction ^slicing.rules = #open

* prediction contains
    fallRisk 0..1 MS and
    mobilityDecline 0..1 MS and
    assistanceNeeded 0..1 MS

* prediction[fallRisk].outcome from https://2rdoc.pt/fhir/ValueSet/fall-risk-outcomes
* prediction[fallRisk].probabilityDecimal 0..1 MS
* prediction[fallRisk].qualitativeRisk from https://2rdoc.pt/fhir/ValueSet/risk-level

* prediction[mobilityDecline].outcome from https://2rdoc.pt/fhir/ValueSet/mobility-decline-outcomes
* prediction[mobilityDecline].probabilityDecimal 0..1 MS
* prediction[mobilityDecline].qualitativeRisk from https://2rdoc.pt/fhir/ValueSet/risk-level

* prediction[assistanceNeeded].outcome from https://2rdoc.pt/fhir/ValueSet/assistance-level-outcomes
* prediction[assistanceNeeded].probabilityDecimal 0..1 MS
* prediction[assistanceNeeded].qualitativeRisk from https://2rdoc.pt/fhir/ValueSet/risk-level

* basis only Reference(MobilityProfile or Observation or QuestionnaireResponse)
* basis MS

* note MS



// ===== Conteúdo de: EnvironmentalProfiles.fsh =====

Alias: $SCT = http://snomed.info/sct
Alias: $LOINC = http://loinc.org
Alias: $UCUM = http://unitsofmeasure.org

Profile: EnvironmentalObservation
Parent: Observation
Id: environmental-observation
Title: "Environmental Observation Profile"
Description: "Base profile for environmental measurements from iOS Health App"

* ^version = "0.1.0"
* ^status = #draft
* ^publisher = "HL7 International"
* ^contact.name = "Environmental Health Working Group"

* status MS
* category 1..1 MS
* category = http://terminology.hl7.org/CodeSystem/observation-category#environment
* subject 1..1 MS
* effectiveDateTime 1..1 MS
* device 0..1 MS
* method 0..1 MS
* note 0..* MS

Profile: NoiseExposureObservation
Parent: EnvironmentalObservation
Id: noise-exposure-observation
Title: "Noise Exposure Observation Profile"
Description: "Profile for noise exposure measurements from iOS Health App"

* code = $LOINC#28573-7 "Noise exposure time"
* component ^slicing.discriminator.type = #pattern
* component ^slicing.discriminator.path = "code"
* component ^slicing.rules = #open
* component ^short = "Noise exposure components"
* component ^definition = "Components of noise exposure measurement"

* component contains
    level 1..1 MS and
    duration 1..1 MS and
    peakLevel 0..1 MS and
    backgroundNoise 0..1 MS

* component[level].code = $LOINC#89020-2 "Environmental noise average"
* component[level].valueQuantity.system = $UCUM
* component[level].valueQuantity.code = #dB
* component[level].valueQuantity ^short = "Noise level in decibels"

* component[duration].code = $LOINC#89021-0 "Environmental noise duration"
* component[duration].valueQuantity.system = $UCUM
* component[duration].valueQuantity.code = #min
* component[duration].valueQuantity ^short = "Duration of exposure"

* component[peakLevel].code = $LOINC#89024-4 "Peak sound level"
* component[peakLevel].valueQuantity.system = $UCUM
* component[peakLevel].valueQuantity.code = #dB
* component[peakLevel].valueQuantity ^short = "Peak noise level"

* component[backgroundNoise].code = $LOINC#89025-1 "Background noise level"
* component[backgroundNoise].valueQuantity.system = $UCUM
* component[backgroundNoise].valueQuantity.code = #dB
* component[backgroundNoise].valueQuantity ^short = "Background noise level"

Profile: UVExposureObservation
Parent: EnvironmentalObservation
Id: uv-exposure-observation
Title: "UV Exposure Observation Profile"
Description: "Profile for UV exposure measurements from iOS Health App"

* code = $LOINC#28574-5 "UV exposure"
* component ^slicing.discriminator.type = #pattern
* component ^slicing.discriminator.path = "code"
* component ^slicing.rules = #open
* component ^short = "UV exposure components"
* component ^definition = "Components of UV exposure measurement"

* component contains
    index 1..1 MS and
    duration 1..1 MS and
    timeOfDay 0..1 MS and
    intensity 0..1 MS

* component[index].code = $LOINC#89022-8 "UV index"
* component[index].valueQuantity.system = $UCUM
* component[index].valueQuantity.code = #{index}
* component[index].valueQuantity ^short = "UV index value"

* component[duration].code = $LOINC#89023-6 "UV exposure duration"
* component[duration].valueQuantity.system = $UCUM
* component[duration].valueQuantity.code = #min
* component[duration].valueQuantity ^short = "Duration of UV exposure"

* component[timeOfDay].code = $LOINC#89026-9 "Time of exposure"
* component[timeOfDay].valueDateTime 1..1
* component[timeOfDay].valueDateTime ^short = "Time of UV exposure"

* component[intensity].code = $LOINC#89027-7 "UV intensity"
* component[intensity].valueQuantity.system = $UCUM
* component[intensity].valueQuantity.code = #W/m2
* component[intensity].valueQuantity ^short = "UV radiation intensity"

Extension: EnvironmentalContext
Id: environmental-context
Title: "Environmental Context Extension"
Description: "Additional context about environmental measurements"

* value[x] only CodeableConcept
* valueCodeableConcept from https://2rdoc.pt/fhir/ValueSet/environmental-context (required)



// ===== Conteúdo de: SocialInteractionProfile.fsh =====

Profile: SocialInteractionProfile
Parent: Observation
Id: social-interaction
Title: "Social Interaction Profile"
Description: "Profile for recording social interaction data from iOS Health App"

* ^version = "0.1.0"
* ^status = #active
* ^date = "2024-01-03"
* ^publisher = "FMUP HEADS2"

* status MS
* category 1..1 MS
* category = http://terminology.hl7.org/CodeSystem/observation-category#social-history
* code 1..1 MS
* code = $LOINC#96766-1 "Social interaction pattern"
* subject 1..1 MS
* effectiveDateTime 1..1 MS
* value[x] only CodeableConcept
* valueCodeableConcept from SocialInteractionTypeVS (required)

* component ^slicing.discriminator.type = #pattern
* component ^slicing.discriminator.path = "code"
* component ^slicing.rules = #open

* component contains
    duration 0..1 MS and
    quality 0..1 MS and
    medium 0..1 MS and
    participants 0..1 MS

* component[duration]
  * code = $LOINC#89597-9 "Social interaction duration"
  * valueQuantity only Quantity
  * valueQuantity.system = $UCUM
  * valueQuantity.code = #min

* component[quality]
  * code = $LOINC#89598-7 "Social interaction quality"
  * valueCodeableConcept from SocialInteractionQualityVS (required)

* component[medium]
  * code = $LOINC#89599-5 "Social interaction medium"
  * valueCodeableConcept from SocialInteractionMediumVS (required)

* component[participants]
  * code = $LOINC#89600-1 "Social interaction participants"
  * valueInteger only integer

* extension contains
    SocialContext named context 0..1 MS and
    SocialSupport named support 0..1 MS and
    SocialActivity named activity 0..* MS



// ===== Conteúdo de: MindfulnessExtensions.fsh =====

Extension: MindfulnessContext
Id: mindfulness-context
Title: "Mindfulness Session Context"
Description: "Additional context about the mindfulness practice session"

* ^url = "https://2rdoc.pt/ig/ios-lifestyle-medicine/StructureDefinition/mindfulness-context"
* ^version = "1.0.0"
* ^status = #draft
* ^date = "2024-03-19"
* ^publisher = "Example Organization"

* extension contains
    location 0..1 and
    environment 0..1 and
    guidance 0..1

* extension[location].value[x] only string
* extension[location].valueString 1..1
* extension[location] ^short = "Physical location of practice"
* extension[location] ^definition = "The physical location where the mindfulness practice took place"

* extension[environment].value[x] only CodeableConcept
* extension[environment].valueCodeableConcept from https://2rdoc.pt/fhir/ValueSet/environment-type (required)
* extension[environment] ^short = "Environmental conditions"
* extension[environment] ^definition = "The environmental conditions during the practice session"

* extension[guidance].value[x] only boolean
* extension[guidance].valueBoolean 1..1
* extension[guidance] ^short = "Whether guidance was used"
* extension[guidance] ^definition = "Indicates if the session was guided or self-directed"



// ===== Conteúdo de: MindfulnessTerminology.fsh =====

CodeSystem: MindfulnessOutcomeCS
Id: mindfulness-outcome-cs
Title: "Mindfulness Outcomes"
Description: "Outcomes and effects of mindfulness practice"

* ^experimental = false
* ^caseSensitive = true
* #increasedAwareness "Increased Awareness" "Greater awareness of thoughts and sensations"
* #improvedFocus "Improved Focus" "Enhanced ability to concentrate"
* #stressReduction "Stress Reduction" "Decreased levels of stress and tension"
* #emotionalBalance "Emotional Balance" "Better emotional regulation"
* #improvedSleep "Improved Sleep" "Enhanced sleep quality"

ValueSet: MindfulnessOutcomeVS
Id: mindfulness-outcome-vs
Title: "Mindfulness Outcomes Value Set"
Description: "Value set for mindfulness practice outcomes"

* ^experimental = false
* include codes from system MindfulnessOutcomeCS
* include $SCT#365949003 "Finding of level of stress"
* include $SCT#373931001 "Mood finding"

CodeSystem: MindfulnessQualifierCS
Id: mindfulness-qualifier-cs
Title: "Mindfulness Practice Qualifiers"
Description: "Qualifiers for mindfulness practice characteristics"

* ^experimental = false
* ^caseSensitive = true
* #guided "Guided Practice" "Practice with guidance or instruction"
* #selfDirected "Self-Directed" "Independent practice"
* #group "Group Practice" "Practice in group setting"
* #individual "Individual Practice" "Solo practice session"

ValueSet: MindfulnessQualifierVS
Id: mindfulness-qualifier-vs
Title: "Mindfulness Practice Qualifiers Value Set"
Description: "Value set for mindfulness practice qualifiers"

* ^experimental = false
* include codes from system MindfulnessQualifierCS
* include $SCT#410534003 "Guided meditation"
* include $SCT#225386006 "Exercise therapy"

* ^copyright = "This value set includes content from SNOMED CT, which is copyright © 2002+ International Health Terminology Standards Development Organisation (IHTSDO)"



// ===== Conteúdo de: SocialInteractionExtensions.fsh =====

Extension: SocialContext
Id: social-context
Title: "Social Context Extension"
* ^experimental = falseDescription: "Extension for recording the context of social interaction"
* value[x] only CodeableConcept
* valueCodeableConcept from SocialContextVS (required)

Extension: SocialSupport
Id: social-support
Title: "Social Support Extension"
* ^experimental = falseDescription: "Extension for recording perceived social support"
* value[x] only CodeableConcept
* valueCodeableConcept from SocialSupportVS (required)

Extension: SocialActivity
Id: social-activity
Title: "Social Activity Extension"
* ^experimental = falseDescription: "Extension for recording specific social activities"
* value[x] only CodeableConcept
* valueCodeableConcept from SocialActivityVS (required)

ValueSet: SocialContextVS
Id: social-context-vs
Title: "Social Context Value Set"
* ^experimental = falseDescription: "Value set for social interaction contexts"
* codes from system SocialContextCS

ValueSet: SocialSupportVS
Id: social-support-vs
Title: "Social Support Value Set"
* ^experimental = falseDescription: "Value set for levels of social support"
* codes from system SocialSupportCS

ValueSet: SocialActivityVS
Id: social-activity-vs
Title: "Social Activity Value Set"
* ^experimental = falseDescription: "Value set for types of social activities"
* codes from system SocialActivityCS

CodeSystem: SocialContextCS
Id: social-context-cs
Title: "Social Context Code System"
* ^experimental = falseDescription: "Code system for social interaction contexts"
* #home "Home" "Home environment"
* #work "Work" "Work environment"
* #education "Educational" "Educational setting"
* #community "Community" "Community setting"
* #recreational "Recreational" "Recreational setting"
* #healthcare "Healthcare" "Healthcare setting"

CodeSystem: SocialSupportCS
Id: social-support-cs
Title: "Social Support Code System"
* ^experimental = falseDescription: "Code system for levels of social support"
* #strong "Strong Support" "Strong social support network"
* #adequate "Adequate Support" "Sufficient social support"
* #limited "Limited Support" "Limited social support"
* #minimal "Minimal Support" "Minimal social support"
* #none "No Support" "Absence of social support"

CodeSystem: SocialActivityCS
Id: social-activity-cs
Title: "Social Activity Code System"
* ^experimental = falseDescription: "Code system for types of social activities"
* #meal "Shared Meal" "Sharing a meal together"
* #exercise "Group Exercise" "Group physical activity"
* #entertainment "Entertainment" "Shared entertainment activity"
* #learning "Learning" "Group learning activity"
* #volunteering "Volunteering" "Community service activity"
* #celebration "Celebration" "Social celebration or event"



// ===== Conteúdo de: AuditLevelsValueSet.fsh =====

ValueSet: AuditLevelsValueSet
Id: audit-levels
Title: "Audit Levels Value Set"
Description: "Value set for audit level types"
* ^url = "https://2rdoc.pt/fhir/ValueSet/audit-levels"
* ^status = #active
* ^experimental = false
* ^date = "2024-12-27"
* include codes from system https://2rdoc.pt/fhir/CodeSystem/audit-levels

CodeSystem: AuditLevelsCodeSystem
Id: audit-levels
Title: "Audit Levels Code System"
Description: "Code system for audit level types"
* ^url = "https://2rdoc.pt/fhir/CodeSystem/audit-levels"
* ^status = #active
* ^experimental = false
* ^caseSensitive = true
* #low "Low Level"
* #medium "Medium Level"
* #high "High Level"



// ===== Conteúdo de: MobilityExamples.fsh =====

Profile: WalkingSteadinessObservation
Parent: MobilityProfile
Id: walking-steadiness-observation
Description: "Profile for assessing walking steadiness and balance"Title: "Walking Steadiness Observation Profile"

* code = $LOINC#LA32-8 "Balance"
* component contains
    balanceScore 0..1 MS and
    balanceStatus 0..1 MS

* component[balanceScore]
  * code = $LOINC#LA32-8 "Balance score"
  * valueQuantity.system = $UCUM
  * valueQuantity.code = #%

* component[balanceStatus]
  * code = $LOINC#LA32-9 "Balance status"
  * valueCodeableConcept from https://2rdoc.pt/fhir/ValueSet/balance-status (required)

Profile: WalkingSpeedObservation
Parent: MobilityProfile
Id: walking-speed-observation
Description: "Profile for measuring walking speed as part of mobility assessment"Title: "Walking Speed Observation Profile"

* code = $LOINC#LA29042-4 "Walking speed"
* component contains
    speed 0..1 MS and
    distance 0..1 MS

* component[speed]
  * code = $LOINC#LA29042-4 "Walking speed measurement"
  * valueQuantity.system = $UCUM
  * valueQuantity.code = #m/s

* component[distance]
  * code = $LOINC#LA29043-2 "Walking distance"
  * valueQuantity.system = $UCUM
  * valueQuantity.code = #m

Instance: WalkingSteadinessExample
InstanceOf: WalkingSteadinessObservation
Usage: #example
Description: "Walking steadiness observation example"
Title: "Walking Steadiness Measurement Example"

* status = #final
* category = http://terminology.hl7.org/CodeSystem/observation-category#activity
* code = $LOINC#LA32-8 "Balance"
* subject = Reference(Patient/PatientExample)
* effectiveDateTime = "2024-03-19T15:30:00Z"
* valueQuantity = 85 '1' "score"
* device = Reference(Device/iphone-example)

* component[balanceScore].valueQuantity = 85 '%' "percent"
* component[balanceStatus].valueCodeableConcept = $LOINC#LA32-10 "OK"

Instance: WalkingSpeedExample
InstanceOf: WalkingSpeedObservation
Usage: #example
Description: "Walking speed observation example"
Title: "Walking Speed Measurement Example"

* status = #final
* category = http://terminology.hl7.org/CodeSystem/observation-category#activity
* code = $LOINC#LA29042-4 "Walking speed"
* subject = Reference(Patient/PatientExample)
* effectiveDateTime = "2024-03-19T15:30:00Z"
* valueQuantity = 1.2 'm/s' "meters per second"
* device = Reference(Device/iphone-example)

* component[speed].valueQuantity = 1.2 'm/s' "meters per second"
* component[distance].valueQuantity = 10 'm' "meters"



// ===== Conteúdo de: MindfulnessRules.fsh =====

RuleSet: MindfulnessValidation
* ^extension[0].url = "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice"
* ^extension[0].valueBoolean = true

* status MS
* code MS
* subject MS
* effective[x] MS
* value[x] MS
* component MS

* status from http://hl7.org/fhir/ValueSet/observation-status
* code from http://snomed.info/sct?fhir_vs=isa/711415009
* subject only Reference(Patient)
* effective[x] only dateTime

* obeys mindfulness-session-duration
* obeys mindfulness-stress-level
* obeys mindfulness-mood-required
* obeys mindfulness-context-complete
* obeys sequential-measurements

RuleSet: MindfulnessQuestionnaireValidation
* status MS
* title MS
* item MS

* status = #active
* subjectType = #Patient
* item ^slicing.discriminator.type = #pattern
* item ^slicing.discriminator.path = "linkId"
* item ^slicing.rules = #open
* item contains 
    session 0..1 MS and
    mood 0..1 MS and
    stress 0..1 MS and
    relaxation 0..1 MS

* item[session]
  * linkId = "mindful_session"
  * text = "Mindfulness Session"
  * type = #group
  * required = true
  * repeats = false

* item[mood]
  * linkId = "mood_assessment"
  * text = "Mood Assessment"
  * type = #group
  * required = true
  * repeats = false

* item[stress]
  * linkId = "stress_assessment"
  * text = "Stress Assessment"
  * type = #group
  * required = true
  * repeats = false

* item[relaxation]
  * linkId = "relaxation"
  * text = "Relaxation"
  * type = #group
  * required = true
  * repeats = false

RuleSet: MindfulnessResponseValidation
* status MS
* subject MS
* authored MS
* item MS

* status = #completed
* subject only Reference(Patient)
* authored 1..1
* item ^slicing.discriminator.type = #pattern
* item ^slicing.discriminator.path = "linkId"
* item ^slicing.rules = #open



// ===== Conteúdo de: SocialInteractionValueSets.fsh =====

ValueSet: SocialInteractionTypeVS
Id: social-interaction-type-vs
Title: "Social Interaction Type Value Set"
* ^experimental = falseDescription: "Types of social interactions"
* codes from system SocialInteractionTypeCS

ValueSet: SocialInteractionQualityVS
Id: social-interaction-quality-vs
Title: "Social Interaction Quality Value Set"
* ^experimental = falseDescription: "Quality measures for social interactions"
* codes from system SocialInteractionQualityCS

ValueSet: SocialInteractionMediumVS
Id: social-interaction-medium-vs
Title: "Social Interaction Medium Value Set"
* ^experimental = falseDescription: "Mediums through which social interaction occurs"
* codes from system SocialInteractionMediumCS

CodeSystem: SocialInteractionTypeCS
Id: social-interaction-type-cs
Title: "Social Interaction Type Code System"
* ^experimental = falseDescription: "Types of social interactions"
* #family "Family Interaction" "Interaction with family members"
* #friends "Friend Interaction" "Interaction with friends"
* #professional "Professional Interaction" "Work-related interactions"
* #community "Community Interaction" "Community-based interactions"
* #group "Group Activity" "Organized group activities"
* #casual "Casual Interaction" "Casual social encounters"

CodeSystem: SocialInteractionQualityCS
Id: social-interaction-quality-cs
Title: "Social Interaction Quality Code System"
* ^experimental = falseDescription: "Quality measures for social interactions"
* #meaningful "Meaningful" "Deep, meaningful interaction"
* #supportive "Supportive" "Supportive interaction"
* #neutral "Neutral" "Neither positive nor negative"
* #superficial "Superficial" "Surface-level interaction"
* #stressful "Stressful" "Stressful or difficult interaction"

CodeSystem: SocialInteractionMediumCS
Id: social-interaction-medium-cs
Title: "Social Interaction Medium Code System"
* ^experimental = falseDescription: "Mediums through which social interaction occurs"
* #inPerson "In Person" "Face-to-face interaction"
* #video "Video Call" "Video-based interaction"
* #voice "Voice Call" "Voice-only interaction"
* #text "Text Based" "Text-based communication"
* #social "Social Media" "Social media interaction"
* #mixed "Mixed Medium" "Multiple communication methods"



// ===== Conteúdo de: PhysicalActivityExamples.fsh =====

Instance: PhysicalActivityExample1
InstanceOf: PhysicalActivityObservation
Usage: #example
Description: "Physical activity observation example"
Title: "Example of Walking Activity"
* status = #final
* category = http://terminology.hl7.org/CodeSystem/observation-category#activity
* code = $SNOMED#228557008 "Walking"
* subject = Reference(PatientExample)
* effectiveDateTime = "2024-03-19T15:30:00Z"
* device = Reference(DeviceActivityTracker)
* component[steps].code = $LOINC#55423-8 "Number of steps in 24 hour Measured"
* component[steps].valueQuantity = 8546 '1' "count"
* component[steps].valueQuantity.system = $UCUM
* component[steps].valueQuantity.unit = "count"
* component[distance].code = $LOINC#55430-3 "Distance walked"
* component[distance].valueQuantity = 6.2 'km' "kilometer"
* component[distance].valueQuantity.system = $UCUM
* component[distance].valueQuantity.unit = "kilometer"
* component[duration].code = $LOINC#55411-3 "Exercise duration"
* component[duration].valueQuantity = 72 'min' "minute"
* component[duration].valueQuantity.system = $UCUM
* component[duration].valueQuantity.unit = "minute"
* component[energy].code = $LOINC#55424-6 "Energy expenditure"
* component[energy].valueQuantity = 320 'kcal' "kilocalorie"
* component[energy].valueQuantity.system = $UCUM
* component[energy].valueQuantity.unit = "kilocalorie"

Instance: DeviceActivityTracker
InstanceOf: Device
Usage: #example
Description: "Activity tracker device example"
Title: "Activity Tracking Device"
* deviceName.name = "Health Activity Tracker"
* deviceName.type = #user-friendly-name
* manufacturer = "HealthTech Devices"
* modelNumber = "HAT-2024"
* type = $SCT#258158006 "Breathing rate"



// ===== Conteúdo de: MindfulnessConfig.fsh =====

Extension: MindfulnessSessionDuration
Id: mindfulness-session-duration
Title: "Mindfulness Session Duration"
Description: "Default duration for mindfulness sessions in minutes"
* value[x] only integer

Extension: MindfulnessReminderTime
Id: mindfulness-reminder-time
Title: "Mindfulness Reminder Time"
Description: "Default time for daily reminders"
* value[x] only time

Extension: MindfulnessPreferredGuide
Id: mindfulness-preferred-guide
Title: "Mindfulness Preferred Guide"
Description: "Preferred guide for mindfulness sessions"
* value[x] only string

Extension: MindfulnessNotificationEnabled
Id: mindfulness-notification-enabled
Title: "Mindfulness Notification Enabled"
Description: "Whether notifications are enabled for mindfulness sessions"
* value[x] only boolean

Profile: MindfulnessConfiguration
Parent: Basic
Id: mindfulness-configuration
Title: "Mindfulness Configuration"
Description: "Configuration settings for mindfulness sessions"

* code 1..1 MS
* code = https://2rdoc.pt/fhir/CodeSystem/mindfulness-config-type#settings "Mindfulness Settings"

* extension contains
    MindfulnessSessionDuration named sessionDuration 1..1 MS and
    MindfulnessReminderTime named reminderTime 1..1 MS and
    MindfulnessPreferredGuide named preferredGuide 0..1 MS and
    MindfulnessNotificationEnabled named notificationEnabled 1..1 MS

Instance: DefaultMindfulnessConfig
InstanceOf: MindfulnessConfiguration
Title: "Default Mindfulness Configuration"
Description: "Default configuration settings for mindfulness sessions"

* code = https://2rdoc.pt/fhir/CodeSystem/mindfulness-config-type#settings "Mindfulness Settings"
* extension[sessionDuration].valueInteger = 15
* extension[reminderTime].valueTime = "08:00:00"
* extension[preferredGuide].valueString = "Jane Smith"
* extension[notificationEnabled].valueBoolean = true



// ===== Conteúdo de: BodyMetricsExamples.fsh =====

Instance: WeightExample
InstanceOf: WeightObservation
Usage: #example
Description: "Weight observation example"
Title: "Weight Measurement Example"
* status = #final
* category = http://terminology.hl7.org/CodeSystem/observation-category#vital-signs
* code = $LOINC#29463-7 "Body weight"
* subject = Reference(PatientExample)
* performer = Reference(PractitionerExample)
* effectiveDateTime = "2024-03-19T08:00:00Z"
* valueQuantity = 70.5 'kg' "kilogram"
* valueQuantity.system = $UCUM
* valueQuantity.unit = "kilogram"
* device = Reference(SmartScale)

Instance: HeightExample
InstanceOf: HeightObservation
Usage: #example
Description: "Height observation example"
Title: "Height Measurement Example"
* status = #final
* category = http://terminology.hl7.org/CodeSystem/observation-category#vital-signs
* code = $LOINC#8302-2 "Body height"
* subject = Reference(PatientExample)
* performer = Reference(PractitionerExample)
* effectiveDateTime = "2024-03-19T08:00:00Z"
* valueQuantity = 175 'cm' "centimeter"
* valueQuantity.system = $UCUM
* valueQuantity.unit = "centimeter"

Instance: BMIExample
InstanceOf: BMIObservation
Usage: #example
Description: "Body Mass Index observation example"
Title: "BMI Calculation Example"
* status = #final
* category = http://terminology.hl7.org/CodeSystem/observation-category#vital-signs
* code = $LOINC#39156-5 "Body mass index (BMI)"
* subject = Reference(PatientExample)
* performer = Reference(PractitionerExample)
* effectiveDateTime = "2024-03-19T08:00:00Z"
* valueQuantity = 23.0 'kg/m2' "kilogram per square meter"
* valueQuantity.system = $UCUM
* valueQuantity.unit = "kilogram per square meter"
* derivedFrom[0] = Reference(Observation/WeightExample)
* derivedFrom[1] = Reference(Observation/HeightExample)

Instance: BodyCompositionExample
InstanceOf: BodyCompositionObservation
Usage: #example
Description: "Body composition observation example"
Title: "Body Composition Measurement Example" 
* status = #final
* category = http://terminology.hl7.org/CodeSystem/observation-category#vital-signs
* code = $LOINC#88365-2 "Body composition panel"
* subject = Reference(PatientExample)
* performer = Reference(PractitionerExample)
* effectiveDateTime = "2024-03-19T08:00:00Z"
* device = Reference(BioimpedanceAnalyzer)

* component[bodyFat].code = $LOINC#41982-0 "Percentage body fat"
* component[bodyFat].valueQuantity = 22.5 '%' "percent"
* component[bodyFat].valueQuantity.system = $UCUM
* component[bodyFat].valueQuantity.unit = "percent"

* component[leanMass].code = $LOINC#291-7 "Lean body mass"
* component[leanMass].valueQuantity = 54.6 'kg' "kilogram"
* component[leanMass].valueQuantity.system = $UCUM
* component[leanMass].valueQuantity.unit = "kilogram"

* component[bodyWater].code = $LOINC#73708-0 "Total body water"
* component[bodyWater].valueQuantity = 39.2 'L' "liter"
* component[bodyWater].valueQuantity.system = $UCUM
* component[bodyWater].valueQuantity.unit = "liter"

* component[muscleMass].code = $LOINC#73713-0 "Muscle mass"
* component[muscleMass].valueQuantity = 51.8 'kg' "kilogram"
* component[muscleMass].valueQuantity.system = $UCUM
* component[muscleMass].valueQuantity.unit = "kilogram"

* component[boneMass].code = $LOINC#73711-4 "Bone mass"
* component[boneMass].valueQuantity = 2.8 'kg' "kilogram"
* component[boneMass].valueQuantity.system = $UCUM
* component[boneMass].valueQuantity.unit = "kilogram"

Instance: SmartScale
InstanceOf: Device
Usage: #example
Description: "Smart scale device example"
Title: "Smart Scale Device"
* deviceName.name = "Smart Body Analyzer"
* deviceName.type = #user-friendly-name
* manufacturer = "HealthTech Devices"
* modelNumber = "SBA-2024"
* type = $SCT#469576000 "Digital scale device"

Instance: BioimpedanceAnalyzer  
InstanceOf: Device
Usage: #example
Description: "Bioimpedance analyzer device example"
Title: "Bioimpedance Analyzer Device"
* deviceName.name = "Professional Body Composition Analyzer"
* deviceName.type = #user-friendly-name
* manufacturer = "MedTech Solutions"
* modelNumber = "BCA-Pro"
* type = $SCT#706767009 "Patient data recorder"



// ===== Conteúdo de: StressLevelProfile.fsh =====

Profile: StressLevelProfile
Parent: Observation
Id: stress-level
Title: "Stress Level Profile"
Description: "Profile for recording stress level measurements from iOS Health App"

* ^version = "0.1.0"
* ^status = #active
* ^date = "2024-01-03"
* ^publisher = "FMUP HEADS2"

* status MS
* category 1..1 MS
* category = http://terminology.hl7.org/CodeSystem/observation-category#vital-signs
* code 1..1 MS
* code = $LOINC#89592-0 "Stress level score"
* subject 1..1 MS
* effectiveDateTime 1..1 MS
* value[x] only Quantity
* valueQuantity MS

* component ^slicing.discriminator.type = #pattern
* component ^slicing.discriminator.path = "code"
* component ^slicing.rules = #open

* component contains
    physiologicalStress 0..1 MS and
    psychologicalStress 0..1 MS and
    chronicity 0..1 MS and 
    impact 0..1 MS

* component[physiologicalStress]
  * code = $LOINC#89593-8 "Physiological stress"
  * valueQuantity only Quantity
  * valueQuantity.system = $UCUM
  * valueQuantity.code = #{score}

* component[psychologicalStress]
  * code = $LOINC#89594-6 "Psychological stress"
  * valueQuantity only Quantity
  * valueQuantity.system = $UCUM
  * valueQuantity.code = #{score}

* component[chronicity]
  * code = $LOINC#89595-3 "Stress chronicity"
  * valueCodeableConcept from StressChronicityVS (required)

* component[impact]
  * code = $LOINC#89596-1 "Stress impact"
  * valueCodeableConcept from StressImpactVS (required)

* extension contains
    MeasurementContext named context 0..1 MS and
    StressTriggers named triggers 0..* MS and 
    StressCoping named coping 0..* MS



// ===== Conteúdo de: MoodValueSet.fsh =====

ValueSet: MoodValueSet
Id: mood
Title: "Mood Value Set"
Description: "Value set for mood states"
* ^url = "https://2rdoc.pt/fhir/ValueSet/mood"
* ^status = #active
* ^experimental = false

CodeSystem: MoodCodeSystem
Id: mood
Title: "Mood Code System"
Description: "Code system for mood states"
* ^url = "https://2rdoc.pt/fhir/CodeSystem/mood"
* ^status = #active
* ^caseSensitive = true
* #elevated "Elevated" "Mood is higher than normal"
* #neutral "Neutral" "Neither elevated nor depressed mood"
* #depressed "Depressed" "Mood is lower than normal"
* #anxious "Anxious" "Feeling worried or nervous"
* #irritable "Irritable" "Easily annoyed or angered"
* #calm "Calm" "Feeling peaceful and relaxed"



// ===== Conteúdo de: MindfulnessAlerts.fsh =====

Extension: AlertTiming
Id: alert-timing
Title: "Alert Timing Extension"
Description: "Defines when alerts should be triggered"
* value[x] only Timing
* valueTiming.repeat 1..1 MS
* valueTiming.repeat.frequency MS
* valueTiming.repeat.period MS
* valueTiming.repeat.periodUnit MS

Extension: AlertMessage
Id: alert-message
Title: "Alert Message Extension"
Description: "Defines the alert message content"
* value[x] only string

Profile: MindfulnessAlert
Parent: Basic
Id: mindfulness-alert
Title: "Mindfulness Alert"
Description: "Alert configuration for mindfulness sessions"

* code 1..1 MS
* code = https://2rdoc.pt/fhir/CodeSystem/mindfulness-alert-type#reminder "Mindfulness Reminder"

* extension contains
    alert-timing named alertTiming 0..1 MS and
    alert-message named alertMessage 1..1 MS

Instance: DailyMindfulnessAlert
InstanceOf: MindfulnessAlert
Title: "Daily Mindfulness Alert" 
Description: "Example of a daily mindfulness alert configuration"

* code = https://2rdoc.pt/fhir/CodeSystem/mindfulness-alert-type#reminder "Mindfulness Reminder"
* extension[alertTiming].valueTiming.repeat
  * frequency = 1
  * period = 1
  * periodUnit = #d
* extension[alertMessage].valueString = "Time for your daily mindfulness practice"



// ===== Conteúdo de: MindfulnessAuditConfig.fsh =====

Extension: MindfulnessAuditLevel
Id: mindfulness-audit-level
Title: "Mindfulness Audit Level"
Description: "Level of detail for audit records"
* value[x] only code
* valueCode from https://2rdoc.pt/fhir/ValueSet/audit-levels (required)

Extension: MindfulnessAuditRetention
Id: mindfulness-audit-retention
Title: "Mindfulness Audit Retention"
Description: "Period to retain audit records"
* value[x] only Duration

Extension: MindfulnessAuditFormat
Id: mindfulness-audit-format
Title: "Mindfulness Audit Format"
Description: "Format for audit records"
* value[x] only code
* valueCode from https://2rdoc.pt/fhir/ValueSet/audit-formats (required)

Profile: MindfulnessAuditConfig
Parent: Basic
Id: mindfulness-audit-config
Title: "Mindfulness Audit Configuration"
Description: "Configuration for mindfulness session auditing"

* code 1..1 MS
* code = https://2rdoc.pt/fhir/CodeSystem/mindfulness-config-type#audit "Audit Configuration"

* extension contains
    MindfulnessAuditLevel named auditLevel 1..1 MS and
    MindfulnessAuditRetention named auditRetention 1..1 MS and
    MindfulnessAuditFormat named auditFormat 1..1 MS

Instance: DefaultAuditConfig
InstanceOf: MindfulnessAuditConfig
Title: "Default Audit Configuration"
Description: "Default configuration for mindfulness session auditing"

* code = https://2rdoc.pt/fhir/CodeSystem/mindfulness-config-type#audit "Audit Configuration"
* extension[auditLevel].valueCode = #detailed
* extension[auditRetention].valueDuration = 90 'days'
* extension[auditFormat].valueCode = #fhir



// ===== Conteúdo de: SymptomExamples.fsh =====

Instance: ChronicSymptomExample
InstanceOf: Observation
Usage: #example
Description: "Chronic symptom observation example"
* status = #final
* category = http://terminology.hl7.org/CodeSystem/observation-category#survey
* code = $SCT#267036007 "Fatigue"
* subject = Reference(Patient/PatientExample)
* performer = Reference(Practitioner/PractitionerExample)
* effectiveDateTime = "2024-03-19T14:00:00Z"
// ... resto do exemplo ...

Instance: ExampleSymptomSeverity
InstanceOf: Observation
Usage: #example
Description: "Symptom severity observation example"
* status = #final
* category = http://terminology.hl7.org/CodeSystem/observation-category#survey
* code = $SCT#246604007 "Symptom severity"
* subject = Reference(Patient/PatientExample)
* performer = Reference(Practitioner/PractitionerExample)
* effectiveDateTime = "2024-03-19T10:30:00Z"
// ... resto do exemplo ...



// ===== Conteúdo de: SleepExtensions.fsh =====




// ===== Conteúdo de: StressMappings.fsh =====

Mapping: StressToHealthKit
Id: stress-to-healthkit
Description: "Definition for stress-to-healthkit resource"Title: "Mapping to Apple HealthKit"
Source: StressLevelProfile
Target: "http://developer.apple.com/documentation/healthkit"

* -> "HKCategoryTypeIdentifierStressLevel" "Root mapping"
* valueQuantity -> "stressLevel" "Overall stress score"
* component[physiologicalStress] -> "physiologicalStress" "Physical stress indicators"
* component[psychologicalStress] -> "mentalStress" "Mental stress indicators"

Mapping: StressToLOINC
Id: stress-to-loinc
Title: "Mapping to LOINC codes"
Source: StressLevelProfile
Target: "http://loinc.org"

* -> "89592-0" "Stress Level Panel"
* component[physiologicalStress] -> "89593-8" "Physical stress score"
* component[psychologicalStress] -> "89594-6" "Mental stress score"



// ===== Conteúdo de: EnvironmentalContextVS.fsh =====

ValueSet: EnvironmentalContextValueSet
Id: environmental-context
Title: "Environmental Context Value Set"
Description: "Valid contexts for environmental measurements"

* ^status = #active
* ^experimental = false
* ^url = "https://2rdoc.pt/fhir/ValueSet/environmental-context"
* include codes from system https://2rdoc.pt/fhir/CodeSystem/environmental-context



// ===== Conteúdo de: ActivityTypeVS.fsh =====

ValueSet: PhysicalActivityTypeVS
Id: physical-activity-type-vs
Title: "Physical Activity Types Value Set"
* ^experimental = falseDescription: "Types of physical activities from iOS Health App"

* ^status = #active

* $SNOMED#255604002 "Physical activity (observable entity)"
* $SNOMED#228557008 "Walking"
* $SNOMED#229058003 "Running"
* $SNOMED#266938001 "Swimming"
* $SNOMED#266940006 "Cycling"
* $SNOMED#32147004 "Regular exercise"



// ===== Conteúdo de: SocialInteractionExamples.fsh =====

Instance: SocialInteractionExample
InstanceOf: SocialInteractionProfile
Usage: #example
Description: "Social interaction observation example"
Title: "Social Interaction Example"

* status = #final
* category = http://terminology.hl7.org/CodeSystem/observation-category#social-history
* code = $LOINC#96766-1 "Social interaction pattern"
* subject = Reference(Patient/PatientExample)
* effectiveDateTime = "2024-01-03T14:00:00Z"
* valueCodeableConcept = SocialInteractionTypeCS#family

* component[duration].valueQuantity = 120 'min' "minutes"
* component[quality].valueCodeableConcept = SocialInteractionQualityCS#meaningful
* component[medium].valueCodeableConcept = SocialInteractionMediumCS#inPerson
* component[participants].valueInteger = 4

* extension[context].valueCodeableConcept = SocialContextCS#home
* extension[support].valueCodeableConcept = SocialSupportCS#strong
* extension[activity].valueCodeableConcept = SocialActivityCS#meal



// ===== Conteúdo de: NutritionProfiles.fsh =====

Alias: $SCT = http://snomed.info/sct
Alias: $LOINC = http://loinc.org
Alias: $UCUM = http://unitsofmeasure.org

Profile: NutritionIntakeObservation
Parent: Observation
Id: nutrition-intake-observation
Title: "Nutrition Intake Observation Profile"
Description: "Profile for nutrition intake data from iOS Health App and user input"

* ^version = "0.1.0"
* ^status = #draft
* ^publisher = "Ricardo Lourenço dos Santos"

* status MS
* category 1..1 MS
* category = http://terminology.hl7.org/CodeSystem/observation-category#nutrition
* subject 1..1 MS
* effectiveDateTime 1..1 MS
* code 1..1 MS
* method 0..1 MS

Profile: WaterIntakeObservation
Parent: NutritionIntakeObservation 
Id: water-intake-observation
Title: "Water Intake Observation Profile"
Description: "Profile for water intake measurements"

* ^version = "0.1.0"
* ^status = #draft
* ^publisher = "Ricardo Lourenço dos Santos"

* code = $LOINC#77111-4 "Water intake"
* valueQuantity only Quantity
* valueQuantity.system = $UCUM
* valueQuantity.code = #mL
* valueQuantity.unit = "milliliter"

Profile: CalorieIntakeObservation
Parent: NutritionIntakeObservation
Id: calorie-intake-observation
Title: "Calorie Intake Observation Profile"
Description: "Profile for caloric intake measurements"

* ^version = "0.1.0"
* ^status = #draft
* ^publisher = "Ricardo Lourenço dos Santos"

* code = $LOINC#9051-4 "Caloric intake total"
* valueQuantity only Quantity
* valueQuantity.system = $UCUM
* valueQuantity.code = #kcal
* valueQuantity.unit = "kilocalorie"

Profile: MacronutrientsObservation
Parent: NutritionIntakeObservation
Id: macronutrients-observation
Title: "Macronutrients Observation Profile"
Description: "Profile for macronutrient intake measurements"

* ^version = "0.1.0"
* ^status = #draft
* ^publisher = "Ricardo Lourenço dos Santos"

* code = $LOINC#LP199119-9 "Macronutrients panel"
* component ^slicing.discriminator.type = #pattern
* component ^slicing.discriminator.path = "code"
* component ^slicing.rules = #open

* component contains
    carbohydrates 0..1 MS and
    proteins 0..1 MS and
    fats 0..1 MS

* component[carbohydrates].code = $LOINC#LP35925-4 "Carbohydrates"
* component[carbohydrates].valueQuantity.system = $UCUM
* component[carbohydrates].valueQuantity.code = #g
* component[carbohydrates].valueQuantity.unit = "gram"

* component[proteins].code = $LOINC#LP35921-3 "Proteins" 
* component[proteins].valueQuantity.system = $UCUM
* component[proteins].valueQuantity.code = #g
* component[proteins].valueQuantity.unit = "gram"

* component[fats].code = $LOINC#LP35922-1 "Fats"
* component[fats].valueQuantity.system = $UCUM
* component[fats].valueQuantity.code = #g
* component[fats].valueQuantity.unit = "gram"



// ===== Conteúdo de: MindfulnessTransforms.fsh =====

Instance: MindfulnessHealthKitTransform
InstanceOf: StructureMap
Usage: #definition
Title: "HealthKit to FHIR Mindfulness Transform"

* status = #draft
* name = "MindfulnessHealthKitTransform"
* structure[0]
  * url = "https://2rdoc.pt/ig/ios-lifestyle-medicine/StructureDefinition/healthkit-mindfulness"
  * mode = #source
  * documentation = "HealthKit mindfulness session structure"

* structure[1]
  * url = "http://hl7.org/fhir/StructureDefinition/Observation"
  * mode = #target
  * documentation = "FHIR Observation resource"

* group[0]
  * name = "MindfulnessSessionToObservation"
  * typeMode = #none
  * input[0]
    * name = "source"
    * type = "HealthKitMindfulness"
    * mode = #source
  * input[1]
    * name = "target"
    * type = "Observation"
    * mode = #target
  * rule[0]
    * name = "Session"
    * source[0]
      * context = "source"
      * element = "startDate"
    * target[0]
      * context = "target"
      * element = "effectiveDateTime"
  * rule[1]
    * name = "Duration"
    * source[0]
      * context = "source"
      * element = "duration"
    * target[0]
      * context = "target"
      * element = "component.where(code.coding.code='118682006').valueQuantity"

Instance: MindfulnessCSVTransform
InstanceOf: StructureMap
Usage: #definition
Title: "CSV to FHIR Mindfulness Transform"

* status = #draft
* name = "MindfulnessCSVTransform"
* structure[0]
  * url = "https://2rdoc.pt/ig/ios-lifestyle-medicine/StructureDefinition/csv-mindfulness"
  * mode = #source
  * documentation = "CSV mindfulness data structure"

* group[0]
  * name = "CSVToMindfulnessObservation"
  * typeMode = #none
  * input[0]
    * name = "source"
    * type = "CSVMindfulness"
    * mode = #source
  * input[1]
    * name = "target"
    * type = "Observation"
    * mode = #target
  * rule[0]
    * name = "MapDatetime"
    * source[0]
      * context = "source"
      * element = "date,time"
    * target[0]
      * context = "target"
      * element = "effectiveDateTime"
      * transform = #append

RuleSet: TransformValidationRules
* rule[+]
  * name = "ValidateStatus"
  * source[0]
    * context = "target"
    * element = "status"
  * assert[0]
    * description = "Status must be final"
    * expression = "%status = 'final'"

* rule[+]
  * name = "ValidateCode"
  * source[0]
    * context = "target"
    * element = "code"
  * assert[0]
    * description = "Must use SNOMED CT code"
    * expression = "%code.system = 'http://snomed.info/sct'"



// ===== Conteúdo de: VitalSignsExamples.fsh =====

Instance: HeartRateExample
InstanceOf: HeartRateObservation
Usage: #example
Description: "Heart rate observation example"
Title: "Heart Rate Measurement Example"
* status = #final
* code = $LOINC#8867-4 "Heart rate"
* subject = Reference(PatientExample)
* effectiveDateTime = "2024-03-19T15:30:00Z"
* valueQuantity = 72 '/min' "per minute"
* valueQuantity.system = $UCUM
* valueQuantity.unit = "per minute"
* device = Reference(DeviceHeartRateMonitor)
* performer = Reference(PractitionerExample)
* component[heartRateVariability].code = $LOINC#80404-7 "R-R interval.standard deviation (Heart rate variability)"
* component[heartRateVariability].valueQuantity = 45 'ms' "millisecond"
* component[heartRateVariability].valueQuantity.system = $UCUM
* component[heartRateVariability].valueQuantity.unit = "millisecond"

Instance: BloodPressureExample
InstanceOf: BloodPressureObservation
Usage: #example
Description: "Blood pressure observation example"
Title: "Blood Pressure Measurement Example"
* status = #final
* code = $LOINC#85354-9 "Blood pressure panel with all children optional"
* subject = Reference(PatientExample)
* effectiveDateTime = "2024-03-19T15:30:00Z"
* device = Reference(DeviceBloodPressureMonitor)
* performer = Reference(PractitionerExample)
* component[systolic].code = $LOINC#8480-6 "Systolic blood pressure"
* component[systolic].valueQuantity = 120 'mm[Hg]' "millimeter of mercury"
* component[systolic].valueQuantity.system = $UCUM
* component[systolic].valueQuantity.unit = "millimeter of mercury"
* component[diastolic].code = $LOINC#8462-4 "Diastolic blood pressure"
* component[diastolic].valueQuantity = 80 'mm[Hg]' "millimeter of mercury"
* component[diastolic].valueQuantity.system = $UCUM
* component[diastolic].valueQuantity.unit = "millimeter of mercury"

Instance: DeviceHeartRateMonitor
InstanceOf: Device
Usage: #example
Description: "Heart rate monitor device example"
Title: "Heart Rate Monitor Device"
* deviceName.name = "Continuous Heart Rate Monitor"
* deviceName.type = #user-friendly-name
* manufacturer = "HealthTech Devices"
* modelNumber = "HRM-2024"
* type = $SCT#720737000 "Pulse rate monitoring device"

Instance: DeviceBloodPressureMonitor
InstanceOf: Device
Usage: #example
Description: "Blood pressure monitor device example"
Title: "Blood Pressure Monitor Device"
* deviceName.name = "Digital Blood Pressure Monitor"
* deviceName.type = #user-friendly-name
* manufacturer = "HealthTech Devices"
* modelNumber = "BPM-2024"
* type = $SCT#43770009 "Blood pressure monitor"



// ===== Conteúdo de: MindfulnessValueSets.fsh =====

ValueSet: EnvironmentTypeValueSet
Id: environment-type
Title: "Environment Type Value Set"
* ^experimental = falseDescription: "Value set for environmental context types"
* ^url = "https://2rdoc.pt/fhir/ValueSet/environment-type"
* ^status = #active
* include codes from system https://2rdoc.pt/fhir/CodeSystem/environment-type

ValueSet: MindfulnessTypeValueSet
Id: mindfulness-type
Title: "Mindfulness Type Value Set"
* ^experimental = falseDescription: "Value set for types of mindfulness practices"
* ^url = "https://2rdoc.pt/fhir/ValueSet/mindfulness-type"
* ^status = #active
* include codes from system https://2rdoc.pt/fhir/CodeSystem/mindfulness-type



// ===== Conteúdo de: PractitionerExample.fsh =====

Instance: PractitionerExample
InstanceOf: Practitioner
Usage: #example
Description: "Practitioner resource example"
* identifier[0].system = "http://terminology.hl7.org/CodeSystem/practitioner-identifier"
* identifier[0].value = "9941339108"
* name.given = "Jane"
* name.family = "Smith"



// ===== Conteúdo de: MindfulnessCompleteExamples.fsh =====

Instance: CompleteMindfulnessSession
InstanceOf: MindfulnessObservation
Usage: #example
Description: "Complete mindfulness session observation example"
Title: "Complete Mindfulness Session Example"

* status = #final
* code = $SCT#711415009 "Mindfulness"
* subject = Reference(Patient/PatientExample)
* effectiveDateTime = "2024-03-19T08:00:00Z"
* performer = Reference(Practitioner/PractitionerExample)

* component[sessionDuration].code = $SCT#118682006 "Duration"
* component[sessionDuration].valueQuantity = 20 'min'

* component[stressLevel].code = $SCT#725854004 "Assessment of stress level"
* component[stressLevel].valueInteger = 3

* component[moodState].code = $SCT#373931001 "Mood finding"
* component[moodState].valueCodeableConcept = $SCT#130991005 "Neutral mood"

* component[relaxationResponse].code = $SCT#276241001 "Relaxation technique"
* component[relaxationResponse].valueString = "Deep breathing exercises with progressive relaxation"

* component[mindfulnessType].code = $SCT#711415009 "Mindfulness"
* component[mindfulnessType].valueCodeableConcept = $SCT#711415009 "Mindfulness"

* extension[mindfulness-context].extension[location].valueString = "Home meditation room"
* extension[mindfulness-context].extension[environment].valueCodeableConcept = #quiet "Quiet Space"
* extension[mindfulness-context].extension[guidance].valueBoolean = true

Instance: CompleteMindfulnessResponse
InstanceOf: QuestionnaireResponse
Usage: #example
Description: "Complete mindfulness questionnaire response example"
Title: "Complete Mindfulness Session Response"

* questionnaire = "https://2rdoc.pt/fhir/Questionnaire/daily-mindfulness"
* status = #completed
* subject = Reference(Patient/PatientExample)
* authored = "2024-03-19T08:30:00Z"

* item[0]
  * linkId = "mindful_session"
  * item[0]
    * linkId = "session_duration"
    * answer.valueInteger = 20
  * item[1]
    * linkId = "practice_type"
    * answer.valueString = "Meditation"

* item[1]
  * linkId = "mood_assessment"
  * item[0]
    * linkId = "current_mood"
    * answer.valueCoding = $SCT#130991005 "Neutral mood"
  * item[1]
    * linkId = "mood_intensity"
    * answer.valueInteger = 3

* item[2]
  * linkId = "stress_assessment"
  * item[0]
    * linkId = "stress_level"
    * answer.valueInteger = 3
  * item[1]
    * linkId = "stress_symptoms"
    * answer[0].valueString = "Slight tension"

* item[3]
  * linkId = "relaxation"
  * item[0]
    * linkId = "relaxation_duration"
    * answer.valueInteger = 15
  * item[1]
    * linkId = "relaxation_technique"
    * answer.valueString = "Deep breathing"



// ===== Conteúdo de: NutritionQuestionnaires.fsh =====

Instance: DailyNutritionQuestionnaire
InstanceOf: Questionnaire
Usage: #definition
Title: "Daily Nutrition Intake Questionnaire"
Description: "Questionnaire for daily nutrition intake tracking"

* url = "https://2rdoc.pt/ig/ios-lifestyle-medicine/Questionnaire/daily-nutrition"
* version = "0.1.0"
* name = "DailyNutritionQuestionnaire"
* title = "Daily Nutrition Intake"
* status = #active
* experimental = false
* date = "2024-12-14"
* publisher = "Ricardo Lourenço dos Santos"

* item[0]
  * linkId = "water_intake"
  * text = "How much water did you drink today?"
  * type = #quantity
  * required = true
  * repeats = false
  * initial.valueQuantity = 0 'mL'

* item[1]
  * linkId = "meal_record"
  * text = "Meal Records"
  * type = #group
  * repeats = true

  * item[0]
    * linkId = "meal_time"
    * text = "Meal Time"
    * type = #dateTime
    * required = true

  * item[1]
    * linkId = "meal_type"
    * text = "Meal Type"
    * type = #choice
    * required = true
    * answerOption[0].valueString = "Breakfast"
    * answerOption[1].valueString = "Lunch"
    * answerOption[2].valueString = "Dinner"
    * answerOption[3].valueString = "Snack"

  * item[2]
    * linkId = "calories"
    * text = "Estimated Calories"
    * type = #integer
    * required = true

  * item[3]
    * linkId = "macronutrients"
    * text = "Macronutrients"
    * type = #group

    * item[0]
      * linkId = "carbs"
      * text = "Carbohydrates (g)"
      * type = #decimal
      * required = true

    * item[1]
      * linkId = "protein"
      * text = "Proteins (g)"
      * type = #decimal
      * required = true

    * item[2]
      * linkId = "fat"
      * text = "Fats (g)"
      * type = #decimal
      * required = true

* item[2]
  * linkId = "caffeine"
  * text = "Caffeine Intake"
  * type = #group

  * item[0]
    * linkId = "caffeine_amount"
    * text = "Caffeine amount (mg)"
    * type = #integer
    * required = false

  * item[1]
    * linkId = "caffeine_source"
    * text = "Caffeine source"
    * type = #choice
    * repeats = true
    * answerOption[0].valueString = "Coffee"
    * answerOption[1].valueString = "Tea"
    * answerOption[2].valueString = "Soft Drink"
    * answerOption[3].valueString = "Energy Drink"



// ===== Conteúdo de: MindfulnessAudit.fsh =====

Extension: AuditLevelExtension
Id: audit-level
Title: "Audit Level Extension"
Description: "Level of detail for audit records"
* value[x] only code
* valueCode from https://2rdoc.pt/fhir/ValueSet/audit-levels (required)

Extension: AuditRetentionExtension
Id: audit-retention
Title: "Audit Retention Extension" 
Description: "Period to retain audit records"
* value[x] only Duration

Extension: AuditFormatExtension
Id: audit-format
Title: "Audit Format Extension"
Description: "Format for audit records"
* value[x] only code
* valueCode from https://2rdoc.pt/fhir/ValueSet/audit-formats (required)

Profile: MindfulnessAudit
Parent: Basic
Id: mindfulness-audit
Title: "Mindfulness Audit"
Description: "Audit record for mindfulness sessions"

* code 1..1 MS
* code = https://2rdoc.pt/fhir/CodeSystem/mindfulness-audit-type#session "Session Audit"
* created 1..1 MS

* extension contains
    audit-level named auditLevel 1..1 MS and
    audit-retention named auditRetention 1..1 MS and
    audit-format named auditFormat 1..1 MS

Instance: MindfulnessAuditExample
InstanceOf: MindfulnessAudit
Title: "Example Mindfulness Audit"
Description: "Example of a mindfulness session audit record"

* code = https://2rdoc.pt/fhir/CodeSystem/mindfulness-audit-type#session "Session Audit"
* created = "2024-03-15"
* extension[auditLevel].valueCode = #detailed
* extension[auditRetention].valueDuration = 90 'days'
* extension[auditFormat].valueCode = #fhir



// ===== Conteúdo de: MindfulnessExamples.fsh =====

Instance: MindfulnessObservationExample
InstanceOf: MindfulnessObservation
Usage: #example
Description: "Mindfulness observation example"
Title: "Example of Mindfulness Session Observation"

* status = #final
* code = $SCT#711415009 "Mindfulness"
* subject = Reference(Patient/PatientExample)
* effectiveDateTime = "2024-03-19T09:30:00Z"
* performer = Reference(Practitioner/PractitionerExample)

* component[sessionDuration].code = $SCT#118682006 "Duration"
* component[sessionDuration].valueQuantity = 20 'min'

* component[stressLevel].code = $SCT#725854004 "Assessment of stress level"
* component[stressLevel].valueInteger = 4

* component[moodState].code = $SCT#373931001 "Mood finding"
* component[moodState].valueCodeableConcept = $SCT#130991005 "Neutral mood"

* component[relaxationResponse].code = $SCT#276241001 "Relaxation technique"
* component[relaxationResponse].valueString = "Deep breathing exercises helped reduce tension"

* component[mindfulnessType].code = $SCT#711415009 "Mindfulness"
* component[mindfulnessType].valueCodeableConcept = $SCT#711415009 "Mindfulness"

// New example for MindfulnessQuestionnaire
Instance: MindfulnessQuestionnaireExample
InstanceOf: Questionnaire
Usage: #example
Title: "Example of Mindfulness Questionnaire"

* url = "https://2rdoc.pt/ig/ios-lifestyle-medicine/Questionnaire/mindfulness-example"
* status = #active
* title = "Daily Mindfulness Assessment"
* version = "1.0"
* name = "MindfulnessQuestionnaireExample"
* date = "2024-03-19"
* description = "Example questionnaire for daily mindfulness practice assessment"

* item[0]
  * linkId = "session_details"
  * text = "Session Details"
  * type = #group
  
  * item[0]
    * linkId = "duration"
    * text = "Duration (minutes)"
    * type = #integer
    * required = true
    
  * item[1]
    * linkId = "technique"
    * text = "Technique Used"
    * type = #choice
    * required = true
    * answerOption[0].valueString = "Mindful Breathing"
    * answerOption[1].valueString = "Body Scan"
    * answerOption[2].valueString = "Walking Meditation"



// ===== Conteúdo de: SocialInteractionInvariants.fsh =====

Invariant: social-interaction-duration
Description: "Social interaction duration must be positive"
Expression: "component.where(code.coding.code='89597-9').value.exists() implies component.where(code.coding.code='89597-9').value > 0"
Severity: #error

Invariant: social-interaction-participants
Description: "Number of participants must be at least 2 for social interaction"
Expression: "component.where(code.coding.code='89600-1').value.exists() implies component.where(code.coding.code='89600-1').value >= 2"
Severity: #error



// ===== Conteúdo de: MindfulnessInvariants.fsh =====

Invariant: mindfulness-session-duration
Description: "Mindfulness session duration must be between 1 and 180 minutes"
Expression: "component.where(code.coding.system='http://snomed.info/sct' and code.coding.code='118682006').value.ofType(Quantity).value.exists() implies (component.where(code.coding.system='http://snomed.info/sct' and code.coding.code='118682006').value.ofType(Quantity).value >= 1 and component.where(code.coding.system='http://snomed.info/sct' and code.coding.code='118682006').value.ofType(Quantity).value <= 180)"
Severity: #error

Invariant: mindfulness-stress-level
Description: "Stress level must be between 0 and 10"
Expression: "component.where(code.coding.system='http://snomed.info/sct' and code.coding.code='725854004').value.ofType(Integer).exists() implies (component.where(code.coding.system='http://snomed.info/sct' and code.coding.code='725854004').value.ofType(Integer) >= 0 and component.where(code.coding.system='http://snomed.info/sct' and code.coding.code='725854004').value.ofType(Integer) <= 10)"
Severity: #error

Invariant: mindfulness-mood-required
Description: "Mood assessment must include a mood state and intensity"
Expression: "component.where(code.coding.system='http://snomed.info/sct' and code.coding.code='373931001').exists() implies component.where(code.coding.system='http://snomed.info/sct' and code.coding.code='373931001').value.exists()"
Severity: #warning

Invariant: mindfulness-context-complete
Description: "Mindfulness context should include location and environment"
Expression: "extension.where(url='https://2rdoc.pt/ig/ios-lifestyle-medicine/StructureDefinition/mindfulness-context').exists() implies (extension.where(url='https://2rdoc.pt/ig/ios-lifestyle-medicine/StructureDefinition/mindfulness-context').extension.where(url='location').exists() and extension.where(url='https://2rdoc.pt/ig/ios-lifestyle-medicine/StructureDefinition/mindfulness-context').extension.where(url='environment').exists())"
Severity: #warning

Invariant: sequential-measurements
Description: "Sequential measurements must have increasing effectiveDateTime"
Expression: "component.where(code.coding.system='http://snomed.info/sct' and code.coding.code='118682006').exists() implies (effectiveDateTime > previous().effectiveDateTime)"
Severity: #warning



// ===== Conteúdo de: MindfulnessOperations.fsh =====

Profile: MindfulnessOperation
Parent: OperationDefinition 
Id: mindfulness-operation
Title: "Mindfulness Operation"
Description: "Base definition for mindfulness operations"

* status 1..1
* kind 1..1
* name 1..1
* code 1..1
* resource 1..1
* system 1..1
* type 1..1
* instance 1..1
* parameter 0..*
* parameter.name 1..1

Instance: StartSessionOperation
InstanceOf: MindfulnessOperation
Title: "Start Session Operation"
Description: "Operation to start a new mindfulness session"

* status = #active
* kind = #operation
* name = "start-session"
* code = #start
* resource = #Observation
* system = false
* type = true
* instance = false
* parameter[+]
  * name = #duration
  * use = #in
  * min = 1
  * max = "1" 
  * type = #integer
  * documentation = "Duration in minutes"

Instance: EndSessionOperation
InstanceOf: MindfulnessOperation
Title: "End Session Operation"
Description: "Operation to end an ongoing mindfulness session"

* status = #active
* kind = #operation
* name = "end-session"
* code = #end
* resource = #Observation
* system = false
* type = true
* instance = true
* parameter[+]
  * name = #session
  * use = #in
  * min = 1
  * max = "1"
  * type = #string
  * documentation = "ID of the session to end"



// ===== Conteúdo de: MultiJurisdictionalConsent.fsh =====

// ====== Perfil Multi-Jurisdicional de Consent ======

Profile: MultiJurisdictionalConsent
Parent: Consent
Id: multi-jurisdictional-consent
Title: "Multi-Jurisdictional Healthcare Consent"
Description: "Consent profile supporting GDPR, HIPAA, and LGPD compliance"

* status MS
* scope MS
* category MS
* patient 1..1 MS
* dateTime 1..1 MS

// Múltiplas políticas para diferentes jurisdições
* policy 1..* MS
* policy ^slicing.discriminator.type = #value
* policy ^slicing.discriminator.path = "authority"
* policy ^slicing.rules = #open

* policy contains
    gdpr 0..1 MS and
    hipaa 0..1 MS and
    lgpd 0..1 MS

* policy[gdpr].authority = "https://eur-lex.europa.eu/eli/reg/2016/679/oj"
* policy[gdpr].uri 1..1 MS

* policy[hipaa].authority = "https://www.hhs.gov/hipaa/index.html"  
* policy[hipaa].uri 1..1 MS

* policy[lgpd].authority = "http://www.planalto.gov.br/ccivil_03/_ato2015-2018/2018/lei/L13709compilado.htm"
* policy[lgpd].uri 1..1 MS

// Extensões de compliance
* extension contains
    RegulatoryBasis named regulatoryBasis 0..* MS and
    JurisdictionApplicability named jurisdiction 0..* MS and
    DataLocalization named dataLocalization 0..* MS

// Provisions com segurança
* provision MS
* provision.type MS
* provision.period MS
* provision.actor MS
* provision.action MS
* provision.securityLabel MS
* provision.purpose MS
* provision.dataPeriod MS



// ===== Conteúdo de: ReproductiveExamples.fsh =====

Instance: ExampleReproductiveActivity
InstanceOf: CarePlan
Usage: #example
Description: "Reproductive health care plan example"
* status = #active
* intent = #plan
* subject = Reference(Patient/PatientExample)
* activity.detail.kind = #ServiceRequest
* activity.detail.code = ReproductiveActivityCS#cycle-tracking
* activity.detail.status = #scheduled



// ===== Conteúdo de: ComplianceExtensions.fsh =====

// ====== Extensões de Compliance Multi-Jurisdicional ======

Extension: RegulatoryBasis
Id: regulatory-basis
Title: "Regulatory Basis for Consent"
Description: "Identifies the regulatory framework(s) that govern this consent"
* value[x] only CodeableConcept
* valueCodeableConcept from RegulatoryFrameworkVS (extensible)

Extension: JurisdictionApplicability  
Id: jurisdiction-applicability
Title: "Jurisdiction Applicability"
Description: "Specifies which jurisdictions this consent applies to"
* value[x] only CodeableConcept
* valueCodeableConcept from http://hl7.org/fhir/ValueSet/jurisdiction (extensible)

Extension: DataLocalization
Id: data-localization
Title: "Data Localization Requirements"
Description: "Specifies data localization requirements per jurisdiction"
* extension contains
    jurisdiction 1..1 MS and
    storageLocation 1..1 MS and
    residencyRequired 1..1 MS
* extension[jurisdiction].value[x] only CodeableConcept
* extension[storageLocation].value[x] only string
* extension[residencyRequired].value[x] only boolean

// ====== ValueSets de Compliance ======

ValueSet: RegulatoryFrameworkVS
Id: regulatory-framework-vs
Title: "Regulatory Framework Value Set"
Description: "Regulatory frameworks for healthcare data protection"
* ^experimental = false
* include codes from system RegulatoryFrameworkCS

CodeSystem: RegulatoryFrameworkCS
Id: regulatory-framework-cs
Title: "Regulatory Framework Code System"
Description: "Codes for healthcare regulatory frameworks"
* ^experimental = false
* ^caseSensitive = true
* #gdpr "GDPR - General Data Protection Regulation" "European Union data protection regulation"
* #hipaa "HIPAA - Health Insurance Portability and Accountability Act" "United States healthcare privacy law"
* #lgpd "LGPD - Lei Geral de Proteção de Dados" "Brazilian general data protection law"
* #pipeda "PIPEDA - Personal Information Protection and Electronic Documents Act" "Canadian privacy law"
* #ehds "EHDS - European Health Data Space" "European health data framework"



// ===== Conteúdo de: BalanceStatusValueSet.fsh =====

ValueSet: BalanceStatusValueSet
Id: balance-status
Title: "Balance Status Value Set"
Description: "Value set for walking steadiness balance status"
* ^url = "https://2rdoc.pt/fhir/ValueSet/balance-status"
* ^status = #active
* include codes from system https://2rdoc.pt/fhir/CodeSystem/balance-status

CodeSystem: BalanceStatusCodeSystem
Id: balance-status
Title: "Balance Status Code System"
Description: "Code system for balance status types"
* ^url = "https://2rdoc.pt/fhir/CodeSystem/balance-status"
* ^status = #active
* ^experimental = false
* ^caseSensitive = true
* #veryStable "Very Stable"
* #stable "Stable"
* #slightlyUnstable "Slightly Unstable"
* #unstable "Unstable"
* #veryUnstable "Very Unstable"



// ===== Conteúdo de: SleepQualityVS.fsh =====

ValueSet: SleepQualityVS
Id: sleep-quality-vs
Title: "Sleep Quality Value Set"
Description: "Qualitative assessments of sleep quality including subjective measures"
* ^status = #active
* ^experimental = false
* $SCT#248254009 "Quality of sleep (observable entity)"
* $SCT#248255005 "Sleeping well"
* $SCT#248256006 "Difficulty sleeping"
* $SCT#301345002 "Poor sleep pattern"
* $SCT#301346001 "Good sleep pattern"




// ===== Conteúdo de: FertilityValueSets.fsh =====

ValueSet: CervicalMucusValueSet
Id: cervical-mucus-valueset
Title: "Cervical Mucus Value Set"
* ^experimental = falseDescription: "Value set for cervical mucus observations"
* ^url = "https://2rdoc.pt/fhir/ValueSet/cervical-mucus-vs"
* ^status = #active
* include codes from system https://2rdoc.pt/fhir/CodeSystem/cervical-mucus-cs

CodeSystem: CervicalMucusCodeSystem
Id: cervical-mucus-cs
Description: "Code system for cervical mucus classification"Title: "Cervical Mucus Code System"
* ^url = "https://2rdoc.pt/fhir/CodeSystem/cervical-mucus-cs"
* ^status = #active
* ^caseSensitive = true
* #dry "Dry"
* #sticky "Sticky"
* #creamy "Creamy"
* #watery "Watery"
* #eggWhite "Egg White"

ValueSet: OvulationTestValueSet
Id: ovulation-test-valueset
Title: "Ovulation Test Value Set"
* ^experimental = falseDescription: "Value set for ovulation test results"
* ^url = "https://2rdoc.pt/fhir/ValueSet/ovulation-test-vs"
* ^status = #active
* include codes from system https://2rdoc.pt/fhir/CodeSystem/ovulation-test-cs

CodeSystem: OvulationTestCodeSystem
Id: ovulation-test-cs
Description: "Code system for ovulation test results"Title: "Ovulation Test Code System"
* ^url = "https://2rdoc.pt/fhir/CodeSystem/ovulation-test-cs"
* ^status = #active
* ^caseSensitive = true
* #negative "Negative"
* #positive "Positive"
* #invalid "Invalid Test"

ValueSet: FertilityStatusValueSet
Id: fertility-status-valueset
Title: "Fertility Status Value Set"
* ^experimental = falseDescription: "Value set for fertility status"
* ^url = "https://2rdoc.pt/fhir/ValueSet/fertility-status-vs"
* ^status = #active
* include codes from system https://2rdoc.pt/fhir/CodeSystem/fertility-status-cs

CodeSystem: FertilityStatusCodeSystem
Id: fertility-status-cs
Description: "Code system for fertility status indicators"Title: "Fertility Status Code System"
* ^url = "https://2rdoc.pt/fhir/CodeSystem/fertility-status-cs"
* ^status = #active
* ^caseSensitive = true
* #fertile "Fertile"
* #notFertile "Not Fertile"
* #uncertain "Uncertain"



// ===== Conteúdo de: ReproductiveQuestionnaire.fsh =====

Instance: ReproductiveHealthQuestionnaire
InstanceOf: Questionnaire
Usage: #definition
Title: "Reproductive Health Tracking Questionnaire"
Description: "Daily questionnaire for reproductive health tracking"
 
* status = #active
* url = "https://2rdoc.pt/ig/ios-lifestyle-medicine/Questionnaire/reproductive-health"
* name = "ReproductiveHealthQuestionnaire"
* title = "Reproductive Health Monitoring"
* date = "2024-03-19"
 
* item[0]
  * linkId = "menstrual_cycle"
  * text = "Menstrual Cycle"
  * type = #group
 
  * item[0]
    * linkId = "cycle_start"
    * text = "Cycle started today?"
    * type = #boolean
 
  * item[1]
    * linkId = "flow_intensity"
    * text = "Flow intensity"
    * type = #choice
    * enableWhen
      * question = "cycle_start"
      * operator = #=
      * answerBoolean = true
    * answerOption[0].valueString = "Light"
    * answerOption[1].valueString = "Moderate"
    * answerOption[2].valueString = "Heavy"
 
* item[1]
  * linkId = "symptoms"
  * text = "Symptoms"
  * type = #group
  * repeats = true
 
  * item[0]
    * linkId = "symptom_type"
    * text = "Symptom type"
    * type = #choice
    * answerValueSet = "https://2rdoc.pt/fhir/ValueSet/reproductive-symptoms"
 
  * item[1]
    * linkId = "symptom_severity"
    * text = "Intensity (0-10)"
    * type = #integer
    * extension[0]
      * url = "http://hl7.org/fhir/StructureDefinition/minValue"
      * valueInteger = 0
    * extension[1]
      * url = "http://hl7.org/fhir/StructureDefinition/maxValue"
      * valueInteger = 10
 
* item[2]
  * linkId = "mood_changes"
  * text = "Mood Changes"
  * type = #group

  * item[0]
    * linkId = "mood_type"
    * text = "Current mood"
    * type = #choice
    * answerValueSet = "https://2rdoc.pt/fhir/ValueSet/mood-types"

  * item[1]
    * linkId = "mood_severity"
    * text = "Intensity (0-10)"
    * type = #integer
    * extension[0]
      * url = "http://hl7.org/fhir/StructureDefinition/minValue"
      * valueInteger = 0
    * extension[1]
      * url = "http://hl7.org/fhir/StructureDefinition/maxValue"
      * valueInteger = 10



// ===== Conteúdo de: MindfulnessCapabilities.fsh =====

Instance: MindfulnessCapabilityStatement
InstanceOf: CapabilityStatement
Usage: #definition
Title: "Mindfulness Module Capabilities"
Description: "Capabilities supported by the mindfulness module implementation"

* status = #draft
* date = "2024-03-19"
* kind = #requirements
* fhirVersion = #4.0.1
* format[0] = #json
* format[1] = #xml

* rest[0]
  * mode = #server
  * documentation = "RESTful server capabilities for mindfulness data"
  
  * resource[0]
    * type = #Observation
    * documentation = "Supports mindfulness session observations"
    * profile = "https://2rdoc.pt/ig/ios-lifestyle-medicine/StructureDefinition/mindfulness-observation"
    * interaction[0]
      * code = #read
    * interaction[1]
      * code = #create
    * interaction[2]
      * code = #update
    * interaction[3]
      * code = #search-type
    * searchParam[0]
      * name = "patient"
      * type = #reference
      * documentation = "Search by patient reference"
    * searchParam[1]
      * name = "date"
      * type = #date
      * documentation = "Search by session date"
    * searchParam[2]
      * name = "code"
      * type = #token
      * documentation = "Search by observation type"
      
  * resource[1]
    * type = #Questionnaire
    * documentation = "Supports mindfulness questionnaires"
    * profile = "https://2rdoc.pt/ig/ios-lifestyle-medicine/StructureDefinition/mindfulness-questionnaire"
    * interaction[0]
      * code = #read
    * interaction[1]
      * code = #search-type
    * searchParam[0]
      * name = "title"
      * type = #string
      * documentation = "Search by questionnaire title"
      
  * resource[2]
    * type = #QuestionnaireResponse
    * documentation = "Supports mindfulness questionnaire responses"
    * profile = "https://2rdoc.pt/ig/ios-lifestyle-medicine/StructureDefinition/mindfulness-questionnaire-response"
    * interaction[0]
      * code = #create
    * interaction[1]
      * code = #read
    * interaction[2]
      * code = #search-type
    * searchParam[0]
      * name = "patient"
      * type = #reference
      * documentation = "Search by patient reference"
    * searchParam[1]
      * name = "authored"
      * type = #date
      * documentation = "Search by response date"



// ===== Conteúdo de: MobilityExtensions.fsh =====

Extension: MobilityAlertLevel
Id: mobility-alert-level
Title: "Mobility Alert Level Extension"
Description: "Extension for mobility measurements alert levels to indicate the severity or concern level of mobility changes detected by the device"
* ^status = #active
* ^context[0].type = #element
* ^context[0].expression = "Observation"
* . ^short = "Mobility alert level indicator"
* . ^definition = "Indicates the severity level of mobility changes or concerns based on device measurements"
* value[x] only CodeableConcept
* valueCodeableConcept from MobilityAlertLevelVS (required)
* valueCodeableConcept ^short = "Alert level code"
* valueCodeableConcept ^definition = "The specific alert level code indicating the severity of mobility changes"

ValueSet: MobilityAlertLevelVS
Id: mobility-alert-level-vs
Title: "Mobility Alert Level Value Set"
Description: "Value set for mobility measurement alert levels used to categorize the severity of mobility changes or concerns"
* ^status = #active
* ^experimental = false
* ^purpose = "To provide standardized alert levels for mobility measurements"
* codes from system MobilityAlertLevelCS

CodeSystem: MobilityAlertLevelCS
Id: mobility-alert-level-cs
Title: "Mobility Alert Level Code System"
Description: "Code system defining alert levels for mobility measurements, indicating the severity of changes in mobility patterns"
* ^status = #active
* ^experimental = false
* ^caseSensitive = true
* ^content = #complete
* #green "Normal - No concern" "Mobility measurements are within normal range and show no concerning patterns"
* #yellow "Caution - Monitor closely" "Mobility measurements show slight deviations that warrant closer monitoring"
* #red "Alert - Significant change" "Mobility measurements indicate significant changes that require immediate attention"
* ^property[0].code = #status
* ^property[0].type = #code
* ^property[0].description = "The status of the alert level"
* ^property[1].code = #severity
* ^property[1].type = #integer
* ^property[1].description = "Numeric value indicating severity (1=low, 3=high)"



// ===== Conteúdo de: MissingResources.fsh =====

// ====== Recursos Faltantes para Resolver Links Quebrados ======

Instance: example
InstanceOf: Patient
Usage: #example
* identifier.system = "http://example.org/patients"
* identifier.value = "example-patient"
* name.family = "Example"
* name.given = "Patient"
* gender = #unknown
* birthDate = "1970-01-01"

Instance: osa-practitioner-kyle-anydoc
InstanceOf: Practitioner
Usage: #example
* identifier.system = "http://example.org/practitioners"
* identifier.value = "kyle-anydoc"
* name.family = "Anydoc"
* name.given = "Kyle"
* name.prefix = "Dr."

Instance: PatientMindfulness
InstanceOf: Patient
Usage: #example
* identifier.system = "http://example.org/patients"
* identifier.value = "mindfulness-patient"
* name.family = "Mindfulness"
* name.given = "Test"
* gender = #other
* birthDate = "1980-01-01"

Instance: Org2RDoc
InstanceOf: Organization
Usage: #example
* identifier.system = "http://example.org/organizations"
* identifier.value = "2rdoc"
* name = "2RDoc Healthcare Solutions"
* active = true



// ===== Conteúdo de: MindfulnessResources.fsh =====

CodeSystem: MindfulnessTypeCS
Id: mindfulness-type-cs
Title: "Mindfulness Practice Types"
Description: "Types of mindfulness practices and techniques"
* ^experimental = false
* ^caseSensitive = true
* #meditation "Meditation" "Focused meditation practice"
* #breathing "Breathing Exercise" "Conscious breathing techniques"
* #bodyScan "Body Scan" "Progressive body awareness practice"
* #walking "Mindful Walking" "Walking meditation practice"
* #movement "Mindful Movement" "Conscious movement practice"

CodeSystem: EnvironmentTypeCS
Id: environment-type-cs
Title: "Practice Environment Types"
Description: "Types of environments for mindfulness practice"
* ^experimental = false
* ^caseSensitive = true
* #indoor "Indoor" "Indoor environment"
* #outdoor "Outdoor" "Outdoor environment"
* #quiet "Quiet Space" "Quiet or silent environment"
* #group "Group Setting" "Group practice environment"

ValueSet: MindfulnessTypeVS
Id: mindfulness-type-vs
Title: "Mindfulness Practice Types Value Set"
Description: "Value set of mindfulness practice types"
* ^experimental = false
* include codes from system MindfulnessTypeCS

ValueSet: EnvironmentTypeVS
Id: environment-type-vs
Title: "Practice Environment Types Value Set"
Description: "Value set of practice environment types"
* ^experimental = false
* include codes from system EnvironmentTypeCS

Instance: MindfulnessSettingCS
InstanceOf: CodeSystem
Usage: #definition
* url = "https://2rdoc.pt/ig/ios-lifestyle-medicine/CodeSystem/mindfulness-setting"
* version = "1.0.0"
* name = "MindfulnessSettingCS"
* title = "Mindfulness Setting CodeSystem"
* status = #active
* experimental = false
* caseSensitive = true
* content = #complete
* count = 5
* concept[+].code = #home
* concept[=].display = "Home Practice"
* concept[+].code = #clinic
* concept[=].display = "Clinical Setting"
* concept[+].code = #group
* concept[=].display = "Group Setting"
* concept[+].code = #retreat
* concept[=].display = "Retreat Setting"
* concept[+].code = #workplace
* concept[=].display = "Workplace Setting"



// ===== Conteúdo de: ActivityExtensions.fsh =====




// ===== Conteúdo de: SymptomValueSets.fsh =====

CodeSystem: SymptomSeverityCS
Id: symptom-severity-cs
Title: "Symptom Severity Code System"
Description: "Severity levels for symptoms"
* ^experimental = false

* #1-3 "Light" "Symptom barely noticeable"
* #4-6 "Mild" "Symptom noticeable but not interfering with daily activities"
* #7-8 "Intense" "Symptom interfering with daily activities"
* #9-10 "Severe" "Symptom preventing daily activities"

ValueSet: BodyLocationsVS
Id: body-locations-vs
Title: "Body Locations Value Set"
Description: "Anatomical locations for symptom recording"
* ^experimental = false
* $SCT#12738006 "Brain"
* $SCT#69536005 "Head"
* $SCT#45048000 "Neck"
* $SCT#51185008 "Chest"
* $SCT#62413002 "Abdomen"
* $SCT#32849002 "Back"
* $SCT#53120007 "Upper limb"
* $SCT#61685007 "Lower limb"

ValueSet: DurationUnitsVS
Id: duration-units-vs
Title: "Duration Units Value Set"
Description: "Time units for symptom duration"
* ^experimental = false
* $UCUM#min "Minutes"
* $UCUM#h "Hours"
* $UCUM#d "Days"
* $UCUM#wk "Weeks"
* $UCUM#mo "Months"

CodeSystem: SymptomFrequencyCS
Id: symptom-frequency-cs
Title: "Symptom Frequency Code System"
Description: "Frequency patterns for symptoms"
* ^experimental = false
* #rare "Rare" "Less than once per month"
* #occasional "Occasional" "Several times per month"
* #frequent "Frequent" "Several times per week"
* #daily "Daily" "Once or more per day"
* #constant "Constant" "Present most of the time"

ValueSet: SymptomFrequencyVS
Id: symptom-frequency-vs
Title: "Symptom Frequency Value Set"
Description: "Frequency patterns for symptoms"
* ^experimental = false
* codes from system SymptomFrequencyCS

CodeSystem: SymptomImpactCS
Id: symptom-impact-cs
Title: "Symptom Impact Code System"
Description: "Impact levels of symptoms on daily activities"
* ^experimental = false
* #none "No impact"
* #mild "Mild impact"
* #moderate "Moderate impact"
* #severe "Severe impact"
* #complete "Complete impact"

ValueSet: SymptomImpactVS
Id: symptom-impact-vs
Title: "Symptom Impact Value Set"
Description: "Impact levels for symptoms"
* ^experimental = false
* codes from system SymptomImpactCS

ValueSet: SymptomProgressionVS
Id: symptom-progression-vs
Title: "Symptom Progression Value Set"
Description: "Progression patterns for symptoms"
* ^experimental = false
* $SCT#385633008 "Improving"
* $SCT#58158008 "Stable"
* $SCT#230993007 "Worsening"
* $SCT#255314001 "Fluctuating"

ValueSet: TimeOfDayVS
Id: time-of-day-vs
Title: "Time of Day Value Set"
Description: "Times of day for symptom occurrence"
* ^experimental = false
* $SCT#73775008 "Morning"
* $SCT#255214003 "After exercise"
* $SCT#2546009 "Evening"
* $SCT#73775008 "Morning"



// ===== Conteúdo de: SocialInteractionValueSets.fsh =====

ValueSet: SocialInteractionTypeVS
Id: social-interaction-type-vs
Title: "Social Interaction Type Value Set"
Description: "Types of social interactions"
* ^experimental = false
* codes from system SocialInteractionTypeCS

ValueSet: SocialInteractionQualityVS
Id: social-interaction-quality-vs
Title: "Social Interaction Quality Value Set"
Description: "Quality measures for social interactions"
* ^experimental = false
* codes from system SocialInteractionQualityCS

ValueSet: SocialInteractionMediumVS
Id: social-interaction-medium-vs
Title: "Social Interaction Medium Value Set"
Description: "Mediums through which social interaction occurs"
* ^experimental = false
* codes from system SocialInteractionMediumCS

CodeSystem: SocialInteractionTypeCS
Id: social-interaction-type-cs
Title: "Social Interaction Type Code System"
Description: "Types of social interactions"
* ^experimental = false
* #family "Family Interaction" "Interaction with family members"
* #friends "Friend Interaction" "Interaction with friends"
* #professional "Professional Interaction" "Work-related interactions"
* #community "Community Interaction" "Community-based interactions"
* #group "Group Activity" "Organized group activities"
* #casual "Casual Interaction" "Casual social encounters"

CodeSystem: SocialInteractionQualityCS
Id: social-interaction-quality-cs
Title: "Social Interaction Quality Code System"
Description: "Quality measures for social interactions"
* ^experimental = false
* #meaningful "Meaningful" "Deep, meaningful interaction"
* #meaningful "Meaningful" "Deep and significant interaction"
* #supportive "Supportive" "Supportive interaction"
* #meaningful "Meaningful" "Deep and significant interaction"
* #neutral "Neutral" "Neither positive nor negative"
* #meaningful "Meaningful" "Deep and significant interaction"
* #superficial "Superficial" "Surface-level interaction"
* #meaningful "Meaningful" "Deep and significant interaction"
* #stressful "Stressful" "Stressful or difficult interaction"
* #meaningful "Meaningful" "Deep and significant interaction"

CodeSystem: SocialInteractionMediumCS
Id: social-interaction-medium-cs
Title: "Social Interaction Medium Code System"
Description: "Mediums through which social interaction occurs"
* ^experimental = false
* #inPerson "In Person" "Face-to-face interaction"
* #meaningful "Meaningful" "Deep and significant interaction"
* #video "Video Call" "Video-based interaction"
* #meaningful "Meaningful" "Deep and significant interaction"
* #voice "Voice Call" "Voice-only interaction"
* #meaningful "Meaningful" "Deep and significant interaction"
* #text "Text Based" "Text-based communication"
* #meaningful "Meaningful" "Deep and significant interaction"
* #social "Social Media" "Social media interaction"
* #meaningful "Meaningful" "Deep and significant interaction"
* #mixed "Mixed Medium" "Multiple communication methods"
* #meaningful "Meaningful" "Deep and significant interaction"



// ===== Conteúdo de: MindfulnessSearchParameters.fsh =====

Instance: MindfulnessType
InstanceOf: SearchParameter
Description: "Example instance of MindfulnessType"Usage: #definition
* status = #active
* code = #mindfulness-type
* name = "MindfulnessType"
* description = "Search for mindfulness observations by practice type"
* base = #Observation
* type = #token
* expression = "Observation.component.where(code.coding.where(system='http://snomed.info/sct' and code='711415009')).value.as(CodeableConcept)"
* xpath = "f:Observation/f:component[f:code/f:coding[f:system/@value='http://snomed.info/sct' and f:code/f:coding/f:code/@value='711415009']]/f:valueCodeableConcept"
* xpathUsage = #normal


