{
  "resourceType" : "ConceptMap",
  "id" : "ConceptMapFHIRToOpenEHR",
  "text" : {
    "status" : "generated",
    "div" : "<div xmlns=\"http://www.w3.org/1999/xhtml\"><p class=\"res-header-id\"><b>Narrativa gerada: ConceptMap ConceptMapFHIRToOpenEHR</b></p><a name=\"ConceptMapFHIRToOpenEHR\"> </a><a name=\"hcConceptMapFHIRToOpenEHR\"> </a><p>Mapeamento de (não especificado) para (não especificado)</p><br/><p><b>Grupo 1 </b>Mapeamento de <a href=\"http://hl7.org/fhir/R4/observation.html\">Observation</a> to <code>openEHR-EHR-OBSERVATION.heart_rate_variability.v0</code></p><table class=\"grid\"><tr><td><b>Código fonte</b></td><td><b>Relacionamento</b></td><td><b>Código de destino</b></td><td><b>Comentário</b></td></tr><tr><td>Observation.component:sdnn (SDNN component with LOINC 80404-7)</td><td><a href=\"http://hl7.org/fhir/R5/codesystem-concept-map-relationship.html#equivalent\" title=\"equivalent\">is equivalent to</a></td><td>id5 (SDNN - Standard deviation of NN intervals)</td><td>Map from Observation.component with code LOINC 80404-7. Unit: ms</td></tr><tr><td>Observation.component:rmssd (RMSSD component with HeartRateVariabilityCS#hrv-rmssd)</td><td><a href=\"http://hl7.org/fhir/R5/codesystem-concept-map-relationship.html#equivalent\" title=\"equivalent\">is equivalent to</a></td><td>id6 (RMSSD - Root mean square of successive differences)</td><td>Map from component with HeartRateVariabilityCS#hrv-rmssd. No LOINC code. Unit: ms</td></tr><tr><td>Observation.component:pnn50 (pNN50 component with HeartRateVariabilityCS#hrv-pnn50)</td><td><a href=\"http://hl7.org/fhir/R5/codesystem-concept-map-relationship.html#equivalent\" title=\"equivalent\">is equivalent to</a></td><td>id7 (pNN50 - Percentage of NN intervals &gt;50ms)</td><td>Map from component with HeartRateVariabilityCS#hrv-pnn50. Unit: %</td></tr><tr><td>Observation.component:lf-hf-ratio (LF/HF ratio component)</td><td><a href=\"http://hl7.org/fhir/R5/codesystem-concept-map-relationship.html#equivalent\" title=\"equivalent\">is equivalent to</a></td><td>id13 (LF/HF Ratio)</td><td>Map from component with HeartRateVariabilityCS#hrv-lf-hf-ratio. Dimensionless ratio</td></tr><tr><td>Observation.effectivePeriod (Observation.effectivePeriod (start/end))</td><td><a href=\"http://hl7.org/fhir/R5/codesystem-concept-map-relationship.html#relatedto\" title=\"relatedto\">is related to</a></td><td>id32 (Recording duration)</td><td>Calculate duration from effectivePeriod.end - effectivePeriod.start</td></tr><tr><td>Observation.component:state (Physiological state component)</td><td><a href=\"http://hl7.org/fhir/R5/codesystem-concept-map-relationship.html#equivalent\" title=\"equivalent\">is equivalent to</a></td><td>id41 (Physiological state)</td><td>Map resting/active/sleep states from component</td></tr><tr><td>Observation.device (Observation.device reference)</td><td><a href=\"http://hl7.org/fhir/R5/codesystem-concept-map-relationship.html#relatedto\" title=\"relatedto\">is related to</a></td><td>id51 (Device type)</td><td>Resolve Device reference and map to CLUSTER.wearable_device</td></tr></table><hr/><p><b>Grupo 2 </b>Mapeamento de <a href=\"http://hl7.org/fhir/R4/observation.html\">Observation</a> to <code>openEHR-EHR-OBSERVATION.physical_activity_detailed.v0</code></p><table class=\"grid\"><tr><td><b>Código fonte</b></td><td><b>Relacionamento</b></td><td><b>Código de destino</b></td><td><b>Comentário</b></td></tr><tr><td>Observation.valueQuantity (Observation.valueQuantity (steps))</td><td><a href=\"http://hl7.org/fhir/R5/codesystem-concept-map-relationship.html#equivalent\" title=\"equivalent\">is equivalent to</a></td><td>id10 (Step count)</td><td>When Observation.code is LOINC 55423-8 (Number of steps). Unit: steps</td></tr><tr><td>Observation.component:distance (Distance component with LOINC 55430-3)</td><td><a href=\"http://hl7.org/fhir/R5/codesystem-concept-map-relationship.html#equivalent\" title=\"equivalent\">is equivalent to</a></td><td>id11 (Distance)</td><td>Map from component with LOINC 55430-3. Unit: km or m</td></tr><tr><td>Observation.component:active-calories (Active calories component with LOINC 41979-6)</td><td><a href=\"http://hl7.org/fhir/R5/codesystem-concept-map-relationship.html#equivalent\" title=\"equivalent\">is equivalent to</a></td><td>id20 (Active calories)</td><td>Map from component with LOINC 41979-6. Unit: kcal</td></tr><tr><td>Observation.component:moderate-minutes (Moderate activity minutes with LOINC 77592-4)</td><td><a href=\"http://hl7.org/fhir/R5/codesystem-concept-map-relationship.html#equivalent\" title=\"equivalent\">is equivalent to</a></td><td>id32 (Moderately active minutes)</td><td>Map from component with LOINC 77592-4. Unit: min</td></tr><tr><td>Observation.component:vigorous-minutes (Vigorous activity minutes with LOINC 77593-2)</td><td><a href=\"http://hl7.org/fhir/R5/codesystem-concept-map-relationship.html#equivalent\" title=\"equivalent\">is equivalent to</a></td><td>id33 (Vigorously active minutes)</td><td>Map from component with LOINC 77593-2. Unit: min</td></tr></table><hr/><p><b>Grupo 3 </b>Mapeamento de <a href=\"http://hl7.org/fhir/R4/observation.html\">Observation</a> to <code>openEHR-EHR-OBSERVATION.sleep_architecture.v0</code></p><table class=\"grid\"><tr><td><b>Código fonte</b></td><td><b>Relacionamento</b></td><td><b>Código de destino</b></td><td><b>Comentário</b></td></tr><tr><td>Observation.valueQuantity (Observation.valueQuantity (sleep duration))</td><td><a href=\"http://hl7.org/fhir/R5/codesystem-concept-map-relationship.html#equivalent\" title=\"equivalent\">is equivalent to</a></td><td>id13 (Total sleep time)</td><td>When Observation.code is LOINC 93832-4 (Sleep duration). Unit: h or min</td></tr><tr><td>Observation.component:deep-sleep (Deep sleep duration component)</td><td><a href=\"http://hl7.org/fhir/R5/codesystem-concept-map-relationship.html#equivalent\" title=\"equivalent\">is equivalent to</a></td><td>id23 (Deep sleep duration)</td><td>N3/SWS stage duration. Custom code - no LOINC</td></tr><tr><td>Observation.component:rem-sleep (REM sleep duration component)</td><td><a href=\"http://hl7.org/fhir/R5/codesystem-concept-map-relationship.html#equivalent\" title=\"equivalent\">is equivalent to</a></td><td>id24 (REM sleep duration)</td><td>REM stage duration. Custom code - no LOINC</td></tr><tr><td>Observation.component:efficiency (Sleep efficiency component)</td><td><a href=\"http://hl7.org/fhir/R5/codesystem-concept-map-relationship.html#equivalent\" title=\"equivalent\">is equivalent to</a></td><td>id30 (Sleep efficiency)</td><td>TST/TIB ratio as percentage. Custom code - no LOINC</td></tr><tr><td>Observation.component:score (Sleep score component)</td><td><a href=\"http://hl7.org/fhir/R5/codesystem-concept-map-relationship.html#equivalent\" title=\"equivalent\">is equivalent to</a></td><td>id40 (Sleep score)</td><td>Vendor-specific composite score (0-100). Proprietary algorithm</td></tr><tr><td>Observation.component:sleep-hrv (Average HRV during sleep component)</td><td><a href=\"http://hl7.org/fhir/R5/codesystem-concept-map-relationship.html#equivalent\" title=\"equivalent\">is equivalent to</a></td><td>id53 (Average HRV (RMSSD) during sleep)</td><td>Use HeartRateVariabilityCS#hrv-rmssd with context. Unit: ms</td></tr></table><hr/><p><b>Grupo 4 </b>Mapeamento de <a href=\"http://hl7.org/fhir/R4/device.html\">Device</a> to <code>openEHR-EHR-CLUSTER.wearable_device.v0</code></p><table class=\"grid\"><tr><td><b>Código fonte</b></td><td><b>Relacionamento</b></td><td><b>Código de destino</b></td><td><b>Comentário</b></td></tr><tr><td>Device.manufacturer</td><td><a href=\"http://hl7.org/fhir/R5/codesystem-concept-map-relationship.html#equivalent\" title=\"equivalent\">is equivalent to</a></td><td>id2 (Device platform)</td><td>Map manufacturer string to vendor code (Apple, Fitbit, Garmin, etc.)</td></tr><tr><td>Device.modelNumber</td><td><a href=\"http://hl7.org/fhir/R5/codesystem-concept-map-relationship.html#equivalent\" title=\"equivalent\">is equivalent to</a></td><td>id3 (Device model)</td><td>Specific model name</td></tr><tr><td>Device.type</td><td><a href=\"http://hl7.org/fhir/R5/codesystem-concept-map-relationship.html#equivalent\" title=\"equivalent\">is equivalent to</a></td><td>id4 (Device category)</td><td>Map from SNOMED CT device type codes where available</td></tr><tr><td>Device.serialNumber</td><td><a href=\"http://hl7.org/fhir/R5/codesystem-concept-map-relationship.html#equivalent\" title=\"equivalent\">is equivalent to</a></td><td>id23 (Serial number)</td><td/></tr><tr><td>Device.version:firmware (Device.version[firmware])</td><td><a href=\"http://hl7.org/fhir/R5/codesystem-concept-map-relationship.html#equivalent\" title=\"equivalent\">is equivalent to</a></td><td>id20 (Firmware version)</td><td>Filter by version.type = firmware</td></tr></table></div>"
  },
  "url" : "https://2rdoc.pt/ig/ios-lifestyle-medicine/ConceptMap/ConceptMapFHIRToOpenEHR",
  "version" : "0.1.0",
  "name" : "ConceptMapFHIRToOpenEHR",
  "title" : "FHIR Resource to openEHR Archetype Mapping",
  "status" : "active",
  "experimental" : false,
  "date" : "2025-11-25",
  "publisher" : "Ricardo Lourenço dos Santos",
  "contact" : [{
    "name" : "Ricardo Lourenço dos Santos",
    "telecom" : [{
      "system" : "url",
      "value" : "https://linktr.ee/ricardolsantos"
    }]
  }],
  "description" : "Reverse mapping from FHIR R4 resources to custom openEHR archetypes for wearable lifestyle medicine data.\n\nSupported FHIR → openEHR mappings:\n- Observation (HRV profile) → OBSERVATION.heart_rate_variability.v0\n- Observation (activity profile) → OBSERVATION.physical_activity_detailed.v0\n- Observation (sleep profile) → OBSERVATION.sleep_architecture.v0\n- Device → CLUSTER.wearable_device.v0\n\nArchitecture:\n- Complements ConceptMapOpenEHRToFHIR for bidirectional transformation\n- Compatible with NUM-FHIR-Bridge Apache Camel routes\n- Supports EHRbase CDR as target system",
  "jurisdiction" : [{
    "coding" : [{
      "system" : "http://unstats.un.org/unsd/methods/m49/m49.htm",
      "code" : "150",
      "display" : "Europe"
    }]
  },
  {
    "coding" : [{
      "system" : "http://unstats.un.org/unsd/methods/m49/m49.htm",
      "code" : "021",
      "display" : "Northern America a/"
    }]
  },
  {
    "coding" : [{
      "system" : "http://unstats.un.org/unsd/methods/m49/m49.htm",
      "code" : "005",
      "display" : "South America"
    }]
  },
  {
    "coding" : [{
      "system" : "urn:iso:std:iso:3166",
      "code" : "PT",
      "display" : "Portugal"
    }]
  },
  {
    "coding" : [{
      "system" : "urn:iso:std:iso:3166",
      "code" : "US",
      "display" : "United States of America"
    }]
  },
  {
    "coding" : [{
      "system" : "urn:iso:std:iso:3166",
      "code" : "BR",
      "display" : "Brazil"
    }]
  }],
  "purpose" : "Enable data transformation from FHIR servers to openEHR Clinical Data Repositories (CDRs) for wearable health data in Learning Health Systems.",
  "group" : [{
    "source" : "http://hl7.org/fhir/StructureDefinition/Observation",
    "target" : "openEHR-EHR-OBSERVATION.heart_rate_variability.v0",
    "element" : [{
      "code" : "Observation.component:sdnn",
      "display" : "SDNN component with LOINC 80404-7",
      "target" : [{
        "code" : "id5",
        "display" : "SDNN - Standard deviation of NN intervals",
        "equivalence" : "equivalent",
        "comment" : "Map from Observation.component with code LOINC 80404-7. Unit: ms"
      }]
    },
    {
      "code" : "Observation.component:rmssd",
      "display" : "RMSSD component with HeartRateVariabilityCS#hrv-rmssd",
      "target" : [{
        "code" : "id6",
        "display" : "RMSSD - Root mean square of successive differences",
        "equivalence" : "equivalent",
        "comment" : "Map from component with HeartRateVariabilityCS#hrv-rmssd. No LOINC code. Unit: ms"
      }]
    },
    {
      "code" : "Observation.component:pnn50",
      "display" : "pNN50 component with HeartRateVariabilityCS#hrv-pnn50",
      "target" : [{
        "code" : "id7",
        "display" : "pNN50 - Percentage of NN intervals >50ms",
        "equivalence" : "equivalent",
        "comment" : "Map from component with HeartRateVariabilityCS#hrv-pnn50. Unit: %"
      }]
    },
    {
      "code" : "Observation.component:lf-hf-ratio",
      "display" : "LF/HF ratio component",
      "target" : [{
        "code" : "id13",
        "display" : "LF/HF Ratio",
        "equivalence" : "equivalent",
        "comment" : "Map from component with HeartRateVariabilityCS#hrv-lf-hf-ratio. Dimensionless ratio"
      }]
    },
    {
      "code" : "Observation.effectivePeriod",
      "display" : "Observation.effectivePeriod (start/end)",
      "target" : [{
        "code" : "id32",
        "display" : "Recording duration",
        "equivalence" : "relatedto",
        "comment" : "Calculate duration from effectivePeriod.end - effectivePeriod.start"
      }]
    },
    {
      "code" : "Observation.component:state",
      "display" : "Physiological state component",
      "target" : [{
        "code" : "id41",
        "display" : "Physiological state",
        "equivalence" : "equivalent",
        "comment" : "Map resting/active/sleep states from component"
      }]
    },
    {
      "code" : "Observation.device",
      "display" : "Observation.device reference",
      "target" : [{
        "code" : "id51",
        "display" : "Device type",
        "equivalence" : "relatedto",
        "comment" : "Resolve Device reference and map to CLUSTER.wearable_device"
      }]
    }],
    "unmapped" : {
      "mode" : "fixed",
      "code" : "other",
      "display" : "Unmapped FHIR HRV element"
    }
  },
  {
    "source" : "http://hl7.org/fhir/StructureDefinition/Observation",
    "target" : "openEHR-EHR-OBSERVATION.physical_activity_detailed.v0",
    "element" : [{
      "code" : "Observation.valueQuantity",
      "display" : "Observation.valueQuantity (steps)",
      "target" : [{
        "code" : "id10",
        "display" : "Step count",
        "equivalence" : "equivalent",
        "comment" : "When Observation.code is LOINC 55423-8 (Number of steps). Unit: steps"
      }]
    },
    {
      "code" : "Observation.component:distance",
      "display" : "Distance component with LOINC 55430-3",
      "target" : [{
        "code" : "id11",
        "display" : "Distance",
        "equivalence" : "equivalent",
        "comment" : "Map from component with LOINC 55430-3. Unit: km or m"
      }]
    },
    {
      "code" : "Observation.component:active-calories",
      "display" : "Active calories component with LOINC 41979-6",
      "target" : [{
        "code" : "id20",
        "display" : "Active calories",
        "equivalence" : "equivalent",
        "comment" : "Map from component with LOINC 41979-6. Unit: kcal"
      }]
    },
    {
      "code" : "Observation.component:moderate-minutes",
      "display" : "Moderate activity minutes with LOINC 77592-4",
      "target" : [{
        "code" : "id32",
        "display" : "Moderately active minutes",
        "equivalence" : "equivalent",
        "comment" : "Map from component with LOINC 77592-4. Unit: min"
      }]
    },
    {
      "code" : "Observation.component:vigorous-minutes",
      "display" : "Vigorous activity minutes with LOINC 77593-2",
      "target" : [{
        "code" : "id33",
        "display" : "Vigorously active minutes",
        "equivalence" : "equivalent",
        "comment" : "Map from component with LOINC 77593-2. Unit: min"
      }]
    }]
  },
  {
    "source" : "http://hl7.org/fhir/StructureDefinition/Observation",
    "target" : "openEHR-EHR-OBSERVATION.sleep_architecture.v0",
    "element" : [{
      "code" : "Observation.valueQuantity",
      "display" : "Observation.valueQuantity (sleep duration)",
      "target" : [{
        "code" : "id13",
        "display" : "Total sleep time",
        "equivalence" : "equivalent",
        "comment" : "When Observation.code is LOINC 93832-4 (Sleep duration). Unit: h or min"
      }]
    },
    {
      "code" : "Observation.component:deep-sleep",
      "display" : "Deep sleep duration component",
      "target" : [{
        "code" : "id23",
        "display" : "Deep sleep duration",
        "equivalence" : "equivalent",
        "comment" : "N3/SWS stage duration. Custom code - no LOINC"
      }]
    },
    {
      "code" : "Observation.component:rem-sleep",
      "display" : "REM sleep duration component",
      "target" : [{
        "code" : "id24",
        "display" : "REM sleep duration",
        "equivalence" : "equivalent",
        "comment" : "REM stage duration. Custom code - no LOINC"
      }]
    },
    {
      "code" : "Observation.component:efficiency",
      "display" : "Sleep efficiency component",
      "target" : [{
        "code" : "id30",
        "display" : "Sleep efficiency",
        "equivalence" : "equivalent",
        "comment" : "TST/TIB ratio as percentage. Custom code - no LOINC"
      }]
    },
    {
      "code" : "Observation.component:score",
      "display" : "Sleep score component",
      "target" : [{
        "code" : "id40",
        "display" : "Sleep score",
        "equivalence" : "equivalent",
        "comment" : "Vendor-specific composite score (0-100). Proprietary algorithm"
      }]
    },
    {
      "code" : "Observation.component:sleep-hrv",
      "display" : "Average HRV during sleep component",
      "target" : [{
        "code" : "id53",
        "display" : "Average HRV (RMSSD) during sleep",
        "equivalence" : "equivalent",
        "comment" : "Use HeartRateVariabilityCS#hrv-rmssd with context. Unit: ms"
      }]
    }]
  },
  {
    "source" : "http://hl7.org/fhir/StructureDefinition/Device",
    "target" : "openEHR-EHR-CLUSTER.wearable_device.v0",
    "element" : [{
      "code" : "Device.manufacturer",
      "display" : "Device.manufacturer",
      "target" : [{
        "code" : "id2",
        "display" : "Device platform",
        "equivalence" : "equivalent",
        "comment" : "Map manufacturer string to vendor code (Apple, Fitbit, Garmin, etc.)"
      }]
    },
    {
      "code" : "Device.modelNumber",
      "display" : "Device.modelNumber",
      "target" : [{
        "code" : "id3",
        "display" : "Device model",
        "equivalence" : "equivalent",
        "comment" : "Specific model name"
      }]
    },
    {
      "code" : "Device.type",
      "display" : "Device.type",
      "target" : [{
        "code" : "id4",
        "display" : "Device category",
        "equivalence" : "equivalent",
        "comment" : "Map from SNOMED CT device type codes where available"
      }]
    },
    {
      "code" : "Device.serialNumber",
      "display" : "Device.serialNumber",
      "target" : [{
        "code" : "id23",
        "display" : "Serial number",
        "equivalence" : "equivalent"
      }]
    },
    {
      "code" : "Device.version:firmware",
      "display" : "Device.version[firmware]",
      "target" : [{
        "code" : "id20",
        "display" : "Firmware version",
        "equivalence" : "equivalent",
        "comment" : "Filter by version.type = firmware"
      }]
    }]
  }]
}