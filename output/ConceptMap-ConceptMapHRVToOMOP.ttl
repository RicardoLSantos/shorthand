@prefix fhir: <http://hl7.org/fhir/> .
@prefix owl: <http://www.w3.org/2002/07/owl#> .
@prefix rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#> .
@prefix rdfs: <http://www.w3.org/2000/01/rdf-schema#> .
@prefix xsd: <http://www.w3.org/2001/XMLSchema#> .

# - resource -------------------------------------------------------------------

<https://2rdoc.pt/ig/ios-lifestyle-medicine/ConceptMap/ConceptMapHRVToOMOP> a fhir:ConceptMap ;
  fhir:nodeRole fhir:treeRoot ;
  fhir:id [ fhir:v "ConceptMapHRVToOMOP"] ; # 
  fhir:text [
     fhir:status [ fhir:v "generated" ] ;
     fhir:div "<div xmlns=\"http://www.w3.org/1999/xhtml\"><p class=\"res-header-id\"><b>Narrativa gerada: ConceptMap ConceptMapHRVToOMOP</b></p><a name=\"ConceptMapHRVToOMOP\"> </a><a name=\"hcConceptMapHRVToOMOP\"> </a><p>Mapeamento de (não especificado) para (não especificado)</p><br/><p><b>Grupo 1 </b>Mapeamento de <a href=\"http://terminology.hl7.org/6.5.0/CodeSystem-v3-loinc.html\">Logical Observation Identifiers, Names and Codes (LOINC)</a> to <a href=\"CodeSystem-omop-concepts-stub.html\">OHDSI OMOP CDM Concepts (External Reference)</a></p><table class=\"grid\"><tr><td><b>Código fonte</b></td><td><b>Relacionamento</b></td><td><b>Código de destino</b></td><td><b>Comentário</b></td></tr><tr><td>80404-7 (R-R interval.standard deviation (Heart rate variability) [LOINC])</td><td><a href=\"http://hl7.org/fhir/R5/codesystem-concept-map-relationship.html#equivalent\" title=\"equivalent\">is equivalent to</a></td><td>37547368 (R-R interval.standard deviation (Heart rate variability))</td><td>VERIFIED MAPPING via Athena (2025-11-28):\n- OMOP concept_id: 37547368\n- Domain: Measurement\n- Concept Class: Lab Test\n- Vocabulary: LOINC\n- Valid dates: 2020-08-11 to 2099-12-31\n- Standard concept: Standard\n\nETL Implementation:\n- MEASUREMENT.measurement_concept_id = 37547368\n- MEASUREMENT.value_as_number = SDNN value\n- MEASUREMENT.unit_concept_id = 8587 (millisecond)\n- MEASUREMENT.measurement_type_concept_id = 44818707 (Patient self-reported)</td></tr><tr><td>hrv-rmssd-local (RMSSD - Root Mean Square of Successive Differences [Custom])</td><td colspan=\"2\" style=\"background-color: #efefef\">(not mapped)</td><td style=\"background-color: #efefef\">CRITICAL GAP: RMSSD has NO OMOP concept (concept_id = 0)\n\nClinical Importance:\n- Primary parasympathetic marker (HRV Task Force 1996)\n- Main HRV metric from consumer wearables (Apple, Oura, Garmin)\n- Strongly associated with vagal tone and inflammation (RS1 finding)\n- Mathematical relationship: RMSSD = SD1 × √2 (Poincaré plot)\n\nWorkaround:\n1. Create local custom concept in OMOP vocabulary with concept_class_id = 'Observable Entity'\n2. Map to general HRV concept 37547368 with qualifier (data loss)\n3. Store in measurement_source_value field (non-standardized)\n\nRecommendation: Submit new concept proposal to OHDSI Vocabulary team</td></tr><tr><td>hrv-pnn50-local (pNN50 - Percentage of NN intervals &gt;50ms [Custom])</td><td colspan=\"2\" style=\"background-color: #efefef\">(not mapped)</td><td style=\"background-color: #efefef\">GAP: pNN50 has no OMOP concept (concept_id = 0)\n\nClinical notes:\n- High correlation with RMSSD (r &gt; 0.90)\n- Parasympathetic marker\n- Unit: percentage (%)\n- Normal range: typically 20-30% in healthy adults\n\nETL workaround: Store as measurement_source_value = 'pNN50:{value}%'</td></tr><tr><td>hrv-lf-hf-local (LF/HF Ratio - Low to High Frequency Power Ratio [Custom])</td><td colspan=\"2\" style=\"background-color: #efefef\">(not mapped)</td><td style=\"background-color: #efefef\">GAP: LF/HF ratio has no OMOP concept (concept_id = 0)\n\nClinical notes:\n- Autonomic balance indicator (sympathovagal)\n- Interpretation is debated in literature\n- Dimensionless ratio\n- Typically 1.5-2.0 in healthy adults at rest\n\nETL workaround: Store in measurement_source_value with qualifier</td></tr><tr><td>8867-4 (Heart rate [LOINC])</td><td><a href=\"http://hl7.org/fhir/R5/codesystem-concept-map-relationship.html#equivalent\" title=\"equivalent\">is equivalent to</a></td><td>3027018 (Heart rate)</td><td>Verified standard OMOP concept for heart rate.\n- OMOP concept_id: 3027018\n- Unit_concept_id: 8541 (per minute, {beats}/min)\n- Critical contextual data for HRV interpretation</td></tr><tr><td>40443-4 (Heart rate --resting [LOINC])</td><td><a href=\"http://hl7.org/fhir/R5/codesystem-concept-map-relationship.html#wider\" title=\"wider\">maps to wider concept</a></td><td>3027018 (Heart rate)</td><td>Maps to general heart rate concept.\nResting context can be captured in:\n- visit_occurrence.visit_concept_id\n- measurement qualifier\n- observation_period context\n\nResting HR is critical for HRV baseline interpretation (Uth formula: VO2max = HRmax/HRrest × 15)</td></tr></table><hr/><p><b>Grupo 2 </b>Mapeamento de <a href=\"http://hl7.org/fhir/R4/codesystem-snomedct.html\">SNOMED CT (all versions)</a> to <a href=\"CodeSystem-omop-concepts-stub.html\">OHDSI OMOP CDM Concepts (External Reference)</a></p><table class=\"grid\"><tr><td><b>Código fonte</b></td><td><b>Relacionamento</b></td><td><b>Código de destino</b></td><td><b>Comentário</b></td></tr><tr><td>86290005 (Respiratory rate [SNOMED])</td><td><a href=\"http://hl7.org/fhir/R5/codesystem-concept-map-relationship.html#equivalent\" title=\"equivalent\">is equivalent to</a></td><td>3024171 (Respiratory rate)</td><td>Critical for HRV interpretation. RSA (respiratory sinus arrhythmia) affects HF power band.</td></tr></table></div>"^^rdf:XMLLiteral
  ] ; # 
  fhir:url [ fhir:v "https://2rdoc.pt/ig/ios-lifestyle-medicine/ConceptMap/ConceptMapHRVToOMOP"^^xsd:anyURI] ; # 
  fhir:version [ fhir:v "0.1.0"] ; # 
  fhir:name [ fhir:v "ConceptMapHRVToOMOP"] ; # 
  fhir:title [ fhir:v "HRV LOINC to OMOP CDM Mapping"] ; # 
  fhir:status [ fhir:v "active"] ; # 
  fhir:experimental [ fhir:v false] ; # 
  fhir:date [ fhir:v "2025-11-28"^^xsd:date] ; # 
  fhir:publisher [ fhir:v "Ricardo Lourenço dos Santos"] ; # 
  fhir:contact ( [
     fhir:name [ fhir:v "Ricardo Lourenço dos Santos" ] ;
     fhir:telecom ( [
       fhir:system [ fhir:v "url" ] ;
       fhir:value [ fhir:v "https://linktr.ee/ricardolsantos" ]
     ] )
  ] ) ; # 
  fhir:description [ fhir:v "Maps HRV (Heart Rate Variability) metrics from LOINC codes to OMOP CDM concepts for federated analytics.\n\nKey Findings from RS4 Systematic Review (354 papers analyzed):\n- ZERO documented HRV-OMOP transformations in peer-reviewed literature\n- Only ONE OMOP concept available: 37547368 (SDNN via LOINC 80404-7)\n- CRITICAL GAP: RMSSD, pNN50, LF/HF have NO OMOP concepts (concept_id = 0)\n\nThis ConceptMap enables:\n- SpringBatch ETL pipelines (Peng et al. achieved 99% DQD compliance)\n- Incremental loading patterns (Henke et al. achieved 87.5% time reduction)\n- OHDSI network study participation for wearable HRV data\n\nTarget OMOP Table: MEASUREMENT\n- measurement_concept_id: mapped OMOP concept\n- value_as_number: HRV metric value\n- unit_concept_id: 8587 (millisecond) for time-domain metrics\n- measurement_type_concept_id: 44818707 (Patient self-reported/device)"] ; # 
  fhir:jurisdiction ( [
     fhir:coding ( [
       fhir:system [ fhir:v "http://unstats.un.org/unsd/methods/m49/m49.htm"^^xsd:anyURI ] ;
       fhir:code [ fhir:v "150" ] ;
       fhir:display [ fhir:v "Europe" ]
     ] )
  ] [
     fhir:coding ( [
       fhir:system [ fhir:v "http://unstats.un.org/unsd/methods/m49/m49.htm"^^xsd:anyURI ] ;
       fhir:code [ fhir:v "021" ] ;
       fhir:display [ fhir:v "Northern America a/" ]
     ] )
  ] [
     fhir:coding ( [
       fhir:system [ fhir:v "http://unstats.un.org/unsd/methods/m49/m49.htm"^^xsd:anyURI ] ;
       fhir:code [ fhir:v "005" ] ;
       fhir:display [ fhir:v "South America" ]
     ] )
  ] [
     fhir:coding ( [
       fhir:system [ fhir:v "urn:iso:std:iso:3166"^^xsd:anyURI ] ;
       fhir:code [ fhir:v "PT" ] ;
       fhir:display [ fhir:v "Portugal" ]
     ] )
  ] [
     fhir:coding ( [
       fhir:system [ fhir:v "urn:iso:std:iso:3166"^^xsd:anyURI ] ;
       fhir:code [ fhir:v "US" ] ;
       fhir:display [ fhir:v "United States of America" ]
     ] )
  ] [
     fhir:coding ( [
       fhir:system [ fhir:v "urn:iso:std:iso:3166"^^xsd:anyURI ] ;
       fhir:code [ fhir:v "BR" ] ;
       fhir:display [ fhir:v "Brazil" ]
     ] )
  ] ) ; # 
  fhir:purpose [ fhir:v "Enable ETL transformation of wearable HRV data from FHIR (LOINC-coded) to OMOP CDM for research analytics in OHDSI federated network."] ; # 
  fhir:group ( [
     fhir:source [ fhir:v "http://loinc.org"^^xsd:anyURI ] ;
     fhir:target [ fhir:v "http://athena.ohdsi.org/search-terms/terms"^^xsd:anyURI ] ;
     fhir:element ( [
       fhir:code [ fhir:v "80404-7" ] ;
       fhir:display [ fhir:v "R-R interval.standard deviation (Heart rate variability) [LOINC]" ] ;
       fhir:target ( [
         fhir:code [ fhir:v "37547368" ] ;
         fhir:display [ fhir:v "R-R interval.standard deviation (Heart rate variability)" ] ;
         fhir:equivalence [ fhir:v "equivalent" ] ;
         fhir:comment [ fhir:v "VERIFIED MAPPING via Athena (2025-11-28):\n- OMOP concept_id: 37547368\n- Domain: Measurement\n- Concept Class: Lab Test\n- Vocabulary: LOINC\n- Valid dates: 2020-08-11 to 2099-12-31\n- Standard concept: Standard\n\nETL Implementation:\n- MEASUREMENT.measurement_concept_id = 37547368\n- MEASUREMENT.value_as_number = SDNN value\n- MEASUREMENT.unit_concept_id = 8587 (millisecond)\n- MEASUREMENT.measurement_type_concept_id = 44818707 (Patient self-reported)" ]
       ] )
     ] [
       fhir:code [ fhir:v "hrv-rmssd-local" ] ;
       fhir:display [ fhir:v "RMSSD - Root Mean Square of Successive Differences [Custom]" ] ;
       fhir:target ( [
         fhir:equivalence [ fhir:v "unmatched" ] ;
         fhir:comment [ fhir:v "CRITICAL GAP: RMSSD has NO OMOP concept (concept_id = 0)\n\nClinical Importance:\n- Primary parasympathetic marker (HRV Task Force 1996)\n- Main HRV metric from consumer wearables (Apple, Oura, Garmin)\n- Strongly associated with vagal tone and inflammation (RS1 finding)\n- Mathematical relationship: RMSSD = SD1 × √2 (Poincaré plot)\n\nWorkaround:\n1. Create local custom concept in OMOP vocabulary with concept_class_id = 'Observable Entity'\n2. Map to general HRV concept 37547368 with qualifier (data loss)\n3. Store in measurement_source_value field (non-standardized)\n\nRecommendation: Submit new concept proposal to OHDSI Vocabulary team" ]
       ] )
     ] [
       fhir:code [ fhir:v "hrv-pnn50-local" ] ;
       fhir:display [ fhir:v "pNN50 - Percentage of NN intervals >50ms [Custom]" ] ;
       fhir:target ( [
         fhir:equivalence [ fhir:v "unmatched" ] ;
         fhir:comment [ fhir:v "GAP: pNN50 has no OMOP concept (concept_id = 0)\n\nClinical notes:\n- High correlation with RMSSD (r > 0.90)\n- Parasympathetic marker\n- Unit: percentage (%)\n- Normal range: typically 20-30% in healthy adults\n\nETL workaround: Store as measurement_source_value = 'pNN50:{value}%'" ]
       ] )
     ] [
       fhir:code [ fhir:v "hrv-lf-hf-local" ] ;
       fhir:display [ fhir:v "LF/HF Ratio - Low to High Frequency Power Ratio [Custom]" ] ;
       fhir:target ( [
         fhir:equivalence [ fhir:v "unmatched" ] ;
         fhir:comment [ fhir:v "GAP: LF/HF ratio has no OMOP concept (concept_id = 0)\n\nClinical notes:\n- Autonomic balance indicator (sympathovagal)\n- Interpretation is debated in literature\n- Dimensionless ratio\n- Typically 1.5-2.0 in healthy adults at rest\n\nETL workaround: Store in measurement_source_value with qualifier" ]
       ] )
     ] [
       fhir:code [ fhir:v "8867-4" ] ;
       fhir:display [ fhir:v "Heart rate [LOINC]" ] ;
       fhir:target ( [
         fhir:code [ fhir:v "3027018" ] ;
         fhir:display [ fhir:v "Heart rate" ] ;
         fhir:equivalence [ fhir:v "equivalent" ] ;
         fhir:comment [ fhir:v "Verified standard OMOP concept for heart rate.\n- OMOP concept_id: 3027018\n- Unit_concept_id: 8541 (per minute, {beats}/min)\n- Critical contextual data for HRV interpretation" ]
       ] )
     ] [
       fhir:code [ fhir:v "40443-4" ] ;
       fhir:display [ fhir:v "Heart rate --resting [LOINC]" ] ;
       fhir:target ( [
         fhir:code [ fhir:v "3027018" ] ;
         fhir:display [ fhir:v "Heart rate" ] ;
         fhir:equivalence [ fhir:v "wider" ] ;
         fhir:comment [ fhir:v "Maps to general heart rate concept.\nResting context can be captured in:\n- visit_occurrence.visit_concept_id\n- measurement qualifier\n- observation_period context\n\nResting HR is critical for HRV baseline interpretation (Uth formula: VO2max = HRmax/HRrest × 15)" ]
       ] )
     ] ) ;
     fhir:unmapped [
       fhir:mode [ fhir:v "fixed" ] ;
       fhir:code [ fhir:v "0" ] ;
       fhir:display [ fhir:v "No OMOP concept - requires custom vocabulary extension" ]
     ]
  ] [
     fhir:source [ fhir:v "http://snomed.info/sct"^^xsd:anyURI ] ;
     fhir:target [ fhir:v "http://athena.ohdsi.org/search-terms/terms"^^xsd:anyURI ] ;
     fhir:element ( [
       fhir:code [ fhir:v "86290005" ] ;
       fhir:display [ fhir:v "Respiratory rate [SNOMED]" ] ;
       fhir:target ( [
         fhir:code [ fhir:v "3024171" ] ;
         fhir:display [ fhir:v "Respiratory rate" ] ;
         fhir:equivalence [ fhir:v "equivalent" ] ;
         fhir:comment [ fhir:v "Critical for HRV interpretation. RSA (respiratory sinus arrhythmia) affects HF power band." ]
       ] )
     ] )
  ] ) . # 

# -------------------------------------------------------------------------------------

